<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="chart.css"> <link rel="stylesheet" href="theme/white.min.css"> </head> <body class="chart-page on-widget"> <svg style="display:none"> <symbol viewBox="0 0 17.5 16" id="svg-alarm-clock-plus"> <title>alarm-clock-plus</title> <path d="M2.766.016c-1.515 0-2.75 1.235-2.75 2.75 0 .518.155.992.406 1.406.981-1.569 2.539-2.737 4.375-3.219-.504-.564-1.218-.938-2.031-.938zm7.781 0c-.813 0-1.527.374-2.031.938 1.841.479 3.391 1.648 4.375 3.219.251-.415.406-.888.406-1.406 0-1.515-1.235-2.75-2.75-2.75zm-3.875 1.719c-3.489 0-6.313 2.854-6.313 6.344 0 1.363.423 2.625 1.156 3.656l-.906 1.156a.857.857 0 1 0 1.344 1.063l.75-.969c1.083.875 2.466 1.406 3.969 1.406.668 0 1.298-.123 1.906-.313v-1.719c-.581.26-1.226.406-1.906.406-2.596 0-4.688-2.092-4.688-4.688 0-2.596 2.092-4.719 4.688-4.719 2.261 0 4.147 1.619 4.594 3.75h1.625c-.463-3.036-3.057-5.375-6.219-5.375zm-.063 2.438a.65.65 0 0 0-.094.031.65.65 0 0 0-.5.656v2.938l-1.25 1.313a.652.652 0 1 0 .938.906l1.438-1.5.188-.188v-3.469a.65.65 0 0 0-.719-.688zm6.375 4.625v2.687h-2.719v1.813h2.719v2.688h1.781v-2.688h2.719v-1.813h-2.719v-2.687h-1.781z"/> </symbol> <symbol viewBox="0 0 13.3 14.4" id="svg-alarm-clock"> <title>alarm-clock</title> <path d="M2.759.013c-1.515 0-2.75 1.235-2.75 2.75 0 .518.155.992.406 1.406.981-1.569 2.539-2.737 4.375-3.219-.504-.564-1.218-.938-2.031-.938zm7.781 0c-.813 0-1.527.374-2.031.938 1.841.479 3.391 1.648 4.375 3.219.251-.415.406-.888.406-1.406 0-1.515-1.235-2.75-2.75-2.75zm-3.875 1.719c-3.489 0-6.313 2.854-6.313 6.344 0 1.363.423 2.625 1.156 3.656l-.906 1.156a.857.857 0 1 0 1.344 1.063l.75-.969c1.083.875 2.466 1.406 3.969 1.406 1.496 0 2.888-.507 3.969-1.375l.719.938a.857.857 0 1 0 1.344-1.063l-.875-1.125c.742-1.035 1.156-2.316 1.156-3.687 0-3.489-2.823-6.344-6.313-6.344zm0 1.625c2.596 0 4.688 2.123 4.688 4.719 0 1.234-.476 2.352-1.25 3.187a.85.85 0 0 0-.063.063c-.852.885-2.045 1.438-3.375 1.438-2.596 0-4.688-2.092-4.688-4.687 0-2.596 2.092-4.719 4.688-4.719zm-.063.813a.65.65 0 0 0-.094.031.65.65 0 0 0-.5.656v2.938l-1.25 1.313a.652.652 0 1 0 .938.906l1.438-1.5.188-.188v-3.469a.65.65 0 0 0-.719-.688z"/> </symbol> <symbol viewBox="2 6 27 22" id="svg-base"> <title>base</title> <path d="M12.1 24h-2v-1h.4c-.5-.3-.9-.7-1.4-1.2v.2H4v-1h4.3c-.3-.3-.5-.7-.7-1H4v-1h3c-.2-.3-.3-.7-.4-1H4v-1h2.3c-.2-.8-.3-1.6-.3-2.5 0-1.6.4-3.1 1-4.5H2v18h15v-3h-.5c-1.6 0-3.1-.4-4.4-1zM9 26H4v-1h5v1zm0-2H4v-1h5v1zm6 2h-5v-1h5v1zm8.5-6.6c1-1.4 1.5-3 1.5-4.9C25 9.8 21.2 6 16.5 6S8 9.8 8 14.5s3.8 8.5 8.5 8.5c1.8 0 3.5-.6 4.9-1.5l5.6 5.6 2.1-2.1-5.6-5.6zM22 18.1L20.1 20c-1 .7-2.3 1.1-3.6 1.1-3.6 0-6.5-2.9-6.5-6.5S12.9 8 16.5 8s6.5 2.9 6.5 6.5c0 1.3-.4 2.5-1 3.6z"/> </symbol> <symbol viewBox="4 4 21 23" id="svg-calendar"> <title>calendar</title> <path d="M23 9v15H7V9H5v17h20V9h-2zm-4-3h-2v4h2V6zm-6 0h-2v4h2V6zm-2 8H9v2h2v-2zm5 0h-2v2h2v-2zm5 0h-2v2h2v-2zm-2 7h2v-2h-2v2zm-3-2h-2v2h2v-2zm-5 0H9v2h2v-2z"/> </symbol> <symbol viewBox="4 6 23 21" id="svg-chat"> <title>chat</title> <path d="M22 6H5v12h1v4l4-4h3v-6h9V6zm-8 7v10h8l4 3v-3h1V13H14z"/> </symbol> <symbol viewBox="5 7 23 21" id="svg-datawindow"> <title>datawindow</title> <path d="M6 7v18h20V7H6zm18 16H8V9h16v14zm-2-8H10v2h12v-2zm0-4H10v2h12v-2zm0 8H10v2h12v-2z"/> </symbol> <symbol viewBox="0 0 595.3 841.9" id="svg-help"> <title>help</title> <path d="M297 127.5c-161.8 0-293 131.2-293 293s131.2 293 293 293 293-131.2 293-293-131.2-293-293-293zm0 537.2c-134.8 0-244.2-109.3-244.2-244.2S162.2 176.3 297 176.3s244.2 109.3 244.2 244.2S431.8 664.7 297 664.7zm-24.4-122.1h48.8v-48.8h-48.8v48.8zM368 319c-17.7-13.9-41.6-20.9-71.5-20.9-28.5 0-51.5 6.9-69 20.6-17.5 13.7-26.8 33.2-28.2 52.9h48.8c3.3-13.7 8.4-21.5 17.3-28.2 8.9-6.7 20-10.1 33.3-10.1 13.7 0 24.7 3.2 32.8 9.6 8.1 6.4 12.2 14.2 12.2 23.2 0 6.5-2.3 12.4-6.9 17.8-3 3.4-12.1 10.6-27.3 21.6-15.2 11-25.4 20.9-30.5 29.7-5.1 8.8-7.6 20-7.6 33.6 0 1.3 1-5.7 1.2.4h48.8c-.2-12.7-1.5-10.9 1.2-15.9 2.7-4.9 9.5-11.5 20.5-19.6 21.3-15.7 35.2-28.1 41.7-37.3 6.5-9.1 9.8-18.8 9.8-29 0-18.3-8.9-34.5-26.6-48.4z"/> </symbol> <symbol viewBox="6 6 21 23" id="svg-hotlists"> <title>hotlists</title> <path d="M22 14s-.8 1.8-1 4c0 0-1.6-8.8-8.3-13 0 0 2.8 4.5.9 6.5 0 0-1.2 1.4-1.6 3.5 0 0-.4 1.5 0 3 .3 1-2-.6-2-3 0 0-1.4 1.7 1 6 0 0 1.3 1.7 1 3 0 0-2.7-.6-4-4 0 0 .1 4.2 2 6 2 1.8 4.5 2 6 2 0 0 6.6 0 7-5 .5-5.2-1.6-6.5-1-9z"/> </symbol> <symbol viewBox="-80 -25 140 140" id="svg-left"> <title>left</title> <path fill-rule="evenodd" clip-rule="evenodd" fill="#ccc" d="M10 12l-10.7-11.3-40.3 42.5.1.1-.1.1 40.3 42.5 10-10.6-29.7-31.2z"/> </symbol> <symbol viewBox="4 6 23 21" id="svg-messages"> <title>messages</title> <path d="M16 18h3v-3h-3v3zm-2-5v10h9l3 3v-3h1V13H14zm6 2v4h-4v3h-1v-8h5v1zm6 0v7h-1v-6h-1v1h-1v-1h-1v6h-1v-8h1v1h1v1h1v-1h1v-1h1v1zm-4-9H5v12h1v4l4-4h3v-6h9V6z"/> </symbol> <symbol viewBox="0 0 120 120" id="svg-minus"> <title>minus</title> <path fill-rule="evenodd" clip-rule="evenodd" fill="#ccc" d="M28 50h65v17h-65z"/> </symbol> <symbol viewBox="300 310 0.3 216.9" id="svg-notes"> <title>notes</title> <path d="M363.5 411.5v17H406v-17h-42.5zm-59.5-102h-17V352h17v-42.5zm76.3 42l-12-12-30.1 30.1 12 12 30.1-30.1zm-169.6 137l12 12 30.1-30.1-12-12-30.1 30.1zm42.4-123.1L222.6 335l-12.2 12.2 30.4 30.4 12.3-12.2zm84.8 109.2l30.4 30.4 12.2-12.2-30.4-30.4-12.2 12.2zM277.5 497h-.2v23.9l5.9 3.8 5.6 5.9h13.7l5.3-5.9 6.1-3.8V497h-36.4zm68.6-74.5c.8-6.6.3-11.3.3-11.3-2.8-19.3-13.3-29.7-23.5-35.4-7.4-4.2-16.2-6.7-24.9-6.8h-2.5c-15.8.5-27 7-33.8 12.5-5.1 4.1-7.7 7.7-7.7 7.7-6.9 8.7-9.4 17.7-9.5 25.9-.1 10.7 3.7 20.2 7.1 26.5 2.6 4.9 5 7.8 5 7.8 3.6 4.6 5.8 10.1 7 15.1 1.8 7.4 1.7 10.2 1.7 10.2.3 6.5 2.5 10.1 4.1 11 .5.3 1.3.7 2.3.7l4.2 3.9h39.7l3.9-3.9h.7c3.6-.5 5.6-6.6 6-10.5.4-4 .5-6 .5-6 0-.4.1-.9.1-1.5.9-9.4 9.9-23.1 9.9-23.1.5-.6.9-1.1 1.3-1.7 5.2-6.9 7.3-14.8 8.1-21.1zm-118.6-11H185v17h42.5v-17z"/> </symbol> <symbol viewBox="5 6 21 21" id="svg-notifications"> <title>notifications</title> <path d="M15.5 27c1.2 0 2.2-.9 2.4-2H13c.3 1.1 1.3 2 2.5 2zm6.5-7v-6c-.2-2.9-2.3-5.3-5.1-5.9 0-.2.1-.4.1-.6 0-.8-.7-1.5-1.5-1.5S14 6.7 14 7.5c0 .2.1.4.2.6-2.8.6-4.9 3-5.1 5.9v5.9C9 22.7 7 23 7 23v1h17v-1s-2-.3-2-3z"/> </symbol> <symbol viewBox="0 0 140 140" id="svg-plus"> <title>plus</title> <path fill-rule="evenodd" clip-rule="evenodd" fill="#ccc" d="M112 60h-34v-34h-17v34h-34v17h34v34h17v-34h34z"/> </symbol> <symbol viewBox="0 0 15 15" id="svg-redo"> <title>redo</title> <path d="M7.5 8.2v3.2l7.5-4.9-7.5-4.8v3.3s-7.5-.9-7.5 8.4c0-.1 1.7-5.2 7.5-5.2z"/> </symbol> <symbol viewBox="-58 -18 120 120" id="svg-restore"> <title>restore</title> <path fill-rule="evenodd" clip-rule="evenodd" fill="#ccc" d="M31 13c-7.6-7.7-18.2-12.5-29.9-12.5-23.3 0-42.3 19-42.3 42.5s18.9 42.5 42.3 42.5c13.8 0 26-6.6 33.7-16.9l-16.5-1.8c-4.8 3.6-10.8 5.7-17.3 5.7-16.2 0-29.3-13.2-29.3-29.4s13.1-29.4 29.3-29.4c8.1 0 15.4 3.3 20.7 8.6l-10.9 11h32.5v-32.8l-12.3 12.5z"/> </symbol> <symbol viewBox="0 0 14.8 13.4" id="svg-right-stop"> <title>right-stop</title> <path fill="#ccc" d="M8 6.7l-6.3-6.7-1.6 1.7 4.7 4.9-4.8 5 1.7 1.8 6.3-6.7zm6.8 0l-6.4-6.7-1.6 1.7 4.7 4.9-4.8 5 1.7 1.8 6.4-6.7z"/> </symbol> <symbol viewBox="-90 -55 140 140" id="svg-right"> <title>right</title> <path fill-rule="evenodd" clip-rule="evenodd" fill="#ccc" d="M10 12l-40.3-42.5-10 10.6 29.7 31.2-30.4 32.1 10.7 11.3 40.3-42.5-.1-.1z"/> </symbol> <symbol viewBox="0 0 15 11.5" id="svg-snapshot"> <title>snapshot</title> <path d="M7.5 4.8c-1.1 0-1.9.9-1.9 1.9s.9 1.9 1.9 1.9c1.1 0 1.9-.9 1.9-1.9s-.9-1.9-1.9-1.9zm5.5-2.9h-2.2c0-1-.9-1.9-2-1.9h-2.7c-1.1 0-1.9.9-1.9 1.9h-2.3c-1 0-1.9.9-1.9 2v5.7c0 1.1.9 1.9 1.9 1.9h11.1c1.1 0 1.9-.9 1.9-1.9v-5.7c.1-1.1-.8-2-1.9-2zm-5.5 8.3c-1.9 0-3.5-1.6-3.5-3.5s1.5-3.4 3.4-3.4 3.4 1.5 3.4 3.4c.1 1.9-1.4 3.5-3.3 3.5z"/> </symbol> <symbol viewBox="0 0 14.8 9.4" id="svg-stocktwits"> <title>stocktwits</title> <path d="M3.9 4c-.7-.3-1.1-.5-1.3-.6l-.4-.4c-.1-.1-.1-.3-.1-.5 0-.3.1-.5.3-.7.2-.2.5-.3.9-.3.3 0 .7 0 1 .1.3.2.7.4 1.2.5l.7-1.5c-.5-.2-1-.4-1.4-.5l-1.4-.1c-1.1 0-1.9.2-2.4.7s-.9 1.1-.9 1.9c0 .4.1.8.3 1.1s.4.6.7.8c.3.2.7.5 1.3.8l1.2.6c.2.2.4.3.5.4.1.1.2.3.2.5 0 .3-.1.6-.4.7-.2.2-.6.2-1 .2s-.8-.1-1.2-.2c-.5 0-1.1-.2-1.7-.5v1.8c.8.4 1.7.6 2.7.6 1.1 0 2-.2 2.6-.7.7-.5 1-1.2 1-2 0-.6-.2-1.1-.5-1.5-.4-.4-1-.8-1.9-1.2zm3.1-4v1.6h3.1v7.8h1.6v-7.8h3.1v-1.6h-7.8z"/> </symbol> <symbol viewBox="0 0 10 14" id="svg-trading-connect"> <title>trading-connect</title> <circle cx="5" cy="7" r="3"/> </symbol> <symbol viewBox="0 0 15 11.6" id="svg-twitter"> <title>twitter</title> <path d="M15 1.4c-.3.1-1 .4-1.7.5.4-.2 1.1-1 1.3-1.6-.4.3-1.4.7-1.9.7-.6-.7-1.4-1-2.3-1-1.7 0-3.1 1.3-3.1 3 0 .2 0 .4.1.7-2.3-.1-5-1.2-6.5-3.1-.9 1.5-.1 3.3.9 3.9-.4 0-1 0-1.3-.3 0 1 .5 2.4 2.4 2.9-.4.2-1 .1-1.3.1.1.9 1.4 2 2.8 2-.6.5-2.3 1.4-4.4 1.1 1.4.8 3.1 1.3 4.8 1.3 5 0 8.8-3.9 8.6-8.6.5-.4 1.1-.9 1.6-1.6z"/> </symbol> <symbol viewBox="0 0 15 15" id="svg-undo"> <title>undo</title> <path d="M15 13.4c0-9.3-7.5-8.4-7.5-8.4v-3.3l-7.5 4.8 7.5 4.9v-3.2c5.8 0 7.5 5.1 7.5 5.2z"/> </symbol> <symbol viewBox="0 0 1024 973.125" id="svg-chat-search"> <title>chat-search</title> <path d="M960 832L710.875 582.875C746.438 524.812 768 457.155 768 384 768 171.97 596 0 384 0 171.97 0 0 171.97 0 384c0 212 171.97 384 384 384 73.156 0 140.812-21.562 198.875-57L832 960c17.5 17.5 46.5 17.375 64 0l64-64c17.5-17.5 17.5-46.5 0-64zM384 640c-141.375 0-256-114.625-256-256s114.625-256 256-256 256 114.625 256 256-114.625 256-256 256z"/> </symbol> <symbol viewBox="-2.4 120.9 600 600" id="svg-config"> <title>config</title> <path d="M594 473.5V368.8h-76c-5.7-23.8-15.2-46.4-27.5-66.4l53.8-53.8-73.9-73.9-53.8 53.4c-20.6-12.8-42.7-21.8-66.4-27.5v-75.9H245.5v75.9c-23.8 5.7-46.4 15.2-66.4 27.5l-53.8-53.8-73.9 73.9 53.4 53.8C92 322.6 83 344.7 77.3 368.4h-76V473h75.9c5.7 23.8 15.2 46.4 27.5 66.4L51 593.3l73.9 73.9 53.8-53.4c20.6 12.8 42.7 21.8 66.4 27.5v75.9h104.6v-75.9c23.8-5.7 46.4-15.2 66.4-27.5l53.8 53.8 73.9-73.9-53.4-53.8c12.8-20.6 21.8-42.7 27.5-66.4H594zm-296.4 69.7c-67.3 0-122.3-54.6-122.3-122.3 0-67.3 54.6-122.3 122.3-122.3 67.3 0 122.3 54.6 122.3 122.3-.4 67.4-54.9 122.3-122.3 122.3z"/> </symbol> <symbol viewBox="0 0 17 17" id="svg-plus-bolder"> <title>plus-bolder</title> <path d="M7 2h3v13H7M2 7h13v3H2z"/> </symbol> </svg> <div class="loading-indicator" id="loading-indicator"></div> <script src="vendor/spin.min.js"></script><script>var loadingSpinner=new Spinner({lines:15,length:0,width:9,radius:30,corners:1,rotate:0,direction:1,color:"#000",speed:.75,trail:74,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"}).spin(document.getElementById("loading-indicator"));</script><div id="library-container" class="chart-page"> <div class="tv-side-toolbar"></div> <div class="tv-side-panel"></div> <div class="tv-main-panel"> <div class="header-chart-panel"> <div class="right"></div> <div class="left"></div> </div> <div id="chart-area"></div> </div> </div> <script>var A82={},__initialEnabledFeaturesets=["charting_library"];</script><script>function cursorCss(e,t,i){return i||(i="light"),e=TradingView.wrapUrl("url("+TradingView.resourceFullPath(i+"/"+e+".cur")+")"),$.browser.msie?e+", default":e+" "+t+", default"}function isInteger(e){return"number"==typeof e&&0===e%1}function isNumber(e){return"number"==typeof e&&isFinite(e)}function parseBool(e){return!0===e||"true"===e}function isBoolean(e){return!0===e||!1===e}function isString(e){return null===e||void 0===e?!1:e.constructor==String}function isFunction(e){return null===e||void 0===e?!1:e.constructor==Function}function inherit(e,t){e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),e.prototype.superclass=t}function declareClassAsPureInterface(e,t){for(var i in e.prototype)"function"==typeof e.prototype[i]&&e.prototype.hasOwnProperty(i)&&(e.prototype[i]=function(){throw t+"::"+i+" is an interface member declaration and must be overloaded in order to be called"})}function requireFullInterfaceImplementation(e,t,i,n){for(var o in i.prototype)if("function"==typeof i.prototype[o]&&!e.prototype[o])throw"Interface implementation assertion failed: "+t+" does not implement "+n+"::"+o+" function"}function isInherited(e,t){return e===t?!0:e&&e.prototype?void 0===e.prototype.superclass||null===e.prototype.superclass?!1:e.prototype.superclass===t?!0:isInherited(e.prototype.superclass,t):!1}function TypeValidator(e){this.m_type=e}function PredicateValidator(e){this.m_predicate=e}function OrderedHash(e,t){this.array=[];for(var i in e)e[i].key=i,this.array.push(e[i]);this.rearrange(t)}function List(e){if(void 0==e)this.m_values=[];else{if(!isArray(e))throw new TypeError("invalid values");this.m_values=e}this.m_validator=null}function loadScript(e){function t(){n.reject()}function i(){if(o.length){var e=o.shift();if(null==e)return i();var r=document.createElement("script");r.addEventListener("load",i,!0),r.addEventListener("error",t,!0),r.async=!0,r.defer=!0,r.src=e,document.body.appendChild(r)}else n.resolve()}var n=$.Deferred(),o=[].concat(e);return i(),n.promise()}function Delegate(){this._listeners=new List}function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t,i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(t in i)e==t&&(e=i[t]);for(i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],t=0;t<i.length;t++){var n=i[t].process,o=i[t].re.exec(e);o&&(channels=n(o),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.cleanupRGB=function(){this.r=0>this.r||isNaN(this.r)?0:255<this.r?255:this.r,this.g=0>this.g||isNaN(this.g)?0:255<this.g?255:this.g,this.b=0>this.b||isNaN(this.b)?0:255<this.b?255:this.b},this.cleanupRGB(),this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),i=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i},this.grayChannel=function(){var e=[.199,.687,.114];return e[0]*this.r+e[1]*this.g+e[2]*this.b},this.blackWhiteContrast=function(){return 150>this.grayChannel()?"white":"black"},this.darken=function(e){var t=TradingView.rgbToHsl(this.r,this.g,this.b);return e=TradingView.hslToRgb(t[0],t[1],t[2]-e/100),this.r=e[0],this.g=e[1],this.b=e[2],this.cleanupRGB(),this}}function PixelSet(e,t,i){this._rawData=e?e:Array(t*i*4),this._width=t,this._height=i}function ReadonlyWatchedValue(){}function WatchedValue(e){return this instanceof WatchedValue?(0<arguments.length&&(this._value=e),void(this._listeners=[])):new WatchedValue(e)}function HandlerInfo(e,t){this.handler=e,this.customId=t,this.requestHook=null}function W98(){}function ChartSession(e,t){this._chartApi=e,this._sessionid="cs_"+TradingView.randomHash(),this._sessionDisabled=!1,this._disableStatistics=!!t}function TimeIndexes(){this._zoffset=0,this._items=[],this._lastTimePointIndex=null}function PlotList(e){this._items=[],this._columns=e?e:[],this._end=this._start=0,this._shareread=!1}function StudyMetaInfo(e){TradingView.merge(this,{palettes:{},inputs:[],plots:[],graphics:{},defaults:{}}),TradingView.merge(this,e),TradingView.merge(this,StudyMetaInfo.parseIdString(e.id)),this.name=this.id}function HitTestResult(e,t,i){this._result=e,this._data=t,this._eraseMarker=i}function DataSource(){this._zorder=0,this.m_priceScale=null,this._id=TradingView.guid(),this._ownerSource=null,this._userEditEnabled=!0,this.hasAlert=new WatchedValue(!1)}function PriceDataSource(e){DataSource.call(this),this._isOverlay=null,this.D0=e}function Property(e){if(this._listeners=new Delegate,this._childs=[],void 0!==e&&null!==e)if(this.isPrimitiveType(e))this._value=e;else for(var t in e)this.addProperty(t,e[t])}function $52(e,t,i){this._defaultName=e,i?i=t:(i=TradingView.clone(defaults(e)),t&&TradingView.merge(i,t)),Property.call(this,i),this._defaultName=e,this.listeners().subscribe(this,$52.prototype.onPropertyChanged),this._exclusions=[]}function factoryDefaults(e){"undefined"==typeof defaultProperties&&(defaultProperties={chartproperties:{timezone:"UTC",timeScale:{barSpacing:DEFAULT_BAR_SPACING,rightOffset:DEFAULT_RIGHT_OFFSET},dataWindowProperties:{background:"#FFFECE",border:"#606090",font:"Verdana",fontBold:!1,fontItalic:!1,fontSize:10,transparency:80,visible:!0},paneProperties:{background:"#141414",gridProperties:{color:"#222",style:CanvasEx.LINESTYLE_SOLID},crossHairProperties:{color:"#B7B7B7",style:CanvasEx.LINESTYLE_DASHED,transparency:0,width:1},topMargin:5,bottomMargin:5,leftAxisProperties:{autoScale:!0,autoScaleDisabled:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1,showSymbolLabels:!1,alignLabels:!0},rightAxisProperties:{autoScale:!0,autoScaleDisabled:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1,showSymbolLabels:!1,alignLabels:!0},overlayPropreties:{autoScale:!0,autoScaleDisabled:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1,showSymbolLabels:!1,alignLabels:!0},legendProperties:{showStudyArguments:!0,showStudyTitles:!0,showStudyValues:!0,showSeriesTitle:!0,showSeriesOHLC:!0}},scalesProperties:{showLeftScale:!1,showRightScale:!0,backgroundColor:"#ffffff",lineColor:"#555",textColor:"#555",scaleSeriesOnly:!1,showSeriesLastValue:!0,showStudyLastValue:!1},mainSeriesProperties:{style:TradingView.Series.STYLE_CANDLES,esdShowDividends:!0,esdShowSplits:!0,esdShowEarnings:!0,esdShowBreaks:!1,esdBreaksStyle:{color:"#E2745B",style:CanvasEx.LINESTYLE_DASHED,width:1},esdFlagSize:2,showCountdown:!0,showInDataWindow:!0,visible:!0,silentIntervalChange:!1,showPriceLine:!0,priceLineWidth:1,lockScale:!1,minTick:"default",extendedHours:!1,sessVis:!1,candleStyle:{upColor:"#6ba583",downColor:"#d75442",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#225437",borderDownColor:"#5b1a13",wickColor:"#737375",barColorsOnPrevClose:!1},hollowCandleStyle:{upColor:"#6ba583",downColor:"#d75442",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#225437",borderDownColor:"#5b1a13",wickColor:"#737375"},haStyle:{upColor:"#6ba583",downColor:"#d75442",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#225437",borderDownColor:"#5b1a13",wickColor:"#737375",barColorsOnPrevClose:!1},barStyle:{upColor:"#6ba583",downColor:"#d75442",barColorsOnPrevClose:!1,dontDrawOpen:!1},lineStyle:{color:"#3C78D8",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,priceSource:"close",styleType:TradingView.Series.STYLE_LINE_TYPE_SIMPLE},areaStyle:{color1:"#606090",color2:"#01F6F5",linecolor:"#0094FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,priceSource:"close",transparency:50},priceAxisProperties:{autoScale:!0,autoScaleDisabled:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1},renkoStyle:{upColor:"#6ba583",downColor:"#d75442",borderUpColor:"#225437",borderDownColor:"#5b1a13",upColorProjection:"#4ad6be",downColorProjection:"#d649cf",borderUpColorProjection:"#225437",borderDownColorProjection:"#5b1a13",inputs:{source:"close",boxSize:3,style:"ATR",atrLength:14},inputInfo:{source:{name:"Source"},boxSize:{name:"Box size"},style:{name:"Style"},atrLength:{name:"ATR Length"}}},pbStyle:{upColor:"#6ba583",downColor:"#d75442",borderUpColor:"#225437",borderDownColor:"#5b1a13",upColorProjection:"#4ad6be",downColorProjection:"#d649cf",borderUpColorProjection:"#225437",borderDownColorProjection:"#5b1a13",inputs:{source:"close",lb:3},inputInfo:{source:{name:"Source"},lb:{name:"Number of line"}}},kagiStyle:{upColor:"#6ba583",downColor:"#d75442",upColorProjection:"#4ad6be",downColorProjection:"#d649cf",inputs:{source:"close",reversalAmount:1},inputInfo:{source:{name:"Source"},reversalAmount:{name:"Reversal amount"}}},pnfStyle:{upColor:"#6ba583",downColor:"#d75442",upColorProjection:"#4ad6be",downColorProjection:"#d649cf",inputs:{sources:"HL",reversalAmount:3,boxSize:1,style:"ATR",atrLength:14},inputInfo:{sources:{name:"Source"},boxSize:{name:"Box size"},reversalAmount:{name:"Reversal amount"},style:{name:"Style"},atrLength:{name:"ATR Length"}}}},symbolWatermarkProperties:{color:"#555",transparency:85},tradingProperties:{showPositions:!0,showOrders:!0,showExecutions:!0,extendLeft:!0,lineLength:5,lineWidth:1,lineStyle:CanvasEx.LINESTYLE_DASHED},alertsProperties:{labels:{visible:!0,color:"#d75442",highlightColor:"#ffff33",hoverColor:"#f5e387",line:{visible:!0,style:CanvasEx.LINESTYLE_DASHED,width:1}},fakeLabels:{visible:!0,color:"#777",line:{visible:!0,style:CanvasEx.LINESTYLE_DASHED,width:1}},drawingIcon:{color:"#AAA"}},editorFontsList:["Verdana","Courier New","Times New Roman","Arial"],volumePaneSize:"large"},drawings:{magnet:!1,stayInDrawingMode:!1,crossHairColor:"#B7B7B7",crossHairStyle:CanvasEx.LINESTYLE_DASHED,crossHairWidth:1},linetoolorder:{extendLeft:"inherit",lineLength:"inherit",lineColor:"#F00",lineTransparency:0,lineStyle:"inherit",lineWidth:"inherit",bodyBorderColor:"#F00",bodyBorderTransparency:0,bodyBackgroundColor:"#FFF",bodyBackgroundTransparency:25,bodyTextColor:"#F00",bodyTextTransparency:0,bodyFontFamily:"Verdana",bodyFontSize:7,bodyFontBold:!0,bodyFontItalic:!1,quantityBorderColor:"#F00",quantityBorderTransparency:0,quantityBackgroundColor:"#F00",quantityBackgroundTransparency:25,quantityTextColor:"#FFF",quantityTextTransparency:0,quantityFontFamily:"Verdana",quantityFontSize:7,quantityFontBold:!0,quantityFontItalic:!1,cancelButtonBorderColor:"#F00",cancelButtonBorderTransparency:0,cancelButtonBackgroundColor:"#FFF",cancelButtonBackgroundTransparency:25,cancelButtonIconColor:"#F00",cancelButtonIconTransparency:0,tooltip:""},linetoolposition:{extendLeft:"inherit",lineLength:"inherit",lineColor:"#0071E0",lineTransparency:0,lineStyle:"inherit",lineWidth:"inherit",bodyBorderColor:"#0071E0",bodyBorderTransparency:0,bodyBackgroundColor:"#FFF",bodyBackgroundTransparency:25,bodyTextColor:"#0071E0",bodyTextTransparency:0,bodyFontFamily:"Verdana",bodyFontSize:7,bodyFontBold:!0,bodyFontItalic:!1,quantityBorderColor:"#0071E0",quantityBorderTransparency:0,quantityBackgroundColor:"#0071E0",quantityBackgroundTransparency:25,quantityTextColor:"#FFF",quantityTextTransparency:0,quantityFontFamily:"Verdana",quantityFontSize:7,quantityFontBold:!0,quantityFontItalic:!1,reverseButtonBorderColor:"#0071E0",reverseButtonBorderTransparency:0,reverseButtonBackgroundColor:"#FFF",reverseButtonBackgroundTransparency:25,reverseButtonIconColor:"#0071E0",reverseButtonIconTransparency:0,closeButtonBorderColor:"#0071E0",closeButtonBorderTransparency:0,closeButtonBackgroundColor:"#FFF",closeButtonBackgroundTransparency:25,closeButtonIconColor:"#0071E0",closeButtonIconTransparency:0,tooltip:""},linetoolexecution:{direction:"buy",arrowHeight:8,arrowSpacing:1,arrowColor:"#00F",arrowTransparency:0,text:"",textColor:"#000",textTransparency:0,fontFamily:"Verdana",fontSize:8,fontBold:!1,fontItalic:!1,tooltip:""},linetoolicon:{clonable:!0,color:"#3D85C6",snapTo45Degrees:!0,size:40,icon:9786,angle:.5*Math.PI,scale:1},linetooltrendline:{clonable:!0,linecolor:"#159980",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_NORMAL,font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,snapTo45Degrees:!0,alwaysShowStats:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1},linetooltrendangle:{clonable:!0,linecolor:"#159980",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,snapTo45Degrees:!0,font:"Verdana",textcolor:"#157760",fontsize:12,bold:!0,italic:!1,alwaysShowStats:!1,showPriceRange:!1,showBarsRange:!1,extendRight:!1,extendLeft:!1},linetooldisjointangle:{clonable:!0,linecolor:"#129f5c",linewidth:2,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"#6AA84F",transparency:50,extendLeft:!1,extendRight:!1,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_NORMAL,font:"Verdana",textcolor:"#129f5c",fontsize:12,bold:!1,italic:!1,showPrices:!1,showPriceRange:!1,showDateTimeRange:!1,showBarsRange:!1},linetoolflatbottom:{clonable:!0,linecolor:"#4985e7",linewidth:2,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"#153899",transparency:50,extendLeft:!1,extendRight:!1,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_NORMAL,font:"Verdana",textcolor:"#4985e7",fontsize:12,bold:!1,italic:!1,showPrices:!1,showPriceRange:!1,showDateTimeRange:!1,showBarsRange:!1},linetoolfibspiral:{clonable:!0,linecolor:"#159980",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},linetooldaterange:{clonable:!0,linecolor:"#585858",linewidth:1,font:"Verdana",textcolor:"#FFFFFF",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",labelBackgroundTransparency:0,fillBackground:!0,backgroundColor:"#BADAFF",backgroundTransparency:60,drawBorder:!1,borderColor:"#667B8B"},linetoolpricerange:{clonable:!0,linecolor:"#585858",linewidth:1,font:"Verdana",textcolor:"#FFFFFF",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",labelBackgroundTransparency:0,fillBackground:!0,backgroundColor:"#BADAFF",backgroundTransparency:60,drawBorder:!1,borderColor:"#667B8B"},linetoolriskrewardshort:{isShort:!0,clonable:!0,linecolor:"#585858",linewidth:1,font:"Verdana",textcolor:"white",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",labelBackgroundTransparency:0,fillBackground:!0,stopBackground:"#FF0000",profitBackground:"#00A000",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"#667B8B"},linetoolriskrewardlong:{isShort:!1,clonable:!0,linecolor:"#585858",linewidth:1,font:"Verdana",textcolor:"white",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",labelBackgroundTransparency:0,fillBackground:!0,stopBackground:"#FF0000",profitBackground:"#00A000",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"#667B8B"},linetoolarrow:{clonable:!0,linecolor:"#6F88C6",linewidth:2,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_ARROW,font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,alwaysShowStats:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1},linetoolray:{clonable:!0,linecolor:"#159980",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!0,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_NORMAL,font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,alwaysShowStats:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1},linetoolextended:{clonable:!0,linecolor:"#159980",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!0,extendRight:!0,leftEnd:W47.LINEEND_NORMAL,rightEnd:W47.LINEEND_NORMAL,font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,alwaysShowStats:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1},linetoolhorzline:{clonable:!0,linecolor:"#80CCDB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showPrice:!0,showLabel:!1,text:"",font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,horzLabelsAlign:"center",vertLabelsAlign:"top"},linetoolhorzray:{clonable:!0,linecolor:"#80CCDB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showPrice:!0,showLabel:!1,text:"",font:"Verdana",textcolor:"#157760",fontsize:12,bold:!1,italic:!1,horzLabelsAlign:"center",vertLabelsAlign:"top"},linetoolvertline:{clonable:!0,linecolor:"#80CCDB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showTime:!0},linetoolcirclelines:{clonable:!0,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},linecolor:"#80CCDB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},linetoolfibtimezone:{horzLabelsAlign:"right",vertLabelsAlign:"bottom",clonable:!0,baselinecolor:"#808080",linecolor:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showLabels:!0,font:"Verdana",fillBackground:!1,transparency:80,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:0},level2:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level3:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2},level4:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3},level5:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:5},level6:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:8},level7:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:13},level8:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:21},level9:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:34},level10:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:55},level11:{visible:!0,color:"#0055DB",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:89}},linetooltext:{clonable:!0,color:"#667B8B",text:$.t("Text"),font:"Verdana",fontsize:20,fillBackground:!1,backgroundColor:"#9BBED5",backgroundTransparency:70,drawBorder:!1,borderColor:"#667B8B",bold:!1,italic:!1,locked:!1,fixedSize:!0,wordWrap:!1,wordWrapWidth:400},linetooltextabsolute:{clonable:!0,color:"#667B8B",text:$.t("Text"),font:"Verdana",fontsize:20,fillBackground:!1,backgroundColor:"#9BBED5",backgroundTransparency:70,drawBorder:!1,borderColor:"#667B8B",bold:!1,italic:!1,locked:!0,wordWrap:!1,wordWrapWidth:400},linetoolballoon:{clonable:!0,color:"#667b8b",backgroundColor:"#fffece",borderColor:"#8c8c8c",fontWeight:"bold",fontsize:12,font:"Arial",transparency:30,text:$.t("Comment")},linetoolbrush:{clonable:!0,linecolor:"#353535",linewidth:2,linestyle:CanvasEx.LINESTYLE_SOLID,smooth:5,fillBackground:!1,backgroundColor:"#153899",transparency:50},linetoolpolyline:{clonable:!0,linecolor:"#353535",linewidth:2,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"#153899",transparency:50,filled:!1},linetoolarrowmark:{clonable:!0,color:"#787878",text:"",fontsize:20,font:"Verdana"},linetoolarrowmarkleft:{clonable:!0,color:"#787878",text:"",fontsize:20,font:"Verdana"},linetoolarrowmarkup:{clonable:!0,color:"#787878",text:"",fontsize:20,font:"Verdana"},linetoolarrowmarkright:{clonable:!0,color:"#787878",text:"",fontsize:20,font:"Verdana"},linetoolarrowmarkdown:{clonable:!0,color:"#787878",text:"",fontsize:20,font:"Verdana"},linetoolflagmark:{clonable:!0,color:"#ff0000"},linetoolnote:{clonable:!0,markerColor:"#2E66FF",textColor:"#000000",backgroundColor:"#FFFFFF",backgroundTransparency:0,text:$.t("Text"),font:"Arial",fontSize:12,bold:!1,italic:!1,locked:!1,fixedSize:!0},linetoolnoteabsolute:{clonable:!0,markerColor:"#2E66FF",textColor:"#000000",backgroundColor:"#FFFFFF",backgroundTransparency:0,text:$.t("Text"),font:"Arial",fontSize:12,bold:!1,italic:!1,locked:!0,fixedSize:!0},linetoolthumbup:{clonable:!0,color:"#008000"},linetoolthumbdown:{clonable:!0,color:"#FF0000"},linetoolpricelabel:{clonable:!0,color:"#667b8b",backgroundColor:"#ffffff",borderColor:"#8c8c8c",fontWeight:"bold",fontsize:11,font:"Arial",transparency:30},linetoolrectangle:{clonable:!0,color:"#153899",fillBackground:!0,backgroundColor:"#153899",transparency:50,linewidth:1,snapTo45Degrees:!0},linetoolrotatedrectangle:{clonable:!0,color:"#9800ff",fillBackground:!0,backgroundColor:"#8e7cc3",transparency:50,linewidth:1,snapTo45Degrees:!0},linetoolellipse:{clonable:!0,color:"#999915",fillBackground:!0,backgroundColor:"#999915",transparency:50,linewidth:1},linetoolarc:{clonable:!0,color:"#999915",fillBackground:!0,backgroundColor:"#999915",transparency:50,linewidth:1},linetoolprediction:{linecolor:"#1c73db",linewidth:2,sourceBackColor:"#f1f1f1",sourceTextColor:"#6e6e6e",sourceStrokeColor:"#6e6e6e",targetStrokeColor:"#2fa8ff",targetBackColor:"#0b6fde",targetTextColor:"#ffffff",successBackground:"#36a02a",successTextColor:"#ffffff",failureBackground:"#e74545",failureTextColor:"#ffffff",intermediateBackColor:"#ead289",intermediateTextColor:"#6d4d22",transparency:10,centersColor:"#202020"},linetooltriangle:{clonable:!0,color:"#991515",fillBackground:!0,backgroundColor:"#991515",transparency:50,linewidth:1},linetoolcallout:{clonable:!0,color:"#FFFFFF",backgroundColor:"#991515",transparency:50,linewidth:2,fontsize:12,font:"Verdana",text:$.t("Text"),bordercolor:"#991515",bold:!1,italic:!1,wordWrap:!1,wordWrapWidth:400},linetoolparallelchannel:{clonable:!0,linecolor:"#773499",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,fillBackground:!0,backgroundColor:"#b4a7d6",transparency:50,showMidline:!1,midlinecolor:"#773499",midlinewidth:1,midlinestyle:CanvasEx.LINESTYLE_DASHED},linetoolelliottsubminuette:{clonable:!0,showWave:!0,color:"#3d85c6",wavesize:0,showBackground:!0},linetoolelliottminor:{clonable:!0,showWave:!0,color:"#ff9800",wavesize:3,showBackground:!0},linetoolelliottcircle:{clonable:!0,showWave:!0,color:"#6aa84f",wavesize:6,showBackground:!0},linetoolelliottminorretr:{clonable:!0,showWave:!0,color:"#a64d79",wavesize:0,showBackground:!0},linetoolelliottmajorretr:{clonable:!0,showWave:!0,color:"#bf9000",wavesize:1,showBackground:!0},linetoolbarspattern:{color:"#5091CC",clonable:!0,mode:TradingView.LineToolBarsPattern.BARS_MODE,mirrored:!1,flipped:!1},study:{inputs:{},styles:{},palettes:{},bands:{},area:{},graphics:{},showInDataWindow:!0,visible:!0,showStudyArguments:!0,precision:"default"},linetoolpitchfork:{clonable:!0,fillBackground:!0,transparency:80,style:TradingView.LineToolPitchfork.STYLE_ORIGINAL,median:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:{visible:!1,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.25},level1:{visible:!1,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level2:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level3:{visible:!1,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level4:{visible:!1,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.75},level5:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!1,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.5},level7:{visible:!1,color:"#990066",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.75},level8:{visible:!1,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2}},linetoolpitchfan:{clonable:!0,fillBackground:!0,transparency:80,median:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:{visible:!1,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.25},level1:{visible:!1,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level2:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level3:{visible:!1,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level4:{visible:!1,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.75},level5:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!1,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.5},level7:{visible:!1,color:"#990066",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.75},level8:{visible:!1,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2}},linetoolgannfan:{clonable:!0,showLabels:!0,font:"Verdana",fillBackground:!0,transparency:80,level1:{visible:!0,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:1,coeff2:8},level2:{visible:!0,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:1,coeff2:4},level3:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:1,coeff2:3},level4:{visible:!0,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:1,coeff2:2},level5:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:1,coeff2:1},level6:{visible:!0,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:2,coeff2:1},level7:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:3,coeff2:1},level8:{visible:!0,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:4,coeff2:1},level9:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff1:8,coeff2:1}},linetoolganncomplex:{clonable:!0,fillBackground:!1,arcsBackground:{fillBackground:!0,transparency:50},levels:[{width:1,color:"#808080",visible:!0},{width:1,color:"#A06B00",visible:!0},{width:1,color:"#699E00",visible:!0},{width:1,color:"#009B00",visible:!0},{width:1,color:"#009965",visible:!0},{width:1,color:"#808080",visible:!0}],fanlines:[{width:1,color:"#A500FF",visible:!1,x:8,y:1},{width:1,color:"#A50000",visible:!1,x:5,y:1},{width:1,color:"#808080",visible:!1,x:4,y:1},{width:1,color:"#A06B00",visible:!1,x:3,y:1},{width:1,color:"#699E00",visible:!0,x:2,y:1},{width:1,color:"#009B00",visible:!0,x:1,y:1},{width:1,color:"#009965",visible:!0,x:1,y:2},{width:1,color:"#009965",visible:!1,x:1,y:3},{width:1,color:"#000099",visible:!1,x:1,y:4},{width:1,color:"#660099",visible:!1,x:1,y:5},{width:1,color:"#A500FF",visible:!1,x:1,y:8}],arcs:[{width:1,color:"#A06B00",visible:!0,x:1,y:0},{width:1,color:"#A06B00",visible:!0,x:1,y:1},{width:1,color:"#A06B00",visible:!0,x:1.5,y:0},{width:1,color:"#699E00",visible:!0,x:2,y:0},{width:1,color:"#699E00",visible:!0,x:2,y:1},{width:1,color:"#009B00",visible:!0,x:3,y:0},{width:1,color:"#009B00",visible:!0,x:3,y:1},{width:1,color:"#009965",visible:!0,x:4,y:0},{width:1,color:"#009965",visible:!0,x:4,y:1},{width:1,color:"#000099",visible:!0,x:5,y:0},{width:1,color:"#000099",visible:!0,x:5,y:1}]},linetoolgannsquare:{clonable:!0,color:"#153899",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,font:"Verdana",showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,fillHorzBackground:!0,horzTransparency:80,fillVertBackground:!0,vertTransparency:80,hlevel1:{color:"#808080",coeff:0,visible:!0},hlevel2:{color:"#A06B00",coeff:.25,visible:!0},hlevel3:{color:"#699E00",coeff:.382,visible:!0},hlevel4:{color:"#009B00",coeff:.5,visible:!0},hlevel5:{color:"#009965",coeff:.618,visible:!0},hlevel6:{color:"#006599",coeff:.75,visible:!0},hlevel7:{color:"#808080",coeff:1,visible:!0},vlevel1:{color:"#808080",coeff:0,visible:!0},vlevel2:{color:"#A06B00",coeff:.25,visible:!0},vlevel3:{color:"#699E00",coeff:.382,visible:!0},vlevel4:{color:"#009B00",coeff:.5,visible:!0},vlevel5:{color:"#009965",coeff:.618,visible:!0},vlevel6:{color:"#006599",coeff:.75,visible:!0},vlevel7:{color:"#808080",coeff:1,visible:!0}},linetoolfibspeedresistancefan:{clonable:!0,fillBackground:!0,transparency:80,grid:{color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,visible:!0},linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,font:"Verdana",showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,snapTo45Degrees:!0,hlevel1:{color:"#808080",coeff:0,visible:!0},hlevel2:{color:"#A06B00",coeff:.25,visible:!0},hlevel3:{color:"#699E00",coeff:.382,visible:!0},hlevel4:{color:"#009B00",coeff:.5,visible:!0},hlevel5:{color:"#009965",coeff:.618,visible:!0},hlevel6:{color:"#006599",coeff:.75,visible:!0},hlevel7:{color:"#808080",coeff:1,visible:!0},vlevel1:{color:"#808080",coeff:0,visible:!0},vlevel2:{color:"#A06B00",coeff:.25,visible:!0},vlevel3:{color:"#699E00",coeff:.382,visible:!0},vlevel4:{color:"#009B00",coeff:.5,visible:!0},vlevel5:{color:"#009965",coeff:.618,visible:!0},vlevel6:{color:"#006599",coeff:.75,visible:!0},vlevel7:{color:"#808080",coeff:1,visible:!0}},linetoolfibretracement:{clonable:!0,showCoeffs:!0,showPrices:!0,font:"Verdana",fillBackground:!0,transparency:80,extendLines:!1,horzLabelsAlign:"left",vertLabelsAlign:"middle",reverse:!1,coeffsAsPercents:!1,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,
color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:0},level2:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level3:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level4:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level5:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level6:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level7:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level8:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level9:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level10:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236}},linetoolfibchannel:{clonable:!0,showCoeffs:!0,showPrices:!0,font:"Verdana",fillBackground:!0,transparency:80,extendLeft:!1,extendRight:!1,horzLabelsAlign:"left",vertLabelsAlign:"middle",reverse:!1,coeffsAsPercents:!1,level1:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:0},level2:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level3:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level4:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level5:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level6:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level7:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level8:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level9:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level10:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236}},linetoolprojection:{clonable:!0,showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,color1:"#008000",color2:"#FF0000",linewidth:1,trendline:{visible:!0,color:"#808080",linestyle:CanvasEx.LINESTYLE_SOLID},level1:{color:"#808080",visible:!0,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1}},linetool5pointspattern:{clonable:!0,color:"#CC2895",textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:"#CC2895",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:50,linewidth:1},linetooltrianglepattern:{clonable:!0,color:"#9528FF",textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:"#9528CC",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:50,linewidth:1},linetoolabcd:{clonable:!0,color:"#009B00",textcolor:"#FFFFFF",font:"Verdana",fontsize:12,bold:!1,italic:!1,linewidth:2},linetoolthreedrivers:{clonable:!0,color:"#9528FF",textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:"#9528CC",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:50,linewidth:2},linetoolheadandshoulders:{clonable:!0,color:"#45682F",textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:"#45A82F",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:50,linewidth:2},linetoolfibwedge:{clonable:!0,showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level1:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level2:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level3:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level4:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level5:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level6:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level7:{visible:!1,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level8:{visible:!1,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level9:{visible:!1,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level10:{visible:!1,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236},level11:{visible:!1,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.618}},linetoolfibcircles:{clonable:!0,showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,snapTo45Degrees:!0,coeffsAsPercents:!1,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level2:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level3:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level4:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level5:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level6:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level7:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level8:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level9:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level10:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.618}},linetoolfibspeedresistancearcs:{clonable:!0,showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level2:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level3:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level4:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level5:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level6:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level7:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level8:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level9:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level10:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.618}},linetooltrendbasedfibextension:{clonable:!0,showCoeffs:!0,showPrices:!0,font:"Verdana",fillBackground:!0,transparency:80,extendLines:!1,horzLabelsAlign:"left",vertLabelsAlign:"middle",reverse:!1,coeffsAsPercents:!1,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:0},level2:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.236},level3:{visible:!0,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level4:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level5:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level6:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.764},level7:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level8:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level9:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level10:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3.618},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:4.236}},linetooltrendbasedfibtime:{clonable:!0,showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,horzLabelsAlign:"right",vertLabelsAlign:"bottom",trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:0},level2:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level3:{visible:!1,color:"#95CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level4:{visible:!0,color:"#28CC28",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level5:{visible:!0,color:"#28CC95",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!0,color:"#2895CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.382},level7:{visible:!0,color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.618},level8:{visible:!0,color:"#2828CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2},level9:{visible:!0,color:"#CC2828",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.382},level10:{visible:!0,color:"#9528CC",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2.618},level11:{visible:!0,color:"#CC2895",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:3}},linetoolschiffpitchfork:{clonable:!0,fillBackground:!0,transparency:80,style:TradingView.LineToolPitchfork.STYLE_SCHIFF,median:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:{visible:!1,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.25},level1:{visible:!1,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level2:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level3:{visible:!1,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level4:{visible:!1,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.75},level5:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!1,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.5},level7:{visible:!1,color:"#990066",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.75},level8:{visible:!1,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2}},linetoolschiffpitchfork2:{clonable:!0,fillBackground:!0,transparency:80,style:TradingView.LineToolPitchfork.STYLE_SCHIFF2,median:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:{visible:!1,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.25},level1:{visible:!1,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level2:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level3:{visible:!1,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level4:{visible:!1,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.75},level5:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!1,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.5},level7:{visible:!1,color:"#990066",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.75},level8:{visible:!1,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2}},linetoolinsidepitchfork:{clonable:!0,fillBackground:!0,transparency:80,style:TradingView.LineToolPitchfork.STYLE_INSIDE,median:{visible:!0,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:{visible:!1,color:"#A06B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.25},level1:{visible:!1,color:"#699E00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.382},level2:{visible:!0,color:"#009B00",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.5},level3:{visible:!1,color:"#009965",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.618},level4:{visible:!1,color:"#006599",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:.75},level5:{visible:!0,color:"#000099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1},level6:{visible:!1,color:"#660099",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.5},level7:{visible:!1,color:"#990066",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:1.75},level8:{visible:!1,color:"#A50000",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,coeff:2}},linetool:{frozen:!1,visible:!0}},applyDefaultsOverrides(defaultProperties.chartproperties)),"undefined"==typeof defaultProperties["study_MA@tv-basicstudies"]&&(defaultProperties["study_MA@tv-basicstudies"]={description:"Moving Average",shortDescription:"MA",inputs:{length:9,source:"close"},styles:{MovAvg:{visible:!0,color:"#0496FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,title:"MA"}}}),"undefined"==typeof defaultProperties["study_ErrorOnUpdate@tv-basicstudies"]&&(defaultProperties["study_ErrorOnUpdate@tv-basicstudies"]={description:"Error On Update",styles:{ErrorOnUpdate:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0}}}),"undefined"==typeof defaultProperties["study_ErrorOnCreate@tv-basicstudies"]&&(defaultProperties["study_ErrorOnCreate@tv-basicstudies"]={description:"Error On Create",styles:{ErrorOnUpdate:{visible:!0,color:"#00ff00",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0}}}),"undefined"==typeof defaultProperties["study_ErrorOnNewBar@tv-basicstudies"]&&(defaultProperties["study_ErrorOnNewBar@tv-basicstudies"]={description:"Error On New Bar",styles:{ErrorOnUpdate:{visible:!0,color:"#0000ff",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0}}}),"undefined"==typeof defaultProperties["study_PivotPointsHighLow@tv-basicstudies"]&&(defaultProperties["study_PivotPointsHighLow@tv-basicstudies"]={font:"Arial",fontsize:10,borderColor:"#538F1F",backColor:"#F0FFCC",textColor:"#000000"}),"undefined"==typeof defaultProperties["study_PivotPointsStandard@tv-basicstudies"]&&(defaultProperties["study_PivotPointsStandard@tv-basicstudies"]={_hardCodedDefaultsVersion:1,font:"Arial",fontsize:11,levelsStyle:{showLabels:!0,visibility:{P:!0,"S1/R1":!0,"S2/R2":!0,"S3/R3":!0,"S4/R4":!0,"S5/R5":!0},colors:{P:"#D47928","S1/R1":"#D47928","S2/R2":"#D47928","S3/R3":"#D47928","S4/R4":"#D47928","S5/R5":"#D47928"},widths:{P:1,"S1/R1":1,"S2/R2":1,"S3/R3":1,"S4/R4":1,"S5/R5":1}}}),"undefined"==typeof defaultProperties["study_ZigZag@tv-basicstudies"]&&(defaultProperties["study_ZigZag@tv-basicstudies"]={color:"#56871D",linewidth:2}),"undefined"==typeof defaultProperties["study_ElliottWave@tv-basicstudies"]&&(defaultProperties["study_ElliottWave@tv-basicstudies"]={inputs:{},level0:{visible:!1,color:"#ff0000"},level1:{visible:!1,color:"#008000"},level2:{visible:!1,color:"#0000ff"},level3:{visible:!1,color:"#ff00ff"},level4:{visible:!0,color:"#0080ff"},level5:{visible:!0,color:"#ff0000"},level6:{visible:!0,color:"#008000"},level7:{visible:!0,color:"#0000ff"},level8:{visible:!0,color:"#ff00ff"}}),"undefined"==typeof defaultProperties["study_LinearRegression@tv-basicstudies"]&&(defaultProperties["study_LinearRegression@tv-basicstudies"]={styles:{upLine:{visible:!0,color:"#0000ff",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},downLine:{visible:!0,color:"#0000ff",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},baseLine:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},extendLines:!0,showPearsons:!0,backgroundColor:"#991515",transparency:70}}),"undefined"==typeof defaultProperties["study_RegressionTrend@tv-basicstudies"]&&(defaultProperties["study_RegressionTrend@tv-basicstudies"]={linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,styles:{upLine:{visible:!0,color:"#0000FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},downLine:{visible:!0,color:"#0000FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},baseLine:{visible:!0,color:"#FF0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},extendLines:!1,showPearsons:!0,transparency:70}}),"undefined"==typeof defaultProperties["study_Compare@tv-basicstudies"]&&(defaultProperties["study_Compare@tv-basicstudies"]={minTick:"default"}),"undefined"==typeof defaultProperties["study_Overlay@tv-basicstudies"]&&(defaultProperties["study_Overlay@tv-basicstudies"]={style:TradingView.Series.STYLE_BARS,showPriceLine:!1,minTick:"default",candleStyle:{upColor:"#6ba583",downColor:"#d75442",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#225437",borderDownColor:"#5b1a13",wickColor:"#737375",barColorsOnPrevClose:!1},hollowCandleStyle:{upColor:"#6ba583",downColor:"#d75442",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#225437",borderDownColor:"#5b1a13",wickColor:"#737375",barColorsOnPrevClose:!1},barStyle:{upColor:"#6ba583",downColor:"#d75442",barColorsOnPrevClose:!1,dontDrawOpen:!1},lineStyle:{color:"#0303F7",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,priceSource:"close",styleType:TradingView.Series.STYLE_LINE_TYPE_SIMPLE},areaStyle:{color1:"#606090",color2:"#01F6F5",linecolor:"#0094FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,priceSource:"close",transparency:50},styles:{open:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,title:"open"},high:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,title:"high"},low:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,title:"low"},close:{visible:!0,color:"#ff0000",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,title:"close"}}}),e=e.split(".");for(var t=defaultProperties,i=0;i<e.length;i++)t&&(t=t[e[i]]);return t?TradingView.clone(t):{}}function applyDefaultsOverrides(e,t,i){function n(e,i,o){var r=i.split(".");if(i=r[0],t&&t[i]&&(i=t[i]),!e.hasOwnProperty(i))throw"illegal path";1<r.length?(r=r.splice(1).join("."),n(e[i],r,o)):e[i]&&e[i].serValue?e[i].setValue(o):e[i]=o}if("undefined"!=typeof __defaultsOverrides&&__defaultsOverrides)for(var o in __defaultsOverrides)try{n(e,o,__defaultsOverrides[o])}catch(r){"undefined"!=typeof i&&i||console.warn("Path `"+o+"` does not exist.")}}function defaults(e,t){return t?_defaultsUpdated(e,t):_defaultsAsIs(e)}function _defaultsAsIs(e){var t=factoryDefaults(e);return window._UNIT_TESTS||(e=TradingView.clone(TVSettings.getJSON(e,null)),TradingView.merge(t,e)),t}function _defaultsUpdated(e,t){var i=factoryDefaults(e);if(!window._UNIT_TESTS){var n=TradingView.clone(TVSettings.getJSON(e,null));e.startsWith("study_")&&n&&A0.isVersionHead(n.version)&&(n=t.updateStudyState(n,n)),TradingView.merge(i,n)}return i}function saveDefaults(e,t){TVSettings.setJSON(e,t)}function PriceFormatter(e,t,i,n){if(t||(t=1),isInteger(e)||(e=100),0>e)throw new TypeError("invalid base");this._priceScale=e,this._minMove=t,this._minMove2=n,n>0&&2!==n&&4!==n?TradingView.logDebug("invalid minmove2"):(this._fractional=i,this.calculateDecimal())}function numberToStringWithLeadingZero(e,t){if(!isNumber(e))return"n/a";if(!isInteger(t))throw new TypeError("invalid length");if(0>t||t>16)throw new TypeError("invalid length");return 0===t?e.toString():("0000000000000000"+e.toString()).right(t)}function PercentageFormatter(){PriceFormatter.call(this,100)}function DateFormatter(){}function TimeFormatter(e){this._format_str=e||"%h:%m:%s"}function DateTimeFormatter(e){this._dwm=e}function VolumeFormatter(e){this._precision=e,this._fractionalValues=e>0}function TimeSpanFormatter(){}function PriceColorer(){this._prev=null}function FormattedLabelsCache(e,t){this._formatter=e,this._maxSize=t||50,this._actualSize=0,this._cache={},this._oldestTick=this._usageTick=1,this._tick2Labels={}}function AbstractBarColorer(){this.backColorers=[]}function SeriesBarColorer(e){AbstractBarColorer.call(this),this._series=e}function StudyBarColorer(e,t){AbstractBarColorer.call(this),this.D1=e,this._plotIndex=t}function BarItem(){this.close=this.low=this.high=this.open=this.time=0}function BarsRange(e,t){null===e||isInteger(e)?null===t||isInteger(t)?(this.m_firstBar=e,this.m_lastBar=t):TradingView.logDebug("BarsRange: incorrect lastBar"):TradingView.logDebug("BarsRange: incorrect firstBar")}function SetChartLayoutCommand(e,t){UndoCommand.call(this,"Change Chart Layout to "+A8.LayoutTemplates[t].title),this.D5=e,this._newLayoutId=t,this._oldLayoutId=e.layout.value()}function W78(e,t,i,n,o,r,s,a){this.D4=a,this.m_model=new W79(e,t,i,n,o,r,s,this),this.m_undoStack=new UndoStack,this.m_redoStack=new UndoStack,this.m_zoomStack=new UndoStack,this._onSimpleZoomIn=new Delegate,this._onSimpleZoomOut=new Delegate}function UndoCommand(e){this._text=e}function UndoStack(){this.m_commands=new List,this.m_commands.setValidator(new TypeValidator(UndoCommand)),this._onChange=new Delegate}function UndoMacroCommand(e){UndoCommand.call(this,e),this._subcommands=new List}function SetPropertyCommand(e,t,i,n){UndoCommand.call(this,i),this._targetObj=e,this._newValue=t,this.D0=n}function SetAutoScalePropertyCommand(e,t,i,n,o){UndoCommand.call(this,n),this._property=e,this._priceScale=i,this._newValue=t,this.D0=o}function SetPercentagePropertyCommand(e,t,i,n,o){UndoCommand.call(this,n),this._percentage=e,this._priceScale=i,this._newValue=t,this.D0=o}function SetLogPropertyCommand(e,t,i,n,o){UndoCommand.call(this,n),this._log=e,this._priceScale=i,this._newValue=t,this.D0=o}function SetChartStyleCommand(e,t,i,n,o,r){UndoCommand.call(this,n),this._style=e,this._mainSeries=i,this._priceAxisProperties=i.properties().priceAxisProperties,this._newValue=t,this.D0=o,this.D4=r}function SetLockScaleCommand(e,t,i,n,o){UndoCommand.call(this,n),this._property=e,this._mainSeries=i,this._priceAxisProperties=i.properties().priceAxisProperties,this._newValue=t,this.D0=o}function RemoveSourceCommand(e,t){this.D0=e,this.W99=t}function W88(e,t,i,n,o){this.D0=e,this.W99=t,this._scale=o,this._sources=new List,this._sources.append(t),this._sources.appendAll(this.D0.children(t)),this._oldPane=i,this._oldPaneIndex=e.panes().indexOf(i),this._oldPaneState=this._oldPane.state(),this._oldScaleName=i.priceScaleName(t.priceScale()),this._pane=n,this._samePane=this._pane===this._oldPane}function W83(e,t,i,n){UndoCommand.call(this,"Create line "+t.toolname),this.D0=e,this._line=t,this._paneIndex=e.panes().indexOf(i),this._points=new List,this._points.append({point:n})}function W80(e,t,i,n){this.D0=e,this.W99=t,this._nextState=this._prevState=t.state(!0)}function W87(e,t,i,n){this.D0=e,this.W99=t,this._origPoint=i instanceof MathEx.Point?i.clone():TradingView.clone(i),this._pointIndex=n}function ChangeZOrderCommand(e,t,i){UndoCommand.call(this,"Change "+t.title()+" Z order"),this.D0=e,this.W99=t,this._shift=i}function SendToBackCommand(e,t){UndoCommand.call(this,"Change "+t.title()+" Z order"),this.D0=e,this.W99=t}function BringToFrontCommand(e,t){UndoCommand.call(this,"Change "+t.title()+" Z order"),this.D0=e,this.W99=t}function RemovePaneCommand(e,t,i){UndoCommand.call(this,"Remove pane"),this.D0=e,this._index=t,this._pane=this.D0.panes().item(t),this._chart=i}function RearrangePanesCommand(e,t,i,n){UndoCommand.call(this,"Rearrange panes"),this.D0=e,this._index=t,this._direction=i,this._chart=n}function ZoomCommand(e,t,i,n,o,r){this.D0=e,this._startBar=t,this._endBar=i,this._startPrice=n,this._endPrice=o,this._pane=r}function W95(e,t,i){this._baseCmd=e,this._zoomStack=t,this._inOut=i}function W91(e,t,i,n,o){this.D0=e,this._paneA=t,this._paneB=i,this._prevStretchA=n,this._currStretchA=o}function W90(e,t){UndoCommand.call(this,"Restore Defaults"),this.D0=e,this._defaultProperty=t,this._state=t.state(t._exclusions)}function W81(e,t){UndoCommand.call(this,"Apply Chart Theme"),this.D0=e,this._newChartProps=t.chartProperties,this._newSeriesProps=t.mainSourceProperties,this._newChartProps.symbolWatermarkProperties||(this._newChartProps.symbolWatermarkProperties=defaults("chartproperties.symbolWatermarkProperties"),this._newChartProps.symbolWatermarkProperties.color=this._newChartProps.scalesProperties.textColor),this._oldChartProps=e.properties().state(),delete this._oldChartProps.paneProperties.topMargin,delete this._oldChartProps.paneProperties.bottomMargin,this._oldSeriesProps=e.properties().state().mainSeriesProperties}function W84(e,t){UndoCommand.call(this,"Apply Drawing Template"),this.W99=e,this._oldProps=e.properties().state(),this._newProps=t}function W93(e,t,i,n){UndoCommand.call(this,(" "+n||"")+" Study template"),this.D0=e,this._oldProps=t,this._newProps=i}function SetPriceScaleMarginsCommand(e,t,i,n,o){this.D0=e,this._pane=t,this._priceScale=i,this._topMargin=n,this._bottomMargin=o,this._oldTopMargin=i.topMargin(),this._oldBottomMargin=i.bottomMargin()}function W85(e,t){this.D0=e,this._range=t}function W92(e,t,i,n,o){UndoCommand.call(this,e),this._property=t,this._value=i,this._forceSetProperty=o,this._prevValue=t.value(),this._cw=n}function W82(e,t){UndoCommand.call(this,"clone "+t.title()),this.D0=e,this.W99=t,this._points=new List}function SetWatchedValueCommand(e,t,i){UndoCommand.call(this,i),this._wv=e,this._newValue=t,this._oldValue=e.value()}function W79(e,t,i,n,o,r,s,a){this._version=W79.version,this._readOnly=n,this._undoModel=a,this._studiesMetaData=r,this._studyVersioning=new A0(this._studiesMetaData,s),this.m_timeScale=new W49(this,i.timeScale),this.m_panes=new List,this.m_gridSource=new Grid,this.m_crossHairSource=new CrossHair(this,TradingView.drawingState.properties()),this.m_width=0,this._tagsChanged=new Delegate,this.D2=i,this._lineCancelled=new Delegate,this._magnet=new A47(TradingView.drawingState.properties().magnet,this.m_timeScale,i.paneProperties.magnetSensivity),this._alertsList=new List;var l=new $52("chartproperties.mainSeriesProperties");l.addExclusion("lockScale"),l.addExclusion("minTick"),l.addExclusion("priceAxisProperties.percentage"),l.addExclusion("priceAxisProperties.log"),this.createPane(void 0,!1,{rightAxisProperties:l.priceAxisProperties.state(["autoScale"])}),this.m_panes.item(0)._stretchFactor=2*W75.DEFAULT_STRETCH_FACTOR,this.m_panes.item(0)._isMainPane=!0,this.m_selectedSource=null,this._selectedSourceChanged=new Delegate,this._chartApi=e,this._invalidateHandler=t,this.m_hoveredSource=null,this.D2.listeners().subscribe(this,W79.prototype.propertyChangeHandler);var d=this;this.D2.timezone.listeners().subscribe(null,function(){d._chartApi&&d._chartApi.connected()&&d._chartApi.switchTimezone(d.timezone())}),this.D2.timeScale.rightOffset.listeners().subscribe(null,function(){d.m_timeScale.setOffset(d.D2.timeScale.rightOffset.value()),d.recalculateAllPanes()}),l.merge(i.mainSeriesProperties.state()),this.m_mainSeries=new TradingView.Series(this,l,o),this.panes().item(0).addDataSource(this.m_mainSeries,this.panes().item(0).rightPriceScale()),this.m_mainSeries.onCompleted().subscribe(this,function(){d.clearCurrentPosition()}),n||(l.addChild("priceAxisProperties",this.m_mainSeries.m_priceScale.properties()),l.lockScale.listeners().subscribe(this,function(e){(e=e.value())&&(l.priceAxisProperties.percentage.setValue(!1),l.priceAxisProperties.logDisabled.setValue(!1)),l.priceAxisProperties.percentageDisabled.setValue(e),l.priceAxisProperties.logDisabled.setValue(e)}),this.D2.paneProperties.legendProperties.showStudyTitles.listeners().subscribe(this,function(e){e.value()||this.D2.paneProperties.legendProperties.showStudyArguments.setValue(!1)})),this._barsMarksSources=[],e=W77.enabled("charting_library")?new UserDefinedBarsMarks(this):new PublishedChartsTimeline(this),e.setOwnerSource(this.m_mainSeries),this._barsMarksSources.push(e),this.m_watermarkSource=new Watermark(this.m_mainSeries);var h=this._undoModel.D4;TradingView.D18("alerts")&&!this.readOnly()&&!h.onWidget()&&TradingView.alertsDispatcher&&(this._alertsList.setValidator(new PredicateValidator(function(e){return e instanceof TradingView.Alert?e.fake()||e===TradingView.alertsDispatcher.stash.getAlert(e.id())?!0:(console.error("[Alerts] item need to be fake or in alertsDispatcher stash"),!1):(console.error("[Alerts] item should be instance of TradingView.Alert"),!1)})),this._alertsList.onAdd=new Delegate,this._alertsList.onRemove=new Delegate,this._alertsList.onChange=new Delegate,this._alertsList.onAdd.subscribe(this,function(e){function t(t){if(t){var n=t.rightPriceScale()||t.leftPriceScale();n&&t.addDataSource(new TradingView.AlertLabel(i,e),n)}}var i=this;if(e.isOHLC())t(i.paneForSource(i.m_mainSeries));else for(var n=i.m_panes.size()-1;n>=0;n--)t(i.m_panes.item(n));h.update(),i._alertsList.onChange.fire()}),this._alertsList.onRemove.subscribe(this,function(e){for(var t=this.m_panes.size()-1;t>=0;t--){var i=this.m_panes.item(t),n=i.D19().find(function(t){return t.alert&&t.alert()&&t.alert().id()===e.id()});n&&i.removeDataSource&&i.removeDataSource(n)}h.update(),this._alertsList.onChange.fire()}),this._prepareAlertsList()),this._oldEndVisibleIndex=this._oldStartVisibleIndex=-1,this._currentTool="",TradingView.drawingState.hideAllDrawings().subscribe(this,W79.prototype.visibilityChangeHandler)}function DataWindowItem(e,t){this.m_title=e,this.m_value=t,this._visible=!0,this._color=void 0}function DataWindowView(){this._title=this._header="",this._items=new List}function StatusView(e){this._props=e,this._text="",this._size="12px",this._bold=!1}function PriceAxisView(){this._text="",this._background="#585858",this._coordinate=0}function PriceAxisViewRenderer(e,t){this._data=e,this._data.borderColor||(this._data.borderColor=this._data.background),this._textWidthCache=t}function TimeAxisView(){this._text="",this._background="#585858",this._coordinate=0}function TimeAxisViewRenderer(e){this._data=e}function CrossHair(e,t){var i=this;DataSource.call(this),this.D2=t,this.D0=e,this._dataWindowView=new CrossHairDataWindowView(this,e),this._priceAxisView=new CrossHairPriceAxisView(this,e),this._startMeasurePriceAxisView=new CrossHairPriceAxisView(this,e,"measureStartY"),this._endMeasurePriceAxisView=new CrossHairPriceAxisView(this,e,"measureEndY"),this._timeAxisView=new CrossHairTimeAxisView(this,e),this._startMeasureTimeAxisView=new CrossHairTimeAxisView(this,e,"measureStartX"),this._endMeasureTimeAxisView=new CrossHairTimeAxisView(this,e,"measureEndX"),this.visible=!0,e.readOnly()?this.areLinesVisible=!0:TradingView.drawingState.cursorTool.subscribe(function(e){i.areLinesVisible="arrow"!==e},{callWithLast:!0}),this._subscribed=!1}function $64(e,t){this.W99=e,this._pane=t,this._rendererCache={}}function $65(e,t,i){this.source=e,this.pane=t,this._horzVisible=i}function W62(e){this.data=e}function CrossHairPriceAxisView(e,t){this._crossHair=e,this.D0=t,this._rendererData={background:"#585858",color:"white",textHeight:14,visible:!0},this._defaultFormatter=new PriceFormatter(100)}function CrossHairTimeAxisView(e,t){TimeAxisView.call(this),this._crosshair=e,this.D0=t,this._rendererData={visible:!1,background:"#585858",color:"white",textHeight:14,text:""}}function CrossHairDataWindowView(e,t){DataWindowView.call(this),this._header=null,this._crossHair=e,this.D0=t,this._items.append(new DataWindowItem("Date","")),this._items.append(new DataWindowItem("Time","")),this._items.append(new DataWindowItem("Price","")),this._defaultFormatter=new PriceFormatter(100)}function MAMetaInfo(){return new StudyMetaInfo({
id:"MASimple",inputs:[{id:"length",type:"integer",defval:10},{id:"source",type:"text",defval:"close"}],plots:[{id:"MovAvg",type:"line"}],properties:[{id:"is_price_study",type:"bool",value:"true"}],palettes:{}})}function VolumeMetaInfo(){return new StudyMetaInfo({id:"Volume",inputs:[],plots:[{id:"Volume",type:"histogram"},{id:"Color",type:"colorer",palette:"volumePalette",target:"Volume"}],properties:[{id:"is_price_study",type:"bool",value:"false"}],palettes:{volumePalette:{colors:{0:{color:"#007F0E",width:1,style:CanvasEx.LINESTYLE_SOLID,name:"Up Volume"},1:{color:"#872323",width:1,style:CanvasEx.LINESTYLE_SOLID,name:"Down Volume"}}}}})}function DMMetaInfo(){return new StudyMetaInfo({id:"DM",inputs:[{id:"ADX smoothing",max:50,min:1,type:"integer",defval:14},{id:"DI Length",max:500,min:1,type:"integer",defval:14}],plots:[{id:"ADX",type:"line"},{id:"DI_P",type:"line"},{id:"DI_N",type:"line"}],properties:[{id:"is_price_study",type:"bool",value:"false"}],palettes:{}})}function RSIMetaInfo(){return new StudyMetaInfo({id:"RSI",inputs:[{id:"length",type:"integer",defval:14}],plots:[{id:"RelativeStrengthIndex",type:"line"}],properties:[{id:"is_price_study",type:"bool",value:"false"}],palettes:{}})}function makeDefaultChartModel(e,t,i,n,o,r,s,a){return e=new W78(e,t,i,n,o,r,s,a),e.model().D20(new A22(A22.FULL_UPDATE)),e}function Grid(){this.horzLinesVisible=this.visible=!0,this.horzLinesColor="white",this.horzLinesStyle="",this.vertLinesVisible=!0,this.vertLinesColor="white",this.vertLinesStyle=""}function $83(e,t){this.source=e,this.pane=t}function W65(e){this.data=e}function Watermark(e){function t(){var t=i.width(),n=i.height();return{draw:function(i){var s=e.symbolInfo();if(s){i.fillStyle=r.color.value();var a=(100-r.transparency.value())/100;if(0!==a){i.globalAlpha=a;for(var s=[{text:s.name?s.name+", "+translatedIntervalString(e.interval()):"",font:"96px Verdana, Arial, sans-serif",lineHeight:114,baselineOffset:87},{text:s.description||"",font:"48px Verdana, Arial, sans-serif",lineHeight:57,baselineOffset:43.5}],l=a=0;l<s.length;l++){var d=s[l];if(d.text){i.font=d.font;var h=i,c=d.text,p=h.font;o.hasOwnProperty(p)||(o[p]={}),textWidth=o[p].hasOwnProperty(c)?o[p][c]:o[p][c]=h.measureText(c).width,textWidth>t?(d.zoom=t/textWidth,textWidth=t):d.zoom=1,d.offsetLeft=(t-textWidth)/2,a+=d.lineHeight*d.zoom}}for(a=Math.max((n-a)/2,0),l=0;l<s.length;l++)d=s[l],d.text&&(i.save(),i.font=d.font,i.translate(d.offsetLeft,a),i.scale(d.zoom,d.zoom),i.fillText(d.text,0,d.baselineOffset),i.restore(),a+=d.lineHeight*d.zoom)}}}}}var i=null,n=new Function,o={},r=e.model().properties().symbolWatermarkProperties;this.paneViews=function(e){return e.containsMainSeries()?(i=e,(new List).append({renderer:t,update:n})):new List}}function Legend(){this.m_items=new List}function LegendItem(e,t){this.m_title=t,this.m_color="white",this.m_dataSource=e}function W75(e,t,i){var n=this;this.m_timeScale=e,e=t.rightAxisProperties.state(),e.autoScale=!0,this.m_rightPriceScale=new W76(new Property(e)),this.m_rightPriceScale.properties().percentage.listeners().subscribe(null,function(){n._needRecalc=!0,n._recalculateImpl(),i.D20(new A22(A22.LIGHT_UPDATE))}),this.m_rightPriceScale.properties().log.listeners().subscribe(null,function(){n._needRecalc=!0,n._recalculateImpl(),i.D20(new A22(A22.LIGHT_UPDATE))}),e=t.leftAxisProperties.state(),e.autoScale=!0,this.m_leftPriceScale=new W76(new Property(e)),this.m_leftPriceScale.properties().log.listeners().subscribe(null,function(){n._needRecalc=!0,n._recalculateImpl(),i.D20(new A22(A22.LIGHT_UPDATE))}),this.m_leftPriceScale.properties().percentage.listeners().subscribe(null,function(){n._needRecalc=!0,n._recalculateImpl(),i.D20(new A22(A22.LIGHT_UPDATE))}),this.m_dataSources=new List,this.m_legend=new Legend,this.m_width=this.m_height=0,this.m_mainDataSource=null,this.D2=t,this.D0=i,this._tagsChanged=new Delegate,t.topMargin.listeners().subscribe(this,W75.prototype._updateMargins),t.bottomMargin.listeners().subscribe(this,W75.prototype._updateMargins),this._updateMargins(),this._stretchFactor=W75.DEFAULT_STRETCH_FACTOR}function optimalBarWidth(e){return.3*e}function selectionTolerance(e){return 2+.5*e}function paneRendererCoordinateIsValid(e){return null!==e&&void 0!==e&&!isNaN(e)}function W56(e){this.bars=e.bars,this.barSpacing=e.barSpacing,this.barWidth=optimalBarWidth(e.barSpacing),this.barLineWidth=Math.max(1,Math.round(this.barWidth)),this.dontDrawOpen=e.dontDrawOpen}function W70(e){this.bars=e.bars,this.barWidth=e.barWidth,this.barLineWidth=1}function W67(e){this.bars=e.bars,this.barSpacing=e.barSpacing,this.barLineWidth=Math.max(1,optimalBarWidth(e.barSpacing))}function W69(e){this.bars=e.bars,this.barSpacing=e.barSpacing,this.blockSize=e.blockSize,this.barWidth=e.barSpacing}function W66(e){this.items=e.items,this.barSpacing=e.barSpacing,this.histogramBase=e.histogramBase,this.lineColor=e.lineColor,this.lineWidth=e.lineWidth}function W60(e){this.items=e.items,this.barSpacing=e.barSpacing,this.histogramBase=e.histogramBase,this.lineColor=e.lineColor,this.lineWidth=e.lineWidth}function W68(e){this.items=e.items,this._simpleMode=e.simpleMode,this.barSpacing=e.barSpacing,this.lineColor=e.lineColor,this.lineWidth=e.lineWidth,this.lineStyle=e.lineStyle,this.withMarkers=e.withMarkers,this.withSteps=e.withSteps,this.hittest=e.hittest,this.ignorePaletteLineWidth=e.ignorePaletteLineWidth,this.forceLineColor=!!e.forceLineColor}function W53(e){e.forceLineColor=!0,W68.call(this,e),this.color1=e.color1,this.color2=e.color2,this.bottom=e.bottom,this._simpleMode=e.simpleMode}function W57(e){this._data=e,this._barWidth=optimalBarWidth(e.barSpacing),this._barBorderWidth=1}function W61(e){this.items=e.items,this.barSpacing=e.barSpacing,this.lineColor=e.lineColor,this.lineWidth=e.lineWidth,this.lineStyle=e.lineStyle}function W58(e){this.items=e.items,this.barSpacing=e.barSpacing,this.lineColor=e.lineColor||e.color,this.radius=e.lineWidth||e.height/2,this.vertOffset=e.vertOffset||0}function PaneRendererArrowsUpDownItem(e,t,i,n){this.x=e,this.y=t,this.height=i,this.isUp=n}function W54(e){this.items=e.items,this.barSpacing=e.barSpacing,this.colorUp=e.colorup,this.colorDn=e.colordown,this.colorBorder=e.colorBorder,this.width=this._calculateWidth(e.barSpacing),this.minHeight=e.minHeight,this.vertOffset=this._calculateVerticalOffset(e.barSpacing)}function W73(e){this.items=e.items,this.ch=e["char"][0],this.color=e.color,this.vertOffset=e.vertOffset,this.height=Math.round(e.height),this.fontFamily=e.fontFamily||"Arial"}function W52(e){this.items=e.items,this.height=e.height||e.width,this.width=e.width||e.height,this.color=e.color,this.borderColor=e.borderColor,this.vertOffset=e.vertOffset||0}function W74(e){W52.call(this,e)}function W72(e){W52.call(this,e)}function W71(e){W52.call(this,e)}function PaneRendererTriangleApexLeft(e){W52.call(this,e)}function W64(e){W52.call(this,e)}function W63(e){W52.call(this,e)}function W59(e){W52.call(this,e)}function PaneRendererArrowsBase(e){W52.call(this,e),this.width=this._calculateWidth(e.barSpacing),this.isUp=!1}function PaneRendererArrowUp(e){PaneRendererArrowsBase.call(this,e),this.isUp=!0}function PaneRendererArrowDown(e){PaneRendererArrowsBase.call(this,e),this.isUp=!1}function PaneRendererSquare(e){W52.call(this,e)}function PaneRendererDiamond(e){W52.call(this,e)}function W55(e){this._items=e.items,this._y=e.y,this._h=e.h,this._w=e.w}function PaneRendererClockIcon(e){e.point2||(e.point2=e.point1);var t=e.point1.x,i=e.point1.y,t=t<=e.point2.x?t-10:t+10,i=i<=e.point2.y?i+10:i-10;e={items:new List([new MathEx.Point(t-1,i-3)]),"char":[String.fromCharCode("0xF017").toUpperCase()],color:e.color,vertOffset:0,height:16,fontFamily:"FontAwesome"},W73.call(this,e)}function PriceRange(e,t){this.m_minValue=e,this.m_maxValue=t}function TickMark(e,t,i){this.coord=e,this.label=t,this.major=i}function PriceTickSpanCalculator(e,t){if(this.m_base=e,this.m_integralDividers=t,this.m_fractionalDividers=[],MathEx.isBaseDecimal(this.m_base))this.m_fractionalDividers=[2,2.5,2];else for(var i=this.m_base;1!==i;){if(0===i%2)this.m_fractionalDividers.push(2),i/=2;else{if(0!==i%5)throw new RangeError("unexpected base");this.m_fractionalDividers.push(2),this.m_fractionalDividers.push(2.5),i/=5}if(100<this.m_fractionalDividers.length)throw Error("something wrong with base")}}function PriceTickMarkBuilder(e,t,i){this.m_marks=[],this.m_base=t,this.m_priceScale=e,this.m_fontHeight=14,(this._formatter=i)&&(this._cache=new FormattedLabelsCache(function(e){return i.format(e)})),this._currentFormatBase=0}function calculateBaseForTickSpan(e){for(var t=1;e*t!==Math.round(e*t);)t*=10;return t}function W76(e){function t(){for(var e=i.m_dataSources,t=0;t<e.size();t++){var n=e.item(t);n.priceScaleChanged&&n.priceScaleChanged.fire(i)}}this.D2=e,this.m_height=0,this.m_priceRange=null,this.m_dataSources=new List,this._studyBottomMargin=this._studyTopMargin=this.m_bottomMargin=this.m_topMargin=0,this.m_priceRangeSnapshot=this.m_scaleStartPoint=this.m_scrollStartPoint=null,this.m_markBuilder=new PriceTickMarkBuilder(this,100,new PriceFormatter(100)),this.D2.percentage.listeners().subscribe(this,W76.prototype.updateFormatter),this.D2.showSymbolLabels.listeners().subscribe(this,W76.prototype.updateShowSymbolLabels);var i=this;this.D2.log.listeners().subscribe(null,function(e){if(i.m_priceRange){var t=i.m_priceRange;e.value()?i.m_priceRange=new PriceRange(i._toLog(t.minValue()),i._toLog(t.maxValue())):i.m_priceRange=new PriceRange(i._fromLog(t.minValue()),i._fromLog(t.maxValue()))}}),this.D2.percentage.listeners().subscribe(null,function(){i.D2.autoScale.setValue(!0)}),this.D2.percentage.listeners().subscribe(null,function(){i.D2.autoScaleDisabled.setValue(i.D2.percentage.value());var e=i.priceRange();if(!(!i.mainSource()||i.mainSource().model().timeScale().isEmpty()||i.mainSource().data().isEmpty()||i.mainSource()instanceof TradingView.Series&&!i.mainSource().properties().lockScale.value())&&e){var t=i.mainSource().model().timeScale().visibleBars(),t=i.mainSource().data().search(t.firstBar(),SEARCH_NEAREST_RIGHT).value[CLOSE_PLOT];null!=e&&void 0!==t&&(i.D2.percentage.value()?i.setPriceRange(e.convertToPercents(t)):i.setPriceRange(e.convertFromPercents(t)))}}),this._sourcesToUpdateViews=this._sourcesForAutoscale=null,this._hasSeries=!1,this.D2.percentage.listeners().subscribe(null,t),this.D2.log.listeners().subscribe(null,t)}function W23(e){this._series=e,this.D0=e.m_model,this._points=(new List).append(new MathEx.Point(0,0)),this._invalidated=!0}function SeriesDataWindowView(e,t){DataWindowView.call(this),this._series=e,this.D0=t,this._items.append(new DataWindowItem($.t("Open",{context:"in_legend"}),"")),this._items.append(new DataWindowItem($.t("High",{context:"in_legend"}),"")),this._items.append(new DataWindowItem($.t("Low",{context:"in_legend"}),"")),this._items.append(new DataWindowItem($.t("Close",{context:"in_legend"}),"")),this._invalidated=!0,this.update()}function W14(e,t){this.m_series=e,this.m_model=t,this.m_bars=new List,this._invalidated=!0}function W15(e,t){W14.call(this,e,t)}function W16(e,t){W14.call(this,e,t)}function W17(e,t){W14.call(this,e,t)}function W18(e,t){W14.call(this,e,t)}function W29(e,t,i){this.m_series=e,this.m_priceSource=t,this.m_model=i,this.m_items=new List,this._barGetter={open:function(e){return e[OPEN_PLOT]},high:function(e){return e[HIGH_PLOT]},low:function(e){return e[LOW_PLOT]},close:function(e){return e[CLOSE_PLOT]},hl2:function(e){return(e[HIGH_PLOT]+e[LOW_PLOT])/2},hlc3:function(e){return(e[HIGH_PLOT]+e[LOW_PLOT]+e[CLOSE_PLOT])/3},ohlc4:function(e){return(e[OPEN_PLOT]+e[HIGH_PLOT]+e[LOW_PLOT]+e[CLOSE_PLOT])/4}}[this.m_priceSource]}function W20(e,t,i){W29.call(this,e,t,i),this._invaidated=!0}function W13(e,t,i){W29.call(this,e,t,i),this._invaidated=!0}function SeriesStatusView(e,t){StatusView.call(this,t),this._series=e,this._series.onRestarted().subscribe(this,SeriesStatusView.prototype.D20),this._series.onSymbolResolved().subscribe(this,SeriesStatusView.prototype.D20),this._series.onBoxSizeChanged().subscribe(this,SeriesStatusView.prototype.D20)}function SeriesPriceAxisView(e,t){this._series=e,this.D0=t,this._text="",this._coordinate=0,this._background="black",this._color="white",this._textHeight=14,this._invalidated=!0}function ProjectionSeriesPriceAxisView(e,t){SeriesPriceAxisView.call(this,e,t)}function W37(e,t,i,n){this.D1=e,this.m_series=t,this.m_model=i,this._plotName=n,this._visible=!1,this._points=(new List).append(new MathEx.Point(0,0))}function defaultPlotOptions(){return{visible:!0,color:"#0496FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,plottype:TradingView.StudyConsts.PLOT_LINE,histogramBase:0,transparency:50,trackPrice:!1,joinPoints:!1}}function LocationToYMixin(){}function W33(e,t,i,n){for(this.m_study=e,this.m_series=t,this.m_model=i,this._plotName=n,this.m_items=new List,this._invalidated=!0,e=this.m_study.metaInfo().plots,this._paletterProps=this._palette=this._colorer=null,t=this._plotIndex=0;t<e.length;t++)e[t].id===this._plotName&&(this._plotIndex=t),this.m_study.isSelfColorerPlot(t)&&e[t].target===this._plotName&&(this._colorer=t,this._palette=this.m_study.metaInfo().palettes[e[t].palette],this._paletterProps=this.m_study.properties().palettes[e[t].palette])}function W30(e,t,i,n){for(this.D1=e,this._series=t,this.D0=i,this._plotName=n,this._items=new List,this._invalidated=!0,e=this.D1.metaInfo().plots,t=0;t<e.length;t++)e[t].id===this._plotName&&(this._plotIndex=t,assert(this.D1.isBgColorerPlot(t),"Plot '"+this._plotName+"' is not a background colorer!"))}function StudyPlotShapesPaneViewBase(e,t,i,n){for(this.m_study=e,this.m_series=t,this.m_model=i,this.m_plotName=n,this.m_items=new List,this.m_invalidated=!0,this.m_plotIndex=null,e=this.m_study.metaInfo().plots,t=0;t<e.length;t++)if(e[t].id===this.m_plotName){this.m_plotIndex=t;break}for(e=this.m_study.metaInfo().plots,this._paletterProps=this._palette=this._colorer=null,t=this._plotIndex=0;t<e.length;t++)e[t].id===this.m_plotName&&(this._plotIndex=t),this.m_study.isSelfColorerPlot(t)&&e[t].target===this.m_plotName&&(this._colorer=t,this._palette=this.m_study.metaInfo().palettes[e[t].palette],this._paletterProps=this.m_study.properties().palettes[e[t].palette])}function W36(e,t,i,n){StudyPlotShapesPaneViewBase.call(this,e,t,i,n),this._rendererCache={}}function W35(e,t,i,n){W36.call(this,e,t,i,n)}function W34(e,t,i,n){StudyPlotShapesPaneViewBase.call(this,e,t,i,n),this._maxAbsValue=0}function W51(e,t,i){this.D1=e,this.D0=t,this._plotIndex=i,this._text="",this._coordinate=0,this._background="black",this._color="white",this._textHeight=14,this._invalidated=!0,this._cache=new TextWidthCache}function StudyDataWindowView(e,t){DataWindowView.call(this),this.D1=e,this.D0=t;var i=e.metaInfo().plots;if(i){for(var n=0;n<i.length;++n)if(!(this.D1.isSelfColorerPlot(n)||this.D1.isBarColorerPlot(n)||this.D1.isBgColorerPlot(n)||this.D1.isDataOffsetPlot(n))){var o,r=i[n].id;if("Compare@tv-basicstudies"===this.D1.metaInfo().id)o=new DataWindowItem(this.D1.inputsForGUI()[1],"");else{o=this.D1.title();try{o=this.D1.properties().styles[r].title.value()}catch(s){}o=new DataWindowItem(o,"")}o.plotId=r,o.plotIndex=n,this._items.append(o)}this.update(),this._invalidated=!0}}function DataVendorStudyDataWindowView(e,t){StudyDataWindowView.call(this,e,t)}function StudyStatusView(e,t){StatusView.call(this,t),this.D1=e}function $90(e,t){this.W99=e,this.D0=t,this._points=new List,this._floatPoints=new List}function AreaBackgroundRenderer(e){this._data=e}function BandBackgroundRenderer(e){this._data=e}function W50(){this._marksByIndex={},this._marksBySpan=[]}function TimePoint(e){this.m_date=e}function _createMonthNames(){return[$.t("Jan"),$.t("Feb"),$.t("Mar"),$.t("Apr"),$.t("May"),$.t("Jun"),$.t("Jul"),$.t("Aug"),$.t("Sep"),$.t("Oct"),$.t("Nov"),$.t("Dec")]}function W49(e,t){this.D0=e,this.D2=t,this.m_width=0,this._defaultRightOffset=this.D2.rightOffset.value(),this.m_rightOffset=this.D2.rightOffset.value(),this.m_points=new TimeIndexes,this.m_barSpacing=this.D2.barSpacing.value(),this.m_stateSnapshot=this.m_scaleStartPoint=this.m_scrollStartPoint=null,this.m_tickmarks=new W50,this._locked=!1,this._formattedBySpan={}}function SelectionRenderer(e){this._data=e}function LineAnchor(e,t){this._data=e,this.D0=t,this.radius=this._data.radius||LineAnchor.OUTER_RADIUS}function CompositeRenderer(){this._renderers=new List}function SelectionIndexes(){}function W48(e,t){PriceAxisView.call(this,e,t),this._linetool=e,this._pointIndex=t,this._text="",this._coordinate=0,this._background="#5592C9",this._activeBackground="#0F6DBF",this._borderColor="#2E84A6",this._color="white",this._textHeight=14,this._invalidated=!0,this.D0=e.D0}function LineToolTimeAxisView(e,t){TimeAxisView.call(this),this._linetool=e,this._pointindex=t,this.D0=e.D0,this._text="",this._coordinate=0,this._background="#5592C9",this._activeBackground="#0F6DBF",this._borderColor="#2E84A6",this._color="white",this._visible=!1,this._textHeight=14,this._invalidated=!0}function W47(e,t,i){if(DataSource.call(this),this.D0=e,this.D2=i,i.visible&&i.frozen||this.D2.merge(defaults("linetool")),$.isArray(t)?this._paneViews=t:this._paneViews=[t],this._points=new List,this._fixedPoints=new List,this._timePoint=new List,this.D2.symbol||(this.D2.merge({symbol:e.mainSeries().symbol()}),(t=e.mainSeries().symbolInfo())&&this.D2.merge({symbolInfo:{listed_exchange:t.listed_exchange,short_name:t.name}})),this.D2.interval||this.D2.merge({interval:e.mainSeries().interval()}),this.D2.addExclusion&&(this.D2.addExclusion("symbol"),this.D2.addExclusion("symbolInfo"),this.D2.addExclusion("points"),this.D2.addExclusion("interval"),this.D2.addExclusion("visible")),this.calcIsActualSymbol(),this.D2.listeners().subscribe(this,W47.prototype.propertiesChanged),this._createPointsProperties(),"_tooltipFieldsHash"in this&&!this.hasOwnProperty("_tooltipFieldsHash")&&(this._tooltipFieldsHash=$.extend(!0,{},this._tooltipFieldsHash)),this.m_priceAxisViews=new List,this.m_timeAxisViews=new List,0<this.pointsCount())for(e=0;e<this.pointsCount();e++)this.m_priceAxisViews.append(this.createPriceAxisView(e)),this.m_timeAxisViews.append(new LineToolTimeAxisView(this,e));this.D2.visible.listeners().subscribe(this,function(e){e.value()||this.D0.selectedSource()!=this||this.D0.setSelectedSource(null)}),this.customization=this.customization||{forcePriceAxisLabel:!1,disableSelection:!1,disableErasing:!1},$(window).resize(function(){this.isFixed()&&this.restoreFixedPoints()}.bind(this))}function $92(e,t){$90.call(this,e,t)}function W31(e,t){$90.call(this,e,t)}function PoligonRenderer(e,t){this._data=e,this._hittest=t?t:new HitTestResult(HitTestResult.MOVEPOINT)}function $66(e,t){$90.call(this,e,t),this._rendererCache={}}function W6(e,t){$90.call(this,e,t),this._rendererCache={}}function ParallelChannelRenderer(e){this._data=e}function $98(e,t){$90.call(this,e,t)}function TrendLineStatsRenderer(e,t,i){this._textSizeCache=t,this._data=e,this._fontSize=e.fontsize?e.fontsize:e.fontSize?e.fontSize:12,this._lineSpacing="number"==typeof this._data.lineSpacing&&this._data.lineSpacing?this._data.lineSpacing:0,e.lines=this._lines=TextRenderer.prototype.wordWrap.call(this,e.text,e.wordWrapWidth),this._hittest=i?i:new HitTestResult(HitTestResult.MOVEPOINT)}function TrendLineRenderer(e,t){this._data=e,this._hittest=t?t:new HitTestResult(HitTestResult.MOVEPOINT)}function W43(e,t){$90.call(this,e,t),this._label=null,this._rendererCache={},this._invalidated=!0}function RectangleRenderer(e){this._data=e}function W8(e,t){$90.call(this,e,t)}function EllipseRenderer(e){this._data=e,this._data.angleFrom=0,this._data.angleTo=2*Math.PI,this._data.clockwise=!1}function $69(e,t){$90.call(this,e,t)}function HorzLineRenderer(e){this._data=e}function $85(e,t){$90.call(this,e,t),this._rendererCache={}}function LineToolHorzLinePriceAxisView(e,t){this.W99=e,this.D0=t,this._text="",this._coordinate=0,this._background="black",this._color="white",this._textHeight=14,this._invaildated=!0}function HorzRayRenderer(e){this._data=e}function $86(e,t){$90.call(this,e,t),this._rendererCache={}}function LineToolHorzRayPriceAxisView(e,t){this.W99=e,this.D0=t,this._text="",this._coordinate=0,this._background="black",this._textHeight=14}function VertLineRenderer(e,t){this._data=e,this._hittest=t}function W45(e,t){$90.call(this,e,t)}function LineToolVertLineTimeAxisView(e,t){TimeAxisView.call(this),this.W99=e,this.D0=t,this._invalidated=!0}function ChannelRenderer(e){this._data=e}function W1(e,t){$90.call(this,e,t)}function W12(e,t){W1.call(this,e,t)}function W11(e,t){W12.call(this,e,t)}function $88(e,t){W1.call(this,e,t)}function W0(e,t){$90.call(this,e,t)}function TextRenderer(e,t,i){this._textSizeCache=t,this._data=e,this._fontSize=e.fontsize?e.fontsize:e.fontSize?e.fontSize:20,e.lines=this._lines=this.wordWrap(e.text,e.wordWrapWidth),this._hittest=i?i:new HitTestResult(HitTestResult.MOVEPOINT)}function W39(e,t,i,n,o,r){$90.call(this,e,t),this._offsetX=i,this._offsetY=n,this._vertAlign=o,this._horzAlign=r,this._rendererCache={},this._renderer=null}function BalloonRenderer(e,t){this._measureCache=t,this._data=e}function $56(e,t){$90.call(this,e,t),this._image=TradingView.getImage("balloon",TradingView.wrapUrl("/static/images/balloon.png")),$(this._image).load(function(){t.updateSource(e)}),this._rendererCache={}}function CalloutRenderer(e,t){this._data=e,e.lines=this.wordWrap(e.text,e.wordWrapWidth),this._textSizeCache=t}function $62(e,t){$90.call(this,e,t),this._textSizeCache={}}function TriangleRenderer(e){this._data=e}function W44(e,t){$90.call(this,e,t)}function ArcRenderer(e){this._data=e,this._data.angleFrom=0,this._data.angleTo=Math.PI,this._data.clockwise=!1}function $54(e,t){$90.call(this,e,t)}function $61(e,t){$90.call(this,e,t),this._invalidated=!0,this.D0=t,this.W99=e}function NoteRendererSource(){}function NoteRenderer(e,t){this.W99=e,this._data=t}function NotePaneView(e,t){$90.call(this,e,t),this._rendererSource=new NoteRendererSource}function PriceLabelRenderer(e,t,i){this._data=e,this._measureCache=t,this._chartModel=i}function W5(e,t,i){$90.call(this,e,t),this._image=TradingView.getImage("price_label",TradingView.wrapUrl("/static/images/price_label.png")),this._rendererCache={}}function PredictionRenderer(e){this._data=e,this._targetFontSize2=this._targetFontSize1=11,this._targetFontSize3=14,this._font="Arial",this._sourceFontSize1=12,this._sourceFontSize2=10}function W4(e,t){$90.call(this,e,t),this._clockWhite=TradingView.getImage("prediction-clock-white",TradingView.wrapUrl("/static/images/prediction-clock-white.png")),this._clockBlack=TradingView.getImage("prediction-clock-black",TradingView.wrapUrl("/static/images/prediction-clock-black.png")),this._successIcon=TradingView.getImage("prediction-success-white",TradingView.wrapUrl("/static/images/prediction-success-white.png")),this._failureIcon=TradingView.getImage("prediction-failure-white",TradingView.wrapUrl("/static/images/prediction-failure-white.png"))}function W3(e,t){$90.call(this,e,t)}function $82(e,t){$90.call(this,e,t),this._rendererCache={}}function $81(e,t){$90.call(this,e,t),this._rendererCache={}}function $72(e,t){$90.call(this,e,t),this._rendererCache={}}function W41(e,t){$90.call(this,e,t),this._rendererCache={}}function $74(e,t){$90.call(this,e,t),this._rendererCache={}}function FibArcRenderer(e,t){this._data=e,this._hittest=t}function $73(e,t){$90.call(this,e,t),this._rendererCache={}}function $76(e,t){$90.call(this,e,t),this._levels=[],this._rendererCache={}}function EllipseRendererSimple(e,t){this._data=e,this._hittest=t}function $71(e,t){$90.call(this,e,t),this._rendererCache={}}function ArcWedgeRenderer(e,t){this._data=e,this._hittest=t,this._rendererCache={}}function $77(e,t){$90.call(this,e,t),this._rendererCache={},this._levels=[]}function W7(e,t){$77.call(this,e,t)}function $68(e,t){$90.call(this,e,t),this._rendererCache=[{},{},{},{},{},{}]}function $93(e,t){$90.call(this,e,t),this._lines=[]}function LineToolRiskRewardPriceAxisView(e,t,i,n){this.W99=e,this.D0=t,this._text="",this._coordinate=0,this._background="black",this._textHeight=14,this._pricePropName=i,this._colorPropName=n}function $99(e,t){$90.call(this,e,t),this._rendererCache={}}function $91(e,t){$90.call(this,e,t),this._rendererCache={}}function $96(e,t){$90.call(this,e,t),this._rendererCache={}}function $95(e,t){$90.call(this,e,t),this._rendererCache={}}function $94(e,t){$90.call(this,e,t),this._rendererCache={}}function W42(e,t){$90.call(this,e,t),this._rendererCache={}}function GannArcRenderer(e){this._data=e}function $80(e,t){$90.call(this,e,t),this._rendererCache={}}function $70(e,t){$90.call(this,e,t),this._rendererCache={}}function FibSpiralRenderer(e){this._data=e}function $75(e,t){$90.call(this,e,t)}function $67(e,t){$90.call(this,e,t),this._label=null,this._rendererCache={}}function $78(e,t){$90.call(this,e,t),this._label2=this._label1=null,this._rendererCache={}}function IconRenderer(e,t){this._data=e,this._cache=t}function $87(e,t){$90.call(this,e,t),this._cache={}}function W10(e,t){$90.call(this,e,t)}function AngleRenderer(e){this._data=e}function W40(e,t){$90.call(this,e,t),this._label=null,this._rendererCache={}}function OrderLineAdapter(e){this._line=e,this._data={bodyText:"order",quantityText:"0"}}function OrderRenderer(e,t,i){this._data=e,this._cache=t,this._adapter=i}function OrderPriceAxisView(e,t){W48.call(this,e,t)}function OrderPaneView(e,t){$90.call(this,e,t),this._rendererCache={}}function PositionLineAdapter(e){this._line=e,this._data={bodyText:"position",quantityText:"0"}}function PositionRenderer(e,t,i){this._data=e,this._cache=t,this._adapter=i}function PositionPriceAxisView(e,t){W48.call(this,e,t)}function PositionPaneView(e,t){$90.call(this,e,t),this._rendererCache={}}function ExecutionsPositionController(e,t){this._pane=e,this._timeScale=t}function ExecutionLineAdapter(e){this._line=e}function ExecutionRenderer(e,t){this._data=e,this._adapter=t}function ExecutionPaneView(e,t){$90.call(this,e,t)}function MarkRenderer(e){this._data=e}function $97(e,t,i,n,o,r,s){$90.call(this,e,t),this._image=i,this._offsetX=r||0,this._offsetY=s||0,this._width=n,this._height=o}function fixLineToolsPositions(e,t,i){var n=e.allLineTools(),o=n.size();e=e.timeScale(),e.points();for(var r=0;o>r;++r){for(var s=n.item(r),a=0,l=s.points(),d=l.size(),h=0;d>h;++h){var c=l.item(h);c.time>t&&c.time<=i&&(c.index=e.m_points.indexOf(c.time),++a)}a>0&&s.updateAllViews()}}function FutureBarsRenderer(e){this._data=e}function TextWidthCache(e){this._maxSize=e||50,this._actualSize=0,this._cache={},this._oldestTick=this._usageTick=1,this._tick2Labels={}}function W96(e,t){var i=e._undoModel.D4,n=i.onWidget(),o=!1,o=n?i._options&&!i._options.hideIdeas:TVSettings.getBool("W96.visibile",!1);t?t.merge({visible:o,frozen:!1}):t=new Property({visible:o,frozen:!1});var r=this;t.visible.listeners().subscribe(null,function(e){n||i._containsData||TVSettings.setValue("W96.visibile",!!e.value()),r._tooltip&&r._tooltip.removeAll()}),W47.call(this,e,null,t),this.onNeedRepaint=new Delegate,this._requests=[],this._marks={},this.exchangeTimezone=this._collectedRange=this._getDataTimeout=this._loadedRange=null,this.updateTimeZone(),this.D0.mainSeries().onSymbolIntervalChanged().subscribe(this,this.clearMarks),this.D0.mainSeries().onSymbolResolved().subscribe(this,this.clearMarks),this.D0.mainSeries().onTickmarksRangeChanged().subscribe(this,this.getData),this._initialize(),this.pinnedTooltips={},this._tooltip=new TooltipRenderer(this._createTooltip.bind(this),this)}function $59(e,t,i){this.source=e,this.pane=t,this._rendererFactory=i}function BarsMarksContainerRenderer(e,t){this._barWidth=e.barWidth,this._plates=e.plates,this._tooltip=e.tooltip,this.D0=t}function W97(){this._layout=[],this._currentId=void 0,this.tooltipHovered=!1}function UserDefinedBarsMarks(e){W96.call(this,e);var t=this;TradingView.drawingState.hideMarksOnBars().subscribe(this,function(){t.D2.visible.setValue(!TradingView.drawingState.hideMarksOnBars().value())})}function UserDefinedBarsMarksTooltip(e){W97.call(this)}function W32(e,t){this.W99=e,this.D0=t,this._points=(new List).append(new MathEx.Point(0,0))}function TriangleTextMarkRenderer(e,t){this._data=e,this._textCache=t}function RectangleTextMarkRenderer(e,t){this._data=e,this._textCache=t}function CircleShapeMarkRenderer(e,t){this._data=e,this._textCache=t}function SquareShapeMarkRenderer(e,t){this._data=e,this._textCache=t}function ArrowShapeMarkRenderer(e,t,i){this._data=e,this._textCache=t,this._arrowDirection=i}function BackgroundRenderer(e){this._data=e}function HorizHistogramRenderer(e){this._data=e}function searchCoord(e,t){for(var i=0,n=e.length-1;n>=i;){var o=i+n>>>1,r=e[o].y1,s=e[o].y2;if(r>t)i=o+1;else{if(!(t>s))return e[o+1]&&r==e[o+1].y1?o+1:o;n=o-1}}return-1}function PropertyGroup(e,t,i,n){this._property=e,this._name=t,this._children=i,this._propertyPage=n}function D7(e,t){this.D0=t,this._bindings=new List,this._property=e}function Binding(e,t,i,n,o){e?(this._control=e,this._property=t,this._applyOnFly=i,this._undoModel=n,this._undoText=o,t&&(this.setValue(t.value()),t.listeners().subscribe(this,Binding.prototype.propertyChanged))):TradingView.logDebug("Binding: missing control")}function UppercaseTransformer(e){return e.toUpperCase()}function GreateTransformer(e){return function(t){return e>t?e:t}}function LessTransformer(e){return function(t){return t>e?e:t}}function ToIntTransformer(e){return function(t){return t=parseInt(t,10),isNaN(t)?e:t}}function ToFloatTransformer(e){return function(t){return t=parseFloat(t),isNaN(t)?e:t}}function ToAsciiTransformer(){return function(e){var t=e;for(e=e.replace(/[^\u0000-\u007F]/,"");e.length!==t.length;)t=e,e=t.replace(/[^\u0000-\u007F]/,"");return e}}function ReplaceEmptyTransformer(e){return function(t){return 0===t.length?e:t}}function SimpleStringBinder(e,t,i,n,o,r){Binding.call(this,e,t,n,o,r),this._transformFunction=i,this._attachToControl(e,n)}function D8(e,t,i,n,o,r){this._subControlIds=t,Binding.call(this,e,i,n,o,r),this._forEachSubControl(function(e){this._attachToControl(e,n)})}function D9(e,t,i,n,o,r,s){this.D0=n,this._mainSeries=r,this._toIntTransformer=ToIntTransformer(s),this._disabled=!1,Binding.call(this,e,t,i,n,o);var a=this;i&&e.change(function(){a.setValueToProperty(a.value())}),this._mainSeries.onBarReceived().subscribe(this,function(e){a.setValue(this.property().value())})}function D10(e,t,i,n,o){Binding.call(this,e,t,i,n,o),i&&e.on("accept-symbol",function(e,t){this.setValueToProperty(t)}.bind(this))}function D11(e,t,i,n,o,r,s){Binding.call(this,e,t,n,o,r),this._transformFunction=i,this._setter=s;var a=this;n&&e.change(function(){a._setter?a._setter.call(a,a.value()):a.setValueToProperty(a.value())})}function StaticContentBinder(e,t){Binding.call(this,e,t)}function D12(e,t,i,n,o,r){if(!e.is(":checkbox, :radio"))return new D12.PushButtonBinder(e,t,i,n,o);Binding.call(this,e,t,i,n,o),this._setter=r;var s=this;i&&e.change(function(){s._setter?s._setter.call(s,s.value()):s.setValueToProperty(s.value())})}function DisabledBinder(e,t,i,n,o){Binding.call(this,e,t,i,n,o)}function D14(e,t,i,n,o){i?(Binding.call(this,e,t,!0,i,n),o?e.callbacks().subscribe(this,o):e.callbacks().subscribe(this,D14.prototype.onActionCallback)):TradingView.logDebug("D14: Missed undo model")}function ColorBinding(e,t,i,n){Binding.call(this,e,t,i,n);var o=this;i&&e.change(function(){o.setValueToProperty(o.value())})}function SliderBinder(e,t,i,n,o){isNumber(t.value())||(console.warn("Property cannot be binded to control, bad value (expect number): "+t.value()),t=new Property),Binding.call(this,e,t,i,n,o);var r=this;i&&(e.bind("slidechange",function(e,t){r.setValueToProperty(t.value)}),e.bind("slide",function(e,t){r.setValueToProperty(t.value)})),e.bind("slidestart",function(e,t){n.beginUndoMacro(o)}),e.bind("slidestop",function(e,t){n.endUndoMacro()})}function D15(e,t,i,n,o,r){D12.call(this,e,t,n,o,r),this._intervalProperty=i,this._intervalProperty.listeners().subscribe(this,this.onIntervalChanged),
this.onIntervalChanged()}function WVBinding(e,t,i,n){this._control=e,this._wv=t.spawn(),this._transformFunction=i,this._undoText=n,this._attachToControl(this._control)}function CheckboxWVBinding(e,t,i,n,o){this._not=!!o,WVBinding.apply(this,arguments)}function SeriesStylePropertyPageMixin(){}function $49(e,t,i){D7.call(this,e,t),this._linetool=i,this._templateList=new TradingView.LinetoolTemplatesList(this._linetool._constructor,this.applyTemplate.bind(this))}function clearRect(e,t,i,n,o,r){e.save(),"undefined"==typeof FlashCanvas&&e.translate(-.5,-.5),e.fillStyle=r,e.fillRect(t,i,n,o),e.restore()}function _applyLocalizationToMetadata(e){return e.description_localized=$.t(e.description,{context:"study"}),e}function CompareWidget(e){this.D5=e,this.predefines={"":{"S&P 500 Trust":"AMEX:SPY","Nasdaq Composite":"INDEX:NASX","Diamonds Trust":"AMEX:DIA","Gold Trust":"AMEX:GLD","Euro Currency Trust":"AMEX:FXE","Nasdaq 100":"INDEX:IUXX","Nasdaq Financial 100":"INDEX:IXF"}},this.symbolAlias={"BATS:SPY":"AMEX:SPY","BATS:DIA":"AMEX:DIA","BATS:GLD":"AMEX:GLD","BATS:FXE":"AMEX:FXE"}}function CompareDialog(e){this.D6=e}function AddSymbolWidget(e){this.D5=e,this.init()}function EditObjectDialog(e,t,i){this.W99=e,this.D0=t,this._undoCheckpoint=i}function ObjectTreeDialog(e,t){this._defaultOptions={maxHeight:550,padding:20,minHeight:258},this.options=$.extend({},this._defaultOptions,e||{}),this.D0=t}function ManageDrawingsTab(e,t,i){this.dialog=e,this.options=t||{},this.model=i}function ObjectsTreeTab(e,t,i){this.dialog=e,this.options=t||{},this.model=i}function ObjectsTreeTabFilter(e){this.$container=e,this.$button=$('<div class="button-filter">').click(function(e){this.$button.trigger("button-popup",[this._getActions()]),e.stopPropagation()}.bind(this)).appendTo(e),TradingView.bindPopupMenu(this.$button,null,{event:"button-popup",addClass:"tree-tab-filter"}),this.onChange=new Delegate}function $41(e,t,i,n){D7.call(this,e,t),this.D1=i,this._showOnlyConfirmInputs=n,this.prepareLayout()}function $47(e,t,i){D7.call(this,e,t),this.D1=i,this.prepareLayout()}function $39(e,t,i){D7.call(this,e,t),this.D1=i,this._property=e,this.prepareLayout()}function A85(e,t,i){e=t.m_model.properties(),D7.call(this,e,t);var n=this._series=t.mainSeries();this._chart=t.m_model,this.D0=t,this.W99=i,this._property=e,this._seriesProperty=n.properties(),this._scaleProperty=n.m_priceScale.properties(),this._mainAxisProperty=n.properties().priceAxisProperties;var o=null;$.each(t.m_model.panes().toArray(),function(e,t){$.each(t.D19().toArray(),function(e,i){return i==n?(o=t,!1):void 0})}),this._pane=o,this.prepareLayout(),this._themes=[]}function $38(e,t){D7.call(this,e,t),this.prepareLayout()}function $14(e,t,i){D7.call(this,e,t),this._linetool=i,this.prepareLayout()}function A91(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A90(e,t,i){$14.call(this,e,t,i)}function A93(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $32(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $12(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $11(e,t,i){$14.call(this,e,t,i)}function $36(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $35(e,t,i){$14.call(this,e,t,i)}function $18(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $17(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function LineToolTextInplaceEditor(e,t){this.D4=e,this._undoModel=t}function $27(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $23(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A98(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A87(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $34(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $16(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A88(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $21(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A89(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A92(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $20(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $19(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $10(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $8(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $9(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A84(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $1(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A99(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $30(e,t,i){$1.call(this,e,t,i)}function $31(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $3(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $2(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $4(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $5(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $6(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A94(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $24(e,t,i){D7.call(this,e,t),this._linetool=i,this.prepareLayout()}function A95(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $22(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $15(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A86(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function LineToolNotePropertyPage(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $43(e,t,i){D7.call(this,e,t),this._linetool=i,this.prepareLayout()}function $44(e,t,i){D7.call(this,e,t),this.D1=i,this.prepareLayout()}function A97(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $25(e,t,i){$14.call(this,e,t,i),this.prepareLayout()}function $26(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $33(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function A96(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $7(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $13(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $29(e,t,i){$49.call(this,e,t,i),this.prepareLayout()}function $28(e,t,i){$14.call(this,e,t,i)}function $42(e,t,i){D7.call(this,e,t),this.D1=i,this.prepareLayout()}function $50(e,t,i){D7.call(this,e,t),this.D1=i,this.prepareLayout()}function RenameChartDialog(e,t,i){this.title=e||$.t("Rename Chart Layout"),this.label=t||$.t("Enter a new chart layout name"),this.maxlength=i||""}function LoadChartDialog(){this.title=$.t("Load Chart Layout"),this.options={},this.inputDelegate=new Delegate,this.matchedItems=[],this.itemsData=[],this.qs=new LoadChartDialog.QuickSearch(this.inputDelegate,this.fieldsExtractor,this.searchResult.bind(this)),this.sortObj=new LoadChartDialog.SortObject(this.modifiedCompare),this.nameSort=new LoadChartDialog.SortObject(this.nameCompare),this.symbolSort=new LoadChartDialog.SortObject(this.symbolCompare),this.toolsSort=new LoadChartDialog.SortObject(this.toolsCompare),D17.on("chart_loaded",LoadChartDialog.onChartLoaded,this)}function ChangeIntervalDialog(e){this._options=e||{},this._setInput(),this._caption=$('<i class="interval-caption">').html("&nbsp;"),this._helpTooltipTrigger=$('<i class="help-tooltip-trigger">').text("?").blueTooltip($.t("interval_dialog_description"),"bottom"),this._dialogTitle=$.t("Change Interval")}function strip_tags(e){return e&&e.replace?e.replace(/(<([^>]+)>)/gi,""):e}function encodeSpread(e){return encodeURIComponent(e)}function truncate(e,t){return e?(t=void 0===t?140:t,e.length>t?e.substr(0,e.indexOf(" ",t))+"…":e):e}function changeLoginState(e){is_authenticated=e?!0:!1,TVXWindowEvents.emit("loginStateChange",JSON.stringify({is_authenticated:is_authenticated,user:user})),loginStateChange.fire()}function loginUser(e){user=$.extend({},e),changeLoginState(!0),"function"==typeof A83.onSigninSuccess&&(A83.onSigninSuccess(),A83.onSigninSuccess=void 0),A83.modalDialog&&"Log in"==A83.modalDialog.data("title")&&A83.destroy()}function signOut(){$.get("/accounts/logout/",function(){changeLoginState(!1)})}function runOrSignIn(e){is_authenticated?e():A83.showSignInDialog(e)}function runOrGoPro(e,t){user&&user.is_pro?e():A83.showGoProDialog(t)}function following(){runOrSignIn(function(){document.location="/following/"})}function followers(){runOrSignIn(function(){document.location="/followers/"})}function handleIfNotError(e,t){e.error?console.log(e.error):t(e)}function handleIfNotErrorFunc(e){return function(t){handleIfNotError(t,e)}}function relationChange(e,t,i){var n=$(e);runOrSignIn(function(){var e;e=void 0===n.data("type")?t:n.data("type"),$.post("/social/follow-the-user/",{targetId:i,follow:e},function(t){e?(n.addClass("unfollow").removeClass("follow"),user.following++):(n.removeClass("unfollow").addClass("follow"),user.following--),n.mouseleave(),n.hasClass("follow-big")||followButtonTooltip(n),$(".following_count").text(user.following),n.data("type",1-e)},"json")})}function followButtonsHandler(e){e.on("click",".follow-big",function(){var e=$(this);e.hasClass("unfollow")?relationChange(e,0,e.data("userid")):(relationChange(e,1,e.data("userid")),e.hover())}).on("mouseenter",".follow-big",function(){$(this).hasClass("unfollow")&&$(this).text("Unfollow")}).on("mouseleave",".follow-big",function(){$(this).hasClass("unfollow")&&$(this).text("Following")})}function bindIdeasStreamFilter(e,t){t=t||{};var i=e.find(".filter").map(function(){function e(e,o){var r=$(this),s=r.data("name");if(!0===g||g[s])e&&e.preventDefault();else{if(d&&p.find(".temp").remove(),!is_authenticated&&r.hasClass("authorization-required"))return A83.showSignInDialog(null,0),!1;var h=s?a.filter("[name="+s+"]"):a,f=r.data("value");(h&&h.val()!=f||t.forceChange)&&(u.filter(".active").filter(s?"[data-name="+s+"]":"*").removeClass("active").find(".active-underline").remove(),r.addClass("active"),h.val(f).change(),o||"function"!=typeof t.onChange||setTimeout(function(){t.onChange(e,h.attr("name"),f)},0));var m=r.data("hook");if(m)for(key in m)i.forEach(function(e){-1<e.inputs.indexOf(key)&&e.obj.setValue(m[key],key)});if(d&&0==p.find("a[data-value="+f+"]").length&&r.clone(!0).addClass("temp item").append('<span class="active-underline"></span>').appendTo(p),!t.notPreventDefault&&t.onChange&&e&&e.preventDefault(),!d){var _=u.filter(".active[data-filter-title]:first").data("filter-title")||c;_?u.filter(".active").each(function(){_=_.replace("%"+$(this).data("name")+"%",$(this).contents(":first").text())}):_=r.contents(":first").text(),l.text(_)}n(!0)}}function n(e){"boolean"!=typeof e&&(e=s),e?(r.stop(!0,!1).fadeOut(h),o.unbind("clickoutside").removeClass("active"),s=!1):(r.stop(!0,!1).fadeIn(h),o.one("clickoutside",n).addClass("active"),s=!0)}var o=$(this),r=o.find(".dropdown"),s=!1,a=o.find("input"),l=o.find(".selected"),d=!1,h="undefined"==typeof t.speed?50:t.speed,c=o.data("filter-title");o.find(".selected").on("click",n),r.on("click","a",e);var p,u=r.find("a"),f=o.parent(".filter-tabbed");f.length&&(d=!0,p=f.find(".tabs"),u=u.add(p.find("a:not(.temp)")),p.on("click","a",e));var g={};o.find(".sub-group.inactive").find("a:first").each(function(e,t){g[$(t).data("name")]=!0}.bind(this));var m={setValue:function(t,i){var n=u.filter("a[data-value="+t+"]"+(1<a.length&&i?"[data-name="+i+"]":""));e.apply(n,[void 0,!0])},getActiveTitle:function(){return l.text()},disabled:function(e,t){t?$("[data-name="+t+"]",o).closest(".sub-group").addClass("inactive"):d?f.addClass("inactive "):o.addClass("inactive "),e||(t?("object"!=typeof g&&(g={}),g[t]=!0):g=!0)},enabled:function(e){e?($("[data-name="+e+"]",o).closest(".sub-group").removeClass("inactive"),"object"==typeof g&&(g[e]=!1)):(d?f.removeClass("inactive "):o.removeClass("inactive "),g=!1)}};return o.data("interface",m),{inputs:a.map(function(e,t){return $(t).attr("name")}).get(),obj:m}}).get()}function chartWithCover(e){e.find(".date").each(function(){var e=$(this),t=new Date(e.text());TradingView.agoDateFormatter(e,t)}),e.find(".desc").each(function(){var e=$(this);e.height(e.parent().outerHeight()-e.position().top-5)}).ellipsis()}function deleteChart(e,t){var i=[e];A83.showConfirm($.t("Confirmation"),$.t("Are you sure you want to delete this chart?"),function(){return W77.enabled("saveload_storage_customization")?ChartingLibraryBackend.removeChart(e,t):void $.post("/deletechart/",{uid:i},function(e){e.error||("string"==typeof t?document.location=t:"function"==typeof t?t():window.location.reload())})},null,{addClass:"delete-chart-dialog"})}function saveChart(e,t,i,n,o){return o=o||{},W77.enabled("saveload_storage_customization")?ChartingLibraryBackend.saveChart(e.name,e.short_name,e.resolution,e,t.id.value(),function(e){t.id.value()||(t.id.setValue(e),t.uid.setValue(e)),i()},n):void $.post("/savechart/",e,function(e){"ok:"===e.substr(0,3)?(json=e.substr(3),res=JSON.parse(json),t.id.value()||(t.id.setValue(res.id),t.uid.setValue(res.uid)),"function"==typeof i&&i({uid:t.uid.value()},res.count||0)):"saved_chart_limit_reached"==e||""==e?("function"==typeof n&&n(),o.noDefaultOnFail||A83.showGoProDialog({feature:"savedChartsLimit"})):("function"==typeof n&&n(),$("#error").html(e))})}function openSavedChart(e){W77.enabled("saveload_storage_customization")?ChartingLibraryBackend.loadChart(e):open("/e/"+e.url+"/"+(TradingView.isMobileView?"?mobile=1":""),"_blank")}function toggleTitleOfModerationButton(e,t,i){i?(e.attr("title",t),e.addClass("apply-common-tooltip")):(e.removeAttr("title"),e.removeClass("apply-common-tooltip"))}function recommendChart(e,t){var i=t?$(t):$("#chart-recommend-button");i.toggleClass("active"),$.post("/recommend/",{id:e,type:"recommend"},function(e){i.toggleClass("active",!!e.state)})}function bullseyeChart(e,t){var i=t?$(t):$("#chart-bullseye-button");i.hasClass("disabled")||(i.toggleClass("active"),$.post("/recommend/",{id:e,type:"bullseye"},function(e){i.toggleClass("active",!!e.state)}))}function updateSuggestedView(e,t){var i=$("#chart-"+e+"-suggested-button"),n=$("#chart-"+e+"-not-suggested-button");i.toggleClass("active",!!t),n.toggleClass("active",!t),toggleTitleOfModerationButton(i,"By "+user.username,!!t),toggleTitleOfModerationButton(n,"By "+user.username,!t),$("#chart-"+e).removeClass("not-moderated")}function suggestChart(e,t){updateSuggestedView(e,t),$.post("/recommend/",{id:e,type:"hot",state:(!!t).toString()},function(t){updateSuggestedView(e,t.state)})}function chartTogglePublic(e,t){var i=t?$(t):$("#chart-public-button");i.toggleClass("active"),$.post("/togglepublic/",{id:e},function(e){toggleTitleOfModerationButton(i,"By "+user.username,e.state),i.toggleClass("active",!!e.state)})}function chartRepostSTTW(e,t){var i=$(t);i.addClass("active"),$.post("/repoststtw/",{id:e},function(e){i.toggleClass("active",!!e.state)})}function chartToggleIOTD(e,t){function i(){n.toggleClass("active",o)}var n=t?$(t):$("#chart-iotd-button");if(!n.is(".disabled")){var o=n.hasClass("active");n.toggleClass("active",!o),$.post("/toggle-iotd/",{id:e},function(t){t.state&&updateSuggestedView(e,!0)}).done(function(e){return e.error?i():void n.toggleClass("active",!!e.state).toggleClass("disabled",!!e.disabled)}).fail(i)}}function trendingPeople(e){e.on("click",".column-trending-people .tabs a",function(t){var i=$(this);return i.hasClass("active")?!1:(i.addClass("active").siblings("a").removeClass("active"),e.find(".top-user-group").hide().filter("."+i.attr("href").slice(1)).show(),void t.preventDefault())})}function showDisconnectedMessage(){"MozWebSocket"in window&&WEB_SOCKET_WAS_CONNECTED?setTimeout("showDisconnectedMessageImpl()","15000"):showDisconnectedMessageImpl()}function showDisconnectedMessageImpl(){TradingView.trackEvent("System","Disconnect"),A83.showNotice("Connection is lost",{html:'<p class="tv-dialog-left">Connection to server was lost<br/><br/>How to fix:<ol class="tv-dialog-left"><li>Check firewall settings and make sure access to websocket ('+WEBSOCKET_HOST+" port "+WEBSOCKET_PORT+') is open. Then click Reconnect or press F5.</li><li>Your browser doesn’t support <strong>WebSocket</strong> technology and does not have <strong>Adobe Flash</strong> plugin installed.<br/>Please, <a href="http://get.adobe.com/flashplayer/" target="_blank">install Flash plugin</a> or consider updating to one of these modern browsers with WebSocket support:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome</a></li><li><a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a></li></ul></li><li>Server broke the connection. Click Reconnect or press F5.</li></ol></p><input class="tv-button xwide" type="button" value="Reconnect" onclick="A83.destroy();"/>',doNotCloseOnBgClick:!0}).on("destroy",function(){D16.connect()})}function showCriticalErrorMessage(){TradingView.trackEvent("System","Critical Error"),A83.showNotice("Critical error appeared",{html:'<input class="tv-dialog-button" type="button" value="Retry" onclick="A83.destroy();"/>',doNotCloseOnBgClick:!0}).on("destroy",function(){D16.connect()})}function toggleUserSavedCharts(e){var t=$(e).toggleClass("active");$(".my-saved-charts").toggle(),t.is(".active")?$(document).bind("click.toggleUserSavedCharts",function(t){$(t.target).is(".saved-charts-button")||toggleUserSavedCharts(e)}):$(document).unbind("click.toggleUserSavedCharts")}function makeDirectionName(){return function(e,t){var i=t(e);return"0"==i?"Neutral":"1"==i?"Long":"Short"}}function gotochart(e){location.href="/v/"+e+"/"}function closeGlobalNotification(e){$.cookie("notification_id",e,{expires:365,path:"/"}),$(".tv-global-notification").slideUp(400,function(){$(window).resize()})}function getImage(e,t,i){function n(i){i=W77.enabled("charting_library")?(t.snapshotUrl?"":"http://www.tradingview.com/x/")+i:window.location.protocol+"//"+window.location.host+"/x/"+i+"/",a.attr({href:i}),l.val(i),r.remove(),s.css({visibility:"visible"}),setTimeout(function(){var e=l.get(0);e.focus&&e.focus(),e.select&&e.select()},0),i=ShareTwitterSnapshot.getStatus(e.activeChartWidget.value().symbolProperty().value(),i),$('<a class="twitter-share-button tv-dialog-social tv-dialog-social-twitter"></a>').attr({href:"https://twitter.com/share?count=none&text="+encodeURIComponent(i)+"&url=%20"}).appendTo(d),$('<script src="//platform.twitter.com/widgets.js"><\/script>').appendTo(d)}t=t||{},A83.createModalDialog($.t("Image URL"),{addClass:"tv-dialog-min-width"}),dialog=A83.modalDialog;var o=dialog.find(".tv-dialog-content"),r=$("<p><img src="+TradingView.wrapUrl('"/static/images/loading-small.gif"')+"/></p>").css({textAlign:"center",position:"absolute",width:"100%"}).appendTo(o),s=$('<div class="main">').css({visibility:"hidden"}).appendTo(o),a=$("<a>").text($.t("Save image")).attr({target:"_blank"}).css("text-decoration","underline"),l=$("<input>").attr({type:"text",readonly:!0}).bind("click focus",function(){this.select&&this.select()});$("<p>").appendTo(s).append(a," "+$.t("or copy url:")),$("<p>").appendTo(s).append($("<form>").append(l));var d=$('<p class="tv-dialog-socials">').appendTo(s);return A83.positionDialog(),A83.applyHandlers(),TradingView.trackEvent("GUI","Get image button"),takeSnapshot(e,function(e){i&&i(e),n(e)},function(){dialog.find(".tv-dialog-error").text("URL cannot be recieved.").show()},{snapshotUrl:t.snapshotUrl}),!1}function getImageSilently(e,t,i){return takeSnapshot(e,function(e){i&&i(e)},function(){console.warn("Error while trying to create snapshot.")},{snapshotUrl:t.snapshotUrl}),!1}function onLoginStateChange(a){if($("html").toggleClass("is-authenticated",is_authenticated).toggleClass("is-not-authenticated",!is_authenticated).toggleClass("is-pro",is_authenticated&&user&&!!user.is_pro).toggleClass("is-not-pro",!(is_authenticated&&user&&user.is_pro)).toggleClass("is-trial",is_authenticated&&user&&"pro_realtime_trial"===user.pro_plan).toggleClass("is-not-trial",!(is_authenticated&&user&&"pro_realtime_trial"===user.pro_plan)).toggleClass("is-mobile",!!TradingView.isMobileView),TVSettings.sync(user.settings),is_authenticated){if(a||($(".header-item-profile strong.user-badge").remove(),$(".header-item-profile > a").append(userBadge(user,!0,"strong"))),$(".user-info-username").html(user.username),$(".following_count").html(user.following),$(".followers_count").html(user.followers),$(".saved_charts_count").html(user.saved_charts),$(".published_charts_count").html(user.published_charts),$(".treated_charts_count").html(user.treated_charts_count),$("img.user-picture, .user-picture img").attr("src",user.userpic),$(".trial-days-left").html(user.trial_days_left||""),$(".header-item-profile").find("a").each(function(e,t){t=$(t);var i=t.attr("rel");i&&t.attr("href",i.replace("%u",user.username))}),"undefined"!=typeof carouselModels)for(var b in carouselModels)carouselModels[b].reload();user.fastpass_script&&eval(user.fastpass_script),user.is_first_login&&(TradingView.trackEvent("Conversion","First login"),user.prort_trial_started&&(A83.showTrialMessageSuccess(),delete user.prort_trial_started),delete user.is_first_login),setTrialAvailiable(user.trial_availiable)}else user={username:"Guest",following:"0",followers:"0",ignore_list:{}},$(".user-info-username").html(user.username),window.localStorage&&localStorage.removeItem("trial_availiable");window.studyTemplates&&(studyTemplates.refreshStudyTemplateList(),studyTemplates.refreshFavoriteDropdownMenu())}function markNewsAsRead(){$(".user-picture .notifications-counter").hide().addClass("hide"),$(".notifications-counter.counter").removeClass("new").text("0"),TVXWindowEvents.emit("zero-notification-counter")}function followButtonTooltip(e){var t=e.hasClass("unfollow")?"Unfollow":"Follow";e.attr("title",t)}function followButtonToolipAll(){$(".follow-link").each(function(e,t){t=$(t),t.data("tv_tooltip")||followButtonTooltip(t)})}function getSavedChartsList(e){return W77.enabled("charting_library")?ChartingLibraryBackend.getCharts(e):$.getJSON("/my-charts/",e)}function isOnChartEditPage(){return"/e/"==location.pathname.substr(0,3)}function refreshChartMenuState(){function e(){n.hide(),i.show()}function t(t){if(t={charts:t},t.charts&&t.charts.length){o.empty(),o.append(Mustache.render(TradingView.templates.lists.savedCharts,t));var i=new A59(o,o.find("ul").eq(0),{additionalClass:"gray",alwaysVisible:!0});o.parent().one("hover",function(){i.updateScrollBar()}),o.find("li").each(function(t,i){i=$(i);var n=i.find(".name").text();20<n.length&&i.attr("title",n),$("span.icon",i).click(function(t){var i=$(this).data("id");return o.mouseleave(),deleteChart(i,function(){user.saved_charts--;var i=$(t.target).parent().attr("href");$(t.target).parent().parent().remove(),user.saved_charts||e(),!isOnChartEditPage()||user.saved_charts&&"/e/"+D3.metaInfo().uid+"/"!=i||(location.href="/e/")}),!1})})}else e()}var i=$(".header-button.header-item-chart"),n=$(".header-menu.header-item-chart"),o=n.find(".popup-subblock");n.length&&o.length&&(n.on("closeMenu",function(){o.empty()}),n.on("openMenu",function(){getSavedChartsList(t)}),is_authenticated&&user.saved_charts?(i.hide(),n.show()):e())}function urlize(e){var t,i=[],n=0,o="";if(o=e.match(/(https:\/\/|http:\/\/)(www.tradingview.com|beta\d?.tradingview.com|webcharts\d?|localhost\:6285)\/(x|i)\/[0-9a-z]{8}\//gi))for(t=0;t<o.length;t++)e=e.replace(o[t],"<"+n++ +">"),i.push('<div class="ch-item-snapshot-link"><i class="icon icon-snapshot-small" title="Chart Snapshot"></i> <a href="'+o[t]+'" target="_blank">Chart Snapshot</a></div><a target="_blank" href="'+o[t]+'" class="ch-item-snapshot-preview"><img src="'+o[t]+'" alt="" class="snapshot-preview"/></a>');var r=e.match(/(https:\/\/|http:\/\/)(www.tradingview.com|beta\d?.tradingview.com|webcharts\d?|localhost\:6285)\/v\/[0-9a-z]{8}\//gi);if(r)for(t=0;t<r.length;t++)e=e.replace(r[t],"<"+n++ +">"),o=r[t].match(/\/v\/([0-9a-z]{8})\//i)[1],i.push('<div class="ch-item-chart-link"><i class="icon icon-snapshot-small" title="Published Idea"></i> <a href="'+r[t]+'" target="_blank" data-id="'+o+'">Published Idea</a></div><a target="_blank" href="'+r[t]+'" class="ch-item-chart-preview" data-id="'+o+'"><img src="'+r[t].replace("/v/","/i/")+'" alt="" class="idea-preview"/></a>');if(o=e.match(/(http:\/\/|http:\/\/www\.|https:\/\/www\.|https:\/\/)[^ <\n]{2,200}/g))for(t=0;t<o.length;t++)r=0===o[t].indexOf("http://")||0===o[t].indexOf("https://")?"":"http://",e=e.replace(o[t],"<"+n++ +">"),i.push("<a target='_blank' href='"+r+o[t]+"'>"+o[t]+"</a>");if(o=e.match(/(\$)[a-z][a-z0-9\._\-]{2,20}/gi))for(t=0;t<o.length;t++)e=e.replace(new RegExp("\\"+o[t],"gi"),"<"+n++ +">"),i.push("<a target='_blank' href='/s/?q="+o[t].substr(1)+"'>"+o[t]+"</a>");if(o=e.match(/\@[a-z0-9\._\-\u00A0]{2,50}/gi))for(t=0;t<o.length;t++)e=e.replace(new RegExp(o[t],"gi"),"<"+n++ +">"),i.push("<a target='_blank' href='/u/"+o[t].substr(1).replace(" "," ")+"/'>"+o[t]+"</a>");return 0<i.length&&(e=e.replace(/<(\d+)>/g,function(e,t){return i[t]?i[t]:""})),e}function ShareTwitterSnapshot(e){function t(e,t){return"https://twitter.com/intent/tweet?&status="+encodeURIComponent(ShareTwitterSnapshot.getStatus(e,window.location.protocol+"//"+window.location.host+"/x/"+t+"/"))}if(TradingView.winMobileMode)this.onSuccess=function(i){try{JsBridge.sendEvent(t(e,i),"sharing_ready")}catch(n){}},this.onFailure=function(){try{JsBridge.sendEvent("sharing_error")}catch(e){}};else{var i=open("about:blank","snapshot_tweet","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+Math.round(screen.width/2-275)+",top="+Math.round(screen.height/2-210));this.onSuccess=function(n){i.location.href=t(e,n)},this.onFailure=function(){i.close()}}}function ShareStocktwitsSnapshot(e){function t(e,t){return"https://stocktwits.com/widgets/share?body="+encodeURIComponent(ShareStocktwitsSnapshot.getStatus(e,window.location.protocol+"//"+window.location.host+"/x/"+t+"/"))}if(TradingView.winMobileMode)this.onSuccess=function(i){try{JsBridge.sendEvent(t(e,i),"sharing_ready")}catch(n){}},this.onFailure=function(){try{JsBridge.sendEvent("sharing_error")}catch(e){}};else{var i=open("about:blank","snapshot_tweet","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+Math.round(screen.width/2-275)+",top="+Math.round(screen.height/2-210));this.onSuccess=function(n){i.location.href=t(e,n)},this.onFailure=function(){i.close()}}}function authInStocktwits(e){runOrSignIn(function(){user.has_stocktwits?"function"==typeof e&&e():("function"==typeof e&&(user.on_stocktwits_auth_success=function(){e.apply(this,Array.prototype.slice.call(arguments)),this.user.on_stocktwits_auth_success&&delete this.user.on_stocktwits_auth_success}.bind(window)),window.open("https://api.stocktwits.com/api/2/oauth/authorize?client_id="+stocktwits_consumer_key+"&response_type=code&redirect_uri="+location.protocol+"//"+location.host+"/accounts/return/stocktwits/&scope=publish_messages","stocktwits_permission_request","scrollbars=yes,height=400,width=700").focus())})}function userlink(e,t){return Mustache.render(TradingView.templates.userlink,{username:e,is_pro:function(){return!!t},is_realtime:function(){return"pro_realtime"==t},is_premium:function(){return"pro_premium"==t},is_trial:function(){return"pro_realtime_trial"==t}},TradingView.templates)}function proBadge(e,t){return void 0===e||e?Mustache.render(TradingView.templates.proBadge,{is_realtime:"pro_realtime"==e,is_premium:"pro_premium"==e,is_trial:"pro_realtime_trial"==e,large_badge:!!t}):""}function userBadge(e,t,i){var n="",o="";if(e.top_user_info){if(n=e.top_user_info.badge?e.top_user_info.badge.title:"",o=e.top_user_info.badge?e.top_user_info.badge["class"]:"",e.is_pro)switch(n+=" | ",e.pro_plan){case"pro_realtime_trial":n+="Pro Trial";break;case"pro_premium":n+="Premium";break;case"pro_realtime_trial":n+="Pro Plus";break;default:n+="Pro"}e.is_moderator&&(n+=" | Moderator")}return Mustache.render(TradingView.templates.userBadge,{is_moderator:e.is_moderator,is_pro:e.is_pro,is_realtime:"pro_realtime"==e.pro_plan,is_premium:"pro_premium"==e.pro_plan,is_trial:"pro_realtime_trial"==e.pro_plan,is_top:!!e.top_user_info,badge_class:o,badge_title:n,large_badge:!!t,badge_tag:i},TradingView.templates)}function updateChartActiveLabel(e,t){null==e&&(e=$(".chart-activity-label")),e=$(e),e.each(function(){var e,i=$(this);null==t?e=i.hasClass("chart-activity-label-active"):(e=t,i.toggleClass("chart-activity-label-active",e)),i.find(".chart-activity-label-plate").text(e?"Active":"Closed")})}function hash(e){var t=0;if(0==e.length)return t;for(i=0;i<e.length;i++)code=e.charCodeAt(i),t=(t<<5)-t+code,t&=t;return t}function uniq(e){return e.reduce(function(e,t,i){return~e.indexOf(t)?null:e.push(t),e},[])}function bindLate(e,t){return function(){return e[t].apply(e,arguments)}}function debounce(e,t){var i;return function(){clearTimeout(i),i=setTimeout(e.bind.apply(e,[this].concat(Array.prototype.slice.call(arguments))),t)}}function isLatin(e){return!/[^\u0000-\u00FF\u00A0\u2013-\u2122\u2200-\u23FF]/g.test(e)}function isASCII(e,t){return(t?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}function RegExpEscape(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function loadMorePeople(e,t,i){var n=t.$loading||$(),o=t.$button||$(),r=t.$container;n.show(),o.hide();var s=i?0:r.children().length;e.data||(e.data={}),e.data=$.extend({},e.data,{offset:s}),$.ajax(e).done(function(e){var n=e.total,s=e.items;i&&(r.data("loaded",!1),r.empty()),0<s.length?s.forEach(function(e){e.follow_button=!is_authenticated||user.id!=e.id,e.links=e.profile.location||e.profile.twitter_username||e.profile.website,e.badge=userBadge(e,!0),e.reputation_delta&&(e.reputation_delta=Math.round(e.reputation_delta)),$(Mustache.render(a,e)).appendTo(r)}):i&&t.empty&&r.append($('<div class="empty"></div>').text(t.empty)),r.children().length<n&&o.show(),e.thats_all&&r.data("loaded",!0)}).always(function(){n.hide()});var a="<div class='item follow-list-item'>	<a href='/u/{{ username }}/'><img src='{{ mid_picture_url}}'></a>	<div class='indent'>	<div class='description'>		<div class='user-stats'>			<span class='user-stats-followers' title='Followers'><a href='/u/{{ username }}/#followers'>{{ followers_count }}</a></span>			<span class='user-stats-charts' title='Charts'><a href='/u/{{ username }}/#charts'>{{ charts_count }}</a></span>			<span class='user-stats-reputation' title='Reputation'>{{ reputation }}{{# reputation_delta }} (+{{reputation_delta}}){{/ reputation_delta }}</span>		</div>		<div class='username'><a href='/u/{{ username }}/' class='userlink'>{{ username }}</a>{{& badge }}</div>		{{# links }}		<div class='links'>			{{# profile.location }}<span class='contact location'>{{ profile.location }}</span>{{/ profile.location }}			{{# profile.twitter_username }}<span class='contact twitter'><a href='//twitter.com/{{ profile.twitter_username }}' target='_blank'>{{ profile.twitter_username }}</a></span>{{/ profile.twitter_username }}			{{# profile.website }}<span class='contact webpage'><a href='{{ profile.website }}' target='_blank'>{{ profile.website }}</a></span>{{/ profile.website }}		</div>		{{/ links }}		{{# profile.about }}		<div class='about'>{{ profile.about }}</div>		{{/ profile.about }}		{{# follow_button }}	</div>		<div class='action-buttons'>			<button class='follow-user follow-user-{{ id }}{{# follow_status }} active{{/ follow_status }}'  title='{{#follow_status}}Unfollow{{/follow_status}}{{^follow_status}}Follow{{/follow_status}}' data-id='{{ id }}'>				<span class='follow'>Follow</span>				<span class='following'>Followed</span>				<span class='unfollow'>Unfollow</span>			</button> 			<button class='message-user message active' title='Send message' data-id='{{ id }}' data-username='{{ username }}'><span class='message'>Message</span></button>		</div>		{{/ follow_button }}	</div></div>"}function follow(e){runOrSignIn(function(){var t=$(e.currentTarget),i=t.data("id");if(!t.is(".self")){var n=t.is(".active")?0:1;$.ajax({url:"/social/follow-the-user/",type:"POST",data:{targetId:i,follow:n}}).done(function(){$(".follow-user-"+i).toggleClass("active").attr("title",n?"Unfollow":"Follow")})}})}function chartRelationButtons(e){var t=e.closest("[data-chart-id]").data("chart-id");if(!t)throw Error("chartRelationButtons can`t find data-chart-id attribute");
e.on("click",".agree",function(e){function i(){n.toggleClass("active",o)}e.preventDefault();var n=$(this),o=n.hasClass("active");runOrSignIn(function(){n.toggleClass("active",!o),$.post("/vote-for-chart/",{id:t,vote:1}).done(function(e){return e.error?(A83.showNotice("Error",e.error),i()):void(void 0!==e.result_score&&n.text(e.result_score||"").toggleClass("with-counter",0!==e.result_score))}).fail(i)})}),e.on("click",".fav",function(e){function i(){n.toggleClass("active",o)}e.preventDefault();var n=$(this),o=n.hasClass("active");runOrSignIn(function(){n.toggleClass("active",!o),$.post(o?"/remove-from-favorites/":"/add-to-favorites/",{id:t}).done(function(e){return e.error?i():void(void 0!==e.followers&&n.text(e.followers||"").toggleClass("with-counter",0!==e.followers))}).fail(i)})})}function makeTextContainerEditable(e,t,i){function n(t){e.removeClass("tv-editable-active").on("click",function(){r(i)}).off("mousedownoutside"),t&&e.empty().text(t)}function o(t){e.addClass("tv-editable-active").off("click").on("mousedownoutside",function(){n(t)})}function r(i){var r={okButtonText:$.t("OK"),okButtonClass:"tv-button ok",cancelButtonText:$.t("Cancel"),cancelButtonClass:"tv-button cancel"};i=$.extend({},r,i);var s=e.text(),r=Modernizr.touch?"":s,a="textarea"===i.replaceWith?$("<textarea"+(i.inputClass?'class="'+i.inputClass+'" ':"")+"></textarea>"):$('<input type="text" '+(i.inputClass?'class="'+i.inputClass+'" ':"")+'value="">');a.val(r);var r=$('<div class="buttons"></div>'),l=$('<div class="'+i.okButtonClass+'">'+i.okButtonText+"</div>").appendTo(r),d=$('<div class="'+i.cancelButtonClass+'">'+i.cancelButtonText+"</div>").appendTo(r);o(s);var h="function"==typeof i.onCancel?function(){i.onCancel(),n()}:function(){n(s)},c=function(e,i,o){/^\s+$/.test(i)&&(i=""),a.attr("disabled","disabled"),l.addClass("process"),t(e,i,o,function(){n()})};l.click(function(t){t.preventDefault(),t.stopPropagation(),c(e,a.val(),s)}),d.click(function(e){e.preventDefault(),e.stopPropagation(),h()}),a.keyup(function(t){t.preventDefault(),t.stopPropagation(),13!=t.keyCode||t.shiftKey?27==t.keyCode&&h():c(e,a.val(),s)}),e.empty().append(a,r),a.select()}!e instanceof $?console.error("$container should be jQuery object"):t?"function"!=typeof t?console.error("onOk should be function"):(e.addClass("tv-editable"),n()):console.error("onOk required")}function changeUserProfileField(e){function t(e){var t=Array.prototype.slice.call(arguments);t.shift(),"function"==typeof e&&e.apply(this,t)}if(e&&e.name&&"undefined"!=typeof e.value){var i={};i[e.name]=e.value,$.post("/accounts/change_data_json/",i,function(i){!i.errors||$.isEmptyObject(i.errors)?(i=i[e.name],user[e.name]=i,t(e.onSuccess,i)):t(e.onError,i.errors[e.name])}).error(function(i){403===i.status?t(e.onError,"Please, try to reoload page to edit user data"):t(e.onError,A13.isProd()?"Sorry, an error has occurred":i.responseText)}).always(function(){t(e.onComplete)})}else console.warn("Required options.name and options.value")}function setTrialAvailiable(e){window.localStorage&&(window.localStorage.trial_availiable=e?1:0)}function translatedIntervalString(e){var t=(""+e).match(/(.*)([DWM])/);return t?t[1]+$.t(t[2],{context:"dates"}):e}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function generateColor(e,t){if(t>=0&&100>=t){var i=parseInt(e.substr(1,2),16),n=parseInt(e.substr(3,2),16),o=parseInt(e.substr(5,2),16);return"rgba("+i+", "+n+", "+o+", "+(1-t/100).toFixed(2)+")"}throw"invalid transparency"}function pow10Increment(e,t,i){var n=1;0>e&&(n=-1,t=!t),i=Math.abs(i),isFinite(i)||(i=1),e=Math.abs(e);var o=Math.pow(10,Math.floor(Math.log(e)/Math.LN10))||i||0;return e>=10*o&&(o*=10),t&&e===o&&(o/=10),i>o&&(o=i),t?Math.ceil(e/o-1)*o*n:Math.floor(e/o+1)*o*n}function abbreviatedNumber(e){var t=0;if(e=+e,isFinite(e))for(;e>=1e3&&0===e%100;)t++,e/=1e3;var i=" K M G T Y".split(" ")[t];return null==i&&(i="e"+3*t),e+i}function makeFont(e,t,i){return i&&(i+=" "),i+e+"px "+t}function ChartSaver(e){this.D5=e}function takeSnapshot(e,t,i,n){n=n||{};var o={wl:n.wl,images:JSON.stringify(e.images()),previews:n.previews};(n.cme||e.activeChartWidget.value().onCmeWidget())&&(o.cme=!0),e=W77.enabled("charting_library")?n.snapshotUrl||"https://www.tradingview.com/snapshot/":"/snapshot/",$.post(e,o,function(e){e?t(e):i()}).fail(function(){i()})}function linkingSetSymbol(e){e&&"string"==typeof e&&($(".header-chart-panel .symbol-edit-wrap input").val(A68.shortName(e)),A45.symbol.setValue(e))}function PublishedChartsTimeline(){}ChartingLibraryBackend=function(){var e,t,i,n={};return n.initialize=function(n,o,r){e=n,t=o,i=r},n.getCharts=function(n){return $.ajax({url:"{0}/{1}/charts?client={2}&user={3}".format(i,"1.0",e,t),type:"GET",crossDomain:!0}).done(function(e){e=JSON.parse(e),"ok"!=e.status&&console.warn("Charts list request failed: "+e.message),e=e.data.map(function(e){return{id:e.id,name:e.name,image_url:e.id,modified_iso:e.timestamp,short_symbol:e.symbol,interval:e.resolution}}),n(e)})},n.removeChart=function(n,o){$.ajax({url:"{0}/{1}/charts?client={2}&user={3}&chart={4}".format(i,"1.0",e,t,n),type:"DELETE",crossDomain:!0}).done(function(e){e=JSON.parse(e),"ok"!=e.status&&console.warn("Chart delete request failed: "+e.message),o()})},n.saveChart=function(n,o,r,s,a,l,d){var h="{0}/{1}/charts?client={2}&user={3}".format(i,"1.0",e,t);"undefined"!=typeof a&&(h+="&chart="+a),$.ajax({url:h,data:{name:n,content:JSON.stringify(s),symbol:o,resolution:r},type:"POST",crossDomain:!0}).done(function(e){e=JSON.parse(e),"ok"!=e.status?(console.warn("Chart save request failed: "+e.message),d()):l(e.id)}).fail(function(){d()})},n.loadChart=function(n){$.ajax({url:"{0}/{1}/charts?client={2}&user={3}&chart={4}".format(i,"1.0",e,t,n.id),type:"GET",crossDomain:!0}).done(function(e){e=JSON.parse(e),"ok"!=e.status?console.warn("Chart load request failed: "+e.message):(e=JSON.parse(e.data.content),e.uid=n.id,D17.emit("chart_load_requested",e))}).fail(function(){console.warn("Error loading chart")})},n.removeStudyTemplate=function(e,t){},n.getStudyTemplateContent=function(e,t){},n.saveStudyTemplate=function(e,t){},n.getStudyTemplatesList=function(e){e([])},n.clearStudyTemplatesListCache=function(e){},n}(),function(){var e=function(){};"undefined"==typeof window.console&&(window.console={});for(var t=window.console,i="dir log time info warn count clear debug error group trace assert dirxml profile timeEnd groupEnd profileEnd timeStamp exception table notifyFirebug groupCollapsed getFirebugElement firebug userObjects".split(" "),n=0,o=i.length;o>n;n++){var r=i[n];if("undefined"==typeof t[r])try{t[r]=e}catch(s){}}var a=window.onerror;window.__tv_js_errors=[],window.onerror=function(e,t,i){if(window.__tv_js_errors.push(e+" (found at "+t+", line "+i+")"),a)try{a.apply(window,arguments)}catch(n){}}}(),function(e,t){function i(e){var t,i,n=V[e]={};for(e=e.split(/\s+/),t=0,i=e.length;i>t;t++)n[e[t]]=!0;return n}function n(e,i,n){if(n===t&&1===e.nodeType)if(n="data-"+i.replace(W,"-$1").toLowerCase(),n=e.getAttribute(n),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:E.isNumeric(n)?+n:M.test(n)?E.parseJSON(n):n}catch(o){}E.data(e,i,n)}else n=t;return n}function o(e){for(var t in e)if(("data"!==t||!E.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function r(e,t,i){var n=t+"defer",o=t+"queue",r=t+"mark",s=E._data(e,n);!s||"queue"!==i&&E._data(e,o)||"mark"!==i&&E._data(e,r)||setTimeout(function(){E._data(e,o)||E._data(e,r)||(E.removeData(e,n,!0),s.fire())},0)}function s(){return!1}function a(){return!0}function l(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function d(e,t,i){if(t=t||0,E.isFunction(t))return E.grep(e,function(e,n){return!!t.call(e,n,e)===i});if(t.nodeType)return E.grep(e,function(e,n){return e===t===i});if("string"==typeof t){var n=E.grep(e,function(e){return 1===e.nodeType});if(re.test(t))return E.filter(t,n,!i);t=E.filter(t,n)}return E.grep(e,function(e,n){return 0<=E.inArray(e,t)===i})}function h(e){var t=de.split("|");if(e=e.createDocumentFragment(),e.createElement)for(;t.length;)e.createElement(t.pop());return e}function c(e,t){return E.nodeName(e,"table")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e,t){if(1===t.nodeType&&E.hasData(e)){var i,n,o;n=E._data(e);var r=E._data(t,n),s=n.events;if(s)for(i in delete r.handle,r.events={},s)for(n=0,o=s[i].length;o>n;n++)E.event.add(t,i,s[i][n]);r.data&&(r.data=E.extend({},r.data))}}function u(e,t){var i;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),i=t.nodeName.toLowerCase(),"object"===i?t.outerHTML=e.outerHTML:"input"!==i||"checkbox"!==e.type&&"radio"!==e.type?"option"===i?t.selected=e.defaultSelected:"input"===i||"textarea"===i?t.defaultValue=e.defaultValue:"script"===i&&t.text!==e.text&&(t.text=e.text):(e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value)),t.removeAttribute(E.expando),t.removeAttribute("_submit_attached"),t.removeAttribute("_change_attached"))}function f(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function g(e){("checkbox"===e.type||"radio"===e.type)&&(e.defaultChecked=e.checked)}function m(e){var t=(e.nodeName||"").toLowerCase();"input"===t?g(e):"script"!==t&&"undefined"!=typeof e.getElementsByTagName&&E.grep(e.getElementsByTagName("input"),g)}function _(e,t,i){var n="width"===t?e.offsetWidth:e.offsetHeight,o="width"===t?1:0;if(n>0){if("border"!==i)for(;4>o;o+=2)i||(n-=parseFloat(E.css(e,"padding"+We[o]))||0),n="margin"===i?n+(parseFloat(E.css(e,i+We[o]))||0):n-(parseFloat(E.css(e,"border"+We[o]+"Width"))||0);return n+"px"}if(n=Ce(e,t),(0>n||null==n)&&(n=e.style[t]),Ee.test(n))return n;if(n=parseFloat(n)||0,i)for(;4>o;o+=2)n+=parseFloat(E.css(e,"padding"+We[o]))||0,"padding"!==i&&(n+=parseFloat(E.css(e,"border"+We[o]+"Width"))||0),"margin"===i&&(n+=parseFloat(E.css(e,i+We[o]))||0);return n+"px"}function v(e){return function(t,i){if("string"!=typeof t&&(i=t,t="*"),E.isFunction(i))for(var n,o,r=t.toLowerCase().split(Je),s=0,a=r.length;a>s;s++)n=r[s],(o=/^\+/.test(n))&&(n=n.substr(1)||"*"),n=e[n]=e[n]||[],n[o?"unshift":"push"](i)}}function y(e,i,n,o,r,s){r=r||i.dataTypes[0],s=s||{},s[r]=!0,r=e[r];for(var a,l=0,d=r?r.length:0,h=e===Ze;d>l&&(h||!a);l++)a=r[l](i,n,o),"string"==typeof a&&(!h||s[a]?a=t:(i.dataTypes.unshift(a),a=y(e,i,n,o,a,s)));return!h&&a||s["*"]||(a=y(e,i,n,o,"*",s)),a}function w(e,i){var n,o,r=E.ajaxSettings.flatOptions||{};for(n in i)i[n]!==t&&((r[n]?e:o||(o={}))[n]=i[n]);o&&E.extend(!0,e,o)}function b(e,t,i,n){if(E.isArray(t))E.each(t,function(t,o){i||Oe.test(e)?n(e,o):b(e+"["+("object"==typeof o?t:"")+"]",o,i,n)});else if(i||"object"!==E.type(t))n(e,t);else for(var o in t)b(e+"["+o+"]",t[o],i,n)}function T(){try{return new e.XMLHttpRequest}catch(t){}}function S(){return setTimeout(C,0),ct=E.now()}function C(){ct=t}function x(e,t){var i={};return E.each(gt.concat.apply([],gt.slice(0,t)),function(){i[this]=e}),i}function P(e){if(!pt[e]){var t=L.body,i=E("<"+e+">").appendTo(t),n=i.css("display");i.remove(),("none"===n||""===n)&&(lt||(lt=L.createElement("iframe"),lt.frameBorder=lt.width=lt.height=0),t.appendChild(lt),dt&&lt.createElement||(dt=(lt.contentWindow||lt.contentDocument).document,dt.write((E.support.boxModel?"<!doctype html>":"")+"<html><body>"),dt.close()),i=dt.createElement(e),dt.body.appendChild(i),n=E.css(i,"display"),t.removeChild(lt)),pt[e]=n}return pt[e]}function A(e){return E.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var L=e.document,D=e.navigator,k=e.location,E=function(){function i(){if(!s.isReady){try{L.documentElement.doScroll("left")}catch(e){return void setTimeout(i,1)}s.ready()}}var n,o,r,s=function(e,t){return new s.fn.init(e,t,n)},a=e.jQuery,l=e.$,d=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=/\S/,c=/^\s+/,p=/\s+$/,u=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,m=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,_=/(?:^|:|,)(?:\s*\[)+/g,v=/(webkit)[ \/]([\w.]+)/,y=/(opera)(?:.*version)?[ \/]([\w.]+)/,w=/(msie) ([\w.]+)/,b=/(mozilla)(?:.*? rv:([\w.]+))?/,T=/-([a-z]|[0-9])/gi,S=/^-ms-/,C=function(e,t){return(t+"").toUpperCase()},x=D.userAgent,P=Object.prototype.toString,A=Object.prototype.hasOwnProperty,k=Array.prototype.push,E=Array.prototype.slice,V=String.prototype.trim,I=Array.prototype.indexOf,M={};return s.fn=s.prototype={constructor:s,init:function(e,i,n){var o;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("body"===e&&!i&&L.body)return this.context=L,this[0]=L.body,this.selector=e,this.length=1,this;if("string"==typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:d.exec(e),!o||!o[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(o[1])return n=(i=i instanceof s?i[0]:i)?i.ownerDocument||i:L,(e=u.exec(e))?s.isPlainObject(i)?(e=[L.createElement(e[1])],s.fn.attr.call(e,i,!0)):e=[n.createElement(e[1])]:(e=s.buildFragment([o[1]],[n]),e=(e.cacheable?s.clone(e.fragment):e.fragment).childNodes),s.merge(this,e);if((i=L.getElementById(o[2]))&&i.parentNode){if(i.id!==o[2])return n.find(e);this.length=1,this[0]=i}return this.context=L,this.selector=e,this}return s.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),s.makeArray(e,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return E.call(this,0)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,i){var n=this.constructor();return s.isArray(e)?k.apply(n,e):s.merge(n,e),n.prevObject=this,n.context=this.context,"find"===t?n.selector=this.selector+(this.selector?" ":"")+i:t&&(n.selector=this.selector+"."+t+"("+i+")"),n},each:function(e,t){return s.each(this,e,t)},ready:function(e){return s.bindReady(),o.add(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(E.apply(this,arguments),"slice",E.call(arguments).join(","))},map:function(e){return this.pushStack(s.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:k,sort:[].sort,splice:[].splice},s.fn.init.prototype=s.fn,s.extend=s.fn.extend=function(){var e,i,n,o,r,a=arguments[0]||{},l=1,d=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[1]||{},l=2),"object"==typeof a||s.isFunction(a)||(a={}),d===l&&(a=this,--l);d>l;l++)if(null!=(e=arguments[l]))for(i in e)n=a[i],o=e[i],a!==o&&(h&&o&&(s.isPlainObject(o)||(r=s.isArray(o)))?(r?(r=!1,n=n&&s.isArray(n)?n:[]):n=n&&s.isPlainObject(n)?n:{},a[i]=s.extend(h,n,o)):o!==t&&(a[i]=o));return a},s.extend({noConflict:function(t){return e.$===s&&(e.$=l),t&&e.jQuery===s&&(e.jQuery=a),s},isReady:!1,readyWait:1,holdReady:function(e){e?s.readyWait++:s.ready(!0)},ready:function(e){if(!0===e&&!--s.readyWait||!0!==e&&!s.isReady){if(!L.body)return setTimeout(s.ready,1);s.isReady=!0,!0!==e&&0<--s.readyWait||(o.fireWith(L,[s]),s.fn.trigger&&s(L).trigger("ready").off("ready"))}},bindReady:function(){if(!o){if(o=s.Callbacks("once memory"),"complete"===L.readyState)return setTimeout(s.ready,1);if(L.addEventListener)L.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",s.ready,!1);else if(L.attachEvent){L.attachEvent("onreadystatechange",r),e.attachEvent("onload",s.ready);var t=!1;try{t=null==e.frameElement}catch(n){}L.documentElement.doScroll&&t&&i()}}},isFunction:function(e){return"function"===s.type(e)},isArray:Array.isArray||function(e){return"array"===s.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):M[P.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==s.type(e)||e.nodeType||s.isWindow(e))return!1;try{if(e.constructor&&!A.call(e,"constructor")&&!A.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}for(var n in e);return n===t||A.call(e,n)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw Error(e)},parseJSON:function(t){return"string"==typeof t&&t?(t=s.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):f.test(t.replace(g,"@").replace(m,"]").replace(_,""))?new Function("return "+t)():void s.error("Invalid JSON: "+t)):null},parseXML:function(i){if("string"!=typeof i||!i)return null;var n,o;try{e.DOMParser?(o=new DOMParser,n=o.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(r){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||s.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&h.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(S,"ms-").replace(T,C)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,i,n){var o,r=0,a=e.length,l=a===t||s.isFunction(e);if(n)if(l){for(o in e)if(!1===i.apply(e[o],n))break}else for(;a>r&&!1!==i.apply(e[r++],n););else if(l){for(o in e)if(!1===i.call(e[o],o,e[o]))break}else for(;a>r&&!1!==i.call(e[r],r,e[r++]););return e},trim:V?function(e){return null==e?"":V.call(e)}:function(e){return null==e?"":e.toString().replace(c,"").replace(p,"")},makeArray:function(e,t){var i=t||[];if(null!=e){var n=s.type(e);null==e.length||"string"===n||"function"===n||"regexp"===n||s.isWindow(e)?k.call(i,e):s.merge(i,e)}return i},inArray:function(e,t,i){var n;if(t){if(I)return I.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=e.length,o=0;if("number"==typeof i.length)for(var r=i.length;r>o;o++)e[n++]=i[o];else for(;i[o]!==t;)e[n++]=i[o++];return e.length=n,e},grep:function(e,t,i){var n,o=[];i=!!i;for(var r=0,s=e.length;s>r;r++)n=!!t(e[r],r),i!==n&&o.push(e[r]);return o},map:function(e,i,n){var o,r,a=[],l=0,d=e.length;if(e instanceof s||d!==t&&"number"==typeof d&&(d>0&&e[0]&&e[d-1]||0===d||s.isArray(e)))for(;d>l;l++)o=i(e[l],l,n),null!=o&&(a[a.length]=o);else for(r in e)o=i(e[r],r,n),null!=o&&(a[a.length]=o);return a.concat.apply([],a)},guid:1,proxy:function(e,i){if("string"==typeof i){var n=e[i];i=e,e=n}if(!s.isFunction(e))return t;var o=E.call(arguments,2),n=function(){return e.apply(i,o.concat(E.call(arguments)))};return n.guid=e.guid=e.guid||n.guid||s.guid++,n},access:function(e,i,n,o,r,a,l){var d,h=null==n,c=0,p=e.length;if(n&&"object"==typeof n){for(c in n)s.access(e,i,c,n[c],1,a,o);r=1}else if(o!==t){if(d=l===t&&s.isFunction(o),h&&(d?(d=i,i=function(e,t,i){return d.call(s(e),i)}):(i.call(e,o),i=null)),i)for(;p>c;c++)i(e[c],n,d?o.call(e[c],c,i(e[c],n)):o,l);r=1}return r?e:h?i.call(e):p?i(e[0],n):a},now:function(){return(new Date).getTime()},uaMatch:function(e){return e=e.toLowerCase(),e=v.exec(e)||y.exec(e)||w.exec(e)||0>e.indexOf("compatible")&&b.exec(e)||[],{browser:e[1]||"",version:e[2]||"0"}},sub:function(){function e(t,i){return new e.fn.init(t,i)}s.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(i,n){return n&&n instanceof s&&!(n instanceof e)&&(n=e(n)),s.fn.init.call(this,i,n,t)},e.fn.init.prototype=e.fn;var t=e(L);return e},browser:{}}),s.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){M["[object "+t+"]"]=t.toLowerCase()}),x=s.uaMatch(x),x.browser&&(s.browser[x.browser]=!0,s.browser.version=x.version),s.browser.webkit&&(s.browser.safari=!0),h.test(" ")&&(c=/^[\s\xA0]+/,p=/[\s\xA0]+$/),n=s(L),L.addEventListener?r=function(){L.removeEventListener("DOMContentLoaded",r,!1),s.ready()}:L.attachEvent&&(r=function(){"complete"===L.readyState&&(L.detachEvent("onreadystatechange",r),s.ready())}),s}(),V={};E.Callbacks=function(e){e=e?V[e]||i(e):{};var n,o,r,s,a,l,d=[],h=[],c=function(t){var i,n,o,r;for(i=0,n=t.length;n>i;i++)o=t[i],r=E.type(o),"array"===r?c(o):"function"===r&&(e.unique&&u.has(o)||d.push(o))},p=function(t,i){for(i=i||[],n=!e.memory||[t,i],r=o=!0,l=s||0,s=0,a=d.length;d&&a>l;l++)if(!1===d[l].apply(t,i)&&e.stopOnFalse){n=!0;break}r=!1,d&&(e.once?!0===n?u.disable():d=[]:h&&h.length&&(n=h.shift(),u.fireWith(n[0],n[1])))},u={add:function(){if(d){var e=d.length;c(arguments),r?a=d.length:n&&!0!==n&&(s=e,p(n[0],n[1]))}return this},remove:function(){if(d)for(var t=arguments,i=0,n=t.length;n>i;i++)for(var o=0;o<d.length&&(t[i]!==d[o]||(r&&a>=o&&(a--,l>=o&&l--),d.splice(o--,1),!e.unique));o++);return this},has:function(e){if(d)for(var t=0,i=d.length;i>t;t++)if(e===d[t])return!0;return!1},empty:function(){return d=[],this},disable:function(){return d=h=n=t,this},disabled:function(){return!d},lock:function(){return h=t,n&&!0!==n||u.disable(),this},locked:function(){return!h},fireWith:function(t,i){return h&&(r?e.once||h.push([t,i]):e.once&&n||p(t,i)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!o}};return u};var I=[].slice;E.extend({Deferred:function(e){var t,i=E.Callbacks("once memory"),n=E.Callbacks("once memory"),o=E.Callbacks("memory"),r="pending",s={resolve:i,reject:n,notify:o},a={done:i.add,fail:n.add,progress:o.add,state:function(){return r},isResolved:i.fired,isRejected:n.fired,then:function(e,t,i){return l.done(e).fail(t).progress(i),this},always:function(){return l.done.apply(l,arguments).fail.apply(l,arguments),this},pipe:function(e,t,i){return E.Deferred(function(n){E.each({done:[e,"resolve"],fail:[t,"reject"],progress:[i,"notify"]},function(e,t){var i,o=t[0],r=t[1];E.isFunction(o)?l[e](function(){(i=o.apply(this,arguments))&&E.isFunction(i.promise)?i.promise().then(n.resolve,n.reject,n.notify):n[r+"With"](this===l?n:this,[i])}):l[e](n[r])})}).promise()},promise:function(e){if(null==e)e=a;else for(var t in a)e[t]=a[t];return e}},l=a.promise({});for(t in s)l[t]=s[t].fire,l[t+"With"]=s[t].fireWith;return l.done(function(){r="resolved"},n.disable,o.lock).fail(function(){r="rejected"},i.disable,o.lock),e&&e.call(l,l),l},when:function(e){function t(e){return function(t){n[e]=1<arguments.length?I.call(arguments,0):t,--a||l.resolveWith(l,n)}}function i(e){return function(t){s[e]=1<arguments.length?I.call(arguments,0):t,l.notifyWith(d,s)}}var n=I.call(arguments,0),o=0,r=n.length,s=Array(r),a=r,l=1>=r&&e&&E.isFunction(e.promise)?e:E.Deferred(),d=l.promise();if(r>1){for(;r>o;o++)n[o]&&n[o].promise&&E.isFunction(n[o].promise)?n[o].promise().then(t(o),l.reject,i(o)):--a;a||l.resolveWith(l,n)}else l!==e&&l.resolveWith(l,r?[e]:[]);return d}}),E.support=function(){var t,i,n,o,r,s,a,l,d=L.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",i=d.getElementsByTagName("*"),n=d.getElementsByTagName("a")[0],!i||!i.length||!n)return{};o=L.createElement("select"),r=o.appendChild(L.createElement("option")),i=d.getElementsByTagName("input")[0],t={leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.55/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:"on"===i.value,optSelected:r.selected,getSetAttribute:"t"!==d.className,enctype:!!L.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==L.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},E.boxModel=t.boxModel="CSS1Compat"===L.compatMode,i.checked=!0,t.noCloneChecked=i.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!r.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}if(!d.addEventListener&&d.attachEvent&&d.fireEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).fireEvent("onclick")),i=L.createElement("input"),i.value="t",i.setAttribute("type","radio"),t.radioValue="t"===i.value,i.setAttribute("checked","checked"),i.setAttribute("name","t"),d.appendChild(i),n=L.createDocumentFragment(),n.appendChild(d.lastChild),t.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=i.checked,n.removeChild(i),n.appendChild(d),d.attachEvent)for(a in{submit:1,change:1,focusin:1})i="on"+a,l=i in d,l||(d.setAttribute(i,"return;"),l="function"==typeof d[i]),t[a+"Bubbles"]=l;return n.removeChild(d),n=o=r=d=i=null,E(function(){var i,n,o,r,a=L.getElementsByTagName("body")[0];a&&(i=L.createElement("div"),i.style.cssText="padding:0;margin:0;border:0;visibility:hidden;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(i,a.firstChild),d=L.createElement("div"),i.appendChild(d),d.innerHTML="<table><tr><td style='padding:0;margin:0;border:0;display:none'></td><td>t</td></tr></table>",s=d.getElementsByTagName("td"),l=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=l&&0===s[0].offsetHeight,e.getComputedStyle&&(d.innerHTML="",n=L.createElement("div"),n.style.width="0",n.style.marginRight="0",d.style.width="2px",d.appendChild(n),t.reliableMarginRight=0===(parseInt((e.getComputedStyle(n,null)||{marginRight:0}).marginRight,10)||0)),"undefined"!=typeof d.style.zoom&&(d.innerHTML="",d.style.width=d.style.padding="1px",d.style.border=0,d.style.overflow="hidden",d.style.display="inline",d.style.zoom=1,t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div style='width:5px;'></div>",t.shrinkWrapBlocks=3!==d.offsetWidth),d.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:0;visibility:hidden;",d.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",n=d.firstChild,o=n.firstChild,r=n.nextSibling.firstChild.firstChild,r={doesNotAddBorder:5!==o.offsetTop,doesAddBorderForTableAndCells:5===r.offsetTop},o.style.position="fixed",o.style.top="20px",r.fixedPosition=20===o.offsetTop||15===o.offsetTop,o.style.position=o.style.top="",n.style.overflow="hidden",n.style.position="relative",r.subtractsBorderForOverflowNotVisible=-5===o.offsetTop,r.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(d.style.marginTop="1%",t.pixelMargin="1%"!==(e.getComputedStyle(d,null)||{marginTop:0}).marginTop),"undefined"!=typeof i.style.zoom&&(i.style.zoom=1),a.removeChild(i),d=null,E.extend(t,r))}),t}();var M=/^(?:\{.*\}|\[.*\])$/,W=/([A-Z])/g;E.extend({cache:{},uuid:0,expando:"jQuery"+(E.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?E.cache[e[E.expando]]:e[E.expando],!!e&&!o(e)},data:function(e,i,n,o){if(E.acceptData(e)){var r;r=E.expando;var s="string"==typeof i,a=e.nodeType,l=a?E.cache:e,d=a?e[r]:e[r]&&r,h="events"===i;if(d&&l[d]&&(h||o||l[d].data)||!s||n!==t)return d||(a?e[r]=d=++E.uuid:d=r),l[d]||(l[d]={},a||(l[d].toJSON=E.noop)),("object"==typeof i||"function"==typeof i)&&(o?l[d]=E.extend(l[d],i):l[d].data=E.extend(l[d].data,i)),r=e=l[d],o||(e.data||(e.data={}),e=e.data),n!==t&&(e[E.camelCase(i)]=n),h&&!e[i]?r.events:(s?(n=e[i],null==n&&(n=e[E.camelCase(i)])):n=e,n)}},removeData:function(e,t,i){if(E.acceptData(e)){var n,r,s,a=E.expando,l=e.nodeType,d=l?E.cache:e,h=l?e[a]:a;if(d[h]){if(t&&(n=i?d[h]:d[h].data)){E.isArray(t)||(t in n?t=[t]:(t=E.camelCase(t),t=t in n?[t]:t.split(" "))),r=0;for(s=t.length;s>r;r++)delete n[t[r]];if(!(i?o:E.isEmptyObject)(n))return}if(!i&&(delete d[h].data,!o(d[h])))return;E.support.deleteExpando||!d.setInterval?delete d[h]:d[h]=null,l&&(E.support.deleteExpando?delete e[a]:e.removeAttribute?e.removeAttribute(a):e[a]=null)}}},_data:function(e,t,i){return E.data(e,t,i,!0)},acceptData:function(e){if(e.nodeName){var t=E.noData[e.nodeName.toLowerCase()];if(t)return!(!0===t||e.getAttribute("classid")!==t)}return!0}}),E.fn.extend({data:function(e,i){var o,r,s,a,l,d=this[0],h=0,c=null;if(e===t){if(this.length&&(c=E.data(d),1===d.nodeType&&!E._data(d,"parsedAttrs"))){for(s=d.attributes,l=s.length;l>h;h++)a=s[h].name,0===a.indexOf("data-")&&(a=E.camelCase(a.substring(5)),n(d,a,c[a]));E._data(d,"parsedAttrs",!0)}return c}return"object"==typeof e?this.each(function(){E.data(this,e)}):(o=e.split(".",2),o[1]=o[1]?"."+o[1]:"",r=o[1]+"!",E.access(this,function(i){return i===t?(c=this.triggerHandler("getData"+r,[o[0]]),c===t&&d&&(c=E.data(d,e),c=n(d,e,c)),c===t&&o[1]?this.data(o[0]):c):(o[1]=i,void this.each(function(){var t=E(this);t.triggerHandler("setData"+r,o),E.data(this,e,i),t.triggerHandler("changeData"+r,o)}))},null,i,1<arguments.length,null,!1))},removeData:function(e){return this.each(function(){E.removeData(this,e)})}}),E.extend({_mark:function(e,t){e&&(t=(t||"fx")+"mark",E._data(e,t,(E._data(e,t)||0)+1))},_unmark:function(e,t,i){if(!0!==e&&(i=t,t=e,e=!1),t){i=i||"fx";var n=i+"mark";(e=e?0:(E._data(t,n)||1)-1)?E._data(t,n,e):(E.removeData(t,n,!0),r(t,i,"mark"))}},queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=E._data(e,t),i&&(!n||E.isArray(i)?n=E._data(e,t,E.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=E.queue(e,t),n=i.shift(),o={};"inprogress"===n&&(n=i.shift()),n&&("fx"===t&&i.unshift("inprogress"),E._data(e,t+".run",o),n.call(e,function(){E.dequeue(e,t)},o)),i.length||(E.removeData(e,t+"queue "+t+".run",!0),r(e,t,"queue"))}}),E.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?E.queue(this[0],e):i===t?this:this.each(function(){var t=E.queue(this,e,i);"fx"===e&&"inprogress"!==t[0]&&E.dequeue(this,e)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},delay:function(e,t){return e=E.fx?E.fx.speeds[e]||e:e,this.queue(t||"fx",function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){function n(){--l||r.resolveWith(s,[s])}"string"!=typeof e&&(i=e,e=t),e=e||"fx";for(var o,r=E.Deferred(),s=this,a=s.length,l=1,d=e+"defer",h=e+"queue",c=e+"mark";a--;)(o=E.data(s[a],d,t,!0)||(E.data(s[a],h,t,!0)||E.data(s[a],c,t,!0))&&E.data(s[a],d,E.Callbacks("once memory"),!0))&&(l++,o.add(n));return n(),r.promise(i)}});var $,R,B,O=/[\n\t\r]/g,N=/\s+/,F=/\r/g,z=/^(?:button|input)$/i,H=/^(?:button|input|object|select|textarea)$/i,U=/^a(?:rea)?$/i,j=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Y=E.support.getSetAttribute;E.fn.extend({attr:function(e,t){return E.access(this,E.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})},prop:function(e,t){return E.access(this,E.prop,e,t,1<arguments.length)},removeProp:function(e){return e=E.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,o,r,s,a;if(E.isFunction(e))return this.each(function(t){E(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(N),i=0,n=this.length;n>i;i++)if(o=this[i],1===o.nodeType)if(o.className||1!==t.length){for(r=" "+o.className+" ",s=0,a=t.length;a>s;s++)~r.indexOf(" "+t[s]+" ")||(r+=t[s]+" ");o.className=E.trim(r)}else o.className=e;return this},removeClass:function(e){var i,n,o,r,s,a,l;if(E.isFunction(e))return this.each(function(t){E(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(i=(e||"").split(N),
n=0,o=this.length;o>n;n++)if(r=this[n],1===r.nodeType&&r.className)if(e){for(s=(" "+r.className+" ").replace(O," "),a=0,l=i.length;l>a;a++)s=s.replace(" "+i[a]+" "," ");r.className=E.trim(s)}else r.className="";return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return E.isFunction(e)?this.each(function(i){E(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var o,r=0,s=E(this),a=t,l=e.split(N);o=l[r++];)a=n?a:!s.hasClass(o),s[a?"addClass":"removeClass"](o);else("undefined"===i||"boolean"===i)&&(this.className&&E._data(this,"__className__",this.className),this.className=this.className||!1===e?"":E._data(this,"__className__")||"")})},hasClass:function(e){e=" "+e+" ";for(var t=0,i=this.length;i>t;t++)if(1===this[t].nodeType&&-1<(" "+this[t].className+" ").replace(O," ").indexOf(e))return!0;return!1},val:function(e){var i,n,o,r=this[0];return arguments.length?(o=E.isFunction(e),this.each(function(n){var r=E(this);1===this.nodeType&&(n=o?e.call(this,n,r.val()):e,null==n?n="":"number"==typeof n?n+="":E.isArray(n)&&(n=E.map(n,function(e){return null==e?"":e+""})),i=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,n,"value")!==t||(this.value=n))})):r?(i=E.valHooks[r.type]||E.valHooks[r.nodeName.toLowerCase()])&&"get"in i&&(n=i.get(r,"value"))!==t?n:(n=r.value,"string"==typeof n?n.replace(F,""):null==n?"":n):void 0}}),E.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,i,n=e.selectedIndex,o=[],r=e.options,s="select-one"===e.type;if(0>n)return null;for(e=s?n:0,i=s?n+1:r.length;i>e;e++)if(t=r[e],!(!t.selected||(E.support.optDisabled?t.disabled:null!==t.getAttribute("disabled"))||t.parentNode.disabled&&E.nodeName(t.parentNode,"optgroup"))){if(t=E(t).val(),s)return t;o.push(t)}return s&&!o.length&&r.length?E(r[n]).val():o},set:function(e,t){var i=E.makeArray(t);return E(e).find("option").each(function(){this.selected=0<=E.inArray(E(this).val(),i)}),i.length||(e.selectedIndex=-1),i}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(e,i,n,o){var r,s,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a){if(o&&i in E.attrFn)return E(e)[i](n);if("undefined"==typeof e.getAttribute)return E.prop(e,i,n);if((o=1!==a||!E.isXMLDoc(e))&&(i=i.toLowerCase(),s=E.attrHooks[i]||(j.test(i)?R:$)),n===t)return s&&"get"in s&&o&&null!==(r=s.get(e,i))?r:(r=e.getAttribute(i),null===r?t:r);if(null!==n)return s&&"set"in s&&o&&(r=s.set(e,n,i))!==t?r:(e.setAttribute(i,""+n),n);E.removeAttr(e,i)}},removeAttr:function(e,t){var i,n,o,r,s,a=0;if(t&&1===e.nodeType)for(n=t.toLowerCase().split(N),r=n.length;r>a;a++)(o=n[a])&&(i=E.propFix[o]||o,(s=j.test(o))||E.attr(e,o,""),e.removeAttribute(Y?o:i),s&&i in e&&(e[i]=!1))},attrHooks:{type:{set:function(e,t){if(z.test(e.nodeName)&&e.parentNode)E.error("type property can't be changed");else if(!E.support.radioValue&&"radio"===t&&E.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}},value:{get:function(e,t){return $&&E.nodeName(e,"button")?$.get(e,t):t in e?e.value:null},set:function(e,t,i){return $&&E.nodeName(e,"button")?$.set(e,t,i):void(e.value=t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var o,r,s;return s=e.nodeType,e&&3!==s&&8!==s&&2!==s?((s=1!==s||!E.isXMLDoc(e))&&(i=E.propFix[i]||i,r=E.propHooks[i]),n!==t?r&&"set"in r&&(o=r.set(e,n,i))!==t?o:e[i]=n:r&&"get"in r&&null!==(o=r.get(e,i))?o:e[i]):void 0},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):H.test(e.nodeName)||U.test(e.nodeName)&&e.href?0:t}}}}),E.attrHooks.tabindex=E.propHooks.tabIndex,R={get:function(e,i){var n,o=E.prop(e,i);return!0===o||"boolean"!=typeof o&&(n=e.getAttributeNode(i))&&!1!==n.nodeValue?i.toLowerCase():t},set:function(e,t,i){return!1===t?E.removeAttr(e,i):(t=E.propFix[i]||i,t in e&&(e[t]=!0),e.setAttribute(i,i.toLowerCase())),i}},Y||(B={name:!0,id:!0,coords:!0},$=E.valHooks.button={get:function(e,i){var n;return(n=e.getAttributeNode(i))&&(B[i]?""!==n.nodeValue:n.specified)?n.nodeValue:t},set:function(e,t,i){var n=e.getAttributeNode(i);return n||(n=L.createAttribute(i),e.setAttributeNode(n)),n.nodeValue=t+""}},E.attrHooks.tabindex.set=$.set,E.each(["width","height"],function(e,t){E.attrHooks[t]=E.extend(E.attrHooks[t],{set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}})}),E.attrHooks.contenteditable={get:$.get,set:function(e,t,i){""===t&&(t="false"),$.set(e,t,i)}}),E.support.hrefNormalized||E.each(["href","src","width","height"],function(e,i){E.attrHooks[i]=E.extend(E.attrHooks[i],{get:function(e){return e=e.getAttribute(i,2),null===e?t:e}})}),E.support.style||(E.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),E.support.optSelected||(E.propHooks.selected=E.extend(E.propHooks.selected,{get:function(e){return(e=e.parentNode)&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),E.support.enctype||(E.propFix.enctype="encoding"),E.support.checkOn||E.each(["radio","checkbox"],function(){E.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]=E.extend(E.valHooks[this],{set:function(e,t){return E.isArray(t)?e.checked=0<=E.inArray(E(e).val(),t):void 0}})});var q=/^(?:textarea|input|select)$/i,G=/^([^\.]*)?(?:\.(.+))?$/,J=/(?:^|\s)hover(\.\S+)?\b/,X=/^key/,K=/^(?:mouse|contextmenu)|click/,Q=/^(?:focusinfocus|focusoutblur)$/,Z=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,ee=function(e){return(e=Z.exec(e))&&(e[1]=(e[1]||"").toLowerCase(),e[3]=e[3]&&new RegExp("(?:^|\\s)"+e[3]+"(?:\\s|$)")),e},te=function(e){return E.event.special.hover?e:e.replace(J,"mouseenter$1 mouseleave$1")};E.event={add:function(e,i,n,o,r){var s,a,l,d,h,c,p,u,f;if(3!==e.nodeType&&8!==e.nodeType&&i&&n&&(s=E._data(e))){for(n.handler&&(p=n,n=p.handler,r=p.selector),n.guid||(n.guid=E.guid++),l=s.events,l||(s.events=l={}),a=s.handle,a||(s.handle=a=function(e){return"undefined"==typeof E||e&&E.event.triggered===e.type?t:E.event.dispatch.apply(a.elem,arguments)},a.elem=e),i=E.trim(te(i)).split(" "),s=0;s<i.length;s++)d=G.exec(i[s])||[],h=d[1],c=(d[2]||"").split(".").sort(),f=E.event.special[h]||{},h=(r?f.delegateType:f.bindType)||h,f=E.event.special[h]||{},d=E.extend({type:h,origType:d[1],data:o,handler:n,guid:n.guid,selector:r,quick:r&&ee(r),namespace:c.join(".")},p),u=l[h],u||(u=l[h]=[],u.delegateCount=0,f.setup&&!1!==f.setup.call(e,o,c,a)||(e.addEventListener?e.addEventListener(h,a,!1):e.attachEvent&&e.attachEvent("on"+h,a))),f.add&&(f.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),r?u.splice(u.delegateCount++,0,d):u.push(d),E.event.global[h]=!0;e=null}},global:{},remove:function(e,t,i,n,o){var r,s,a,l,d,h,c,p,u,f,g=E.hasData(e)&&E._data(e);if(g&&(c=g.events)){for(t=E.trim(te(t||"")).split(" "),r=0;r<t.length;r++)if(s=G.exec(t[r])||[],a=l=s[1],s=s[2],a){for(p=E.event.special[a]||{},a=(n?p.delegateType:p.bindType)||a,u=c[a]||[],d=u.length,s=s?new RegExp("(^|\\.)"+s.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,h=0;h<u.length;h++)f=u[h],!o&&l!==f.origType||i&&i.guid!==f.guid||s&&!s.test(f.namespace)||n&&n!==f.selector&&("**"!==n||!f.selector)||(u.splice(h--,1),f.selector&&u.delegateCount--,p.remove&&p.remove.call(e,f));0===u.length&&d!==u.length&&(p.teardown&&!1!==p.teardown.call(e,s)||E.removeEvent(e,a,g.handle),delete c[a])}else for(a in c)E.event.remove(e,a+t[r],i,n,!0);E.isEmptyObject(c)&&((t=g.handle)&&(t.elem=null),E.removeData(e,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(i,n,o,r){if(!o||3!==o.nodeType&&8!==o.nodeType){var s,a,l,d,h,c=i.type||i,p=[];if(!Q.test(c+E.event.triggered)&&(0<=c.indexOf("!")&&(c=c.slice(0,-1),s=!0),0<=c.indexOf(".")&&(p=c.split("."),c=p.shift(),p.sort()),o&&!E.event.customEvent[c]||E.event.global[c]))if(i="object"==typeof i?i[E.expando]?i:new E.Event(c,i):new E.Event(c),i.type=c,i.isTrigger=!0,i.exclusive=s,i.namespace=p.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,s=0>c.indexOf(":")?"on"+c:"",o){if(i.result=t,i.target||(i.target=o),n=null!=n?E.makeArray(n):[],n.unshift(i),l=E.event.special[c]||{},!l.trigger||!1!==l.trigger.apply(o,n)){if(h=[[o,l.bindType||c]],!r&&!l.noBubble&&!E.isWindow(o)){for(d=l.delegateType||c,p=Q.test(d+c)?o:o.parentNode,a=null;p;p=p.parentNode)h.push([p,d]),a=p;a&&a===o.ownerDocument&&h.push([a.defaultView||a.parentWindow||e,d])}for(a=0;a<h.length&&!i.isPropagationStopped();a++)p=h[a][0],i.type=h[a][1],(d=(E._data(p,"events")||{})[i.type]&&E._data(p,"handle"))&&d.apply(p,n),(d=s&&p[s])&&E.acceptData(p)&&!1===d.apply(p,n)&&i.preventDefault();return i.type=c,r||i.isDefaultPrevented()||l._default&&!1!==l._default.apply(o.ownerDocument,n)||"click"===c&&E.nodeName(o,"a")||!E.acceptData(o)||!s||!o[c]||("focus"===c||"blur"===c)&&0===i.target.offsetWidth||E.isWindow(o)||((a=o[s])&&(o[s]=null),E.event.triggered=c,o[c](),E.event.triggered=t,a&&(o[s]=a)),i.result}}else for(a in o=E.cache)o[a].events&&o[a].events[c]&&E.event.trigger(i,n,o[a].handle.elem,!0)}},dispatch:function(i){i=E.event.fix(i||e.event);var n,o,r,s,a,l,d,h=(E._data(this,"events")||{})[i.type]||[],c=h.delegateCount,p=[].slice.call(arguments,0),u=!i.exclusive&&!i.namespace,f=E.event.special[i.type]||{},g=[];if(p[0]=i,i.delegateTarget=this,!f.preDispatch||!1!==f.preDispatch.call(this,i)){if(c&&(!i.button||"click"!==i.type))for(r=E(this),r.context=this.ownerDocument||this,o=i.target;o!=this;o=o.parentNode||this)if(!0!==o.disabled){for(a={},l=[],r[0]=o,n=0;c>n;n++){if(s=h[n],d=s.selector,a[d]===t){var m,_=a,v=d;if(s.quick){m=s.quick;var y=o.attributes||{};m=(!m[1]||o.nodeName.toLowerCase()===m[1])&&(!m[2]||(y.id||{}).value===m[2])&&(!m[3]||m[3].test((y["class"]||{}).value))}else m=r.is(d);_[v]=m}a[d]&&l.push(s)}l.length&&g.push({elem:o,matches:l})}for(h.length>c&&g.push({elem:this,matches:h.slice(c)}),n=0;n<g.length&&!i.isPropagationStopped();n++)for(c=g[n],i.currentTarget=c.elem,h=0;h<c.matches.length&&!i.isImmediatePropagationStopped();h++)s=c.matches[h],(u||!i.namespace&&!s.namespace||i.namespace_re&&i.namespace_re.test(s.namespace))&&(i.data=s.data,i.handleObj=s,s=((E.event.special[s.origType]||{}).handle||s.handler).apply(c.elem,p),s!==t&&(i.result=s,!1===s&&(i.preventDefault(),i.stopPropagation())));return f.postDispatch&&f.postDispatch.call(this,i),i.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,o,r=i.button,s=i.fromElement;return null==e.pageX&&null!=i.clientX&&(n=e.target.ownerDocument||L,o=n.documentElement,n=n.body,e.pageX=i.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?i.toElement:s),e.which||r===t||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[E.expando])return e;var i,n,o=e,r=E.event.fixHooks[e.type]||{},s=r.props?this.props.concat(r.props):this.props;for(e=E.Event(o),i=s.length;i;)n=s[--i],e[n]=o[n];return e.target||(e.target=o.srcElement||L),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey===t&&(e.metaKey=e.ctrlKey),r.filter?r.filter(e,o):e},special:{ready:{setup:E.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,i){E.isWindow(this)&&(this.onbeforeunload=i)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,i,n){e=E.extend(new E.Event,i,{type:e,isSimulated:!0,originalEvent:{}}),n?E.event.trigger(e,null,t):E.event.dispatch.call(t,e),e.isDefaultPrevented()&&i.preventDefault()}},E.event.handle=E.event.dispatch,E.removeEvent=L.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent&&e.detachEvent("on"+t,i)},E.Event=function(e,t){return this instanceof E.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?a:s):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||E.now(),void(this[E.expando]=!0)):new E.Event(e,t)},E.Event.prototype={preventDefault:function(){this.isDefaultPrevented=a;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=a;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},E.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){E.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=e.relatedTarget,o=e.handleObj;return(!n||n!==this&&!E.contains(this,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),E.support.submitBubbles||(E.event.special.submit={setup:function(){return E.nodeName(this,"form")?!1:void E.event.add(this,"click._submit keypress._submit",function(e){e=e.target,(e=E.nodeName(e,"input")||E.nodeName(e,"button")?e.form:t)&&!e._submit_attached&&(E.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),e._submit_attached=!0)})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&E.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return E.nodeName(this,"form")?!1:void E.event.remove(this,"._submit")}}),E.support.changeBubbles||(E.event.special.change={setup:function(){return q.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(E.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),E.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1,E.event.simulate("change",this,e,!0))})),!1):void E.event.add(this,"beforeactivate._change",function(e){e=e.target,q.test(e.nodeName)&&!e._change_attached&&(E.event.add(e,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||E.event.simulate("change",this.parentNode,e,!0)}),e._change_attached=!0)})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return E.event.remove(this,"._change"),q.test(this.nodeName)}}),E.support.focusinBubbles||E.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){E.event.simulate(t,e.target,E.event.fix(e),!0)};E.event.special[t]={setup:function(){0===i++&&L.addEventListener(e,n,!0)},teardown:function(){0===--i&&L.removeEventListener(e,n,!0)}}}),E.fn.extend({on:function(e,i,n,o,r){var a,l;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(l in e)this.on(l,i,n,e[l],r);return this}if(null==n&&null==o?(o=i,n=i=t):null==o&&("string"==typeof i?(o=n,n=t):(o=n,n=i,i=t)),!1===o)o=s;else if(!o)return this;return 1===r&&(a=o,o=function(e){return E().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=E.guid++)),this.each(function(){E.event.add(this,e,o,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){if(e&&e.preventDefault&&e.handleObj){var o=e.handleObj;return E(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this}if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(!1===i||"function"==typeof i)&&(n=i,i=t),!1===n&&(n=s),this.each(function(){E.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,i){return E(this.context).on(e,this.selector,t,i),this},die:function(e,t){return E(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1==arguments.length?this.off(e,"**"):this.off(t,e,i)},trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?E.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,i=e.guid||E.guid++,n=0,o=function(i){var o=(E._data(this,"lastToggle"+e.guid)||0)%n;return E._data(this,"lastToggle"+e.guid,o+1),i.preventDefault(),t[o].apply(this,arguments)||!1};for(o.guid=i;n<t.length;)t[n++].guid=i;return this.click(o)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){E.fn[t]=function(e,i){return null==i&&(i=e,e=null),0<arguments.length?this.on(t,null,e,i):this.trigger(t)},E.attrFn&&(E.attrFn[t]=!0),X.test(t)&&(E.event.fixHooks[t]=E.event.keyHooks),K.test(t)&&(E.event.fixHooks[t]=E.event.mouseHooks)}),function(){function e(e,t,i,n,r,s){r=0;for(var a=n.length;a>r;r++){var l=n[r];if(l){for(var d=!1,l=l[e];l;){if(l[o]===i){d=n[l.sizset];break}if(1!==l.nodeType||s||(l[o]=i,l.sizset=r),l.nodeName.toLowerCase()===t){d=l;break}l=l[e]}n[r]=d}}}function i(e,t,i,n,r,s){r=0;for(var a=n.length;a>r;r++){var l=n[r];if(l){for(var d=!1,l=l[e];l;){if(l[o]===i){d=n[l.sizset];break}if(1===l.nodeType)if(s||(l[o]=i,l.sizset=r),"string"!=typeof t){if(l===t){d=!0;break}}else if(0<p.filter(t,[l]).length){d=l;break}l=l[e]}n[r]=d}}}var n=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,o="sizcache"+(Math.random()+"").replace(".",""),r=0,s=Object.prototype.toString,a=!1,l=!0,d=/\\/g,h=/\r\n/g,c=/\W/;[0,0].sort(function(){return l=!1,0});var p=function(e,t,i,o){i=i||[];var r=t=t||L;if(1!==t.nodeType&&9!==t.nodeType)return[];if(!e||"string"!=typeof e)return i;var a,l,d,h,c,u=!0,f=p.isXML(t),_=[],y=e;do if(n.exec(""),(a=n.exec(y))&&(y=a[3],_.push(a[1]),a[2])){h=a[3];break}while(a);if(1<_.length&&m.exec(e))if(2===_.length&&g.relative[_[0]])l=T(_[0]+_[1],t,o);else for(l=g.relative[_[0]]?[t]:p(_.shift(),t);_.length;)e=_.shift(),g.relative[e]&&(e+=_.shift()),l=T(e,l,o);else if(!o&&1<_.length&&9===t.nodeType&&!f&&g.match.ID.test(_[0])&&!g.match.ID.test(_[_.length-1])&&(a=p.find(_.shift(),t,f),t=a.expr?p.filter(a.expr,a.set)[0]:a.set[0]),t)for(a=o?{expr:_.pop(),set:v(o)}:p.find(_.pop(),1!==_.length||"~"!==_[0]&&"+"!==_[0]||!t.parentNode?t:t.parentNode,f),l=a.expr?p.filter(a.expr,a.set):a.set,0<_.length?d=v(l):u=!1;_.length;)a=c=_.pop(),g.relative[c]?a=_.pop():c="",null==a&&(a=t),g.relative[c](d,a,f);else d=[];if(d||(d=l),d||p.error(c||e),"[object Array]"===s.call(d))if(u)if(t&&1===t.nodeType)for(e=0;null!=d[e];e++)d[e]&&(!0===d[e]||1===d[e].nodeType&&p.contains(t,d[e]))&&i.push(l[e]);else for(e=0;null!=d[e];e++)d[e]&&1===d[e].nodeType&&i.push(l[e]);else i.push.apply(i,d);else v(d,i);return h&&(p(h,r,i,o),p.uniqueSort(i)),i};p.uniqueSort=function(e){if(w&&(a=l,e.sort(w),a))for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1);return e},p.matches=function(e,t){return p(e,null,null,t)},p.matchesSelector=function(e,t){return 0<p(t,null,null,[e]).length},p.find=function(e,t,i){var n,o,r,s,a,l;if(!e)return[];for(o=0,r=g.order.length;r>o;o++)if(a=g.order[o],(s=g.leftMatch[a].exec(e))&&(l=s[1],s.splice(1,1),"\\"!==l.substr(l.length-1)&&(s[1]=(s[1]||"").replace(d,""),n=g.find[a](s,t,i),null!=n))){e=e.replace(g.match[a],"");break}return n||(n="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName("*"):[]),{set:n,expr:e}},p.filter=function(e,i,n,o){for(var r,s,a,l,d,h,c,u,f=e,m=[],_=i,v=i&&i[0]&&p.isXML(i[0]);e&&i.length;){for(a in g.filter)if(null!=(r=g.leftMatch[a].exec(e))&&r[2]&&(h=g.filter[a],d=r[1],s=!1,r.splice(1,1),"\\"!==d.substr(d.length-1))){if(_===m&&(m=[]),g.preFilter[a])if(r=g.preFilter[a](r,_,n,m,o,v),r){if(!0===r)continue}else s=l=!0;if(r)for(c=0;null!=(d=_[c]);c++)d&&(l=h(d,r,c,_),u=o^l,n&&null!=l?u?s=!0:_[c]=!1:u&&(m.push(d),s=!0));if(l!==t){if(n||(_=m),e=e.replace(g.match[a],""),!s)return[];break}}if(e===f){if(null!=s)break;p.error(e)}f=e}return _},p.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)};var u,f=p.getText=function(e){var t,i;t=e.nodeType;var n="";if(t){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;if("string"==typeof e.innerText)return e.innerText.replace(h,"");for(e=e.firstChild;e;e=e.nextSibling)n+=f(e)}else if(3===t||4===t)return e.nodeValue}else for(t=0;i=e[t];t++)8!==i.nodeType&&(n+=f(i));return n},g=p.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var i="string"==typeof t,n=i&&!c.test(t),i=i&&!n;n&&(t=t.toLowerCase());for(var o,n=0,r=e.length;r>n;n++)if(o=e[n]){for(;(o=o.previousSibling)&&1!==o.nodeType;);e[n]=i||o&&o.nodeName.toLowerCase()===t?o||!1:o===t}i&&p.filter(t,e,!0)},">":function(e,t){var i,n="string"==typeof t,o=0,r=e.length;if(n&&!c.test(t))for(t=t.toLowerCase();r>o;o++)(i=e[o])&&(i=i.parentNode,e[o]=i.nodeName.toLowerCase()===t?i:!1);else{for(;r>o;o++)(i=e[o])&&(e[o]=n?i.parentNode:i.parentNode===t);n&&p.filter(t,e,!0)}},"":function(t,n,o){var s,a=r++,l=i;"string"!=typeof n||c.test(n)||(s=n=n.toLowerCase(),l=e),l("parentNode",n,a,t,s,o)},"~":function(t,n,o){var s,a=r++,l=i;"string"!=typeof n||c.test(n)||(s=n=n.toLowerCase(),l=e),l("previousSibling",n,a,t,s,o)}},find:{ID:function(e,t,i){return"undefined"==typeof t.getElementById||i?void 0:(e=t.getElementById(e[1]))&&e.parentNode?[e]:[]},NAME:function(e,t){if("undefined"!=typeof t.getElementsByName){for(var i=[],n=t.getElementsByName(e[1]),o=0,r=n.length;r>o;o++)n[o].getAttribute("name")===e[1]&&i.push(n[o]);return 0===i.length?null:i}},TAG:function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e[1]):void 0}},preFilter:{CLASS:function(e,t,i,n,o,r){if(e=" "+e[1].replace(d,"")+" ",r)return e;r=0;for(var s;null!=(s=t[r]);r++)s&&(o^(s.className&&0<=(" "+s.className+" ").replace(/[\t\n\r]/g," ").indexOf(e))?i||n.push(s):i&&(t[r]=!1));return!1},ID:function(e){return e[1].replace(d,"")},TAG:function(e,t){return e[1].replace(d,"").toLowerCase()},CHILD:function(e){if("nth"===e[1]){e[2]||p.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===e[2]&&"2n"||"odd"===e[2]&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&p.error(e[0]);return e[0]=r++,e},ATTR:function(e,t,i,n,o,r){return t=e[1]=e[1].replace(d,""),!r&&g.attrMap[t]&&(e[1]=g.attrMap[t]),e[4]=(e[4]||e[5]||"").replace(d,""),"~="===e[2]&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(e,t,i,o,r){if("not"===e[1]){if(!(1<(n.exec(e[3])||"").length||/^\w/.test(e[3])))return e=p.filter(e[3],t,i,1^r),i||o.push.apply(o,e),!1;e[3]=p(e[3],null,null,t)}else if(g.match.POS.test(e[0])||g.match.CHILD.test(e[0]))return!0;return e},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return!1===e.disabled&&"hidden"!==e.type},disabled:function(e){return!0===e.disabled},checked:function(e){return!0===e.checked},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,i){return!!p(i[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),i=e.type;return"input"===e.nodeName.toLowerCase()&&"text"===i&&(t===i||null===t)},radio:function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},checkbox:function(e){return"input"===e.nodeName.toLowerCase()&&"checkbox"===e.type},file:function(e){return"input"===e.nodeName.toLowerCase()&&"file"===e.type},password:function(e){return"input"===e.nodeName.toLowerCase()&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"submit"===e.type},image:function(e){return"input"===e.nodeName.toLowerCase()&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return 0===t},last:function(e,t,i,n){return t===n.length-1},even:function(e,t){return 0===t%2},odd:function(e,t){return 1===t%2},lt:function(e,t,i){return t<i[3]-0},gt:function(e,t,i){return t>i[3]-0},nth:function(e,t,i){return i[3]-0===t},eq:function(e,t,i){return i[3]-0===t}},filter:{PSEUDO:function(e,t,i,n){var o=t[1],r=g.filters[o];if(r)return r(e,i,t,n);if("contains"===o)return 0<=(e.textContent||e.innerText||f([e])||"").indexOf(t[3]);if("not"===o){for(t=t[3],i=0,n=t.length;n>i;i++)if(t[i]===e)return!1;return!0}p.error(o)},CHILD:function(e,t){var i,n,r,s,a,l;switch(i=t[1],l=e,i){case"only":case"first":for(;l=l.previousSibling;)if(1===l.nodeType)return!1;if("first"===i)return!0;l=e;case"last":for(;l=l.nextSibling;)if(1===l.nodeType)return!1;return!0;case"nth":if(i=t[2],n=t[3],1===i&&0===n)return!0;if(r=t[0],(s=e.parentNode)&&(s[o]!==r||!e.nodeIndex)){for(a=0,l=s.firstChild;l;l=l.nextSibling)1===l.nodeType&&(l.nodeIndex=++a);s[o]=r}return l=e.nodeIndex-n,0===i?0===l:0===l%i&&l/i>=0}},ID:function(e,t){return 1===e.nodeType&&e.getAttribute("id")===t},TAG:function(e,t){return"*"===t&&1===e.nodeType||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return-1<(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)},ATTR:function(e,t){var i=t[1],i=p.attr?p.attr(e,i):g.attrHandle[i]?g.attrHandle[i](e):null!=e[i]?e[i]:e.getAttribute(i),n=i+"",o=t[2],r=t[4];return null==i?"!="===o:!o&&p.attr?null!=i:"="===o?n===r:"*="===o?0<=n.indexOf(r):"~="===o?0<=(" "+n+" ").indexOf(r):r?"!="===o?n!==r:"^="===o?0===n.indexOf(r):"$="===o?n.substr(n.length-r.length)===r:"|="===o?n===r||n.substr(0,r.length+1)===r+"-":!1:n&&!1!==i},POS:function(e,t,i,n){var o=g.setFilters[t[2]];return o?o(e,i,t,n):void 0}}},m=g.match.POS,_=function(e,t){return"\\"+(t-0+1)};for(u in g.match)g.match[u]=new RegExp(g.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source),g.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+g.match[u].source.replace(/\\(\d+)/g,_));g.match.globalPOS=m;var v=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(L.documentElement.childNodes,0)[0].nodeType}catch(y){v=function(e,t){var i=0,n=t||[];if("[object Array]"===s.call(e))Array.prototype.push.apply(n,e);else if("number"==typeof e.length)for(var o=e.length;o>i;i++)n.push(e[i]);else for(;e[i];i++)n.push(e[i]);return n}}var w,b;L.documentElement.compareDocumentPosition?w=function(e,t){return e===t?(a=!0,0):e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1}:(w=function(e,t){if(e===t)return a=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var i,n,o=[],r=[];i=e.parentNode,n=t.parentNode;var s=i;if(i===n)return b(e,t);if(!i)return-1;if(!n)return 1;for(;s;)o.unshift(s),s=s.parentNode;for(s=n;s;)r.unshift(s),s=s.parentNode;for(i=o.length,n=r.length,s=0;i>s&&n>s;s++)if(o[s]!==r[s])return b(o[s],r[s]);return s===i?b(e,r[s],-1):b(o[s],t,1)},b=function(e,t,i){if(e===t)return i;for(e=e.nextSibling;e;){if(e===t)return-1;e=e.nextSibling}return 1}),function(){var e=L.createElement("div"),i="script"+(new Date).getTime(),n=L.documentElement;e.innerHTML="<a name='"+i+"'/>",n.insertBefore(e,n.firstChild),L.getElementById(i)&&(g.find.ID=function(e,i,n){return"undefined"==typeof i.getElementById||n?void 0:(i=i.getElementById(e[1]))?i.id===e[1]||"undefined"!=typeof i.getAttributeNode&&i.getAttributeNode("id").nodeValue===e[1]?[i]:t:[]},g.filter.ID=function(e,t){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return 1===e.nodeType&&i&&i.nodeValue===t}),n.removeChild(e),n=e=null}(),function(){var e=L.createElement("div");e.appendChild(L.createComment("")),0<e.getElementsByTagName("*").length&&(g.find.TAG=function(e,t){var i=t.getElementsByTagName(e[1]);if("*"===e[1]){for(var n=[],o=0;i[o];o++)1===i[o].nodeType&&n.push(i[o]);i=n}return i}),e.innerHTML="<a href='#'></a>",e.firstChild&&"undefined"!=typeof e.firstChild.getAttribute&&"#"!==e.firstChild.getAttribute("href")&&(g.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),L.querySelectorAll&&function(){var e=p,t=L.createElement("div");if(t.innerHTML="<p class='TEST'></p>",!t.querySelectorAll||0!==t.querySelectorAll(".TEST").length){p=function(t,i,n,o){if(i=i||L,!o&&!p.isXML(i)){var r=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);if(r&&(1===i.nodeType||9===i.nodeType)){if(r[1])return v(i.getElementsByTagName(t),n);if(r[2]&&g.find.CLASS&&i.getElementsByClassName)return v(i.getElementsByClassName(r[2]),n)}if(9===i.nodeType){if("body"===t&&i.body)return v([i.body],n);if(r&&r[3]){var s=i.getElementById(r[3]);if(!s||!s.parentNode)return v([],n);if(s.id===r[3])return v([s],n)}try{return v(i.querySelectorAll(t),n)}catch(a){}}else if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){var r=i,l=(s=i.getAttribute("id"))||"__sizzle__",d=i.parentNode,h=/^\s*[+~]/.test(t);s?l=l.replace(/'/g,"\\$&"):i.setAttribute("id",l),h&&d&&(i=i.parentNode);try{if(!h||d)return v(i.querySelectorAll("[id='"+l+"'] "+t),n)}catch(c){}finally{s||r.removeAttribute("id")}}}return e(t,i,n,o)};for(var i in e)p[i]=e[i];t=null}}(),function(){var e=L.documentElement,t=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(t){var i=!t.call(L.createElement("div"),"div"),n=!1;try{t.call(L.documentElement,"[test!='']:sizzle")}catch(o){n=!0}p.matchesSelector=function(e,o){if(o=o.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!p.isXML(e))try{if(n||!g.match.PSEUDO.test(o)&&!/!=/.test(o)){var r=t.call(e,o);if(r||!i||e.document&&11!==e.document.nodeType)return r}}catch(s){}return 0<p(o,null,null,[e]).length}}}(),function(){var e=L.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>",e.getElementsByClassName&&0!==e.getElementsByClassName("e").length&&(e.lastChild.className="e",1!==e.getElementsByClassName("e").length&&(g.order.splice(1,0,"CLASS"),g.find.CLASS=function(e,t,i){return"undefined"==typeof t.getElementsByClassName||i?void 0:t.getElementsByClassName(e[1])},e=null))}(),p.contains=L.documentElement.contains?function(e,t){
return e!==t&&(e.contains?e.contains(t):!0)}:L.documentElement.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:function(){return!1},p.isXML=function(e){return(e=(e?e.ownerDocument||e:0).documentElement)?"HTML"!==e.nodeName:!1};var T=function(e,t,i){var n,o=[],r="";for(t=t.nodeType?[t]:t;n=g.match.PSEUDO.exec(e);)r+=n[0],e=e.replace(g.match.PSEUDO,"");e=g.relative[e]?e+"*":e,n=0;for(var s=t.length;s>n;n++)p(e,t[n],o,i);return p.filter(r,o)};p.attr=E.attr,p.selectors.attrMap={},E.find=p,E.expr=p.selectors,E.expr[":"]=E.expr.filters,E.unique=p.uniqueSort,E.text=p.getText,E.isXMLDoc=p.isXML,E.contains=p.contains}();var ie=/Until$/,ne=/^(?:parents|prevUntil|prevAll)/,oe=/,/,re=/^.[^:#\[\.,]*$/,se=Array.prototype.slice,ae=E.expr.match.globalPOS,le={children:!0,contents:!0,next:!0,prev:!0};E.fn.extend({find:function(e){var t,i,n=this;if("string"!=typeof e)return E(e).filter(function(){for(t=0,i=n.length;i>t;t++)if(E.contains(n[t],this))return!0});var o,r,s,a=this.pushStack("","find",e);for(t=0,i=this.length;i>t;t++)if(o=a.length,E.find(e,this[t],a),t>0)for(r=o;r<a.length;r++)for(s=0;o>s;s++)if(a[s]===a[r]){a.splice(r--,1);break}return a},has:function(e){var t=E(e);return this.filter(function(){for(var e=0,i=t.length;i>e;e++)if(E.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(d(this,e,!1),"not",e)},filter:function(e){return this.pushStack(d(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?ae.test(e)?0<=E(e,this.context).index(this[0]):0<E.filter(e,this).length:0<this.filter(e).length)},closest:function(e,t){var i,n,o=[],r=this[0];if(E.isArray(e)){for(n=1;r&&r.ownerDocument&&r!==t;){for(i=0;i<e.length;i++)E(r).is(e[i])&&o.push({selector:e[i],elem:r,level:n});r=r.parentNode,n++}return o}var s=ae.test(e)||"string"!=typeof e?E(e,t||this.context):0;for(i=0,n=this.length;n>i;i++)for(r=this[i];r;){if(s?-1<s.index(r):E.find.matchesSelector(r,e)){o.push(r);break}if(r=r.parentNode,!r||!r.ownerDocument||r===t||11===r.nodeType)break}return o=1<o.length?E.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?E.inArray(this[0],E(e)):E.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var i="string"==typeof e?E(e,t):E.makeArray(e&&e.nodeType?[e]:e),n=E.merge(this.get(),i);return this.pushStack(l(i[0])||l(n[0])?n:E.unique(n))},andSelf:function(){return this.add(this.prevObject)}}),E.each({parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},parents:function(e){return E.dir(e,"parentNode")},parentsUntil:function(e,t,i){return E.dir(e,"parentNode",i)},next:function(e){return E.nth(e,2,"nextSibling")},prev:function(e){return E.nth(e,2,"previousSibling")},nextAll:function(e){return E.dir(e,"nextSibling")},prevAll:function(e){return E.dir(e,"previousSibling")},nextUntil:function(e,t,i){return E.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return E.dir(e,"previousSibling",i)},siblings:function(e){return E.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return E.sibling(e.firstChild)},contents:function(e){return E.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:E.makeArray(e.childNodes)}},function(e,t){E.fn[e]=function(i,n){var o=E.map(this,t,i);return ie.test(e)||(n=i),n&&"string"==typeof n&&(o=E.filter(n,o)),o=1<this.length&&!le[e]?E.unique(o):o,(1<this.length||oe.test(n))&&ne.test(e)&&(o=o.reverse()),this.pushStack(o,e,se.call(arguments).join(","))}}),E.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?E.find.matchesSelector(t[0],e)?[t[0]]:[]:E.find.matches(e,t)},dir:function(e,i,n){var o=[];for(e=e[i];e&&9!==e.nodeType&&(n===t||1!==e.nodeType||!E(e).is(n));)1===e.nodeType&&o.push(e),e=e[i];return o},nth:function(e,t,i,n){for(t=t||1,n=0;e&&(1!==e.nodeType||++n!==t);e=e[i]);return e},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var de="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",he=/ jQuery\d+="(?:\d+|null)"/g,ce=/^\s+/,pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ue=/<([\w:]+)/,fe=/<tbody/i,ge=/<|&#?\w+;/,me=/<(?:script|style)/i,_e=/<(?:script|object|embed|option|style)/i,ve=new RegExp("<(?:"+de+")[\\s/>]","i"),ye=/checked\s*(?:[^=]|=\s*.checked.)/i,we=/\/(java|ecma)script/i,be=/^\s*<!(?:\[CDATA\[|\-\-)/,Te={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Se=h(L);Te.optgroup=Te.option,Te.tbody=Te.tfoot=Te.colgroup=Te.caption=Te.thead,Te.th=Te.td,E.support.htmlSerialize||(Te._default=[1,"div<div>","</div>"]),E.fn.extend({text:function(e){return E.access(this,function(e){return e===t?E.text(this):this.empty().append((this[0]&&this[0].ownerDocument||L).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(E.isFunction(e))return this.each(function(t){E(this).wrapAll(e.call(this,t))});if(this[0]){var t=E(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return E.isFunction(e)?this.each(function(t){E(this).wrapInner(e.call(this,t))}):this.each(function(){var t=E(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=E.isFunction(e);return this.each(function(i){E(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){E.nodeName(this,"body")||E(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.insertBefore(e,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=E.clean(arguments);return e.push.apply(e,this.toArray()),this.pushStack(e,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=this.pushStack(this,"after",arguments);return e.push.apply(e,E.clean(arguments)),e}},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||E.filter(e,[i]).length)&&(t||1!==i.nodeType||(E.cleanData(i.getElementsByTagName("*")),E.cleanData([i])),i.parentNode&&i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&E.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return E.access(this,function(e){var i=this[0]||{},n=0,o=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(he,""):null;if(!("string"!=typeof e||me.test(e)||!E.support.leadingWhitespace&&ce.test(e)||Te[(ue.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(pe,"<$1></$2>");try{for(;o>n;n++)i=this[n]||{},1===i.nodeType&&(E.cleanData(i.getElementsByTagName("*")),i.innerHTML=e);i=0}catch(r){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return this[0]&&this[0].parentNode?E.isFunction(e)?this.each(function(t){var i=E(this),n=i.html();i.replaceWith(e.call(this,t,n))}):("string"!=typeof e&&(e=E(e).detach()),this.each(function(){var t=this.nextSibling,i=this.parentNode;E(this).remove(),t?E(t).before(e):E(i).append(e)})):this.length?this.pushStack(E(E.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){var o,r,s,a=e[0],l=[];if(!E.support.checkClone&&3===arguments.length&&"string"==typeof a&&ye.test(a))return this.each(function(){E(this).domManip(e,i,n,!0)});if(E.isFunction(a))return this.each(function(o){var r=E(this);e[0]=a.call(this,o,i?r.html():t),r.domManip(e,i,n)});if(this[0]){if(o=a&&a.parentNode,o=E.support.parentNode&&o&&11===o.nodeType&&o.childNodes.length===this.length?{fragment:o}:E.buildFragment(e,this,l),s=o.fragment,r=1===s.childNodes.length?s=s.firstChild:s.firstChild){i=i&&E.nodeName(r,"tr");for(var d=0,h=this.length,p=h-1;h>d;d++)n.call(i?c(this[d],r):this[d],o.cacheable||h>1&&p>d?E.clone(s,!0,!0):s)}l.length&&E.each(l,function(e,t){t.src?E.ajax({type:"GET",global:!1,url:t.src,async:!1,dataType:"script"}):E.globalEval((t.text||t.textContent||t.innerHTML||"").replace(be,"/*$0*/")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),E.buildFragment=function(e,t,i){var n,o,r,s,a=e[0];return t&&t[0]&&(s=t[0].ownerDocument||t[0]),s.createDocumentFragment||(s=L),!(1===e.length&&"string"==typeof a&&512>a.length&&s===L&&"<"===a.charAt(0))||_e.test(a)||!E.support.checkClone&&ye.test(a)||!E.support.html5Clone&&ve.test(a)||(o=!0,(r=E.fragments[a])&&1!==r&&(n=r)),n||(n=s.createDocumentFragment(),E.clean(e,s,n,i)),o&&(E.fragments[a]=r?n:1),{fragment:n,cacheable:o}},E.fragments={},E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){E.fn[e]=function(i){var n=[];i=E(i);var o=1===this.length&&this[0].parentNode;if(o&&11===o.nodeType&&1===o.childNodes.length&&1===i.length)return i[t](this[0]),this;for(var o=0,r=i.length;r>o;o++){var s=(o>0?this.clone(!0):this).get();E(i[o])[t](s),n=n.concat(s)}return this.pushStack(n,e,i.selector)}}),E.extend({clone:function(e,t,i){var n,o,r;E.support.html5Clone||E.isXMLDoc(e)||!ve.test("<"+e.nodeName+">")?n=e.cloneNode(!0):(n=L.createElement("div"),Se.appendChild(n),n.innerHTML=e.outerHTML,n=n.firstChild);var s=n;if(!(E.support.noCloneEvent&&E.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(u(e,s),n=f(e),o=f(s),r=0;n[r];++r)o[r]&&u(n[r],o[r]);if(t&&(p(e,s),i))for(n=f(e),o=f(s),r=0;n[r];++r)p(n[r],o[r]);return s},clean:function(e,t,i,n){var o,r=[];t=t||L,"undefined"==typeof t.createElement&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||L);for(var s,a=0;null!=(s=e[a]);a++)if("number"==typeof s&&(s+=""),s){if("string"==typeof s)if(ge.test(s)){s=s.replace(pe,"<$1></$2>"),o=(ue.exec(s)||["",""])[1].toLowerCase();var l=Te[o]||Te._default,d=l[0],c=t.createElement("div"),p=Se.childNodes;for(t===L?Se.appendChild(c):h(t).appendChild(c),c.innerHTML=l[1]+s+l[2];d--;)c=c.lastChild;if(!E.support.tbody)for(d=fe.test(s),l="table"!==o||d?"<table>"!==l[1]||d?[]:c.childNodes:c.firstChild&&c.firstChild.childNodes,o=l.length-1;o>=0;--o)E.nodeName(l[o],"tbody")&&!l[o].childNodes.length&&l[o].parentNode.removeChild(l[o]);!E.support.leadingWhitespace&&ce.test(s)&&c.insertBefore(t.createTextNode(ce.exec(s)[0]),c.firstChild),s=c.childNodes,c&&(c.parentNode.removeChild(c),0<p.length&&(c=p[p.length-1])&&c.parentNode&&c.parentNode.removeChild(c))}else s=t.createTextNode(s);var u;if(!E.support.appendChecked)if(s[0]&&"number"==typeof(u=s.length))for(o=0;u>o;o++)m(s[o]);else m(s);s.nodeType?r.push(s):r=E.merge(r,s)}if(i)for(e=function(e){return!e.type||we.test(e.type)},a=0;r[a];a++)t=r[a],n&&E.nodeName(t,"script")&&(!t.type||we.test(t.type))?n.push(t.parentNode?t.parentNode.removeChild(t):t):(1===t.nodeType&&(s=E.grep(t.getElementsByTagName("script"),e),r.splice.apply(r,[a+1,0].concat(s))),i.appendChild(t));return r},cleanData:function(e){for(var t,i,n,o=E.cache,r=E.event.special,s=E.support.deleteExpando,a=0;null!=(n=e[a]);a++)if((!n.nodeName||!E.noData[n.nodeName.toLowerCase()])&&(i=n[E.expando])){if((t=o[i])&&t.events){for(var l in t.events)r[l]?E.event.remove(n,l):E.removeEvent(n,l,t.handle);t.handle&&(t.handle.elem=null)}s?delete n[E.expando]:n.removeAttribute&&n.removeAttribute(E.expando),delete o[i]}}});var Ce,xe,Pe,Ae=/alpha\([^)]*\)/i,Le=/opacity=([^)]*)/,De=/([A-Z]|^ms)/g,ke=/^[\-+]?(?:\d*\.)?\d+$/i,Ee=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Ve=/^([\-+])=([\-+.\de]+)/,Ie=/^margin/,Me={position:"absolute",visibility:"hidden",display:"block"},We=["Top","Right","Bottom","Left"];E.fn.css=function(e,i){return E.access(this,function(e,i,n){return n!==t?E.style(e,i,n):E.css(e,i)},e,i,1<arguments.length)},E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Ce(e,"opacity");return""===i?"1":i}return e.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":E.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,s=E.camelCase(i),a=e.style,l=E.cssHooks[s];if(i=E.cssProps[s]||s,n===t)return l&&"get"in l&&(r=l.get(e,!1,o))!==t?r:a[i];if(o=typeof n,"string"===o&&(r=Ve.exec(n))&&(n=+(r[1]+1)*+r[2]+parseFloat(E.css(e,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||E.cssNumber[s]||(n+="px"),l&&"set"in l&&(n=l.set(e,n))===t)))try{a[i]=n}catch(d){}}},css:function(e,i,n){var o,r;return i=E.camelCase(i),r=E.cssHooks[i],i=E.cssProps[i]||i,"cssFloat"===i&&(i="float"),r&&"get"in r&&(o=r.get(e,!0,n))!==t?o:Ce?Ce(e,i):void 0},swap:function(e,t,i){var n,o={};for(n in t)o[n]=e.style[n],e.style[n]=t[n];i=i.call(e);for(n in t)e.style[n]=o[n];return i}}),E.curCSS=E.css,L.defaultView&&L.defaultView.getComputedStyle&&(xe=function(e,t){var i,n,o,r=e.style;return t=t.replace(De,"-$1").toLowerCase(),(n=e.ownerDocument.defaultView)&&(o=n.getComputedStyle(e,null))&&(i=o.getPropertyValue(t),""!==i||E.contains(e.ownerDocument.documentElement,e)||(i=E.style(e,t))),!E.support.pixelMargin&&o&&Ie.test(t)&&Ee.test(i)&&(n=r.width,r.width=i,i=o.width,r.width=n),i}),L.documentElement.currentStyle&&(Pe=function(e,t){var i,n,o=e.currentStyle&&e.currentStyle[t],r=e.style;return null==o&&r&&(i=r[t])&&(o=i),Ee.test(o)&&(i=r.left,(n=e.runtimeStyle&&e.runtimeStyle.left)&&(e.runtimeStyle.left=e.currentStyle.left),r.left="fontSize"===t?"1em":o,o=r.pixelLeft+"px",r.left=i,n&&(e.runtimeStyle.left=n)),""===o?"auto":o}),Ce=xe||Pe,E.each(["height","width"],function(e,t){E.cssHooks[t]={get:function(e,i,n){return i?0!==e.offsetWidth?_(e,t,n):E.swap(e,Me,function(){return _(e,t,n)}):void 0},set:function(e,t){return ke.test(t)?t+"px":t}}}),E.support.opacity||(E.cssHooks.opacity={get:function(e,t){return Le.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=E.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,t>=1&&""===E.trim(r.replace(Ae,""))&&(i.removeAttribute("filter"),n&&!n.filter)||(i.filter=Ae.test(r)?r.replace(Ae,o):r+" "+o)}}),E(function(){E.support.reliableMarginRight||(E.cssHooks.marginRight={get:function(e,t){return E.swap(e,{display:"inline-block"},function(){return t?Ce(e,"margin-right"):e.style.marginRight})}})}),E.expr&&E.expr.filters&&(E.expr.filters.hidden=function(e){var t=e.offsetHeight;return 0===e.offsetWidth&&0===t||!E.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||E.css(e,"display"))},E.expr.filters.visible=function(e){return!E.expr.filters.hidden(e)}),E.each({margin:"",padding:"",border:"Width"},function(e,t){E.cssHooks[e+t]={expand:function(i){var n="string"==typeof i?i.split(" "):[i],o={};for(i=0;4>i;i++)o[e+We[i]+t]=n[i]||n[i-2]||n[0];return o}}});var $e,Re,Be=/%20/g,Oe=/\[\]$/,Ne=/\r?\n/g,Fe=/#.*$/,ze=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,He=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ue=/^(?:GET|HEAD)$/,je=/^\/\//,Ye=/\?/,qe=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ge=/^(?:select|textarea)/i,Je=/\s+/,Xe=/([?&])_=[^&]*/,Ke=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Qe=E.fn.load,Ze={},et={},tt=["*/"]+["*"];try{$e=k.href}catch(it){$e=L.createElement("a"),$e.href="",$e=$e.href}Re=Ke.exec($e.toLowerCase())||[],E.fn.extend({load:function(e,i,n){if("string"!=typeof e&&Qe)return Qe.apply(this,arguments);if(!this.length)return this;var o=e.indexOf(" ");if(o>=0){var r=e.slice(o,e.length);e=e.slice(0,o)}o="GET",i&&(E.isFunction(i)?(n=i,i=t):"object"==typeof i&&(i=E.param(i,E.ajaxSettings.traditional),o="POST"));var s=this;return E.ajax({url:e,type:o,dataType:"html",data:i,complete:function(e,t,i){i=e.responseText,e.isResolved()&&(e.done(function(e){i=e}),s.html(r?E("<div>").append(i.replace(qe,"")).find(r):i)),n&&s.each(n,[i,t,e])}}),this},serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?E.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Ge.test(this.nodeName)||He.test(this.type))}).map(function(e,t){var i=E(this).val();return null==i?null:E.isArray(i)?E.map(i,function(e,i){return{name:t.name,value:e.replace(Ne,"\r\n")}}):{name:t.name,value:i.replace(Ne,"\r\n")}}).get()}}),E.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.each(["get","post"],function(e,i){E[i]=function(e,n,o,r){return E.isFunction(n)&&(r=r||o,o=n,n=t),E.ajax({type:i,url:e,data:n,success:o,dataType:r})}}),E.extend({getScript:function(e,i){return E.get(e,t,i,"script")},getJSON:function(e,t,i){return E.get(e,t,i,"json")},ajaxSetup:function(e,t){return t?w(e,E.ajaxSettings):(t=e,e=E.ajaxSettings),w(e,t),e},ajaxSettings:{url:$e,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Re[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":tt},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":E.parseJSON,"text xml":E.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:v(Ze),ajaxTransport:v(et),ajax:function(e,i){function n(e,i,n,s){if(2!==b){b=2,l&&clearTimeout(l),a=t,r=s||"",T.readyState=e>0?4:0;var d,c,v;if(s=i,n){var y,w,S,C,x=p,P=T,A=x.contents,L=x.dataTypes,D=x.responseFields;for(w in D)w in n&&(P[D[w]]=n[w]);for(;"*"===L[0];)L.shift(),y===t&&(y=x.mimeType||P.getResponseHeader("content-type"));if(y)for(w in A)if(A[w]&&A[w].test(y)){L.unshift(w);break}if(L[0]in n)S=L[0];else{for(w in n){if(!L[0]||x.converters[w+" "+L[0]]){S=w;break}C||(C=w)}S=S||C}S?(S!==L[0]&&L.unshift(S),n=n[S]):n=void 0}else n=t;if(e>=200&&300>e||304===e)if(p.ifModified&&((y=T.getResponseHeader("Last-Modified"))&&(E.lastModified[o]=y),(y=T.getResponseHeader("Etag"))&&(E.etag[o]=y)),304===e)s="notmodified",d=!0;else try{y=p,y.dataFilter&&(n=y.dataFilter(n,y.dataType));var k=y.dataTypes;w={};var V,I,M,W,$,R,B,O,N=k.length,F=k[0];for(V=1;N>V;V++){if(1===V)for(I in y.converters)"string"==typeof I&&(w[I.toLowerCase()]=y.converters[I]);if(W=F,F=k[V],"*"===F)F=W;else if("*"!==W&&W!==F){if($=W+" "+F,R=w[$]||w["* "+F],!R)for(B in O=t,w)if(M=B.split(" "),(M[0]===W||"*"===M[0])&&(O=w[M[1]+" "+F])){B=w[B],!0===B?R=O:!0===O&&(R=B);break}R||O||E.error("No conversion from "+$.replace(" "," to ")),!0!==R&&(n=R?R(n):O(B(n)))}}c=n,s="success",d=!0}catch(z){s="parsererror",v=z}else v=s,(!s||e)&&(s="error",0>e&&(e=0));T.status=e,T.statusText=""+(i||s),d?g.resolveWith(u,[c,s,T]):g.rejectWith(u,[T,s,v]),T.statusCode(_),_=t,h&&f.trigger("ajax"+(d?"Success":"Error"),[T,p,d?c:v]),m.fireWith(u,[T,s]),h&&(f.trigger("ajaxComplete",[T,p]),--E.active||E.event.trigger("ajaxStop"))}}"object"==typeof e&&(i=e,e=t),i=i||{};var o,r,s,a,l,d,h,c,p=E.ajaxSetup({},i),u=p.context||p,f=u!==p&&(u.nodeType||u instanceof E)?E(u):E.event,g=E.Deferred(),m=E.Callbacks("once memory"),_=p.statusCode||{},v={},w={},b=0,T={readyState:0,setRequestHeader:function(e,t){if(!b){var i=e.toLowerCase();e=w[i]=w[i]||e,v[e]=t}return this},getAllResponseHeaders:function(){return 2===b?r:null},getResponseHeader:function(e){var i;if(2===b){if(!s)for(s={};i=ze.exec(r);)s[i[1].toLowerCase()]=i[2];i=s[e.toLowerCase()]}return i===t?null:i},overrideMimeType:function(e){return b||(p.mimeType=e),this},abort:function(e){return e=e||"abort",a&&a.abort(e),n(0,e),this}};if(g.promise(T),T.success=T.done,T.error=T.fail,T.complete=m.add,T.statusCode=function(e){if(e){var t;if(2>b)for(t in e)_[t]=[_[t],e[t]];else t=e[T.status],T.then(t,t)}return this},p.url=((e||p.url)+"").replace(Fe,"").replace(je,Re[1]+"//"),p.dataTypes=E.trim(p.dataType||"*").toLowerCase().split(Je),null==p.crossDomain&&(d=Ke.exec(p.url.toLowerCase()),p.crossDomain=!(!d||d[1]==Re[1]&&d[2]==Re[2]&&(d[3]||("http:"===d[1]?80:443))==(Re[3]||("http:"===Re[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),y(Ze,p,i,T),2===b)return!1;if(h=p.global,p.type=p.type.toUpperCase(),p.hasContent=!Ue.test(p.type),h&&0===E.active++&&E.event.trigger("ajaxStart"),!p.hasContent&&(p.data&&(p.url+=(Ye.test(p.url)?"&":"?")+p.data,delete p.data),o=p.url,!1===p.cache)){d=E.now();var S=p.url.replace(Xe,"$1_="+d);p.url=S+(S===p.url?(Ye.test(p.url)?"&":"?")+"_="+d:"")}(p.data&&p.hasContent&&!1!==p.contentType||i.contentType)&&T.setRequestHeader("Content-Type",p.contentType),p.ifModified&&(o=o||p.url,E.lastModified[o]&&T.setRequestHeader("If-Modified-Since",E.lastModified[o]),E.etag[o]&&T.setRequestHeader("If-None-Match",E.etag[o])),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+tt+"; q=0.01":""):p.accepts["*"]);for(c in p.headers)T.setRequestHeader(c,p.headers[c]);if(p.beforeSend&&(!1===p.beforeSend.call(u,T,p)||2===b))return T.abort(),!1;for(c in{success:1,error:1,complete:1})T[c](p[c]);if(a=y(et,p,i,T)){T.readyState=1,h&&f.trigger("ajaxSend",[T,p]),p.async&&0<p.timeout&&(l=setTimeout(function(){T.abort("timeout")},p.timeout));try{b=1,a.send(v,n)}catch(C){if(!(2>b))throw C;n(-1,C)}}else n(-1,"No Transport");return T},param:function(e,i){var n=[],o=function(e,t){t=E.isFunction(t)?t():t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=E.ajaxSettings.traditional),E.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){o(this.name,this.value)});else for(var r in e)b(r,e[r],i,o);return n.join("&").replace(Be,"+")}}),E.extend({active:0,lastModified:{},etag:{}});var nt=E.now(),ot=/(\=)\?(&|$)|\?\?/i;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return E.expando+"_"+nt++}}),E.ajaxPrefilter("json jsonp",function(t,i,n){if(i="string"==typeof t.data&&/^application\/x\-www\-form\-urlencoded/.test(t.contentType),"jsonp"===t.dataTypes[0]||!1!==t.jsonp&&(ot.test(t.url)||i&&ot.test(t.data))){var o,r=t.jsonpCallback=E.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s=e[r],a=t.url,l=t.data,d="$1"+r+"$2";return!1!==t.jsonp&&(a=a.replace(ot,d),t.url===a&&(i&&(l=l.replace(ot,d)),t.data===l&&(a+=(/\?/.test(a)?"&":"?")+t.jsonp+"="+r))),t.url=a,t.data=l,e[r]=function(e){o=[e]},n.always(function(){e[r]=s,o&&E.isFunction(s)&&e[r](o[0])}),t.converters["script json"]=function(){return o||E.error(r+" was not called"),o[0]},t.dataTypes[0]="json","script"}}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),E.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=L.head||L.getElementsByTagName("head")[0]||L.documentElement;return{send:function(o,r){i=L.createElement("script"),i.async="async",e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,o){(o||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,n&&i.parentNode&&n.removeChild(i),i=t,o||r(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(0,1)}}}});var rt,st=e.ActiveXObject?function(){for(var e in rt)rt[e](0,1)}:!1,at=0;E.ajaxSettings.xhr=e.ActiveXObject?function(){var t;if(!(t=!this.isLocal&&T()))e:{try{t=new e.ActiveXObject("Microsoft.XMLHTTP");break e}catch(i){}t=void 0}return t}:T,function(e){E.extend(E.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(E.ajaxSettings.xhr()),E.support.ajax&&E.ajaxTransport(function(i){if(!i.crossDomain||E.support.cors){var n;return{send:function(o,r){var s,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");try{for(a in o)l.setRequestHeader(a,o[a])}catch(d){}l.send(i.hasContent&&i.data||null),n=function(e,o){var a,d,h,c,p;try{if(n&&(o||4===l.readyState))if(n=t,s&&(l.onreadystatechange=E.noop,st&&delete rt[s]),o)4!==l.readyState&&l.abort();else{a=l.status,h=l.getAllResponseHeaders(),c={},(p=l.responseXML)&&p.documentElement&&(c.xml=p);try{c.text=l.responseText}catch(u){}try{d=l.statusText}catch(f){d=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=c.text?200:404}}catch(g){o||r(-1,g)}c&&r(a,d,c,h)},i.async&&4!==l.readyState?(s=++at,st&&(rt||(rt={},E(e).unload(st)),rt[s]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(0,1)}}}});var lt,dt,ht,ct,pt={},ut=/^(?:toggle|show|hide)$/,ft=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,gt=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];E.fn.extend({show:function(e,t,i){if(e||0===e)return this.animate(x("show",3),e,t,i);i=0;for(var n=this.length;n>i;i++)e=this[i],e.style&&(t=e.style.display,E._data(e,"olddisplay")||"none"!==t||(t=e.style.display=""),(""===t&&"none"===E.css(e,"display")||!E.contains(e.ownerDocument.documentElement,e))&&E._data(e,"olddisplay",P(e.nodeName)));for(i=0;n>i;i++)e=this[i],e.style&&(t=e.style.display,""===t||"none"===t)&&(e.style.display=E._data(e,"olddisplay")||"");return this},hide:function(e,t,i){if(e||0===e)return this.animate(x("hide",3),e,t,i);i=0;for(var n=this.length;n>i;i++)e=this[i],e.style&&(t=E.css(e,"display"),"none"===t||E._data(e,"olddisplay")||E._data(e,"olddisplay",t));for(i=0;n>i;i++)this[i].style&&(this[i].style.display="none");return this},_toggle:E.fn.toggle,toggle:function(e,t,i){var n="boolean"==typeof e;return E.isFunction(e)&&E.isFunction(t)?this._toggle.apply(this,arguments):null==e||n?this.each(function(){var t=n?e:E(this).is(":hidden");E(this)[t?"show":"hide"]()}):this.animate(x("toggle",3),e,t,i),this},fadeTo:function(e,t,i,n){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){function o(){!1===r.queue&&E._mark(this);var t,i,n,o,s,a=E.extend({},r),l=1===this.nodeType,d=l&&E(this).is(":hidden");a.animatedProperties={};for(n in e)if(t=E.camelCase(n),n!==t&&(e[t]=e[n],delete e[n]),(i=E.cssHooks[t])&&"expand"in i)for(n in o=i.expand(e[t]),delete e[t],o)n in e||(e[n]=o[n]);for(t in e){if(i=e[t],E.isArray(i)?(a.animatedProperties[t]=i[1],i=e[t]=i[0]):a.animatedProperties[t]=a.specialEasing&&a.specialEasing[t]||a.easing||"swing","hide"===i&&d||"show"===i&&!d)return a.complete.call(this);!l||"height"!==t&&"width"!==t||(a.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===E.css(this,"display")&&"none"===E.css(this,"float")&&(E.support.inlineBlockNeedsLayout&&"inline"!==P(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=a.overflow&&(this.style.overflow="hidden");for(n in e)l=new E.fx(this,a,n),i=e[n],ut.test(i)?(t=E._data(this,"toggle"+n)||("toggle"===i?d?"show":"hide":0))?(E._data(this,"toggle"+n,"show"===t?"hide":"show"),l[t]()):l[i]():(t=ft.exec(i),o=l.cur(),t?(i=parseFloat(t[2]),s=t[3]||(E.cssNumber[n]?"":"px"),"px"!==s&&(E.style(this,n,(i||1)+s),o*=(i||1)/l.cur(),E.style(this,n,o+s)),t[1]&&(i=("-="===t[1]?-1:1)*i+o),l.custom(o,i,s)):l.custom(o,i,""));return!0}var r=E.speed(t,i,n);return E.isEmptyObject(e)?this.each(r.complete,[!1]):(e=E.extend({},e),!1===r.queue?this.each(o):this.queue(r.queue,o))},stop:function(e,i,n){return"string"!=typeof e&&(n=i,i=e,e=t),i&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t,i=!1,o=E.timers,r=E._data(this);if(n||E._unmark(!0,this),null==e){for(t in r)if(r[t]&&r[t].stop&&t.indexOf(".run")===t.length-4){var s=r[t];E.removeData(this,t,!0),s.stop(n)}}else r[t=e+".run"]&&r[t].stop&&(r=r[t],E.removeData(this,t,!0),r.stop(n));for(t=o.length;t--;)o[t].elem!==this||null!=e&&o[t].queue!==e||(n?o[t](!0):o[t].saveState(),i=!0,o.splice(t,1));n&&i||E.dequeue(this,e)})}}),E.each({slideDown:x("show",1),slideUp:x("hide",1),slideToggle:x("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){E.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),E.extend({speed:function(e,t,i){var n=e&&"object"==typeof e?E.extend({},e):{complete:i||!i&&t||E.isFunction(e)&&e,duration:e,easing:i&&t||t&&!E.isFunction(t)&&t};return n.duration=E.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in E.fx.speeds?E.fx.speeds[n.duration]:E.fx.speeds._default,(null==n.queue||!0===n.queue)&&(n.queue="fx"),n.old=n.complete,n.complete=function(e){E.isFunction(n.old)&&n.old.call(this),n.queue?E.dequeue(this,n.queue):!1!==e&&E._unmark(this)},n},easing:{linear:function(e){return e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5}},timers:[],fx:function(e,t,i){this.options=t,this.elem=e,this.prop=i,t.orig=t.orig||{}}}),E.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(E.fx.step[this.prop]||E.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var e,t=E.css(this.elem,this.prop);return isNaN(e=parseFloat(t))?t&&"auto"!==t?t:0:e},custom:function(e,i,n){function o(e){return r.step(e)}var r=this,s=E.fx;this.startTime=ct||S(),this.end=i,this.now=this.start=e,this.pos=this.state=0,this.unit=n||this.unit||(E.cssNumber[this.prop]?"":"px"),o.queue=this.options.queue,o.elem=this.elem,o.saveState=function(){E._data(r.elem,"fxshow"+r.prop)===t&&(r.options.hide?E._data(r.elem,"fxshow"+r.prop,r.start):r.options.show&&E._data(r.elem,"fxshow"+r.prop,r.end))},o()&&E.timers.push(o)&&!ht&&(ht=setInterval(s.tick,s.interval))},show:function(){var e=E._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||E.style(this.elem,this.prop),this.options.show=!0,e!==t?this.custom(this.cur(),e):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),E(this.elem).show()},hide:function(){this.options.orig[this.prop]=E._data(this.elem,"fxshow"+this.prop)||E.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(e){var t,i=ct||S(),n=!0,o=this.elem,r=this.options;if(e||i>=r.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),r.animatedProperties[this.prop]=!0;for(t in r.animatedProperties)!0!==r.animatedProperties[t]&&(n=!1);if(n){if(null==r.overflow||E.support.shrinkWrapBlocks||E.each(["","X","Y"],function(e,t){o.style["overflow"+t]=r.overflow[e]}),r.hide&&E(o).hide(),r.hide||r.show)for(t in r.animatedProperties)E.style(o,t,r.orig[t]),E.removeData(o,"fxshow"+t,!0),E.removeData(o,"toggle"+t,!0);(e=r.complete)&&(r.complete=!1,e.call(o))}return!1}return 1/0==r.duration?this.now=i:(e=i-this.startTime,this.state=e/r.duration,this.pos=E.easing[r.animatedProperties[this.prop]](this.state,e,0,1,r.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},E.extend(E.fx,{tick:function(){for(var e,t=E.timers,i=0;i<t.length;i++)e=t[i],
e()||t[i]!==e||t.splice(i--,1);t.length||E.fx.stop()},interval:13,stop:function(){clearInterval(ht),ht=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){E.style(e.elem,"opacity",e.now)},_default:function(e){e.elem.style&&null!=e.elem.style[e.prop]?e.elem.style[e.prop]=e.now+e.unit:e.elem[e.prop]=e.now}}}),E.each(gt.concat.apply([],gt),function(e,t){t.indexOf("margin")&&(E.fx.step[t]=function(e){E.style(e.elem,t,Math.max(0,e.now)+e.unit)})}),E.expr&&E.expr.filters&&(E.expr.filters.animated=function(e){return E.grep(E.timers,function(t){return e===t.elem}).length});var mt,_t=/^t(?:able|d|h)$/i,vt=/^(?:body|html)$/i;mt="getBoundingClientRect"in L.documentElement?function(e,t,i,n){try{n=e.getBoundingClientRect()}catch(o){}return n&&E.contains(i,e)?(e=t.body,t=A(t),{top:n.top+(t.pageYOffset||E.support.boxModel&&i.scrollTop||e.scrollTop)-(i.clientTop||e.clientTop||0),left:n.left+(t.pageXOffset||E.support.boxModel&&i.scrollLeft||e.scrollLeft)-(i.clientLeft||e.clientLeft||0)}):n?{top:n.top,left:n.left}:{top:0,left:0}}:function(e,t,i){var n,o=e.offsetParent,r=t.body;n=(t=t.defaultView)?t.getComputedStyle(e,null):e.currentStyle;for(var s=e.offsetTop,a=e.offsetLeft;(e=e.parentNode)&&e!==r&&e!==i&&(!E.support.fixedPosition||"fixed"!==n.position);)n=t?t.getComputedStyle(e,null):e.currentStyle,s-=e.scrollTop,a-=e.scrollLeft,e===o&&(s+=e.offsetTop,a+=e.offsetLeft,!E.support.doesNotAddBorder||E.support.doesAddBorderForTableAndCells&&_t.test(e.nodeName)||(s+=parseFloat(n.borderTopWidth)||0,a+=parseFloat(n.borderLeftWidth)||0),o=e.offsetParent),E.support.subtractsBorderForOverflowNotVisible&&"visible"!==n.overflow&&(s+=parseFloat(n.borderTopWidth)||0,a+=parseFloat(n.borderLeftWidth)||0);return("relative"===n.position||"static"===n.position)&&(s+=r.offsetTop,a+=r.offsetLeft),E.support.fixedPosition&&"fixed"===n.position&&(s+=Math.max(i.scrollTop,r.scrollTop),a+=Math.max(i.scrollLeft,r.scrollLeft)),{top:s,left:a}},E.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){E.offset.setOffset(this,e,t)});var i=this[0],n=i&&i.ownerDocument;return n?i===n.body?E.offset.bodyOffset(i):mt(i,n,n.documentElement):null},E.offset={bodyOffset:function(e){var t=e.offsetTop,i=e.offsetLeft;return E.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(E.css(e,"marginTop"))||0,i+=parseFloat(E.css(e,"marginLeft"))||0),{top:t,left:i}},setOffset:function(e,t,i){var n=E.css(e,"position");"static"===n&&(e.style.position="relative");var o=E(e),r=o.offset(),s=E.css(e,"top"),a=E.css(e,"left"),l={},d={};("absolute"===n||"fixed"===n)&&-1<E.inArray("auto",[s,a])?(d=o.position(),n=d.top,a=d.left):(n=parseFloat(s)||0,a=parseFloat(a)||0),E.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(l.top=t.top-r.top+n),null!=t.left&&(l.left=t.left-r.left+a),"using"in t?t.using.call(e,l):o.css(l)}},E.fn.extend({position:function(){if(!this[0])return null;var e=this[0],t=this.offsetParent(),i=this.offset(),n=vt.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(E.css(e,"marginTop"))||0,i.left-=parseFloat(E.css(e,"marginLeft"))||0,n.top+=parseFloat(E.css(t[0],"borderTopWidth"))||0,n.left+=parseFloat(E.css(t[0],"borderLeftWidth"))||0,{top:i.top-n.top,left:i.left-n.left}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||L.body;e&&!vt.test(e.nodeName)&&"static"===E.css(e,"position");)e=e.offsetParent;return e})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);E.fn[e]=function(o){return E.access(this,function(e,o,r){var s=A(e);return r===t?s?i in s?s[i]:E.support.boxModel&&s.document.documentElement[o]||s.document.body[o]:e[o]:void(s?s.scrollTo(n?E(s).scrollLeft():r,n?r:E(s).scrollTop()):e[o]=r)},e,o,arguments.length,null)}}),E.each({Height:"height",Width:"width"},function(e,i){var n="client"+e,o="scroll"+e,r="offset"+e;E.fn["inner"+e]=function(){var e=this[0];return e?e.style?parseFloat(E.css(e,i,"padding")):this[i]():null},E.fn["outer"+e]=function(e){var t=this[0];return t?t.style?parseFloat(E.css(t,i,e?"margin":"border")):this[i]():null},E.fn[i]=function(e){return E.access(this,function(e,i,s){return E.isWindow(e)?(i=e.document,e=i.documentElement[n],E.support.boxModel&&e||i.body&&i.body[n]||e):9===e.nodeType?(i=e.documentElement,i[n]>=i[o]?i[n]:Math.max(e.body[o],i[o],e.body[r],i[r])):s===t?(e=E.css(e,i),i=parseFloat(e),E.isNumeric(i)?i:e):void E(e).css(i,s)},i,e,arguments.length,null)}}),e.jQuery=e.$=E,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return E})}(window),jQuery.cookie=function(e,t,i){if(1<arguments.length&&"[object Object]"!==String(t)){if(i=jQuery.extend({},i),(null===t||void 0===t)&&(i.expires=-1),"number"==typeof i.expires){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}return i=t||{},o=i.raw?function(e){return e}:decodeURIComponent,(n=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?o(n[1]):null},function(e){function t(t){var i=t||window.event,n=[].slice.call(arguments,1),o=0,r=0,s=0;return t=e.event.fix(i),t.type="mousewheel",i.wheelDelta&&(o=i.wheelDelta/120),i.detail&&(o=-i.detail/3),s=o,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(s=0,r=-1*o),void 0!==i.wheelDeltaY&&(s=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(r=-1*i.wheelDeltaX/120),n.unshift(t,o,r,s),(e.event.dispatch||e.event.handle).apply(this,n)}var i=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=i.length;n;)e.event.fixHooks[i[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),function(e,t){function i(){this._state=[],this._defaults={classHolder:"sbHolder",classHolderDisabled:"sbHolderDisabled",classHolderOpen:"sbHolderOpen",classSelector:"sbSelector",classOptions:"sbOptions",classGroup:"sbGroup",classSub:"sbSub",classDisabled:"sbDisabled",classToggleOpen:"sbToggleOpen",classToggle:"sbToggle",speed:200,slidesUp:!1,effect:"slide",onChange:null,onOpen:null,onClose:null}}e.extend(i.prototype,{_isOpenSelectbox:function(e){return e?this._getInst(e).isOpen:!1},_isDisabledSelectbox:function(e){return e?this._getInst(e).isDisabled:!1},_attachSelectbox:function(i,n){function o(){var t,i=this.attr("id").split("_")[1];for(t in p._state)t!==i&&p._state.hasOwnProperty(t)&&e(":input[sb='"+t+"']")[0]&&p._closeSelectbox(e(":input[sb='"+t+"']")[0])}function r(t){c.children().each(function(n){if(e(this).is(":selected")){if(38==t&&n>0)return n=e(c.children()[n-1]),p._changeSelectbox(i,n.val(),n.text()),!1;if(40==t&&n<c.children().length-1)return n=e(c.children()[n+1]),p._changeSelectbox(i,n.val(),n.text()),!1}})}function s(n,o){var r=o&&o.sub?!0:!1,s=o&&o.disabled?!0:!1;n.each(function(n){var o,a=e(this),c=e("<li>");a.is(":selected")&&(l.text(a.text()),f=!0),n===m-1&&c.addClass("last"),function(){var n=a.text(),l=a.data("custom-option-text"),l=l!=t?l:n;a.is(":disabled")||s?o=e("<span>",{text:l}).addClass(u.settings.classDisabled):(o=e("<a>",{href:"#"+a.val(),rel:a.val(),text:l,click:function(t){t.preventDefault(),t=d,t.attr("id").split("_"),p._closeSelectbox(i),p._changeSelectbox(i,e(this).attr("rel"),n),t.focus()}}),a.is(":selected")&&o.addClass("active")),r&&o.addClass(u.settings.classSub),o.appendTo(c)}(),c.appendTo(h)})}if(this._getInst(i))return!1;var a,l,d,h,c=e(i),p=this,u=p._newInst(c),f=!1;c.find("optgroup");var g=c.find("option"),m=g.length;c.attr("sb",u.uid),e.extend(u.settings,p._defaults,n),p._state[u.uid]=!1,c.hide(),a=e("<div>",{id:"sbHolder_"+u.uid,"class":u.settings.classHolder});var _=c.data("selectbox-css");_&&a.css(_),l=e("<a>",{id:"sbSelector_"+u.uid,href:"#","class":u.settings.classSelector,click:function(t){t.preventDefault(),t.stopPropagation(),o.apply(e(this),[]),t=e(this).attr("id").split("_")[1],p._state[t]?p._closeSelectbox(i):(p._openSelectbox(i),d.focus())},keyup:function(e){r(e.keyCode)}}),d=e("<a>",{id:"sbToggle_"+u.uid,href:"#","class":u.settings.classToggle,click:function(t){t.preventDefault(),t.stopPropagation(),o.apply(e(this),[]),t=e(this).attr("id").split("_")[1],p._state[t]?p._closeSelectbox(i):(p._openSelectbox(i),d.focus())},keyup:function(e){r(e.keyCode)}}),d.appendTo(a),h=e("<ul>",{id:"sbOptions_"+u.uid,"class":u.settings.classOptions,css:{display:"none"}}),c.children().each(function(t){t=e(this);var i,n={};t.is("option")?s(t):t.is("optgroup")&&(i=e("<li>"),e("<span>",{text:t.attr("label")}).addClass(u.settings.classGroup).appendTo(i),i.appendTo(h),t.is(":disabled")&&(n.disabled=!0),n.sub=!0,s(t.find("option"),n))}),f||l.text(g.first().text()),e.data(i,"selectbox",u),l.appendTo(a),h.appendTo(a),a.insertAfter(c),c.is(":disabled")&&e.selectbox._disableSelectbox(i),c.change(function(){var t=e(this).val(),n=c.find("option[value='"+t+"']").text();p._changeSelectbox(i,t,n)})},_detachSelectbox:function(t){var i=this._getInst(t);return i?(e("#sbHolder_"+i.uid).remove(),delete this._state[i.uid],e.data(t,"selectbox",null),void e(t).show()):!1},_changeSelectbox:function(t,i,n){var o=this._getInst(t),r=this._get(o,"onChange");alreadySelected=e("#sbSelector_"+o.uid).text()===n&&e("#sbOptions_"+o.uid).find('a[rel="'+i+'"]').hasClass("active"),alreadySelected||(e("#sbSelector_"+o.uid).text(n),e("#sbOptions_"+o.uid).find(".active").removeClass("active"),e("#sbOptions_"+o.uid).find('a[rel="'+i+'"]').addClass("active"),e(t).find("option").attr("selected",!1),e(t).find("option[value='"+i+"']").attr("selected",!0),r?r.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"))},_enableSelectbox:function(t){var i=this._getInst(t);return i&&i.isDisabled?(e("#sbHolder_"+i.uid).removeClass(i.settings.classHolderDisabled),i.isDisabled=!1,void e.data(t,"selectbox",i)):!1},_disableSelectbox:function(t){var i=this._getInst(t);return!i||i.isDisabled?!1:(e("#sbHolder_"+i.uid).addClass(i.settings.classHolderDisabled),i.isDisabled=!0,void e.data(t,"selectbox",i))},_optionSelectbox:function(t,i,n){var o=this._getInst(t);return o?(o[i]=n,void e.data(t,"selectbox",o)):!1},_openSelectbox:function(t){var i=this._getInst(t),n=this;if(i&&!i.isOpen&&!i.isDisabled){var o=e("#sbOptions_"+i.uid),r=parseInt(e(window).height(),10),s=parseInt(e(window).width(),10),a=e("#sbHolder_"+i.uid).offset(),l=e(window).scrollTop(),d=o.prev().height(),r=r-(a.top-l)-d/2,h=this._get(i,"onOpen");r>50&&!i.settings.slidesUp?o.css({bottom:"auto",top:d+2+"px",maxHeight:r-d+"px"}):o.css({top:"auto",bottom:d+2+"px",maxHeight:a.top-l-d/2+"px"}),a.left+o.width()>s?o.css("left","-"+(o.width()-o.parent().width()+3)+"px"):o.css("left","-1px"),"fade"===i.settings.effect?o.fadeIn(i.settings.speed):o.slideDown(i.settings.speed),e("#sbToggle_"+i.uid).addClass(i.settings.classToggleOpen),e("#sbHolder_"+i.uid).addClass(i.settings.classHolderOpen),this._state[i.uid]=!0,i.isOpen=!0,h&&h.apply(i.input?i.input[0]:null,[i]),e.data(t,"selectbox",i),e("html").unbind("click.sbClose").one("click.sbClose",function(){n._closeSelectbox(t)})}},_closeSelectbox:function(t){var i=this._getInst(t);if(i&&i.isOpen){var n=this._get(i,"onClose");e("#sbOptions_"+i.uid).hide(),e("#sbToggle_"+i.uid).removeClass(i.settings.classToggleOpen),e("#sbHolder_"+i.uid).removeClass(i.settings.classHolderOpen),this._state[i.uid]=!1,i.isOpen=!1,n&&n.apply(i.input?i.input[0]:null,[i]),e.data(t,"selectbox",i),e("html").unbind("click.sbClose")}},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(99999999*Math.random()),isOpen:!1,isDisabled:!1,settings:{}}},_getInst:function(t){try{return e.data(t,"selectbox")}catch(i){throw"Missing instance data for this selectbox"}},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]}}),e.fn.selectbox=function(t){var i=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"isDisabled"==t||"option"==t&&2==arguments.length&&"string"==typeof arguments[1]?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this].concat(i)):e.selectbox._attachSelectbox(this,t)})},e.selectbox=new i,e.selectbox.version="0.1.3"}(jQuery),function(e,t){var i="fontFamily fontSize fontWeight fontStyle letterSpacing textTransform wordSpacing".split(" "),n=e('<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">')[0];n.setAttribute("oninput","return"),e.isFunction(n.oninput)||"onpropertychange"in n?e.fn.autosize=function(t){return this.each(function(){function n(){var e,t;o||(o=!0,a.value=r.value,a.style.overflowY=r.style.overflowY,a.style.width=s.css("width"),a.style.textIndent=s.css("text-indent"),a.scrollTop=0,a.scrollTop=9e4,e=a.scrollTop,t="hidden",e>d?(e=d,t="scroll"):l>e&&(e=l),r.style.overflowY=t,r.style.height=r.style.minHeight=r.style.maxHeight=e+c+"px",setTimeout(function(){o=!1},1)),s.trigger("autosizeComplete")}for(var o,r=this,s=e(r).css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),a=e('<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">').addClass(t||"autosizejs")[0],l=s.height(),d=parseInt(s.css("maxHeight"),10),h=i.length,c="border-box"===s.css("box-sizing")?s.outerHeight()-s.height():0,d=d&&d>0?d:9e4;h--;)a.style[i[h]]=s.css(i[h]);e("body").append(a),"onpropertychange"in r?"oninput"in r?r.oninput=r.onkeyup=n:r.onpropertychange=n:r.oninput=n,e(window).resize(n),s.bind("autosize",n),n()})}:e.fn.autosize=function(){return this}}(jQuery),function(e,t,i){function n(){o=t.setTimeout(function(){r.each(function(){var t=e(this),i=t.width(),n=t.height(),o=e.data(this,"resize-special-event");i===o.w&&n===o.h||t.trigger("resize",[o.w=i,o.h=n])}),n()},s.delay)}var o,r=e([]),s=e.resize=e.extend(e.resize,{});s.delay=250,s.throttleWindow=!0,e.event.special.resize={setup:function(){if(!s.throttleWindow&&this.setTimeout)return!1;var t=e(this);r=r.add(t),e.data(this,"resize-special-event",{w:t.width(),h:t.height()}),1===r.length&&n()},teardown:function(){if(!s.throttleWindow&&this.setTimeout)return!1;var t=e(this);r=r.not(t),t.removeData("resize-special-event"),r.length||clearTimeout(o)},add:function(t){function n(t,n,r){var s=e(this),a=e.data(this,"resize-special-event");a.w=n!==i?n:s.width(),a.h=r!==i?r:s.height(),o.apply(this,arguments)}if(!s.throttleWindow&&this.setTimeout)return!1;var o;return e.isFunction(t)?(o=t,n):(o=t.handler,void(t.handler=n))}}}(jQuery,this),Modernizr=window.Modernizr=function(e,t,i){function n(e,t){return typeof e===t}function o(e,t){for(var n in e){var o=e[n];if(!~(""+o).indexOf("-")&&c[o]!==i)return"pfx"==t?o:!0}return!1}function r(e,t,r){var s=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+u.join(s+" ")+s).split(" ");if(n(t,"string")||n(t,"undefined"))t=o(a,t);else e:{a=(e+" "+f.join(s+" ")+s).split(" "),e=a;for(var l in e)if(s=t[e[l]],s!==i){t=!1===r?e[l]:n(s,"function")?s.bind(r||t):s;break e}t=!1}return t}var s,a,l={},d=t.documentElement,h=t.createElement("modernizr"),c=h.style,p=" -webkit- -moz- -o- -ms- ".split(" "),u=["Webkit","Moz","O","ms"],f=["webkit","moz","o","ms"],h={},g=[],m=g.slice,_=function(e,i,n,o){var r,s,a,l,h=t.createElement("div"),c=t.body,p=c||t.createElement("body");if(parseInt(n,10))for(;n--;)a=t.createElement("div"),a.id=o?o[n]:"modernizr"+(n+1),h.appendChild(a);return r=['&#173;<style id="smodernizr">',e,"</style>"].join(""),h.id="modernizr",(c?h:p).innerHTML+=r,p.appendChild(h),c||(p.style.background="",p.style.overflow="hidden",l=d.style.overflow,d.style.overflow="hidden",d.appendChild(p)),s=i(h,e),c?h.parentNode.removeChild(h):(p.parentNode.removeChild(p),d.style.overflow=l),!!s},v=function(){var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(o,r){r=r||t.createElement(e[o]||"div"),o="on"+o;var s=o in r;return s||(r.setAttribute||(r=t.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(o,""),s=n(r[o],"function"),n(r[o],"undefined")||(r[o]=i),r.removeAttribute(o))),s}}(),y={}.hasOwnProperty;a=n(y,"undefined")||n(y.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(e,t){return y.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=m.call(arguments,1),n=function(){if(this instanceof n){var o=function(){};o.prototype=t.prototype;var o=new o,r=t.apply(o,i.concat(m.call(arguments)));return Object(r)===r?r:o}return t.apply(e,i.concat(m.call(arguments)))};return n}),h.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},h.canvastext=function(){return!!l.canvas&&!!n(t.createElement("canvas").getContext("2d").fillText,"function")},h.touch=function(){var i;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?i=!0:_(["@media (",p.join("touch-enabled),("),"modernizr){#modernizr{top:9px;position:absolute}}"].join(""),function(e){i=9===e.offsetTop}),i},h.history=function(){return!!e.history&&!!history.pushState},h.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},h.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},h.multiplebgs=function(){return c.cssText="background:url(https://),url(https://),red url(https://)",/(url\s*\(.*?){3}/.test(c.background)},h.csscolumns=function(){return r("columnCount")},h.csstransitions=function(){return r("transition")},h.localstorage=function(){try{return localStorage.setItem("modernizr","modernizr"),localStorage.removeItem("modernizr"),!0}catch(e){return!1}};for(var w in h)a(h,w)&&(s=w.toLowerCase(),l[s]=h[w](),g.push((l[s]?"":"no-")+s));return l.addTest=function(e,t){if("object"==typeof e)for(var n in e)a(e,n)&&l.addTest(n,e[n]);else{if(e=e.toLowerCase(),l[e]!==i)return l;t="function"==typeof t?t():t,d.className+=" feature-"+(t?"":"no-")+e,l[e]=t}return l},c.cssText="",h=null,l._version="2.7.1",l._prefixes=p,l._domPrefixes=f,l._cssomPrefixes=u,l.hasEvent=v,l.testProp=function(e){return o([e])},l.testAllProps=r,l.testStyles=_,d.className=d.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(" feature-js feature-"+g.join(" feature-")),l}(this,this.document),Modernizr.touch=Modernizr.touch&&"onorientationchange"in window,Modernizr.addTest("pointerevents",function(){var e=document.createElement("x"),t=document.documentElement,i=window.getComputedStyle,n=!1;return"pointerEvents"in e.style?(e.style.pointerEvents="auto",e.style.pointerEvents="x",t.appendChild(e),i&&(n=(i=i(e,""))?"auto"===i.pointerEvents:!1),t.removeChild(e),!!n):!1}),function(e){function t(e,t,i){e/=255,t/=255,i/=255;var n,o=Math.max(e,t,i),r=Math.min(e,t,i),s=o-r;if(o==r)n=0;else{switch(o){case e:n=(t-i)/s+(i>t?6:0);break;case t:n=(i-e)/s+2;break;case i:n=(e-t)/s+4}n/=6}return[n,0==o?0:s/o,o]}function i(e,t,i){var n,o,r,s=Math.floor(6*e),a=6*e-s;e=i*(1-t);var l=i*(1-a*t);switch(t=i*(1-(1-a)*t),s%6){case 0:n=i,o=t,r=e;break;case 1:n=l,o=i,r=e;break;case 2:n=e,o=i,r=t;break;case 3:n=e,o=l,r=i;break;case 4:n=t,o=e,r=i;break;case 5:n=i,o=e,r=l}return[255*n,255*o,255*r]}function n(e){return e=e.replace(/^(?:[\da-f]{3}){1,2}$/i,"#$&"),e=e.replace(/^#([\da-f])([\da-f])([\da-f])$/i,"#$1$1$2$2$3$3"),e=e.replace(/^\s*RGB\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/,function(e,t,i,n){return r(t,i,n)})}function o(e){return e.replace(/^#([\da-f])([\da-f])([\da-f])$/i,"#$1$1$2$2$3$3"),e=/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(e)||[null,0,0,0],[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}function r(e,t,i){return 2 in arguments||(i=e[2],t=e[1],e=e[0]),("#@0"+(~~e).toString(16)+"@0"+(~~t).toString(16)+"@0"+(~~i).toString(16)).replace(/@0?([\da-f]{2})/gi,"$1")}function s(e){e&&(e.join||(e=e?(""+e).split(","):[]),d=e)}function a(h){function c(t){var i=!1;return t=t.toLowerCase(),e.each(d,function(e,n){return n.toLowerCase()==t?(i=!0,!1):void 0}),i?!1:(d=[t].concat(d.slice(0,l-1)),!0)}function p(t){u.call(this,t),e(this).removeData("tvcolorpicker").removeData("tvcolorpicker-custom-color"),v()}function u(t){var i=e(this);i.val(t),i.change(),t?i.trigger("pick-color",t):i.trigger("pick-transparent"),f.call(this,t)}function f(t){e(this).css({backgroundColor:t,color:t})}function g(i,n){var r=this,s=e(r).val().toLowerCase(),a=document.createElement("table"),d=document.createElement("tbody");a.appendChild(d);var h,c=0;return e.each(i,function(i,a){c++,0==i%l&&(h=e("<tr></tr>").appendTo(d));var u=e('<td class="tvcolorpicker-cell"></td>').appendTo(h),u=e('<div class="tvcolorpicker-swatch"></div>').appendTo(u);if(n&&n.addClass&&u.addClass(n.addClass),a){a=a.toLowerCase(),s==a&&u.addClass("active"),u.css({backgroundColor:a}).data("color",a),u.bind("click",function(){p.call(r,a)});var f=t.apply(this,o(a));.9<(1-f[1])*f[2]&&u.addClass("low-contrast")}}),e(a).addClass("tvcolorpicker-table"),c?a:e()}function m(t,i,n){var o=e(t).offset();e(document).scrollLeft();var r=e(document).scrollTop(),s=e(t).outerWidth(),a=e(t).outerHeight();t=e(window).width();var l=e(window).height(),d=e(i).outerWidth(),h=e(i).outerHeight();switch(n.direction){default:case"down":n={top:o.top+a+n.offset,left:o.left+n.drift};break;case"right":n={top:o.top+n.drift,left:o.left+s+n.offset}}n.top+h>l+r&&(n.top=l-h+r),o.left+d>t&&(n.left=t-d),n.left+="px",n.top+="px",i.css(n)}function _(n){function s(e){var t=e.originalEvent,n=e.offsetX||e.layerX||t&&(t.offsetX||t.layerX)||0;e=e.offsetY||e.layerY||t&&(t.offsetY||t.layerY)||0,b.css({left:n+"px",top:e+"px"}),k[0]=n/P,k[1]=1-e/x,S.css({backgroundColor:r(i(k[0],k[1],1))}),c()}function a(t){1==t.which&&(A=!1,f.is(".opened")&&e(p).get(0).focus(),e(document).unbind("mouseup",a))}function l(e){var t=e.originalEvent;e=e.offsetY||e.layerY||t&&(t.offsetY||t.layerY)||0,C.css({top:e+"px"}),k[2]=1-e/x,c()}function h(t){1==t.which&&(L=!1,e(document).unbind("mouseup",h),f.is(".opened")&&e(p).get(0).focus())}function c(){D&&(D=!1,f.find(".tvcolorpicker-swatch.active").removeClass("active"));var e=r(i(k[0],k[1],k[2]));p.val().toUpperCase()!=e.toUpperCase()&&(p.data("tvcolorpicker-custom-color",e),u.call(p,e))}var p=e(this),f=e('<div class="tvcolorpicker-popup opened">'),_=e('<div class="tvcolorpicker-swatches-area"></div>').appendTo(f);_.append(g.call(this,"#000000 #424242 #656565 #989898 #b6b6b6 #cbcbcb #d8d8d8 #eeeeee #f2f2f2 #ffffff".split(" "))),_.append(g.call(this,"#970000 #ff0000 #ff9800 #ffff00 #00ff00 #00ffff #4985e7 #0000ff #9800ff #ff00ff".split(" "))),_.append(g.call(this,"#e6b8af #f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #c9daf8 #cfe2f3 #d9d2e9 #ead1dc #dd7e6b #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #a4c2f4 #9fc5e8 #b4a7d6 #d5a6bd #cc4125 #e06666 #f6b26b #ffd966 #93c47d #76a5af #6d9eeb #6fa8dc #8e7cc3 #c27ba0 #a61c00 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3c78d8 #3d85c6 #674ea7 #a64d79 #85200c #990000 #b45f06 #bf9000 #38761d #134f5c #1155cc #0b5394 #351c75 #741b47 #5b0f00 #660000 #783f04 #7f6000 #274e13 #0c343d #1c4587 #073763 #20124d #4c1130".split(" ")));var v=e('<div class="tvcolorpicker-custom-area"></div>').css({display:"none"}).appendTo(f),y=e('<div class="tvcolorpicker-hsv"></div>').appendTo(v),w=e('<div class="tvcolorpicker-hs"></div>').appendTo(y),b=e('<div class="tvcolorpicker-hs-handle"></div>').appendTo(w),T=e('<div class="tvcolorpicker-hs-area"></div>').appendTo(w),S=e('<div class="tvcolorpicker-v"></div>').appendTo(y),C=e('<div class="tvcolorpicker-v-handle"></div>').appendTo(S),y=e('<div class="tvcolorpicker-v-area"></div>').appendTo(S),x=w.height(),P=w.width(),A=!1,L=!1,D=!0,k=[0,0,.5];return T.bind("mousedown",function(t){1==t.which&&(A=!0,e(document).bind("mouseup",a),s(t),t.preventDefault())}),T.bind("mousemove",function(e){A&&(s(e),e.preventDefault())}),y.bind("mousedown",function(t){1==t.which&&(L=!0,e(document).bind("mouseup",h),l(t),t.preventDefault())}),y.bind("mousemove",function(e){L&&(l(e),e.preventDefault())}),e('<a class="tvcolorpicker-custom-button tv-button">'+e.t("Custom color...")+"</a>").appendTo(f).bind("click",function(){var n=e(this).is(".active");n||v.css({minWidth:_.width()+"px",minHeight:_.height()+"px"}),e(this)[n?"removeClass":"addClass"]("active"),v.css({display:n?"none":"block"}),_.css({display:n?"block":"none"}),n?p.removeData("tvcolorpicker-custom-color"):(x=w.height(),P=w.width(),n=o(p.val()),k=t.apply(this,n),b.css({left:~~(k[0]*P)+"px",top:~~((1-k[1])*x)+"px"}),C.css({top:~~((1-k[2])*x)+"px"}),S.css({backgroundColor:r(i(k[0],k[1],1))}))}),f.append(e(g.call(this,d,{addClass:"tvcolorpicker-user"})).addClass("tvcolorpicker-user-swatches")),e(document.body).append(f),m(p,f,n),f}function v(){e(".tvcolorpicker-popup").removeClass("opened").remove(),e(y).data("tvcolorpicker",null),e(y).each(function(){var t=e(this).data("tvcolorpicker-custom-color");t&&(c(t)&&e(this).trigger("customcolorchange",[d]),e(this).data("tvcolorpicker-custom-color",null)),(t=e(this).data("tvcolorpicker-previous-color"))&&t!=e(this).val()&&e(this).trigger("change"),e(this).removeData("tvcolorpicker-previous-color")})}h=e.extend({},a.options,h||{});var y=this;return h&&"customColors"in h&&s(h.customColors),this.each(function(){function t(){var e=n(i.val());f.call(i,e)}var i=e(this);i.val(n(i.val()));var o=null,r=!1;i.addClass("tvcolorpicker-widget").attr("autocomplete","off").attr("readonly",!0);var s=function(){i.data("tvcolorpicker")||(o=_.call(i,h),i.data("tvcolorpicker-custom-color",null),i.data("tvcolorpicker",o),i.data("tvcolorpicker-previous-color",i.val()),o.bind("mousedown click",function(t){e(t.target).parents().andSelf().is(o)&&(i.focus(),r=!0,setTimeout(function(){r=!1},0))}))};i.on("touchstart",s),i.focus(s),i.blur(function(e){r?e.stopPropagation():v.call(i)}),i.change(function(e){t()}),t()})}if(!e)throw Error("This program cannot be run in DOS mode");a.setCustomColors=s,e.fn.tvcolorpicker=a;var l=10,d=[];a.options={direction:"down",offset:0,drift:0}}(window.jQuery);var Mustache="undefined"!=typeof module&&module.exports||{};!function(e){function t(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return y[e]||e})}function i(e,t,i,n){n=n||"<template>";for(var o=t.split("\n"),r=Math.max(i-3,0),s=Math.min(o.length,i+3),o=o.slice(r,s),a=0,l=o.length;l>a;++a)s=a+r+1,o[a]=(s===i?" >> ":"    ")+o[a];return e.template=t,e.line=i,e.file=n,e.message=[n+":"+i,o.join("\n"),"",e.message].join("\n"),e}function n(e,t,i){if("."===e)return t[t.length-1];e=e.split(".");for(var n,o,r,s,a=e.length-1,l=e[a],d=t.length;d;){for(s=t.slice(0),o=t[--d],r=0;a>r&&(o=o[e[r++]],null!=o);)s.push(o);if(o&&l in o){n=o[l];break}}return"function"==typeof n&&(n=n.call(s[s.length-1])),null==n?i:n}function o(e,t,i,o){var r="";if(e=n(e,t),o)(null==e||!1===e||d(e)&&0===e.length)&&(r+=i());else if(d(e))f(e,function(e){t.push(e),r+=i(),t.pop()});else if("object"==typeof e)t.push(e),r+=i(),t.pop();else if("function"==typeof e)var s=t[t.length-1],r=r+(e.call(s,i(),function(e){return l(e,s)})||"");else e&&(r+=i());return r}function r(t,n){n=n||{};for(var o,r,s,a,l,d=n.tags||e.tags,h=d[0],c=d[d.length-1],p=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],u=[],f=!1,_=!1,v=function(){if(!f||_||n.space)u=[];else for(;u.length;)p.splice(u.pop(),1);_=f=!1},y=[],w=function(e){d=g(e).split(/\s+/),r=d[0],s=d[d.length-1]},b=function(e){p.push('";',o,'\nvar partial = partials["'+g(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},T=function(e,r){var s=g(e);if(""===s)throw i(Error("Section name may not be empty"),t,A,n.file);y.push({name:s,inverted:r}),p.push('";',o,'\nvar name = "'+s+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},S=function(e){T(e,!0)},C=function(e){e=g(e);var o=0!=y.length&&y[y.length-1].name;if(!o||e!=o)throw i(Error('Section named "'+e+'" was never opened'),t,A,n.file);e=y.pop(),p.push('";',"\n    return buffer;","\n  };","\n})();"),e.inverted?p.push("\nbuffer += renderSection(name,stack,callback,true);"):p.push("\nbuffer += renderSection(name,stack,callback);"),p.push('\nbuffer += "')},x=function(e){p.push('";',o,'\nbuffer += lookup("'+g(e)+'",stack,"");','\nbuffer += "')},P=function(e){p.push('";',o,'\nbuffer += escapeHTML(lookup("'+g(e)+'",stack,""));','\nbuffer += "')},A=1,L=0,D=t.length;D>L;++L)if(t.slice(L,L+h.length)===h){switch(L+=h.length,a=t.substr(L,1),o="\nline = "+A+";",r=h,s=c,f=!0,a){case"!":L++,l=null;break;case"=":L++,c="="+c,l=w;break;case">":L++,l=b;break;case"#":L++,l=T;break;case"^":L++,l=S;break;case"/":L++,l=C;break;case"{":c="}"+c;case"&":L++,_=!0,l=x;break;default:_=!0,l=P}if(a=t.indexOf(c,L),-1===a)throw i(Error('Tag "'+h+'" was not closed properly'),t,A,n.file);for(h=t.substring(L,a),l&&l(h),l=0;~(l=h.indexOf("\n",l));)A++,l++;L=a+c.length-1,h=r,c=s}else switch(a=t.substr(L,1)){case'"':case"\\":_=!0,p.push("\\"+a);break;case"\r":break;case"\n":u.push(p.length),p.push("\\n"),v(),A++;break;default:m.test(a)?u.push(p.length):_=!0,p.push(a)}if(0!=y.length)throw i(Error('Section "'+y[y.length-1].name+'" was not closed properly'),t,A,n.file);return v(),p.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }"),c=p.join("").replace(/buffer \+= "";\n/g,""),n.debug&&("undefined"!=typeof console&&console.log?console.log(c):"function"==typeof print&&print(c)),c}function s(e,s){var a=r(e,s),d=new Function("view,partials,stack,lookup,escapeHTML,renderSection,render",a);return function(r,a){a=a||{};var h=[r];try{return d(r,a,h,n,t,o,l)}catch(c){throw i(c.error,e,c.line,s.file)}}}function a(e,t){return t=t||{},!1!==t.cache?(w[e]||(w[e]=s(e,t)),w[e]):s(e,t)}function l(e,t,i){return a(e)(t,i)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=r,e.compile=a,e.render=l,e.clearCache=function(){w={}},e.to_html=function(e,t,i,n){return e=l(e,t,i),"function"!=typeof n?e:void n(e)};var d,h=Object.prototype.toString,c=Array.isArray,p=Array.prototype.forEach,u=String.prototype.trim;d=c?c:function(e){return"[object Array]"===h.call(e)};var f;f=p?function(e,t,i){return p.call(e,t,i)}:function(e,t,i){for(var n=0,o=e.length;o>n;++n)t.call(i,e[n],n,e)};var g,m=/^\s*$/;if(u)g=function(e){return null==e?"":u.call(e)};else{var _,v;m.test(" ")?(_=/^\s+/,v=/\s+$/):(_=/^[\s\xA0]+/,v=/[\s\xA0]+$/),g=function(e){return null==e?"":String(e).replace(_,"").replace(v,"")}}var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},w={}}(Mustache),Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=2<=arguments.length?arguments[1]:void 0,o=0;i>o;o++)o in t&&e.call(n,t[o],o,t)}),Array.prototype.map||(Array.prototype.map=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=Array(i),o=2<=arguments.length?arguments[1]:void 0,r=0;i>r;r++)r in t&&(n[r]=e.call(o,t[r],r,t));return n}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),i="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),n=i.length;
return function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on non-object");var r,s=[];for(r in o)e.call(o,r)&&s.push(r);if(t)for(r=0;n>r;r++)e.call(o,i[r])&&s.push(i[r]);return s}}()),function(e){var t=["","webkit","moz","o","ms"],i=0;!function(i,n){var o;e:{var r;for(o in t){r=t[o];var s;if(s=i,s=s[0].toUpperCase()+s.slice(1),r+=s,r=r[0].toLowerCase()+r.slice(1),e[r]){o=r;break e}}o=!1}e[i]=o?e[o]:n}("requestAnimationFrame",function(e){return setTimeout(e,16),i++})}(this),function(){var e,t,i,n,o,r;window.parent!==window&&window.CanvasRenderingContext2D&&window.TextMetrics&&(t=window.CanvasRenderingContext2D.prototype)&&t.hasOwnProperty("font")&&t.hasOwnProperty("mozTextStyle")&&"function"==typeof t.__lookupSetter__&&(i=t.__lookupSetter__("font"))&&(t.__defineSetter__("font",function(e){try{return i.call(this,e)}catch(t){if("NS_ERROR_FAILURE"!==t.name)throw t}}),n=t.measureText,e=function(){this.width=0,this.isFake=!0,this.__proto__=window.TextMetrics.prototype},t.measureText=function(t){try{return n.apply(this,arguments)}catch(i){if("NS_ERROR_FAILURE"!==i.name)throw i;return new e}},o=t.fillText,t.fillText=function(e,t,i,n){try{o.apply(this,arguments)}catch(r){if("NS_ERROR_FAILURE"!==r.name)throw r}},r=t.strokeText,t.strokeText=function(e,t,i,n){try{r.apply(this,arguments)}catch(o){if("NS_ERROR_FAILURE"!==o.name)throw o}})}(),eval(function(e,t,i,n,o,r){if(o=function(e){return(t>e?"":o(parseInt(e/t)))+(35<(e%=t)?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;i--;)r[o(i)]=n[i]||o(i);n=[function(e){return r[e]}],o=function(){return"\\w+"},i=1}for(;i--;)n[i]&&(e=e.replace(new RegExp("\\b"+o(i)+"\\b","g"),n[i]));return e}("h.i['1a']=h.i['z'];h.O(h.i,{y:'D',z:9(x,t,b,c,d){6 h.i[h.i.y](x,t,b,c,d)},17:9(x,t,b,c,d){6 c*(t/=d)*t+b},D:9(x,t,b,c,d){6-c*(t/=d)*(t-2)+b},13:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t+b;6-c/2*((--t)*(t-2)-1)+b},X:9(x,t,b,c,d){6 c*(t/=d)*t*t+b},U:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t+1)+b},R:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t+b;6 c/2*((t-=2)*t*t+2)+b},N:9(x,t,b,c,d){6 c*(t/=d)*t*t*t+b},M:9(x,t,b,c,d){6-c*((t=t/d-1)*t*t*t-1)+b},L:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t+b;6-c/2*((t-=2)*t*t*t-2)+b},K:9(x,t,b,c,d){6 c*(t/=d)*t*t*t*t+b},J:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t*t*t+1)+b},I:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t*t+b;6 c/2*((t-=2)*t*t*t*t+2)+b},G:9(x,t,b,c,d){6-c*8.C(t/d*(8.g/2))+c+b},15:9(x,t,b,c,d){6 c*8.n(t/d*(8.g/2))+b},12:9(x,t,b,c,d){6-c/2*(8.C(8.g*t/d)-1)+b},Z:9(x,t,b,c,d){6(t==0)?b:c*8.j(2,10*(t/d-1))+b},Y:9(x,t,b,c,d){6(t==d)?b+c:c*(-8.j(2,-10*t/d)+1)+b},W:9(x,t,b,c,d){e(t==0)6 b;e(t==d)6 b+c;e((t/=d/2)<1)6 c/2*8.j(2,10*(t-1))+b;6 c/2*(-8.j(2,-10*--t)+2)+b},V:9(x,t,b,c,d){6-c*(8.o(1-(t/=d)*t)-1)+b},S:9(x,t,b,c,d){6 c*8.o(1-(t=t/d-1)*t)+b},Q:9(x,t,b,c,d){e((t/=d/2)<1)6-c/2*(8.o(1-t*t)-1)+b;6 c/2*(8.o(1-(t-=2)*t)+1)+b},P:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6-(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b},H:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6 a*8.j(2,-10*t)*8.n((t*d-s)*(2*8.g)/p)+c+b},T:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d/2)==2)6 b+c;e(!p)p=d*(.3*1.5);e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);e(t<1)6-.5*(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b;6 a*8.j(2,-10*(t-=1))*8.n((t*d-s)*(2*8.g)/p)*.5+c+b},F:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*(t/=d)*t*((s+1)*t-s)+b},E:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},16:9(x,t,b,c,d,s){e(s==u)s=1.l;e((t/=d/2)<1)6 c/2*(t*t*(((s*=(1.B))+1)*t-s))+b;6 c/2*((t-=2)*t*(((s*=(1.B))+1)*t+s)+2)+b},A:9(x,t,b,c,d){6 c-h.i.v(x,d-t,0,c,d)+b},v:9(x,t,b,c,d){e((t/=d)<(1/2.k)){6 c*(7.q*t*t)+b}m e(t<(2/2.k)){6 c*(7.q*(t-=(1.5/2.k))*t+.k)+b}m e(t<(2.5/2.k)){6 c*(7.q*(t-=(2.14/2.k))*t+.11)+b}m{6 c*(7.q*(t-=(2.18/2.k))*t+.19)+b}},1b:9(x,t,b,c,d){e(t<d/2)6 h.i.A(x,t*2,0,c,d)*.5+b;6 h.i.v(x,t*2-d,0,c,d)*.5+c*.5+b}});",62,74,"      return  Math function     if var PI jQuery easing pow 75 70158 else sin sqrt  5625 asin   undefined easeOutBounce abs  def swing easeInBounce 525 cos easeOutQuad easeOutBack easeInBack easeInSine easeOutElastic easeInOutQuint easeOutQuint easeInQuint easeInOutQuart easeOutQuart easeInQuart extend easeInElastic easeInOutCirc easeInOutCubic easeOutCirc easeInOutElastic easeOutCubic easeInCirc easeInOutExpo easeInCubic easeOutExpo easeInExpo  9375 easeInOutSine easeInOutQuad 25 easeOutSine easeInOutBack easeInQuad 625 984375 jswing easeInOutBounce".split(" "),0,{})),function(e){var t=e(window),i=e(document),n=function(n){n=jQuery.data(n.target),t.scrollTop()>i.height()-t.innerHeight()-(n.tolerance||190)&&e(this).trigger("scrolltoend")};e.event.special.scrolltoend={setup:function(t,i){e(this).bind("scroll.scrolltoend",n)},teardown:function(t){e(this).unbind("scroll.scrolltoend",n)}},jQuery.event.special.scrollto={bindType:"scroll",handle:function(e){var n=e.handleObj;e.scrollData||(e.scrollData={scrollTop:t.scrollTop()});var o=null;if("number"==typeof e.data.to)o=e.scrollData.scrollTop>e.data.to-(e.data.tolerance||0)?!0:!1;else{if("bottom"!==e.data.to)throw Error('Special event scrollto: property "to" has unexpected value');e.scrollData.bottomOffset||(e.scrollData.bottomOffset=i.height()-t.innerHeight()),o=e.scrollData.scrollTop>e.scrollData.bottomOffset-(e.data.tolerance||0)?!0:!1}var r=Array.prototype.slice.apply(arguments);return o?(r.push(!0),n.handler.apply(this,r)):e.data.twoway?(r.push(!1),n.handler.apply(this,r)):void 0}}}(jQuery),jQuery.fn.timeUpdate=function(){return this.each(function(){var e=jQuery(this).data("timestamp"),e=e?1e3*e:1e3*jQuery(this).text();TradingView.agoDateFormatter(jQuery(this),new Date(e)),jQuery(this).removeClass("time-upd")})},function(e){function t(e,t,i){for(var n=0;n<h.length;n++)h[n]||(t=t.toLowerCase()),e.addEventListener(h[n]+t,i,!1)}function i(e){e.stop(!0),e.css("background-color",""),e.removeData("flicker-enable"),e.removeData("flicker-options")}function n(t){var n=t.data("flicker-enable");n&&(!0!==n?(n--,n?(o(t),t.data("flicker-enable",n)):(n=t.data("flicker-options").complete,i(t),n&&e.isFunction(n)&&n())):o(t))}function o(e){var t=e.css("background-color"),i=e.data("flicker-options"),o=i.duration||400,r=i.easing||"swing";e.animate({"background-color":i.highlightColor||"#fbf8e9"},o,r).animate({"background-color":t},o,r,n.bind(e,e))}var r=!1,s=document.body||document.documentElement,a="animation",l=["Webkit","Moz","O","ms","Khtml"],d="";if(void 0!==s.style.animationName&&(r=!0),!1===r)for(d=0;d<l.length;d++)if(void 0!==s.style[l[d]+"AnimationName"]){d=l[d],a=d+"Animation",d.toLowerCase(),r=!0;break}var h=["webkit","moz","MS","o",""];e.fn.highlight=function(n,s){switch(n){default:n=void 0===n?!0:n,this.each(function(){if(r)n=!0===n?"infinite":n,t(this,"AnimationEnd",function(){this.style[a]=""}),this.style[a]="highlight-animation 0.4s ease-in-out "+n+" alternate";else{var i=e(this);i.data("flicker-enable",n),i.data("flicker-options",e.extend({},s||{})),i.is(":animated")||o(i)}});break;case!1:this.each(function(){r?this.style[a]="":i(e(this))})}}}(jQuery),function(e){var t,i;"undefined"!=typeof document.hidden?(t="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(t="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(t="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(t="webkitHidden",i="webkitvisibilitychange"),e.tabvisible=!0,i&&(e(document).on(i,function(i){e.tabvisible=!document[t],e(window).trigger("visibilitychange",!document[t])}),e(document).trigger(i)),e.whenTabVisible=function(t){!i||e.tabvisible?t():e(window).one("visibilitychange",t)}}(jQuery),!function(e){function t(o,r,s,a,l){var d=o.contents(),h=!1;o.empty();for(var c=0,p=d.length;p>c&&!h;c++){var u=d[c],f=e(u);"undefined"!=typeof u&&(o.append(f),l&&o[o.is("table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style")?"after":"append"](l),3==u.nodeType?n(s,a)&&(h=i(f,r,s,a,l)):h=t(f,r,s,a,l),h||l&&l.detach())}return h}function i(e,t,r,l,d){var h=!1,c=e[0];if("undefined"==typeof c)return!1;for(var p=a(c),u=-1!==p.indexOf(" ")?" ":"　",u="letter"==l.wrap?"":u,p=p.split(u),f=-1,g=-1,m=0,_=p.length-1;_>=m;){var v=Math.floor((m+_)/2);if(v==g)break;g=v,s(c,p.slice(0,g+1).join(u)+l.ellipsis),n(r,l)?_=g:(f=g,m=g),_==m&&0==_&&l.fallbackToLetter&&(u="",p=p[0].split(u),f=-1,g=-1,m=0,_=p.length-1)}return-1==f||1==p.length&&0==p[0].length?(u=e.parent(),e.remove(),c=d?d.length:0,u.contents().size()>c?(h=u.contents().eq(-1-c),h=i(h,t,r,l,d)):(t=u.prev(),c=t.contents().eq(-1)[0],"undefined"!=typeof c&&(p=o(a(c),l),s(c,p),d&&t.append(d),u.remove(),h=!0))):(p=o(p.slice(0,f+1).join(u),l),h=!0,s(c,p)),h}function n(e,t){return e.innerHeight()>t.maxHeight}function o(t,i){for(;-1<e.inArray(t.slice(-1),i.lastCharacter.remove);)t=t.slice(0,-1);return 0>e.inArray(t.slice(-1),i.lastCharacter.noEllipsis)&&(t+=i.ellipsis),t}function r(e){return{width:e.innerWidth(),height:e.innerHeight()}}function s(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function a(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function l(t,i){return"undefined"==typeof t?!1:t?"string"==typeof t?(t=e(t,i),t.length?t:!1):"object"==typeof t?"undefined"==typeof t.jquery?!1:t:!1:!1}function d(e,t){return e?(t="string"==typeof t?"dotdotdot: "+t:["dotdotdot:",t],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(t),!1):!1}if(!e.fn.dotdotdot){e.fn.dotdotdot=function(i){if(0==this.length)return i&&!1===i.debug||d(!0,'No element found for "'+this.selector+'".'),this;if(1<this.length)return this.each(function(){e(this).dotdotdot(i)});var o=this;o.data("dotdotdot")&&o.trigger("destroy.dot"),o.data("dotdotdot-style",o.attr("style")),o.css("word-wrap","break-word"),o.bind_events=function(){return o.bind("update.dot",function(i,r){i.preventDefault(),i.stopPropagation();var l,d=a;if("number"==typeof a.height)l=a.height;else{l=o.innerHeight();for(var h=["paddingTop","paddingBottom"],p=0,u=h.length;u>p;p++){var g=parseInt(o.css(h[p]),10);isNaN(g)&&(g=0),l-=g}}if(d.maxHeight=l,a.maxHeight+=a.tolerance,"undefined"!=typeof r&&(("string"==typeof r||r instanceof HTMLElement)&&(r=e("<div />").append(r).contents()),r instanceof e&&(s=r)),f=o.wrapInner('<div class="dotdotdot" />').children(),f.empty().append(s.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0}),d=h=!1,c.afterElement&&(h=c.afterElement.clone(!0),c.afterElement.remove()),n(f,a))if("children"==a.wrap){d=f,l=a,p=d.children(),u=!1,d.empty();for(var g=0,m=p.length;m>g;g++){var _=p.eq(g);if(d.append(_),h&&d.append(h),n(d,l)){_.remove(),u=!0;break}h&&h.detach()}d=u}else d=t(f,o,f,a,h);return f.replaceWith(f.contents()),f=null,e.isFunction(a.callback)&&a.callback.call(o[0],d,s),c.isTruncated=d,d}).bind("isTruncated.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(o[0],c.isTruncated),c.isTruncated}).bind("originalContent.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(o[0],s),s}).bind("destroy.dot",function(e){e.preventDefault(),e.stopPropagation(),o.unwatch().unbind_events().empty().append(s).attr("style",o.data("dotdotdot-style")).data("dotdotdot",!1)}),o},o.unbind_events=function(){return o.unbind(".dot"),o},o.watch=function(){if(o.unwatch(),"window"==a.watch){var t=e(window),i=t.width(),n=t.height();t.bind("resize.dot"+c.dotId,function(){i==t.width()&&n==t.height()&&a.windowResizeFix||(i=t.width(),n=t.height(),u&&clearInterval(u),u=setTimeout(function(){o.trigger("update.dot")},10))})}else p=r(o),u=setInterval(function(){var e=r(o);(p.width!=e.width||p.height!=e.height)&&(o.trigger("update.dot"),p=r(o))},100);return o},o.unwatch=function(){return e(window).unbind("resize.dot"+c.dotId),u&&clearInterval(u),o};var s=o.contents(),a=e.extend(!0,{},e.fn.dotdotdot.defaults,i),c={},p={},u=null,f=null;return a.lastCharacter.remove instanceof Array||(a.lastCharacter.remove=e.fn.dotdotdot.defaultArrays.lastCharacter.remove),a.lastCharacter.noEllipsis instanceof Array||(a.lastCharacter.noEllipsis=e.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),c.afterElement=l(a.after,o),c.isTruncated=!1,c.dotId=h++,o.data("dotdotdot",!0).bind_events().trigger("update.dot"),a.watch&&o.watch(),o},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1},e.fn.dotdotdot.defaultArrays={lastCharacter:{remove:" 　,;.!?".split(""),noEllipsis:[]}};var h=1,c=e.fn.html;e.fn.html=function(e){return"undefined"!=typeof e?this.data("dotdotdot")&&"function"!=typeof e?this.trigger("update",[e]):c.call(this,e):c.call(this)};var p=e.fn.text;e.fn.text=function(t){if("undefined"!=typeof t){if(this.data("dotdotdot")){var i=e("<div />");return i.text(t),t=i.html(),i.remove(),this.trigger("update",[t])}return p.call(this,t)}return p.call(this)}}}(jQuery),function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,i=/^get|post$/i,n=new RegExp("^"+location.protocol,"i"),o=/text\/html/i,r=/\/json/i,s=/\/xml/i;e.ajaxTransport("* text html xml json",function(a,l,d){if(a.crossDomain&&a.async&&i.test(a.type)&&t.test(a.url)&&n.test(a.url)){var h=null,c=(l.dataType||"").toLowerCase();return{send:function(t,i){h=new XDomainRequest,/^\d+$/.test(l.timeout)&&(h.timeout=l.timeout),h.ontimeout=function(){i(500,"timeout")},h.onload=function(){var t="Content-Length: "+h.responseText.length+"\r\nContent-Type: "+h.contentType,n=200,a="success",l={text:h.responseText};try{if("html"===c||o.test(h.contentType))l.html=h.responseText;else if("json"===c||"text"!==c&&r.test(h.contentType))try{l.json=e.parseJSON(h.responseText)}catch(d){n=500,a="parseerror"}else if("xml"===c||"text"!==c&&s.test(h.contentType)){var p=new ActiveXObject("Microsoft.XMLDOM");p.async=!1;try{p.loadXML(h.responseText)}catch(u){p=void 0}if(!p||!p.documentElement||p.getElementsByTagName("parsererror").length)throw n=500,a="parseerror","Invalid XML: "+h.responseText;l.xml=p}}catch(f){throw f}finally{i(n,a,l,t)}},h.onprogress=function(){},h.onerror=function(){i(500,"error",{text:h.responseText})};var n="";l.data&&(n="string"===e.type(l.data)?l.data:e.param(l.data)),h.open(a.type,a.url),h.send(n)},abort:function(){h&&h.abort()}}}})}}(jQuery),function(e){e.fn.inputselectable=function(t){var i=e(this);if(t=e.extend({},t),!i.is('input[type="text"]'))throw Error(i+' should be input[type="text"]');if(t.list&&t.list.length&&!i.hasClass("ISinput")){i.addClass("ISinput");var n=e('<div class="ISwraper"></div>'),o=e('<div class="IStoggle"></div>'),r=function(n,r,s){function a(n,r){r||(r=l),r.remove(),i.off("click"),t.closeHandle instanceof e&&t.closeHandle.off("click"),o.removeClass("active"),i.focus()}if(n.stopPropagation(),(!o.is(":active")&&!o.is(".active")||(a(null,e(".ISdropdown")),!s))&&r&&r.length){for(n='<ul class="ISdropdown">',s=0;s<r.length;s++)n+='<li><div><span class="IStext">'+r[s]+"</span></div></li>";var l=e(n+"</ul>");l.find("li").each(function(){e(this).click(function(){i.val(e(this).find(".IStext").text()),a()})}),i.on("click","",a),t.closeHandle instanceof e&&t.closeHandle.on("click","",a),l.insertAfter(i),l.css({top:i.outerHeight(),width:i.outerWidth(),"max-height":e(window).height()-l.offset().top-35}),o.toggleClass("active")}};return i.wrap(n),"static"==i.css("position")?n.css("position","relative"):n.css({top:i.css("top"),left:i.css("left"),position:i.css("position")}),n.css({width:i.outerHeight(),height:i.outerWidth()}),o.insertAfter(i),o.click(function(e){r(e,t.list,!0)}),i.keyup(function(n){var o=new RegExp(i.val(),"i"),s=e.grep(t.list,function(e){return o.test(e)});r(n,s)}),i.focus()}}}(jQuery),function(e){function t(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(e,t){return function(i){return d(e.call(this,i),t)}}function n(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)}}function o(){}function r(e){v(e),a(this,e)}function s(e){e=f(e);var t=e.year||0,i=e.month||0,n=e.week||0,o=e.day||0;this._milliseconds=+(e.millisecond||0)+1e3*(e.second||0)+6e4*(e.minute||0)+36e5*(e.hour||0),this._days=+o+7*n,this._months=+i+12*t,this._data={},this._bubble()}function a(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function l(e){return 0>e?Math.ceil(e):Math.floor(e)}function d(e,t,i){for(var n=""+Math.abs(e);n.length<t;)n="0"+n;return(e>=0?i?"+":"":"-")+n}function h(e,t,i,n){var o,r,s=t._milliseconds,a=t._days;t=t._months,s&&e._d.setTime(+e._d+s*i),(a||t)&&(o=e.minute(),r=e.hour()),a&&e.date(e.date()+a*i),t&&e.month(e.month()+t*i),s&&!n&&U.updateOffset(e),(a||t)&&(e.minute(o),e.hour(r))}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function p(e,t,i){var n,o=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0;for(n=0;o>n;n++)(i&&e[n]!==t[n]||!i&&m(e[n])!==m(t[n]))&&s++;return s+r}function u(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ke[e]||Ee[t]||t}return e}function f(e){var t,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=u(i),t&&(n[t]=e[i]));return n}function g(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else{if(0!==t.indexOf("month"))return;i=12,n="month"}U[t]=function(o,r){var s,a,l=U.fn._lang[t],d=[];if("number"==typeof o&&(r=o,o=e),a=function(e){return e=U().utc().set(n,e),l.call(U.fn._lang,e,o||"")},null!=r)return a(r);for(s=0;i>s;s++)d.push(a(s));return d}}function m(e){e=+e;var t=0;return 0!==e&&isFinite(e)&&(t=e>=0?Math.floor(e):Math.ceil(e)),t}function _(e){return 0===e%4&&0!==e%100||0===e%400}function v(e){var t;e._a&&-2===e._pf.overflow&&(t=0>e._a[J]||11<e._a[J]?J:1>e._a[X]||e._a[X]>new Date(Date.UTC(e._a[G],e._a[J]+1,0)).getUTCDate()?X:0>e._a[K]||23<e._a[K]?K:0>e._a[Q]||59<e._a[Q]?Q:0>e._a[Z]||59<e._a[Z]?Z:0>e._a[ee]||999<e._a[ee]?ee:-1,e._pf._overflowDayOfYear&&(G>t||t>X)&&(t=X),e._pf.overflow=t)}function y(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&0>e._pf.overflow&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function w(e){return e?e.toLowerCase().replace("_","-"):e}function b(e,t){return t._isUTC?U(e).zone(t._offset||0):U(e).local()}function T(e){var t,i,n,o,r=0,s=function(e){if(!te[e]&&ne)try{require("./lang/"+e)}catch(t){}return te[e]};if(!e)return U.fn._lang;if(!c(e)){if(i=s(e))return i;e=[e]}for(;r<e.length;){for(o=w(e[r]).split("-"),t=o.length,n=(n=w(e[r+1]))?n.split("-"):null;t>0;){if(i=s(o.slice(0,t).join("-")))return i;if(n&&n.length>=t&&p(o,n,!0)>=t-1)break;t--}r++}return U.fn._lang}function S(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function C(e){var t,i,n=e.match(ae);for(t=0,i=n.length;i>t;t++)n[t]=We[n[t]]?We[n[t]]:S(n[t]);return function(o){var r="";for(t=0;i>t;t++)r+=n[t]instanceof Function?n[t].call(o,e):n[t];return r}}function x(e,t){return e.isValid()?(t=P(t,e.lang()),Ve[t]||(Ve[t]=C(t)),Ve[t](e)):e.lang().invalidDate()}function P(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(le.lastIndex=0;n>=0&&le.test(e);)e=e.replace(le,i),le.lastIndex=0,--n;return e}function A(e,t){var i=t._strict;switch(e){case"DDDD":return we;case"YYYY":case"GGGG":case"gggg":return i?be:ce;case"Y":case"G":case"g":return Se;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Te:pe;case"S":if(i)return ve;case"SS":if(i)return ye;case"SSS":if(i)return we;case"DDD":return he;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return fe;case"a":case"A":return T(t._l)._meridiemParse;case"X":return _e;case"Z":case"ZZ":return ge;case"T":return me;case"SSSS":return ue;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?ye:de;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return de;default:var n,i=RegExp;return n=V(e.replace("\\","")).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),new i(n)}}function L(e){e=(e||"").match(ge)||[],e=((e[e.length-1]||[])+"").match(Ae)||["-",0,0];var t=+(60*e[1])+m(e[2]);return"+"===e[0]?-t:t}function D(e){var t,i,n,o,r,s,a,l,d,h=[];if(!e._d){for(i=k(e),e._w&&null==e._a[X]&&null==e._a[J]&&(o=function(t){var i=parseInt(t,10);return t?3>t.length?i>68?1900+i:2e3+i:i:null==e._a[G]?U().weekYear():e._a[G]},r=e._w,null!=r.GG||null!=r.W||null!=r.E?s=B(o(r.GG),r.W||1,r.E,4,1):(a=T(e._l),l=null!=r.d?W(r.d,a):null!=r.e?parseInt(r.e,10)+a._week.dow:0,d=parseInt(r.w,10)||1,null!=r.d&&l<a._week.dow&&d++,s=B(o(r.gg),d,l,a._week.doy,a._week.dow)),e._a[G]=s.year,e._dayOfYear=s.dayOfYear),e._dayOfYear&&(n=null==e._a[G]?i[G]:e._a[G],e._dayOfYear>(_(n)?366:365)&&(e._pf._overflowDayOfYear=!0),t=M(n,0,e._dayOfYear),e._a[J]=t.getUTCMonth(),e._a[X]=t.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=h[t]=i[t];for(;7>t;t++)e._a[t]=h[t]=null==e._a[t]?2===t?1:0:e._a[t];h[K]+=m((e._tzm||0)/60),h[Q]+=m((e._tzm||0)%60),e._d=(e._useUTC?M:I).apply(null,h)}}function k(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function E(e){e._a=[],e._pf.empty=!0;var t,i,n,o,r;t=T(e._l);var s=""+e._i,a=s.length,l=0;for(n=P(e._f,t).match(ae)||[],t=0;t<n.length;t++)if(o=n[t],(i=(s.match(A(o,e))||[])[0])&&(r=s.substr(0,s.indexOf(i)),0<r.length&&e._pf.unusedInput.push(r),s=s.slice(s.indexOf(i)+i.length),l+=i.length),We[o]){i?e._pf.empty=!1:e._pf.unusedTokens.push(o);var d=e,h=void 0,c=d._a;switch(o){case"M":case"MM":null!=i&&(c[J]=m(i)-1);break;case"MMM":case"MMMM":h=T(d._l).monthsParse(i),null!=h?c[J]=h:d._pf.invalidMonth=i;break;case"D":case"DD":null!=i&&(c[X]=m(i));break;case"DDD":case"DDDD":null!=i&&(d._dayOfYear=m(i));break;case"YY":c[G]=m(i)+(68<m(i)?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":c[G]=m(i);break;case"a":case"A":d._isPm=T(d._l).isPM(i);break;case"H":case"HH":case"h":case"hh":c[K]=m(i);break;case"m":case"mm":c[Q]=m(i);break;case"s":case"ss":c[Z]=m(i);break;case"S":case"SS":case"SSS":case"SSSS":c[ee]=m(1e3*("0."+i));break;case"X":d._d=new Date(1e3*parseFloat(i));break;case"Z":case"ZZ":d._useUTC=!0,d._tzm=L(i);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":o=o.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":o=o.substr(0,2),i&&(d._w=d._w||{},d._w[o]=i)}}else e._strict&&!i&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=a-l,0<s.length&&e._pf.unusedInput.push(s),e._isPm&&12>e._a[K]&&(e._a[K]+=12),!1===e._isPm&&12===e._a[K]&&(e._a[K]=0),D(e),v(e)}function V(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o})}function I(e,t,i,n,o,r,s){return t=new Date(e,t,i,n,o,r,s),1970>e&&t.setFullYear(e),t}function M(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function W(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function $(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}function R(e,t,i){var n;return t=i-t,i-=e.day(),i>t&&(i-=7),t-7>i&&(i+=7),n=U(e).add("d",i),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function B(e,t,i,n,o){var r,s,a=M(e,0,1).getUTCDay();return i=null!=i?i:o,r=o-a+(a>n?7:0)-(o>a?7:0),s=7*(t-1)+(i-o)+r+1,{year:s>0?e:e-1,dayOfYear:s>0?s:(_(e-1)?366:365)+s}}function O(i){var n=i._i,o=i._f;if(null===n)i=U.invalid({nullInput:!0});else{if("string"==typeof n&&(i._i=n=T().preparse(n)),U.isMoment(n)){i=n;var s,l={};for(s in i)i.hasOwnProperty(s)&&ie.hasOwnProperty(s)&&(l[s]=i[s]);i=l,i._d=new Date(+n._d)}else if(o)if(c(o)){var d,h,p=i;if(0===p._f.length)p._pf.invalidFormat=!0,p._d=new Date(NaN);else{for(n=0;n<p._f.length;n++)s=0,l=a({},p),l._pf=t(),l._f=p._f[n],E(l),y(l)&&(s+=l._pf.charsLeftOver,s+=10*l._pf.unusedTokens.length,l._pf.score=s,(null==h||h>s)&&(h=s,d=l));a(p,d||l)}}else E(i);else if(l=i,d=l._i,h=oe.exec(d),d===e)l._d=new Date;else if(h)l._d=new Date(+h[1]);else if("string"==typeof d)if(p=l._i,n=Ce.exec(p)){for(l._pf.iso=!0,d=0,h=xe.length;h>d;d++)if(xe[d][1].exec(p)){l._f=xe[d][0]+(n[6]||" ");break}for(d=0,h=Pe.length;h>d;d++)if(Pe[d][1].exec(p)){l._f+=Pe[d][0];break}p.match(ge)&&(l._f+="Z"),E(l)}else l._d=new Date(p);else c(d)?(l._a=d.slice(0),D(l)):"[object Date]"===Object.prototype.toString.call(d)||d instanceof Date?l._d=new Date(+d):"object"==typeof d?l._d||(p=f(l._i),l._a=[p.year,p.month,p.day,p.hour,p.minute,p.second,p.millisecond],D(l)):l._d=new Date(d);i=new r(i)}return i}function N(e,t){U.fn[e]=U.fn[e+"s"]=function(e){var i=this._isUTC?"UTC":"";return null!=e?(this._d["set"+i+t](e),U.updateOffset(this),this):this._d["get"+i+t]()}}function F(e){U.duration.fn[e]=function(){return this._data[e]}}function z(e,t){U.duration.fn["as"+e]=function(){return+this/t}}function H(e){var t=!1,i=U;"undefined"==typeof ender&&(e?(Y.moment=function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)},a(Y.moment,i)):Y.moment=U)}for(var U,j,Y=this,q=Math.round,G=0,J=1,X=2,K=3,Q=4,Z=5,ee=6,te={},ie={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},ne="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,oe=/^\/?Date\((\-?\d+)/i,re=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,se=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ae=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,le=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,de=/\d\d?/,he=/\d{1,3}/,ce=/\d{1,4}/,pe=/[+\-]?\d{1,6}/,ue=/\d+/,fe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ge=/Z|[\+\-]\d\d:?\d\d/gi,me=/T/i,_e=/[\+\-]?\d+(\.\d{1,3})?/,ve=/\d/,ye=/\d\d/,we=/\d{3}/,be=/\d{4}/,Te=/[+-]?\d{6}/,Se=/[+-]?\d+/,Ce=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xe=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Pe=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ae=/([\+\-]|\d\d)/gi,Le=["Date","Hours","Minutes","Seconds","Milliseconds"],De={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ke={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ee={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Ve={},Ie="DDD w W M D d".split(" "),Me="MDHhmswW".split(""),We={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return d(this.year()%100,2)},YYYY:function(){return d(this.year(),4)},YYYYY:function(){return d(this.year(),5)},YYYYYY:function(){var e=this.year();return(e>=0?"+":"-")+d(Math.abs(e),6)},gg:function(){return d(this.weekYear()%100,2)},gggg:function(){return d(this.weekYear(),4)},ggggg:function(){return d(this.weekYear(),5)},GG:function(){return d(this.isoWeekYear()%100,2)},GGGG:function(){return d(this.isoWeekYear(),4)},GGGGG:function(){return d(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return m(this.milliseconds()/100)},SS:function(){return d(m(this.milliseconds()/10),2)},SSS:function(){return d(this.milliseconds(),3)},SSSS:function(){return d(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+d(m(e/60),2)+":"+d(m(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+d(m(e/60),2)+d(m(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},$e=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Ie.length;)j=Ie.pop(),We[j+"o"]=n(We[j],j);for(;Me.length;)j=Me.pop(),We[j+j]=i(We[j],2);for(We.DDDD=i(We.DDD,3),a(o.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January February March April May June July August September October November December".split(" "),months:function(e){return this._months[e.month()]},_monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=U.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=U([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var o=this._relativeTime[i];return"function"==typeof o?o(e,t,i,n):o.replace(/%d/i,e)},pastFuture:function(e,t){
var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return R(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),U=function(i,n,o,r){var s;return"boolean"==typeof o&&(r=o,o=e),s={},s._isAMomentObject=!0,s._i=i,s._f=n,s._l=o,s._strict=r,s._isUTC=!1,s._pf=t(),O(s)},U.utc=function(i,n,o,r){var s;return"boolean"==typeof o&&(r=o,o=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=o,s._i=i,s._f=n,s._strict=r,s._pf=t(),O(s).utc()},U.unix=function(e){return U(1e3*e)},U.duration=function(e,t){var i,n,o,r=e,a=null;return U.isDuration(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(r={},t?r[t]=e:r.milliseconds=e):(a=re.exec(e))?(i="-"===a[1]?-1:1,r={y:0,d:m(a[X])*i,h:m(a[K])*i,m:m(a[Q])*i,s:m(a[Z])*i,ms:m(a[ee])*i}):(a=se.exec(e))&&(i="-"===a[1]?-1:1,o=function(e){return e=e&&parseFloat(e.replace(",",".")),(isNaN(e)?0:e)*i},r={y:o(a[2]),M:o(a[3]),d:o(a[4]),h:o(a[5]),m:o(a[6]),s:o(a[7]),w:o(a[8])}),n=new s(r),U.isDuration(e)&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},U.version="2.5.1",U.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",U.updateOffset=function(){},U.lang=function(e,t){var i,n;return e?(t?(n=w(e),t.abbr=n,te[n]||(te[n]=new o),te[n].set(t)):null===t?(delete te[e],e="en"):te[e]||T(e),i=U.duration.fn._lang=U.fn._lang=T(e),n=i._abbr):n=U.fn._lang._abbr,n},U.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),T(e)},U.isMoment=function(e){return e instanceof r||null!=e&&e.hasOwnProperty("_isAMomentObject")},U.isDuration=function(e){return e instanceof s},j=$e.length-1;j>=0;--j)g($e[j]);for(U.normalizeUnits=function(e){return u(e)},U.invalid=function(e){var t=U.utc(NaN);return null!=e?a(t._pf,e):t._pf.userInvalidated=!0,t},U.parseZone=function(e){return U(e).parseZone()},a(U.fn=r.prototype,{clone:function(){return U(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=U(this).utc();return 0<e.year()&&9999>=e.year()?x(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):x(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){return[this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds(),this.milliseconds()]},isValid:function(){return y(this)},isDSTShifted:function(){return this._a?this.isValid()&&0<p(this._a,(this._isUTC?U.utc(this._a):U(this._a)).toArray()):!1},parsingFlags:function(){return a({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){return e=x(this,e||U.defaultFormat),this.lang().postformat(e)},add:function(e,t){var i;return i="string"==typeof e?U.duration(+t,e):U.duration(e,t),h(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e?U.duration(+t,e):U.duration(e,t),h(this,i,-1),this},diff:function(e,t,i){var n,o;e=b(e,this);var r=6e4*(this.zone()-e.zone());return t=u(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+e.daysInMonth()),o=12*(this.year()-e.year())+(this.month()-e.month()),o+=(this-U(this).startOf("month")-(e-U(e).startOf("month")))/n,o-=6e4*(this.zone()-U(this).startOf("month").zone()-(e.zone()-U(e).startOf("month").zone()))/n,"year"===t&&(o/=12)):(n=this-e,o="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-r)/864e5:"week"===t?(n-r)/6048e5:n),i?o:l(o)},from:function(e,t){return U.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(U(),e)},calendar:function(){var e=b(U(),this).startOf("day"),e=this.diff(e,"days",!0),e=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){return _(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=W(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,i=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+i+"Month"](e),this.date(Math.min(t,this.daysInMonth())),U.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(e){switch(e=u(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=u(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+U(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+U(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+b(e,this).startOf(t)},min:function(e){return e=U.apply(null,arguments),this>e?this:e},max:function(e){return e=U.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=L(e)),16>Math.abs(e)&&(e*=60),this._offset=e,this._isUTC=!0,t!==e&&h(this,U.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?U(e).zone():0,0===(this.zone()-e)%60},daysInMonth:function(){var e=this.year(),t=this.month();return new Date(Date.UTC(e,t+1,0)).getUTCDate()},dayOfYear:function(e){var t=q((U(this).startOf("day")-U(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(e){var t=R(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=R(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=R(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=u(e),this[e]()},set:function(e,t){return e=u(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=T(t),this)}}),j=0;j<Le.length;j++)N(Le[j].toLowerCase().replace(/s$/,""),Le[j]);N("year","FullYear"),U.fn.days=U.fn.day,U.fn.months=U.fn.month,U.fn.weeks=U.fn.week,U.fn.isoWeeks=U.fn.isoWeek,U.fn.toJSON=U.fn.toISOString,a(U.duration.fn=s.prototype,{_bubble:function(){var e,t;e=this._milliseconds,t=this._days;var i=this._months,n=this._data;n.milliseconds=e%1e3,e=l(e/1e3),n.seconds=e%60,e=l(e/60),n.minutes=e%60,e=l(e/60),n.hours=e%24,t+=l(e/24),n.days=t%30,i+=l(t/30),n.months=i%12,t=l(i/12),n.years=t},weeks:function(){return l(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*m(this._months/12)},humanize:function(e){var t,i=+this;t=!e;var n=this.lang(),o=q(Math.abs(i)/1e3),r=q(o/60),s=q(r/60),a=q(s/24),l=q(a/365),o=45>o&&["s",o]||1===r&&["m"]||45>r&&["mm",r]||1===s&&["h"]||22>s&&["hh",s]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",q(a/30)]||1===l&&["y"]||["yy",l];return o[2]=t,o[3]=i>0,o[4]=n,t=$.apply({},o),e&&(t=this.lang().pastFuture(i,t)),this.lang().postformat(t)},add:function(e,t){var i=U.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=U.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=u(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=u(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:U.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),o=Math.abs(this.minutes()),r=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(0>this.asSeconds()?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||o||r?"T":"")+(n?n+"H":"")+(o?o+"M":"")+(r?r+"S":""):"P0D"}});for(j in De)De.hasOwnProperty(j)&&(z(j,De[j]),F(j.toLowerCase()));z("Weeks",6048e5),U.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},U.lang("en",{ordinal:function(e){var t=e%10,t=1===m(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+t}}),ne?(module.exports=U,H(!0)):"function"==typeof define&&define.amd?define("moment",function(t,i,n){return n.config&&n.config()&&!0!==n.config().noGlobal&&H(n.config().noGlobal===e),U}):H()}.call(this),function(){function e(e){return(10>e?"0":"")+e}function t(e){var t=++f+"";return e?e+t:t}function i(i,r){function l(e,t){var i=u.offset(),o=/^touch/.test(e.type),l=i.left+100,d=i.top+100,h=(o?e.originalEvent.touches[0]:e).pageX-l,f=(o?e.originalEvent.touches[0]:e).pageY-d,i=Math.sqrt(h*h+f*f),m=!1;if(!t||!(67>i||i>93)){e.preventDefault();var _=setTimeout(function(){n.addClass("clockpicker-moving")},200);a&&u.append(w.canvas),w.setHand(h,f,!t,!0),s.off(c).on(c,function(e){e.preventDefault();var t=/^touch/.test(e.type),i=(t?e.originalEvent.touches[0]:e).pageX-l;e=(t?e.originalEvent.touches[0]:e).pageY-d,(m||i!==h||e!==f)&&(m=!0,w.setHand(i,e,!1,!0))}),s.off(p).one(p,function(e){e.preventDefault();var i=/^touch/.test(e.type),o=(i?e.originalEvent.changedTouches[0]:e).pageX-l;e=(i?e.originalEvent.changedTouches[0]:e).pageY-d,(t||m)&&o===h&&e===f&&w.setHand(o,e),"hours"===w.currentView?w.toggleView("minutes",g/2):r.autoclose&&(w.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){w.done()},g/2)),u.prepend(C),clearTimeout(_),n.removeClass("clockpicker-moving"),s.off(c)})}}var d=o('<div class="popover clockpicker-popover"><div class="arrow"></div><div class="popover-title"><span class="clockpicker-span-hours text-primary"></span> : <span class="clockpicker-span-minutes"></span></div><div class="popover-content"><div class="clockpicker-plate"><div class="clockpicker-canvas"></div><div class="clockpicker-dial clockpicker-hours"></div><div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div></div></div></div>'),u=d.find(".clockpicker-plate"),f=d.find(".clockpicker-hours"),m=d.find(".clockpicker-minutes"),_="INPUT"===i.prop("tagName"),v=_?i:i.find("input"),y=i.find(".input-group-addon"),w=this;this.id=t("cp"),this.element=i,this.options=r,this.isShown=this.isAppended=!1,this.currentView="hours",this.isInput=_,this.input=v,this.addon=y,this.popover=d,this.plate=u,this.hoursView=f,this.minutesView=m,this.spanHours=d.find(".clockpicker-span-hours"),this.spanMinutes=d.find(".clockpicker-span-minutes"),r.autoclose||o('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+r.donetext+"</button>").click(o.proxy(this.done,this)).appendTo(d),"top"!==r.placement&&"bottom"!==r.placement||"top"!==r.align&&"bottom"!==r.align||(r.align="left"),"left"!==r.placement&&"right"!==r.placement||"left"!==r.align&&"right"!==r.align||(r.align="top"),d.addClass(r.placement),d.addClass("clockpicker-align-"+r.align),this.spanHours.click(o.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(o.proxy(this.toggleView,this,"minutes")),v.on("focus.clockpicker click.clockpicker",o.proxy(this.show,this)),y.on("click.clockpicker",o.proxy(this.toggle,this));for(var b,_=o('<div class="clockpicker-tick"></div>'),v=0;24>v;v+=1){y=_.clone(),b=v/6*Math.PI;var T=v>0&&13>v,S=T?54:80;y.css({left:100+Math.sin(b)*S-13,top:100-Math.cos(b)*S-13}),T&&y.css("font-size","120%"),y.html(0===v?"00":v),f.append(y),y.on(h,l)}for(v=0;60>v;v+=5)y=_.clone(),b=v/30*Math.PI,y.css({left:100+80*Math.sin(b)-13,top:100-80*Math.cos(b)-13}),y.css("font-size","120%"),y.html(e(v)),m.append(y),y.on(h,l);if(u.on(h,function(e){0===o(e.target).closest(".clockpicker-tick").length&&l(e,!0)}),a){var C=d.find(".clockpicker-canvas"),d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("class","clockpicker-svg"),d.setAttribute("width",200),d.setAttribute("height",200),f=document.createElementNS("http://www.w3.org/2000/svg","g"),f.setAttribute("transform","translate(100,100)"),m=document.createElementNS("http://www.w3.org/2000/svg","circle"),m.setAttribute("class","clockpicker-canvas-bearing"),m.setAttribute("cx",0),m.setAttribute("cy",0),m.setAttribute("r",2),_=document.createElementNS("http://www.w3.org/2000/svg","line"),_.setAttribute("x1",0),_.setAttribute("y1",0),v=document.createElementNS("http://www.w3.org/2000/svg","circle"),v.setAttribute("class","clockpicker-canvas-bg"),v.setAttribute("r",13),y=document.createElementNS("http://www.w3.org/2000/svg","circle"),y.setAttribute("class","clockpicker-canvas-fg"),y.setAttribute("r",3.5),f.appendChild(_),f.appendChild(v),f.appendChild(y),f.appendChild(m),d.appendChild(f),C.append(d),this.hand=_,this.bg=v,this.fg=y,this.bearing=m,this.g=f,this.canvas=C}}var n,o=window.jQuery,r=o(window),s=o(document),a="SVGAngle"in window&&function(){var e,t=document.createElement("div");return t.innerHTML="<svg/>",e="http://www.w3.org/2000/svg"==(t.firstChild&&t.firstChild.namespaceURI),t.innerHTML="",e}(),l=function(){var e=document.createElement("div").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e}(),d="ontouchstart"in window,h="mousedown"+(d?" touchstart":""),c="mousemove.clockpicker"+(d?" touchmove.clockpicker":""),p="mouseup.clockpicker"+(d?" touchend.clockpicker":""),u=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,f=0,g=l?350:1;i.DEFAULTS={"default":"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:!1,vibrate:!0},i.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},i.prototype.locate=function(){var e=this.element,t=this.popover,i=e.offset(),n=e.outerWidth(),e=e.outerHeight(),o=this.options.placement,r=this.options.align,s={};switch(t.show(),o){case"bottom":s.top=i.top+e;break;case"right":s.left=i.left+n;break;case"top":s.top=i.top-t.outerHeight();break;case"left":s.left=i.left-t.outerWidth()}switch(r){case"left":s.left=i.left;break;case"right":s.left=i.left+n-t.outerWidth();break;case"top":s.top=i.top;break;case"bottom":s.top=i.top+e-t.outerHeight()}t.css(s)},i.prototype.show=function(t){if(!this.isShown){var i=this;this.isAppended||(n=o(document.body).append(this.popover),r.on("resize.clockpicker"+this.id,function(){i.isShown&&i.locate()}),this.isAppended=!0),t=((this.input.prop("value")||this.options["default"]||"")+"").split(":"),"now"===t[0]&&(t=new Date(+new Date+this.options.fromnow),t=[t.getHours(),t.getMinutes()]),this.hours=+t[0]||0,this.minutes=+t[1]||0,this.spanHours.html(e(this.hours)),this.spanMinutes.html(e(this.minutes)),"function"==typeof this.options.beforeShow&&this.options.beforeShow.apply(this),this.toggleView("hours"),this.locate(),this.isShown=!0,s.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(e){e=o(e.target),0===e.closest(i.popover).length&&0===e.closest(i.addon).length&&0===e.closest(i.input).length&&i.hide()}),s.on("keyup.clockpicker."+this.id,function(e){27===e.keyCode&&i.hide()}),"function"==typeof this.options.afterShow&&this.options.afterShow.apply(this)}},i.prototype.hide=function(){this.isShown=!1,s.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),s.off("keyup.clockpicker."+this.id),this.popover.hide()},i.prototype.toggleView=function(e,t){var i="hours"===e,n=i?this.hoursView:this.minutesView,o=i?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",i),this.spanMinutes.toggleClass("text-primary",!i),o.addClass("clockpicker-dial-out"),n.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(t),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){o.css("visibility","hidden")},g)},i.prototype.resetClock=function(e){var t=this.currentView,i=this[t],n="hours"===t,t=Math.PI/(n?6:30)*i,i=n&&i>0&&13>i?54:80,o=Math.sin(t)*i,r=-Math.cos(t)*i,s=this;a&&e?(s.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){s.canvas.removeClass("clockpicker-canvas-out"),s.setHand(o,r)},e)):this.setHand(o,r)},i.prototype.setHand=function(t,i,n,r){var s=Math.atan2(t,-i),l="hours"===this.currentView,d=Math.PI/(l||n?6:30);t=Math.sqrt(t*t+i*i),t=(i=l&&67>t)?54:80;var h;0>s&&(s=2*Math.PI+s),h=Math.round(s/d),s=h*d,l?(12===h&&(h=0),h=i?0===h?12:h:0===h?0:h+12):(n&&(h*=5),60===h&&(h=0)),this[this.currentView]!==h&&u&&this.options.vibrate&&!this.vibrateTimer&&(navigator[u](10),this.vibrateTimer=setTimeout(o.proxy(function(){this.vibrateTimer=null},this),100)),this[this.currentView]=h,this[l?"spanHours":"spanMinutes"].html(e(h)),a?(r||!l&&h%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg")),n=Math.sin(s)*t,s=-Math.cos(s)*t,this.hand.setAttribute("x2",n),this.hand.setAttribute("y2",s),this.bg.setAttribute("cx",n),this.bg.setAttribute("cy",s),this.fg.setAttribute("cx",n),this.fg.setAttribute("cy",s)):this[l?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=o(this);e.toggleClass("active",h===+e.html())})},i.prototype.done=function(){this.hide();var t=this.input.prop("value"),i=e(this.hours)+":"+e(this.minutes);this.input.prop("value",i),i!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change"))},i.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(r.off("resize.clockpicker"+this.id),this.popover.remove())},o.fn.clockpicker=function(e){var t=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=o(this),r=n.data("clockpicker");r?"function"==typeof r[e]&&r[e].apply(r,t):(r=o.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),n.data("clockpicker",new i(n,r)))})}}(),function(){function e(e,t){if(!t||"function"==typeof t)return e;for(var i in t)e[i]=t[i];return e}function t(e,t,i){var n,o=0,r=e.length,s=void 0===r||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e;if(i)if(s){for(n in e)if(!1===t.apply(e[n],i))break}else for(;r>o&&!1!==t.apply(e[o++],i););else if(s){for(n in e)if(!1===t.call(e[n],n,e[n]))break}else for(;r>o&&!1!==t.call(e[o],o,e[o++]););return e}function i(e){var t=function(e){if(window.XMLHttpRequest)return e(null,new XMLHttpRequest);if(window.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}return e(Error())},i=function(e){if("string"==typeof e)return e;var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i.join("&")},n=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var i,n=arguments[t];for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e},o=function(e,r,s,a){"function"==typeof s&&(a=s,s={}),s.cache=s.cache||!1,s.data=s.data||{},s.headers=s.headers||{},s.jsonp=s.jsonp||!1,s.async=void 0===s.async?!0:s.async;var l,d=n({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},o.headers,s.headers);if(l="application/json"===d["content-type"]?JSON.stringify(s.data):i(s.data),"GET"===e){var h=[];if(l&&(h.push(l),l=null),s.cache||h.push("_="+(new Date).getTime()),s.jsonp&&(h.push("callback="+s.jsonp),h.push("jsonp="+s.jsonp)),h=h.join("&"),1<h.length&&(r=-1<r.indexOf("?")?r+("&"+h):r+("?"+h)),s.jsonp){var h=document.getElementsByTagName("head")[0],c=document.createElement("script");return c.type="text/javascript",c.src=r,void h.appendChild(c)}}t(function(t,i){if(t)return a(t);i.open(e,r,s.async);for(var n in d)d.hasOwnProperty(n)&&i.setRequestHeader(n,d[n]);i.onreadystatechange=function(){if(4===i.readyState){var e=i.responseText||"";a&&a(i.status,{text:function(){return e},json:function(){return JSON.parse(e)}})}},i.send(l)})};({authBasic:function(e,t){var i,n=o.headers;i=e+":"+t,i=i.replace(/\r\n/g,"\n");for(var r="",s=0;s<i.length;s++){var a=i.charCodeAt(s);128>a?r+=String.fromCharCode(a):(a>127&&2048>a?r+=String.fromCharCode(a>>6|192):(r+=String.fromCharCode(a>>12|224),r+=String.fromCharCode(a>>6&63|128)),r+=String.fromCharCode(63&a|128))}i=r;var l,d,h,c,r="",p=0;do l=i.charCodeAt(p++),s=i.charCodeAt(p++),a=i.charCodeAt(p++),d=l>>2,l=(3&l)<<4|s>>4,h=(15&s)<<2|a>>6,c=63&a,isNaN(s)?h=c=64:isNaN(a)&&(c=64),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);while(p<i.length);n.Authorization="Basic "+r},connect:function(e,t,i){return o("CONNECT",e,t,i)},del:function(e,t,i){return o("DELETE",e,t,i)},get:function(e,t,i){return o("GET",e,t,i)},head:function(e,t,i){return o("HEAD",e,t,i)},headers:function(e){o.headers=e||{}},isAllowed:function(e,t,i){this.options(e,function(e,n){i(-1!==n.text().indexOf(t))})},options:function(e,t,i){return o("OPTIONS",e,t,i)},patch:function(e,t,i){return o("PATCH",e,t,i)},post:function(e,t,i){return o("POST",e,t,i)},put:function(e,t,i){return o("PUT",e,t,i)},trace:function(e,t,i){return o("TRACE",e,t,i)}})[e.type?e.type.toLowerCase():"get"](e.url,e,function(t,i){200===t?e.success(i.json(),t,null):e.error(i.text(),t,null)})}function n(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},C.extend(w,e),delete w.fixLng,"string"==typeof w.ns&&(w.ns={namespaces:[w.ns],defaultNs:w.ns}),"string"==typeof w.fallbackNS&&(w.fallbackNS=[w.fallbackNS]),("string"==typeof w.fallbackLng||"boolean"==typeof w.fallbackLng)&&(w.fallbackLng=[w.fallbackLng]),w.interpolationPrefixEscaped=C.regexEscape(w.interpolationPrefix),w.interpolationSuffixEscaped=C.regexEscape(w.interpolationSuffix),w.lng||(w.lng=C.detectLanguage()),w.lng?w.useCookie&&C.cookie.create(w.cookieName,w.lng,w.cookieExpirationTime,w.cookieDomain):(w.lng=w.fallbackLng[0],w.useCookie&&C.cookie.remove(w.cookieName)),v=C.toLanguages(w.lng),u=v[0],C.log("currentLng set to: "+u);var i=d;e.fixLng&&(i=function(e,t){return t=t||{},t.lng=t.lng||i.lng,d(e,t)},i.lng=u),P.setCurrentLng(u),f&&w.setJqueryExt&&r();var n;if(f&&f.Deferred&&(n=f.Deferred()),w.resStore)m=w.resStore,y=!0,t&&t(i),n&&n.resolve(i);else{var o=C.toLanguages(w.lng);"string"==typeof w.preload&&(w.preload=[w.preload]);for(var s=0,a=w.preload.length;a>s;s++)for(var l=C.toLanguages(w.preload[s]),h=0,c=l.length;c>h;h++)0>o.indexOf(l[h])&&o.push(l[h]);g.sync.load(o,w,function(e,o){m=o,y=!0,t&&t(i),n&&n.resolve(i)})}return n?n.promise():void 0}function o(e,t){var i={dynamicLoad:w.dynamicLoad,resGetPath:w.resGetPath,getAsync:w.getAsync,customLoad:w.customLoad,ns:{namespaces:e,defaultNs:""}},n=C.toLanguages(w.lng);"string"==typeof w.preload&&(w.preload=[w.preload]);for(var o=0,r=w.preload.length;r>o;o++)for(var s=C.toLanguages(w.preload[o]),a=0,l=s.length;l>a;a++)0>n.indexOf(s[a])&&n.push(s[a]);for(var d=[],o=0,r=n.length;r>o;o++){if(s=!1,a=m[n[o]])for(var l=0,h=e.length;h>l;l++)a[e[l]]||(s=!0);else s=!0;s&&d.push(n[o])}d.length?g.sync._fetch(d,i,function(i,n){var o=e.length*d.length;C.each(e,function(e,i){0>w.ns.namespaces.indexOf(i)&&w.ns.namespaces.push(i),C.each(d,function(e,r){m[r]=m[r]||{},m[r][i]=n[r][i],o--,0===o&&t&&(w.useLocalStorage&&g.sync._storeLocal(m),t())})})}):t&&t()}function r(){function e(e,t,i){if(0!==t.length){var n="text";if(0===t.indexOf("[")&&(n=t.split("]"),t=n[1],n=n[0].substr(1,n[0].length-1)),t.indexOf(";")===t.length-1&&(t=t.substr(0,t.length-2)),"html"===n)i=w.defaultValueFromContent?f.extend({defaultValue:e.html()},i):i,e.html(f.t(t,i));else if("text"===n)i=w.defaultValueFromContent?f.extend({defaultValue:e.text()},i):i,e.text(f.t(t,i));else if("prepend"===n)i=w.defaultValueFromContent?f.extend({defaultValue:e.html()},i):i,e.prepend(f.t(t,i));else if("append"===n)i=w.defaultValueFromContent?f.extend({defaultValue:e.html()},i):i,e.append(f.t(t,i));else if(0===n.indexOf("data-")){var o=n.substr(5);i=w.defaultValueFromContent?f.extend({defaultValue:e.data(o)},i):i,t=f.t(t,i),e.data(o,t),e.attr(n,t)}else i=w.defaultValueFromContent?f.extend({defaultValue:e.attr(n)},i):i,e.attr(n,f.t(t,i))}}function t(t,i){var n=t.attr(w.selectorAttr);if(n||"undefined"==typeof n||!1===n||(n=t.text()||t.val()),n){var o=t,r=t.data("i18n-target");r&&(o=t.find(r)||t),i||!0!==w.useDataAttrOptions||(i=t.data("i18n-options")),i=i||{},0<=n.indexOf(";")?(n=n.split(";"),f.each(n,function(t,n){""!==n&&e(o,n,i)})):e(o,n,i),!0===w.useDataAttrOptions&&t.data("i18n-options",i)}}f.t=f.t||d,f.fn.i18n=function(e){return this.each(function(){t(f(this),e),f(this).find("["+w.selectorAttr+"]").each(function(){t(f(this),e)})})}}function s(e,t,i,n){if(!e)return e;if(n=n||t,0>e.indexOf(n.interpolationPrefix||w.interpolationPrefix))return e;var o=n.interpolationPrefix?C.regexEscape(n.interpolationPrefix):w.interpolationPrefixEscaped,r=n.interpolationSuffix?C.regexEscape(n.interpolationSuffix):w.interpolationSuffixEscaped,a="HTML"+r;return C.each(t,function(t,l){var d=i?i+w.keyseparator+t:t;"object"==typeof l&&null!==l?e=s(e,l,d,n):n.escapeInterpolation||w.escapeInterpolation?(e=e.replace(new RegExp([o,d,a].join(""),"g"),l),e=e.replace(new RegExp([o,d,r].join(""),"g"),C.escape(l))):e=e.replace(new RegExp([o,d,r].join(""),"g"),l)}),e}function a(e,t){var i=C.extend({},t);for(delete i.postProcess;-1!=e.indexOf(w.reusePrefix)&&(_++,!(_>w.maxRecursion));){var n=e.lastIndexOf(w.reusePrefix),o=e.indexOf(w.reuseSuffix,n)+w.reuseSuffix.length,n=e.substring(n,o),o=n.replace(w.reusePrefix,"").replace(w.reuseSuffix,"");if(-1!=o.indexOf(",")){var r=o.indexOf(",");if(-1!=o.indexOf("{",r)&&-1!=o.indexOf("}",r)){var s=o.indexOf("{",r),a=o.indexOf("}",s)+1;try{i=C.extend(i,JSON.parse(o.substring(s,a))),o=o.substring(0,r)}catch(l){}}}o=c(o,i),e=e.replace(n,o)}return e}function l(e,t){t=t||{};var i=void 0!==t.defaultValue?t.defaultValue:e,n=p(e,t);return void 0!==n||n===i}function d(e,t){return t=t||{},y?(_=0,c.apply(null,arguments)):e||""}function h(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);return{postProcess:"sprintf",sprintf:e}}function c(e,t){if(t&&"object"!=typeof t?"sprintf"===w.shortcutFunction?t=h.apply(null,arguments):"defaultValue"===w.shortcutFunction&&(t={defaultValue:t}):t=t||{},void 0===e||null===e)return"";"string"==typeof e&&(e=[e]);var i=e[0];if(1<e.length)for(var n=0;n<e.length&&(i=e[n],!l(i,t));n++);var o,n=void 0!==t.defaultValue?t.defaultValue:i,r=p(i,t),d=t.lng?C.toLanguages(t.lng):v,c=t.ns||w.ns.defaultNs;return-1<i.indexOf(w.nsseparator)&&(o=i.split(w.nsseparator),c=o[0],i=o[1]),void 0===r&&w.sendMissing&&(t.lng?x.postMissing(d[0],c,i,n,d):x.postMissing(w.lng,c,i,n,d)),d=t.postProcess||w.postProcess,void 0!==r&&d&&A[d]&&(r=A[d](r,i,t)),o=n,-1<n.indexOf(w.nsseparator)&&(o=n.split(w.nsseparator),o=o[1]),o===i&&w.parseMissingKey&&(n=w.parseMissingKey(n)),void 0===r&&(n=s(n,t),n=a(n,t),d&&A[d]&&(r=A[d](void 0!==t.defaultValue?t.defaultValue:i,i,t))),void 0!==r?r:n}function p(e,t){t=t||{};var i,n=void 0!==t.defaultValue?t.defaultValue:e,o=v;if(!m||"cimode"===o[0].toLowerCase())return n;if(t.lng&&(o=C.toLanguages(t.lng),!m[o[0]])){var r=w.getAsync;w.getAsync=!1,g.sync.load(o,w,function(e,t){C.extend(m,t),w.getAsync=r})}var l=t.ns||w.ns.defaultNs;if(-1<e.indexOf(w.nsseparator)&&(i=e.split(w.nsseparator),l=i[0],e=i[1]),t.context&&("string"==typeof t.context||"number"==typeof t.context)&&(i=C.extend({},t),delete i.context,i.defaultValue=w.contextNotFound,i=d(l+w.nsseparator+e+"_"+t.context,i),i!=w.contextNotFound))return s(i,{context:t.context});if(void 0!==t.count&&"string"!=typeof t.count&&1!==t.count){i=C.extend({},t),delete i.count,i.defaultValue=w.pluralNotFound;var h=l+w.nsseparator+e+w.pluralSuffix,u=P.get(o[0],t.count);if(u>=0?h=h+"_"+u:1===u&&(h=l+w.nsseparator+e),i=d(h,i),i!=w.pluralNotFound)return s(i,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix})}var f;for(i=e.split(w.keyseparator),h=0,u=o.length;u>h&&void 0===f;h++){for(var _=o[h],y=0,b=m[_]&&m[_][l];i[y];)b=b&&b[i[y]],y++;if(void 0!==b){if(f=Object.prototype.toString.apply(b),"string"==typeof b)b=s(b,t),b=a(b,t);else if("[object Array]"!==f||w.returnObjectTrees||t.returnObjectTrees){if(null===b&&!0===w.fallbackOnNull)b=void 0;else if(null!==b)if(w.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==f&&"[object Function]"!==f&&"[object RegExp]"!==f){var T="[object Array]"===f?[]:{};C.each(b,function(i){T[i]=c(l+w.nsseparator+e+w.keyseparator+i,t)}),b=T}}else w.objectTreeKeyHandler&&"function"==typeof w.objectTreeKeyHandler?b=w.objectTreeKeyHandler(e,b,_,l,t):(b="key '"+l+":"+e+" ("+_+")' returned an object instead of string.",C.log(b))}else b=b.join("\n"),b=s(b,t),b=a(b,t);"string"==typeof b&&""===b.trim()&&!0===w.fallbackOnEmpty&&(b=void 0),f=b}}if(void 0===f&&!t.isFallbackLookup&&(!0===w.fallbackToDefaultNS||w.fallbackNS&&0<w.fallbackNS.length))if(t.isFallbackLookup=!0,w.fallbackNS.length)for(o=0,i=w.fallbackNS.length;i>o&&(!(f=p(w.fallbackNS[o]+w.nsseparator+e,t))||(h=-1<f.indexOf(w.nsseparator)?f.split(w.nsseparator)[1]:f,u=-1<n.indexOf(w.nsseparator)?n.split(w.nsseparator)[1]:n,h===u));o++);else f=p(e,t);return f}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if(0===i)return-1;var n=0;if(0<arguments.length&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&1/0!=n&&-(1/0)!=n&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(n=n>=0?n:Math.max(i-Math.abs(n),0);i>n;n++)if(n in t&&t[n]===e)return n;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if(0===i)return-1;var n=i;for(1<arguments.length&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),i=n>=0?Math.min(n,i-1):i-Math.abs(n);i>=0;i--)if(i in t&&t[i]===e)return i;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var u,f=this.jQuery||this.Zepto,g={},m={},_=0,v=[],y=!1;"undefined"!=typeof module&&module.exports?module.exports=g:(f&&(f.i18n=f.i18n||g),this.i18n=this.i18n||g);var w={lng:void 0,load:"all",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"locales/__lng__/__ns__.json",resPostPath:"locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",
pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,setJqueryExt:!0,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},T={create:function(e,t,i,n){if(i){var o=new Date;o.setTime(o.getTime()+6e4*i),i="; expires="+o.toGMTString()}else i="";document.cookie=e+"="+t+i+";"+(n?"domain="+n+";":"")+"path=/"},read:function(e){e+="=";for(var t=document.cookie.split(";"),i=0;i<t.length;i++){for(var n=t[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null},remove:function(e){this.create(e,"",-1)}},S={create:function(e,t,i,n){},read:function(e){return null},remove:function(e){}},C={extend:f?f.extend:e,each:f?f.each:t,ajax:f?f.ajax:"undefined"!=typeof document?i:function(){},cookie:"undefined"!=typeof document?T:S,detectLanguage:function(){var e,t=[];if("undefined"!=typeof window){for(var i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++){var o=i[n].indexOf("=");if(o>0){var r=i[n].substring(0,o),o=i[n].substring(o+1);t[r]=o}}t[w.detectLngQS]&&(e=t[w.detectLngQS])}return!e&&"undefined"!=typeof document&&w.useCookie&&(t=C.cookie.read(w.cookieName))&&(e=t),e||"undefined"==typeof navigator||(e=navigator.language?navigator.language:navigator.userLanguage),e},escape:function(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return b[e]}):e},log:function(e){w.debug&&"undefined"!=typeof console&&console.log(e)},toLanguages:function(e){var t=[];if("string"==typeof e&&-1<e.indexOf("-")){var i=e.split("-");e=w.lowerCaseLng?i[0].toLowerCase()+"-"+i[1].toLowerCase():i[0].toLowerCase()+"-"+i[1].toUpperCase(),"unspecific"!==w.load&&t.push(e),"current"!==w.load&&t.push(i[0])}else t.push(e);for(e=0;e<w.fallbackLng.length;e++)-1===t.indexOf(w.fallbackLng[e])&&w.fallbackLng[e]&&t.push(w.fallbackLng[e]);return t},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};C.applyReplacement=s;var x={load:function(e,t,i){t.useLocalStorage?x._loadLocal(e,t,function(n,o){for(var r=[],s=0,a=e.length;a>s;s++)o[e[s]]||r.push(e[s]);0<r.length?x._fetch(r,t,function(e,t){C.extend(o,t),x._storeLocal(t),i(null,o)}):i(null,o)}):x._fetch(e,t,function(e,t){i(null,t)})},_loadLocal:function(e,t,i){var n={},o=(new Date).getTime();if(window.localStorage){var r=e.length;C.each(e,function(e,s){var a=window.localStorage.getItem("res_"+s);a&&(a=JSON.parse(a),a.i18nStamp&&a.i18nStamp+t.localStorageExpirationTime>o&&(n[s]=a)),r--,0===r&&i(null,n)})}},_storeLocal:function(e){if(window.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,i){var n=t.ns,o={};if(t.dynamicLoad){var r=function(e,t){i(null,t)};if("function"==typeof t.customLoad)t.customLoad(e,n.namespaces,t,r);else{var a=s(t.resGetPath,{lng:e.join("+"),ns:n.namespaces.join("+")});C.ajax({url:a,success:function(e,t,n){C.log("loaded: "+a),i(null,e)},error:function(e,t,n){C.log("failed loading: "+a),i(null,void 0)},dataType:"json",async:t.getAsync})}}else{var l,d=n.namespaces.length*e.length;C.each(n.namespaces,function(n,r){C.each(e,function(e,n){var s=function(e,t){e&&(l=l||[],l.push(e)),o[n]=o[n]||{},o[n][r]=t,d--,0===d&&i(l,o)};"function"==typeof t.customLoad?t.customLoad(n,r,t,s):x._fetchOne(n,r,t,s)})})}},_fetchOne:function(e,t,i,n){var o=s(i.resGetPath,{lng:e,ns:t});C.ajax({url:o,success:function(e,t,i){C.log("loaded: "+o),n(null,e)},error:function(e,t,i){t&&200==t||e&&e.status&&200==e.status?C.log("There is a typo in: "+o):t&&404==t||e&&e.status&&404==e.status?C.log("Does not exist: "+o):C.log((t?t:e&&e.status?e.status:null)+" when loading "+o),n(i,{})},dataType:"json",async:i.getAsync})},postMissing:function(e,t,i,n,o){var r={};r[i]=n;var a=[];if("fallback"===w.sendMissingTo&&!1!==w.fallbackLng[0])for(e=0;e<w.fallbackLng.length;e++)a.push({lng:w.fallbackLng[e],url:s(w.resPostPath,{lng:w.fallbackLng[e],ns:t})});else if("current"===w.sendMissingTo||"fallback"===w.sendMissingTo&&!1===w.fallbackLng[0])a.push({lng:e,url:s(w.resPostPath,{lng:e,ns:t})});else if("all"===w.sendMissingTo){e=0;for(var l=o.length;l>e;e++)a.push({lng:o[e],url:s(w.resPostPath,{lng:o[e],ns:t})})}for(o=0,e=a.length;e>o;o++){var d=a[o];C.ajax({url:d.url,type:w.sendType,data:r,success:function(e,o,r){for(C.log("posted missing key '"+i+"' to: "+d.url),e=i.split("."),o=0,r=m[d.lng][t];e[o];)r=o===e.length-1?r[e[o]]=n:r[e[o]]=r[e[o]]||{},o++},error:function(e,t,n){C.log("failed posting missing key '"+i+"' to: "+d.url)},dataType:"json",async:w.postAsync})}}},P={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(e){return Number(e>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ak:{name:"Akan",numbers:[1,2],plurals:function(e){return Number(e>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(e){return Number(e>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ay:{name:"Aymará",numbers:[1],plurals:function(e){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(e){return Number(1!=e)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bo:{name:"Tibetan",numbers:[1],plurals:function(e){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(e){return Number(e>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},cgg:{name:"Chiga",numbers:[1],plurals:function(e){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},de:{name:"German",numbers:[1,2],plurals:function(e){return Number(1!=e)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(e){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(e){return Number(1!=e)}},en:{name:"English",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es:{name:"Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},et:{name:"Estonian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eu:{name:"Basque",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fa:{name:"Persian",numbers:[1],plurals:function(e){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(e){return Number(e>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fr:{name:"French",numbers:[1,2],plurals:function(e){return Number(e>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gun:{name:"Gun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(e){return Number(1!=e)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(e){return Number(1!=e)}},id:{name:"Indonesian",numbers:[1],plurals:function(e){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(e){return Number(1!=e%10||11==e%100)}},it:{name:"Italian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ja:{name:"Japanese",numbers:[1],plurals:function(e){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(e){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(e){return Number(0!==e)}},ka:{name:"Georgian",numbers:[1],plurals:function(e){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(e){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(e){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ko:{name:"Korean",numbers:[1],plurals:function(e){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(e){return Number(1==e?0:2==e?1:3==e?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(e){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(e){return Number(e>1)}},lo:{name:"Lao",numbers:[1],plurals:function(e){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(e){return Number(1==e%10&&11!=e%100?0:0!==e?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(e){return Number(e>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(e){return Number(e>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(e){return Number(e>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(e){return Number(1==e||1==e%10?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(e){return Number(1==e?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ms:{name:"Malay",numbers:[1],plurals:function(e){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(e){return Number(1!=e)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(e){return Number(1!=e)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(e){return Number(e>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(e){return Number(1!=e)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(e){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(e){return Number(1!=e)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(e){return Number(1!=e)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(e){return Number(1==e%100?1:2==e%100?2:3==e%100||4==e%100?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},son:{name:"Songhay",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(e){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(e){return Number(1!=e)}},te:{name:"Telugu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(e){return Number(e>1)}},th:{name:"Thai",numbers:[1],plurals:function(e){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(e){return Number(e>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(e){return Number(e>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(e){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(e){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(e){return Number(1==e%10&&11!=e%100?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(e){return Number(e>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(e){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(e){return Number(e>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(e){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(e){return Number(1!=e)}},zh:{name:"Chinese",numbers:[1],plurals:function(e){return 0}}},addRule:function(e,t){P.rules[e]=t},setCurrentLng:function(e){if(!P.currentRule||P.currentRule.lng!==e){var t=e.split("-");P.currentRule={lng:e,rule:P.rules[t[0]]}}},get:function(e,t){var i=e.split("-");if(i=P.currentRule&&P.currentRule.lng===e?P.currentRule.rule:P.rules[i[0]]){var n=i.plurals(t),n=i.numbers[n];2===i.numbers.length&&1===i.numbers[0]&&(2===n?n=-1:1===n&&(n=1)),i=n}else i=1===t?"1":"-1";return i}},A={},T=function(e,t){A[e]=t},L=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var t=function(){return t.cache.hasOwnProperty(arguments[0])||(t.cache[arguments[0]]=t.parse(arguments[0])),t.format.call(null,t.cache[arguments[0]],arguments)};return t.format=function(t,i){var n,o,r,s,a=1,l=t.length,d="",h=[];for(n=0;l>n;n++)if(d=e(t[n]),"string"===d)h.push(t[n]);else if("array"===d){if(r=t[n],r[2])for(d=i[a],o=0;o<r[2].length;o++){if(!d.hasOwnProperty(r[2][o]))throw L('[sprintf] property "%s" does not exist',r[2][o]);d=d[r[2][o]]}else d=r[1]?i[r[1]]:i[a++];if(/[^s]/.test(r[8])&&"number"!=e(d))throw L("[sprintf] expecting number but found %s",e(d));switch(r[8]){case"b":d=d.toString(2);break;case"c":d=String.fromCharCode(d);break;case"d":d=parseInt(d,10);break;case"e":d=r[7]?d.toExponential(r[7]):d.toExponential();break;case"f":d=r[7]?parseFloat(d).toFixed(r[7]):parseFloat(d);break;case"o":d=d.toString(8);break;case"s":d=(d=String(d))&&r[7]?d.substring(0,r[7]):d;break;case"u":d=Math.abs(d);break;case"x":d=d.toString(16);break;case"X":d=d.toString(16).toUpperCase()}if(d=/[def]/.test(r[8])&&r[3]&&d>=0?"+"+d:d,o=r[4]?"0"==r[4]?"0":r[4].charAt(1):" ",s=r[6]-String(d).length,r[6]){for(var c=[];s>0;c[--s]=o);o=c.join("")}else o="";h.push(r[5]?d+o:o+d)}return h.join("")},t.cache={},t.parse=function(e){for(var t=[],i=[],n=0;e;){if(null!==(t=/^[^\x25]+/.exec(e)))i.push(t[0]);else if(null!==(t=/^\x25{2}/.exec(e)))i.push("%");else{if(null===(t=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(e)))throw"[sprintf] huh?";if(t[2]){var n=1|n,o=[],r=t[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(r)))throw"[sprintf] huh?";for(o.push(s[1]);""!==(r=r.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(r)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(r)))throw"[sprintf] huh?";o.push(s[1])}t[2]=o}else n|=2;if(3===n)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(t)}e=e.substring(t[0].length)}return i},t}();T("sprintf",function(e,t,i){return i.sprintf?"[object Array]"===Object.prototype.toString.apply(i.sprintf)?(t=i.sprintf,t.unshift(e),L.apply(null,t)):"object"==typeof i.sprintf?L(e,i.sprintf):e:e}),g.init=n,g.setLng=function(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),t.lng=e,n(t,i)},g.preload=function(e,t){"string"==typeof e&&(e=[e]);for(var i=0,o=e.length;o>i;i++)0>w.preload.indexOf(e[i])&&w.preload.push(e[i]);return n(t)},g.addResourceBundle=function(e,t,i){"string"!=typeof t?(i=t,t=w.ns.defaultNs):0>w.ns.namespaces.indexOf(t)&&w.ns.namespaces.push(t),m[e]=m[e]||{},m[e][t]=m[e][t]||{},C.extend(m[e][t],i)},g.removeResourceBundle=function(e,t){"string"!=typeof t&&(t=w.ns.defaultNs),m[e]=m[e]||{},m[e][t]={}},g.loadNamespace=function(e,t){o([e],t)},g.loadNamespaces=o,g.setDefaultNamespace=function(e){w.ns.defaultNs=e},g.t=d,g.translate=d,g.exists=l,g.detectLanguage=C.detectLanguage,g.pluralExtensions=P,g.sync=x,g.functions=C,g.lng=function(){return u},g.addPostProcessor=T,g.options=w}(),function(e,t){function i(e){return!!(""===e||e&&e.charCodeAt&&e.substr)}function n(e){return c?c(e):"[object Array]"===p.call(e)}function o(e){return e&&"[object Object]"===p.call(e)}function r(e,t){var i;e=e||{},t=t||{};for(i in t)t.hasOwnProperty(i)&&null==e[i]&&(e[i]=t[i]);return e}function s(e,t,i){var n,o,r=[];if(!e)return r;if(h&&e.map===h)return e.map(t,i);for(n=0,o=e.length;o>n;n++)r[n]=t.call(i,e[n],n,e);return r}function a(e,t){return e=Math.round(Math.abs(e)),isNaN(e)?t:e}function l(e){var t=d.settings.currency.format;return"function"==typeof e&&(e=e()),i(e)&&e.match("%v")?{pos:e,neg:e.replace("-","").replace("%v","-%v"),zero:e}:e&&e.pos&&e.pos.match("%v")?e:i(t)?d.settings.currency.format={pos:t,neg:t.replace("%v","-%v"),zero:t}:t}var d={version:"0.4.1",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},h=Array.prototype.map,c=Array.isArray,p=Object.prototype.toString,u=d.unformat=d.parse=function(e,t){if(n(e))return s(e,function(e){return u(e,t)});if(e=e||0,"number"==typeof e)return e;t=t||d.settings.number.decimal;var i=new RegExp("[^0-9-"+t+"]",["g"]),i=parseFloat((""+e).replace(/\((.*)\)/,"-$1").replace(i,"").replace(t,"."));return isNaN(i)?0:i},f=d.toFixed=function(e,t){t=a(t,d.settings.number.precision);var i=Math.pow(10,t);return(Math.round(d.unformat(e)*i)/i).toFixed(t)},g=d.formatNumber=d.format=function(e,t,i,l){if(n(e))return s(e,function(e){return g(e,t,i,l)});e=u(e);var h=r(o(t)?t:{precision:t,thousand:i,decimal:l},d.settings.number),c=a(h.precision),p=0>e?"-":"",m=parseInt(f(Math.abs(e||0),c),10)+"",_=3<m.length?m.length%3:0;return p+(_?m.substr(0,_)+h.thousand:"")+m.substr(_).replace(/(\d{3})(?=\d)/g,"$1"+h.thousand)+(c?h.decimal+f(Math.abs(e),c).split(".")[1]:"")},m=d.formatMoney=function(e,t,i,h,c,p){if(n(e))return s(e,function(e){return m(e,t,i,h,c,p)});e=u(e);var f=r(o(t)?t:{symbol:t,precision:i,thousand:h,decimal:c,format:p},d.settings.currency),_=l(f.format);return(e>0?_.pos:0>e?_.neg:_.zero).replace("%s",f.symbol).replace("%v",g(Math.abs(e),a(f.precision),f.thousand,f.decimal))};d.formatColumn=function(e,t,h,c,p,f){if(!e)return[];var m=r(o(t)?t:{symbol:t,precision:h,thousand:c,decimal:p,format:f},d.settings.currency),_=l(m.format),v=_.pos.indexOf("%s")<_.pos.indexOf("%v")?!0:!1,y=0;return e=s(e,function(e,t){if(n(e))return d.formatColumn(e,m);e=u(e);var i=(e>0?_.pos:0>e?_.neg:_.zero).replace("%s",m.symbol).replace("%v",g(Math.abs(e),a(m.precision),m.thousand,m.decimal));return i.length>y&&(y=i.length),i}),s(e,function(e,t){return i(e)&&e.length<y?v?e.replace(m.symbol,m.symbol+Array(y-e.length+1).join(" ")):Array(y-e.length+1).join(" ")+e:e})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.accounting=d):"function"==typeof define&&define.amd?define([],function(){return d}):(d.noConflict=function(i){return function(){return e.accounting=i,d.noConflict=t,d}}(e.accounting),e.accounting=d)}(this),function(e,t){function i(t){return!e(t).parents().andSelf().filter(function(){return"hidden"===e.curCSS(this,"visibility")||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,i){return"number"==typeof t?this.each(function(){var n=this;setTimeout(function(){e(n).focus(),i&&i.call(n)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length){i=e(this[0]);for(var n;i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(n=parseInt(i.css("zIndex"),10),!isNaN(n)&&0!==n))return n;i=i.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.each(["Width","Height"],function(i,n){function o(t,i,n,o){return e.each(r,function(){i-=parseFloat(e.curCSS(t,"padding"+this,!0))||0,n&&(i-=parseFloat(e.curCSS(t,"border"+this+"Width",!0))||0),o&&(i-=parseFloat(e.curCSS(t,"margin"+this,!0))||0)}),i}var r="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(s,o(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(s,o(this,t,!0,i)+"px")})}}),e.extend(e.expr[":"],{data:function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){var n=t.nodeName.toLowerCase(),o=e.attr(t,"tabindex");return"area"===n?(n=t.parentNode,o=n.name,t.href&&o&&"map"===n.nodeName.toLowerCase()?(t=e("img[usemap=#"+o+"]")[0],!!t&&i(t)):!1):(/input|select|textarea|button|object/.test(n)?!t.disabled:"a"==n?t.href||!isNaN(o):!isNaN(o))&&i(t)},tabbable:function(t){var i=e.attr(t,"tabindex");return(isNaN(i)||i>=0)&&e(t).is(":focusable")}}),e(function(){var t=document.body,i=t.appendChild(i=document.createElement("div"));e.extend(i.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=100===i.offsetHeight,e.support.selectstart="onselectstart"in i,t.removeChild(i).style.display="none"}),e.extend(e.ui,{plugin:{add:function(t,i,n){t=e.ui[t].prototype;for(var o in n)t.plugins[o]=t.plugins[o]||[],t.plugins[o].push([i,n[o]])},call:function(e,t,i){if((t=e.plugins[t])&&e.element[0].parentNode)for(var n=0;n<t.length;n++)e.options[t[n][0]]&&t[n][1].apply(e.element,i)}},contains:function(e,t){return document.compareDocumentPosition?16&e.compareDocumentPosition(t):e!==t&&e.contains(t)},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;i=i&&"left"===i?"scrollLeft":"scrollTop";var n=!1;return 0<t[i]?!0:(t[i]=1,n=0<t[i],t[i]=0,n)},isOverAxis:function(e,t,i){return e>t&&t+i>e},isOver:function(t,i,n,o,r,s){return e.ui.isOverAxis(t,n,r)&&e.ui.isOverAxis(i,o,s)}}))}(jQuery),function(e,t){if(e.cleanData){var i=e.cleanData;e.cleanData=function(t){for(var n,o=0;null!=(n=t[o]);o++)e(n).triggerHandler("remove");i(t)}}else{var n=e.fn.remove;e.fn.remove=function(t,i){return this.each(function(){return i||t&&!e.filter(t,[this]).length||e("*",this).add([this]).each(function(){e(this).triggerHandler("remove")}),n.call(e(this),t,i)})}}e.widget=function(t,i,n){var o,r=t.split(".")[0];t=t.split(".")[1],o=r+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o]=function(i){return!!e.data(i,t)},e[r]=e[r]||{},e[r][t]=function(e,t){arguments.length&&this._createWidget(e,t)},i=new i,i.options=e.extend(!0,{},i.options),e[r][t].prototype=e.extend(!0,i,{namespace:r,widgetName:t,widgetEventPrefix:e[r][t].prototype.widgetEventPrefix||t,widgetBaseClass:o},n),e.widget.bridge(t,e[r][t])},e.widget.bridge=function(i,n){e.fn[i]=function(o){var r="string"==typeof o,s=Array.prototype.slice.call(arguments,1),a=this;return o=!r&&s.length?e.extend.apply(null,[!0,o].concat(s)):o,r&&"_"===o.charAt(0)?a:(r?this.each(function(){var n=e.data(this,i),r=n&&e.isFunction(n[o])?n[o].apply(n,s):n;return r!==n&&r!==t?(a=r,!1):void 0}):this.each(function(){var t=e.data(this,i);t?t.option(o||{})._init():e.data(this,i,new n(o,this))}),a)}},e.Widget=function(e,t){arguments.length&&this._createWidget(e,t)},e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(t,i){e.data(i,this.widgetName,this),this.element=e(i),this.options=e.extend(!0,{},this.options,this._getCreateOptions(),t);var n=this;this.element.bind("remove."+this.widgetName,function(){n.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(i,n){var o=i;if(0===arguments.length)return e.extend({},this.options);if("string"==typeof i){if(n===t)return this.options[i];o={},o[i]=n}return this._setOptions(o),this},_setOptions:function(t){var i=this;return e.each(t,function(e,t){i._setOption(e,t)}),this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&this.widget()[t?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",t),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(t,i,n){var o=this.options[t];if(i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n=n||{},i.originalEvent){t=e.event.props.length;for(var r;t;)r=e.event.props[--t],i[r]=i.originalEvent[r]}return this.element.trigger(i,n),!(e.isFunction(o)&&!1===o.call(this.element[0],i,n)||i.isDefaultPrevented())}}}(jQuery),function(e){e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(t){if(t.originalEvent=t.originalEvent||{},!t.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,n=1==t.which,o="string"==typeof this.options.cancel?e(t.target).parents().add(t.target).filter(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),t.originalEvent.mouseHandled=!0)):!0}},_mouseMove:function(t){return!e.browser.msie||9<=document.documentMode||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t))?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target==this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){e.ui=e.ui||{};var t=/left|center|right/,i=/top|center|bottom/,n=e.fn.position,o=e.fn.offset;e.fn.position=function(o){if(!o||!o.of)return n.apply(this,arguments);o=e.extend({},o);var r,s,a,l=e(o.of),d=l[0],h=(o.collision||"flip").split(" "),c=o.offset?o.offset.split(" "):[0,0];return 9===d.nodeType?(r=l.width(),s=l.height(),a={top:0,left:0}):d.setTimeout?(r=l.width(),s=l.height(),a={top:l.scrollTop(),left:l.scrollLeft()}):d.preventDefault?(o.at="left top",r=s=0,a={top:o.of.pageY,left:o.of.pageX}):(r=l.outerWidth(),s=l.outerHeight(),a=l.offset()),
e.each(["my","at"],function(){var e=(o[this]||"").split(" ");1===e.length&&(e=t.test(e[0])?e.concat(["center"]):i.test(e[0])?["center"].concat(e):["center","center"]),e[0]=t.test(e[0])?e[0]:"center",e[1]=i.test(e[1])?e[1]:"center",o[this]=e}),1===h.length&&(h[1]=h[0]),c[0]=parseInt(c[0],10)||0,1===c.length&&(c[1]=c[0]),c[1]=parseInt(c[1],10)||0,"right"===o.at[0]?a.left+=r:"center"===o.at[0]&&(a.left+=r/2),"bottom"===o.at[1]?a.top+=s:"center"===o.at[1]&&(a.top+=s/2),a.left+=c[0],a.top+=c[1],this.each(function(){var t,i=e(this),n=i.outerWidth(),l=i.outerHeight(),d=parseInt(e.curCSS(this,"marginLeft",!0))||0,p=parseInt(e.curCSS(this,"marginTop",!0))||0,u=n+d+(parseInt(e.curCSS(this,"marginRight",!0))||0),f=l+p+(parseInt(e.curCSS(this,"marginBottom",!0))||0),g=e.extend({},a);"right"===o.my[0]?g.left-=n:"center"===o.my[0]&&(g.left-=n/2),"bottom"===o.my[1]?g.top-=l:"center"===o.my[1]&&(g.top-=l/2),g.left=Math.round(g.left),g.top=Math.round(g.top),t={left:g.left-d,top:g.top-p},e.each(["left","top"],function(i,a){e.ui.position[h[i]]&&e.ui.position[h[i]][a](g,{targetWidth:r,targetHeight:s,elemWidth:n,elemHeight:l,collisionPosition:t,collisionWidth:u,collisionHeight:f,offset:c,my:o.my,at:o.at})}),e.fn.bgiframe&&i.bgiframe(),i.offset(e.extend(g,{using:o.using}))})},e.ui.position={fit:{left:function(t,i){var n=e(window),n=i.collisionPosition.left+i.collisionWidth-n.width()-n.scrollLeft();t.left=n>0?t.left-n:Math.max(t.left-i.collisionPosition.left,t.left)},top:function(t,i){var n=e(window),n=i.collisionPosition.top+i.collisionHeight-n.height()-n.scrollTop();t.top=n>0?t.top-n:Math.max(t.top-i.collisionPosition.top,t.top)}},flip:{left:function(t,i){if("center"!==i.at[0]){var n=e(window),n=i.collisionPosition.left+i.collisionWidth-n.width()-n.scrollLeft(),o="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,r="left"===i.at[0]?i.targetWidth:-i.targetWidth,s=-2*i.offset[0];t.left+=0>i.collisionPosition.left?o+r+s:n>0?o+r+s:0}},top:function(t,i){if("center"!==i.at[1]){var n=e(window),n=i.collisionPosition.top+i.collisionHeight-n.height()-n.scrollTop(),o="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,r="top"===i.at[1]?i.targetHeight:-i.targetHeight,s=-2*i.offset[1];t.top+=0>i.collisionPosition.top?o+r+s:n>0?o+r+s:0}}}},e.offset.setOffset||(e.offset.setOffset=function(t,i){/static/.test(e.curCSS(t,"position"))&&(t.style.position="relative");var n=e(t),o=n.offset(),r=parseInt(e.curCSS(t,"top",!0),10)||0,s=parseInt(e.curCSS(t,"left",!0),10)||0,o={top:i.top-o.top+r,left:i.left-o.left+s};"using"in i?i.using.call(t,o):n.css(o)},e.fn.offset=function(t){var i=this[0];return i&&i.ownerDocument?t?this.each(function(){e.offset.setOffset(this,t)}):o.call(this):null})}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){return this.element.data("draggable")?(this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this):void 0},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t))?!0:!1},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),i.containment&&this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(t,!0),!0)},_mouseDrag:function(t,i){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){if(i=this._uiHash(),!1===this._trigger("drag",t,i))return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=!1;if(e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),!(this.element[0]&&this.element[0].parentNode||"original"!=this.options.helper))return!1;if("invalid"==this.options.revert&&!i||"valid"==this.options.revert&&i||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)){var n=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==n._trigger("stop",t)&&n._clear()})}else!1!==this._trigger("stop",t)&&this._clear();return!1},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var i=this.options.handle&&e(this.options.handle,this.element).length?!1:!0;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(i=!0)}),i},_createHelper:function(t){var i=this.options;return t=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"==i.helper?this.element.clone():this.element,t.parents("body").length||t.appendTo("parent"==i.appendTo?this.element[0].parentNode:i.appendTo),t[0]!=this.element[0]&&!/(fixed|absolute)/.test(t.css("position"))&&t.css("position","absolute"),t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.browser.msie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=[("document"==t.containment?0:e(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,("document"==t.containment?0:e(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(t.containment)||t.containment.constructor==Array)t.containment.constructor==Array&&(this.containment=t.containment);else{var i=e(t.containment)[0];if(i){var t=e(t.containment).offset(),n="hidden"!=e(i).css("overflow");this.containment=[t.left+(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0),t.top+(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0),t.left+(n?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,t.top+(n?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}}},_convertPositionTo:function(t,i){i||(i=this.position),t="absolute"==t?1:-1;var n="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*t+this.offset.parent.top*t-(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*t),left:i.left+this.offset.relative.left*t+this.offset.parent.left*t-(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*t)}},_generatePosition:function(t){var i=this.options,n="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName),r=t.pageX,s=t.pageY;return this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),i.grid&&(s=this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1],s=this.containment&&(s-this.offset.click.top<this.containment[1]||s-this.offset.click.top>this.containment[3])?s-this.offset.click.top<this.containment[1]?s+i.grid[1]:s-i.grid[1]:s,r=this.originalPageX+Math.round((r-this.originalPageX)/i.grid[0])*i.grid[0],r=this.containment&&(r-this.offset.click.left<this.containment[0]||r-this.offset.click.left>this.containment[2])?r-this.offset.click.left<this.containment[0]?r+i.grid[0]:r-i.grid[0]:r)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.extend(e.ui.draggable,{version:"1.8.11"}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var n=e(this).data("draggable"),o=n.options,r=e.extend({},i,{item:n.element});n.sortables=[],e(o.connectToSortable).each(function(){var i=e.data(this,"sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,r))})},stop:function(t,i){var n=e(this).data("draggable"),o=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,i){var n=e(this).data("draggable"),o=this;e.each(n.sortables,function(){this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","iframeFix",{start:function(){var t=e(this).data("draggable").options;e(!0===t.iframeFix?"iframe":t.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")})},stop:function(){e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){t=e(i.helper),i=e(this).data("draggable").options,t.css("opacity")&&(i._opacity=t.css("opacity")),t.css("opacity",i.opacity)},stop:function(t,i){t=e(this).data("draggable").options,t._opacity&&e(i.helper).css("opacity",t._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("draggable"),n=i.options,o=!1;i.scrollParent[0]!=document&&"HTML"!=i.scrollParent[0].tagName?(n.axis&&"x"==n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"==n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"==n.axis||(t.pageY-e(document).scrollTop()<n.scrollSensitivity?o=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(o=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"==n.axis||(t.pageX-e(document).scrollLeft()<n.scrollSensitivity?o=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(o=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var i=e(this),n=i.offset();this!=t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(t,i){for(var n=e(this).data("draggable"),o=n.options,r=o.snapTolerance,s=i.offset.left,a=s+n.helperProportions.width,l=i.offset.top,d=l+n.helperProportions.height,h=n.snapElements.length-1;h>=0;h--){var c=n.snapElements[h].left,p=c+n.snapElements[h].width,u=n.snapElements[h].top,f=u+n.snapElements[h].height;if(s>c-r&&p+r>s&&l>u-r&&f+r>l||s>c-r&&p+r>s&&d>u-r&&f+r>d||a>c-r&&p+r>a&&l>u-r&&f+r>l||a>c-r&&p+r>a&&d>u-r&&f+r>d){if("inner"!=o.snapMode){var g=Math.abs(u-d)<=r,m=Math.abs(f-l)<=r,_=Math.abs(c-a)<=r,v=Math.abs(p-s)<=r;g&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top-n.margins.top),m&&(i.position.top=n._convertPositionTo("relative",{top:f,left:0}).top-n.margins.top),_&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left-n.margins.left),v&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p}).left-n.margins.left)}var y=g||m||_||v;"outer"!=o.snapMode&&(g=Math.abs(u-l)<=r,m=Math.abs(f-d)<=r,_=Math.abs(c-s)<=r,v=Math.abs(p-a)<=r,g&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top-n.margins.top),m&&(i.position.top=n._convertPositionTo("relative",{top:f-n.helperProportions.height,left:0}).top-n.margins.top),_&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c}).left-n.margins.left),v&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[h].snapping&&(g||m||_||v||y)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=g||m||_||v||y}else n.snapElements[h].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=!1}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t=e(this).data("draggable").options,t=e.makeArray(e(t.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});if(t.length){var i=parseInt(t[0].style.zIndex)||0;e(t).each(function(e){this.style.zIndex=i+e}),this[0].style.zIndex=i+t.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){t=e(i.helper),i=e(this).data("draggable").options,t.css("zIndex")&&(i._zIndex=t.css("zIndex")),t.css("zIndex",i.zIndex)},stop:function(t,i){t=e(this).data("draggable").options,t._zIndex&&e(i.helper).css("zIndex",t._zIndex)}})}(jQuery),function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,i=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=i.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var n=this.handles.split(",");this.handles={};for(var o=0;o<n.length;o++){var r=e.trim(n[o]),s=e('<div class="ui-resizable-handle ui-resizable-'+r+'"></div>');/sw|se|ne|nw/.test(r)&&s.css({zIndex:++i.zIndex}),"se"==r&&s.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(s)}}this._renderAxis=function(t){t=t||this.element;for(var i in this.handles){if(this.handles[i].constructor==String&&(this.handles[i]=e(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var n=e(this.handles[i],this.element),o=0,o=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");t.css(n,o),this._proportionallyResize()}e(this.handles[i])}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),i.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").hover(function(){e(this).removeClass("ui-resizable-autohide"),t._handles.show()},function(){t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var i=this.element;i.after(this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var i,n=!1;for(i in this.handles)e(this.handles[i])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(i){var n=this.options,o=this.element.position(),r=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(r.is(".ui-draggable")||/absolute/.test(r.css("position")))&&r.css({position:"absolute",top:o.top,left:o.left}),e.browser.opera&&/relative/.test(r.css("position"))&&r.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy();var o=t(this.helper.css("left")),s=t(this.helper.css("top"));return n.containment&&(o+=e(n.containment).scrollLeft()||0,s+=e(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:s},this.size=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalPosition={left:o,top:s},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"==n?this.axis+"-resize":n),r.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var t=this.helper,i=this.originalMousePosition,n=this._change[this.axis];return n?(i=n.apply(this,[e,e.pageX-i.left||0,e.pageY-i.top||0]),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(i),this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i=this.options;if(this._helper){var n=this._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),n=o&&e.ui.hasScroll(n[0],"left")?0:this.sizeDiff.height,o=o?0:this.sizeDiff.width,o={width:this.helper.width()-o,height:this.helper.height()-n},n=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,r=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;i.animate||this.element.css(e.extend(o,{top:r,left:n})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!i.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return e.height?e.width=i.height*this.aspectRatio:e.width&&(e.height=i.width/this.aspectRatio),"sw"==n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"==n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this.options,n=this.axis,o=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=i(e.width)&&t.minWidth&&t.minWidth>e.width,a=i(e.height)&&t.minHeight&&t.minHeight>e.height;s&&(e.width=t.minWidth),a&&(e.height=t.minHeight),o&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight);var l=this.originalPosition.left+this.originalSize.width,d=this.position.top+this.size.height,h=/sw|nw|w/.test(n),n=/nw|ne|n/.test(n);return s&&h&&(e.left=l-t.minWidth),o&&h&&(e.left=l-t.maxWidth),a&&n&&(e.top=d-t.minHeight),r&&n&&(e.top=d-t.maxHeight),(t=!e.width&&!e.height)&&!e.left&&e.top?e.top=null:t&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t=this.helper||this.element,i=0;i<this._proportionallyResizeElements.length;i++){var n=this._proportionallyResizeElements[i];if(!this.borderDif){var o=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],r=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")];this.borderDif=e.map(o,function(e,t){return e=parseInt(e,10)||0,t=parseInt(r[t],10)||0,e+t})}e.browser.msie&&(e(t).is(":hidden")||e(t).parents(":hidden").length)||n.css({height:t.height()-this.borderDif[0]-this.borderDif[2]||0,width:t.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.options;if(this.elementOffset=this.element.offset(),this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var i=e.browser.msie&&7>e.browser.version,n=i?1:0,i=i?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+i,height:this.element.outerHeight()+i,position:"absolute",left:this.elementOffset.left-n+"px",top:this.elementOffset.top-n+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){return{left:this.originalPosition.left+t,width:this.originalSize.width-t}},n:function(e,t,i){return{top:this.originalPosition.top+i,height:this.originalSize.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!=t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.extend(e.ui.resizable,{version:"1.8.11"}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("resizable").options,i=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10),position:t.css("position")})})};"object"!=typeof t.alsoResize||t.alsoResize.parentNode?i(t.alsoResize):t.alsoResize.length?(t.alsoResize=t.alsoResize[0],i(t.alsoResize)):e.each(t.alsoResize,function(e){i(e)})},resize:function(t,i){var n=e(this).data("resizable");t=n.options;var o=n.originalSize,r=n.originalPosition,s={height:n.size.height-o.height||0,width:n.size.width-o.width||0,top:n.position.top-r.top||0,left:n.position.left-r.left||0},a=function(t,o){e(t).each(function(){
var t=e(this),r=e(this).data("resizable-alsoresize"),a={},l=o&&o.length?o:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(l,function(e,t){(e=(r[t]||0)+(s[t]||0))&&e>=0&&(a[t]=e||null)}),e.browser.opera&&/relative/.test(t.css("position"))&&(n._revertToRelativePosition=!0,t.css({position:"absolute",top:"auto",left:"auto"})),t.css(a)})};"object"!=typeof t.alsoResize||t.alsoResize.nodeType?a(t.alsoResize):e.each(t.alsoResize,function(e,t){a(e,t)})},stop:function(){var t=e(this).data("resizable"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.css({position:t.data("resizable-alsoresize").position})})};t._revertToRelativePosition&&(t._revertToRelativePosition=!1,"object"!=typeof i.alsoResize||i.alsoResize.nodeType?n(i.alsoResize):e.each(i.alsoResize,function(e){n(e)})),e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("resizable"),n=i.options,o=i._proportionallyResizeElements,r=o.length&&/textarea/i.test(o[0].nodeName),s=r&&e.ui.hasScroll(o[0],"left")?0:i.sizeDiff.height,r={width:i.size.width-(r?0:i.sizeDiff.width),height:i.size.height-s},s=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,a=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(r,a&&s?{top:a,left:s}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i=e(this).data("resizable"),n=i.element,o=i.options.containment;if(n=o instanceof e?o.get(0):/parent/.test(o)?n.parent().get(0):o)if(i.containerElement=e(n),/document/.test(o)||o==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var r=e(n),s=[];e(["Top","Right","Left","Bottom"]).each(function(e,i){s[e]=t(r.css("padding"+i))}),i.containerOffset=r.offset(),i.containerPosition=r.position(),i.containerSize={height:r.innerHeight()-s[3],width:r.innerWidth()-s[1]};var o=i.containerOffset,a=i.containerSize.height,l=i.containerSize.width,l=e.ui.hasScroll(n,"left")?n.scrollWidth:l,a=e.ui.hasScroll(n)?n.scrollHeight:a;i.parentData={element:n,left:o.left,top:o.top,width:l,height:a}}},resize:function(t){var i=e(this).data("resizable"),n=i.options,o=i.containerOffset,r=i.position;t=i._aspectRatio||t.shiftKey;var s={top:0,left:0},a=i.containerElement;a[0]!=document&&/static/.test(a.css("position"))&&(s=o),r.left<(i._helper?o.left:0)&&(i.size.width+=i._helper?i.position.left-o.left:i.position.left-s.left,t&&(i.size.height=i.size.width/n.aspectRatio),i.position.left=n.helper?o.left:0),r.top<(i._helper?o.top:0)&&(i.size.height+=i._helper?i.position.top-o.top:i.position.top,t&&(i.size.width=i.size.height*n.aspectRatio),i.position.top=i._helper?o.top:0),i.offset.left=i.parentData.left+i.position.left,i.offset.top=i.parentData.top+i.position.top,n=Math.abs(i.offset.left-s.left+i.sizeDiff.width),o=Math.abs((i._helper?i.offset.top-s.top:i.offset.top-o.top)+i.sizeDiff.height),r=i.containerElement.get(0)==i.element.parent().get(0),s=/relative|absolute/.test(i.containerElement.css("position")),r&&s&&(n-=i.parentData.left),n+i.size.width>=i.parentData.width&&(i.size.width=i.parentData.width-n,t&&(i.size.height=i.size.width/i.aspectRatio)),o+i.size.height>=i.parentData.height&&(i.size.height=i.parentData.height-o,t&&(i.size.width=i.size.height*i.aspectRatio))},stop:function(){var t=e(this).data("resizable"),i=t.options,n=t.containerOffset,o=t.containerPosition,r=t.containerElement,s=e(t.helper),a=s.offset(),l=s.outerWidth()-t.sizeDiff.width,s=s.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(r.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:s}),t._helper&&!i.animate&&/static/.test(r.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:s})}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("resizable"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("resizable"),i=t.options,n=t.size,o=t.originalSize,r=t.originalPosition,s=t.axis;i.grid="number"==typeof i.grid?[i.grid,i.grid]:i.grid;var a=Math.round((n.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),i=Math.round((n.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(s)?(t.size.width=o.width+a,t.size.height=o.height+i):/^(ne)$/.test(s)?(t.size.width=o.width+a,t.size.height=o.height+i,t.position.top=r.top-i):(/^(sw)$/.test(s)?(t.size.width=o.width+a,t.size.height=o.height+i):(t.size.width=o.width+a,t.size.height=o.height+i,t.position.top=r.top-i),t.position.left=r.left-a)}});var t=function(e){return parseInt(e,10)||0},i=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e){e.widget("ui.sortable",e.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData("sortable-item");return this},_setOption:function(t,i){"disabled"===t?(this.options[t]=i,this.widget()[i?"addClass":"removeClass"]("ui-sortable-disabled")):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);var n=null,o=this;if(e(t.target).parents().each(function(){return e.data(this,"sortable-item")==o?(n=e(this),!1):void 0}),e.data(t.target,"sortable-item")==o&&(n=e(t.target)),!n)return!1;if(this.options.handle&&!i){var r=!1;if(e(this.options.handle,n).find("*").andSelf().each(function(){this==t.target&&(r=!0)}),!r)return!1}return this.currentItem=n,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,i,n){if(i=this.options,this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),i.containment&&this._setContainment(),i.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",i.cursor)),i.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",i.opacity)),i.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",i.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var i=this.options,n=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-this.overflowOffset.top<i.scrollSensitivity&&(this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-i.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-this.overflowOffset.left<i.scrollSensitivity&&(this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft-i.scrollSpeed)):(t.pageY-e(document).scrollTop()<i.scrollSensitivity?n=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(n=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed)),t.pageX-e(document).scrollLeft()<i.scrollSensitivity?n=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(n=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed))),!1!==n&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}for(this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--){var n=this.items[i],o=n.item[0],r=this._intersectsWithPointer(n);if(r&&o!=this.currentItem[0]&&this.placeholder[1==r?"next":"prev"]()[0]!=o&&!e.ui.contains(this.placeholder[0],o)&&("semi-dynamic"==this.options.type?!e.ui.contains(this.element[0],o):1)){if(this.direction=1==r?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this;i=n.placeholder.offset(),n.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-n.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-n.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,r=e.left,s=r+e.width,a=e.top,l=a+e.height,d=this.offset.click.top,h=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?n+d>a&&l>n+d&&t+h>r&&s>t+h:r<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&a<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var i=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height);t=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=i&&t,t=this._getDragVerticalDirection();var n=this._getDragHorizontalDirection();return i?this.floating?n&&"right"==n||"down"==t?2:1:t&&("down"==t?2:1):!1},_intersectsWithSides:function(t){var i=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height);t=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width);var n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"==o&&t||"left"==o&&!t:n&&("down"==n&&i||"up"==n&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var i=[],n=[],o=this._connectWith();if(o&&t)for(t=o.length-1;t>=0;t--)for(var r=e(o[t]),s=r.length-1;s>=0;s--){var a=e.data(r[s],"sortable");a&&a!=this&&!a.options.disabled&&n.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}for(n.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),t=n.length-1;t>=0;t--)n[t][0].each(function(){i.push(this)});return e(i)},_removeCurrentsFromItems:function(){for(var e=this.currentItem.find(":data(sortable-item)"),t=0;t<this.items.length;t++)for(var i=0;i<e.length;i++)e[i]==this.items[t].item[0]&&this.items.splice(t,1)},_refreshItems:function(t){this.items=[],this.containers=[this];var i=this.items,n=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],o=this._connectWith();if(o)for(var r=o.length-1;r>=0;r--)for(var s=e(o[r]),a=s.length-1;a>=0;a--){var l=e.data(s[a],"sortable");l&&l!=this&&!l.options.disabled&&(n.push([e.isFunction(l.options.items)?l.options.items.call(l.element[0],t,{item:this.currentItem}):e(l.options.items,l.element),l]),this.containers.push(l))}for(r=n.length-1;r>=0;r--)for(t=n[r][1],o=n[r][0],a=0,s=o.length;s>a;a++)l=e(o[a]),l.data("sortable-item",t),i.push({item:l,instance:t,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var i=this.items.length-1;i>=0;i--){var n=this.items[i],o=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item;t||(n.width=o.outerWidth(),n.height=o.outerHeight()),o=o.offset(),n.left=o.left,n.top=o.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){var i=t||this,n=i.options;if(!n.placeholder||n.placeholder.constructor==String){var o=n.placeholder;n.placeholder={element:function(){var t=e(document.createElement(i.currentItem[0].nodeName)).addClass(o||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return o||(t.style.visibility="hidden"),t},update:function(e,t){(!o||n.forcePlaceholderSize)&&(t.height()||t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}}i.placeholder=e(n.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),n.placeholder.update(i,i.placeholder)},_contactContainers:function(t){for(var i=null,n=null,o=this.containers.length-1;o>=0;o--)e.ui.contains(this.currentItem[0],this.containers[o].element[0])||(this._intersectsWith(this.containers[o].containerCache)?i&&e.ui.contains(this.containers[o].element[0],i.element[0])||(i=this.containers[o],n=o):this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",t,this._uiHash(this)),this.containers[o].containerCache.over=0));if(i)if(1===this.containers.length)this.containers[n]._trigger("over",t,this._uiHash(this)),this.containers[n].containerCache.over=1;else if(this.currentContainer!=this.containers[n]){for(var i=1e4,o=null,r=this.positionAbs[this.containers[n].floating?"left":"top"],s=this.items.length-1;s>=0;s--)if(e.ui.contains(this.containers[n].element[0],this.items[s].item[0])){var a=this.items[s][this.containers[n].floating?"left":"top"];Math.abs(a-r)<i&&(i=Math.abs(a-r),o=this.items[s])}(o||this.options.dropOnEmpty)&&(this.currentContainer=this.containers[n],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[n].element,!0),this._trigger("change",t,this._uiHash()),this.containers[n]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",t,this._uiHash(this)),this.containers[n].containerCache.over=1)}},_createHelper:function(t){var i=this.options;return t=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"==i.helper?this.currentItem.clone():this.currentItem,t.parents("body").length||e("parent"!=i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(t[0]),t[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==t[0].style.width||i.forceHelperSize)&&t.width(this.currentItem.width()),(""==t[0].style.height||i.forceHelperSize)&&t.height(this.currentItem.height()),t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.browser.msie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(t.containment)){var i=e(t.containment)[0],t=e(t.containment).offset(),n="hidden"!=e(i).css("overflow");this.containment=[t.left+(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0)-this.margins.top,t.left+(n?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(n?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,i){i||(i=this.position),t="absolute"==t?1:-1;var n="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*t+this.offset.parent.top*t-(e.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*t),left:i.left+this.offset.relative.left*t+this.offset.parent.left*t-(e.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*t)}},_generatePosition:function(t){var i=this.options,n="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);"relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());var r=t.pageX,s=t.pageY;return this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),i.grid&&(s=this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1],s=this.containment&&(s-this.offset.click.top<this.containment[1]||s-this.offset.click.top>this.containment[3])?s-this.offset.click.top<this.containment[1]?s+i.grid[1]:s-i.grid[1]:s,r=this.originalPageX+Math.round((r-this.originalPageX)/i.grid[0])*i.grid[0],r=this.containment&&(r-this.offset.click.left<this.containment[0]||r-this.offset.click.left>this.containment[2])?r-this.offset.click.left<this.containment[0]?r+i.grid[0]:r-i.grid[0]:r)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this,r=this.counter;window.setTimeout(function(){r==o.counter&&o.refreshPositions(!n)},0)},_clear:function(t,i){this.reverting=!1;var n=[];if(!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var o in this._storedCSS)("auto"==this._storedCSS[o]||"static"==this._storedCSS[o])&&(this._storedCSS[o]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();if(this.fromOutside&&!i&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev==this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent==this.currentItem.parent()[0]||i||n.push(function(e){this._trigger("update",e,this._uiHash())}),!e.ui.contains(this.element[0],this.currentItem[0]))for(i||n.push(function(e){this._trigger("remove",e,this._uiHash())}),o=this.containers.length-1;o>=0;o--)e.ui.contains(this.containers[o].element[0],this.currentItem[0])&&!i&&(n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.containers[o])),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.containers[o])));for(o=this.containers.length-1;o>=0;o--)i||n.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[o])),this.containers[o].containerCache.over&&(n.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[o])),this.containers[o].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!i){for(this._trigger("beforeStop",t,this._uiHash()),o=0;o<n.length;o++)n[o].call(this,t);this._trigger("stop",t,this._uiHash())}return!1}if(i||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!i){for(o=0;o<n.length;o++)n[o].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.extend(e.ui.sortable,{version:"1.8.11"})}(jQuery),function(e){e.widget("ui.slider",e.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t=this,i=this.options;if(this._mouseSliding=this._keySliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),i.disabled&&this.element.addClass("ui-slider-disabled ui-disabled"),this.range=e([]),i.range&&(!0===i.range?(this.range=e("<div></div>"),i.values||(i.values=[this._valueMin(),this._valueMin()]),i.values.length&&2!==i.values.length&&(i.values=[i.values[0],i.values[0]])):this.range=e("<div></div>"),this.range.appendTo(this.element).addClass("ui-slider-range"),"min"!==i.range&&"max"!==i.range||this.range.addClass("ui-slider-range-"+i.range),this.range.addClass("ui-widget-header")),0===e(".ui-slider-handle",this.element).length&&e("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle"),i.values&&i.values.length)for(;e(".ui-slider-handle",this.element).length<i.values.length;)e("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=e(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all"),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).hover(function(){i.disabled||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).focus(function(){i.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("index.ui-slider-handle",t)}),this.handles.keydown(function(i){var n,o,r,s=!0,a=e(this).data("index.ui-slider-handle");if(!t.options.disabled){switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s=!1,!t._keySliding&&(t._keySliding=!0,e(this).addClass("ui-state-active"),n=t._start(i,a),!1===n))return}switch(r=t.options.step,n=o=t.options.values&&t.options.values.length?t.values(a):t.value(),i.keyCode){case e.ui.keyCode.HOME:o=t._valueMin();break;case e.ui.keyCode.END:o=t._valueMax();break;case e.ui.keyCode.PAGE_UP:o=t._trimAlignValue(n+(t._valueMax()-t._valueMin())/5);break;case e.ui.keyCode.PAGE_DOWN:o=t._trimAlignValue(n-(t._valueMax()-t._valueMin())/5);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===t._valueMax())return;o=t._trimAlignValue(n+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===t._valueMin())return;o=t._trimAlignValue(n-r)}return t._slide(i,a,o),s}}).keyup(function(i){var n=e(this).data("index.ui-slider-handle");t._keySliding&&(t._keySliding=!1,t._stop(i,n),t._change(i,n),e(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),
this._mouseDestroy(),this},_mouseCapture:function(t){var i,n,o,r,s,a=this.options;return a.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i=this._normValueFromMouse({x:t.pageX,y:t.pageY}),n=this._valueMax()-this._valueMin()+1,r=this,this.handles.each(function(t){var a=Math.abs(i-r.values(t));n>a&&(n=a,o=e(this),s=t)}),!0===a.range&&this.values(1)===a.min&&(s+=1,o=e(this.handles[s])),!1===this._start(t,s)?!1:(this._mouseSliding=!0,r._handleIndex=s,o.addClass("ui-state-active").focus(),a=o.offset(),this._clickOffset=e(t.target).parents().andSelf().is(".ui-slider-handle")?{left:t.pageX-a.left-o.width()/2,top:t.pageY-a.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)}:{left:0,top:0},this.handles.hasClass("ui-state-hover")||this._slide(t,s,i),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t=this._normValueFromMouse({x:e.pageX,y:e.pageY});return this._slide(e,this._handleIndex,t),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._clickOffset=this._handleIndex=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t;return"horizontal"===this.orientation?(t=this.elementSize.width,e=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,e=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),t=e/t,t>1&&(t=1),0>t&&(t=0),"vertical"===this.orientation&&(t=1-t),e=this._valueMax()-this._valueMin(),this._trimAlignValue(this._valueMin()+t*e)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&!0===this.options.range&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(n=this.values(),n[t]=i,e=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),this.values(t?0:1),!1!==e&&this.values(t,i,!0))):i!==this.value()&&(e=this._trigger("slide",e,{handle:this.handles[t],value:i}),!1!==e&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("change",e,i)}},value:function(e){return arguments.length&&(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0)),this._value()},values:function(t,i){var n,o,r;if(1<arguments.length&&(this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t)),!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(n=this.options.values,o=arguments[0],r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(o[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,i){var n,o=0;switch(e.isArray(this.options.values)&&(o=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.attr("disabled","disabled"),this.element.addClass("ui-disabled")):(this.handles.removeAttr("disabled"),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;o>n;n+=1)this._change(null,n);this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(e){var t,i;if(arguments.length)return t=this.options.values[e],this._trimAlignValue(t);for(t=this.options.values.slice(),i=0;i<t.length;i+=1)t[i]=this._trimAlignValue(t[i]);return t},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=0<this.options.step?this.options.step:1,i=(e-this._valueMin())%t;return alignValue=e-i,2*Math.abs(i)>=t&&(alignValue+=i>0?t:-t),parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,n,o,r,s=this.options.range,a=this.options,l=this,d=this._animateOff?!1:a.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(n){t=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,h["horizontal"===l.orientation?"left":"bottom"]=t+"%",e(this).stop(1,1)[d?"animate":"css"](h,a.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[d?"animate":"css"]({left:t+"%"},a.animate),1===n&&l.range[d?"animate":"css"]({width:t-i+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[d?"animate":"css"]({bottom:t+"%"},a.animate),1===n&&l.range[d?"animate":"css"]({height:t-i+"%"},{queue:!1,duration:a.animate}))),i=t}):(n=this.value(),o=this._valueMin(),r=this._valueMax(),t=r!==o?(n-o)/(r-o)*100:0,h["horizontal"===l.orientation?"left":"bottom"]=t+"%",this.handle.stop(1,1)[d?"animate":"css"](h,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({width:t+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[d?"animate":"css"]({width:100-t+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({height:t+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[d?"animate":"css"]({height:100-t+"%"},{queue:!1,duration:a.animate}))}}),e.extend(e.ui.slider,{version:"1.8.11"})}(jQuery),function(a,b){function c(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._inDialog=this._datepickerShowing=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1},a.extend(this._defaults,this.regional[""]),this.dpDiv=a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}function d(e,t){a.extend(e,t);for(var i in t)(null==t[i]||t[i]==b)&&(e[i]=t[i]);return e}a.extend(a.ui,{datepicker:{version:"1.8.11"}});var e=(new Date).getTime();a.extend(c.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return d(this._defaults,e||{}),this},_attachDatepicker:function(b,c){var d=null,e;for(e in this._defaults){var m=b.getAttribute("date:"+e);if(m){d=d||{};try{d[e]=eval(m)}catch(n){d[e]=m}}}e=b.nodeName.toLowerCase(),m="div"==e||"span"==e,b.id||(this.uuid+=1,b.id="dp"+this.uuid);var q=this._newInst(a(b),m);q.settings=a.extend({},c||{},d||{}),"input"==e?this._connectDatepicker(b,q):m&&this._inlineDatepicker(b,q)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'):this.dpDiv}},_connectDatepicker:function(e,t){var i=a(e);t.append=a([]),t.trigger=a([]),i.hasClass(this.markerClassName)||(this._attachments(i,t),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,i,n){t.settings[i]=n}).bind("getData.datepicker",function(e,i){return this._get(t,i)}),this._autoSize(t),a.data(e,"datepicker",t))},_attachments:function(e,t){var i=this._get(t,"appendText"),n=this._get(t,"isRTL");if(t.append&&t.append.remove(),i&&(t.append=a('<span class="'+this._appendClass+'">'+i+"</span>"),e[n?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),i=this._get(t,"showOn"),"focus"!=i&&"both"!=i||e.focus(this._showDatepicker),"button"==i||"both"==i){var i=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=a(this._get(t,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:o,alt:i,title:i}):a('<button type="button"></button>').addClass(this._triggerClass).html(""==o?i:a("<img/>").attr({src:o,alt:i,title:i}))),e[n?"before":"after"](t.trigger),t.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput==e[0]?a.datepicker._hideDatepicker():a.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),i=this._get(e,"dateFormat");if(i.match(/[DM]/)){var n=function(e){for(var t=0,i=0,n=0;n<e.length;n++)e[n].length>t&&(t=e[n].length,i=n);return i};t.setMonth(n(this._get(e,i.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(n(this._get(e,i.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var i=a(e);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,i,n){t.settings[i]=n}).bind("getData.datepicker",function(e,i){return this._get(t,i)}),a.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.dpDiv.show())},_dialogDatepicker:function(e,t,i,n,o){return e=this._dialogInst,e||(this.uuid+=1,this._dialogInput=a('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),e=this._dialogInst=this._newInst(this._dialogInput,!1),e.settings={},a.data(this._dialogInput[0],"datepicker",e)),d(e.settings,n||{}),t=t&&t.constructor==Date?this._formatDate(e,t):t,this._dialogInput.val(t),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),e.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",e),this},_destroyDatepicker:function(e){var t=a(e),i=a.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var n=e.nodeName.toLowerCase();a.removeData(e,"datepicker"),"input"==n?(i.append.remove(),i.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!=n&&"span"!=n||t.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(e){var t=a(e),i=a.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var n=e.nodeName.toLowerCase();"input"==n?(e.disabled=!1,i.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!=n&&"span"!=n||t.children("."+this._inlineClass).children().removeClass("ui-state-disabled"),this._disabledInputs=a.map(this._disabledInputs,function(t){return t==e?null:t})}},_disableDatepicker:function(e){var t=a(e),i=a.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var n=e.nodeName.toLowerCase();"input"==n?(e.disabled=!0,i.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!=n&&"span"!=n||t.children("."+this._inlineClass).children().addClass("ui-state-disabled"),this._disabledInputs=a.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return a.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,i){var n=this._getInst(e);if(2==arguments.length&&"string"==typeof t)return"defaults"==t?a.extend({},a.datepicker._defaults):n?"all"==t?a.extend({},n.settings):this._get(n,t):null;var o=t||{};if("string"==typeof t&&(o={},o[t]=i),n){this._curInst==n&&this._hideDatepicker();var r=this._getDateDatepicker(e,!0),s=this._getMinMaxDate(n,"min"),l=this._getMinMaxDate(n,"max");d(n.settings,o),null!==s&&o.dateFormat!==b&&o.minDate===b&&(n.settings.minDate=this._formatDate(n,s)),null!==l&&o.dateFormat!==b&&o.maxDate===b&&(n.settings.maxDate=this._formatDate(n,l)),this._attachments(a(e),n),this._autoSize(n),this._setDateDatepicker(e,r),this._updateDatepicker(n)}},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){(e=this._getInst(e))&&this._updateDatepicker(e)},_setDateDatepicker:function(e,t){(e=this._getInst(e))&&(this._setDate(e,t),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(e,t){return(e=this._getInst(e))&&!e.inline&&this._setDateFromField(e,t),e?this._getDate(e):null},_doKeyDown:function(e){var t=a.datepicker._getInst(e.target),i=!0,n=t.dpDiv.is(".ui-datepicker-rtl");if(t._keyEvent=!0,a.datepicker._datepickerShowing)switch(e.keyCode){case 9:a.datepicker._hideDatepicker(),i=!1;break;case 13:return i=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",t.dpDiv),i[0]?a.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,i[0]):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(e.target,e.ctrlKey?-a.datepicker._get(t,"stepBigMonths"):-a.datepicker._get(t,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(e.target,e.ctrlKey?+a.datepicker._get(t,"stepBigMonths"):+a.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&a.datepicker._clearDate(e.target),i=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&a.datepicker._gotoToday(e.target),i=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&a.datepicker._adjustDate(e.target,n?1:-1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&a.datepicker._adjustDate(e.target,e.ctrlKey?-a.datepicker._get(t,"stepBigMonths"):-a.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&a.datepicker._adjustDate(e.target,-7,"D"),i=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&a.datepicker._adjustDate(e.target,n?-1:1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&a.datepicker._adjustDate(e.target,e.ctrlKey?+a.datepicker._get(t,"stepBigMonths"):+a.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&a.datepicker._adjustDate(e.target,7,"D"),i=e.ctrlKey||e.metaKey;break;default:i=!1}else 36==e.keyCode&&e.ctrlKey?a.datepicker._showDatepicker(this):i=!1;i&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=a.datepicker._getInst(e.target);if(a.datepicker._get(t,"constrainInput")){var t=a.datepicker._possibleChars(a.datepicker._get(t,"dateFormat")),i=String.fromCharCode(e.charCode==b?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||" ">i||!t||-1<t.indexOf(i)}},_doKeyUp:function(e){if(e=a.datepicker._getInst(e.target),e.input.val()!=e.lastVal)try{a.datepicker.parseDate(a.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,a.datepicker._getFormatConfig(e))&&(a.datepicker._setDateFromField(e),a.datepicker._updateAlternate(e),a.datepicker._updateDatepicker(e))}catch(t){a.datepicker.log(t)}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!=e.nodeName.toLowerCase()&&(e=a("input",e.parentNode)[0]),!a.datepicker._isDisabledDatepicker(e)&&a.datepicker._lastInput!=e){var t=a.datepicker._getInst(e);a.datepicker._curInst&&a.datepicker._curInst!=t&&a.datepicker._curInst.dpDiv.stop(!0,!0);var i=a.datepicker._get(t,"beforeShow");d(t.settings,i?i.apply(e,[e,t]):{}),t.lastVal=null,a.datepicker._lastInput=e,a.datepicker._setDateFromField(t),a.datepicker._inDialog&&(e.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(e),a.datepicker._pos[1]+=e.offsetHeight);var n=!1;if(a(e).parents().each(function(){return n|="fixed"==a(this).css("position"),!n}),n&&a.browser.opera&&(a.datepicker._pos[0]-=document.documentElement.scrollLeft,a.datepicker._pos[1]-=document.documentElement.scrollTop),i={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(t),i=a.datepicker._checkOffset(t,i,n),t.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":n?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"}),!t.inline){var i=a.datepicker._get(t,"showAnim"),o=a.datepicker._get(t,"duration"),r=function(){a.datepicker._datepickerShowing=!0;var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(e.length){var i=a.datepicker._getBorders(t.dpDiv);e.css({left:-i[0],top:-i[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex(a(e).zIndex()+1),a.effects&&a.effects[i]?t.dpDiv.show(i,a.datepicker._get(t,"showOptions"),o,r):t.dpDiv[i||"show"](i?o:null,r),i&&o||r(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),a.datepicker._curInst=t}}},_updateDatepicker:function(e){var t=this,i=a.datepicker._getBorders(e.dpDiv);e.dpDiv.empty().append(this._generateHTML(e));var n=e.dpDiv.find("iframe.ui-datepicker-cover");if(n.length&&n.css({left:-i[0],top:-i[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){a(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).bind("mouseover",function(){t._isDisabledDatepicker(e.inline?e.dpDiv.parent()[0]:e.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end(),i=this._getNumberOfMonths(e),n=i[1],n>1?e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"):e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),e.dpDiv[(1!=i[0]||1!=i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==a.datepicker._curInst&&a.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus(),e.yearshtml){var o=e.yearshtml;setTimeout(function(){o===e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+a(document).scrollLeft(),d=document.documentElement.clientHeight+a(document).scrollTop();return t.left-=this._get(e,"isRTL")?n-r:0,t.left-=i&&t.left==e.input.offset().left?a(document).scrollLeft():0,t.top-=i&&t.top==e.input.offset().top+s?a(document).scrollTop():0,t.left-=Math.min(t.left,t.left+n>l&&l>n?Math.abs(t.left+n-l):0),t.top-=Math.min(t.top,t.top+o>d&&d>o?Math.abs(o+s):0),t},_findPos:function(e){for(var t=this._get(this._getInst(e),"isRTL");e&&("hidden"==e.type||1!=e.nodeType||a.expr.filters.hidden(e));)e=e[t?"previousSibling":"nextSibling"];return e=a(e).offset(),[e.left,e.top]},_hideDatepicker:function(e){var t=this._curInst;if(t&&(!e||t==a.data(e,"datepicker"))&&this._datepickerShowing){e=this._get(t,"showAnim");var i=this._get(t,"duration"),n=function(){a.datepicker._tidyDialog(t),this._curInst=null};a.effects&&a.effects[e]?t.dpDiv.hide(e,a.datepicker._get(t,"showOptions"),i,n):t.dpDiv["slideDown"==e?"slideUp":"fadeIn"==e?"fadeOut":"hide"](e?i:null,n),e||n(),(e=this._get(t,"onClose"))&&e.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._datepickerShowing=!1,this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){a.datepicker._curInst&&(e=a(e.target),e[0].id==a.datepicker._mainDivId||0!=e.parents("#"+a.datepicker._mainDivId).length||e.hasClass(a.datepicker.markerClassName)||e.hasClass(a.datepicker._triggerClass)||!a.datepicker._datepickerShowing||a.datepicker._inDialog&&a.blockUI||a.datepicker._hideDatepicker())},_adjustDate:function(e,t,i){e=a(e);var n=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(n,t+("M"==i?this._get(n,"showCurrentAtPos"):0),i),this._updateDatepicker(n))},_gotoToday:function(e){e=a(e);var t=this._getInst(e[0]);if(this._get(t,"gotoCurrent")&&t.currentDay)t.selectedDay=t.currentDay,t.drawMonth=t.selectedMonth=t.currentMonth,t.drawYear=t.selectedYear=t.currentYear;else{var i=new Date;t.selectedDay=i.getDate(),t.drawMonth=t.selectedMonth=i.getMonth(),t.drawYear=t.selectedYear=i.getFullYear()}this._notifyChange(t),this._adjustDate(e)},_selectMonthYear:function(e,t,i){e=a(e);var n=this._getInst(e[0]);n._selectingMonthYear=!1,n["selected"+("M"==i?"Month":"Year")]=n["draw"+("M"==i?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(n),this._adjustDate(e)},_clickMonthYear:function(e){var t=this._getInst(a(e)[0]);t.input&&t._selectingMonthYear&&setTimeout(function(){t.input.focus()},0),t._selectingMonthYear=!t._selectingMonthYear},_selectDay:function(e,t,i,n){var o=a(e);a(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(o=this._getInst(o[0]),o.selectedDay=o.currentDay=a("a",n).html(),o.selectedMonth=o.currentMonth=t,o.selectedYear=o.currentYear=i,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){e=a(e),this._getInst(e[0]),this._selectDate(e,"")},_selectDate:function(e,t){e=this._getInst(a(e)[0]),t=null!=t?t:this._formatDate(e),e.input&&e.input.val(t),this._updateAlternate(e);var i=this._get(e,"onSelect");i?i.apply(e.input?e.input[0]:null,[t,e]):e.input&&e.input.trigger("change"),e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),o=this.formatDate(i,n,this._getFormatConfig(e));a(t).each(function(){a(this).val(o)})}},noWeekends:function(e){return e=e.getDay(),[e>0&&6>e,""]},iso8601Week:function(e){e=new Date(e.getTime()),e.setDate(e.getDate()+4-(e.getDay()||7));var t=e.getTime();return e.setMonth(0),e.setDate(1),Math.floor(Math.round((t-e)/864e5)/7)+1},parseDate:function(e,t,i){if(null==e||null==t)throw"Invalid arguments";if(t="object"==typeof t?t.toString():t+"",""==t)return null;for(var n=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,n="string"!=typeof n?n:(new Date).getFullYear()%100+parseInt(n,10),o=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,r=(i?i.dayNames:null)||this._defaults.dayNames,s=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=i=-1,d=-1,h=-1,c=!1,p=function(t){return(t=_+1<e.length&&e.charAt(_+1)==t)&&_++,t},u=function(e){var i=p(e);if(e=new RegExp("^\\d{1,"+("@"==e?14:"!"==e?20:"y"==e&&i?4:"o"==e?3:2)+"}"),e=t.substring(m).match(e),!e)throw"Missing number at position "+m;return m+=e[0].length,parseInt(e[0],10)},f=function(e,i,n){for(e=p(e)?n:i,i=0;i<e.length;i++)if(t.substr(m,e[i].length).toLowerCase()==e[i].toLowerCase())return m+=e[i].length,i+1;throw"Unknown name at position "+m},g=function(){if(t.charAt(m)!=e.charAt(_))throw"Unexpected literal at position "+m;m++},m=0,_=0;_<e.length;_++)if(c)"'"!=e.charAt(_)||p("'")?g():c=!1;else switch(e.charAt(_)){case"d":d=u("d");break;case"D":f("D",o,r);break;case"o":h=u("o");break;case"m":l=u("m");break;case"M":l=f("M",s,a);break;case"y":i=u("y");break;case"@":var v=new Date(u("@"));i=v.getFullYear(),l=v.getMonth()+1,d=v.getDate();break;case"!":v=new Date((u("!")-this._ticksTo1970)/1e4),i=v.getFullYear(),l=v.getMonth()+1,d=v.getDate();break;case"'":p("'")?g():c=!0;break;default:g()}if(-1==i?i=(new Date).getFullYear():100>i&&(i+=(new Date).getFullYear()-(new Date).getFullYear()%100+(n>=i?0:-100)),h>-1)for(l=1,d=h;;){if(n=this._getDaysInMonth(i,l-1),n>=d)break;l++,d-=n}if(v=this._daylightSavingAdjust(new Date(i,l-1,d)),v.getFullYear()!=i||v.getMonth()+1!=l||v.getDate()!=d)throw"Invalid date";return v},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort;i=(i?i.monthNames:null)||this._defaults.monthNames;var s=function(t){return(t=c+1<e.length&&e.charAt(c+1)==t)&&c++,t},a=function(e,t,i){if(t=""+t,s(e))for(;t.length<i;)t="0"+t;return t},l=function(e,t,i,n){return s(e)?n[t]:i[t]},d="",h=!1;if(t)for(var c=0;c<e.length;c++)if(h)"'"!=e.charAt(c)||s("'")?d+=e.charAt(c):h=!1;else switch(e.charAt(c)){case"d":d+=a("d",t.getDate(),2);break;case"D":d+=l("D",t.getDay(),n,o);break;case"o":d+=a("o",(t.getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5,3);break;case"m":d+=a("m",t.getMonth()+1,2);break;case"M":d+=l("M",t.getMonth(),r,i);break;case"y":d+=s("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":s("'")?d+="'":h=!0;break;default:d+=e.charAt(c)}return d},_possibleChars:function(e){for(var t="",i=!1,n=function(t){return(t=o+1<e.length&&e.charAt(o+1)==t)&&o++,t},o=0;o<e.length;o++)if(i)"'"!=e.charAt(o)||n("'")?t+=e.charAt(o):i=!1;else switch(e.charAt(o)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":n("'")?t+="'":i=!0;break;default:t+=e.charAt(o)}return t},_get:function(e,t){return e.settings[t]!==b?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!=e.lastVal){var i,n,o=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null;i=n=this._getDefaultDate(e);var s=this._getFormatConfig(e);try{i=this.parseDate(o,r,s)||n}catch(a){this.log(a),r=t?"":r}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=r?i.getDate():0,e.currentMonth=r?i.getMonth():0,e.currentYear=r?i.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,i){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},o=function(t){try{return a.datepicker.parseDate(a.datepicker._get(e,"dateFormat"),t,a.datepicker._getFormatConfig(e))}catch(i){}for(var n=(t.toLowerCase().match(/^c/)?a.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),r=n.getMonth(),n=n.getDate(),s=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(t);l;){switch(l[2]||"d"){case"d":case"D":n+=parseInt(l[1],10);break;case"w":case"W":n+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),n=Math.min(n,a.datepicker._getDaysInMonth(o,r));break;case"y":case"Y":o+=parseInt(l[1],10),n=Math.min(n,a.datepicker._getDaysInMonth(o,r))}l=s.exec(t)}return new Date(o,r,n)};return(t=(t=null==t||""===t?i:"string"==typeof t?o(t):"number"==typeof t?isNaN(t)?i:n(t):new Date(t.getTime()))&&"Invalid Date"==t.toString()?i:t)&&(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)),this._daylightSavingAdjust(t)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,o=e.selectedMonth,r=e.selectedYear;t=this._restrictMinMax(e,this._determineDate(e,t,new Date)),e.selectedDay=e.currentDay=t.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=t.getMonth(),e.drawYear=e.selectedYear=e.currentYear=t.getFullYear(),o==e.selectedMonth&&r==e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""==e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_generateHTML:function(t){var i=new Date,i=this._daylightSavingAdjust(new Date(i.getFullYear(),i.getMonth(),i.getDate())),n=this._get(t,"isRTL"),o=this._get(t,"showButtonPanel"),r=this._get(t,"hideIfNoPrevNext"),s=this._get(t,"navigationAsDateFormat"),l=this._getNumberOfMonths(t),d=this._get(t,"showCurrentAtPos"),h=this._get(t,"stepMonths"),c=1!=l[0]||1!=l[1],p=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),u=this._getMinMaxDate(t,"min"),f=this._getMinMaxDate(t,"max"),d=t.drawMonth-d,g=t.drawYear;
if(0>d&&(d+=12,g--),f)for(var m=this._daylightSavingAdjust(new Date(f.getFullYear(),f.getMonth()-l[0]*l[1]+1,f.getDate())),m=u&&u>m?u:m;this._daylightSavingAdjust(new Date(g,d,1))>m;)d--,0>d&&(d=11,g--);t.drawMonth=d,t.drawYear=g;var m=this._get(t,"prevText"),m=s?this.formatDate(m,this._daylightSavingAdjust(new Date(g,d-h,1)),this._getFormatConfig(t)):m,m=this._canAdjustMonth(t,-1,g,d)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+e+".datepicker._adjustDate('#"+t.id+"', -"+h+", 'M');\" title=\""+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":r?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",_=this._get(t,"nextText"),_=s?this.formatDate(_,this._daylightSavingAdjust(new Date(g,d+h,1)),this._getFormatConfig(t)):_,r=this._canAdjustMonth(t,1,g,d)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+e+".datepicker._adjustDate('#"+t.id+"', +"+h+", 'M');\" title=\""+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+_+"</span></a>":r?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+_+"</span></a>",h=this._get(t,"currentText"),_=this._get(t,"gotoCurrent")&&t.currentDay?p:i,h=s?this.formatDate(h,_,this._getFormatConfig(t)):h,s=t.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+e+'.datepicker._hideDatepicker();">'+this._get(t,"closeText")+"</button>",o=o?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?s:"")+(this._isInRange(t,_)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+e+".datepicker._gotoToday('#"+t.id+"');\">"+h+"</button>":"")+(n?"":s)+"</div>":"",s=parseInt(this._get(t,"firstDay"),10),s=isNaN(s)?0:s,h=this._get(t,"showWeek"),_=this._get(t,"dayNames");this._get(t,"dayNamesShort");var v=this._get(t,"dayNamesMin"),y=this._get(t,"monthNames"),w=this._get(t,"monthNamesShort"),b=this._get(t,"beforeShowDay"),T=this._get(t,"showOtherMonths"),S=this._get(t,"selectOtherMonths");this._get(t,"calculateWeek");for(var C=this._getDefaultDate(t),x="",P=0;P<l[0];P++){for(var A="",L=0;L<l[1];L++){var D=this._daylightSavingAdjust(new Date(g,d,t.selectedDay)),k=" ui-corner-all",E="";if(c){if(E+='<div class="ui-datepicker-group',1<l[1])switch(L){case 0:E+=" ui-datepicker-group-first",k=" ui-corner-"+(n?"right":"left");break;case l[1]-1:E+=" ui-datepicker-group-last",k=" ui-corner-"+(n?"left":"right");break;default:E+=" ui-datepicker-group-middle",k=""}E+='">'}for(var E=E+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+k+'">'+(/all|left/.test(k)&&0==P?n?r:m:"")+(/all|right/.test(k)&&0==P?n?m:r:"")+this._generateMonthYearHeader(t,d,g,u,f,P>0||L>0,y,w)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),V=h?'<th class="ui-datepicker-week-col">'+this._get(t,"weekHeader")+"</th>":"",k=0;7>k;k++)var I=(k+s)%7,V=V+("<th"+((k+s+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+_[I]+'">'+v[I]+"</span></th>");E+=V+"</tr></thead><tbody>",V=this._getDaysInMonth(g,d),g==t.selectedYear&&d==t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,V));for(var k=(this._getFirstDayOfMonth(g,d)-s+7)%7,V=c?6:Math.ceil((k+V)/7),I=this._daylightSavingAdjust(new Date(g,d,1-k)),M=0;V>M;M++){for(var E=E+"<tr>",W=h?'<td class="ui-datepicker-week-col">'+this._get(t,"calculateWeek")(I)+"</td>":"",k=0;7>k;k++){var $=b?b.apply(t.input?t.input[0]:null,[I]):[!0,""],R=I.getMonth()!=d,B=R&&!S||!$[0]||u&&u>I||f&&I>f,W=W+('<td class="'+((k+s+6)%7>=5?" ui-datepicker-week-end":"")+(R?" ui-datepicker-other-month":"")+(I.getTime()==D.getTime()&&d==t.selectedMonth&&t._keyEvent||C.getTime()==I.getTime()&&C.getTime()==D.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(R&&!T?"":" "+$[1]+(I.getTime()==p.getTime()?" "+this._currentClass:"")+(I.getTime()==i.getTime()?" ui-datepicker-today":""))+'"'+(R&&!T||!$[2]?"":' title="'+$[2]+'"')+(B?"":' onclick="DP_jQuery_'+e+".datepicker._selectDay('#"+t.id+"',"+I.getMonth()+","+I.getFullYear()+', this);return false;"')+">"+(R&&!T?"&#xa0;":B?'<span class="ui-state-default">'+I.getDate()+"</span>":'<a class="ui-state-default'+(I.getTime()==i.getTime()?" ui-state-highlight":"")+(I.getTime()==p.getTime()?" ui-state-active":"")+(R?" ui-priority-secondary":"")+'" href="#">'+I.getDate()+"</a>")+"</td>");I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I)}E+=W+"</tr>"}d++,d>11&&(d=0,g++),E+="</tbody></table>"+(c?"</div>"+(0<l[0]&&L==l[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),A+=E}x+=A}return x+=o+(a.browser.msie&&7>parseInt(a.browser.version,10)&&!t.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),t._keyEvent=!1,x},_generateMonthYearHeader:function(t,i,n,o,r,s,l,d){var h=this._get(t,"changeMonth"),c=this._get(t,"changeYear"),p=this._get(t,"showMonthAfterYear"),u='<div class="ui-datepicker-title">',f="";if(s||!h)f+='<span class="ui-datepicker-month">'+l[i]+"</span>";else{l=o&&o.getFullYear()==n;for(var g=r&&r.getFullYear()==n,f=f+('<select class="ui-datepicker-month" onchange="DP_jQuery_'+e+".datepicker._selectMonthYear('#"+t.id+"', this, 'M');\" onclick=\"DP_jQuery_"+e+".datepicker._clickMonthYear('#"+t.id+"');\">"),m=0;12>m;m++)(!l||m>=o.getMonth())&&(!g||m<=r.getMonth())&&(f+='<option value="'+m+'"'+(m==i?' selected="selected"':"")+">"+d[m]+"</option>");f+="</select>"}if(p||(u+=f+(!s&&h&&c?"":"&#xa0;")),t.yearshtml="",s||!c)u+='<span class="ui-datepicker-year">'+n+"</span>";else{d=this._get(t,"yearRange").split(":");var _=(new Date).getFullYear();for(l=function(e){return e=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?_+parseInt(e,10):parseInt(e,10),isNaN(e)?_:e},i=l(d[0]),d=Math.max(i,l(d[1]||"")),i=o?Math.max(i,o.getFullYear()):i,d=r?Math.min(d,r.getFullYear()):d,t.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+e+".datepicker._selectMonthYear('#"+t.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+e+".datepicker._clickMonthYear('#"+t.id+"');\">";d>=i;i++)t.yearshtml+='<option value="'+i+'"'+(i==n?' selected="selected"':"")+">"+i+"</option>";t.yearshtml+="</select>",a.browser.mozilla?u+='<select class="ui-datepicker-year"><option value="'+n+'" selected="selected">'+n+"</option></select>":(u+=t.yearshtml,t.yearshtml=null)}return u+=this._get(t,"yearSuffix"),p&&(u+=(!s&&h&&c?"":"&#xa0;")+f),u+"</div>"},_adjustInstDate:function(e,t,i){var n=e.drawYear+("Y"==i?t:0),o=e.drawMonth+("M"==i?t:0);t=Math.min(e.selectedDay,this._getDaysInMonth(n,o))+("D"==i?t:0),n=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,o,t))),e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),"M"!=i&&"Y"!=i||this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min");return e=this._getMinMaxDate(e,"max"),t=i&&i>t?i:t,e&&t>e?e:t},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){return e=this._get(e,"numberOfMonths"),null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var o=this._getNumberOfMonths(e);return i=this._daylightSavingAdjust(new Date(i,n+(0>t?t:o[0]*o[1]),1)),0>t&&i.setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())),this._isInRange(e,i)},_isInRange:function(e,t){var i=this._getMinMaxDate(e,"min");return e=this._getMinMaxDate(e,"max"),(!i||t.getTime()>=i.getTime())&&(!e||t.getTime()<=e.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff"),t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){return t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear),t=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay)),this.formatDate(this._get(e,"dateFormat"),t,this._getFormatConfig(e))}}),a.fn.datepicker=function(e){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick).find("body").append(a.datepicker.dpDiv),a.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&("isDisabled"==e||"getDate"==e||"widget"==e)||"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+e+"Datepicker"].apply(a.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?a.datepicker["_"+e+"Datepicker"].apply(a.datepicker,[this].concat(t)):a.datepicker._attachDatepicker(this,e)})},a.datepicker=new c,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.8.11",window["DP_jQuery_"+e]=a}(jQuery),jQuery.effects||function(e,t){function i(t){var i;return t&&t.constructor==Array&&3==t.length?t:(i=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)]:(i=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))?[2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3])]:(i=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:(i=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))?[parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(t)?l.transparent:l[e.trim(t).toLowerCase()]}function n(){var e,t,i=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,n={};if(i&&i.length&&i[0]&&i[i[0]])for(var o=i.length;o--;)e=i[o],"string"==typeof i[e]&&(t=e.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),n[t]=i[e]);else for(e in i)"string"==typeof i[e]&&(n[e]=i[e]);return n}function o(t){var i,n;for(i in t)n=t[i],(null==n||e.isFunction(n)||i in h||/scrollbar/.test(i)||!/color/i.test(i)&&isNaN(parseFloat(n)))&&delete t[i];return t}function r(e,t){var i,n={_:0};for(i in t)e[i]!=t[i]&&(n[i]=t[i]);return n}function s(t,i,n,o){return"object"==typeof t&&(o=i,n=null,i=t,t=i.effect),e.isFunction(i)&&(o=i,n=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(o=n,n=i,i={}),e.isFunction(n)&&(o=n,n=null),i=i||{},n=n||i.duration,n=e.fx.off?0:"number"==typeof n?n:n in e.fx.speeds?e.fx.speeds[n]:e.fx.speeds._default,o=o||i.complete,[t,i,n,o]}function a(t){return!t||"number"==typeof t||e.fx.speeds[t]||"string"==typeof t&&!e.effects[t]?!0:!1}e.effects={},e.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor borderColor color outlineColor".split(" "),function(t,n){e.fx.step[n]=function(t){if(!t.colorInit){var o;o=t.elem;var r,s=n;do{if(r=e.curCSS(o,s),""!=r&&"transparent"!=r||e.nodeName(o,"body"))break;s="backgroundColor"}while(o=o.parentNode);o=i(r),t.start=o,t.end=i(t.end),t.colorInit=!0}t.elem.style[n]="rgb("+Math.max(Math.min(parseInt(t.pos*(t.end[0]-t.start[0])+t.start[0],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[1]-t.start[1])+t.start[1],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[2]-t.start[2])+t.start[2],10),255),0)+")"}});var l={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},d=["add","remove","toggle"],h={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.effects.animateClass=function(t,i,s,a){return e.isFunction(s)&&(a=s,s=null),this.queue("fx",function(){var l,h=e(this),c=h.attr("style")||" ",p=o(n.call(this)),u=h.attr("className");e.each(d,function(e,i){t[i]&&h[i+"Class"](t[i])}),l=o(n.call(this)),h.attr("className",u),h.animate(r(p,l),i,s,function(){e.each(d,function(e,i){t[i]&&h[i+"Class"](t[i])}),"object"==typeof h.attr("style")?(h.attr("style").cssText="",h.attr("style").cssText=c):h.attr("style",c),a&&a.apply(this,arguments)}),p=e.queue(this),l=p.splice(p.length-1,1)[0],p.splice(1,0,l),e.dequeue(this)})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,i,n,o){return i?e.effects.animateClass.apply(this,[{add:t},i,n,o]):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,i,n,o){return i?e.effects.animateClass.apply(this,[{remove:t},i,n,o]):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(i,n,o,r,s){return"boolean"==typeof n||n===t?o?e.effects.animateClass.apply(this,[n?{add:i}:{remove:i},o,r,s]):this._toggleClass(i,n):e.effects.animateClass.apply(this,[{toggle:i},n,o,r])},switchClass:function(t,i,n,o,r){return e.effects.animateClass.apply(this,[{add:i,remove:t},n,o,r])}}),e.extend(e.effects,{version:"1.8.11",save:function(e,t){for(var i=0;i<t.length;i++)null!==t[i]&&e.data("ec.storage."+t[i],e[0].style[t[i]])},restore:function(e,t){for(var i=0;i<t.length;i++)null!==t[i]&&e.css(t[i],e.data("ec.storage."+t[i]))},setMode:function(e,t){return"toggle"==t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":e=0;break;case"center":e=.5;break;case"right":e=1;break;default:e=e[1]/t.width}return{x:e,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},n=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});return t.wrap(n),n=t.parent(),"static"==t.css("position")?(n.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,n){i[n]=t.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),n.css(i).show()},removeWrapper:function(e){return e.parent().is(".ui-effects-wrapper")?e.parent().replaceWith(e):e},setTransition:function(t,i,n,o){return o=o||{},e.each(i,function(e,i){unit=t.cssUnit(i),0<unit[0]&&(o[i]=unit[0]*n+unit[1])}),o}}),e.fn.extend({effect:function(t){var i=s.apply(this,arguments),n={options:i[1],duration:i[2],callback:i[3]},i=n.options.mode,o=e.effects[t];return e.fx.off||!o?i?this[i](n.duration,n.callback):this.each(function(){n.callback&&n.callback.call(this)}):o.call(this,n)},_show:e.fn.show,show:function(e){if(a(e))return this._show.apply(this,arguments);var t=s.apply(this,arguments);return t[1].mode="show",this.effect.apply(this,t)},_hide:e.fn.hide,hide:function(e){if(a(e))return this._hide.apply(this,arguments);var t=s.apply(this,arguments);return t[1].mode="hide",this.effect.apply(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(a(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var i=s.apply(this,arguments);return i[1].mode="toggle",this.effect.apply(this,i)},cssUnit:function(t){var i=this.css(t),n=[];return e.each(["em","px","%","pt"],function(e,t){0<i.indexOf(t)&&(n=[parseFloat(i),t])}),n}}),e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,i,n,o,r){return e.easing[e.easing.def](t,i,n,o,r)},easeInQuad:function(e,t,i,n,o){return n*(t/=o)*t+i},easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i},easeInOutQuad:function(e,t,i,n,o){return 1>(t/=o/2)?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,o){return n*(t/=o)*t*t+i},easeOutCubic:function(e,t,i,n,o){return n*((t=t/o-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,o){return 1>(t/=o/2)?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,o){return n*(t/=o)*t*t*t+i},easeOutQuart:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,o){return 1>(t/=o/2)?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,o){return n*(t/=o)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,o){return n*((t=t/o-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,o){return 1>(t/=o/2)?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,o){return-n*Math.cos(t/o*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,o){return n*Math.sin(t/o*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,o){return-n/2*(Math.cos(Math.PI*t/o)-1)+i},easeInExpo:function(e,t,i,n,o){return 0==t?i:n*Math.pow(2,10*(t/o-1))+i},easeOutExpo:function(e,t,i,n,o){return t==o?i+n:n*(-Math.pow(2,-10*t/o)+1)+i},easeInOutExpo:function(e,t,i,n,o){return 0==t?i:t==o?i+n:1>(t/=o/2)?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,o){return-n*(Math.sqrt(1-(t/=o)*t)-1)+i},easeOutCirc:function(e,t,i,n,o){return n*Math.sqrt(1-(t=t/o-1)*t)+i},easeInOutCirc:function(e,t,i,n,o){return 1>(t/=o/2)?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,o){var r=0,s=n;return 0==t?i:1==(t/=o)?i+n:(r||(r=.3*o),s<Math.abs(n)?(s=n,e=r/4):e=r/(2*Math.PI)*Math.asin(n/s),-(s*Math.pow(2,10*--t)*Math.sin(2*(t*o-e)*Math.PI/r))+i)},easeOutElastic:function(e,t,i,n,o){var r=0,s=n;return 0==t?i:1==(t/=o)?i+n:(r||(r=.3*o),s<Math.abs(n)?(s=n,e=r/4):e=r/(2*Math.PI)*Math.asin(n/s),s*Math.pow(2,-10*t)*Math.sin(2*(t*o-e)*Math.PI/r)+n+i)},easeInOutElastic:function(e,t,i,n,o){var r=0,s=n;return 0==t?i:2==(t/=o/2)?i+n:(r||(r=.3*o*1.5),s<Math.abs(n)?(s=n,e=r/4):e=r/(2*Math.PI)*Math.asin(n/s),1>t?-.5*s*Math.pow(2,10*--t)*Math.sin(2*(t*o-e)*Math.PI/r)+i:s*Math.pow(2,-10*--t)*Math.sin(2*(t*o-e)*Math.PI/r)*.5+n+i)},easeInBack:function(e,i,n,o,r,s){return s==t&&(s=1.70158),o*(i/=r)*i*((s+1)*i-s)+n},easeOutBack:function(e,i,n,o,r,s){return s==t&&(s=1.70158),o*((i=i/r-1)*i*((s+1)*i+s)+1)+n},easeInOutBack:function(e,i,n,o,r,s){return s==t&&(s=1.70158),1>(i/=r/2)?o/2*i*i*(((s*=1.525)+1)*i-s)+n:o/2*((i-=2)*i*(((s*=1.525)+1)*i+s)+2)+n},easeInBounce:function(t,i,n,o,r){return o-e.easing.easeOutBounce(t,r-i,0,o,r)+n},easeOutBounce:function(e,t,i,n,o){return(t/=o)<1/2.75?7.5625*n*t*t+i:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(t,i,n,o,r){return r/2>i?.5*e.easing.easeInBounce(t,2*i,0,o,r)+n:.5*e.easing.easeOutBounce(t,2*i-r,0,o,r)+.5*o+n}})}(jQuery),function(e){e.fn.contextMenu=function(t){e(this).bind("contextmenu",function(e){return t(e),!1})}}(jQuery),function(e){function t(t){if("string"==typeof t.data){var i=t.handler,n=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type){var o="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],r=String.fromCharCode(t.which).toLowerCase(),s="",a={};for(t.ctrlKey&&"ctrl"!==o&&(s+="ctrl+"),t.altKey&&"alt"!==o&&(s+="alt+"),t.metaKey&&!t.ctrlKey&&"meta"!==o&&(s+="meta+"),t.shiftKey&&"shift"!==o&&(s+="shift+"),o?a[s+o]=!0:(a[s+r]=!0,a[s+e.hotkeys.shiftNums[r]]=!0,"shift+"===s&&(a[e.hotkeys.shiftNums[r]]=!0)),o=0,r=n.length;r>o;o++)if(a[n[o]])return i.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:/mac/i.test(navigator.platform)?"del":"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(jQuery),function(e){e.fn.selectable=function(t){return this.each(function(){var i=e(this);i.css("user-select",t?"text":"none"),i.css("-moz-user-select",t?"text":"-moz-none"),i.css("-webkit-user-select",t?"auto":"none"),(e.browser.msie||e.browser.opera)&&i.attr("unselectable",t?"off":"on")})}}(jQuery),this.JSON||(this.JSON={}),function(){function a(e){return 10>e?"0"+e:e}function b(t){return e.lastIndex=0,e.test(t)?'"'+t.replace(e,function(e){var t=k[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function c(e,t){var i,n,o,r,s,a=g,d=t[e];switch(d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(e)),"function"==typeof l&&(d=l.call(t,e,d)),typeof d){case"string":return b(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(g+=h,s=[],"[object Array]"===Object.prototype.toString.apply(d)){for(r=d.length,i=0;r>i;i+=1)s[i]=c(i,d)||"null";return o=0===s.length?"[]":g?"[\n"+g+s.join(",\n"+g)+"\n"+a+"]":"["+s.join(",")+"]",g=a,o}if(l&&"object"==typeof l)for(r=l.length,i=0;r>i;i+=1)n=l[i],"string"==typeof n&&(o=c(n,d))&&s.push(b(n)+(g?": ":":")+o);else for(n in d)Object.hasOwnProperty.call(d,n)&&(o=c(n,d))&&s.push(b(n)+(g?": ":":")+o);return o=0===s.length?"{}":g?"{\n"+g+s.join(",\n"+g)+"\n"+a+"}":"{"+s.join(",")+"}",g=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,k={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(h=g="","number"==typeof i)for(n=0;i>n;n+=1)h+=" ";else"string"==typeof i&&(h=i);if((l=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return c("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(a,b){function c(e,t){var i,n,o=e[t];if(o&&"object"==typeof o)for(i in o)Object.hasOwnProperty.call(o,i)&&(n=c(o,i),void 0!==n?o[i]=n:delete o[i]);return b.call(e,t,o)}var e;if(a=String(a),d.lastIndex=0,d.test(a)&&(a=a.replace(d,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"==typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse")})}(),function(e){e.extend(e.fn,{swapClass:function(e,t){var i=this.filter("."+e);return this.filter("."+t).removeClass(t).addClass(e),i.removeClass(e).addClass(t),this},replaceClass:function(e,t){return this.filter("."+e).removeClass(e).addClass(t).end()},hoverClass:function(t){return t=t||"hover",this.hover(function(){e(this).addClass(t)},function(){e(this).removeClass(t)})},heightToggle:function(e,t){e?this.animate({height:"toggle"},e,t):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),t&&t.apply(this,arguments)})},heightHide:function(e,t){e?this.animate({height:"hide"},e,t):(this.hide(),t&&this.each(t))},prepareBranches:function(e){return e.prerendered||(this.filter(":last-child:not(ul)").addClass(t.last),this.filter((e.collapsed?"":"."+t.closed)+":not(."+t.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(i,n){if(this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(t){this==t.target&&n.apply(e(this).next())}).add(e("a",this)).hoverClass(),!i.prerendered){this.filter(":has(>ul:hidden)").addClass(t.expandable).replaceClass(t.last,t.lastExpandable),this.not(":has(>ul:hidden)").addClass(t.collapsable).replaceClass(t.last,t.lastCollapsable);var o=this.find("div."+t.hitarea);o.length||(o=this.prepend('<div class="'+t.hitarea+'"/>').find("div."+t.hitarea)),o.removeClass().addClass(t.hitarea).each(function(){var t="";e.each(e(this).parent().attr("class").split(" "),function(){t+=this+"-hitarea "}),e(this).addClass(t)})}this.find("div."+t.hitarea).click(n)},treeview:function(i){function n(i,n){function r(n){return function(){return o.apply(e("div."+t.hitarea,i).filter(function(){return n?e(this).parent("."+n).length:!0})),!1}}e("a:eq(0)",n).click(r(t.collapsable)),e("a:eq(1)",n).click(r(t.expandable)),e("a:eq(2)",n).click(r())}function o(){e(this).parent().find(">.hitarea").swapClass(t.collapsableHitarea,t.expandableHitarea).swapClass(t.lastCollapsableHitarea,t.lastExpandableHitarea).end().swapClass(t.collapsable,t.expandable).swapClass(t.lastCollapsable,t.lastExpandable).find(">ul").heightToggle(i.animated,i.toggle),i.unique&&e(this).parent().siblings().find(">.hitarea").replaceClass(t.collapsableHitarea,t.expandableHitarea).replaceClass(t.lastCollapsableHitarea,t.lastExpandableHitarea).end().replaceClass(t.collapsable,t.expandable).replaceClass(t.lastCollapsable,t.lastExpandable).find(">ul").heightHide(i.animated,i.toggle)}function r(){var t=[];l.each(function(i,n){t[i]=e(n).is(":has(>ul:visible)")?1:0}),e.cookie(i.cookieId,t.join(""),i.cookieOptions)}function s(){var t=e.cookie(i.cookieId);if(t){var n=t.split("");l.each(function(t,i){e(i).find(">ul")[parseInt(n[t])?"show":"hide"]()})}}if(i=e.extend({cookieId:"treeview"},i),i.toggle){var a=i.toggle;i.toggle=function(){return a.apply(e(this).parent()[0],arguments)}}this.data("toggler",o),this.addClass("treeview");var l=this.find("li").prepareBranches(i);switch(i.persist){case"cookie":var d=i.toggle;i.toggle=function(){r(),d&&d.apply(this,arguments)},s();break;case"location":var h=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()});h.length&&(h=h.addClass("selected").parents("ul, li").add(h.next()).show(),i.prerendered&&h.filter("li").swapClass(t.collapsable,t.expandable).swapClass(t.lastCollapsable,t.lastExpandable).find(">.hitarea").swapClass(t.collapsableHitarea,t.expandableHitarea).swapClass(t.lastCollapsableHitarea,t.lastExpandableHitarea))}return l.applyClasses(i,o),i.control&&(n(this,i.control),e(i.control).show()),this}}),e.treeview={};var t=e.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"}}(jQuery),function(e){function t(e){for(var t=0;t<arguments.length;t++)if(!isNaN(parseFloat(arguments[t])))return Number(parseFloat(arguments[t]))}function i(t,i){var n=e(i||this).attr("class"),n=new RegExp("(\\b"+t+")(\\S*)").exec(n),o={"true":!0,True:!0,"false":!1,False:!1};return n&&3<=n.length&&void 0!==o[n[3]]&&(n[3]=o[n[3]]),n?3<=n.length?n[2]:null:void 0}e.fn.spinbox=function(n){return n&&"String"==typeof n&&"destroy"===n?this.unbind(".spinbox").removeClass(n.spinboxClass).removeClass(n.upClass).removeClass(n.downClass).removeClass(n.upHoverClass).removeClass(n.downHoverClass).removeData("spinboxMin").removeData("spinboxMax").removeData("spinboxReset").removeData("spinboxStep").removeData("spinboxBigStep"):(n=e.extend({},e.fn.spinbox.defaults,n),this.each(function(){var o=e(this),r=i("spinboxMin",this),s=i("spinboxMax",this),a=i("spinboxStep",this),l=i("spinboxBigStep",this),d=i("spinboxReset",this),h=i("spinboxScale",this);void 0===r&&(r=t(o.attr("min"),n.min)),void 0===s&&(s=t(o.attr("max"),n.max)),a||(a=t(o.attr("step"),n.step)),l||(l=t(o.attr("bigStep"),n.bigStep)),void 0===d&&(d=t(n.reset,o.val(),r,s)),void 0===h&&(h=o.data("spinboxScale")),h=h||!isNaN(parseFloat(h))?h:n.scale,!0===h&&(h=(a.toString().split(".")[1]||"").length),o.data("spinboxMin",r),o.data("spinboxMax",s),o.data("spinboxStep",a),o.data("spinboxBigStep",l),o.data("spinboxReset",d),o.data("spinboxScale",h)}),this.each(function(){function i(i,o,r){if(i=e(this),!n.ignore||!i.is(n.ignore)){o=t(o,i.data("spinboxStep"),1),r=r||(a?-1:1);var s=i.val(),l=t(s,i.data("spinboxReset"),0),d=t(i.data("spinboxMin")),h=t(i.data("spinboxMax")),c=[l,o,d,h,r,s,n];r>0?l=n.increment.apply(this,c):0>r&&(l=n.decrement.apply(this,c)),c=i.data("spinboxScale"),!isNaN(parseFloat(c))&&n.round&&(l=n.round(l,i.data("spinboxScale"))),isNaN(parseFloat(d))||(l=Math.max(l,d)),isNaN(parseFloat(h))||(l=Math.min(l,h)),c=[l,o,d,h,r,s,n],l!=s&&!1!==i.triggerHandler("beforeSpin",c)&&(i.val(l),n.change&&i.trigger("change",c),i.triggerHandler("spin",c))}}function o(e,t){r(),l=window.setTimeout(function(){i.apply(e,[t]),d=window.setInterval(function(){i.apply(e,[t])},n.repeat)},n.delay)}function r(){window.clearTimeout(l),window.clearInterval(d)}var s,a,l,d,h=e(this);h.bind("mousemove.spinbox",function(t){var i=e(this),o=i.offset(),r=i.height()/2,l=t.pageX>o.left+i.width()-n.buttonWidth;s=l&&t.pageY<=o.top+r,a=l&&t.pageY>o.top+r,i.toggleClass(n.upHoverClass,s).toggleClass(n.downHoverClass,a)}),h.bind("mouseout.spinbox",function(){r(),e(this).removeClass([n.upClass,n.downClass,n.upHoverClass,n.downHoverClass].join(" ")),s=a=null}),h.bind("mousedown.spinbox",function(t){(s||a)&&(e(this).toggleClass(n.upClass,s).toggleClass(n.downClass,a),i.apply(this,[t]),o(this,t))}),h.bind("mouseup.spinbox",function(t){r(),e(this).removeClass(n.upClass).removeClass(n.downClass)}),h.bind("keydown.spinbox",function(t){if(n.keys&&!e.grep(n.keys,function(e){return e===t.keyCode||e instanceof RegExp&&e.test(String.fromCharCode(t.keyCode))}).length)return!n.keys;var o=e(this),r=o.data("spinboxBigStep"),o=t.shiftKey?r:o.data("spinboxStep");switch(t.keyCode){case 38:i.apply(this,[t,o,1]);break;case 40:i.apply(this,[t,o,-1]);break;case 33:i.apply(this,[t,r,1]);break;case 34:i.apply(this,[t,r,-1])}}),h.bind("change.spinbox",function(e){i.apply(this,[e,0])}),h.addClass(n.spinboxClass),n.mousewheel&&e(this).bind("mousewheel.spinbox DOMMouseScroll.spinbox",function(t){var n=t.shiftKey?e(this).data("spinboxBigStep"):e(this).data("spinboxStep");return 0>t.detail||120<=t.wheelDelta?i.apply(this,[t,n,1]):(0<t.detail||-120>=t.wheelDelta)&&i.apply(this,[t,n,-1]),!1}),i.apply(this,[e.Event(),0])}))},e.fn.spinbox.defaults={min:0,max:null,step:1,bigStep:10,keys:[/[0-9]/,9,13,8,46,33,34,37,38,39,40,109,188,190],ignore:"[readonly],[disabled]",
spinboxClass:"spinbox-active",upClass:"spinbox-up",downClass:"spinbox-down",upHoverClass:"spinbox-up-hover",downHoverClass:"spinbox-down-hover",mousewheel:!0,change:!0,increment:function(e,t,i,n,o){return e+t},decrement:function(e,t,i,n,o){return e-t},reset:null,delay:500,repeat:100,buttonWidth:20,scale:!0,round:function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}}(jQuery),function(e){e.fn.popup=function(){return e(this).each(function(e,t){HTMLHelper.createPopup(t)})}}(jQuery),function(e,t,i){function n(n,o){function r(t){e(s).each(function(){var i=e(this);this===t.target||i.has(t.target).length||i.triggerHandler(o,[t.target])})}o=o||n+i;var s=e(),a=n+"."+o+"-special-event";e.event.special[o]={setup:function(){s=s.add(this),delete s.prevObject,1===s.length&&e(t).bind(a,r)},teardown:function(){s=s.not(this),delete s.prevObject,0===s.length&&e(t).unbind(a)},add:function(e){var t=e.handler;e.handler=function(e,i){e.target=i,t.apply(this,arguments)}}}}e.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(e){n(e)}),n("focusin","focus"+i),n("focusout","blur"+i),Modernizr.touch&&(n("touchstart","mousedown"+i),n("touchmove","mousemove"+i),n("touchend","mouseup"+i)),e.addOutsideEvent=n}(jQuery,document,"outside"),function(e){e.fn.mousecapture=function(t){var i=e(document);return this.each(function(){var n=e(this),o={};n.mousedown(function(e){var r;t.move&&(r=function(e){t.move.call(n,e,o)},i.mousemove(r));var s,a=function(){t.move&&i.unbind("mousemove",r),i.unbind("mouseup",s)};return s=t.up?function(e){return a(),t.up.call(n,e,o)}:a,i.mouseup(s),t.down.call(n,e,o)})}),this}}(jQuery),function(e){function t(e,t){if(!(1<e.originalEvent.touches.length)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,n=e.ui.mouse.prototype,o=n._mouseInit,r=n._mouseDestroy;n._touchStart=function(e){!i&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,this._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},n._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},n._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},n._mouseInit=function(){this.element.bind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),o.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),r.call(this)}}}(jQuery),EventEmitter=function(){function e(){}function t(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,o=this,r=o.EventEmitter;return n.getListeners=function(e){var t,i,n=this._getEvents();if(e instanceof RegExp)for(i in t={},n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i]);else t=n[e]||(n[e]=[]);return t},n.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},n.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&(t={},t[e]=i),t||i},n.addListener=function(e,i){var n,o=this.getListenersAsObject(e),r="object"==typeof i;for(n in o)o.hasOwnProperty(n)&&-1===t(o[n],i)&&o[n].push(r?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,i){var n,o,r=this.getListenersAsObject(e);for(o in r)r.hasOwnProperty(o)&&(n=t(r[o],i),-1!==n&&r[o].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,i){var n,o,r=e?this.removeListener:this.addListener;if(e=e?this.removeListeners:this.addListeners,"object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)r.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(o=t[n])&&("function"==typeof o?r.call(this,n,o):e.call(this,n,o));return this},n.removeEvent=function(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(e,t){var i,n,o,r,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].length;n--;)i=s[o][n],!0===i.once&&this.removeListener(e,i.listener),r=i.listener.apply(this,t||[]),r===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return o.EventEmitter=r,e},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e,e}.call(this);var W77=function(){var e={};if("undefined"!=typeof W77)return W77;var t,i={custom_items_in_context_menu:{},websocket_connection:{},countdown:{},extended_hours:{},symbol_search_parser_mixin:{},show_pro_features:{},daily_timeframe_suffix:{},symbollist_context_menu:{},pay_attention_to_ticker_not_symbol:{},graying_disabled_tools_enabled:{},update_study_formatter_on_symbol_resolve:{},constraint_dialogs_movement:{},same_data_requery:{},show_interval_dialog_on_key_press:{},header_interval_dialog_button:{subsets:["show_interval_dialog_on_key_press"]},header_fullscreen_button:{},header_symbol_search:{},header_resolutions:{subsets:["header_interval_dialog_button"]},header_chart_type:{},header_settings:{},header_indicators:{},header_compare:{},header_undo_redo:{},header_screenshot:{},header_saveload:{},header_saveload_to_the_right:{},header_widget:{subsets:"header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_settings header_indicators header_compare header_undo_redo header_fullscreen_button".split(" ")},disable_userlink_popup:{},left_toolbar:{},control_bar:{},widget_logo:{},timeframes_toolbar:{},edit_buttons_in_legend:{},pane_context_menu:{},scales_context_menu:{},legend_context_menu:{},context_menus:{subsets:["pane_context_menu","scales_context_menu","legend_context_menu"]},items_favoriting:{},use_localstorage_for_settings:{subsets:["items_favoriting"]},plain_studymarket:{},trading_options:{},disable_resolution_rebuild:{},border_around_the_chart:{},narrow_chart_enabled:{},charting_library_debug_mode:{},log_data_request_time:{},saveload_requires_authentication:{},saveload_storage_customization:{},new_chart_creation_available:{},volume_force_overlay:{},create_volume_indicator_by_default:{},saved_charts_count_restriction:{},lean_chart_load:{},stop_study_on_restart:{},star_some_intervals_by_default:{},predefined_items_only_may_be_starred:{},move_logo_to_main_pane:{},link_to_tradingview:{},right_bar_stays_on_scroll:{},short_name_may_differ_from_fullname:{},chart_content_overrides_by_deafults:{},14851:{},alerts:{},show_dialog_on_snapshot_ready:{},allow_supported_resolutions_set_only:{},study_market_minimized:{},widgetbar_tabs:{},collapsible_header:{},remove_library_container_border:{},side_toolbar_in_fullscreen_mode:{},tv_production:{subsets:"show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection header_fullscreen_button header_widget left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay new_chart_creation_available saved_charts_count_restriction create_volume_indicator_by_default charts_auto_save save_old_chart_before_save_as trading_options chart_content_overrides_by_deafults alerts show_dialog_on_snapshot_ready widgetbar_tabs header_saveload_to_the_right collapsible_header".split(" ")},browser_extension:{subsets:["disable_userlink_popup"]},widget:{subsets:"show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay create_volume_indicator_by_default show_dialog_on_snapshot_ready header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_indicators header_compare star_some_intervals_by_default".split(" ")},charting_library:{subsets:"daily_timeframe_suffix custom_items_in_context_menu pay_attention_to_ticker_not_symbol graying_disabled_tools_enabled update_study_formatter_on_symbol_resolve constraint_dialogs_movement header_widget header_screenshot left_toolbar control_bar widget_logo timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings plain_studymarket border_around_the_chart saveload_storage_customization volume_force_overlay lean_chart_load stop_study_on_restart header_saveload create_volume_indicator_by_default adapt_onchart_logo_background update_timeframes_set_on_symbol_resolve refresh_saved_charts_list_on_dialog_show predefined_items_only_may_be_starred link_to_tradingview right_bar_stays_on_scroll short_name_may_differ_from_fullname 14851 show_dialog_on_snapshot_ready allow_supported_resolutions_set_only study_market_minimized collapsible_header".split(" ")},static_charts_service:{subsets:["charting_library","disable_resolution_rebuild","log_data_request_time","same_data_requery"]},trading_terminal:{subsets:["charting_library","trading_options","header_saveload_to_the_right"]}},n={};for(t in i){for(var o=i[t].subsets||[],r=0;r<o.length;++r)n[o[r]]=1;n[t]=1}var s={};for(t in n)for(var a in n)o=i[a],"undefined"!=typeof o&&o.subsets&&0<=o.subsets.indexOf(t)&&(s.hasOwnProperty(t)||(s[t]=[]),s[t].push(a));var l={};return e.enabled=function(e){var t=s.hasOwnProperty(e)?s[e]:[];if(0==l[e])return!1;e=l[e];for(var i=0;i<t.length;++i)e|=W77.enabled(t[i]);return e},e._uniqueSets=function(){return Object.keys(n)},e.enable=function(e){l[e]=!0},e.setEnabled=function(e,t){l[e]=t},"undefined"!=typeof __initialDisabledFeaturesets&&__initialDisabledFeaturesets&&__initialDisabledFeaturesets.map(function(t){e.setEnabled(t,!1)}),"undefined"!=typeof __initialEnabledFeaturesets&&__initialEnabledFeaturesets&&__initialEnabledFeaturesets.map(function(t){e.enable(t)}),e}();"undefined"!=typeof module&&(module.exports=W77);var TradingView={},PineAddons={};TradingView.className=function(e){for(var t in this)if(TradingView[t]===e)return t;return null},TradingView.isMobileView=/mobile=1/i.test(window.location.search),TradingView.isOnFeaturePage=/on-features-page=1/i.test(window.location.search),TradingView.wrapUrl=function(e){return W77.enabled("charting_library")&&(e=e.replace("/static/","")),e},TradingView.RESOURCES_ROOT=TradingView.wrapUrl("/static/chart-client/css/"),TradingView.THEME_RESOURCES_ROOT=TradingView.wrapUrl("/static/chart-client/css/images/"),TradingView.resourceFullPath=function(e){return TradingView.RESOURCES_ROOT+e},TradingView.themeResourceFullPath=function(e){return TradingView.THEME_RESOURCES_ROOT+e},TradingView.isMobile=function(){var e=/Android/i.test(navigator.userAgent),t=/BlackBerry/i.test(navigator.userAgent),i=/iPhone|iPad|iPod/i.test(navigator.userAgent),n=/Opera Mini/i.test(navigator.userAgent),o=TradingView.winMobileMode,r=TradingView.isMobileView||e||t||i||n||o;return{Android:function(){return e},BlackBerry:function(){return t},iOS:function(){return i},Opera:function(){return n},Windows:function(){return o},any:function(){return r}}}(),TradingView.supportTouch=function(){return Modernizr.touch||TradingView.isMobile.any()},TradingView.onWidget=function(){return/widgetembed|widgetpopup|idea-popup/.test(window.location.pathname)},TradingView.availableTimezones=TradingView.availableTimezones||[{id:"UTC",title:"UTC"},{id:"EST",title:"EST"},{id:"CST",title:"CST"},{id:"PST",title:"PST"},{id:"exchange",title:"Exchange"}],TradingView.monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),TradingView.futuresRoots=[{d:"E-Mini S&P 500",t:"ES"},{d:"E-Mini Nasdaq 100",t:"NQ"},{d:"Gold",t:"GC"},{d:"Silver",t:"SI"},{d:"Crude Oil WTI",t:"CL"},{d:"Natural Gas",t:"NG"},{d:"Australian Dollar",t:"6A"},{d:"Australian Dollar (Floor)",t:"AD"},{d:"Euro FX",t:"6E"},{d:"Euro FX (Floor)",t:"EC"},{d:"Corn",t:"ZC"},{d:"Corn (Floor)",t:"C"},{d:"Eurodollar",t:"GE"},{d:"Eurodollar (Floor)",t:"ED"}],TradingView.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},TradingView.randomHash=function(){return TradingView.randomHashN(12)},TradingView.randomHashN=function(e){for(var t="",i=0;e>i;i++)var n=Math.round(60*Math.random()),t=t+"0123456789abcdefghijklmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[n];return t},isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},TypeValidator.prototype.check=function(e){return e.constructor===this.m_type||isInherited(e.constructor,this.m_type)},PredicateValidator.prototype.check=function(e){return this.m_predicate(e)},TradingView.clone=function(e){if(!e||"object"!=typeof e)return e;var t;t="function"==typeof e.pop?[]:{};var i,n;for(i in e)e.hasOwnProperty(i)&&(n=e[i],t[i]=n&&"object"==typeof n?TradingView.clone(n):n);return t},TradingView.deepEquals=function(e,t,i){if(i||(i=""),e===t)return[!0,i];if(isFunction(e)&&(e=void 0),isFunction(t)&&(t=void 0),void 0===e&&void 0!==t||void 0===t&&void 0!==e||null===e&&null!==t||null===t&&null!==e)return[!1,i];if(isString(e)&&isString(t))return[e===t,i];if(isArray(e)&&isArray(t)){var n=e.length;if(n!==t.length)return[!1,i];for(var o=0;n>o;o++)if(res=TradingView.deepEquals(e[o],t[o],i+"["+o+"]"),!res[0])return res}else{if(isArray(e)||isArray(t))return[!1,i];for(n in e)if(res=TradingView.deepEquals(e[n],t[n],i+"["+n+"]"),!res[0])return res}return[!0,i]},TradingView.merge=function(e,t){for(var i in t)"object"==typeof t[i]&&e.hasOwnProperty(i)?TradingView.merge(e[i],t[i]):e[i]=t[i];return e},TradingView.mergeWithRules=function(e,t,i,n){for(var o in t){var r=n?n+"."+o:o;i&&r in i?e[o]=i[r](e[o],t[o]):"object"==typeof t[o]&&e.hasOwnProperty(o)?TradingView.merge(e[o],t[o],i,r):e[o]=t[o]}},TradingView.sortMultipleFunction=function(){var e=[].slice.call(arguments),t=e.length;return function(i,n){var o,r,s,a,l;for(l=0;t>l&&(a=0,s=e[l],r="string"==typeof s?s:s.name,o=i[r],r=n[r],"function"==typeof s.fn&&(o=s.fn(o),r=s.fn(r)),s=s.reverse?-1:1,r>o&&(a=-1*s),o>r&&(a=1*s),0===a);l++);return a}},"undefined"!=typeof module&&module&&module.exports&&(module.exports={inherit:inherit,merge:TradingView.merge,isNumber:isNumber,isBoolean:isBoolean,isString:isString}),OrderedHash.prototype.rearrange=function(e){if("function"!=typeof e)throw Error("sort param is not a function");return this.array.sort(e)},OrderedHash.byValue=function(e){return function(e,t){return e-t}},OrderedHash.byField=function(e){return function(t,i){return t[e]>i[e]?1:t[e]<i[e]?-1:t[e]==i[e]?0:void 0}},OrderedHash.byOrder=function(e){return function(t,i){var n=e.indexOf(t.key),o=e.indexOf(i.key);return n-o}};var HTMLHelper={};!function(e){HTMLHelper.createLabel=function(t,i,n){return HTMLHelper.Element.create("label",e.extend(n,{html:i,"for":t}))},HTMLHelper.unbindContextMenu=function(e){e.contextMenu(function(e){return!1})},HTMLHelper.offsetX=function(e,t){return e.width()+t.pageX},HTMLHelper.offsetY=function(e,t){return e.height()+t.pageY},HTMLHelper.checkObjIsOutOfWindowX=function(t,i){var n=e(window).width()-HTMLHelper.offsetX(t,i);return 0>n?(n=i.pageX+n,n>0?n:0):i.pageX},HTMLHelper.checkObjIsOutOfWindowY=function(t,i){var n=e(window).height()-HTMLHelper.offsetY(t,i);return 0>n?(n=i.pageY+n,n>0?n:0):i.pageY},HTMLHelper.checkObjIsOutOfWindow=function(e,t){return{left:HTMLHelper.checkObjIsOutOfWindowX(e,t),top:HTMLHelper.checkObjIsOutOfWindowY(e,t)}},HTMLHelper.setAttr=function(e,t,i){return e.attr?e.attr(t,i):e[t]=i,e},HTMLHelper.removeAttr=function(e,t){return e.removeAttr?e.removeAttr(t):e.removeAttribute(t),e},HTMLHelper.notNull=function(t){return-1==e.inArray(t,[null,void 0,"false","null","undefined",0])},HTMLHelper.hideControl=function(e){return e.css({position:"absolute",top:-1e3,left:-1e3})},HTMLHelper.createPopup=function(e,t,i){return new HTMLHelper.Popup(e,t,i).render()},HTMLHelper.Popup=function(t,i,n){if(this.jqDiv=void 0!==t.selector?t:t.nodeType?e(t):HTMLHelper.Element.create("div",t),n){var o=this;e.each(n,function(e,t){o[e]=t})}TradingView.setMouseEventHandler(this.jqDiv,this),this._callback=i},HTMLHelper.Popup.prototype.render=function(){return this.jqDiv},HTMLHelper.Popup.prototype.show=function(){this.jqDiv.show()},HTMLHelper.Popup.prototype.hide=function(){this.jqDiv.hide()},HTMLHelper.Popup.prototype.setVisible=function(e){e?this.show():this.hide()},HTMLHelper.Popup.prototype.isVisible=function(){return this.jqDiv.is(":visible")},HTMLHelper.Popup.prototype.contextMenuEvent=function(e){return!1},HTMLHelper.Popup.prototype.mouseDownOutsideEvent=function(e){!this.isVisible()||this._callback&&!this._callback()||this.hide()}}(jQuery),HTMLHelper.Element={},HTMLHelper.Element.renderAttributes=function(e){var t="";for(attr in e)e[attr]&&(t+=" "+attr+'="'+e[attr]+'"');return t},HTMLHelper.Element.create=function(e,t){var i=$(document.createElement(e));return t&&(t.html&&(i.html(t.html),delete t.html),i.attr(t)),i},HTMLHelper.Element.validAttributes="abbr accept-charset accept accesskey action align alink alt archive axis background bgcolor border cellpadding cellspacing char charoff charset checked cite class classid clear code codebase codetype color cols colspan compact content coords data datetime declare defer dir disabled enctype face for frame frameborder headers height href hreflang hspace http-equiv id ismap label lang language link longdesc marginheight marginwidth maxlength media method multiple name nohref noresize noshade nowrap object onblur onchange onclick ondblclick onfocus onkeydown onkeypress onkeyup onload onmousedown onmousemove onmouseout onmouseover onmouseup onreset onselect onsubmit onunload profile prompt readonly rel rev rows rowspan rules scheme scope scrolling selected shape size span src standby start style summary tabindex target text title type usemap valign value valuetype version vlink vspace width".split(" "),HTMLHelper.Element.validAttribute=function(e){return-1!=jQuery.inArray(e,HTMLHelper.Element.validAttributes)},HTMLHelper.Element.cleanAttributes=function(e){return jQuery.each(e,function(t,i){HTMLHelper.Element.validAttribute(t)||delete e[t]}),e},HTMLHelper.CUSTOM_SELECT_MINIMAL_WIDTH=100,HTMLHelper.Input=function(e){return this.jqObj=null,this.data=e,this.init(),this._prepareValue(),this._prepareCallback(),this._prepareChildren(),this._applyAttributes(),this.jqObj},HTMLHelper.Input.selectOptions={type:"option",value:null,html:null},HTMLHelper.Input.optionsData={radiogroup:{type:"radio",name:null,value:null,label:null},select:HTMLHelper.Input.selectOptions,"select-one":HTMLHelper.Input.selectOptions,"select-multiple":HTMLHelper.Input.selectOptions},HTMLHelper.Input.customTypes=["radiogroup","fontpicker","colorpicker","combobox"],HTMLHelper.Input.prototype._tagIsInput=function(e){return-1!=jQuery.inArray(this.data.type,"text radio checkbox hidden reset image file".split(" "))},HTMLHelper.Input.prototype.init=function(){this._tagIsInput()?this.jqObj=HTMLHelper.Element.create("input",{name:this.data.name,type:this.data.type}):this.jqObj=HTMLHelper.Element.create(this.data.type,{name:this.data.name})},HTMLHelper.Input.prototype._eventIsKeyUp=function(){return-1!=jQuery.inArray(this.data.type,["text","textarea"])},HTMLHelper.Input.prototype._eventIsClick=function(){return-1!=jQuery.inArray(this.data.type,["checkbox","radio","option"])},HTMLHelper.Input.prototype._eventIsChange=function(){return-1!=jQuery.inArray(this.data.type,["select","select-one","select-multiple","radiogroup"])},HTMLHelper.Input.prototype._prepareCallback=function(){this.data.callback&&(this._eventIsKeyUp()?this.jqObj.keyup(this.data.callback):this._eventIsClick()?this.jqObj.click(this.data.callback):this._eventIsChange()&&this.jqObj.bind("change",this.data.callback),delete this.data.callback)},HTMLHelper.Input.prototype._childTag=function(){return{select:"option","select-one":"option","select-multiple":"option",radiogroup:"radio"}[this.data.type]},HTMLHelper.Input.prototype._inheritedProperties=function(){var e={type:this._childTag()};return"radiogroup"==this.data.type&&(e.name=this.data.name),e},HTMLHelper.Input.prototype._extendChildProps=function(e){var t=jQuery.extend(this._inheritedProperties(),e);return this.data.value==e.value&&(t.selected=!0),t},HTMLHelper.Input.prototype._prepareChildren=function(){if(this.data.options){var e=this;jQuery.each(this.data.options,function(t,i){e.jqObj.append(new HTMLHelper.Input(e._extendChildProps(i)))})}},HTMLHelper.Input.prototype.isCustom=function(){return-1!=jQuery.inArray(this.data.type,this.customTypes)},HTMLHelper.Input.prototype._isStoringValue=function(){return-1!=jQuery.inArray(this.data.type,["text","textarea","option","radio","checkbox"])},HTMLHelper.Input.prototype._htmlAsValue=function(){return"textarea"==this.data.type},HTMLHelper.Input.prototype._valAsValue=function(){return jQuery.inArray(this.data.type,"text checkbox radio option select select-one select-multiple".split(" "))},HTMLHelper.Input.prototype._getControlValue=function(){return{checkbox:1}[this.data.type]||this.data.value},HTMLHelper.Input.prototype._setControlValue=function(){this._valAsValue()?this.jqObj.val(this._getControlValue()):this._htmlAsValue()&&this.jqObj.html(this.data.value)},HTMLHelper.Input.prototype._getCheckedAttr=function(){return{option:"selected",radio:"checked",checkbox:"checked"}[this.data.type]},HTMLHelper.Input.prototype._setChecked=function(){this.data.selected&&this.jqObj.attr(this._getCheckedAttr(),!0)},HTMLHelper.Input.prototype._setValue=function(){this._setControlValue(),HTMLHelper.Input.isCheckable(this.data.type)&&this._setChecked()},HTMLHelper.Input.prototype._prepareValue=function(){this._isStoringValue()&&this._setValue()},HTMLHelper.Input.prototype._applyAttributes=function(){this.jqObj.attr(HTMLHelper.Element.cleanAttributes(this.data))},HTMLHelper.Input.value=function(e){return HTMLHelper.Input.controlCheckable(e)?e.checked:e.value},HTMLHelper.Input.isCheckable=function(e){return-1!=jQuery.inArray(e,["checkbox","radio","option"])},HTMLHelper.Input.controlType=function(e){if("string"==typeof e)return e;e=jQuery(e);var t=null;return e.attr("type")&&(t=e.attr("type"),jQuery.inArray(t,"textarea text select select-one select-multiple submit".split(" ")))?t:e.attr("tagName")},HTMLHelper.Input.controlCheckable=function(e){return HTMLHelper.Input.isCheckable(HTMLHelper.Input.controlType(e))},HTMLHelper.Input.controlToggleChecked=function(e,t){return HTMLHelper.setAttr(e,"checked",t)},HTMLHelper.Input.controlSetValue=function(e,t){return HTMLHelper.Input.controlCheckable(e)?HTMLHelper.Input.controlToggleChecked(e,t):HTMLHelper.setAttr(e,"value",t)},HTMLHelper.Input.currentOption=function(e){return e.options[e.selectedIndex]},HTMLHelper.Input.currentOptionInnerHTML=function(e){return HTMLHelper.Input.currentOption(e).innerHTML},HTMLHelper.ComboboxItem=function(e,t){this.value=e,this.html=t||"",this.jqItem=this._render()},HTMLHelper.ComboboxItem.prototype.eq=function(e){return this.value===e},HTMLHelper.ComboboxItem.prototype.width=function(e){return this.jqItem.width()},HTMLHelper.ComboboxItem.prototype._render=function(e){return e=$("<span/>").append(this.html),$('<div class="item"></div>').append(e)},HTMLHelper.ComboboxItem.prototype.render=function(e){return this.jqItem},HTMLHelper.ComboboxItem.prototype.select=function(e){e?this.jqItem.addClass("selected"):this.jqItem.removeClass("selected")},HTMLHelper.ComboboxItem.prototype.selectAndReturnIfValueMatch=function(e){return this.eq(e)?(this.select(!0),this):(this.select(!1),null)},HTMLHelper.Combobox=function(e){this._value=null,this.items=[],this.width=0,this.callback=this.jqItems=this.jqIcon=this.jqTitle=this.jqSwitcher=this.jqWrapper=null,this._init(),this.addItems(e),this.joinParts()},HTMLHelper.Combobox.prototype._init=function(){this._initWrapper(),this._initSwitcher(),this._initOptions()},HTMLHelper.Combobox.prototype._initTitle=function(){this.jqTitle=$('<span class="title" />')},HTMLHelper.Combobox.prototype._initIcon=function(){this.jqIcon=$('<span class="icon" />')},HTMLHelper.Combobox.prototype._initOptions=function(){this.jqItems=HTMLHelper.createPopup({"class":"items"})},HTMLHelper.Combobox.prototype._initWrapper=function(){this.jqWrapper=$('<div class="custom-select" />'),this.jqWrapper.data({disable:this.disable.bind(this),enable:this.enable.bind(this)})},HTMLHelper.Combobox.prototype._initSwitcher=function(){var e=this;this._initTitle(),this._initIcon(),this.jqSwitcher=$('<div class="switcher" />'),this.jqSwitcher.append(this.jqTitle),this.jqSwitcher.append(this.jqIcon),this.jqSwitcher.click(function(t){e.toggleItems()})},HTMLHelper.Combobox.prototype.toggleItems=function(){this.disabled()||this.jqItems.toggle()},HTMLHelper.Combobox.prototype.setWidth=function(){this.jqWrapper.width(this.width)},HTMLHelper.Combobox.prototype.joinParts=function(){this.jqWrapper.append(this.jqSwitcher),this.jqWrapper.append(this.jqItems),this.jqWrapper.selectable(!1)},HTMLHelper.Combobox.prototype.render=function(){return this.jqWrapper},HTMLHelper.Combobox.prototype.selectItemByValue=function(e){var t=null;return $(this.items).each(function(i,n){var o=n.selectAndReturnIfValueMatch(e);o&&(t=o)}),t},HTMLHelper.Combobox.prototype.setValue=function(e){if(this._value!=e){var t=this.selectItemByValue(e);this._value=e,this.jqTitle.html(t.html),this.change()}},HTMLHelper.Combobox.prototype.change=function(e){e?this.callback=e:this.callback&&this.callback.call(this)},HTMLHelper.Combobox.prototype.value=function(){return this._value},HTMLHelper.Combobox.prototype.val=function(e){return void 0===e?this.value():void this.setValue(e)},HTMLHelper.Combobox.prototype.addItems=function(e){var t=this;$(e).each(function(e,i){t.addItem(i.value,i.html)})},HTMLHelper.Combobox.prototype.addItem=function(e,t){var i=this,n=new HTMLHelper.ComboboxItem(e,t);this.items.push(n),n=n.render(),n.click(function(){i.setValue(e),i.toggleItems()}),this.jqItems.append(n),null===this.value()&&this.setValue(e)},HTMLHelper.Combobox.prototype.disable=function(){this._disabled=!0},HTMLHelper.Combobox.prototype.enable=function(){this._disabled=!1},HTMLHelper.Combobox.prototype.disabled=function(){return this._disabled},List.prototype.validator=function(){return this.m_validator},List.prototype.setValidator=function(e){this.m_validator=e},List.prototype.item=function(e){return this.m_values[e]},List.prototype.setItem=function(e,t){if(!isInteger(e))throw new RangeError("incorrect index");if(0>e||e>=this.m_values.length)throw new RangeError("incorrect index");if(null!==this.m_validator&&!this.m_validator.check(t))throw new TypeError("value is of unexpected type");this.m_values[e]=t},List.prototype.first=function(){return this.item(0)},List.prototype.last=function(){return this.item(this.size()-1)},List.prototype.append=function(e){if(null!==this.m_validator&&!this.m_validator.check(e))throw new TypeError("value is of unexpected type");return this.m_values.push(e),this},List.prototype.insert=function(e,t){if(!isInteger(t))throw new RangeError("invalid index:"+t);if(0>t||t>this.size())throw new RangeError("invalid index:"+t);this.m_values.splice(t,0,e)},List.prototype.appendAll=function(e){if(!new TypeValidator(List).check(e))throw new TypeError("parameter must be of type List");for(var t=0;t<e.size();++t)this.m_values.push(e.item(t));return this},List.prototype.removeAt=function(e){if(!isInteger(e))throw new RangeError("incorrect index");if(0>e||e>=this.m_values.length)throw new RangeError("incorrect index");this.m_values.splice(e,1)},List.prototype.size=function(){return this.m_values.length},List.prototype.isEmpty=function(){return 0===this.size()},List.prototype.indexOf=function(e){if(null!==this.m_validator&&!this.m_validator.check(e))throw new TypeError("value is of unexpected type");return this.m_values.indexOf(e)},List.prototype.contains=function(e){return-1!=this.indexOf(e)},List.prototype.remove=function(e){if(null!==this.m_validator&&!this.m_validator.check(e))throw new TypeError("value is of unexpected type");e=this.indexOf(e),-1!==e&&this.removeAt(e)},List.prototype.removeAll=function(e){this.m_values=this.m_values.filter(function(t){return!e(t)})},List.prototype.clear=function(){this.m_values=[]},List.prototype.clone=function(){var e=new List;return e.setValidator(this.validator()),e.m_values=this.m_values.slice(),e},List.prototype.toArray=function(){return this.m_values},List.prototype.sort=function(e){this.m_values.sort(e)},List.prototype.find=function(e){for(var t=0;t<this.m_values.length;t++)if(e(this.m_values[t],t,this.m_values))return this.m_values[t]},List.prototype.count=function(e){for(var t=0,i=0;i<this.m_values.length;i++)e(this.m_values[i],i,this.m_values)&&t++;return t};var loadTVScript=function(){var e=null;return function(){return e||(e="undefined"!=typeof TVScript?$.Deferred().resolve():loadScript(window.TVSCRIPT_FILES)),e.promise()}}(),MathEx={lessThan:function(e,t){return t>=e},greaterThan:function(e,t){return e>=t},clamp:function(e,t,i){return Math.min(Math.max(e,t),i)},sign:function(e){return 0>e?-1:e>0?1:0},isBaseDecimal:function(e){if(0>e)return TradingView.logDebug("MathEx.isBaseDecimal: argument less zero"),!1;for(;e>1;e/=10)if(0!==e%10)return!1;return!0},greaterOrEqual:function(e,t,i){return i>=t-e},equal:function(e,t,i){return Math.abs(e-t)<i},log10:function(e){return 0>=e?void TradingView.logDebug("MathEx.log10: argument less or equal zero"):Math.log(e)/Math.log(10)},defComparator:function(e,t){return t>e?-1:e>t?1:0},min:function(e,t){if(!isArray(e))throw"argument is not array";if(1>e.length)throw"array is empty";t||(t=MathEx.defComparator);for(var i=e[0],n=0;n<e.length;++n)0>t(e[n],i)&&(i=e[n]);return i},max:function(e,t){if(!isArray(e))throw"argument is not array";if(1>e.length)throw"array is empty";t||(t=MathEx.defComparator);for(var i=e[0],n=0;n<e.length;++n)0<t(e[n],i)&&(i=e[n]);return i},Point:function(e,t){this.x=e,this.y=t}};MathEx.Point.prototype.add=function(e){return new MathEx.Point(this.x+e.x,this.y+e.y)},MathEx.Point.prototype.addScaled=function(e,t){return new MathEx.Point(this.x+t*e.x,this.y+t*e.y)},MathEx.Point.prototype.substract=function(e){return new MathEx.Point(this.x-e.x,this.y-e.y)},MathEx.Point.prototype.dotProduct=function(e){return this.x*e.x+this.y*e.y},MathEx.Point.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},MathEx.Point.prototype.scaled=function(e){return new MathEx.Point(this.x*e,this.y*e)},MathEx.Point.prototype.normalized=function(){return this.scaled(1/this.length())},MathEx.Point.prototype.transponed=function(){return new MathEx.Point(-this.y,this.x)},MathEx.Point.prototype.clone=function(){return new MathEx.Point(this.x,this.y)},MathEx.Matrix=function(){this._rows=[[1,0,0],[0,1,0],[0,0,1]]},MathEx.Matrix.prototype.mult=function(e){if(e instanceof MathEx.Matrix){for(var t=new MathEx.Matrix,i=0;3>i;i++)for(var n=0;3>n;n++)for(var o=t._rows[i][n]=0;3>o;o++)t._rows[i][n]+=this._rows[i][o]*e._rows[o][n];
return t}if(e instanceof MathEx.Point){for(e=[e.x,e.y,1],t=[0,0,0],i=0;3>i;i++)for(n=0;3>n;n++)t[i]+=e[n]*this._rows[i][n];return new MathEx.Point(t[0],t[1])}throw"unsupported type"},MathEx.Matrix.rotate=function(e){var t=new MathEx.Matrix;return t._rows[0][0]=Math.cos(e),t._rows[1][1]=Math.cos(e),t._rows[0][1]=-Math.sin(e),t._rows[1][0]=Math.sin(e),t},MathEx.Matrix.scale=function(e,t){var i=new MathEx.Matrix;return i._rows[0][0]=e,i._rows[1][1]=t,i},MathEx.Matrix.translate=function(e,t){var i=new MathEx.Matrix;return i._rows[0][2]=e,i._rows[1][2]=t,i},MathEx.distanceToLine=function(e,t,i){t=t.substract(e);var n=i.substract(e).dotProduct(t)/t.dotProduct(t);return{distance:e.addScaled(t,n).substract(i).length(),coeff:n}},MathEx.distanceToSegment=function(e,t,i){var n=MathEx.distanceToLine(e,t,i);return 0<=n.coeff&&1>=n.coeff?n:(e=e.substract(i).length(),t=t.substract(i).length(),t>e?{distance:e,coeff:0}:{distance:t,coeff:1})},MathEx.intersectLines=function(e,t,i,n){return t=t.substract(e),n=n.substract(i),t=t.x*n.y-t.y*n.x,1e-6>Math.abs(t)?null:(e=e.substract(i),(e.y*n.x-e.x*n.y)/t)},MathEx.intersectSegment=function(e,t,i,n){var o=MathEx.intersectLines(e,t,i,n);return null===o?null:(e=t.substract(e).scaled(o).add(e),i=MathEx.distanceToSegment(i,n,e),1e-6>Math.abs(i.distance)?o:null)},MathEx.pointInRect=function(e,t,i){return e.x>=t.x&&e.x<=i.x&&e.y>=t.y&&e.y<=i.y},MathEx.pointInTriangle=function(e,t,i,n){var o=e.add(t).scaled(.5).add(i).scaled(.5),r=MathEx.intersectSegment(e,t,o,n);return null!==r?!1:(r=MathEx.intersectSegment(t,i,o,n),null!==r?!1:(r=MathEx.intersectSegment(i,e,o,n),null!==r?!1:!0))},MathEx.intersectRayWithRect=function(e,t,i,n){var o=MathEx.intersectLines(e,t,i,new MathEx.Point(n.x,i.y)),r=MathEx.intersectLines(e,t,new MathEx.Point(n.x,i.y),n),s=MathEx.intersectLines(e,t,n,new MathEx.Point(i.x,n.y)),a=MathEx.intersectLines(e,t,new MathEx.Point(i.x,n.y),i),l=[];return o&&o>=0&&l.push(o),r&&r>=0&&l.push(r),s&&s>=0&&l.push(s),a&&a>=0&&l.push(a),0===l.length?null:(l.sort(function(e,t){return e-t}),i=MathEx.pointInRect(e,i,n)?l[0]:l[l.length-1],e.addScaled(t.substract(e),i))},MathEx.isInPolygon=function(e,t){for(var i=0,n=e.size()-1,o=!1,r=t.x,s=t.y,i=0;i<e.size();i++){var a=e.item(i),n=e.item(n);(a.y<s&&n.y>=s||n.y<s&&a.y>=s)&&a.x+(s-a.y)/(n.y-a.y)*(n.x-a.x)<r&&(o=!o),n=i}return o},MathEx.isInCircle=function(e,t,i){return e=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),radiusQ=t*t,e<=radiusQ},MathEx.optionalCorner=function(e,t,i,n){return 1e-6<Math.abs(e.x-t.x)&&1e-6<Math.abs(e.y-t.y)?0==Math.round(e.x)||0==Math.round(t.x)?0==Math.round(e.y)||0==Math.round(t.y)?new MathEx.Point(0,0):new MathEx.Point(0,n):0==Math.round(e.y)||0==Math.round(t.y)?new MathEx.Point(i,0):new MathEx.Point(i,n):null};var CanvasEx={LINESTYLE_SOLID:0,LINESTYLE_DOTTED:1,LINESTYLE_DASHED:2,LINESTYLE_LARGE_DASHED:3,TEXTPOS_TOPLEFT:0,TEXTPOS_TOPCENTER:1,TEXTPOS_TOPRIGHT:2,TEXTPOS_MIDDLELEFT:3,TEXTPOS_MIDDLECENTER:4,TEXTPOS_MIDDLERIGHT:5,TEXTPOS_BOTTOMLEFT:6,TEXTPOS_BOTTOMCENTER:7,TEXTPOS_BOTTOMRIGHT:8,MARKLOC_ABOVEBAR:"AboveBar",MARKLOC_BELOWBAR:"BelowBar",MARKLOC_TOP:"Top",MARKLOC_BOTTOM:"Bottom",MARKLOC_RIGHT:"Right",MARKLOC_LEFT:"Left",MARKLOC_ABSOLUTE:"Absolute",MARKLOC_ABSOLUTEUP:"AbsoluteUp",MARKLOC_ABSOLUTEDOWN:"AbsoluteDown",HHISTLOC_RELATIVE:"relative",HHISTLOC_ABSOLUTE:"absolute",HHISTDIR_LEFTTORIGHT:"left_to_right",HHISTDIR_RIGHTTOLEFT:"right_to_left"};CanvasEx.computeDashPattern=function(e){return[[e.lineWidth,2*e.lineWidth],[3*e.lineWidth,2*e.lineWidth],[6*e.lineWidth,6*e.lineWidth]][e.lineStyle-1]},CanvasEx.drawLine=function(e,t,i,n,o){isFinite(t)&&isFinite(n)&&isFinite(i)&&isFinite(o)&&(e.lineStyle===CanvasEx.LINESTYLE_DASHED||e.lineStyle===CanvasEx.LINESTYLE_DOTTED?e.drawDashedLine(e,t,i,n,o):CanvasEx.drawSolidLine(e,t,i,n,o))},CanvasEx.drawSolidLine=function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i),e.lineTo(n,o),e.stroke()},CanvasEx.setLineStyle=function(e,t){e.lineStyle=t;var i=[];t!=CanvasEx.LINESTYLE_SOLID&&(i=CanvasEx.computeDashPattern(e)),"function"==typeof e.setLineDash?e.setLineDash(i):void 0!==e.mozDash?e.mozDash=i:void 0!==e.webkitLineDash&&(e.webkitLineDash=i)},CanvasEx.drawPoly=function(e,t,i){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var n=0;n<t.length;n++){var o=t[n];e.lineTo(o.x,o.y)}e.closePath(),e.stroke(),i&&e.fill()},CanvasEx.lineStyles=[],"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.setFont=function(e){if(this.font!=e)try{this.font=e}catch(t){}},CanvasRenderingContext2D.prototype.lineStyle=CanvasEx.LINESTYLE_SOLID,CanvasEx.originalSave=CanvasRenderingContext2D.prototype.save,CanvasEx.originalRestore=CanvasRenderingContext2D.prototype.restore,CanvasRenderingContext2D.prototype.save=function(){CanvasEx.lineStyles.push(this.lineStyle),CanvasEx.originalSave.call(this)},CanvasRenderingContext2D.prototype.restore=function(){0<CanvasEx.lineStyles.length&&(this.lineStyle=CanvasEx.lineStyles.pop(),CanvasEx.originalRestore.call(this))},CanvasRenderingContext2D.prototype.drawDashedLine=function(e,t,i,n,o){e.save();var r=CanvasEx.computeDashPattern(e);if(e.beginPath(),"function"==typeof e.setLineDash)e.setLineDash(r);else if(void 0!==e.mozDash)e.mozDash=r;else{if(void 0===e.webkitLineDash)return e.dashedLineTo(t,i,n,o,r),e.stroke(),void e.restore();e.webkitLineDash=r}e.moveTo(t,i),e.lineTo(n,o),e.stroke(),e.restore()},CanvasRenderingContext2D.prototype.dashedLineTo=function(e,t,i,n,o){var r={thereYet:MathEx.greaterThan,cap:Math.min},s={thereYet:MathEx.greaterThan,cap:Math.min};t-n>0&&(s.thereYet=MathEx.lessThan,s.cap=Math.max),e-i>0&&(r.thereYet=MathEx.lessThan,r.cap=Math.max),this.moveTo(e,t);for(var a=e,l=t,d=0,h=!0;!r.thereYet(a,i)||!s.thereYet(l,n);){var c=Math.atan2(n-t,i-e),p=o[d],a=r.cap(i,a+Math.cos(c)*p),l=s.cap(n,l+Math.sin(c)*p);h?this.lineTo(a,l):this.moveTo(a,l),d=(d+1)%o.length,h=!h}},CanvasRenderingContext2D.prototype.roundRect=function(e,t,i,n,o){this.beginPath(),this.moveTo(e+o,t),this.lineTo(e+i-o,t),this.arcTo(e+i,t,e+i,t+o,o),this.lineTo(e+i,t+n-o),this.arcTo(e+i,t+n,e+i-o,t+n,o),this.lineTo(e+o,t+n),this.arcTo(e,t+n,e,t+n-o,o),this.lineTo(e,t+o),this.arcTo(e,t,e+o,t,o)}),String.prototype.left=function(e){if(!isInteger(e))throw"invalid length";if(e>this.length)throw"invalid length";return this.substring(0,e)},String.prototype.right=function(e){if(!isInteger(e))throw"invalid length";if(e>this.length)throw"invalid length";return this.substring(this.length-e,this.length)},String.prototype.trimmed=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")},String.prototype.startsWith=function(e){return e.length>this.length?!1:this.left(e.length)===e},Delegate.prototype.subscribe=function(e,t,i){this._listeners.append({object:e,member:t,singleshot:!!i})},Delegate.prototype.unsubscribe=function(e,t){for(var i=0;i<this._listeners.size();++i){var n=this._listeners.item(i);if(n.object===e&&n.member.prototype===t.prototype){this._listeners.removeAt(i);break}}},Delegate.prototype.fire=function(e){for(var t=$.extend(!0,{},this._listeners),i=0;i<t.size();++i){var n=t.item(i);n.object?n.member.call(n.object,e):n.member(e)}this._listeners.removeAll(function(e){return e.singleshot})},TradingView.rgbToHsl=function(e,t,i){e/=255,t/=255,i/=255;var n,o=Math.max(e,t,i),r=Math.min(e,t,i),s=(o+r)/2;if(o==r)n=r=0;else{var a=o-r,r=s>.5?a/(2-o-r):a/(o+r);switch(o){case e:n=(t-i)/a+(i>t?6:0);break;case t:n=(i-e)/a+2;break;case i:n=(e-t)/a+4}n/=6}return[n,r,s]},TradingView.hslToRgb=function(e,t,i){if(0===t)i=t=e=i;else{var n=function(e,t,i){return 0>i&&(i+=1),i>1&&--i,1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+(t-e)*(2/3-i)*6:e},o=.5>i?i*(1+t):i+t-i*t,r=2*i-o;i=n(r,o,e+1/3),t=n(r,o,e),e=n(r,o,e-1/3)}return[Math.round(255*i),Math.round(255*t),Math.round(255*e)]},TradingView.colorsAreSimilar=function(e,t){var i=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16),r=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),a=parseInt(t.substring(5,7),16),i=r-i,n=n-s,o=o-a;return 16>Math.sqrt(i*i+n*n+o*o)},TradingView.invertColor=function(e){var t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16);return e=parseInt(e.substring(5,7),16),i=255-i,e=255-e,"#"+("0"+(255-t).toString(16)).right(2)+("0"+i.toString(16)).right(2)+("0"+e.toString(16)).right(2)},PixelSet.prototype.rawData=function(){return this._rawData},PixelSet.prototype.width=function(){return this._width},PixelSet.prototype.height=function(){return this._height},PixelSet.prototype.pixel=function(e,t){var i=[],n=t*this._width*4+4*e;return i.push(this._rawData[n]),i.push(this._rawData[n+1]),i.push(this._rawData[n+2]),i.push(this._rawData[n+3]),i},PixelSet.prototype.setPixel=function(e,t,i){e=t*this._width*4+4*e,this._rawData[e]=i[0],this._rawData[e+1]=i[1],this._rawData[e+2]=i[2],this._rawData[e+3]=i[3]},PixelSet.prototype.blend=function(e,t,i,n,o,r,s){n||(n=this.width()),o||(o=this.height()),r||(r=0),s||(s=0);for(var a=e.getImageData(t,i,n,o),l=0;n>l;l++)for(var d=0;o>d;d++){var h=d*n*4+4*l,c=this.pixel(r+l,s+d),p=c[1],u=c[2],f=1-c[3]/255;a.data[h]=a.data[h]*f+c[0]*(1-f),a.data[h+1]=a.data[h+1]*f+p*(1-f),a.data[h+2]=a.data[h+2]*f+u*(1-f),a.data[h+3]=Math.max(c[3],a.data[h+3])}e.putImageData(a,t,i)},TradingView.getImage=function(e,t){var i=document.body,n=i[e];return n||(n=document.createElement("img"),n.src=t,i[e]=n),n},A68=function(){function e(e,t){var i=function(){};return i.prototype=t.prototype,e.prototype=new i,e}function t(){}function i(e){this.value=e}function n(){}function o(){}function r(){}function s(){}function a(){}function l(){}function d(){}function h(e){this.value=e}function c(e){this.value=e}function p(e){this.value=e}function u(){h.apply(this,arguments)}function f(){c.apply(this,arguments)}function g(e,t){var n,o=[];e:for(;n=T.exec(e);){for(var r=y.length;r--;)if(void 0!==n[r+1]){y[r].ctor&&(r=new y[r].ctor(n[r+1]),r._offset=n.index,o.push(r));continue e}r=new p(n[0]),r._offset=n.index,o.push(r)}if(t&&t.recover)for(var s,r=o.length;r--;)n=o[r],n instanceof c||n instanceof h?(void 0!==s&&(n=new h(""),s=o.splice(r,s-r+1,n),n.value=s.map(function(e){return e.value}).join("")),s=r):n instanceof i||(s=void 0);return o}function m(e){for(var t=[],n=0;n<e.length;n++)e[n]instanceof i||t.push(e[n]);return t}function _(e){e=m(e);for(var t=[],i=[],s=0;s<e.length;s++){var a=e[s];if(a instanceof r)i.length&&i[i.length-1].minPrecedence>a.precedence&&(i[i.length-1].minPrecedence=a.precedence);else if(a instanceof n)i.push({minPrecedence:1/0,openBraceIndex:s});else if(a instanceof o){var a=i.pop(),l=e[a.openBraceIndex-1],d=e[s+1];d instanceof r&&!(d.precedence<=a.minPrecedence)||l instanceof r&&!(l.precedence<a.minPrecedence||l.precedence===a.minPrecedence&&l.commutative)||(t.unshift(a.openBraceIndex),t.push(s),i.length&&i[i.length-1].minPrecedence>a.minPrecedence&&(i[i.length-1].minPrecedence=a.minPrecedence))}}for(s=t.length;s--;)e.splice(t[s],1);return e}function v(e){for(var t,s=0,a=0,l=0;l<e.length;l++){var h=e[l];if(!(h instanceof i))switch(s){case 0:if(!(h instanceof c&&1===+h.value))return!1;s=1;break;case 1:if(!(1===s&&h instanceof d))return!1;s=2,t=l+1;break;case 2:if(h instanceof n)s=3,a=1;else if(h instanceof r)return!1;break;case 3:h instanceof n?a++:h instanceof o&&(a--,0>=a&&(s=2))}}return e.slice(t)}var y=[{pattern:"(",ctor:n},{pattern:")",ctor:o},{pattern:"+",ctor:s},{pattern:"-",ctor:a},{pattern:"*",ctor:l},{pattern:"/",ctor:d},{pattern:/\d+(?:\.\d*|(?![a-zA-Z0-9_!:\.&]))|\.\d+/,ctor:c},{pattern:/\./,ctor:f},{pattern:W77.enabled("charting_library")?/[a-zA-Z0-9_\u4e00-\u9fa5^][a-zA-Z0-9_\u4e00-\u9fa5_!:\.&]*|'.+?'/:/[a-zA-Z0-9][a-zA-Z0-9_!|:\.&]*|'.+?'/,ctor:h},{pattern:/'[^']*/,ctor:u},{pattern:/[\0-\x20\s]+/,ctor:i}];t.prototype.toString=function(){return this.value},e(i,t),e(n,t),n.prototype.value="(",e(o,t),o.prototype.value=")",e(r,t),e(s,r),s.prototype.value="+",s.prototype.precedence=0,s.prototype.commutative=!0,e(a,r),a.prototype.value="-",a.prototype.precedence=0,a.prototype.commutative=!1,e(l,r),l.prototype.value="*",l.prototype.precedence=1,l.prototype.commutative=!0,e(d,r),d.prototype.value="/",d.prototype.precedence=1,d.prototype.commutative=!1;var w=/^'?(?:([A-Z0-9_]+):)?(.*?)'?$/i,b=/[\+\-\/\*]/;e(h,t),h.prototype.toString=function(){if(this.hasOwnProperty("_ticker")){var e=b.test(this._ticker)?"'":"";return e+(this._exchange?this._exchange+":":"")+this._ticker+e}return this.value},h.prototype.parse=function(){var e=w.exec(this.value);e[1]&&(this._exchange=e[1]),this._ticker=e[2]},h.prototype.parseAsFutures=function(){if(TradingView.futuresRoots){this.hasOwnProperty("_ticker")||this.parse();for(var e=function(e){return TradingView.futuresRoots.some(function(t){return t.t===e})},t=2;t>=1;--t){var i=this._ticker.slice(0,t);if(e(i)){this._root=i,this._contract=this._ticker.slice(t);break}}}},h.prototype.exchange=function(e){return this.hasOwnProperty("_ticker")||this.parse(),0<arguments.length?void(null===e||void 0===e?delete this._exchange:this._exchange=e+""):this._exchange},h.prototype.ticker=function(e){return this.hasOwnProperty("_ticker")||this.parse(),0<arguments.length?(null===e||void 0===e?delete this._ticker:this._ticker=e+"",delete this._root,delete this._contract,void 0):this._ticker},h.prototype.root=function(e){return this.hasOwnProperty("_root")||this.parseAsFutures(),0<arguments.length?void(null===e||void 0===e?delete this._root:(this._root=e+"")&&(this._ticker=this._root+(this._contract||""))):this._root},h.prototype.contract=function(e){return this.hasOwnProperty("_contract")||this.parseAsFutures(),0<arguments.length?void(null===e||void 0===e?delete this._contract:(this._contract=e+"",this._root&&(this._ticker=this._root+this._contract))):this._root},e(c,t),c.prototype.toString=function(){return this.hasOwnProperty("_normalizedValue")?this._normalizedValue:this.value},c.prototype.parse=function(){this._normalizedValue=this.value.replace(/^0+|\.0*$/g,"").replace(/(\.\d*?)0+$/,"$1").replace(/^(\.|$)/,"0$1")},p.prototype.toString=function(){return this.value},e(u,h),u.prototype.isIncomplete=!0,u.prototype.incompleteSuggest=function(){return"'"!==this.value?new String("'"):void 0},e(f,c),f.prototype.isIncomplete=!0;var T=new RegExp(y.map(function(e){return"("+("string"==typeof e.pattern?e.pattern.replace(/[\^\$\(\)\[\]\{\}\*\+\?\|\\]/g,"\\$&"):e.pattern.source)+")"}).concat(".").join("|"),"g");return{tokenize:g,validate:function(e){if(W77.enabled("charting_library"))return{currentState:"var"};for(var t="init",s={warnings:[],errors:[],isEmpty:!0},a=[],l=0;l<e.length;l++){var d=e[l];if(!(d instanceof i)){if(delete s.isEmpty,d.isIncomplete){var u={status:"incomplete",reason:"incomplete_token",offset:d._offset,token:d};if(d.incompleteSuggest&&(u.recover={append:d.incompleteSuggest()}),s.warnings.push(u),l!==e.length-1){u.status="error";continue}}d instanceof h||d instanceof c?"var"==t?s.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d}):t="var":d instanceof r?"var"!=t?s.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d}):t="operator":d instanceof n?"var"==t?s.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d}):(a.push(d),t="init"):d instanceof o?"var"!=t?s.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d}):(a.pop()||s.errors.push({status:"error",reason:"unbalanced_brace",offset:d._offset,token:d,recover:{prepend:new n}}),t="var"):d instanceof p&&s.errors.push({status:"error",reason:"unparsed_entity",offset:d._offset,token:d})}}for(s.braceBalance=a.length,"var"!==t&&s.warnings.push({status:"incomplete"});a.length;)d=a.pop(),u={status:"incomplete",reason:"unbalanced_brace",offset:d._offset,token:d},"var"==t&&(u.recover={append:new o}),s.warnings.push(u);return s.currentState=t,0===s.warnings.length&&delete s.warnings,0===s.errors.length&&delete s.errors,s},factorOutBraces:_,normalizeTokens:function(e){for(var t=0;t<e.length;t++)e[t].parse&&e[t].parse();return e},flip:function(e){var t=v(e);return _(t?t:[new c("1"),new d,new n].concat(e).concat(new o))},hasBatsSymbols:function(e){if("string"==typeof e)e=g(e);else if(!Array.isArray(e))throw new TypeError("expression must be a string or token array");return e.some(function(e){return e instanceof h&&"BATS"===(e.exchange()||"").toUpperCase()?!0:!1})},hasEodSymbols:function(e){if("string"==typeof e)e=g(e);else if(!Array.isArray(e))throw new TypeError("expression must be a string or token array");return e.some(function(e){return e instanceof h&&-1!==(e.exchange()||"").toUpperCase().indexOf("_EOD")?!0:!1})},SymbolToken:h,IncompleteSymbolToken:u,NumberToken:c,BinaryOperatorToken:r,OpenBraceToken:n,CloseBraceToken:o,ticker:function(e){return new h(e).ticker()},shortName:function(e){if("string"!=typeof e)throw new TypeError("expression must be a string");return e=_(m(g(e))),e.forEach(function(e){e instanceof h&&e.exchange(null)}),e.join("")},normalize:function(e){if("string"!=typeof e)throw new TypeError("expression must be a string");return _(m(g(e))).join("")}}}(),WatchedValue.prototype.value=function(){return this._owner?this._owner._value:this._value},WatchedValue.prototype.setValue=function(e,t){var i=this._owner?this._owner:this;if("function"==typeof i.hook&&(e=i.hook(e)),i.writeLock)return i._value;if(!t&&i._value===e&&i.hasOwnProperty("_value"))return e;i._value=e;for(var n=i._listeners.slice(),o=0,r=0;r<n.length;r++)n[r].once&&(i._listeners.splice(r-o,1),o++),n[r].cb(e);return e},WatchedValue.prototype.deleteValue=function(){var e=this._owner?this._owner:this;if(e.hasOwnProperty("_value")){if(e.writeLock)return e._value;delete e._value;for(var t=e._listeners.slice(),i=0;i<t.length;i++)t[i].once&&e._listeners.splice(i-deletedEntries,1);for(i=0;i<t.length;i++)t[i].cb()}},WatchedValue.prototype.subscribe=function(e,t){if("function"!=typeof e)throw new TypeError("callback must be a function");var i=!!t&&!!t.once,n=this._owner?this._owner:this;t&&t.callWithLast&&n.hasOwnProperty("_value")&&(e(n._value),i)||n._listeners.push({cb:e,owner:this,once:!!t&&!!t.once})},WatchedValue.prototype.unsubscribe=function(e){var t=this._owner?this._owner:this;void 0===e&&(e=null);for(var i=t._listeners,n=i.length;n--;)i[n].owner!==this&&t!==this||i[n].cb!==e&&null!==e||i.splice(n,1)},WatchedValue.prototype.readonly=function(){if(this._readonlyInstance)return this._readonlyInstance;var e=this._readonlyInstance=new ReadonlyWatchedValue;return e.subscribe=this.subscribe.bind(this),e.unsubscribe=this.unsubscribe.bind(this),e.value=this.value.bind(this),e.when=this.when.bind(this),e},WatchedValue.prototype.spawn=function(){var e=new WatchedValue;return delete e._listeners,e._owner=this._owner||this,e.destroy=function(){this.unsubscribe(),delete this._owner},e},WatchedValue.prototype.when=function(e){var t=this;if(this.value())e();else{var i=function(n){n&&(t.unsubscribe(i),e())};t.subscribe(i)}},WEB_SOCKET_SWF_LOCATION=TradingView.resourceFullPath("web_socket_main.swf"),WEB_SOCKET_WAS_CONNECTED=WEB_SOCKET_DEBUG=!1,STUDY_COUNT_LIMIT=100,W98.prototype.defaultWatchlistSymbols=function(){},W98.prototype.availableTimeFrames=function(e,t){},W98.prototype.defaultResolutions=function(){},W98.prototype.supportedSymbolsTypes=function(){},W98.prototype.supportedExchangesList=function(){},W98.prototype.setAuthToken=function(e,t){},W98.prototype.authTokenRequired=function(e){},W98.prototype.quoteCreateSession=function(e){},W98.prototype.quoteDeleteSession=function(e){},W98.prototype.quoteSetFields=function(e,t){},W98.prototype.quoteAddSymbols=function(e,t){},W98.prototype.quoteRemoveSymbols=function(e,t){},W98.prototype.quoteFastSymbols=function(e,t){},W98.prototype.depthCreateSession=function(e,t,i){},W98.prototype.depthDeleteSession=function(e){},W98.prototype.depthSetSymbol=function(e,t){},W98.prototype.depthClearSymbol=function(e){},W98.prototype.depthSetScale=function(e,t){},W98.prototype.chartCreateSession=function(e,t){},W98.prototype.chartDeleteSession=function(e){},W98.prototype.createSession=function(e,t){},W98.prototype.removeSession=function(e){},W98.prototype.connected=function(){},W98.prototype._getHost=function(e){},W98.prototype.connect=function(){},W98.prototype.disconnect=function(){},W98.prototype.switchTimezone=function(e,t){},W98.prototype.resolveSymbol=function(e,t,i,n,o){},W98.prototype.createSeries=function(e,t,i,n,o,r,s){},W98.prototype.removeSeries=function(e,t,i){},W98.prototype.modifySeries=function(e,t,i,n,o,r){},W98.prototype.requestMoreData=function(e,t,i,n){},W98.prototype.requestMetadata=function(e,t,i){},W98.prototype.isCanCreateStudy=function(){},W98.prototype.createStudy=function(e,t,i,n,o,r,s){},W98.prototype.removeStudy=function(e,t,i){},W98.prototype.modifyStudy=function(e,t,i,n,o){},W98.prototype.createPointset=function(e,t,i,n,o,r,s){},W98.prototype.modifyPointset=function(e,t,i,n,o){},W98.prototype.removePointset=function(e,t,i){},W98.prototype.requestMoreTickmarks=function(e,t,i,n){},W98.prototype.requestFirstBarTime=function(e,t,i,n){},W98.prototype._invokeHandler=function(e,t){},W98.prototype._sendRequest=function(e,t){},W98.prototype._onMessage=function(e){},W98.prototype._convertTimescaleResponse=function(e){},W98.prototype._dispathNotification=function(e){},W98.prototype._invokeNotificationHandler=function(e,t,i){},W98.prototype._notifySessions=function(e){},W98.prototype.unpack=function(e){},W98.prototype.reconnectTimeout=function(e){},W98.prototype.searchSymbolsByName=function(e){},W98.prototype._isSafari5=function(){},W98.prototype._isIE9=function(){},W98.prototype._isIOS5=function(){},W98.prototype._getPort=function(e){},W98.prototype.getMarks=function(e,t,i,n,o){},declareClassAsPureInterface(W98,"W98"),ChartSession.prototype.serverTimeOffset=function(){return this._chartApi._serverTimeOffset},ChartSession.prototype.connected=function(){return this._chartApi.connected()&&!this._sessionDisabled},ChartSession.prototype.disconnected=function(){var e=this;Object.keys(this).forEach(function(t){/^(s|st|symbol_)\d+$/.test(t)&&delete e[t]})},ChartSession.prototype.initSession=function(){this._chartApi.createSession(this._sessionid,this)},ChartSession.prototype.stopSession=function(){this._chartApi.removeSession(this._sessionid)},ChartSession.prototype.setHandler=function(e){this._globalHandler=e},ChartSession.prototype.sessionId=function(){return this._sessionid},ChartSession.prototype.connect=function(e){this._globalHandler=e,this.initSession(),this._chartApi.connect()},ChartSession.prototype.disconnect=function(){this._chartApi.disconnect()},ChartSession.prototype.switchTimezone=function(e){this._chartApi.switchTimezone(this._sessionid,e)},ChartSession.prototype.resolveSymbol=function(e,t,i){this._chartApi.resolveSymbol(this._sessionid,e,t,i)},ChartSession.prototype.createSeries=function(e,t,i,n,o,r){this._chartApi.createSeries(this._sessionid,e,t,i,n,o,r)},ChartSession.prototype.removeSeries=function(e,t){this._chartApi.removeSeries(this._sessionid,e,t)},ChartSession.prototype.modifySeries=function(e,t,i,n,o){this._chartApi.modifySeries(this._sessionid,e,t,i,n,o)},ChartSession.prototype.requestMoreData=function(e,t,i){this._chartApi.requestMoreData(this._sessionid,e,t,i)},ChartSession.prototype.requestMetadata=function(e,t){this._chartApi.requestMetadata(this._sessionid,e,t)},ChartSession.prototype.createStudy=function(e,t,i,n,o,r){this._chartApi.createStudy(this._sessionid,e,t,i,n,o,r)},ChartSession.prototype.removeStudy=function(e,t){this._chartApi.removeStudy(this._sessionid,e,t)},ChartSession.prototype.modifyStudy=function(e,t,i,n){this._chartApi.modifyStudy(this._sessionid,e,t,i,n)},ChartSession.prototype.createPointset=function(e,t,i,n,o,r){this._chartApi.createPointset(this._sessionid,e,t,i,n,o,r)},ChartSession.prototype.modifyPointset=function(e,t,i,n){this._chartApi.modifyPointset(this._sessionid,e,t,i,n)},ChartSession.prototype.removePointset=function(e,t){this._chartApi.removePointset(this._sessionid,e,t)},ChartSession.prototype.requestMoreTickmarks=function(e,t,i){this._chartApi.requestMoreTickmarks(this._sessionid,e,t,i)},ChartSession.prototype.requestFirstBarTime=function(e,t,i){this._chartApi.requestFirstBarTime(this._sessionid,e,t,i)},ChartSession.prototype.setVisibleTimeRange=function(e,t,i){this._chartApi.setVisibleTimeRange(this._sessionid,e,t,i)},ChartSession.prototype.onMessage=function(e){switch(e.method){case"connected":this._chartApi.chartCreateSession(this._sessionid,this._disableStatistics);break;case"disconnected":this.disconnected()}this._globalHandler&&this._globalHandler(e)},ChartSession.prototype.disable=function(){this._sessionDisabled=!0},TimeIndexes.prototype.clear=function(){this._zoffset=0,this._items=[],this._lastTimePointIndex=null},TimeIndexes.prototype.items=function(){return this._items},TimeIndexes.prototype.size=function(){return this._items.length},TimeIndexes.prototype.firstTimePointIndex=function(){return this.offsetToIndex(0)},TimeIndexes.prototype.lastTimePointIndex=function(){return null!==this._lastTimePointIndex&&void 0!==this._lastTimePointIndex?this._lastTimePointIndex:this._lastTimePointIndex=this.offsetToIndex(this.size()-1)},TimeIndexes.prototype.merge=function(e,t,i){if(0===this._items.length)return this._items=i,this._zoffset=t,[{change:"rebuild",index:0}];var n=e+this._zoffset;if(0>n){n=Math.abs(n),this._items=Array(n).concat(this._items),this._zoffset=t;for(var o=0;o<i.length;++o)this._items[e+o+t]=i[o];return[{change:"rebuild",index:0}]}for(e=[],o=n;o<this._items.length&&o-n<i.length;++o)this._items[o]=i[o-n],e.push({change:"update",index:o-this._zoffset,value:i[o-n]});if(n+=i.length,n>this._items.length)for(n-=this._items.length,o=0;n>o;++o){var r=this._items.length;this._items.push(i[o]),e.push({change:"append",index:r-this._zoffset,value:i[o]})}return this._zoffset=t,this._lastTimePointIndex=null,e},TimeIndexes.prototype.addTail=function(e,t){for(var i=t?1:0;i<e.length;i++)this._items.push(e[i]),this._lastTimePointIndex++},TimeIndexes.prototype.valueAt=function(e){return e=this.indexToOffset(e),void 0!==e?this._items[e]:void 0},TimeIndexes.prototype.indexOf=function(e,t){if(t&&e>this._items[this._items.length-1])return this.offsetToIndex(this._items.length-1);for(var i=0;i<this._items.length&&!(e<this._items[i]);++i)if(!(e>this._items[i]))return this.offsetToIndex(i);return t?this.offsetToIndex(i):void 0},TimeIndexes.prototype.offsetToIndex=function(e){return e>=0&&e<this.size()?e-this._zoffset:void 0},TimeIndexes.prototype.indexToOffset=function(e){return e+=this._zoffset,e>=0&&e<this.size()?e:void 0},TimeIndexes.prototype.state=function(){var e={};return e.zoffset=this._zoffset,e.items=this._items,e},TimeIndexes.prototype.restoreState=function(e){e&&(this._zoffset=e.zoffset,this._items=e.items,this._lastTimePointIndex=null)},TimeIndexes.prototype.closestIndexLeft=function(e){var t=this._items;if(t.length&&e===e){var i=t.length-1;if(e>=t[i])return i-this._zoffset;var n=0,o=t[n];if(!(o>e)){if(e==o)return n-this._zoffset;for(;i>n+1;){var o=n+i>>1,r=t[o];if(r>e)i=o;else{if(!(e>r)){if(r===e)return o-this._zoffset;return}n=o}}return n-this._zoffset}}},PlotList.prototype.clear=function(){this._items=[],this._columns=[],this._end=this._start=0,this._shareread=!1},PlotList.prototype.columns=function(){return this._columns},PlotList.prototype.last=function(){return this._items[this._end-this._start-1]},PlotList.prototype.first=function(){return this._items[0]},PlotList.prototype.firstIndex=function(){return this._start},PlotList.prototype.lastIndex=function(){return this._end-this._start-1},PlotList.prototype.size=function(){return this._end-this._start},PlotList.prototype.isEmpty=function(){return 0===this.size()},PlotList.prototype.contains=function(e){return-1!=this._search(e)},PlotList.prototype.valueAt=function(e){return(e=this.search(e))?e.value:void 0},PlotList.prototype.add=function(e,t){if(this._shareread)return TradingView.logDebug("PlotList.add: readonly collection modification attempt"),!1;var i=this._createPair(e,t),n=this._search(e);return 0>n?(n=this._lowerbound(e,-1),this._items.splice(n,0,i),this._start=0,this._end=this._items.length,!0):(this._items[n]=i,!1)};var SEARCH_NEAREST_LEFT=-1,SEARCH_EXACT=0,SEARCH_NEAREST_RIGHT=1;PlotList.prototype.search=function(e,t){var i=this._search(e,t);return 0>i?void 0:{index:this._indexAt(i),value:this._valueAt(i)}},PlotList.prototype.fold=function(e,t){for(var i=t,n=this._start;n<this._end;++n)i=e(this._indexAt(n),this._valueAt(n),i);return i},PlotList.prototype.each=function(e){for(var t=this._start;t<this._end&&!e(this._indexAt(t),this._valueAt(t));++t);},PlotList.prototype.reduce=function(e,t){for(var i=t,n=this._start;n<this._end;++n)i=e(i,this._indexAt(n),this._valueAt(n));return i},PlotList.prototype.range=function(e,t){var i=new PlotList;return i._items=this._items,i._start=this._lowerbound(e),i._end=Math.min(this._lowerbound(t)+1,i._items.length),i._shareread=!0,i},PlotList.prototype.minMaxOnRange=function(e,t,i){for(var n=this._lowerbound(e),o=Math.min(this._lowerbound(t)+1,this._items.length),r=null,s=null,a=0;a<i.length;a++){var l=i[a],n=this._lowerbound(e-l.offset),o=Math.min(this._lowerbound(t-l.offset)+1,this._items.length);for(this._items[o-1]>t-l.offset&&(o=n);o>n;n++){var d=this._items[n].value[l.index];void 0!==d&&null!==d&&((null===r||r>d)&&(r=d),(null==s||d>s)&&(s=d))}void 0!==l.baseValue&&(r=Math.min(l.baseValue,r),s=Math.max(l.baseValue,s))}return{min:r,max:s}},PlotList.prototype.merge=function(e){if(this._shareread)return TradingView.logDebug("PlotList.merge: shared collection modification attempt"),[];for(var t=[],i=0;i<e.length;++i){var n=e[i];this.add(n.index,n.value)?t.push({insert:n}):t.push({update:n})}return t},PlotList.prototype.addTail=function(e,t){var i=0;for(t&&0<this._end-this._start&&(i=1,this._items[this._end-this._start-1].value=e[0].value);i<e.length;++i){var n=e[i];this.add(parseInt(this.last(),10)+1,n.value)}},PlotList.prototype._createPair=function(e,t){var i=new Number(e);return i.value=t,i},PlotList.prototype._valueAt=function(e){return this._items[e].value},PlotList.prototype._length=function(e){return this._items.length},PlotList.prototype._indexAt=function(e){return this._items[e].valueOf()},PlotList.prototype._search=function(e,t){var i=this._bsearch(e);return-1==i&&t?0>t?(i=this._lowerbound(e),i>this._start&&--i,i!=this._end&&this._indexAt(i)<e?i:-1):(i=this._upperbound(e),i!=this._end&&e<this._indexAt(i)?i:-1):i},PlotList.prototype._bsearch=function(e){var t=this._lowerbound(e);return t==this._end||e<this._items[t]?-1:t},PlotList.prototype._lowerbound=function(e){for(var t=this._start,i=this._end-t;i>0;){var n=i>>1,o=t+n;this._items[o]<e?(t=o+1,i-=n+1):i=n}return t},PlotList.prototype._upperbound=function(e){for(var t=this._start,i=this._end-t;i>0;){var n=i>>1,o=t+n;e<this._items[o]?i=n:(t=o+1,i-=n+1)}return t},PlotList.prototype.state=function(){var e={};e.columns=this._columns,e.start=this._start,e.end=this._end,e.shareread=this._shareread,e.data=[];for(var t in this._items)e.data.push({index:new Number(this._items[t]),value:this._items[t].value});return e},PlotList.prototype.restoreState=function(e){if(e){this._columns=e.columns,this._start=e.start,this._end=e.end,this._shareread=e.shareread,this._items=[];for(var t=0;t<e.data.length;t++){var i=new Number(e.data[t].index);i.value=e.data[t].value,this._items.push(i)}}else this.clear()},PlotList.prototype.firstTimeIndex=function(){return this._indexAt(this._start)},PlotList.prototype.lastTimeIndex=function(){return this._indexAt(this._end-1)},StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION=31,StudyMetaInfo.FilledArea={},StudyMetaInfo.FilledArea.TYPE_PLOTS="plot_plot",StudyMetaInfo.FilledArea.TYPE_HLINES="hline_hline",StudyMetaInfo.versionOf=function(e){return e="_metainfoVersion"in e&&isNumber(e._metainfoVersion)?e._metainfoVersion:0,0>e&&console.error("Metainfo format version cannot be negative: "+e),e>StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION&&console.warn("Client doesn't support this version of metainfo format: "+e),e},StudyMetaInfo.parseIdString=function(e){
var t={};if(-1==e.indexOf("@"))t.shortId=e,t.packageId="tv-basicstudies",t.id=e+"@"+t.packageId,t.version=1;else{var i=e.split("@");if(t.shortId=i[0],i=i[1].split("-"),3===i.length)t.packageId=i.slice(0,2).join("-"),t.id=t.shortId+"@"+t.packageId,t.version=i[2];else if(1===i.length&&"decisionbar"===i[0])t.packageId="les-"+i[0],t.id=t.shortId+"@"+t.packageId,t.version=1;else{if(1!==i.length)throw Error("unexpected study id:"+e);t.packageId="tv-"+i[0],t.id=t.shortId+"@"+t.packageId,t.version=1}}return t.fullId=t.id+"-"+t.version,"tv-scripting"===t.packageId?(e=t.shortId,0===e.indexOf("Script$")?(i=e.indexOf("_"),t.productId=i>=0?e.substring(0,i):t.packageId):t.productId=t.packageId):t.productId=t.packageId,t},StudyMetaInfo.getPackageName=function(e){return(/^[^@]+@([^-]+-[^-]+)/.exec(e||"")||[0,"tv-basicstudies"])[1]},StudyMetaInfo.cutFullId=function(e){return e.replace(/(@[^-]+-[^-]+).*$/,"$1")},StudyMetaInfo.cutDollarHash=function(e){var t=e.indexOf("$"),i=e.indexOf("@");return-1==t?e:(t=e.substr(0,t),e=i>=0?e.substr(i):"",t+e)},StudyMetaInfo.prototype.parseValue=function(e,t){return"bool"===e?parseBool(t):t},StudyMetaInfo.prototype.defaultInputs=function(){for(var e=new List,t=0;t<this.inputs.length;t++)e.append(this.inputs[t].defval);return e},StudyMetaInfo.prototype.state=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e],"id"===e&&(t[e]+="-"+this.version));return t},StudyMetaInfo.findStudyMetaInfoByDescription=function(e,t){if(e){for(var i=0;i<e.size();++i)if(e.item(i).description.toLowerCase()===t.toLowerCase())return e.item(i);throw Error("unexpected study id:"+t)}throw Error("There is no studies metainfo")},StudyMetaInfo.findStudyMetaInfo=function(e,t){if(e){for(var i=0;i<e.size();++i)if(e.item(i).id===t)return e.item(i);throw Error("unexpected study id:"+t)}throw Error("There is no studies metainfo")},StudyMetaInfo.removeStudyMetaInfo=function(e,t){if(e){for(var i=0;i<e.size();++i)if(e.item(i).id===t)return e.removeAt(i),defaults.remove("study_"+t),!0;return!1}throw Error("There is no studies metainfo")},StudyMetaInfo.addStudyMetaInfo=function(e,t){var i=new StudyMetaInfo(t);if(assert(!1===StudyMetaInfo.removeStudyMetaInfo(e,i.id),"Study with id="+t.id+" already exists in the model"),e.append(i),t.defaults){var n=TradingView.clone(t.defaults);n.precision="default",defaults.create("study_"+t.id,n)}return i},StudyMetaInfo.addOrReplaceStudyMetaInfo=function(e,t){var i=new StudyMetaInfo(t);if(StudyMetaInfo.removeStudyMetaInfo(e,i.id),e.append(i),t.defaults){var n=TradingView.clone(t.defaults);n.precision="default",defaults.createOrReplace("study_"+t.id,n)}return i},StudyMetaInfo.sortStudiesMetainfo=function(e){e.sort(function(e,t){var i=defaults("study_"+e.id).description,n=defaults("study_"+t.id).description;return n>i?-1:i>n?1:0})},StudyMetaInfo.setStudyHidden=function(e,t){if(!e)throw Error("There is no studies metainfo");for(var i=0;i<e.size();++i)if(e.item(i).id===t)return e.is_hidden_study=!0;return!1},StudyMetaInfo.createMetaInfoStub=function(e,t){return e.scriptIdPart||TVScript.createScriptIdPart(),{isTVScriptStubToCompile:!0,id:TVScript.createScriptStudyId(e.scriptIdPart,t),scriptIdPart:e.scriptIdPart,description:e.scriptName,TVScriptSourceCode:e.scriptSource,version:t}},StudyMetaInfo.replaceWithFullStudyMetaInfoAsync=function(e,t){var i=$.Deferred();if(t.isTVScriptStubToCompile){try{var n=StudyMetaInfo.findStudyMetaInfo(e,t.id);n.isTVScriptStubToCompile||i.resolve(n)}catch(o){}A57.translateScriptAsync(t.TVScriptSourceCode,null,t.scriptIdPart,t.version).done(function(t){t=StudyMetaInfo.addOrReplaceStudyMetaInfo(e,t),i.resolve(t)}).fail(function(n){n=A57.createScriptStub(t.TVScriptSourceCode,t.description,t.scriptIdPart),n=StudyMetaInfo.addOrReplaceStudyMetaInfo(e,n),i.resolve(n)})}else i.resolve(t);return i.promise()},"undefined"!=typeof module&&module&&module.exports&&(module.exports=StudyMetaInfo),StudyMetaInfo.getOrderedInputIds=function(e){var t=[];e=e.inputs;for(var i=0;i<e.length;++i)t.push(e[i].id);return t},TradingView.drawingState=function(){function e(e){return"cursor"===e||"arrow"===e||"dot"===e}var t=null,i=null,n=null,o=new WatchedValue,r=new WatchedValue,s=!1;return{tool:o,cursorTool:r,toolIsCursor:e,resetToCursor:function(e){!e&&t&&t.stayInDrawingMode.value()||this.tool.setValue(this.cursorTool.value())},init:function(){s||(o.setValue(TVSettings.getValue("chart.cursorPreference","cursor")),o.subscribe(function(t){e(t)&&r.setValue(t)},{callWithLast:!0}),r.subscribe(function(e){e&&TVSettings.setValue("chart.cursorPreference",e)}),t=new $52("drawings"),i=new Property,n=new Property,hideMarksOnBars=new Property,i.setValue(!1),n.setValue(!1),hideMarksOnBars.setValue(!1),s=!0)},properties:function(){return t},hideAllDrawings:function(){return i},hideMarksOnBars:function(){return hideMarksOnBars},lockDrawings:function(){return n}}}(),HitTestResult.REGULAR=1,HitTestResult.MOVEPOINT=2,HitTestResult.CHANGEPOINT=3,HitTestResult.CUSTOM=4,HitTestResult.prototype.result=function(){return this._result},HitTestResult.prototype.data=function(){return this._data},HitTestResult.prototype.eraseMarker=function(){return this._eraseMarker},DataSource.prototype.id=function(){return this._id},DataSource.prototype.uniqueId=function(){return this._id},DataSource.prototype.setId=function(e){this._id=e},DataSource.prototype.zorder=function(){return this._zorder},DataSource.prototype.setZorder=function(e){"number"==typeof e&&this._zorder!=e&&(this._zorder=e)},DataSource.prototype.title=function(){throw Error("Implement this fun in a subclass")},DataSource.prototype.priceScale=function(){return this.m_priceScale},DataSource.prototype.setPriceScale=function(e){this.m_priceScale=e},DataSource.prototype.ownerSource=function(){return this._ownerSource},DataSource.prototype.setOwnerSource=function(e){(this._ownerSource=e)&&this.setPriceScale(e.priceScale())},DataSource.prototype.isSavedInChart=function(e){return!0},DataSource.prototype.isSavedInStudyTemplates=function(){return!0},DataSource.prototype.isRemovedByStudyTemplates=function(){return!0},DataSource.prototype.hasContextMenu=function(){return!0},DataSource.prototype.showInObjectTree=function(){return!0},DataSource.prototype.setUserEditEnabled=function(e){this._userEditEnabled=e},DataSource.prototype.userEditEnabled=function(){return this._userEditEnabled},DataSource.prototype.isUserDeletable=function(){return this.userEditEnabled()},DataSource.prototype.canHasAlert=function(){return!1},DataSource.prototype.properties=function(){throw Error("Implement this fun in a subclass")},DataSource.prototype.statusView=function(){return null},DataSource.prototype.dataWindowView=function(){return null},DataSource.prototype.priceAxisViews=function(e,t){return null},DataSource.prototype.updateAllViews=function(){},DataSource.prototype.paneViews=function(e){return null},inherit(PriceDataSource,DataSource),PriceDataSource.prototype.isNoScale=function(){return!!this._isOverlay},PriceDataSource.prototype.base=function(){return 0},PriceDataSource.prototype.formatter=function(){return null},PriceDataSource.prototype.model=function(){return this.D0},PriceDataSource.prototype.priceRange=function(e,t){return null},Property.prototype.merge=function(e){if(null!=e)if(this.isPrimitiveType(e))this._value=e;else if(isArray(e))for(var t=0;t<e.length;t++)this[t]?this[t].merge(e[t]):this.addProperty(t,e[t]);else for(t in e)this[t]?this[t].merge(e[t]):this.addProperty(t,e[t])},Property.prototype.state=function(e){var t=this._value;void 0===t&&(t={});for(var i=0;i<this._childs.length;i++){var n=this._childs[i];if(!e||-1===e.indexOf(n))if(e){for(var o=[],r=0;r<e.length;r++){var s=e[r];s.startsWith(n+".")&&o.push(s.substr(n.length+1))}t[n]=this[n].state(o)}else t[n]=this[n].state()}return t},Property.prototype.isPrimitiveType=function(e){return isNumber(e)||new TypeValidator(String).check(e)||isBoolean(e)?!0:!1},Property.prototype.value=function(){return this._value},Property.prototype.listeners=function(){return this._listeners},Property.prototype.childCount=function(){return this._childs.length},Property.prototype.setValue=function(e,t){(this._value!==e||t)&&(this._value=e,this._listeners.fire(this))},Property.prototype.addProperty=function(e,t){var i=new Property(t);this[e]=i,this._childs.push(e),i.listeners().subscribe(this,Property.prototype.childChanged)},Property.prototype.addChild=function(e,t){this[e]=t,-1==$.inArray(e,this._childs)&&this._childs.push(e),t.listeners().subscribe(this,Property.prototype.childChanged)},Property.prototype.childChanged=function(e,t){this.listeners().fire(this)},Property.prototype.subscribe=function(e,t){this.listeners().subscribe(e,t)},Property.prototype.unsubscribe=function(e,t){this.listeners().unsubscribe(e,t)},inherit($52,Property),$52._saveDefaults=!1,TradingView.saveDefaultProperties=function(e){$52._saveDefaults=e},$52.prototype.addExclusion=function(e){this._exclusions.push(e)},$52.prototype.restoreFactoryDefaults=function(){var e={};this._defaultName.startsWith("study_")&&(e=TradingView.clone(factoryDefaults("study")));var t=TradingView.clone(factoryDefaults(this._defaultName));this._defaultName.startsWith("study_")&&t.inputs&&delete t.inputs.symbol,"linetoolicon"===this._defaultName&&(t.icon=defaults(this._defaultName).icon),~"linetooltext linetooltextabsolute linetoolnote linetoolnoteabsolute linetoolcallout linetoolballoon linetoolarrowmark linetoolarrowmarkleft linetoolarrowmarkup linetoolarrowmarkright linetoolarrowmarkdown linetoolhorzline linetoolhorzray".split(" ").indexOf(this._defaultName)&&delete t.text,TradingView.merge(e,t),this.merge(e),this._defaultName.startsWith("study_")||saveDefaults(this._defaultName,this.state(this._exclusions)),this.listeners().fire(this)},$52.prototype.cleanupFactoryDefaults=function(){saveDefaults(this._defaultName,{}),this.listeners().fire(this)},$52.prototype.onPropertyChanged=function(){$52._saveDefaults&&!this._defaultName.startsWith("study_")&&this.saveDefaults()},$52.prototype.saveDefaults=function(){saveDefaults(this._defaultName,this.state(this._exclusions))},defaults.create=function(e,t){if(t){var i=StudyMetaInfo.parseIdString(e),n=factoryDefaults(i.id);defaultProperties[i.id]=$.extend(t,n)}},defaults.createOrReplace=function(e,t){if(t){var i=StudyMetaInfo.parseIdString(e);defaultProperties[i.id]=t}},defaults.remove=function(e){defaultProperties[e]=void 0},PriceFormatter.prototype.isFractional=function(){return this._fractional},PriceFormatter.prototype.decimalSign=".",PriceFormatter.prototype.decimalSignFractional="'",PriceFormatter.prototype.southandDelimeter="`",PriceFormatter.prototype.fullPrecision=!1,PriceFormatter.prototype.calculateDecimal=function(){if(this._fractionalLength=0,0<this._priceScale&&0<this._minMove){var e=this._priceScale;for(this._minMove2&&(e/=this._minMove2);e>1;)e/=10,this._fractionalLength++}},PriceFormatter.prototype.format=function(e,t){var i="";return 0>e?(i=!0===t?"−":"-",e=-e):e&&!0===t&&(i="+"),this._fractional?i+this.formatAsFractional(e):i+this.formatAsDecimal(e)},PriceFormatter.prototype.formatAsDecimal=function(e){var t;t=this._fractional?Math.pow(10,this._fractionalLength||0):this._priceScale/this._minMove;var i=Math.floor(e);return e=+(Math.round(e*t)-i*t).toFixed(this._fractionalLength),e>=t&&(e-=t,i+=1),t=1===t?"":this.decimalSign+numberToStringWithLeadingZero(e.toFixed(this._fractionalLength)*this._minMove,this._fractionalLength),i.toString()+t},PriceFormatter.prototype.formatAsFractional=function(e){var t=this._priceScale/this._minMove,i=Math.floor(e);if(e=Math.round(e*t)-i*t,e===t&&(e=0,i+=1),this._minMove2){var t=["0","5"],n=["0","2","5","7"],o=e%this._minMove2;e=(e-o)/this._minMove2,e=numberToStringWithLeadingZero(e,this._fractionalLength)+this.decimalSignFractional+(2===this._minMove2?t[o]:n[o])}else e=numberToStringWithLeadingZero(e*this._minMove,this._fractionalLength);return i.toString()+this.decimalSignFractional+e},inherit(PercentageFormatter,PriceFormatter),PercentageFormatter.prototype.format=function(e,t){return PriceFormatter.prototype.format.call(this,e,t)+"%"},DateFormatter.prototype.format=function(e){return numberToStringWithLeadingZero(e.getUTCFullYear(),4)+"-"+numberToStringWithLeadingZero(e.getUTCMonth()+1,2)+"-"+numberToStringWithLeadingZero(e.getUTCDate(),2)},TimeFormatter.prototype.format=function(e){return this._format_str.replace("%h",numberToStringWithLeadingZero(e.getUTCHours(),2)).replace("%m",numberToStringWithLeadingZero(e.getUTCMinutes(),2)).replace("%s",numberToStringWithLeadingZero(e.getUTCSeconds(),2))},DateTimeFormatter.prototype.format=function(e){var t=(new DateFormatter).format(e);return this._dwm||(t+=" "+(new TimeFormatter).format(e)),t},VolumeFormatter.prototype.format=function(e){function t(e){return i._fractionalValues?(e.toFixed(i._precision)+"").replace(/\.?0+$/,""):e}if(!isNumber(e))return"---";var i=this,n="";return 0>e&&(n="-",e=-e),e>=1e100?"N/A":((!this._fractionalValues||e>=995)&&(e=Math.round(e)),995>e?n+t(e):999995>e?n+t(e/1e3)+"K":999999995>e?(e=1e3*Math.round(e/1e3),n+t(e/1e6)+"M"):(e=1e6*Math.round(e/1e6),n+t(e/1e9)+"B"))},TimeSpanFormatter.prototype.format=function(e){var t=0>e;e=Math.abs(e);var i=Math.floor(e/86400);e-=86400*i;var n=Math.floor(e/3600);e-=3600*n;var o=Math.floor(e/60);e-=60*o;var r="";return i&&(r+=i+" "+$.t("d",{context:"dates"})+" "),n&&(r+=n+" "+$.t("h",{context:"dates"})+" "),o&&(r+=o+" "+$.t("m",{context:"dates"})+" "),e&&(r+=e+" "+$.t("s",{context:"dates"})+" "),t&&(r="-"+r),r.trimmed()},PriceColorer.formatSign=function(e){return 0==e?"#5A5D66":e>0?"#27AC66":"#DA563E"},PriceColorer.formatDiff=function(e,t){PriceColorer.signFormat(t-e)},PriceColorer.prototype.format=function(e){try{return null===this._prev?PriceColorer.formatSign(e):PriceColorer.formatDiff(this._prev,e)}finally{this._prev=e}},FormattedLabelsCache.prototype.format=function(e){if(this._cache[e])return this._cache[e].string;if(this._actualSize==this._maxSize){var t=this._tick2Labels[this._oldestTick];delete this._tick2Labels[this._oldestTick],delete this._cache[t],this._oldestTick++,this._actualSize--}return t=this._formatter(e),this._cache[e]={string:t,tick:this._usageTick},this._tick2Labels[this._usageTick]=e,this._actualSize++,this._usageTick++,t},AbstractBarColorer.prototype.barStyle=function(e,t,i){for(var n={},o=this.backColorers.length-1;o>=0;o--)this.backColorers[o].applyBarStyle(e,t,n,i);return this.applyBarStyle(e,t,n,i),n},AbstractBarColorer.prototype.pushBackBarColorer=function(e){this.backColorers.push(e)},AbstractBarColorer.prototype.applyBarStyle=function(e,t,i){throw Error("This function is supposed to be reimplemented in a subclass")},inherit(SeriesBarColorer,AbstractBarColorer),SeriesBarColorer.prototype.applyBarStyle=function(e,t,i,n){i||(i={}),i.barColor=null,i.barBorderColor=null,i.isBarHollow=null,i.isBarUp=null,i.upColor=null,i.downColor=null,i.isTwoColorBar=null;var o=this._series.properties();switch(o.style.value()){case TradingView.Series.STYLE_LINE:i.barColor=o.lineStyle.color.value();break;case TradingView.Series.STYLE_AREA:i.barColor=o.areaStyle.linecolor.value();break;case TradingView.Series.STYLE_BARS:var r=o.barStyle.upColor.value(),s=o.barStyle.downColor.value(),a=r,l=s,d=this.findBar(e,!1,n);o.barStyle.barColorsOnPrevClose.value()?(t=this.findPrevBar(e,!1,n),i.barColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?a:l):(i.barColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?a:l);break;case TradingView.Series.STYLE_CANDLES:r=o.candleStyle.upColor.value(),s=o.candleStyle.downColor.value(),a=o.candleStyle.borderUpColor?o.candleStyle.borderUpColor.value():o.candleStyle.borderColor.value(),l=o.candleStyle.borderDownColor?o.candleStyle.borderDownColor.value():o.candleStyle.borderColor.value(),d=this.findBar(e,!1,n),o.candleStyle.barColorsOnPrevClose.value()?(t=this.findPrevBar(e,!1,n),i.barColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?a:l):(i.barColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?a:l);break;case TradingView.Series.STYLE_HOLLOW_CANDLES:r=o.hollowCandleStyle.upColor.value(),s=o.hollowCandleStyle.downColor.value(),a=o.hollowCandleStyle.borderUpColor?o.hollowCandleStyle.borderUpColor.value():o.hollowCandleStyle.borderColor.value(),l=o.hollowCandleStyle.borderDownColor?o.hollowCandleStyle.borderDownColor.value():o.hollowCandleStyle.borderColor.value(),d=this.findBar(e,!1,n),t=this.findPrevBar(e,!1,n),t[CLOSE_PLOT]<=d[CLOSE_PLOT]?(i.barColor=r,i.barBorderColor=a):(i.barColor=s,i.barBorderColor=l),i.isBarHollow=d[OPEN_PLOT]<=d[CLOSE_PLOT]?!0:!1;break;case TradingView.Series.STYLE_HEIKEN_ASHI:r=o.haStyle.upColor.value(),s=o.haStyle.downColor.value(),a=o.haStyle.borderUpColor.value(),l=o.haStyle.borderDownColor.value(),d=this.findBar(e,t,n),o.haStyle.barColorsOnPrevClose.value()?(t=this.findPrevBar(e,t,n),i.barColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=t[CLOSE_PLOT]<=d[CLOSE_PLOT]?a:l):(i.barColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?r:s,i.barBorderColor=d[OPEN_PLOT]<=d[CLOSE_PLOT]?a:l);break;case TradingView.Series.STYLE_RENKO:d=this.findBar(e,t,n),d=d[OPEN_PLOT]<=d[CLOSE_PLOT],r=t?o.renkoStyle.upColorProjection.value():o.renkoStyle.upColor.value(),s=t?o.renkoStyle.downColorProjection.value():o.renkoStyle.downColor.value(),a=t?o.renkoStyle.borderUpColorProjection.value():o.renkoStyle.borderUpColor.value(),l=t?o.renkoStyle.borderDownColorProjection.value():o.renkoStyle.borderDownColor.value(),i.barColor=d?r:s,i.barBorderColor=d?a:l,i.isBarUp=d;break;case TradingView.Series.STYLE_PB:d=this.findBar(e,t,n),d=d[OPEN_PLOT]<=d[CLOSE_PLOT],r=t?o.pbStyle.upColorProjection.value():o.pbStyle.upColor.value(),s=t?o.pbStyle.downColorProjection.value():o.pbStyle.downColor.value(),a=t?o.pbStyle.borderUpColorProjection.value():o.pbStyle.borderUpColor.value(),l=t?o.pbStyle.borderDownColorProjection.value():o.pbStyle.borderDownColor.value(),i.barColor=d?r:s,i.barBorderColor=d?a:l,i.isBarUp=d;break;case TradingView.Series.STYLE_KAGI:i.upColor=t?o.kagiStyle.upColorProjection.value():o.kagiStyle.upColor.value(),i.downColor=t?o.kagiStyle.downColorProjection.value():o.kagiStyle.downColor.value(),r=null,d=this.findBar(e,t,n),d[LOW_PLOT]<d[ADT_PLOT]&&d[ADT_PLOT]<d[HIGH_PLOT]?(r=d[OPEN_PLOT]<=d[CLOSE_PLOT],i.isTwoColorBar=!0):(r=d[OPEN_PLOT]<=d[CLOSE_PLOT]?d[OPEN_PLOT]==d[ADT_PLOT]?!0:!1:d[OPEN_PLOT]==d[ADT_PLOT]?!1:!0,i.isTwoColorBar=!1),i.barColor=r?i.upColor:i.downColor,i.isBarUp=d[OPEN_PLOT]<=d[CLOSE_PLOT];break;case TradingView.Series.STYLE_PNF:d=this.findBar(e,t,n),d=0<d[ADT_PLOT],r=t?o.pnfStyle.upColorProjection.value():o.pnfStyle.upColor.value(),s=t?o.pnfStyle.downColorProjection.value():o.pnfStyle.downColor.value(),i.isBarUp=d,i.barColor=d?r:s}return i},SeriesBarColorer.prototype.getSeriesBars=function(e){return e?this._series.nsBars():this._series.bars()},SeriesBarColorer.prototype._findBarFieldValue=function(e,t,i){return e=this.getSeriesBars(i).valueAt(e),void 0!==e?e[t]:void 0},SeriesBarColorer.prototype.findBar=function(e,t,i){return i?i.value:this.getSeriesBars(t).valueAt(e)||[]},SeriesBarColorer.prototype.findPrevBar=function(e,t,i){return i?i.previousValue||[]:(e=this._series.bars()._search(e,SEARCH_EXACT),e>0?this._series.bars()._valueAt(e-1):[])},inherit(StudyBarColorer,AbstractBarColorer),StudyBarColorer.prototype.applyBarStyle=function(e,t,i){if(i||(i={}),t)return i;if(t=this.D1.properties(),!t.visible.value())return i;var n=this.D1.metaInfo(),o=this.D1.data();if(!o||0==o.size())return i;var r=this.D1.offset(n.plots[this._plotIndex].id);return(e=o.valueAt(e-r))?(e=e[this._plotIndex+1],null==e?i:(e=Math.round(e),o=n.plots[this._plotIndex].palette,t=t.palettes[o].colors[n.palettes[o].valToIndex?n.palettes[o].valToIndex[e]:e].color.value(),i.barColor=t,i.upColor=t.color,i.downColor=t.color,i)):i},BarItem.prototype.setTime=function(e){isNumber(e)?this.time=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect time")},BarItem.prototype.setOpen=function(e){isNumber(e)?this.open=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect open")},BarItem.prototype.setHigh=function(e){isNumber(e)?this.high=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect high")},BarItem.prototype.setLow=function(e){isNumber(e)?this.low=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect low")},BarItem.prototype.setClose=function(e){isNumber(e)?this.close=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect close")},BarItem.prototype.setAdditionalPrice=function(e){isNumber(e)?this.additionalPrice=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect additionalPrice")},BarItem.prototype.setAdditionalNum=function(e){isNumber(e)?this.additionalNum=e:TradingView.logDebug("BarItem.setAdditionalNum: incorrect additionalNum")},BarsRange.prototype.isEmpty=function(){return null===this.m_firstBar||null===this.m_lastBar},BarsRange.prototype.clone=function(){return new BarsRange(this.m_firstBar,this.m_lastBar)},BarsRange.prototype.firstBar=function(){return this.m_firstBar},BarsRange.prototype.lastBar=function(){return this.m_lastBar},BarsRange.prototype.count=function(){return this.m_lastBar-this.m_firstBar+1},BarsRange.prototype.resizeRight=function(e){!isInteger(e)||0>e?TradingView.logDebug("BarsRange: incorrect newWidth"):this.m_firstBar=this.m_lastBar-e+1},BarsRange.prototype.shift=function(e){isNumber(e)?(this.m_firstBar=Math.round(this.m_firstBar+e),this.m_lastBar=Math.round(this.m_lastBar+e)):TradingView.logDebug("BarsRange.shift: incorrect coeff")},BarsRange.prototype.contains=function(e){return this.m_firstBar<=e&&this.m_lastBar>=e},A47=function(e,t,i){this._magnetProperty=e,this._timeScale=t},A47.prototype.align=function(e,t,i){var n=i.defaultPriceScale(),o=n.priceToCoordinate(e);if(!this._magnetProperty.value())return e;n=n.D19(),i=null;for(var r=0;r<n.size();r++)if(n.item(r)instanceof TradingView.Series){i=n.item(r);break}if(i&&(n=i.bars(),n.contains(t)&&(t=n.valueAt(t),t=[t[OPEN_PLOT],t[HIGH_PLOT],t[LOW_PLOT],t[CLOSE_PLOT]],n=i.priceScale(),!n.isEmpty()))){var s=[];if(n.isPercent())for(i=i.firstValue(),r=0;r<t.length;r++)t[r]=n.priceRange().convertToPercent(t[r],i);for(r=0;r<t.length;r++)s.push({y:n.priceToCoordinate(t[r]),price:t[r]});s.sort(function(e,t){var i=Math.abs(e.y-o),n=Math.abs(t.y-o);return i-n}),i=s[0],50>Math.abs(i.y-o)&&(e=i.price)}return e},A77=function(){function e(){if(i){var e=i;i=null,e.isEmpty()||t(e)}}function t(e){i?i.addCommand(e):(o.clear(),n.push(e))}var i=null,n=new UndoStack,o=new UndoStack;return{beginUndoMacro:function(t){i&&e(),i=new UndoMacroCommand(t)},endUndoMacro:e,undo:function(){if(n.isEmpty())return!1;var e=n.pop();return e.undo(),o.push(e),!0},redo:function(){if(o.isEmpty())return!1;var e=o.pop();return e.redo(),n.push(e),!0},pushUndoCommand:t,createUndoCheckpoint:function(){return{lastActualCommand:n.isEmpty()?null:n.head()}},undoToCheckpoint:function(e){for(;!n.isEmpty()&&e.lastActualCommand!==n.head();)n.pop().undo();o.clear()},undoStack:function(){return n},redoStack:function(){return o},clearStack:function(){n.clear(),o.clear()}}}(),A77.setChartLayout=function(e,t){if(e.layout.value()===t)return!1;var i=new SetChartLayoutCommand(e,t);i.redo(),this.pushUndoCommand(i)},inherit(SetChartLayoutCommand,UndoCommand),SetChartLayoutCommand.prototype.redo=function(){this.D5.layout.setValue(this._newLayoutId)},SetChartLayoutCommand.prototype.undo=function(){this.D5.layout.setValue(this._oldLayoutId)},inherit(W78,EventEmitter),W78.prototype.version=function(){return this.m_model._version},W78.prototype.onData=function(e){switch(e.method){case"timescale_update":e=e.params,this.m_model.updateTimeScale(e.index,e.zoffset,e.changes,e.marks,e.clear)}},W78.prototype.paneForSource=function(e){return this.m_model.paneForSource(e)},W78.prototype.createPane=function(e){return this.m_model.createPane(e)},W78.prototype.dumpViews=function(){return this.m_model.dumpViews()},W78.prototype.readOnly=function(){return this.m_model.readOnly()},W78.prototype.restart=function(){this.m_model.restart()},W78.prototype.disconnect=function(){this.m_model.disconnect()},W78.prototype.studiesMetaData=function(){return this.m_model.studiesMetaData()},W78.prototype.studyVersioning=function(){return this.m_model.studyVersioning()},W78.prototype.chartModel=function(){return this.m_model},W78.prototype.undoStack=A77.undoStack,W78.prototype.redoStack=A77.redoStack,W78.prototype.undo=A77.undo,W78.prototype.redo=A77.redo,W78.prototype.pushUndoCommand=A77.pushUndoCommand,W78.prototype.startScalePrice=function(e,t,i){this.pushUndoCommand(new W89(this.m_model,e,t,t.state())),this.chartModel().startScalePrice(e,t,i)},W78.prototype.scalePriceTo=function(e,t,i){this.chartModel().scalePriceTo(e,t,i)},W78.prototype.endScalePrice=function(e,t){this.chartModel().endScalePrice(e,t)},W78.prototype.startScrollPrice=function(e,t,i){t.isAutoScale()||(this._initialPriceScrollState=t.state(),this._initialPriceScrollPos=i,this.chartModel().startScrollPrice(e,t,i))},W78.prototype.scrollPriceTo=function(e,t,i){t.isAutoScale()||(this._initialPriceScrollPos&&20<Math.abs(this._initialPriceScrollPos-i)&&(this.pushUndoCommand(new W89(this.m_model,e,t,this._initialPriceScrollState)),delete this._initialPriceScrollState,delete this._initialPriceScrollPos),this.chartModel().scrollPriceTo(e,t,i))},W78.prototype.endScrollPrice=function(e,t){t.isAutoScale()||(delete this._initialPriceScrollState,delete this._initialPriceScrollPos,this.chartModel().endScrollPrice(e,t))},W78.prototype.setPriceAutoScale=function(e,t,i){this.pushUndoCommand(new W89(this.m_model,e,t,t.state())),this.chartModel().setPriceAutoScale(e,t,i)},W78.prototype.resetPriceScale=function(e,t){this.pushUndoCommand(new W89(this.m_model,e,t,t.state())),this.chartModel().resetPriceScale(e,t)},W78.prototype.startScaleTime=function(e){this.pushUndoCommand(new W94(this.m_model,this.m_model.timeScale().state(),"scale time")),this.chartModel().startScaleTime(e)},W78.prototype.scaleTimeTo=function(e){this.chartModel().scaleTimeTo(e)},W78.prototype.endScaleTime=function(){this.chartModel().endScaleTime()},W78.prototype.startScrollTime=function(e){this._initialTimeScrollState=this.m_model.timeScale().state(),this._initialTimeScrollPos=e,this.chartModel().startScrollTime(e)},W78.prototype.scrollTimeTo=function(e){this._initialTimeScrollPos&&20<Math.abs(e-this._initialTimeScrollPos)&&(this.pushUndoCommand(new W94(this.m_model,this._initialTimeScrollState,"scroll time")),delete this._initialTimeScrollPos,delete this._initialTimeScrollState),this.chartModel().scrollTimeTo(e)},W78.prototype.endScrollTime=function(){this.chartModel().endScrollTime(),delete this._initialTimeScrollPos,delete this._initialTimeScrollState},W78.prototype.resetTimeScale=function(){this.pushUndoCommand(new W94(this.m_model,this.m_model.timeScale().state())),this.chartModel().resetTimeScale()},W78.prototype.canZoomIn=function(){return this.chartModel().canZoomIn()},W78.prototype.canZoomOut=function(){return this.chartModel().canZoomOut()},W78.prototype.setWidth=function(e){this.m_model.setWidth(e)},W78.prototype.setPaneHeight=function(e,t){this.m_model.setPaneHeight(e,t)},W78.prototype.gridSource=function(){return this.m_model.gridSource()},W78.prototype.watermarkSource=function(){return this.m_model.watermarkSource()},W78.prototype.addAlertsSource=function(e){return this.m_model.addAlertsSource(e)},W78.prototype.alertsSources=function(){return this.m_model.alertsSources()},W78.prototype.publishedChartsTimelineSource=function(){return this.m_model.publishedChartsTimelineSource()},W78.prototype.barsMarksSources=function(){return this.m_model.barsMarksSources()},W78.prototype.crossHairSource=function(){return this.m_model.crossHairSource()},W78.prototype.model=function(){return this.m_model},W78.prototype.mainSeries=function(){return this.m_model.m_mainSeries},W78.prototype.panes=function(){return this.m_model.m_panes},W78.prototype.timeScale=function(){return this.m_model.timeScale()},W78.prototype.setSelectedSource=function(e,t){this.m_model.setSelectedSource(e,t)},W78.prototype.setHoveredSource=function(e,t){this.m_model.setHoveredSource(e,t)},W78.prototype.selectedSource=function(){return this.m_model.selectedSource()},W78.prototype.onSelectedSourceChanged=function(){return this.m_model.onSelectedSourceChanged()},W78.prototype.hoveredSource=function(){return this.m_model.hoveredSource()},W78.prototype.D20=function(e){this.m_model.D20(e)},W78.prototype.setCurrentPosition=function(e,t,i,n){this.m_model.setCurrentPosition(e,t,i,n)},W78.prototype.modifySeries=function(e,t,i){e=new W86(this.m_model,e,t,i),this.pushUndoCommand(e),e.redo()},W78.prototype.insertStudy=function(e,t,i){if(this.model()._chartApi._chartApi.isCanCreateStudy()){if(!(TradingView.D18("indicators_limit")&&!user.is_pro&&this.m_model.countUserStudies()>=A7.FREE_STUDY_LIMIT))return e=new InsertStudyCommand(this.m_model,e,t,i),this.pushUndoCommand(e),e.redo();A83.showGoProDialog({feature:"studyLimit"})}else A83.showNotice("Error","Exceeded the limit of studies")},W78.prototype.setProperty=function(e,t,i){e&&e.value()!==t&&(e=new SetPropertyCommand(e,t,i,this.m_model),this.pushUndoCommand(e),e.redo(),this.emitEvent("setProperty"))},W78.prototype.setPercentProperty=function(e,t,i,n){e.value()!==t&&(e=new SetPercentagePropertyCommand(e,t,i,n,this.m_model),this.pushUndoCommand(e),e.redo())},W78.prototype.setLogProperty=function(e,t,i,n){e.value()!==t&&(e=new SetLogPropertyCommand(e,t,i,n,this.m_model),this.pushUndoCommand(e),e.redo())},W78.prototype.setAutoScaleProperty=function(e,t,i,n){e.value()!==t&&(e=new SetAutoScalePropertyCommand(e,t,i,n,this.m_model),this.pushUndoCommand(e),e.redo())},W78.prototype.setChartStyleProperty=function(e,t,i){e.value()!==t&&(e=new SetChartStyleCommand(e,t,this.mainSeries(),i,this.m_model,this.D4),this.pushUndoCommand(e),e.redo(),this.emitEvent("setChartStyleProperty"))},W78.prototype.setLockScaleProperty=function(e,t,i,n){e.value()!==t&&(e=new SetLockScaleCommand(e,t,i,n,this.m_model),this.pushUndoCommand(e),e.redo())},W78.prototype.setScreenChartProperty=function(e,t,i,n,o){(o||e.value()!==t)&&(e=new W92(n,e,t,i,o),this.pushUndoCommand(e),e.redo())},W78.prototype.beginUndoMacro=A77.beginUndoMacro,W78.prototype.endUndoMacro=A77.endUndoMacro,W78.prototype.createUndoCheckpoint=A77.createUndoCheckpoint,W78.prototype.undoToCheckpoint=A77.undoToCheckpoint,W78.prototype.removeSource=function(e){if(e.isUserDeletable()){var t=new RemoveSourceCommand(this.m_model,e);this.pushUndoCommand(t),t.redo(),this.emitEvent("removeSource",[e])}},W78.prototype.removeSelectedSource=function(){var e=this.m_model.selectedSource();if(e&&e.isUserDeletable()){this.setSelectedSource(null);var t=new RemoveSourceCommand(this.m_model,e);this.pushUndoCommand(t),t.redo(),this.emitEvent("removeSource",[e])}},W78.prototype.move=function(e,t,i){var n=this.m_model.paneForSource(e);t=new W88(this.m_model,e,n,t,i),this.pushUndoCommand(t),t.redo(),this.emitEvent("moveSource",[e])},W78.prototype.createLineTool=function(e,t,i,n){return"LineToolRegressionTrend"!=i||this.model()._chartApi._chartApi.isCanCreateStudy()?(i=this.m_model.createLineTool(e,t,i,n),this._createLineCommand=new W83(this.m_model,i,e,t),this.m_model.lineBeingCreated()||(this.pushUndoCommand(this._createLineCommand),delete this._createLineCommand),i):void A83.showNotice("Error","Exceeded the limit of studies")},W78.prototype.lineBeingCreated=function(){return this.m_model.lineBeingCreated()},W78.prototype.paneBeingCreatedLineOn=function(){return this.m_model.paneBeingCreatedLineOn()},W78.prototype.coninueCreatingLine=function(e,t){this.m_model.lineBeingCreated(),this.m_model.paneBeingCreatedLineOn();var i=this.m_model.coninueCreatingLine(e,t);return this._createLineCommand.coninueCreatingLine(e,t),i&&(this.pushUndoCommand(this._createLineCommand),delete this._createLineCommand),i},W78.prototype.cancelCreatingLine=function(){this.m_model.cancelCreatingLine()},W78.prototype.lineCancelled=function(){
return this.m_model.lineCancelled()},W78.prototype.startChangingLinetool=function(e,t,i,n){this._currentLineChangeCommand=new W80(this.m_model,e,i,n),this.m_model.startChangingLinetool(e,t,i,n)},W78.prototype.lineBeingEdited=function(){return this.m_model.lineBeingEdited()},W78.prototype.changeLinePoint=function(e,t){this._currentLineChangeCommand.setPoint(e,t),this.m_model.changeLinePoint(e,t)},W78.prototype.endChangingLinetool=function(){this.m_model.endChangingLinetool(),this._currentLineChangeCommand.endChanging(),this.pushUndoCommand(this._currentLineChangeCommand),this._currentLineChangeCommand=null},W78.prototype.startMovingSource=function(e,t,i){this._currentLineMoveCommand=new W87(this.m_model,e,t,i),this.m_model.startMovingSource(e,t,i)},W78.prototype.sourceBeingMoved=function(){return this.m_model.sourceBeingMoved()},W78.prototype.moveSource=function(e){this._currentLineMoveCommand.setPoint(e),this.m_model.moveSource(e)},W78.prototype.endMovingSource=function(){this.m_model.endMovingSource(),this.pushUndoCommand(this._currentLineMoveCommand),this._currentLineChangeCommand=null},W78.prototype.D19=function(){return this.m_model.D19()},W78.prototype.state=function(e){return this.m_model.state(e)},W78.prototype.asyncState=function(e){return this.m_model.asyncState(e)},W78.prototype.restoreState=function(e,t){this.m_model.restoreState(e,t)},W78.prototype.calculateDefaultTags=function(){return this.m_model.calculateDefaultTags()},W78.prototype.onTagsChanged=function(){return this.m_model.onTagsChanged()},W78.prototype.changeZOrder=function(e,t){var i=new ChangeZOrderCommand(this.m_model,e,t);this.pushUndoCommand(i),i.redo(),this.emitEvent("changeZOrder",[e])},W78.prototype.sendToBack=function(e){var t=new SendToBackCommand(this.m_model,e);this.pushUndoCommand(t),t.redo(),this.emitEvent("changeZOrder",[e])},W78.prototype.bringToFront=function(e){var t=new BringToFrontCommand(this.m_model,e);this.pushUndoCommand(t),t.redo(),this.emitEvent("changeZOrder",[e])},W78.prototype.removeAllStudies=function(){this.beginUndoMacro("remove all studies");for(var e=this.m_model.D19(),t=0;t<e.size();t++){var i=e.item(t);isInherited(i.constructor,TradingView.Study)&&i.removeByRemoveAllStudies()&&this.removeSource(i)}this.endUndoMacro()},W78.prototype.removeAllDrawingTools=function(e){this.beginUndoMacro("remove all drawing tools");for(var t=this.m_model.D19(),i=0;i<t.size();i++){var n=t.item(i);isInherited(n.constructor,W47)&&n.isActualSymbol()&&n.isUserDeletable()&&(e&&e!=n._constructor||this.removeSource(n))}this.endUndoMacro()},W78.prototype.moveDown=function(){try{this.beginUndoMacro("Move Down")}catch(e){return}var t=this,i=this.m_model.mainSeries(),n=this.m_model.paneForSource(i),o=n.priceScaleForSource(i);o.setAutoScale(!1),i=o.height(),TradingView.animate(i/5,function(e){t.startScrollPrice(n,o,0),t.scrollPriceTo(n,o,e),t.endScrollPrice(n,o)},function(){t.endUndoMacro()})},W78.prototype.moveUp=function(){try{this.beginUndoMacro("Move Up")}catch(e){return}var t=this,i=this.m_model.mainSeries();pane=this.m_model.paneForSource(i),scale=pane.priceScaleForSource(i),scale.setAutoScale(!1),i=scale.height(),TradingView.animate(i/5,function(e){t.startScrollPrice(pane,scale,e),t.scrollPriceTo(pane,scale,0),t.endScrollPrice(pane,scale)},function(){t.endUndoMacro()})},W78.prototype.moveLeft=function(){try{this.beginUndoMacro("Move Left")}catch(e){return}var t=this.m_model.timeScale().width(),i=this;TradingView.animate(t/5,function(e){i.startScrollTime(e),i.scrollTimeTo(0),i.endScrollTime()},function(){i.endUndoMacro()})},W78.prototype.moveRight=function(){try{this.beginUndoMacro("Move Right")}catch(e){return}var t=this.m_model.timeScale().width(),i=this;TradingView.animate(t/5,function(e){i.startScrollTime(0),i.scrollTimeTo(e),i.endScrollTime()},function(){i.endUndoMacro()})},W78.prototype.scrollChart=function(e){this.startScrollTime(0),this.scrollTimeTo(e),this.endScrollTime()},W78.prototype.scrollChartByBar=function(e){e*=this.m_model.timeScale().barSpacing(),this.startScrollTime(0),this.scrollTimeTo(e),this.endScrollTime()},W78.prototype.zoomIn=function(e,t){var i=this.m_model.timeScale().width(),n=this;if(t=t||1,this.canZoomIn())if(e){var i=t*i/10,o=(e+1)/2*i;this.startScaleTime(i),this.scaleTimeTo(0),this.endScaleTime(),this.startScrollTime(0),this.scrollTimeTo(i-o),this.endScrollTime(),this._onSimpleZoomIn.fire()}else{try{this.beginUndoMacro("Zoom In")}catch(r){return}TradingView.animate(i/5,function(e){n.startScaleTime(e),n.scaleTimeTo(0),n.endScaleTime()},function(){n.endUndoMacro(),n._onSimpleZoomIn.fire()})}},W78.prototype.zoomOut=function(e,t){var i=this.m_model.timeScale().width(),n=this;if(t=t||1,this.canZoomOut())if(e)this.startScaleTime(0),this.scaleTimeTo(t*i/10),this.endScaleTime(),this.startScrollTime(t*(i/20-i/20*e)),this.scrollTimeTo(0),this.endScrollTime(),this._onSimpleZoomOut.fire();else{try{this.beginUndoMacro("Zoom Out")}catch(o){return}TradingView.animate(i/5,function(e){n.startScaleTime(0),n.scaleTimeTo(e),n.endScaleTime()},function(){n.endUndoMacro(),n._onSimpleZoomOut.fire()})}},W78.prototype.resetScales=function(){this.beginUndoMacro("Reset scales"),this.resetTimeScale();for(var e=0;e<this.panes().size();e++){var t=this.panes().item(e);this.resetPriceScale(t,t.leftPriceScale()),this.resetPriceScale(t,t.rightPriceScale())}this.endUndoMacro(),this.m_model.recalculateAllPanes()},W78.prototype.zoomToViewport=function(e,t,i,n,o){e=new ZoomCommand(this.m_model,e,t,i,n,o),e=new W95(e,this.m_zoomStack,!0),e.redo(),this.pushUndoCommand(e)},W78.prototype.zoomFromViewport=function(){var e=new W95(this.m_zoomStack.head(),this.m_zoomStack,!1);e.redo(),this.pushUndoCommand(e)},W78.prototype.zoomStack=function(){return this.m_zoomStack},W78.prototype.addPaneStretchFactorUndoCommand=function(e,t,i,n){e=new W91(this.m_model,e,t,i,n),this.pushUndoCommand(e)},W78.prototype.restoreFactoryDefaults=function(e){e=new W90(this.m_model,e),e.redo(),this.pushUndoCommand(e)},W78.prototype.chartLoadTheme=function(e,t){var i=new W81(e,t);i.redo(),this.pushUndoCommand(i)},W78.prototype.drawingLoadTemplate=function(e,t){var i=new W84(e,t);i.redo(),this.pushUndoCommand(i)},W78.prototype.studyLoadTemplate=function(e,t,i,n){e=new W93(e,t,i,n),e.redo(),this.pushUndoCommand(e)},W78.prototype.onSimpleZoomIn=function(){return this._onSimpleZoomIn},W78.prototype.onSimpleZoomOut=function(){return this._onSimpleZoomOut},W78.prototype.loadRange=function(e){e.res!==this.m_model.mainSeries().properties().interval.value()?(this.m_model.mainSeries()._pendingInterval=e.val,this.setProperty(this.m_model.mainSeries().properties().interval,e.res,"Change date range")):this.m_model.mainSeries().loadDataTo(e.val)},W78.prototype.cloneLineTool=function(e){e=new W82(this.m_model,e),e.redo(),this.pushUndoCommand(e),this.emitEvent("cloneLineTool")},W78.prototype._preparePriceAxisProperties=function(e,t){var i=e.lockScale.value(),n=e.style.value()==TradingView.Series.STYLE_PNF;(n||i)&&(t.log.setValue(!1),t.percentage.setValue(!1)),t.logDisabled.setValue(!(!n&&!i)),t.percentageDisabled.setValue(!(!n&&!i))},W78.prototype.alertsList=function(){return this.m_model.alertsList()},W78.prototype.alertsListChanged=function(){return this.m_model.alertsListChanged()},W78.prototype.insertStudyStub=function(e){return this.m_model.insertStudyStub(e)},W78.prototype.removeStudyStub=function(e){return this.m_model.removeStudyStub(e)},W78.prototype.isJustClonedChart=function(){return this.D4.isJustClonedChart()},UndoCommand.prototype.text=function(){return this._text},UndoCommand.prototype.undo=function(){throw"pure virtual call ;)"},UndoCommand.prototype.redo=function(){throw"pure virtual call ;)"},UndoStack.prototype.onChange=function(){return this._onChange},UndoStack.prototype.isEmpty=function(){return this.m_commands.isEmpty()},UndoStack.prototype.clear=function(){this.m_commands.clear(),this._onChange.fire()},UndoStack.prototype.push=function(e){this.m_commands.append(e),this._onChange.fire()},UndoStack.prototype.pop=function(){if(!this.m_commands.isEmpty()){var e=this.m_commands.item(this.m_commands.size()-1);return this.m_commands.removeAt(this.m_commands.size()-1),this._onChange.fire(),e}TradingView.logDebug("UndoStack.pop: undo stack is empty")},UndoStack.prototype.head=function(){return this.m_commands.isEmpty()?void TradingView.logDebug("UndoStack.head: undo stack is empty"):this.m_commands.item(this.m_commands.size()-1)},inherit(UndoMacroCommand,UndoCommand),UndoMacroCommand.prototype.addCommand=function(e){this._subcommands.append(e)},UndoMacroCommand.prototype.isEmpty=function(){return this._subcommands.isEmpty()},UndoMacroCommand.prototype.redo=function(){for(var e=0;e<this._subcommands.size();e++)this._subcommands.item(e).redo()},UndoMacroCommand.prototype.undo=function(){for(var e=this._subcommands.size()-1;e>=0;e--)this._subcommands.item(e).undo()},inherit(SetPropertyCommand,UndoCommand),SetPropertyCommand.prototype.redo=function(){this._oldValue=this._targetObj.value(),TradingView.saveDefaultProperties(!0),this._targetObj.setValue(this._newValue),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},SetPropertyCommand.prototype.undo=function(){TradingView.saveDefaultProperties(!0),this._targetObj.setValue(this._oldValue),TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},inherit(SetAutoScalePropertyCommand,UndoCommand),SetAutoScalePropertyCommand.prototype.redo=function(){this._oldValue=this._property.value(),this._oldLockScaleValue=this._priceScale.mainSource()instanceof TradingView.Series?this._priceScale.mainSource().properties().lockScale.value():void 0,TradingView.saveDefaultProperties(!0),this._property.setValue(this._newValue),this._oldLockScaleValue&&this._newValue&&this._priceScale.mainSource().properties().lockScale.setValue(!1),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},SetAutoScalePropertyCommand.prototype.undo=function(){TradingView.saveDefaultProperties(!0),this._property.setValue(this._oldValue),this._oldLockScaleValue&&this._newValue&&this._priceScale.mainSource().properties().lockScale.setValue(this._oldLockScaleValue),TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},inherit(SetPercentagePropertyCommand,UndoCommand),SetPercentagePropertyCommand.prototype.redo=function(){this._oldValue=this._percentage.value(),this._oldAutoScaleValue=this._priceScale.properties().autoScale.value(),this._oldLogValue=this._priceScale.properties().log.value(),this._oldLogDisabled=this._priceScale.properties().logDisabled.value(),TradingView.saveDefaultProperties(!0),this._percentage.setValue(this._newValue),this._priceScale.properties().autoScaleDisabled.setValue(this._newValue),this._priceScale.properties().log.setValue(!1),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},SetPercentagePropertyCommand.prototype.undo=function(){if(TradingView.saveDefaultProperties(!0),this._percentage.setValue(this._oldValue),this._priceScale.properties().autoScale.setValue(this._oldAutoScaleValue),this._priceScale.properties().autoScaleDisabled.setValue(this._oldValue),this._priceScale.properties().log.setValue(this._oldLogValue),!(this._oldAutoScaleValue||this._priceScale.mainSource()instanceof TradingView.Series&&this._priceScale.mainSource().isLockScale())){var e=this.D0.timeScale().visibleBars();this._priceScale.setPriceRange(this._priceScale.priceRange().convertFromPercents(this._priceScale.mainSource().close(e.firstBar())))}TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},inherit(SetLogPropertyCommand,UndoCommand),SetLogPropertyCommand.prototype.redo=function(){this._oldValue=this._log.value(),this._oldPercValue=this._priceScale.properties().percentage.value(),this._oldPercDisabled=this._priceScale.properties().percentageDisabled.value(),TradingView.saveDefaultProperties(!0),this._log.setValue(this._newValue),this._priceScale.properties().percentage.setValue(!1),this._priceScale.properties().autoScaleDisabled.setValue(this._priceScale.properties().percentage.value()),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},SetLogPropertyCommand.prototype.undo=function(){TradingView.saveDefaultProperties(!0),this._log.setValue(this._oldValue),this._priceScale.properties().percentage.setValue(this._oldPercValue),TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},inherit(SetChartStyleCommand,UndoCommand),SetChartStyleCommand.prototype.redo=function(){var e=$.Deferred().resolve();this._mainSeries.D2.style===this._style&&this.D0.mainSeries().isNeedRestart(this._newValue)&&(e=this.D4.screen.show()),e.done(function(){this._oldValue=this._style.value(),this._oldAutoScale=this._priceAxisProperties.autoScale.value(),this._oldLogValue=this._priceAxisProperties.log.value(),this._oldLogDisabled=this._priceAxisProperties.logDisabled.value(),this._oldPercentageValue=this._priceAxisProperties.percentage.value(),this._oldPercentageDisabled=this._priceAxisProperties.percentageDisabled.value(),TradingView.saveDefaultProperties(!0),this._style.setValue(this._newValue),this.D4.model()._preparePriceAxisProperties(this._mainSeries.properties(),this._priceAxisProperties),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))}.bind(this))},SetChartStyleCommand.prototype.undo=function(){var e=$.Deferred().resolve();this._mainSeries.D2.style===this._style&&this.D0.mainSeries().isNeedRestart(this._newValue)&&(e=this.D4.screen.show()),e.done(function(){TradingView.saveDefaultProperties(!0),this._style.setValue(this._oldValue),this._priceAxisProperties.log.setValue(this._oldLogValue),this._priceAxisProperties.logDisabled.setValue(this._oldLogDisabled),this._priceAxisProperties.percentage.setValue(this._oldPercentageValue),this._priceAxisProperties.percentageDisabled.setValue(this._oldPercentageDisabled),this._priceAxisProperties.autoScale.setValue(this._oldAutoScale),TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))}.bind(this))},inherit(SetLockScaleCommand,UndoCommand),SetLockScaleCommand.prototype.redo=function(){this._oldValue=this._property.value(),this._oldAutoScale=this._priceAxisProperties.autoScale.value(),this._oldPercentage=this._priceAxisProperties.percentage.value(),this._oldLog=this._priceAxisProperties.log.value(),TradingView.saveDefaultProperties(!0),this._newValue&&(this._priceAxisProperties.percentage.setValue(!1),this._priceAxisProperties.log.setValue(!1),this._priceAxisProperties.autoScale.setValue(!1));var e=this._mainSeries.properties().style.value();e!==TradingView.Series.STYLE_RENKO&&e!==TradingView.Series.STYLE_KAGI&&e!==TradingView.Series.STYLE_PNF&&e!==TradingView.Series.STYLE_PB&&this._mainSeries.fixBoxSize(),this._property.setValue(this._newValue),TradingView.saveDefaultProperties(!1),this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},SetLockScaleCommand.prototype.undo=function(){TradingView.saveDefaultProperties(!0),this._priceAxisProperties.percentage.setValue(this._oldPercentage),this._priceAxisProperties.log.setValue(this._oldLog),this._priceAxisProperties.autoScale.setValue(this._oldAutoScale),this._property.setValue(this._oldValue),TradingView.saveDefaultProperties(!1),this._oldValue=null,this.D0&&(this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE)))},W89=function(e,t,i,n){this.m_model=e,this.m_pane=t,this.m_priceScale=i,this.m_state=n,this.m_newPriceScaleState=null},inherit(W89,UndoCommand),W89.prototype.undo=function(){null!==this.m_newPriceScaleState?TradingView.logDebug("W89.undo: Command is already undone"):(this.m_newPriceScaleState=this.m_priceScale.state(),this.m_model.restorePriceScaleState(this.m_pane,this.m_priceScale,this.m_state),this.m_priceScale.recalcLockedScale(null))},W89.prototype.redo=function(){null===this.m_newPriceScaleState?TradingView.logDebug("W89.redo: Command is not undone"):(this.m_model.restorePriceScaleState(this.m_pane,this.m_priceScale,this.m_newPriceScaleState),this.m_newPriceScaleState=null)},W94=function(e,t,i){UndoCommand.call(this,i),this.m_model=e,this.m_state=t,this.m_newTimeScaleState=null},inherit(W94,UndoCommand),W94.prototype.undo=function(){null!==this.m_newTimeScaleState?TradingView.logDebug("W94.undo: Command is already undone"):(this.m_newTimeScaleState=this.m_model.timeScale().state(),this.m_model.restoreTimeScaleState(this.m_state),this.m_model.timeScale().recalcLockedScale())},W94.prototype.redo=function(){null===this.m_newTimeScaleState?TradingView.logDebug("W94.redo: Command is not undone"):(this.m_model.restoreTimeScaleState(this.m_newTimeScaleState),this.m_newTimeScaleState=null)},W86=function(e,t,i,n){this.D0=e,this._series=t,this._oldSymbol=t.symbol(),this._oldInterval=t.interval(),this._symbol=i,this._interval=n},inherit(W86,UndoCommand),W86.prototype.redo=function(){this.D0.modifySeries(this._series,this._symbol,this._interval)},W86.prototype.undo=function(){this.D0.modifySeries(this._series,this._oldSymbol,this._oldInterval)},InsertStudyCommand=function(e,t,i,n){UndoCommand.call(this,"Insert "+t.id),this.D0=e,this._studyMetaInfo=t,this._props=i,this._isOverlay=n},inherit(InsertStudyCommand,UndoCommand),InsertStudyCommand.prototype.redo=function(){return this.D1=this.D0.insertStudy(this._studyMetaInfo,this._props,this._isOverlay)},InsertStudyCommand.prototype.undo=function(){this.D0.removeSource(this.D1)},inherit(RemoveSourceCommand,UndoCommand),RemoveSourceCommand.prototype.redo=function(){var e=this.D0.paneForSource(this.W99);this._paneIndex=this.D0.panes().indexOf(e),this._priceScaleName=e.priceScaleName(this.W99.priceScale());var t=this.D0.children(this.W99);this._removeChildUndoCommands=new List;for(var i=0;i<t.size();i++){var n=t.item(i),n=new RemoveSourceCommand(this.D0,n);this._removeChildUndoCommands.append(n),n.redo()}this._paneState=e.state(),this._restorePane=this.D0.removeSource(this.W99),this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.FULL_UPDATE,!0))},RemoveSourceCommand.prototype.undo=function(){var e;e=this._restorePane?this.D0.createPane(this._paneIndex):this.D0.panes().item(this._paneIndex);var t=this.W99.ownerSource()?this.W99.ownerSource().priceScale():e.priceScaleByName(this._priceScaleName);for(e.addDataSource(this.W99,t),this.W99.start(),this.W99.restore&&this.W99.restore(),this._restorePane&&e.restoreState(this._paneState),e=this._removeChildUndoCommands.size()-1;e>=0;e--)this._removeChildUndoCommands.item(e).undo();this._removeChildUndoCommands.clear(),this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.FULL_UPDATE,!0))},inherit(W88,UndoCommand),W88.prototype.redo=function(){this.D0.move(this.W99,this._pane,this._scale)},W88.prototype.undo=function(){var e=!1;if(this._samePane)this._oldPane.restoreState(this._oldPaneState);else{for(var t=0;t<this._sources.size();t++)this.D0.detachSource(this._sources.item(t));if(this.D0.panes().contains(this._oldPane)){for(var i=this._oldPane.priceScaleByName(this._oldScaleName),t=0;t<this._sources.size();t++)this._oldPane.addDataSource(this._sources.item(t),i);this._oldPane.restoreState(this._oldPaneState)}else{for(this._oldPane=this.D0.createPane(this._oldPaneIndex),i=this._oldPane.priceScaleByName(this._oldScaleName),t=0;t<this._sources.size();t++)this._oldPane.addDataSource(this._sources.item(t),i);e=!0}}this.D0.recalculateAllPanes(),e&&this.D0.D20(new A22(A7.FULL_UPDATE))},inherit(W83,UndoCommand),W83.prototype.coninueCreatingLine=function(e,t){this._points.append({point:e,envState:t})},W83.prototype.undo=function(){this.D0.removeSource(this._line)},W83.prototype.redo=function(){var e=this.D0.panes().item(this._paneIndex);for(this._line=this.D0.createLineTool(e,this._points.item(0).point,this._line.toolname),e=1;e<this._points.size();e++)this.D0.coninueCreatingLine(this._points.item(e).point,this._points.item(e).envState)},inherit(W80,UndoCommand),W80.prototype.setPoint=function(e){this._nextState=this.W99.state(!0)},W80.prototype.endChanging=function(){this._nextState=this.W99.state(!0)},W80.prototype.undo=function(){var e=this.W99,t=this._prevState;e.restorePoints(t.points,t.indexes||[]),e.properties().merge(t.state),e.restoreData&&e.restoreData(t),e.createServerPoints(),this.D0.D20(new A22(A22.FULL_UPDATE))},W80.prototype.redo=function(){var e=this.W99,t=this._nextState;e.restorePoints(t.points,t.indexes||[]),e.properties().merge(t.state),e.restoreData&&e.restoreData(t),e.createServerPoints(),this.D0.D20(new A22(A22.FULL_UPDATE))},inherit(W87,UndoCommand),W87.prototype.setPoint=function(e){this._point=e instanceof MathEx.Point?e.clone():TradingView.clone(e)},W87.prototype.undo=function(){this.D0.startMovingSource(this.W99,this._point,this._pointIndex),this.D0.moveSource(this._origPoint),this.D0.endMovingSource()},W87.prototype.redo=function(){this.D0.startMovingSource(this.W99,this._origPoint,this._pointIndex),this.D0.moveSource(this._point),this.D0.endMovingSource()},inherit(ChangeZOrderCommand,UndoCommand),ChangeZOrderCommand.prototype.undo=function(){this.D0.changeZOrder(this.W99,-this._shift)},ChangeZOrderCommand.prototype.redo=function(){this.D0.changeZOrder(this.W99,this._shift)},inherit(SendToBackCommand,UndoCommand),SendToBackCommand.prototype.undo=function(){this.D0.bringToFront(this.W99)},SendToBackCommand.prototype.redo=function(){this.D0.sendToBack(this.W99)},inherit(BringToFrontCommand,UndoCommand),BringToFrontCommand.prototype.undo=function(){this.D0.sendToBack(this.W99)},BringToFrontCommand.prototype.redo=function(){this.D0.bringToFront(this.W99)},W78.prototype.removePane=function(e,t){var i=new RemovePaneCommand(this,t,e);this.pushUndoCommand(i),i.redo()},inherit(RemovePaneCommand,UndoCommand),RemovePaneCommand.prototype.redo=function(){this.D0.panes().removeAt(this._index),this._chart._updateGui()},RemovePaneCommand.prototype.undo=function(){this.D0.panes().insert(this._pane,this._index),this._chart._updateGui()},W78.prototype.rearrangePanes=function(e,t,i){e=new RearrangePanesCommand(this,t,i,e),this.pushUndoCommand(e),e.redo()},inherit(RearrangePanesCommand,UndoCommand),RearrangePanesCommand.prototype.redo=function(){var e=this.D0.panes().item(this._index);"up"===this._direction&&0<this._index&&(this.D0.panes().removeAt(this._index),this.D0.panes().insert(e,this._index-1)),"down"===this._direction&&this._index<this.D0.panes().size()-1&&(this.D0.panes().removeAt(this._index),this.D0.panes().insert(e,this._index+1)),this.D0.D20(new A22(A22.FULL_UPDATE))},RearrangePanesCommand.prototype.undo=function(){if("up"===this._direction){var e=this.D0.panes().item(this._index-1);this.D0.panes().removeAt(this._index-1),this.D0.panes().insert(e,this._index)}"down"===this._direction&&(e=this.D0.panes().item(this._index+1),this.D0.panes().removeAt(this._index+1),this.D0.panes().insert(e,this._index)),this.D0.D20(new A22(A22.FULL_UPDATE))},inherit(ZoomCommand,UndoCommand),ZoomCommand.prototype.redo=function(){this._timeScaleState=this.D0.timeScale().state(),this._priceScaleState=this._pane.defaultPriceScale().state(),this.D0.zoomToViewport(this._startBar,this._endBar,this._startPrice,this._endPrice,this._pane)},ZoomCommand.prototype.undo=function(){this.D0.timeScale().restoreState(this._timeScaleState),this._pane.defaultPriceScale().restoreState(this._priceScaleState),this.D0.recalculateAllPanes(),this.D0.D20(new A22(A22.LIGHT_UPDATE))},inherit(W95,UndoCommand),W95.prototype.undo=function(){this._inOut?this._baseCmd!==this._zoomStack.head()?TradingView.logDebug("zoom stack inconsistency"):(this._baseCmd.undo(),this._zoomStack.pop()):(this._baseCmd.redo(),this._zoomStack.push(this._baseCmd))},W95.prototype.redo=function(){this._inOut?(this._baseCmd.redo(),this._zoomStack.push(this._baseCmd)):this._baseCmd!==this._zoomStack.head()?TradingView.logDebug("zoom stack inconsistency"):(this._baseCmd.undo(),this._zoomStack.pop())},inherit(W91,UndoCommand),W91.prototype.redo=function(){var e=this._paneA._stretchFactor+this._paneB._stretchFactor;this._paneA._stretchFactor=this._currStretchA,this._paneB._stretchFactor=e-this._currStretchA,this.D0.D20(new A22(A22.FULL_UPDATE))},W91.prototype.undo=function(){var e=this._paneA._stretchFactor+this._paneB._stretchFactor;this._paneA._stretchFactor=this._prevStretchA,this._paneB._stretchFactor=e-this._prevStretchA,this.D0.D20(new A22(A22.FULL_UPDATE))},inherit(W90,UndoCommand),W90.prototype.redo=function(){this.D0.restoreFactoryDefaults(this._defaultProperty)},W90.prototype.undo=function(){this._defaultProperty.merge(this._state),this._defaultProperty.listeners().fire(this._defaultProperty),this.D0.mainSeries().onChartStyleChanged()},inherit(W81,UndoCommand),W81.prototype._merge=function(e,t){var i=this.D0;TradingView.saveDefaultProperties(!0),e&&(i.properties().paneProperties.merge(e.paneProperties),i.properties().scalesProperties.merge(e.scalesProperties),i.properties().symbolWatermarkProperties.merge(e.symbolWatermarkProperties)),i.mainSeries().properties().merge(t),i.mainSeries().properties().saveDefaults(),i.mainSeries().$63(),i._version=t.version,i.recalculateAllPanes(),i.D20(new A22(A22.FULL_UPDATE)),i.properties().saveDefaults(),i.properties().listeners().fire(this.D2),TradingView.saveDefaultProperties(!1)},W81.prototype.undo=function(){this._merge(this._oldChartProps,this._oldSeriesProps),this.D0.mainSeries().onChartStyleChanged(),this.D0.updateScales()},W81.prototype.redo=function(){this._merge(this._newChartProps,this._newSeriesProps),this.D0.mainSeries().onChartStyleChanged(),this.D0.updateScales()},inherit(W84,UndoCommand),W84.prototype._merge=function(e){var t=this.W99;t.properties().merge(e),t.properties().saveDefaults(),t.updateAllViews(),t.D0.D20(new A22(A22.LIGHT_UPDATE))},W84.prototype.undo=function(){this._merge(this._oldProps)},W84.prototype.redo=function(){this._merge(this._newProps)},inherit(W93,UndoCommand),W93.prototype._merge=function(e){var t=this.D0.model(),i=t.mainSeries();i.properties().lockScale.setValue(!1),e.interval&&i.properties().interval.setValue(e.interval);for(var n=[],o=t.panes(),r=o.size();r--;)for(var s=o.item(r),a=s.containsMainSeries(),l=s.D19(),s=l.size();s--;){var d=l.item(s);(!a||d instanceof TradingView.Study||d instanceof TradingView.AlertLabel)&&(d.isRemovedByStudyTemplates()||n.push(d),t.removeSource(d))}for(a=e.panes,r=0;r<a.length;r++){for(var l=!1,h=a[r],s=0;s<h.sources.length;s++)d=h.sources[s],"MainSeries"===d.type&&(delete d.state,l=!0);if(s=null,s=l?o.item(r):t.createPane(r),s.restoreState(a[r],!1,e.version),l)for(d=0;d<n.length;d++){n[d].restore&&n[d].restore();var c=n[d];c instanceof TradingView.AlertLabel&&!s.D19().find(function(e){return e.alert&&e.alert().id()===c.alert.id()})||s.D19().append(c)}s.updateAlertLabelsSources()}i.priceScale().setAutoScale(!0),t._version=e.version,t.startNotStartedStudies(),t.recalculateAllPanes(),t.D20(new A22(A22.FULL_UPDATE))},W93.prototype.undo=function(){this._merge(this._oldProps),this.D0.model().mainSeries().onChartStyleChanged()},W93.prototype.redo=function(){this._merge(this._newProps),this.D0.model().mainSeries().onChartStyleChanged();var e=this.D0.model().mainSeries().properties(),t=this.D0.model().mainSeries().properties().priceAxisProperties;this.D0._preparePriceAxisProperties(e,t)},inherit(SetPriceScaleMarginsCommand,UndoCommand),SetPriceScaleMarginsCommand.prototype.redo=function(){this._priceScale.setTopMargin(this._topMargin),this._priceScale.setBottomMargin(this._bottomMargin),this.D0.recalculatePane(this._pane,!1)},SetPriceScaleMarginsCommand.prototype.undo=function(){this._priceScale.setTopMargin(this._oldTopMargin),this._priceScale.setBottomMargin(this._oldBottomMargin),this.D0.recalculatePane(this._pane,!1)},inherit(W85,UndoCommand),W85.prototype.redo=function(){this.D0.mainSeries().loadDataTo(this._range)},inherit(W92,UndoCommand),W92.prototype.redo=function(){this._cw.screen.show().done(function(){this._property.setValue(this._value,this._forceSetProperty)}.bind(this))},W92.prototype.undo=function(){this._cw.screen.show().done(function(){this._property.setValue(this._prevValue,this._forceSetProperty)}.bind(this))},inherit(W82,UndoCommand),W82.prototype.redo=function(){if(this.W99){var e=this.W99,t=e.priceScale(),i=this.D0.paneForSource(e),n=TradingView.className(e.constructor);this._line=new TradingView[n](this.D0,new $52(n.toLowerCase(),e.properties().state())),this._line.setOwnerSource(e.ownerSource()),this._line.properties().visible._value=!0,this._line._fixedPoints.appendAll(e._fixedPoints);for(var o=0;o<this._line._fixedPoints.size();o++)this._line._fixedPoints.setItem(o,this._line._fixedPoints.item(o).add(new MathEx.Point(20,20)));var r=e._timePoint.toArray(),n=[];if(t.isPercent())var s=e.ownerSource().firstValue();for(o=0;o<r.length;o++){var a={offset:r[o].offset,time_t:r[o].time_t},l=r[o].price;t.isPercent()&&(l=t.priceRange().convertToPercent(l,s)),l=t.priceToCoordinate(l),l-=40,l=t.coordinateToPrice(l),t.isPercent()&&(l=t.priceRange().convertFromPercent(l,s)),a.price=l,n.push(a)}s=e._points.toArray(),this._line.restorePoints(n,s),this._line.cloneData&&this._line.cloneData(e),i.addDataSource(this._line,t),this.D0.updateSource(this._line),this._line.checkAlert&&this._line.checkAlert(),this._points=this._line.points(),this._paneIndex=this.D0.panes().indexOf(i),this._toolname=e._constructor,delete this.W99}else for(i=this.D0.panes().item(this._paneIndex),this._line=this.D0.createLineTool(i,this._points.item(0),this._toolname),o=1;o<this._points.size();o++)this.D0.coninueCreatingLine(this._points.item(o))},W82.prototype.undo=function(){this.D0.removeSource(this._line),this.D0.D20(new A22(A22.LIGHT_UPDATE,!0))},A77.setWatchedValue=function(e,t,i){e.value()!==t&&(e=new SetWatchedValueCommand(e,t,i),this.pushUndoCommand(e),e.redo())},inherit(SetWatchedValueCommand,UndoCommand),SetWatchedValueCommand.prototype.redo=function(){this._wv.setValue(this._newValue)},SetWatchedValueCommand.prototype.undo=function(){this._wv.setValue(this._oldValue)},W79.prototype.currentTool=function(){return this._currentTool},W79.prototype.setCurrentTool=function(e){this._currentTool=e},W79.prototype.timezone=function(){return this.D2.timezone.value()},W79.prototype.version=function(){return this._version},W79.prototype.initConnection=function(){this._chartApi.switchTimezone(this.timezone())},W79.prototype.dumpViews=function(){for(var e={panes:[]},t=0;t<this.m_panes.size();t++)e.panes.push(this.m_panes.item(t).dumpViews());e.dataWindow=[];for(var i=this.D19(),t=0;t<i.size();t++){var n=i.item(t).dataWindowView();n&&e.dataWindow.push(n.dump())}return e},W79.prototype._paneInvalidationMask=function(e,t){var i=new A22,n=this.m_panes.indexOf(e);return void 0===t&&(t=A22.LIGHT_UPDATE),i.invalidatePane(n,t),i},W79.prototype.updatePane=function(e){e=this._paneInvalidationMask(e),this.D20(e)},W79.prototype.fullUpdate=function(e){this.D20(new A22(A22.FULL_UPDATE))},W79.prototype.updateSource=function(e){e=this.paneForSource(e),e=this._paneInvalidationMask(e),this.D20(e)},W79.prototype.studiesMetaData=function(){return this._studiesMetaData},W79.prototype.studyVersioning=function(){return this._studyVersioning},W79.prototype.disconnect=function(){for(var e=this.D19(),t=0;t<e.size();t++)e.item(t).disconnect&&e.item(t).disconnect()},W79.prototype.restart=function(){this.initConnection(),this.m_timeScale.reset(),this.m_mainSeries.restart();for(var e=this.D19(),t=0;t<e.size();t++)e.item(t).restart&&e.item(t)!==this.m_mainSeries&&e.item(t).restart()},W79.prototype.startNotStartedStudies=function(){
if(!this.m_mainSeries.isStarted())throw Error("Cannot start studies: main series is not started");for(var e=this.D19(),t=0;t<e.size();t++)e.item(t)instanceof TradingView.Study&&!e.item(t).isStarted()&&e.item(t).restart&&e.item(t)!==this.m_mainSeries&&e.item(t).restart()},W79.prototype.updateLineTools=function(){for(var e=this.D19(),t=0;t<e.size();t++)if(isInherited(e.item(t).constructor,W47)){var i=e.item(t);i.tryCreateServerPoints(),i.checkAlert&&i.checkAlert()}},W79.prototype.realignLineTools=function(){for(var e=this.D19(),t=0;t<e.size();t++)isInherited(e.item(t).constructor,W47)&&e.item(t).calcIsActualSymbol();for(t=0;t<this.panes().size();t++)this.panes().item(t).invalidateSourcesCache()},W79.prototype.readOnly=function(){return this._readOnly},W79.prototype.properties=function(){return this.D2},W79.prototype.lineCancelled=function(){return this._lineCancelled},W79.prototype.chartApi=function(){return this._chartApi},W79.prototype.propertyChangeHandler=function(){this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.visibilityChangeHandler=function(){this.setSelectedSource(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.updateAllPaneViews=function(){for(var e=0;e<this.panes().size();e++)this.panes().item(e).updateAllViews()},W79.prototype.mainSeries=function(){return this.m_mainSeries},W79.prototype.timeScale=function(){return this.m_timeScale},W79.prototype.panes=function(){return this.m_panes},W79.prototype.gridSource=function(){return this.m_gridSource},W79.prototype.watermarkSource=function(){return this.m_watermarkSource},W79.prototype.crossHairSource=function(){return this.m_crossHairSource},W79.prototype.publishedChartsTimelineSource=function(){for(var e=0;e<this._barsMarksSources.length;++e)if(this._barsMarksSources[e]instanceof PublishedChartsTimeline)return this._barsMarksSources[e]},W79.prototype.barsMarksSources=function(){return this._barsMarksSources},W79.prototype.width=function(){return this.m_width},W79.prototype.setPaneHeight=function(e,t){e.setHeight(t),this.recalculateAllPanes(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.setWidth=function(e){this.m_width=e,this.m_timeScale.setWidth(this.m_width);for(var t=0;t<this.m_panes.size();++t)this.m_panes.item(t).setWidth(e);this.recalculateAllPanes()},W79.prototype.createPane=function(e,t,i){var n=this.D2.paneProperties;if(i&&n.merge(i),t=new W75(this.m_timeScale,n,this,t),void 0!==e){if(0>e||e>this.m_panes.size())return void TradingView.logDebug("W79.createPane: invalid index: "+e);this.m_panes.insert(t,e)}else this.m_panes.append(t);return t.onTagsChanged().subscribe(this,W79.prototype.onPaneTagsChanged),t},W79.prototype.removePane=function(e){e.destroy(),this.m_panes.remove(e),this.D20(new A22(A22.FULL_UPDATE))},W79.prototype.startScalePrice=function(e,t,i){e.startScalePrice(t,i)},W79.prototype.scalePriceTo=function(e,t,i){e.scalePriceTo(t,i),this.mainSeries().properties().lockScale.value()?this.D20(new A22(A22.LIGHT_UPDATE)):this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.endScalePrice=function(e,t){e.endScalePrice(t),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.startScrollPrice=function(e,t,i){e.startScrollPrice(t,i)},W79.prototype.scrollPriceTo=function(e,t,i){e.scrollPriceTo(t,i),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.endScrollPrice=function(e,t){e.endScrollPrice(t),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.setPriceAutoScale=function(e,t,i){e.setPriceAutoScale(t,i),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.restorePriceScaleState=function(e,t,i){e.restorePriceScaleState(t,i),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.resetPriceScale=function(e,t){e.resetPriceScale(t),this.D20(this._paneInvalidationMask(e,A22.LIGHT_UPDATE))},W79.prototype.updateScales=function(e,t){this._undoModel.D4._updateScalesActions()},W79.prototype.startScaleTime=function(e){this.m_timeScale.startScale(e)},W79.prototype.scaleTimeTo=function(e){this.m_timeScale.scaleTo(e),this.recalculateAllPanes(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.endScaleTime=function(){this.m_timeScale.endScale(),this.D20(new A22(A22.LIGHT_UPDATE)),this.mainSeries().requestMoreData(),this.recalcVisibleRangeStudy(this.D19())},W79.prototype.startScrollTime=function(e){this.m_timeScale.startScroll(e)},W79.prototype.scrollTimeTo=function(e){this.m_timeScale.scrollTo(e),this.recalculateAllPanes(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.endScrollTime=function(){this.m_timeScale.endScroll(),this.D20(new A22(A22.LIGHT_UPDATE)),this.mainSeries().requestMoreData(),this.recalcVisibleRangeStudy(this.D19())},W79.prototype.recalcVisibleRangeStudy=function(e,t){if(!this.timeScale().isEmpty()){var i=this.timeScale().visibleBars(),n=this.mainSeries().nearestData(i.firstBar(),SEARCH_NEAREST_RIGHT),i=this.mainSeries().nearestData(i.lastBar(),SEARCH_NEAREST_LEFT),o=n?n.index:void 0,r=i?i.index:void 0;if(o!=this._oldStartVisibleIndex||r!=this._oldEndVisibleIndex||t)for(this._oldStartVisibleIndex=o,this._oldEndVisibleIndex=r,o=0;o<e.size();o++)if(e.item(o)instanceof TradingView.Study)for(var r=e.item(o),s=r.metaInfo().inputs,a=0;a<s.length;a++){if("first_visible_bar_time"==s[a].id){var l=n&&n.value?n.value[TIME_PLOT]:0;r.properties().inputs.first_visible_bar_time.setValue(1e3*Math.floor(l))}"last_visible_bar_time"==s[a].id&&(l=i&&i.value?i.value[TIME_PLOT]:0,r.properties().inputs.last_visible_bar_time.setValue(1e3*Math.floor(l)))}}},W79.prototype.resetTimeScale=function(){this.m_timeScale.restoreDefault(),this.recalculateAllPanes(),this.mainSeries().requestMoreData(),this.recalcVisibleRangeStudy(this.D19()),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.restoreTimeScaleState=function(e){this.m_timeScale.restoreState(e),this.recalculateAllPanes(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.restoreFactoryDefaults=function(e){e.restoreFactoryDefaults(),this.recalcVisibleRangeStudy(this.D19(),!0),this.mainSeries().onChartStyleChanged()},W79.prototype.setSelectedSource=function(e,t){if(!(this.m_selectedSource===e&&this._lastHittestData===t||e&&e.customization&&e.customization.disableSelection)){this._lastHittestData=t;var i=new A22;this.m_selectedSource&&(this.m_selectedSource.updateAllViews(),this.paneForSource(this.m_selectedSource)),this.m_selectedSource=e,this._selectedSourceChanged.fire(e),e&&(e.updateAllViews(),this.paneForSource(e),e.hasAlert.value()&&TradingView.alertsDispatcher&&e.getAlert(function(e){TradingView.alertsDispatcher.alertSelected.setValue(e)},!0)),i.force=!0,this.D20(new A22(A22.LIGHT_UPDATE)),this.setHoveredSource(e,t)}},W79.prototype.checkLineToolSelection=function(){this.m_selectedSource&&this.m_selectedSource instanceof W47&&(this.m_selectedSource.calcIsActualSymbol(),this.m_selectedSource.isActualSymbol()||this.setSelectedSource(null))},W79.prototype.onSelectedSourceChanged=function(){return this._selectedSourceChanged},W79.prototype.setHoveredSource=function(e,t){if(this.m_hoveredSource!==e||this._lastHittestData!==t){this._lastHittestData=t;var i=null;this.m_hoveredSource&&(this.m_hoveredSource.updateAllViews(),i||(i=new A22),i.merge(this._paneInvalidationMask(this.paneForSource(this.m_hoveredSource),A22.LIGHT_UPDATE))),(this.m_hoveredSource=e)&&(e.updateAllViews(),i||(i=new A22),i.merge(this._paneInvalidationMask(this.paneForSource(e),A22.LIGHT_UPDATE))),i&&this.D20(i)}},W79.prototype.selectedSource=function(){return this.m_selectedSource},W79.prototype.hoveredSource=function(){return this.m_hoveredSource},W79.prototype.lastHittestData=function(){return this._lastHittestData},W79.prototype.D20=function(e){this._invalidateHandler&&this._invalidateHandler(e)},W79.prototype.D19=function(){var e=[];e.push(this.m_crossHairSource);for(var t=0;t<this.m_panes.size();++t)e=e.concat(this.m_panes.item(t).D19().toArray());return new List(e)},W79.prototype.dataSourceForId=function(e){for(var t,i=0;i<this.m_panes.size();++i)if(t=this.m_panes.item(i).dataSourceForId(e))return t;return null},W79.prototype.children=function(e){for(var t=this.D19(),i=new List,n=0;n<t.size();n++){var o=t.item(n);o.ownerSource()===e&&i.append(o)}return i},W79.prototype.setCurrentPosition=function(e,t,i,n){var o=NaN;if(e=Math.round(this.m_timeScale.coordinateToIndex(e)),i){var r=i.defaultPriceScale();r.isEmpty()||(o=r.coordinateToPrice(t))}for((this._lineBeingCreated||W47.isLineTool(this.currentTool()))&&(o=this._magnet.align(o,e,i)),this.m_crossHairSource.setPosition(e,o,i),this.m_crossHairSource.dataWindowView().update(),t=this.m_panes.toArray(),i=t.length;i--;)for(var r=t[i].D19().toArray(),s=r.length;s--;){var a=r[s].dataWindowView();a&&a.update()}this._lineBeingCreated?(this._lineBeingCreated.setLastPoint({index:e,price:o},n),this._lineBeingCreated.updateAllViews(),this.D20(new A22(A22.LIGHT_UPDATE))):this.crossHairSource().startMeasurePoint()?this.D20(new A22(A22.LIGHT_UPDATE)):this.D20(new A22(A22.UPDATE_CURSOR_ONLY)),n=this._undoModel.D4,n.D5&&(o=this.m_timeScale.points().valueAt(e),isNaN(o)&&e>0&&(o=1/0),n.D5.syncCrosshair(o,n))},W79.prototype.clearCurrentPosition=function(){this.crossHairSource().clearPosition(),this.fullUpdate();var e=this._undoModel.D4;e.D5&&e.D5.syncCrosshair(NaN,e)},W79.prototype.setExternalPosition=function(e){if(e=this.m_timeScale.points().closestIndexLeft(e),isFinite(e)){this.crossHairSource().setPosition(e,NaN,null),e=this.D19();for(var t=e.size();t--;){var i=e.item(t).dataWindowView();i&&i.update()}}else this.crossHairSource().visible=!1;this.D20(new A22(A22.UPDATE_CURSOR_ONLY))},W79.prototype.updateTimeScale=function(e,t,i,n,o){if(o){this.m_timeScale.reset(),o=this.D19();for(var r=0;r<o.size();r++)o.item(r).clearData&&o.item(r).clearData()}this.m_timeScale.update(e,t,i,n),this.recalculateAllPanes(),this.updateBarsMarksSources(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.recalculatePane=function(e,t){e&&e.recalculate(t)},W79.prototype.paneForSource=function(e){for(var t=this.m_panes.size()-1;t>=0;t--)if(this.m_panes.item(t).D19().contains(e))return this.m_panes.item(t);return e instanceof W96?this.paneForSource(this.m_mainSeries):null},W79.prototype.updateBarsMarksSources=function(){for(;0<this._barsMarksSources.length;)return this._barsMarksSources[0].updateTimeZone()},W79.prototype.recalculateAllPanes=function(){for(var e=0;e<this.m_panes.size();++e)this.m_panes.item(e).recalculate();this.timeScale().recalcLockedScale(),this.updateAllPaneViews()},W79.prototype._invalidateBarColorerCaches=function(){for(var e=this.D19(),t=0;t<e.size();++t){var i=e.item(t);i instanceof TradingView.Series&&i.invalidateBarColorerCache()}},W79.prototype.insertStudy=function(e,t,i){var n=null;TradingView.trackEvent("studies","Study_"+e.id),i||e.is_price_study?n=this.paneForSource(this.m_mainSeries):(n=this.createPane(void 0,!0),t&&t.paneSize&&n.setPaneSize(t.paneSize)),"Compare@tv-basicstudies"==e.id&&(TradingView.trackEvent("compare","symbol:"+t.inputs.symbol),this.m_mainSeries.priceScale().properties().log.setValue(!1),this.m_mainSeries.priceScale().properties().percentage.setValue(!0)),t=TradingView.prepareStudyProperties(e,t,n,this.studyVersioning()),t=TradingView.createStudy(this,t,this.mainSeries(),e),t.start();var o=t.metaInfo().priceScale||TradingView.StudyConsts.SCALE_RIGHT;return o===TradingView.StudyConsts.SCALE_RIGHT?o=n.rightPriceScale():o===TradingView.StudyConsts.SCALE_LEFT?o=n.leftPriceScale():e.is_price_study?o=null:(console.warn("Cannot add study "+t.metaInfo().id+" with 'No Scale' setting, because study is not a price study. Using right price scale."),o=n.rightPriceScale()),i?(n.addDataSource(t,null),"Volume@tv-basicstudies"==e.id&&(e=t.priceScale(),e.setTopMargin(.75),e.setBottomMargin(0))):n.addDataSource(t,o),t.properties().linkedToSeries&&t.properties().linkedToSeries.value()&&t.setOwnerSource(this.mainSeries()),this.recalculatePane(n),this.D20(new A22(A22.FULL_UPDATE)),this._invalidateBarColorerCaches(),this.recalcVisibleRangeStudy(this.D19(),!0),t},W79.prototype.replaceStudyStub=function(e,t){var i=this.paneForSource(e);if(void 0==i)return!1;var n=e.isNoScale()?null:e.priceScale(),o=e.zorder(),r=e.ownerSource();return i.addDataSource(t,n),t.setOwnerSource(r),t.setZorder(o),this.removeSource(e),t.start(),this.recalculatePane(i),this.D20(new A22(A22.FULL_UPDATE)),!0},W79.prototype.insertStudyStub=function(e){var t=this.mainSeries(),t=this.paneForSource(t);return e=new TradingView.StudyStub(this,null,e),t.addDataSource(e,null),this.recalculatePane(t),this.D20(new A22(A22.FULL_UPDATE)),e},W79.prototype.removeStudyStub=function(e){var t=this.dataSourceForId(e);return void 0==t?(console.info("StudyStub id="+e+" is not found in chart model"),!1):(this.removeSource(t),!0)},W79.prototype.detachSource=function(e,t){var i=this.paneForSource(e);return i?(i.removeDataSource(e),i.isEmpty()?(this._lineBeingCreated&&i==this._paneBeingCreatedLineOn&&this.cancelCreatingLine(),this.removePane(i,t),!0):(this.D20(new A22(A22.FULL_UPDATE)),!1)):void 0},W79.prototype.removeSource=function(e,t){e===this.m_selectedSource&&this.setSelectedSource(null),e.stop&&e.stop();var i=this.detachSource(e,t);if(e.metaInfo&&e.metaInfo()&&"Compare@tv-basicstudies"===e.metaInfo().id){for(var n=this.paneForSource(this.m_mainSeries),o=0;o<n.D19().size();o++)if(n.D19().item(o).metaInfo&&"Compare@tv-basicstudies"===n.D19().item(o).metaInfo().id)return;this.m_mainSeries.priceScale().properties().percentage.setValue(!1)}return this.D20(new A22(A22.FULL_UPDATE)),this._invalidateBarColorerCaches(),i},W79.prototype.move=function(e,t,i){var n=new List,o=this.children(e);n.append(e),n.appendAll(o);var r=this.paneForSource(e);if(this.panes().indexOf(r),r.state(),r.priceScaleName(e.priceScale()),this.panes().indexOf(t),t&&t.state(),i=t?t.priceScaleName(i):"right",r===t)for(t.move(e,t.priceScaleByName(i)),n=e.priceScale(),e=0;e<o.size();e++)t.move(o.item(e),n);else{for(e=0;e<n.size();e++)this.detachSource(n.item(e));for(t=t?t:this.createPane(),e=0;e<n.size();e++)t.addDataSource(n.item(e),t.priceScaleByName(i));this.D20(new A22(A22.FULL_UPDATE))}this.recalculateAllPanes()},W79.prototype.isSingleInstanceLineTool=function(e){return"LineStudyMtpRiskReward"==e||"LineStudyMtpAnalysis"==e?!0:!1},W79.prototype.createLineTool=function(e,t,i,n){TradingView.trackEvent("GUI","Add Line Tool");var o=TradingView[i];if(!o)return null;this.isSingleInstanceLineTool(i)&&this._undoModel.removeAllDrawingTools(i),TradingView.trackEvent("drawings","Study_Drawing_"+i),n=new o(this,n),n.toolname=i,n.setOwnerSource(e.mainDataSource());var r=e.defaultPriceScale();return e.addDataSource(n,r),i=this.m_timeScale.indexToCoordinate(t.index),r=r.priceToCoordinate(t.price),n.isFixed()?t=n.addFixedPoint(new MathEx.Point(i,r)):(o.skipMagnetting||(t.price=this._magnet.align(t.price,t.index,e)),t=n.addPoint(t)),t||(this._lineBeingCreated=n,this._paneBeingCreatedLineOn=e),this.D20(new A22(A22.FULL_UPDATE)),n},W79.prototype.lineBeingCreated=function(){return this._lineBeingCreated},W79.prototype.paneBeingCreatedLineOn=function(){return this._paneBeingCreatedLineOn},W79.prototype.coninueCreatingLine=function(e,t){var i=this.paneForSource(this._lineBeingCreated);i.defaultPriceScale(),e.price=this._magnet.align(e.price,e.index,i),i=this._lineBeingCreated.addPoint(e,t),this._lineBeingCreated.updateAllViews();var n=new A22(A22.LIGHT_UPDATE);return i&&(this._lineBeingCreated=this._paneBeingCreatedLineOn=null,n.force=!0),this.D20(n),i},W79.prototype.cancelCreatingLine=function(){this._lineBeingCreated&&(this.removeSource(this._lineBeingCreated),this._lineBeingCreated=null,this._lineCancelled.fire())},W79.prototype.startChangingLinetool=function(e,t,i,n){this._lineBeingEdited=e,this._linePointBeingEdited=i,this._lineBeingEdited.startChanging(i,t),e=this.paneForSource(e),t.price=this._magnet.align(t.price,t.index,e),this._lineBeingEdited.startDragPoint&&this._lineBeingEdited.startDragPoint(i,t),this._lineBeingEdited.setPoint(i,t,n),this._lineBeingEdited.updateAllViews(),t=this._paneInvalidationMask(e,A22.LIGHT_UPDATE),t.force=!0,this.D20(t)},W79.prototype.lineBeingEdited=function(){return this._lineBeingEdited},W79.prototype.linePointBeingEdited=function(){return this._linePointBeingEdited},W79.prototype.changeLinePoint=function(e,t){var i=this.paneForSource(this._lineBeingEdited);if(void 0!==e.x&&void 0!==e.y){var n=this._lineBeingEdited.priceScale().coordinateToPrice(e.y),o=Math.round(this.timeScale().coordinateToIndex(e.x)),n=this._magnet.align(n,o,i);this._lineBeingEdited.setPoint(this._linePointBeingEdited,{price:n,index:o},t)}else this._lineBeingEdited.setPoint(this._linePointBeingEdited,e,t);this._lineBeingEdited.updateAllViews(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.endChangingLinetool=function(){this.paneForSource(this._lineBeingEdited),this._lineBeingEdited.endChanging(),this._linePointBeingEdited=this._lineBeingEdited=null;var e=new A22(A22.LIGHT_UPDATE);e.force=!0,this.D20(e)},W79.prototype.startMovingSource=function(e,t,i){this._sourceBeingMoved=e,this._linePointBeingMoved=i,this._sourceBeingMoved.startMoving(t,i),e=this.paneForSource(this._sourceBeingMoved),e=this._paneInvalidationMask(e,A22.LIGHT_UPDATE),e.force=!0,this.D20(e)},W79.prototype.sourceBeingMoved=function(){return this._sourceBeingMoved},W79.prototype.moveSource=function(e){this._sourceBeingMoved.move(e,this._linePointBeingMoved),this.paneForSource(this._sourceBeingMoved),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.endMovingSource=function(){var e=this.paneForSource(this._sourceBeingMoved);this._sourceBeingMoved.endMoving(),this._linePointBeingMoved=this._sourceBeingMoved=null,e=this._paneInvalidationMask(e,A22.LIGHT_UPDATE),e.invalidateAll(A22.LIGHT_UPDATE),e.force=!0,this.D20(e)},W79.prototype.calculateDefaultTags=function(){for(var e=[],t=this.D19(),i=0;i<t.size();i++){var n=t.item(i);n.tags&&(e=e.concat(n.tags()))}return e},W79.prototype.changeZOrder=function(e,t){this.paneForSource(e).changeZOrder(e,t),this.D20(new A22(A22.FULL_UPDATE))},W79.prototype.sendToBack=function(e){this.paneForSource(e).sendToBack(e),this.D20(new A22(A22.FULL_UPDATE))},W79.prototype.bringToFront=function(e){this.paneForSource(e).bringToFront(e),this.D20(new A22(A22.FULL_UPDATE))},W79.prototype.onTagsChanged=function(){return this._tagsChanged},W79.prototype.onPaneTagsChanged=function(){this._tagsChanged.fire()},W79.prototype.setTimeViewport=function(e,t){this.timeScale().zoomToBarsRange(e,t),this.recalculateAllPanes(),this.D20(new A22(A22.LIGHT_UPDATE))},W79.prototype.zoomToViewport=function(e,t,i,n,o){this.setTimeViewport(e,t),e=Math.min(i,n),i=Math.max(i,n),n=o.defaultPriceScale(),n.setAutoScale(!1),n.isLog()&&(e=n.priceToLogical(e),i=n.priceToLogical(i)),n.setPriceRange(new PriceRange(e,i)),this.recalculateAllPanes(),this.D20(this._paneInvalidationMask(o,A22.LIGHT_UPDATE))},W79.prototype.clearAllStudies=function(){for(var e=this.D19(),t=0;t<e.size();t++)e.item(t).clearData&&e.item(t).clearData()},W79.prototype.allLineTools=function(){for(var e=new List,t=this.m_panes,i=t.size(),n=0;i>n;++n)for(var o=t.item(n).D19(),r=o.size(),s=0;r>s;++s){var a=o.item(s);isInherited(a.constructor,W47)&&e.append(a)}return e},W79.prototype.backgroundColor=function(){return this.D2.paneProperties.background._value},W79.prototype.backgroundCounterColor=function(){return new RGBColor(this.backgroundColor()).blackWhiteContrast()},W79.prototype.isDark=function(){return"white"===this.backgroundCounterColor()},W79.prototype.canZoomIn=function(){return this.m_timeScale.canZoomIn()},W79.prototype.canZoomOut=function(){return this.m_timeScale.canZoomOut()},W79.prototype.updateAllVolumeStudies=function(){for(var e=this.m_panes.toArray(),t=e.length;t--;)for(var i=!1,n=e[t],o=n.D19().toArray(),r=o.length;r--;){var s=o[r];s instanceof TradingView.Study&&"Volume"===s.metaInfo().shortId&&(s.updateAllViews(),i||(this.updatePane(n),i=!0))}},W79.prototype._prepareAlertsList=function(){function e(){var e=r.mainSeries().symbolInfo()?r.mainSeries().symbolInfo().full_name:null,o=r.mainSeries().properties().interval.value();e&&o&&is_authenticated?TradingView.alertsDispatcher.requestList(function(e){for(;r._alertsList.size();)n(r._alertsList.item(0));for(var t=0;t<e.length;t++)i(e[t])},function(){},{symbol:e,resolution:o,activeOnly:!0}):t()}function t(){for(var e=r._alertsList.toArray(),t=0;t<e.length;t++)n(e[t].id())}function i(e){if(e instanceof TradingView.Alert){var t=r._alertsList.find(function(t){return t.id()===e.id()});t&&n(t),(e.active()||e.fake())&&(r.mainSeries().symbolInfo()?r.mainSeries().symbolInfo().full_name:null)===e.symbol()&&(r._alertsList.append(e),r._alertsList.onAdd.fire(e))}}function n(e){var t=e instanceof TradingView.Alert?e.id():e.id||e;(e=r._alertsList.find(function(e){return e.id()===t}))&&(r._alertsList.removeAll(function(e){return e.id()===t}),r._alertsList.onRemove.fire(e))}function o(o){TradingView.alertsDispatcher.alertCreatingStarted[o](r,i),TradingView.alertsDispatcher.alertRunning[o](r,i),TradingView.alertsDispatcher.alertDeletingStarted[o](r,n),TradingView.alertsDispatcher.alertDeletingAllStarted[o](r,t),TradingView.alertsDispatcher.alertDeleted[o](r,n),TradingView.alertsDispatcher.alertStoppingStarted[o](r,n),TradingView.alertsDispatcher.alertStoppingAllStarted[o](r,t),TradingView.alertsDispatcher.alertStopped[o](r,n),r.mainSeries().onSymbolResolved()[o](r,e),r.mainSeries().onSymbolError()[o](r,t),r.mainSeries().properties().interval[o](r,e)}var r=this;r._alertsList.add=i,r._alertsList.remove=n,loginStateChange.subscribe(r,function(){is_authenticated?(e(),o("subscribe")):(t(),o("unsubscribe"))}),is_authenticated&&(e(),o("subscribe"))},W79.prototype.alertsList=function(){return this._alertsList},W79.prototype._modelIntervals=[],W79.prototype.setInterval=function(e,t){var i=setInterval(e,t);return this._modelIntervals.push(i),i},W79.prototype.clearInterval=function(e){clearInterval(e),e=this._modelIntervals.indexOf(e),e>-1&&this._modelIntervals.splice(e,1)},W79.prototype.clearIntervals=function(){for(var e=0;e<this._modelIntervals.length;e++)clearInterval(this._modelIntervals[e]);this._modelIntervals=[]},W79.prototype.destroy=function(){this.clearIntervals()},W79.prototype.countUserStudies=function(){for(var e=0,t=0;t<this.panes().size();t++)for(var i=this.panes().item(t).D19(),n=0;n<i.size();n++){var o=i.item(n);o instanceof TradingView.Study&&o.showInObjectTree()&&e++}return e},W79.prototype.isJustClonedChart=function(){return this._undoModel.isJustClonedChart()},DataWindowItem.prototype.title=function(){return this.m_title},DataWindowItem.prototype.text=function(){return this.m_value},DataWindowItem.prototype.visible=function(){return this._visible},DataWindowItem.prototype.color=function(){return this._color},DataWindowItem.prototype.setVisible=function(e){this._visible=e},DataWindowItem.prototype.setValue=function(e){this.m_value=e},DataWindowItem.prototype.setColor=function(e){this._color=e},DataWindowItem.prototype.value=function(){return this.m_value},DataWindowView.prototype.header=function(){return this._header},DataWindowView.prototype.title=function(){return this._title},DataWindowView.prototype.items=function(){return this._items},DataWindowView.prototype.update=function(){},StatusView.prototype.text=function(){return this._text},StatusView.prototype.setText=function(e){this._text=e},StatusView.prototype.color=function(){return this._props?this._props.scalesProperties.textColor.value():"#444"},StatusView.prototype.bold=function(){return this._bold},StatusView.prototype.size=function(){return this._size},PriceAxisView.prototype.text=function(){return this._text},PriceAxisView.prototype.background=function(){return this._background},PriceAxisView.prototype.color=function(){return new RGBColor(this._background).blackWhiteContrast()},PriceAxisView.prototype.coordinate=function(){return this._coordinate},PriceAxisViewRenderer.prototype.height=function(e){return this._data.secondLine&&e?2.2*this._data.textHeight+2:1.1*this._data.textHeight},PriceAxisViewRenderer.prototype.measureText=function(e,t){return this._textWidthCache?this._textWidthCache.measureText(e,t):e.measureText(t).width},PriceAxisViewRenderer.prototype.draw=function(e,t,i,n){function o(e,t,i,n){$.browser.webkit?--n:$.browser.mozilla?n+=1:$.browser.jsdom&&(n+=.5),e.fillText(t,i,n)}if(this._data.visible){if(this._data.font){var r=e.font;e.setFont(this._data.font)}var s=this.measureText(e,this._data.text);e.strokeStyle=this._data.borderColor,e.fillStyle=this._data.background,e.lineWidth=1,n=Math.round(1.1*this._data.textHeight);var a=this._data.coordinate,l=Math.round(a-.5*n)-.5,d=l,h=d+n+1,c=h;if(this._data.text){if(t){var p=i-1.5,u=p-s-9-2,f=u,g=i=p,m=g-3;e.beginPath(),e.moveTo(p,l),e.lineTo(u,d),e.lineTo(f,h),e.lineTo(i,c),e.fill(),e.beginPath(),e.strokeStyle=this._data.color,e.moveTo(g,a),e.lineTo(m,a),e.stroke(),e.textBaseline="middle",e.textAlign="left",e.fillStyle=this._data.color,g=p-s-.4*n}else p=.5,f=u=p+s+9+2,g=i=p,m=g+3,e.beginPath(),e.moveTo(p,l),e.lineTo(u,d),e.lineTo(f,h),e.lineTo(i,c),e.fill(),e.beginPath(),e.strokeStyle=this._data.color,e.moveTo(g,a),e.lineTo(m,a),e.stroke(),e.textBaseline="middle",e.textAlign="left",e.fillStyle=this._data.color,g=p+.4*n;o(e,this._data.text,g,a+1),this._data.font&&e.setFont(r)}this._data.secondLine&&(r=this.measureText(e,this._data.secondLine),e.fillStyle=this._data.background,this._data.text&&(l=h+1,d=c+1,h=l+n,c=d+n),t?(i=p=p-s-9-2,u=p+r+4+3):(i=p=.5+s-r+4,u=s+9+2+.5),f=u,g=p+2,e.beginPath(),e.moveTo(p,l),e.lineTo(u,d),e.lineTo(f,h),e.lineTo(i,c),e.fill(),e.textBaseline="middle",e.textAlign="left",e.fillStyle=this._data.color,t=this._data.coordinate,this._data.text&&(t+=n+2),o(e,this._data.secondLine,g,t))}},TimeAxisView.prototype.text=function(){return this._text},TimeAxisView.prototype.background=function(){return this._background},TimeAxisView.prototype.color=function(){return new RGBColor(this._background).blackWhiteContrast()},TimeAxisView.prototype.coordinate=function(){return this._coordinate},TimeAxisViewRenderer.prototype.draw=function(e,t,i){if(!1!==this._data.visible&&(this._cacheFont!=e.font&&(this._cacheFont=e.font,this._cache=new TextWidthCache),t=this._cache.measureText(e,this._data.text),!(0>=t))){i=t+6,t=Math.round(this._data.coordinate-.5*i-1.5)+1.5,i=t+i+3;var n=Math.round(this._data.coordinate+1),o=this._data.textHeight+6+.5;e.fillStyle=this._data.background,e.lineWidth=1,e.beginPath(),e.moveTo(t,.5),e.lineTo(t,o),e.lineTo(i,o),e.lineTo(i,.5),e.fill(),e.strokeStyle=this._data.color,e.beginPath(),e.moveTo(n,.5),e.lineTo(n,3.5),e.stroke(),e.textBaseline="middle",e.textAlign="left",e.fillStyle=this._data.color,$.browser.webkit?e.fillText(this._data.text,t+3+1,.5*(.5+o)+1):e.fillText(this._data.text,t+3+1,.5*(.5+o)+2)}},inherit(CrossHair,DataSource),CrossHair.prototype.index=0,CrossHair.prototype.price=NaN,CrossHair.prototype.pane=null,CrossHair.prototype.color="white",CrossHair.prototype.style="",CrossHair.prototype.properties=function(){return this.D2},CrossHair.prototype.setPosition=function(e,t,i){this._subscribed||(this.D0.mainSeries().onRestarted().subscribe(this,CrossHair.prototype.clearMeasure),this._subscribed=!0),this.index=e,this.x=this.D0.timeScale().indexToCoordinate(e),i&&!i.defaultPriceScale().isEmpty()?(this.price=t,this.y=i.defaultPriceScale().priceToCoordinate(t),this.pane=i):(this.y=this.price=NaN,this.pane=null),this.visible=!0,this.updateAllViews()},CrossHair.prototype.clearPosition=function(){this.visible=!1,this.index=parseInt(this.D0.mainSeries().data().bars().last())},CrossHair.prototype.measureStartY=function(){var e=this._startMeasurePoint.price,t=this._measurePane;if(t.defaultPriceScale().isPercent())var i=t.mainDataSource().firstValue(),e=t.defaultPriceScale().priceRange().convertToPercent(e,i);return t.defaultPriceScale().priceToCoordinate(e)},CrossHair.prototype.measureStartX=function(){return this.D0.timeScale().indexToCoordinate(this._startMeasurePoint.index)},CrossHair.prototype.measureEndY=function(){var e=this._endMeasurePoint.price,t=this._measurePane;if(t.defaultPriceScale().isPercent())var i=t.mainDataSource().firstValue(),e=t.defaultPriceScale().priceRange().convertToPercent(e,i);return t.defaultPriceScale().priceToCoordinate(e)},CrossHair.prototype.measureEndX=function(){return this.D0.timeScale().indexToCoordinate(this._endMeasurePoint.index)},CrossHair.prototype.paneViews=function(e){var t=(new List).append(new $65(this,e,e===this.pane));return e===this._measurePane&&(this._measurePaneView||(this._measurePaneView=new $64(this,e)),this._measurePaneView.update(),t.append(this._measurePaneView)),t},CrossHair.prototype.dataWindowView=function(){return this._dataWindowView},CrossHair.prototype.priceAxisViews=function(e,t){if(this.visible&&this.pane===e&&t===e.defaultPriceScale()){var i=new List;return i.append(this._priceAxisView),this._startMeasurePoint&&i.append(this._startMeasurePriceAxisView),this._endMeasurePoint&&i.append(this._endMeasurePriceAxisView),i}return null},CrossHair.prototype.timeAxisView=function(){if(!this.visible)return null;var e=new List;return e.append(this._timeAxisView),this._startMeasurePoint&&e.append(this._startMeasureTimeAxisView),this._endMeasurePoint&&e.append(this._endMeasureTimeAxisView),e},CrossHair.prototype.updateAllViews=function(){this._priceAxisView.update(),this._startMeasurePoint&&(this._startMeasurePriceAxisView.update(),this._startMeasureTimeAxisView.update()),this._endMeasurePoint&&(this._endMeasurePriceAxisView.update(),this._endMeasureTimeAxisView.update()),this._timeAxisView.update()},CrossHair.prototype.startMeasurePoint=function(){return this._startMeasurePoint},CrossHair.prototype.startMeasuring=function(e,t){if(t.defaultPriceScale().isPercent()){var i=t.mainDataSource().firstValue();e.price=t.defaultPriceScale().priceRange().convertFromPercent(e.price,i)}this._startMeasurePoint=e,this._measurePane=t},CrossHair.prototype.finishMeasure=function(e){var t=this._measurePane;if(t.defaultPriceScale().isPercent()){var i=t.mainDataSource().firstValue();e.price=t.defaultPriceScale().priceRange().convertFromPercent(e.price,i)}this._endMeasurePoint=e},CrossHair.prototype.endMeasurePoint=function(){return this._endMeasurePoint},CrossHair.prototype.clearMeasure=function(e){delete this._measurePane,delete this._startMeasurePoint,delete this._endMeasurePoint,delete this._lastValidMeasurePoint,this.D0.D20(new A22(A22.LIGHT_UPDATE))},CrossHair.prototype.measurePoints=function(){this.updateAllViews();var e=new List;if(e.append(this._startMeasurePoint),this._endMeasurePoint)e.append(this._endMeasurePoint);else{this._measurePane===this.pane&&(this._lastValidMeasurePoint={x:this.x,y:this.y,rawPrice:this.price,price:this.price,index:this.index});var t=this._lastValidMeasurePoint.rawPrice,i=this._measurePane,n=i.defaultPriceScale();n.isPercent()&&!n.isEmpty()&&(i=i.mainDataSource().firstValue(),this._lastValidMeasurePoint.price=n.priceRange().convertFromPercent(t,i)),e.append(this._lastValidMeasurePoint)}return e},CrossHair.prototype.currentPoint=function(){return new MathEx.Point(this.x,this.y)},$64.prototype.update=function(){if(this.W99._endMeasurePoint)var e=this.W99._endMeasurePoint.price,t=this.W99._endMeasurePoint.index;else if(this.W99._measurePane===this.W99.pane)e=this.W99.price,t=this.W99.index;else{if(!this.W99._lastValidMeasurePoint)return;e=this.W99._lastValidMeasurePoint.rawPrice,t=this.W99._lastValidMeasurePoint.index}var i=e-this.W99._startMeasurePoint.price,n=t-this.W99._startMeasurePoint.index,o=this.W99._startMeasurePoint.price,r=this.W99._measurePane;if(r.defaultPriceScale().isPercent()){var s=r.mainDataSource().firstValue();this.W99._endMeasurePoint&&(e=r.defaultPriceScale().priceRange().convertToPercent(e,s)),o=r.defaultPriceScale().priceRange().convertToPercent(o,s)}this._horzLabel=$.t("{0} bars").format(n),n=this.W99._measurePane.defaultPriceScale().formatter().format(i),this.W99._startMeasurePoint.price&&(r=i/this.W99._startMeasurePoint.price,
n+=" ("+(new PercentageFormatter).format(100*r)+")"),this._vertLabel=""+n,o=this.W99.D0._magnet.align(o,this.W99._startMeasurePoint.index,this.W99._measurePane),e=this.W99.D0._magnet.align(e,t,this.W99._measurePane),n=this.W99.D0.timeScale().indexToCoordinate(this.W99._startMeasurePoint.index),r=this.W99.D0.timeScale().indexToCoordinate(t),o=this.W99._measurePane.defaultPriceScale().priceToCoordinate(o),e=this.W99._measurePane.defaultPriceScale().priceToCoordinate(e),this._p1=new MathEx.Point(n,o),this._p2=new MathEx.Point(r,e),e=this.W99.D0.timeScale().indexToUserTime(this.W99._startMeasurePoint.index),t=this.W99.D0.timeScale().indexToUserTime(t),e&&t&&(t=(t.valueOf()-e.valueOf())/1e3,this._horzLabel+=", "+(new TimeSpanFormatter).format(t)),(t=this.W99._measurePane.mainDataSource().base())&&(i=Math.round(i*t),this._vertLabel+=" , "+i)},$64.prototype.renderer=function(){var e=new CompositeRenderer,t={};t.points=(new List).append(this._p1).append(this._p2),t.width=this.W99.D0.timeScale().width(),t.height=this.W99._measurePane.defaultPriceScale().height(),t.color="#D3E7FF",t.linewidth=0,t.fillBackground=!0,t.transparency=60,t.backcolor="#BADAFF",e.append(new RectangleRenderer(t));var i=this._p1.add(this._p2).scaled(.5),n=new MathEx.Point(this._p1.x,i.y),o=new MathEx.Point(this._p2.x,i.y),n={points:(new List).append(n).append(o),width:t.width,height:t.height,color:"#646668",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_ARROW};return e.append(new TrendLineRenderer(n)),n=new MathEx.Point(i.x,this._p1.y),o=new MathEx.Point(i.x,this._p2.y),n={points:(new List).append(n).append(o),width:t.width,height:t.height,color:"#646668",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_ARROW},e.append(new TrendLineRenderer(n)),t=function(e,t){return{points:(new List).append(t),text:e,color:"#FFFFFF",horzAlign:"center",vertAlign:"middle",font:"Arial",offsetX:5,offsetY:0,bold:!1,italic:!1,fontsize:12,highlightBorder:!1,backgroundColor:"#646668",backgroundTransparency:20,backgroundVertInflate:5,backgroundHorzInflate:5}},i=i.add(new MathEx.Point(0,-10)),i=t(this._horzLabel,i),e.append(new TextRenderer(i,this._rendererCache)),i=this._p2.y,this._p1.y>this._p2.y&&(i-=27),i=new MathEx.Point(.5*(this._p1.x+this._p2.x),i),i=t(this._vertLabel,i),e.append(new TextRenderer(i,this._rendererCache)),e},$65.prototype.update=function(){},$65.prototype.renderer=function(){var e={},t=this.source.visible&&this.source.areLinesVisible;e.horzLinesVisible=t&&this._horzVisible,e.vertLinesVisible=t;var i=(t=this.pane.D0.readOnly())?defaults("chartproperties.paneProperties.crossHairProperties"):null,n=TradingView.isMobile.any()&&W47.isLineTool(this.source.D0.currentTool()),o=n?"#a000a0":t?i.color:this.pane.D0.properties().paneProperties.crossHairProperties.color.value(),r=t?i.transparency:this.pane.D0.properties().paneProperties.crossHairProperties.transparency.value();return!n&&r>0&&(o=generateColor(o,r)),e.color=o,e.lineWidth=t?i.width:this.pane.D0.properties().paneProperties.crossHairProperties.width.value(),e.lineStyle=t?i.style:this.pane.D0.properties().paneProperties.crossHairProperties.style.value(),e.drawCenter=n&&this.pane==this.source.pane,e.w=this.pane.width(),e.h=this.pane.height(),e.x=this.source.x,e.y=this.source.y,new W62(e)},W62.prototype.draw=function(e){var t=this.data.vertLinesVisible,i=this.data.horzLinesVisible;if((t||i)&&this.data){e.lineStyle=this.data.lineStyle,e.lineWidth=this.data.lineWidth,e.strokeStyle=this.data.color;var n=0==this.data.lineWidth%2?.5:0,o=this.data.x+1+n,n=this.data.y+n,r=this.data.w,s=this.data.h;t&&o>=0&&CanvasEx.drawLine(e,o,0,o,s),i&&n>=0&&CanvasEx.drawLine(e,0,n,r,n),this.data.drawCenter&&(e.beginPath(),e.arc(o,n,3,0,2*Math.PI,!0),e.fillStyle=this.data.color,e.fill())}},inherit(CrossHairPriceAxisView,PriceAxisView),CrossHairPriceAxisView.prototype.update=function(){var e=this._rendererData,t=this._crossHair.pane;if(e.coordinate=this._crossHair.y,this.text="",t&&this._crossHair.visible&&(t=t.defaultPriceScale(),!t.isEmpty())){var i;i=(i=t.mainSource())?i.formatter():this._defaultFormatter,e.text=i.format(this._crossHair.price),e.textHeight=t.m_markBuilder.fontHeight()}},CrossHairPriceAxisView.prototype.renderer=function(){return this._renderer||(this._renderer=new PriceAxisViewRenderer(this._rendererData)),this._renderer},inherit(CrossHairTimeAxisView,TimeAxisView),CrossHairTimeAxisView.prototype.update=function(){var e=this._rendererData;this.D0.timeScale(),e.coordinate=this._crosshair.x;var t=this.D0.timeScale().indexToUserTime(this._crosshair.index);t?(e.visible=!0,e.text=new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(t)):(e.visible=!1,e.text="")},CrossHairTimeAxisView.prototype.renderer=function(){var e=this._rendererData;return this._renderer||(this._renderer=new TimeAxisViewRenderer(e)),this._renderer},inherit(CrossHairDataWindowView,DataWindowView),CrossHairDataWindowView.prototype.update=function(){var e=this.D0.mainSeries().isDWM();if(this._items.item(1).setVisible(!e),this._items.item(0).setValue("n/a"),this._items.item(1).setValue("n/a"),this._items.item(2).setValue("n/a"),!this.D0.timeScale().isEmpty()){var t=this._crossHair.index,t=this.D0.timeScale().indexToUserTime(t);null===t?(this._items.item(0).setValue("n/a"),e||this._items.item(1).setValue("n/a")):(this._items.item(0).setValue((new DateFormatter).format(t)),e||this._items.item(1).setValue((new TimeFormatter).format(t))),(e=this._crossHair.pane)&&(e=e.defaultPriceScale(),e.isEmpty()||(e=(e=e.mainSource())?e.formatter():this._defaultFormatter,this._items.item(2).setValue(e.format(this._crossHair.price))))}},Grid.prototype.paneViews=function(e){return(new List).append(new $83(this,e))},$83.prototype.update=function(){},$83.prototype.renderer=function(){var e={};return this.pane.defaultPriceScale().isEmpty()||this.pane.timeScale().isEmpty()?null:(e.horzLinesVisible=!0,e.vertLinesVisible=!0,e.horzLinesColor=this.pane.D0.properties().paneProperties.gridProperties.color.value(),e.vertLinesColor=e.horzLinesColor,e.lineStyle=this.pane.D0.properties().paneProperties.gridProperties.style.value(),e.priceMarks=this.pane.defaultPriceScale().marks(),e.timeMarks=this.pane.timeScale().marks(),e.w=this.pane.width(),e.h=this.pane.height(),new W65(e))},W65.prototype.draw=function(e){CanvasEx.setLineStyle(e,this.data.lineStyle);var t,i=e.lineStyle!=CanvasEx.LINESTYLE_SOLID&&!("setLineDash"in e||"mozDash"in e||"webkitLineDash"in e),n=i?CanvasEx.computeDashPattern(e):null;if(e.translate(.5,-.5),e.lineWidth=1,this.data.vertLinesVisible){for(e.fillStyle=this.data.vertLinesColor,e.beginPath(),t=0;t<this.data.timeMarks.length;t++)i?e.dashedLineTo(this.data.timeMarks[t].coord,0,this.data.timeMarks[t].coord,this.data.h,n):e.rect(this.data.timeMarks[t].coord,0,1,this.data.h);e.closePath(),e.fill()}if(this.data.horzLinesVisible){for(e.fillStyle=this.data.horzLinesColor,e.beginPath(),t=0;t<this.data.priceMarks.length;t++)i?e.dashedLineTo(0,this.data.priceMarks[t].coord,this.data.w,this.data.priceMarks[t].coord,n):e.rect(0,this.data.priceMarks[t].coord,this.data.w,1);e.closePath(),e.fill()}},Legend.prototype.items=function(){return this.m_items},LegendItem.prototype.title=function(){return this.m_title},LegendItem.prototype.color=function(){return this.m_color},LegendItem.prototype.dataSource=function(){return this.m_dataSource},W75.DEFAULT_STRETCH_FACTOR=1e3,W75.PANE_ANIMATION_DURATION=500,W75.alwaysTopSources=["LineToolOrder","LineToolPosition","LineToolExecution"],W75.sortSourcesPreOrdered={"Volume@tv-basicstudies":0,"Script$TV_DIVIDENDS@tv-scripting":1,"Script$TV_SPLITS@tv-scripting":2,"Script$TV_EARNINGS@tv-scripting":3},W75.prototype.destroy=function(){this.D2.topMargin.listeners().unsubscribe(this,W75.prototype._updateMargins),this.D2.bottomMargin.listeners().unsubscribe(this,W75.prototype._updateMargins)},W75.prototype.setPaneSize=function(e){var t={large:1,medium:.6,small:.3,tiny:.15};if(!t[e])throw"Unknown size enum value: "+e;this._stretchFactor=t[e]*W75.DEFAULT_STRETCH_FACTOR},W75.sortSources=function(e){e.sort(function(e,t){if(0<=W75.alwaysTopSources.indexOf(e._constructor))return 1;if(0<=W75.alwaysTopSources.indexOf(t._constructor))return-1;var i=e.zorder(),n=t.zorder();return n==i&&(i=n-1,e.setZorder(i)),i-n});var t,i=[],n=[];for(t in W75.sortSourcesPreOrdered)n.push(null);t=0;for(var o=e.length;o>t;t++){var r=e[t];if(isFunction(r.metaInfo)){var s=r.metaInfo().id,s=W75.sortSourcesPreOrdered[s];s>0?n[s]=r:i.push(r)}else i.push(r)}for(t=0,o=n.length;o>t;t++)(r=n[t])&&i.push(r);return i},W75.prototype._updateMargins=function(){var e=.01*this.D2.topMargin.value(),t=.01*this.D2.bottomMargin.value();this.m_leftPriceScale.setTopMargin(e),this.m_leftPriceScale.setBottomMargin(t),this.m_rightPriceScale.setTopMargin(e),this.m_rightPriceScale.setBottomMargin(t);for(var i=0;i<this.m_dataSources.size();i++){var n=this.m_dataSources.item(i);n instanceof TradingView.Study&&this.isOverlay(n)&&"Volume"!==n.metaInfo().shortId&&n.priceScale()&&n.priceScale()!==this.m_leftPriceScale&&n.priceScale()==this.m_rightPriceScale&&(n.priceScale().setTopMargin(e),n.priceScale().setBottomMargin(t),this.recalculatePriceScale(n.priceScale()))}this.recalculatePriceScale(this.m_leftPriceScale),this.recalculatePriceScale(this.m_rightPriceScale),this.updateAllViews()},W75.prototype.model=function(){return this.D0},W75.prototype.width=function(){return this.m_width},W75.prototype.height=function(){return this.m_height},W75.prototype.setWidth=function(e){this.m_width=e,this.updateAllViews()},W75.prototype.setHeight=function(e){this.m_height=e,this.m_leftPriceScale.setHeight(e),this.m_rightPriceScale.setHeight(e);for(var t=0;t<this.m_dataSources.size();t++){var i=this.m_dataSources.item(t);this.isOverlay(i)&&i.priceScale()&&i.priceScale().setHeight(e)}this.updateAllViews()},W75.prototype.leftPriceScale=function(){return this.m_leftPriceScale},W75.prototype.rightPriceScale=function(){return this.m_rightPriceScale},W75.prototype.timeScale=function(){return this.m_timeScale},W75.prototype.D19=function(){return this.m_dataSources},W75.prototype.isOverlay=function(e){return e._isOverlay},W75.prototype.legend=function(){return this.m_legend},W75.prototype._processMainSourceChange=function(){var e;if(null===this.m_mainDataSource)for(var t=0;t<this.m_dataSources.size();t++){var i=this.m_dataSources.item(t);if(!(!isInherited(i.constructor,PriceDataSource)||this.isOverlay(i)||i.properties().linkedToSeries&&i.properties().linkedToSeries.value()||i instanceof TradingView.AlertLabel)){this.m_mainDataSource=i,e=!0;break}}if(this.m_mainDataSource&&e){for(e=[],t=0;t<this.m_dataSources.size();t++)i=this.m_dataSources.item(t),isInherited(i.constructor,W47)&&e.push(i);for(e=W75.sortSources(e),t=0;t<e.length;t++)this.move(e[t],this.m_mainDataSource.priceScale())}else if(!this.m_mainDataSource)for(t=0;t<this.m_dataSources.size();t++)if(i=this.m_dataSources.item(t),isInherited(i.constructor,PriceDataSource)&&this.isOverlay(i)&&i.showInObjectTree()){this.m_mainDataSource=i,this.m_rightPriceScale.addDataSource(i),i.setPriceScale(this.m_rightPriceScale);for(var t=this.D0.children(i),n=0;n<t.size();n++)e=t.item(n),this.m_rightPriceScale.addDataSource(e),e.setPriceScale(this.m_rightPriceScale);this.recalculatePriceScale(this.m_rightPriceScale),i._isOverlay=!1;break}},W75.prototype.addDataSource=function(e,t){this.m_dataSources.append(e);var i=!1;null!==this.m_mainDataSource||e instanceof TradingView.AlertLabel||(this.m_mainDataSource=e,i=!0),e._isOverlay=!1,null===t&&(t=new W76(new Property(this.D2.overlayPropreties.state())),t.setHeight(this.m_height),t.setTopMargin(this.m_rightPriceScale.topMargin()),t.setBottomMargin(this.m_rightPriceScale.bottomMargin()),e._isOverlay=!0),t.addDataSource(e),e.setPriceScale(t),e.onTagsChanged&&e.onTagsChanged().subscribe(this,W75.prototype.onSourceTagsChanged),e.setZorder(this.getZOrderMinMax().minZOrder-1),i&&this._processMainSourceChange(),e instanceof TradingView.AlertLabel||this.updateAlertLabelsSources(),this._tagsChanged.fire(),isInherited(e.constructor,PriceDataSource)&&this.recalculatePriceScale(t),this.invalidateSourcesCache()},W75.prototype.removeDataSource=function(e,t){if(this.m_dataSources.contains(e)){e._isOverlay=!1,this.m_dataSources.remove(e),e!==this.m_mainDataSource||t||(this.m_mainDataSource=null);var i=null;this.m_leftPriceScale.D19().contains(e)?(this.m_leftPriceScale.removeDataSource(e),i=this.m_leftPriceScale):this.m_rightPriceScale.D19().contains(e)&&(this.m_rightPriceScale.removeDataSource(e),i=this.m_rightPriceScale),e.onTagsChanged&&e.onTagsChanged().unsubscribe(this,W75.prototype.onSourceTagsChanged),isInherited(e.constructor,PriceDataSource)&&this._processMainSourceChange(),e instanceof TradingView.AlertLabel||this.D0.mainSeries()!==e||this.updateAlertLabelsSources(),this._tagsChanged.fire(),i&&isInherited(e.constructor,PriceDataSource)&&this.recalculatePriceScale(i),this.invalidateSourcesCache()}else TradingView.logDebug("removeDataSource: invalid data source")},W75.prototype.updateAlertLabelsSources=function(){for(var e=this.containsMainSeries(),t=this.D0.alertsList(),i=$.map($.grep(this.D19().toArray(),function(e){return e instanceof TradingView.AlertLabel}),function(e){return e.alert().id()}),n=t.size()-1;n>=0;n--){var o=t.item(n),r=-1!==i.indexOf(o.id());if(!r&&(e||!o.isOHLC())){var s=new TradingView.AlertLabel(this.D0,o),a=this.rightPriceScale()||this.leftPriceScale();this.addDataSource(s,a)}r&&!e&&o.isOHLC()&&this.removeDataSource(new TradingView.AlertLabel(r))}},W75.prototype.startScalePrice=function(e,t){e.startScale(t)},W75.prototype.scalePriceTo=function(e,t){e.scaleTo(t),this.updateAllViews()},W75.prototype.endScalePrice=function(e){e.endScale()},W75.prototype.startScrollPrice=function(e,t){e.startScroll(t)},W75.prototype.scrollPriceTo=function(e,t){e.scrollTo(t),this.updateAllViews()},W75.prototype.endScrollPrice=function(e){e.endScroll()},W75.prototype.setPriceAutoScale=function(e,t){e.setAutoScale(t),this.timeScale().isEmpty()?e.setPriceRange(null):this.recalculatePriceScale(e)},W75.prototype.restorePriceScaleState=function(e,t){e.restoreState(t),this.updateAllViews()},W75.prototype.updateAllViews=function(){for(var e=0;e<this.D19().size();e++)this.D19().item(e).updateAllViews()},W75.prototype.defaultPriceScale=function(){if(!this.m_mainDataSource)var e=this.rightPriceScale();return this.m_mainDataSource&&(e=this.m_mainDataSource.priceScale()),void 0==e&&(props=new Property(this.D2.overlayPropreties.state()),e=new W76(props)),e},W75.prototype._priceScaleIsPrice=function(e){return(e=e.mainSource())?isInherited(e.constructor,TradingView.Series)?!0:isInherited(e.constructor,TradingView.Study)?e.metaInfo().is_price_study:!1:!1},W75.prototype.findSuitableScale=function(e){var t=!1;if(isInherited(e.constructor,TradingView.Study)?t=e.metaInfo().is_price_study:isInherited(e.constructor,TradingView.Series)&&(t=!0),t){if(this._priceScaleIsPrice(this.m_rightPriceScale))return this.m_rightPriceScale;if(this._priceScaleIsPrice(this.m_leftPriceScale))return this.m_leftPriceScale}return this.m_rightPriceScale.mainSource()?this.m_leftPriceScale.mainSource()?null:this.m_leftPriceScale:this.m_rightPriceScale},W75.prototype.mainDataSource=function(){return this.m_mainDataSource},W75.prototype.recalculatePriceScale=function(e){if(e){if(e.isAutoScale()&&!this.timeScale().isEmpty()){var t=this.timeScale().visibleBars();e.recalculatePriceRange(t)}e.updatePaneViews()}},W75.prototype.resetPriceScale=function(e){var t=this.timeScale().visibleBars();e.mainSource()instanceof TradingView.Series&&e.mainSource().isLockScale()||e.setAutoScale(!0),e.recalculatePriceRange(t),this.updateAllViews()},W75.prototype._recalculateImpl=function(){if(this._needRecalc){this.recalculatePriceScale(this.m_rightPriceScale),this.recalculatePriceScale(this.m_leftPriceScale);for(var e=0;e<this.m_dataSources.size();e++){var t=this.m_dataSources.item(e);this.isOverlay(t)&&this.recalculatePriceScale(t.priceScale())}this.updateAllViews(),this.D0.updatePane(this),this._needRecalc=!1}},W75.prototype.recalculate=function(e){this._needRecalc=!0,e&&this._recalculateImpl()},W75.prototype.isEmpty=function(){return null===this.m_mainDataSource},W75.prototype.move=function(e,t){var i=this.m_dataSources.clone();this.removeDataSource(e,null!==t),this.addDataSource(e,t),this.m_dataSources=i,this.invalidateSourcesCache()},W75.prototype.dataSourceForId=function(e){for(var t=0;t<this.m_dataSources.size();t++)if(this.m_dataSources.item(t).id()===e)return this.m_dataSources.item(t);return null},W75.prototype.priceScaleForSource=function(e){return this.rightPriceScale().D19().contains(e)?this.rightPriceScale():this.leftPriceScale().D19().contains(e)?this.leftPriceScale():null},W75.prototype.sourceById=function(e){for(var t=0;t<this.m_dataSources.size();t++)if(this.m_dataSources.item(t).id()===e)return this.m_dataSources.item(t);return null},W75.prototype.containsMainSeries=function(){return this.m_dataSources.contains(this.D0.mainSeries())},W75.prototype.priceScaleByName=function(e){return"left"===e?this.m_leftPriceScale:"right"===e?this.m_rightPriceScale:null},W75.prototype.priceScaleName=function(e){return e===this.m_leftPriceScale?"left":e===this.m_rightPriceScale?"right":""},W75.prototype.hitTestSources=function(){if(this._cachedHitTestSources)return this._cachedHitTestSources;for(var e=this.orderedSources(),t=[],i=[],n=0;n<e.length;n++){var o=e[n];isInherited(o.constructor,W47)?t.push(o):i.push(o)}return this._cachedHitTestSources=i.concat(t)},W75.prototype.orderedSources=function(){if(this._cachedOrderedSoruces)return this._cachedOrderedSoruces;for(var e=[],t=0,i=this.D19().size();i>t;t++){var n=this.D19().item(t);isInherited(n.constructor,W47)&&!n.isActualSymbol()||e.push(n)}return this._cachedOrderedSoruces=e=W75.sortSources(e)},W75.prototype.invalidateSourcesCache=function(){this._cachedHitTestSources=this._cachedOrderedSoruces=null,this.m_leftPriceScale.invalidateSourcesCache(),this.m_rightPriceScale.invalidateSourcesCache()},W75.prototype.getZOrderMinMax=function(){for(var e=this.orderedSources(),t=Number.MAX_VALUE,i=-Number.MAX_VALUE,n=0;n<e.length;n++){var o=e[n];o.showInObjectTree()&&(o.zorder()<t&&(t=o.zorder()),o.zorder()>i&&(i=o.zorder()))}return{minZOrder:t,maxZOrder:i}},W75.prototype.sendToBack=function(e){for(var t=this.getZOrderMinMax().minZOrder,t=Math.abs(e.zorder()-t),i=0;t>i;i++)this.changeZOrder(e,-1)},W75.prototype.bringToFront=function(e){for(var t=this.getZOrderMinMax().maxZOrder,t=Math.abs(e.zorder()-t),i=0;t>i;i++)this.changeZOrder(e,1)},W75.prototype.changeZOrder=function(e,t){for(var i=this.orderedSources().filter(function(e){return e.showInObjectTree()}),n=0,o=0,r=i.length;r>o;o++)if(i[o]===e){n=o;break}n>0&&0>t?(r=i[n-1].zorder(),o=e.zorder(),i[n-1].setZorder(o),e.setZorder(r)):n<i.length-1&&t>0&&(r=i[n+1].zorder(),o=e.zorder(),i[n+1].setZorder(o),e.setZorder(r)),this.invalidateSourcesCache()},W75.prototype.onSourceTagsChanged=function(){this._tagsChanged.fire()},W75.prototype.onTagsChanged=function(){return this._tagsChanged},W75.prototype.dumpPriceScale=function(e){for(var t=new List,i=e.D19().clone(),n=0;n<i.size();++n){var o=i.item(n).priceAxisViews(this,e);o&&t.appendAll(o)}for(e=[],n=0;n<t.size();n++)e.push(t.item(n).dump());return e},W75.prototype.dumpViews=function(){for(var e={paneViews:{}},t=this.orderedSources(),i=0;i<t.length;i++){var n=t[i];if(e.paneViews[i]=[],n=n.paneViews())for(var o=0;o<n.size();o++)e.paneViews[i].push(n.item(i).dump())}return e.leftAxis=this.dumpPriceScale(this.m_leftPriceScale),e.rightAxis=this.dumpPriceScale(this.m_rightPriceScale),e},W75.prototype.clearSeries=function(){for(var e=this.m_dataSources.size()-1;e>=0;e--)isInherited(this.m_dataSources.item(e).constructor,TradingView.Series)&&this.m_dataSources.removeAt(e)},W75.prototype.actionNoScaleIsEnabled=function(e){return this.isOverlay(e)||!isInherited(e.constructor,PriceDataSource)?!0:1<this.D19().count(function(e){return e.properties().linkedToSeries&&e.properties().linkedToSeries.value()?!1:isInherited(e.constructor,PriceDataSource)&&e.showInObjectTree()&&!e.isNoScale()})},W75.prototype.executionsPositionController=function(){return this._executionsPositionController||(this._executionsPositionController=new ExecutionsPositionController(this,this.D0.timeScale())),this._executionsPositionController},W56.prototype.draw=function(e){e.save(),e.translate(.5,.5);for(var t,i=0;i<this.bars.size();++i){var n=this.bars.item(i);t!==n.color&&(t=e.fillStyle=n.color),e.fillRect(Math.round(n.time-this.barLineWidth/2),Math.round(n.high-this.barWidth/2),Math.round(this.barLineWidth),Math.round(n.low-n.high+this.barWidth)),this.barLineWidth<this.barSpacing-1&&(this.dontDrawOpen||e.fillRect(Math.round(n.time-1.5*this.barWidth),Math.round(n.open-this.barWidth/2),Math.round(1.5*this.barWidth),Math.round(this.barWidth)),e.fillRect(Math.round(n.time),Math.round(n.close-this.barWidth/2),Math.round(1.5*this.barWidth),Math.round(this.barWidth)))}e.restore()},W56.prototype.hitTest=function(e){var t=this.bars,i=.5*this.barSpacing;if(t.isEmpty()||e.x<t.first().time-i||e.x>t.last().time+i)return null;for(var n=null,o=0;o<t.size();++o){var r=t.item(o);if(e.x<=r.time+i){n=r;break}}return t=selectionTolerance(this.barLineWidth),n&&n.high-t<=e.y&&e.y<=n.low+t?new HitTestResult(HitTestResult.REGULAR):null},W70.prototype.draw=function(e){e.save(),e.lineCap="butt",e.translate(.5,.5),e.lineWidth=this.barLineWidth;for(var t,i=this.barWidth/2,n=0;n<this.bars.size();++n){t=this.bars.item(n);var o=t.exactTime-i,r=t.exactTime+i-o,s=Math.round(t.high),a=0==t.low-t.high?1:Math.round(t.low-t.high);e.fillStyle=t.borderColor,e.fillRect(o,s,r,a),e.fillStyle=t.color,e.fillRect(o+this.barLineWidth,s+this.barLineWidth,r-2*this.barLineWidth,a-2*this.barLineWidth)}e.restore()},W70.prototype.hitTest=function(e){var t=this.bars,i=.5*this.barWidth;if(t.isEmpty()||e.x<t.first().time-i||e.x>t.last().time+i)return null;for(var n=null,o=0;o<t.size();++o){var r=t.item(o);if(e.x<=r.time+i){n=r;break}}return t=selectionTolerance(this.barLineWidth),n&&n.high-t<=e.y&&e.y<=n.low+t?new HitTestResult(HitTestResult.REGULAR):null},W67.prototype.draw=function(e){e.save(),e.lineCap="square",e.translate(.5,.5);for(var t=0;t<this.bars.size();++t){var i=this.bars.item(t),n=Math.round(.5*this.barLineWidth);i.isTwoColorBar?(e.fillStyle=i.upColor,e.fillRect(Math.round(i.exactTime-n),Math.round(i.high-n),Math.round(2*n),Math.round(i.additionalPrice-i.high+n)),e.fillStyle=i.downColor,e.fillRect(Math.round(i.exactTime-n),Math.round(i.additionalPrice),Math.round(2*n),Math.round(i.low-i.additionalPrice+n))):(e.fillStyle=i.color,e.fillRect(Math.round(i.exactTime-n),Math.round(i.high-n),Math.round(2*n),Math.round(i.low-i.high)+2*n)),i.combinedWithProjection||(e.fillStyle=i.isTwoColorBar?i.isUp?i.downColor:i.upColor:i.color,e.fillRect(Math.round(i.exactTime-this.barSpacing+n),Math.round(i.open-n),Math.round(this.barSpacing-2*n+1),Math.round(2*n)))}e.restore()},W67.prototype.hitTest=function(e){var t=this.bars,i=.5*this.barLineWidth;if(t.isEmpty()||e.x<t.first().time-i||e.x>t.last().time+i)return null;for(var n=null,o=0;o<t.size();++o){var r=t.item(o);if(e.x<=r.time+i){n=r;break}}return t=selectionTolerance(.5*this.barLineWidth),n&&n.high-t<=e.y&&e.y<=n.low+t?new HitTestResult(HitTestResult.REGULAR):null},W69.prototype.draw=function(e){e.save(),e.lineCap="butt",e.translate(.5,.5);for(var t=0;t<this.bars.size();++t){bar=this.bars.item(t);var i=(bar.low-bar.high)/bar.additionalNum;e.beginPath();for(var n=0;n<bar.additionalNum;n++)bar.isUp?(e.moveTo(Math.round(bar.time-.5*this.barWidth)+.5,bar.high+n*i),e.lineTo(Math.round(bar.time+.5*this.barWidth)-.5,bar.high+(n+1)*i),e.moveTo(Math.round(bar.time+.5*this.barWidth)-.5,bar.high+n*i),e.lineTo(Math.round(bar.time-.5*this.barWidth)+.5,bar.high+(n+1)*i)):this.drawEllipse(e,bar.time-.45*this.barWidth+.5,bar.high+n*i,Math.round(.9*this.barWidth),Math.round(i));e.strokeStyle=bar.color,e.lineWidth=1,e.stroke()}e.restore()},W69.prototype.drawEllipse=function(e,t,i,n,o){e.save(),e.translate(t+n/2,i+o/2),e.scale(n/2,o/2),e.moveTo(1,0),e.arc(0,0,.95,0,2*Math.PI,!1),e.restore()},W69.prototype.hitTest=function(e){var t=this.bars,i=.5*this.barSpacing;if(t.isEmpty()||e.x<t.first().time-i||e.x>t.last().time+i)return null;for(var n=null,o=0;o<t.size();++o){var r=t.item(o);if(e.x<=r.time+i){n=r;break}}return t=selectionTolerance(this.barWidth),n&&n.high-t<=e.y&&e.y<=n.low+t?new HitTestResult(HitTestResult.REGULAR):null},W66.prototype.draw=function(e){e.translate(.5,.5),e.fillStyle=this.lineColor;for(var t=this.lineWidth,i=0;i<this.items.size();++i){var n=this.items.item(i),o=n.x,r=n.y;n.style&&(e.fillStyle=n.style.color,t=n.style.width),e.fillRect(Math.round(o-.5*t),r,t,this.histogramBase-r)}},W66.prototype.hitTest=function(e){for(var t,i,n=selectionTolerance(this.lineWidth),o=0;o<this.items.size();++o)if(t=this.items.item(o),i=t.x,t=t.y,i=MathEx.distanceToSegment(new MathEx.Point(i,t),new MathEx.Point(i,this.histogramBase),new MathEx.Point(e.x,e.y)),i.distance<=n)return new HitTestResult(HitTestResult.REGULAR);return null},W60.prototype.draw=function(e){if(0!==this.items.size())if(TradingView.D18("tv4603_tv4590")){var t=this.barSpacing,i=this.lineColor,n=this.histogramBase;e.translate(.5,.5);for(var o={},r=this.items.toArray(),s=0;s<r.length;++s){var a,l=r[s],d=0==s?null:r[s-1];a=l.style?l.style.color:i;var h=o[a]||[];h.push({item:l,prev:d}),o[a]=h}for(a in o){for(h=o[a],e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1,e.beginPath(),s=0;s<h.length;s++){var l=h[s].item,r=Math.ceil(l.x-.5*t),c=Math.ceil(r+t),p=l.y;e.rect(r,p,c-r,n-p)}for(e.fill(),e.beginPath(),s=0;s<h.length;s++)l=h[s].item,r=Math.ceil(l.x-.5*t),c=Math.ceil(r+t),p=l.y,d=h[s].prev,e.moveTo(c-.5,n),e.lineTo(c-.5,p+.5),e.lineTo(r+.5,p+.5),d&&d.y>p&&e.lineTo(r+.5,d.y);e.stroke()}}else for(e.translate(.5,.5),i=this.lineColor,t=n=this.histogramBase,s=0;s<this.items.size();++s)l=this.items.item(s),r=Math.ceil(l.x-.5*this.barSpacing),c=Math.ceil(r+this.barSpacing),p=l.y,a=l.style?l.style.color:i,o!==a&&(o=a,e.fillStyle=a),e.fillRect(r,p,c-r,n-p),2>=this.barSpacing?e.fillRect(r,p,c-r,n-p):(e.beginPath(),t>p&&e.rect(r,p,1,t-p),e.rect(c-1,p,1,n-p),e.rect(r,p,c-r,1),e.fill(),t=p)},W60.prototype.hitTest=function(e){for(var t=.5*this.barSpacing+this.lineWidth,i=e.x-t,t=e.x+t,n=this.items.toArray(),o=n.length;o--;){var r=n[o].x;if(r>=i&&t>=r&&(r=n[o].y,e.y>=Math.min(r,this.histogramBase)&&e.y<=Math.max(r,this.histogramBase)))return new HitTestResult(HitTestResult.REGULAR)}return null},W68.prototype.draw=function(e){e.lineCap="square",e.lineJoin=this.withMarkers?"round":"miter",e.strokeStyle=this.lineColor,e.fillStyle=this.lineColor,e.lineWidth=this.lineWidth,e.lineStyle=this.lineStyle,this._simpleMode?this._drawSimpleMode(e):this._drawLines(e)},W68.prototype._drawSimpleMode=function(e){if(e.beginPath(),this.walkLine(e,this.items.toArray()),e.stroke(),this.withMarkers){i=this.items.size();var t,n=this.lineWidth+2,o=2*Math.PI;for(e.beginPath();i--;)(t=this.items.item(i))&&(e.moveTo(t.x,t.y),e.arc(t.x,t.y,n,0,o));e.fill()}},W68.prototype.walkLine=function(e,t,i,n){if(t){for(var o,r,s,a,l=.25*this.barSpacing,d=paneRendererCoordinateIsValid,h=0,c=t.length;c>h;h++)if(a=t[h],d(a.y)){r=a,o=h;break}if("undefined"!=typeof o&&r)for(var p=this.withSteps&&this.lineWidth&&0==this.lineWidth%2?.5:0,h=o,c=t.length;c>h;h++){if(r=t[h],a=t[h+1]||{},d(r.y))if(s&&d(s.y))this.withSteps&&e.lineTo(s.x+p,r.y+p),e.lineTo(r.x+p,r.y+p),i&&!d(a.y)&&e.lineTo(r.x+p,n);else if(a&&d(a.y))i?(h!=o&&e.lineTo(r.x+p,n),e.lineTo(r.x+p,r.y+p)):e.moveTo(r.x+p,r.y+p);else if(i){if(0===h)continue;h!=o&&e.lineTo(r.x-l+p,n),e.lineTo(r.x-l+p,r.y+p),e.lineTo(r.x+l+p,r.y+p),e.lineTo(r.x+l+p,n)}else e.moveTo(r.x-l+p,r.y+p),e.lineTo(r.x+l+p,r.y+p);s=r}}},W68.prototype._drawLines=function(e){function t(t,i,n){s(i.y)&&(s(t.y)?e.lineTo(i.x,i.y):n&&s(n.y)?e.moveTo(i.x,i.y):(e.moveTo(i.x-r,i.y),e.lineTo(i.x+r,i.y)))}if(this.items.size()){var i,n,o,r=.25*this.barSpacing,s=paneRendererCoordinateIsValid;e.beginPath(),(i=this.items.item(0))&&e.moveTo(i.x,i.y);for(var a=e.strokeStyle,l=e.lineWidth,d=e.lineStyle,h=1;h<this.items.size();++h){i=this.items.item(h-1),n=this.items.item(h),o=this.items.item(h+1);var c,p,u;n.style&&!this.forceLineColor?(c=n.style.color,p=n.style.width,u=n.style.style):(c=this.lineColor,p=this.lineWidth,u=this.lineStyle),this.ignorePaletteLineWidth&&(p=this.lineWidth),c!=a||p!=l||u!=d?(a=c,l=p,d=u,e.stroke(),e.beginPath(),e.strokeStyle=c,e.lineWidth=p,e.lineStyle=u,u===CanvasEx.LINESTYLE_SOLID?(e.moveTo(i.x,i.y),t(i,n,o)):CanvasEx.drawLine(e,i.x,i.y,n.x,n.y)):t(i,n,o)}e.stroke()}},W68.prototype.hitTest=function(e){for(var t,i,n,o,r=selectionTolerance(this.lineWidth),s=0,a=this.items.size()-1;a-s>2;)t=Math.round((a+s)/2),this.items.item(t).x<=e.x?s=t:a=t;for(s=Math.max(1,s-1),a=Math.min(this.items.size()-1,a+1);a>=s;++s)if(t=this.items.item(s-1),i=this.items.item(s),n=t.x,o=i.x,t=MathEx.distanceToSegment(new MathEx.Point(n,t.y),new MathEx.Point(o,i.y),new MathEx.Point(e.x,e.y)),t.distance<=r)return this.hittest?this.hittest:new HitTestResult(HitTestResult.REGULAR);return null},inherit(W53,W68),W53.prototype.draw=function(e){if(0!==this.items.size()){e.lineCap="square",e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth,e.lineStyle=this.lineStyle,e.lineWidth=1,e.beginPath();for(var t,i=0,n=this.items.size();n>i;i++){var o=this.items.item(i);if(paneRendererCoordinateIsValid(o.y)){t=o;break}}if(t){e.moveTo(t.x,this.bottom),W68.prototype.walkLine.call(this,e,this.items.toArray(),!0,this.bottom);for(var r,i=this.items.size()-1;i>=0;i--)if(o=this.items.item(i),paneRendererCoordinateIsValid(o.y)){r=o;break}e.moveTo(r.x,this.bottom),e.closePath(),t=e.createLinearGradient(0,0,0,this.bottom),t.addColorStop(0,this.color1),t.addColorStop(1,this.color2),e.fillStyle=t,e.fill(),e.lineWidth=this.lineWidth,W68.prototype.draw.call(this,e)}}},W57.prototype.draw=function(e){var t,i,n,o=this._data.bars.clone(),r=this._data.barSpacing,s=this._data.drawWick,a=this._data.drawBorder,l=this._data.wickColor,d=this._barBorderWidth,h=this._barWidth,c=o.size();if(e.lineCap="square",e.lineStyle=this._data.lineStyle,1>r){if(s){for(e.strokeStyle=l,e.lineWidth=1,e.beginPath(),c=o.size();0<c--;)r=o.item(c),e.moveTo(r.time,r.low),e.lineTo(r.time,r.high);e.stroke()}for(e.lineWidth=1,a="",h=!1,e.beginPath(),c=o.size();0<c--;)r=o.item(c),s=r.time,a!==r.color&&(h&&(e.stroke(),e.beginPath(),h=!1),a=e.strokeStyle=r.color),e.moveTo(r.time,r.open),e.lineTo(r.time,r.close),h=!0;h&&e.stroke()}else{if(e.translate(.5,.5),e.lineWidth=d,o.sort(function(e,t){return e.color>t.color?1:-1}),s)for(e.fillStyle=l;0<c--;)r=o.item(c),s=r.time,d=r.open,t=r.high,i=r.low,n=r.close,l=Math.min(d,n),d=Math.max(d,n),r.hollow?(e.fillRect(s,t,1,l-t),e.fillRect(s,d,1,i-d)):e.fillRect(s,t,1,i-t);if(a)for(c=o.size();0<c--;)r=o.item(c),o.item(c+1)&&r.borderColor==o.item(c+1).borderColor||(e.fillStyle=r.borderColor),r.hollow||(s=r.time,d=r.open,n=r.close,t=Math.round(s-h),s=Math.round(s+h),l=Math.min(d,n),d=Math.max(d,n),e.fillRect(t,l,s-t+1,d-l+1));for(c=o.size();0<c--;)r=o.item(c),s=r.time,d=r.open,t=r.high,i=r.low,n=r.close,t=Math.round(s-h),s=Math.round(s+h),l=Math.min(d,n),d=Math.max(d,n),o.item(c+1)&&r.color==o.item(c+1).color||(e.fillStyle=r.color,e.strokeStyle=r.color),r.hollow?(e.translate(-.5,-.5),e.strokeRect(t+1,l+1,s-t,d-l),e.translate(.5,.5)):(a&&(t+=1,l+=1,--s,--d),e.fillRect(t,l,s-t+1,d-l+1))}},W57.prototype.hitTest=function(e){var t=this._data.bars,i=.5*this._data.barSpacing;if(t.isEmpty()||e.x<t.first().time-i||e.x>t.last().time+i)return null;for(var n=null,o=0;o<t.size();++o){var r=t.item(o);if(e.x<=r.time+i){n=r;break}}return t=selectionTolerance(this._barBorderWidth),n&&n.high-t<=e.y&&e.y<=n.low+t?new HitTestResult(HitTestResult.REGULAR):null},W61.prototype.draw=function(e){for(var t,i=this.lineWidth,n=3*this.lineWidth,o=!1,r=0;r<this.items.size();++r){
var s=this.items.item(r),a=s.x,l=s.y;isNaN(a)||isNaN(l)||(s=null!=s.style?s.style.color:this.lineColor,s!==t&&(t=s,o&&e.fill(),e.beginPath(),e.fillStyle=s),e.rect(a-n/2,l-i/2,n,i),e.rect(a-i/2,l-n/2,i,n),o=!0)}o&&e.fill()},W61.prototype.hitTest=function(e){for(var t,i,n,o,r=selectionTolerance(this.lineWidth),s=1;s<this.items.size();++s)if(t=this.items.item(s-1),i=this.items.item(s),n=t.x,o=i.x,t=MathEx.distanceToSegment(new MathEx.Point(n,t.y),new MathEx.Point(o,i.y),new MathEx.Point(e.x,e.y)),t.distance<=r)return new HitTestResult(HitTestResult.REGULAR);return null},W58.prototype.draw=function(e){for(var t,i=2*Math.PI,n=this.radius,o=!1,r=0;r<this.items.size();++r){var s=this.items.item(r),a=s.x,l=s.y+this.vertOffset;isNaN(a)||isNaN(l)||(s=null!=s.style?s.style.color:this.lineColor,s!==t&&(t=s,o&&e.fill(),e.beginPath(),e.fillStyle=s),e.moveTo(a+n,l),e.arc(a,l,n,0,i,!1),o=!0)}o&&e.fill()},W58.prototype.hitTest=function(e){for(var t=this.vertOffset,i=selectionTolerance(2*this.radius),n=0;n<this.items.size();++n){var o=this.items.item(n);if(o&&(offsettedPoint=new MathEx.Point(o.x,o.y+t),offsettedPoint.substract(e).length()+this.radius<=i))return new HitTestResult(HitTestResult.REGULAR)}return null},inherit(PaneRendererArrowsUpDownItem,MathEx.Point),W54.prototype._calculateVerticalOffset=function(e){return Math.round((e||0)/4)},W54.prototype._calculateMinHeight=function(e){return this.width||this._calculateWidth(e)},W54.prototype._calculateWidth=function(e){return e=e||this.barSpacing,Math.round(e/2)},W54.prototype.draw=function(e){var t=this.width,i=4>t,n=Math.max(parseInt(t/2),1),o=Math.round(this.width/2),r=Math.round(this.width);e.translate(1,1);for(var s=0,a=this.items.size();a>s;s++){var l=this.items.item(s),d=l.isUp?-1:1,h=Math.abs(l.height),c=l.y-d*this.vertOffset;e.beginPath(),e.translate(l.x,c),i?(e.moveTo(0,0),e.lineTo(-o,-o*d),e.moveTo(0,0),e.lineTo(o,-o*d),e.moveTo(0,0),e.lineTo(0,-h*d),e.moveTo(-o,-h*d),e.lineTo(o,-h*d),e.lineWidth=n,e.strokeStyle=l.isUp?this.colorUp:this.colorDn,e.stroke()):(e.moveTo(0,0),r>h?(e.lineTo(t,-h*d),e.lineTo(-t,-h*d)):(e.lineTo(t,-r*d),e.lineTo(o,-r*d),e.lineTo(o,-h*d),e.lineTo(-o,-h*d),e.lineTo(-o,-r*d),e.lineTo(-t,-r*d)),e.lineTo(0,0),e.strokeStyle=this.colorBorder,e.stroke(),e.fillStyle=l.isUp?this.colorUp:this.colorDn,e.fill()),e.translate(-l.x,-c)}e.translate(-1,-1)},W54.prototype.hitTest=function(e){for(var t=Math.round(this.width/2),i=Math.round(this.width),n=0;n<this.items.size();++n){var o=this.items.item(n);if(o&&void 0!==o.x&&null!==o.x&&!isNaN(o.x)&&void 0!==o.y&&null!==o.y&&!isNaN(o.y)){var r=Math.abs(o.height),s=o.isUp?-1:1,a=o.y-s*this.vertOffset,r=a-s*(r+i),s=o.x+t;if(o.x-t<e.x&&e.x<s&&(o.isUp?a<e.y&&e.y<r:r<e.y&&e.y<a))return new HitTestResult(HitTestResult.REGULAR)}}},W73.prototype.draw=function(e){e.font=this.height+"px "+this.fontFamily;var t=e.measureText(this.ch),i=this.height/2,t=t.width/2;e.translate(1,1);for(var n=0,o=this.items.size();o>n;n++){var r=this.items.item(n);newFillStyle=void 0!==r.style?r.style.color:this.color,e.fillStyle=newFillStyle,e.fillText(this.ch,r.x-t,r.y+this.vertOffset+i)}e.translate(-1,-1)},W73.prototype.hitTest=function(e){for(var t=this.vertOffset,i=selectionTolerance(this.height),n=0;n<this.items.size();++n){var o=this.items.item(n);if(o&&(offsettedPoint=new MathEx.Point(o.x,o.y+t),offsettedPoint.substract(e).length()<=i))return new HitTestResult(HitTestResult.REGULAR)}return null},W52.prototype.draw=function(e){throw Error("Not implemented")},W52.prototype.hitTest=function(e,t){var i=Math.max(this.height,this.width),n=this.vertOffset;t=t||HitTestResult.REGULAR;for(var o,r=0;r<this.items.size();++r)if((o=this.items.item(r))&&(o=new MathEx.Point(o.x,o.y+n),o=o.substract(e).length(),i>=o))return new HitTestResult(t);return null},inherit(W74,W52),W74.prototype.draw=function(e){e.lineWidth=2;for(var t,i=this.width,n=this.height,o=this.vertOffset,r=!1,s=0,a=this.items.size();a>s;s++){var l,d=this.items.item(s);l=null!=d.style?d.style.color:this.color,l!==t&&(t=l,r&&e.stroke(),e.beginPath(),e.strokeStyle=l),r=d.x-i/2,d=d.y-n/2+o,e.moveTo(r,d),e.lineTo(r+i,d+n),e.moveTo(r,d+n),e.lineTo(r+i,d),r=!0}r&&e.stroke()},inherit(W72,W52),W72.prototype.draw=function(e){for(var t,i=this.width,n=this.height,o=Math.round(n/3),o=this.vertOffset-2*o,r=!1,s=0,a=this.items.size();a>s;s++){var l,d,h=this.items.item(s);null!=h.style?(l=h.style.color,d=h.style.borderColor):(l=this.color,d=this.borderColor),l!==t&&(t=l,r&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=l,e.strokeStyle=d),r=h.x,h=h.y+o,e.moveTo(r,h),e.lineTo(r+i/2,h+n),e.lineTo(r-i/2,h+n),e.lineTo(r,h),r=!0}r&&(e.fill(),e.stroke())},inherit(W71,W52),W71.prototype.draw=function(e){for(var t,i=this.width,n=this.height,o=Math.round(n/3),o=this.vertOffset-o,r=!1,s=0,a=this.items.size();a>s;s++){var l,d,h=this.items.item(s);null!=h.style?(l=h.style.color,d=h.style.borderColor):(l=this.color,d=this.borderColor),l!==t&&(t=l,r&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=l,e.strokeStyle=d),r=h.x-i/2,h=h.y+o,e.moveTo(r,h),e.lineTo(r+i,h),e.lineTo(r+i/2,h+n),e.lineTo(r,h),r=!0}r&&(e.fill(),e.stroke())},inherit(PaneRendererTriangleApexLeft,W52),PaneRendererTriangleApexLeft.prototype.draw=function(e){for(var t,i=this.width,n=this.height,o=this.vertOffset,r=!1,s=0,a=this.items.size();a>s;s++){var l,d=this.items.item(s);l=null!=d.style?d.style.color:this.color,l!==t&&(t=l,r&&e.fill(),e.beginPath(),e.fillStyle=l),r=d.x+i/2,d=d.y-n/2+o,e.moveTo(r,d),e.lineTo(r,d+n),e.lineTo(r-i,d+n/2),e.lineTo(r,d),r=!0}r&&e.fill()},inherit(W64,W52),W64.prototype.draw=function(e){for(var t,i=this.width,n=this.height,o=n/2,r=this.vertOffset,s=(i-3)/3,a=!1,l=0,d=this.items.size();d>l;l++){var h,c,p=this.items.item(l);null!=p.style?(h=p.style.color,c=p.style.borderColor):(h=this.color,c=this.borderColor),h!==t&&(t=h,a&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=h,e.strokeStyle=c),a=p.x-i/2,p=p.y-o+r,e.moveTo(a,p),e.lineTo(a+3,p),e.bezierCurveTo(a+s,p-s,a+2*s,p+s,a+i,p),e.lineTo(a+i,p+o),e.bezierCurveTo(a+i-s,p+o+s,a+i-2*s,p+o-s,a+3,p+o),e.lineTo(a+3,p+n),e.lineTo(a,p+n),e.lineTo(a,p),a=!0}a&&(e.fill(),e.stroke())},inherit(W63,W52),W63.prototype.draw=function(e){e.lineWidth=2;for(var t,i=this.width,n=this.height,o=this.vertOffset,r=!1,s=0,a=this.items.size();a>s;s++){var l,d=this.items.item(s);l=null!=d.style?d.style.color:this.color,l!==t&&(t=l,r&&e.stroke(),e.beginPath(),e.strokeStyle=l),r=d.x-i/2,d=d.y-n/2+o,e.moveTo(r+i/2,d),e.lineTo(r+i/2,d+n),e.moveTo(r,d+n/2),e.lineTo(r+i,d+n/2),r=!0}r&&e.stroke()},inherit(W59,W52),W59.prototype.draw=function(e){for(var t,i=Math.max(this.width,this.height)/2,n=this.vertOffset,o=2*Math.PI,r=!1,s=0,a=this.items.size();a>s;s++){var l,d,h=this.items.item(s);null!=h.style?(l=h.style.color,d=h.style.borderColor):(l=this.color,d=this.borderColor),l!==t&&(t=l,r&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=l,e.strokeStyle=d),r=h.x,h=h.y+n,e.moveTo(r+i,h),e.arc(r,h,i,0,o,!1),r=!0}r&&(e.fill(),e.stroke())},inherit(PaneRendererArrowsBase,W52),PaneRendererArrowsBase.prototype._calculateWidth=function(e){return e=e||this.barSpacing,Math.round(e/4)},PaneRendererArrowsBase.prototype.draw=function(e){for(var t,i=!1,n=this.width,o=4>n,r=Math.max(parseInt(n/2),1),s=Math.round(this.width/2),a=Math.round(this.width),l=this.isUp?-1:1,d=0,h=this.items.size();h>d;d++){var c,p=this.items.item(d),u=Math.abs(this.height),f=p.x,g=p.y+this.vertOffset+l*Math.round(u/2);null!=p.style?(c=p.style.color,p=p.style.borderColor):(c=this.color,p=this.borderColor),c!==t&&(t=c,i&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=c,e.strokeStyle=p),e.translate(f,g),o?(e.moveTo(0,0),e.lineTo(-s,-s*l),e.moveTo(0,0),e.lineTo(s,-s*l),e.moveTo(0,0),e.lineTo(0,-u*l),e.moveTo(-s,-u*l),e.lineTo(s,-u*l),e.lineWidth=r):(e.moveTo(0,0),a>u?(e.lineTo(n,-u*l),e.lineTo(-n,-u*l)):(e.lineTo(n,-a*l),e.lineTo(s,-a*l),e.lineTo(s,-u*l),e.lineTo(-s,-u*l),e.lineTo(-s,-a*l),e.lineTo(-n,-a*l)),e.lineTo(0,0)),e.translate(-f,-g),i=!0}i&&(e.fill(),e.stroke())},inherit(PaneRendererArrowUp,PaneRendererArrowsBase),inherit(PaneRendererArrowDown,PaneRendererArrowsBase),inherit(PaneRendererSquare,W52),PaneRendererSquare.prototype.draw=function(e){for(var t,i=!1,n=Math.round(this.height/2),o=0,r=this.items.size();r>o;o++){var s,a,l=this.items.item(o);null!=l.style?(s=l.style.color,a=l.style.borderColor):(s=this.color,a=this.borderColor),s!==t&&(t=s,i&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=s,e.strokeStyle=a),e.rect(l.x-n,l.y+this.vertOffset-n,this.height,this.height),i=!0}i&&(e.fill(),e.stroke())},inherit(PaneRendererDiamond,W52),PaneRendererDiamond.prototype.draw=function(e){for(var t,i=!1,n=Math.round(this.height/2),o=0,r=this.items.size();r>o;o++){var s,a,l=this.items.item(o);null!=l.style?(s=l.style.color,a=l.style.borderColor):(s=this.color,a=this.borderColor),s!==t&&(t=s,i&&(e.fill(),e.stroke()),e.beginPath(),e.fillStyle=s,e.strokeStyle=a),i=l.x,l=l.y+this.vertOffset,e.moveTo(i,l-n),e.lineTo(i+n,l),e.lineTo(i,l+n),e.lineTo(i-n,l),e.lineTo(i,l-n),i=!0}i&&(e.fill(),e.stroke())},W55.prototype.draw=function(e){},W55.prototype.drawBackground=function(e){e.save(),"undefined"==typeof FlashCanvas&&e.translate(-.5,-.5);for(var t=0;t<this._items.size();++t){var i=this._items.item(t);if(void 0!=i.color){e.fillStyle=i.color;var n=t==this._items.size()-1?this._w:this._items.item(t+1).x-i.x;e.fillRect(i.x,this._y,n,this._h)}}e.restore()},W55.prototype.hitTest=function(e){return null},inherit(PaneRendererClockIcon,W73),PriceRange.prototype.equals=function(e){return this.m_minValue==e.m_minValue&&this.m_maxValue==e.m_maxValue},PriceRange.prototype.clone=function(){return new PriceRange(this.m_minValue,this.m_maxValue)},PriceRange.prototype.minValue=function(){return this.m_minValue},PriceRange.prototype.maxValue=function(){return this.m_maxValue},PriceRange.prototype.length=function(){return this.m_maxValue-this.m_minValue},PriceRange.prototype.isEmpty=function(){return this.m_maxValue===this.m_minValue||this.m_maxValue!=this.m_maxValue||this.m_minValue!=this.m_minValue},PriceRange.prototype.merge=function(e){return new PriceRange(Math.min(this.minValue(),e.minValue()),Math.max(this.maxValue(),e.maxValue()))},PriceRange.prototype.apply=function(e,t){this.m_minValue=Math.min(this.m_minValue,e),this.m_maxValue=Math.max(this.m_maxValue,t)},PriceRange.prototype.scaleAroundCenter=function(e){if(isNumber(e)){if(0!==this.m_maxValue-this.m_minValue){var t=.5*(this.m_maxValue+this.m_minValue),i=this.m_maxValue-t,n=this.m_minValue-t;this.m_maxValue=t+i*e,this.m_minValue=t+n*e}}else TradingView.logDebug("PriceRange.scaleAroundCenter: invalid coeff")},PriceRange.prototype.shift=function(e){isNumber(e)?(this.m_maxValue+=e,this.m_minValue+=e):TradingView.logDebug("PriceRange.shift: invalid coeff")},PriceRange.prototype.convertToPercent=function(e,t){return 100*(e-t)/t},PriceRange.prototype.convertFromPercent=function(e,t){return e/100*t+t},PriceRange.prototype.convertToPercents=function(e){return new PriceRange(100*(this.m_minValue-e)/e,100*(this.m_maxValue-e)/e)},PriceRange.prototype.convertFromPercents=function(e){return new PriceRange(this.m_minValue/100*e+e,this.m_maxValue/100*e+e)},PriceTickSpanCalculator.prototype.TICK_SPAN_EPSILON=1e-9,PriceTickSpanCalculator.prototype.tickSpan=function(e,t,i){var n=0===this.m_base?0:1/this.m_base,o=this.TICK_SPAN_EPSILON;e=Math.pow(10,Math.max(0,Math.ceil(MathEx.log10(e-t)))),t=0;var r;for(t=0,r=this.m_integralDividers[0];e>n+o&&MathEx.greaterOrEqual(e,n,o)&&MathEx.greaterOrEqual(e,i*r,o)&&MathEx.greaterOrEqual(e,1,o);++t,r=this.m_integralDividers[t%this.m_integralDividers.length])e/=r;if(n+o>=e&&(e=n),e=Math.max(1,e),0<this.m_fractionalDividers.length&&MathEx.equal(e,1,o))for(t=0,r=this.m_fractionalDividers[0];e>n+o&&MathEx.greaterOrEqual(e,i*r,o);++t,r=this.m_fractionalDividers[t%this.m_fractionalDividers.length])e/=r;return e},PriceTickMarkBuilder.prototype.TICK_DENSITY=2,PriceTickMarkBuilder.prototype.base=function(){return this.m_base},PriceTickMarkBuilder.prototype.setBase=function(e){if(0>e)throw new RangeError("base < 0");this.m_base=e},PriceTickMarkBuilder.prototype.fontHeight=function(){return this.m_fontHeight},PriceTickMarkBuilder.prototype.setFontHeight=function(e){this.m_fontHeight!==e&&(this.m_fontHeight=e)},PriceTickMarkBuilder.prototype.tickSpan=function(e,t){if(t>e)throw new RangeError("high < low");var i=this.m_priceScale.height(),n=this.tickMarkHeight(),i=(e-t)*n/i,n=new PriceTickSpanCalculator(this.m_base,[2,2.5,2]),o=new PriceTickSpanCalculator(this.m_base,[2,2,2.5]),r=new PriceTickSpanCalculator(this.m_base,[2.5,2,2]),s=[];return s.push(n.tickSpan(e,t,i)),s.push(o.tickSpan(e,t,i)),s.push(r.tickSpan(e,t,i)),MathEx.min(s)},PriceTickMarkBuilder.prototype.tickMarkHeight=function(){return this.m_fontHeight*this.TICK_DENSITY},PriceTickMarkBuilder.prototype.rebuildTickMarks=function(){if(null===this.m_priceScale)throw new TypeError("scale is null");if(this.m_priceScale.isEmpty())this.m_marks=[];else{var e=this.m_priceScale.height(),t=this.m_priceScale.coordinateToPrice(e-1),i=this.m_priceScale.coordinateToPrice(0),e=i>=t?1:-1,n=Math.max(i,t),t=Math.min(i,t),i=n;if(i!=t){var n=this.tickSpan(i,t),o=i%n,o=o+(0>o?n:0);if(this.m_marks=[],!this._formatter){var r=calculateBaseForTickSpan(n);if(!this._cache||this._currentFormatBase!=r){var s=new PriceFormatter(r);this._cache=new FormattedLabelsCache(function(e){return s.format(e)})}}for(r=null,i-=o;i>t;i-=n)o=this.m_priceScale.priceToCoordinate(i),null!==r&&Math.abs(o-r)<this.tickMarkHeight()||(r=new TickMark(o,this._cache.format(i),0),this.m_marks.push(r),r=o,this.m_priceScale.isLog()&&(n=this.tickSpan(i*e,t)))}}},PriceTickMarkBuilder.prototype.marks=function(){return this.m_marks},W76.prototype.isLog=function(){return this.D2.log.value()},W76.prototype.isPercent=function(){return this.D2.percentage.value()},W76.prototype.properties=function(){return this.D2},W76.prototype.height=function(){return this.m_height},W76.prototype.setHeight=function(e){var t=this.m_height;this.m_height=e,this._internalHeightCache=void 0,this._marksCache=null,t!=e&&this.mainSource()instanceof TradingView.Series&&this.mainSource().isLockScale()&&this.mainSource().model().timeScale().recalcLockedScale()},W76.prototype.topMargin=function(){return Math.max(this.m_topMargin,this._studyTopMargin)},W76.prototype.setTopMargin=function(e){if(!isNumber(e))throw new TypeError("invalid margin");if(0>e||e>30)throw new RangeError("invalid margin");this.m_topMargin=e,this._internalHeightCache=void 0,this._marksCache=null},W76.prototype.bottomMargin=function(){return Math.max(this.m_bottomMargin,this._studyBottomMargin)},W76.prototype.setBottomMargin=function(e){if(!isNumber(e))throw new TypeError("invalid margin");if(0>e||e>30)throw new RangeError("invalid margin");this.m_bottomMargin=e,this._internalHeightCache=void 0,this._marksCache=null},W76.prototype.internalHeight=function(){if(this._internalHeightCache)return this._internalHeightCache;var e=this.height()*(1-this.topMargin()-this.bottomMargin());return this._internalHeightCache=e},W76.prototype.priceRange=function(){return this.m_priceRange},W76.prototype.setPriceRange=function(e){if(!e instanceof PriceRange)throw new TypeError("incorrect price range");this.m_priceRange&&this.m_priceRange.equals(e)||(this.m_priceRange=e,this._marksCache=null)},W76.prototype.isEmpty=function(){return 0===this.m_height||!this.m_priceRange||this.m_priceRange.isEmpty()},W76.prototype.invertedCoordinate=function(e){return this.height()-1-e},W76._logicalOffset=4,W76._coordOffset=1e-4,W76.prototype.log10=function(e){return Math.log(e)/Math.log(10)},W76.prototype._toLog=function(e){var t=Math.abs(e);return 1e-6>t?0:(t=this.log10(t+W76._coordOffset)+W76._logicalOffset,0>e?-t:t)},W76.prototype.priceToLogical=function(e){return this.isLog()&&e?this._toLog(e):e},W76.prototype._fromLog=function(e){var t=Math.abs(e);return 1e-6>t?0:(t=Math.pow(10,t-W76._logicalOffset)-W76._coordOffset,0>e?-t:t)},W76.prototype.logicalToPrice=function(e){return this.isLog()?this._fromLog(e):e},W76.prototype.priceToCoordinate=function(e,t){if(this.isEmpty())return 0;e=this.priceToLogical(e);var i=this.bottomMargin()*this.height()+(this.internalHeight()-1)*(e-this.priceRange().minValue())/(this.priceRange().maxValue()-this.priceRange().minValue()),i=this.invertedCoordinate(i);return t?i:Math.round(i)},W76.prototype.pricesToCoordinates=function(e){this.pricesToCoordinatesEx(e.toArray(),function(e){return e.y},function(e,t){e.y=t})},W76.prototype.pricesToCoordinatesEx=function(e,t,i){var n=this.bottomMargin()*this.height(),o=this.priceRange().minValue(),r=this.priceRange().maxValue(),r=(this.internalHeight()-1)/(r-o);if(this.isLog())for(var s=0;s<e.length;s++){var a=t(e[s]);i(e[s],this.priceToLogical(a))}for(s=0;s<e.length;s++)a=t(e[s]),isNaN(a)||void 0===a||null===a||i(e[s],Math.round(this.m_height-1-(n+r*(a-o))))},W76.prototype.pointsArrayToCoordinates=function(e){var t=this.bottomMargin()*this.height(),i=this.priceRange().minValue(),n=this.priceRange().maxValue(),n=(this.internalHeight()-1)/(n-i);if(this.isLog())for(var o=0;o<e.length;o++)e[o].y=this.priceToLogical(e[o].y);for(o=0;o<e.length;o++){var r=e[o].y;isNaN(r)||void 0===r||null===r||(e[o].y=Math.round(this.m_height-1-(t+n*(r-i))))}},W76.prototype.pricesArrayToCoordinates=function(e){var t=this.bottomMargin()*this.height(),i=this.priceRange().minValue(),n=this.priceRange().maxValue(),n=(this.internalHeight()-1)/(n-i);if(this.isLog())for(var o=0;o<e.length;o++)e[o]=this.priceToLogical(e[o]);for(o=0;o<e.length;o++){var r=e[o];void 0!=r&&(e[o]=Math.round(this.m_height-1-(t+n*(r-i))))}},W76.prototype.barPricesToCoordinates=function(e){e=e.toArray();var t=this.bottomMargin()*this.height(),i=this.priceRange().minValue(),n=this.priceRange().maxValue(),n=(this.internalHeight()-1)/(n-i);if(this.isLog())for(var o=0;o<e.length;o++)e[o]&&(e[o].open=this.priceToLogical(e[o].open),e[o].high=this.priceToLogical(e[o].high),e[o].low=this.priceToLogical(e[o].low),e[o].close=this.priceToLogical(e[o].close),e[o].additionalPrice&&(e[o].additionalPrice=this.priceToLogical(e[o].additionalPrice)));for(o=0;o<e.length;o++){var r=e[o];if(r){var s=r.open,s=t+n*(s-i),s=this.m_height-1-s;r.open=Math.round(s),s=r.high,s=t+n*(s-i),s=this.m_height-1-s,r.high=Math.round(s),s=r.low,s=t+n*(s-i),s=this.m_height-1-s,r.low=Math.round(s),s=r.close,s=t+n*(s-i),s=this.m_height-1-s,r.close=Math.round(s),r.additionalPrice&&(s=r.additionalPrice,s=t+n*(s-i),s=this.m_height-1-s,r.additionalPrice=Math.round(s))}}},W76.prototype.coordinateToPrice=function(e){return this.isEmpty()?0:(e=this.invertedCoordinate(e),e=this.priceRange().minValue()+(this.priceRange().maxValue()-this.priceRange().minValue())*((e-this.bottomMargin()*this.height())/(this.internalHeight()-1)),this.logicalToPrice(e))},W76.prototype.isAutoScale=function(){return this.D2.autoScale.value()&&!(this.mainSource()instanceof TradingView.Series&&this.mainSource().isLockScale())},W76.prototype.isPercentage=function(){return this.D2.percentage.value()},W76.prototype.D19=function(){return this.m_dataSources},W76.prototype.orderedSources=function(){if(this._cachedOrderedSoruces)return this._cachedOrderedSoruces;for(var e=[],t=0;t<this.D19().size();t++){var i=this.D19().item(t);null==i.zorder()&&i.setZorder(t+1),e.push(i)}return e=W75.sortSources(e),this._cachedOrderedSoruces=new List(e)},W76.prototype.invalidateSourcesCache=function(){this._cachedOrderedSoruces=null},W76.prototype.addDataSource=function(e){if(!this.m_dataSources.contains(e)){isInherited(e.constructor,TradingView.Series)&&(this._hasSeries=!0);var t=this;e.properties().visible.listeners().subscribe(null,function(){t._sourcesForAutoscale=null}),this.m_dataSources.append(e),this._mainSource=void 0,this._sourcesToUpdateViews=this._sourcesForAutoscale=null,this.updateFormatter(),this.initScaleProperties(),this.invalidateSourcesCache()}},W76.prototype.initScaleProperties=function(){var e=this.mainSource()instanceof TradingView.Series&&this.mainSource().properties().lockScale.value();e&&(this.properties().percentage.setValue(!1),this.properties().log.setValue(!1),this.properties().autoScale.setValue(!1)),this.properties().percentageDisabled.setValue(e),this.properties().logDisabled.setValue(e),this.properties().autoScaleDisabled.setValue(this.properties().percentage.value()),this.properties().percentage.value()&&this.properties().log.setValue(!1)},W76.prototype.removeDataSource=function(e){if(!this.m_dataSources.contains(e))throw Error("source is not attached to scale");this.m_dataSources.remove(e),isInherited(e.constructor,TradingView.Series)&&(this._hasSeries=!1),this.mainSource()||this.setAutoScale(!0),this._mainSource=void 0,this._sourcesToUpdateViews=this._sourcesForAutoscale=null,this.updateFormatter(),this.invalidateSourcesCache()},W76.prototype.setAutoScale=function(e){this.D2.autoScale.setValue(e)},W76.prototype.startScale=function(e){this.isPercentage()||null!==this.m_scaleStartPoint||null!==this.m_priceRangeSnapshot||this.isEmpty()||(this.m_scaleStartPoint=this.m_height-e,this.m_priceRangeSnapshot=this.priceRange().clone())},W76.prototype.marks=function(){return this._marksCache?this._marksCache:(this.m_markBuilder.rebuildTickMarks(),this._marksCache=this.m_markBuilder.marks())},W76.prototype.scaleTo=function(e){if(!this.isPercentage()&&(this._marksCache=null,null!==this.m_scaleStartPoint)){this.setAutoScale(!1);var t=this.m_priceRange.clone();e=this.m_height-e,0>e&&(e=0),e=(this.m_scaleStartPoint+.2*(this.m_height-1))/(e+.2*(this.m_height-1)),e=Math.max(e,.1),this.m_priceRange=this.m_priceRangeSnapshot.clone(),this.m_priceRange.scaleAroundCenter(e),this.recalcLockedScale(t)}},W76.prototype.recalcLockedScale=function(e){if(this.mainSource()instanceof TradingView.Series&&this.mainSource().properties().lockScale.value()){var t=this.mainSource().model().timeScale(),i=this.mainSource().data().boxSize;if(void 0===i&&this.mainSource().fixBoxSize(),void 0!==i){if(this.properties().percentage.value())var n=this.mainSource().data().search(this.mainSource().getRealVisibleRange().m_firstBar).value[CLOSE_PLOT],i=PriceRange.prototype.convertToPercent.call(null,n+i,n)-PriceRange.prototype.convertToPercent.call(null,n,n);i*=this.internalHeight()/this.priceRange().length(),.5>i||i>50?this.m_priceRange=e:(t.setBarSpacing(i),t._correctOffset()),this.mainSource().model().mainSeries().requestMoreData()}}},W76.prototype.endScale=function(){this.isPercentage()||null===this.m_scaleStartPoint||(this.m_priceRangeSnapshot=this.m_scaleStartPoint=null)},W76.prototype.startScroll=function(e){this.isAutoScale()||null!==this.m_scrollStartPoint||null!==this.m_priceRangeSnapshot||this.isEmpty()||(this.m_scrollStartPoint=e,this.m_priceRangeSnapshot=this.priceRange().clone())},W76.prototype.scrollTo=function(e){if(this._marksCache=null,!this.isAutoScale()&&null!==this.m_scrollStartPoint){var t=this.priceRange().length()/(this.height()-1);e=(e-this.m_scrollStartPoint)*t,this.m_priceRange=this.m_priceRangeSnapshot.clone(),this.m_priceRange.shift(e)}},W76.prototype.endScroll=function(){this.isAutoScale()||null===this.m_scrollStartPoint||(this.m_priceRangeSnapshot=this.m_scrollStartPoint=null)},W76.prototype.state=function(){var e={};return e.m_priceRange=this.priceRange()?this.priceRange().clone():null,e.m_isAutoScale=this.isAutoScale(),e.m_isPercentage=this.D2.percentage.value(),e.m_isLog=this.D2.log.value(),e.m_height=this.m_height,e.m_topMargin=this.m_topMargin,e.m_bottomMargin=this.m_bottomMargin,e.m_showSymbolLabels=this.D2.showSymbolLabels.value(),e},W76.prototype.restoreState=function(e){var t=e.m_priceRange;if(void 0===t)throw new TypeError("invalid state");if(void 0===e.m_isAutoScale)throw new TypeError("invalid state");void 0!==e.m_isPercentage&&this.D2.percentage.setValue(e.m_isPercentage),void 0!==e.m_isLog&&this.D2.log.setValue(e.m_isLog),this.m_priceRange=t?new PriceRange(t.m_minValue,t.m_maxValue):null,void 0!==e.m_height&&(this.m_height=e.m_height),this.setAutoScale(e.m_isAutoScale),void 0!==e.m_topMargin&&(this.m_topMargin=e.m_topMargin),void 0!==e.m_bottomMargin&&(this.m_bottomMargin=e.m_bottomMargin),void 0!==e.m_showSymbolLabels&&this.D2.showSymbolLabels.setValue(e.m_showSymbolLabels),this._mainSource=void 0,this._scaleSeriesOnly=!1},W76.prototype.mainSource=function(){if(void 0!==this._mainSource)return this._mainSource;for(var e=0;e<this.m_dataSources.size();e++)if(isInherited(this.m_dataSources.item(e).constructor,PriceDataSource))return this._mainSource=e=this.m_dataSources.item(e);return this._mainSource=void 0,null},W76.prototype.formatter=function(){return this._formatter||this.updateFormatter(),this._formatter},W76.prototype.updateFormatter=function(){this._marksCache=null;var e=this.mainSource(),t=100;e&&(t=e.base()),this._formatter=null,this.properties().percentage.value()?this._formatter=new PercentageFormatter:e&&(this._formatter=e.formatter()),this.m_markBuilder=new PriceTickMarkBuilder(this,t,this._formatter),this.m_markBuilder.rebuildTickMarks()},W76.prototype._recalculateSourcesForAutoscale=function(){this._sourcesForAutoscale=new List,this._mainSource&&(this._scaleSeriesOnly=this._mainSource.model().properties().scalesProperties.scaleSeriesOnly.value());for(var e=this._scaleSeriesOnly&&this._hasSeries,t=0;t<this.D19().size();t++){var i,n=this.D19().item(t);i=n,i=i.properties().visible.value()||i instanceof TradingView.Series?e?isInherited(i.constructor,TradingView.Series):isInherited(i.constructor,PriceDataSource):!1,i&&this._sourcesForAutoscale.append(n)}},W76.prototype.sourcesForAutoscale=function(){if(this._mainSource){var e=this._mainSource.model().properties();this._scaleSeriesOnly!=e.scalesProperties.scaleSeriesOnly.value()&&(this._sourcesForAutoscale=null)}return this._sourcesForAutoscale||this._recalculateSourcesForAutoscale(),this._sourcesForAutoscale},W76.prototype.recalculatePriceRange=function(e){this._studyBottomMargin=this._studyTopMargin=0;var t=null,i=this.sourcesForAutoscale();this.mainSource();for(var n=0;n<i.size();n++){var o=i.item(n);if(o.properties().visible.value()){var r=e.firstBar(),s=e.lastBar(),r=o.priceRange(r,s);null===t&&r?t=r:r&&(t=t.merge(r)),o.margins&&(o=o.margins(),this._studyTopMargin=Math.max(o[0],this._studyTopMargin),this._studyBottomMargin=Math.max(o[1],this._studyBottomMargin))}}t?(t.minValue()==t.maxValue()&&(t=new PriceRange(t.minValue()-.5,t.maxValue()+.5)),this.setPriceRange(t)):this.m_priceRange||this.setPriceRange(new PriceRange(-.5,.5))},W76.prototype.sourcesToUpdateViews=function(){if(!this._sourcesToUpdateViews){this._sourcesToUpdateViews=new List;for(var e=0;e<this.D19().size();e++){var t=this.D19().item(e);isInherited(t.constructor,W47)&&!t.isActualSymbol()||this._sourcesToUpdateViews.append(t)}}return this._sourcesToUpdateViews},W76.prototype.updatePaneViews=function(){for(var e=this.sourcesToUpdateViews(),t=0;t<e.size();t++)e.item(t).updateAllViews()},W76.prototype.updateShowSymbolLabels=function(){for(var e=this.sourcesToUpdateViews(),t=0;t<e.size();t++)e.item(t).updateAllViews();this.mainSource()&&this.mainSource().model().D20(new A22(A22.LIGHT_UPDATE))},A58=function(e,t){this.m_bars=new PlotList(["time","open","high","low","close"]),this.m_nsBars=new PlotList(["time","open","high","low","close"]),this.m_series=e,this.m_model=t,this.boxSize=this.lastProjectionPrice=void 0},A58.prototype.bars=function(){return this.m_bars},A58.prototype.nsBars=function(){return this.m_nsBars},A58.prototype.size=function(){return this.m_nsBars._end-this.m_nsBars._start+(this.m_bars._end-this.m_bars._start)},A58.prototype.each=function(e){for(var t=this.m_bars._start;t<this.m_bars._end&&!e(this.m_bars._indexAt(t),this.m_bars._valueAt(t));++t);for(t=this.m_nsBars._start;t<this.m_nsBars._end&&!e(this.m_nsBars._indexAt(t),this.m_nsBars._valueAt(t));++t);},A58.prototype.clear=function(){this.m_bars=new PlotList(["time","open","high","low","close"]),this.m_nsBars=new PlotList(["time","open","high","low","close"]),this.boxSize=this.lastProjectionPrice=void 0},A58.prototype.first=function(){return this.m_bars.isEmpty()?this.m_nsBars._items[0]:this.m_bars._items[0]},A58.prototype.isEmpty=function(){return this.m_bars.isEmpty()&&this.m_nsBars.isEmpty()},A58.prototype.last=function(){return this.m_nsBars.isEmpty()?this.m_bars._items[this.m_bars._end-1]:this.m_nsBars._items[this.m_nsBars._end-1]},A58.prototype.search=function(e,t){return this.nsBars().isEmpty()?this.bars().search(e,t):this.bars().isEmpty()?this.nsBars().search(e,t):this.nsBars().firstTimeIndex()<=e?this.nsBars().search(e,t):this.bars().search(e,t)},A58.prototype.valueAt=function(e){return(e=this.search(e))?e.value:void 0},A58.prototype.firstBar=function(){if(this.m_model.timeScale().isEmpty())return null;var e=this.m_model.timeScale().visibleBars(),t=e.firstBar(),e=e.lastBar(),i=null,n=function(e,t){return i?void 0:(i=t,!0)};return this.bars().range(t,e).isEmpty()?this.nsBars().range(t,e).each(n):this.bars().range(t,e).each(n),i},A58.prototype.firstValue=function(){var e=this.firstBar();return e?e[CLOSE_PLOT]:null},A58.prototype.timeToBarIndex=function(e,t){if(null===e)return TradingView.logDebug("SeriesData.timeToBarIndex: time should be a number of seconds since 1970. But it is null"),0;if(t===SEARCH_FROM_RIGHT){for(var i=this.m_bars.lastIndex();i>=this.m_bars.firstIndex();i--){var n=this.m_bars._valueAt(i);if(e>=n[TIME_PLOT])return i}for(i=this.m_nsBars.lastIndex();i>=this.m_nsBars.firstIndex();i--)if(n=this.m_nsBars._valueAt(i),e>=n[TIME_PLOT])return i;return this.m_bars.firstIndex()}if(t===SEARCH_FROM_LEFT){for(i=this.m_bars.firstIndex();i<=this.m_bars.lastIndex();i++)if(n=this.m_bars._valueAt(i),e<=n[TIME_PLOT])return i;for(i=this.m_nsBars.firstIndex();i<=this.m_nsBars.lastIndex();i++)if(n=this.m_nsBars._valueAt(i),e<=n[TIME_PLOT])return i;return this.m_bars.lastIndex()}return TradingView.logDebug("SeriesData.timeToBarIndex: Incorrect options value"),0};var DEFAULT_BAR_COUNT=300,TIME_PLOT=0,OPEN_PLOT=1,HIGH_PLOT=2,LOW_PLOT=3,CLOSE_PLOT=4,ADT_PLOT=6,SEARCH_FROM_LEFT=-1,SEARCH_FROM_RIGHT=1;W23.prototype.update=function(){this._invalidated=!0},W23.prototype.updateImpl=function(){if(this._visible=!1,this._series.properties().showPriceLine.value()){var e=this._series.lastValueData(CLOSE_PLOT,!0);e&&(this._visible=!0,this._points=(new List).append(new MathEx.Point(0,e.coordinate)),this._color=e.color)}},W23.prototype.renderer=function(){this._invalidated&&(this.updateImpl(),this._invalidated=!1);var e={};return e.points=this._points,e.color=this._color,e.linewidth=this._series.properties().priceLineWidth.value(),e.linestyle=CanvasEx.LINESTYLE_DOTTED,e.hitTestResult=HitTestResult.REGULAR,e.visible=this._visible,new HorzLineRenderer(e)},TradingView.defaultRequestOption=function(){return{count:DEFAULT_BAR_COUNT}},TradingView.Series=function(e,t,i){PriceDataSource.call(this,e),this._boxSizeChanged=new Delegate,this._tagsChanged=new Delegate,this._symbolIntervalChanged=new Delegate,this._symbolResolved=new Delegate,this._symbolError=new Delegate,this._symbolNotPermitted=new Delegate,this._extendedHoursChanged=new Delegate,this._extendedHoursNotPermitted=new Delegate,this.chartTypeNotPermitted=new Delegate,this.intradaySpreadNotPermitted=new Delegate,this.intradayExchangeNotPermitted=new Delegate,this.customIntervalNotPermitted=new Delegate,this.chartWidgetInitialized=new Delegate,this._startLoading=new Delegate,this._dataLoaded=new Delegate,this._tickmarksRangeChanged=new Delegate,this._barReceived=new Delegate,this._onChangedStyle=new Delegate,this._onCompleted=new Delegate,this._onStatusChanged=new Delegate,this._onRestarted=new Delegate,this._onSessionsStudyCreated=new Delegate,this.requestingIntradayWhenNotSupported=new Delegate,this.requestingResolutionWhenNotSupported=new Delegate,this.priceScaleChanged=new Delegate,this._requestOptions=i?i:TradingView.defaultRequestOption(),this.m_model=e,this._chartApi=e._chartApi,this.m_data=new A58(this,e),this.setProperties(t),this._prevChartStyle=t.style.value(),this.$63(),this._dataWindowView=new SeriesDataWindowView(this,e),
this._statusView=new SeriesStatusView(this,e.properties()),this._priceAxisViews=new List,this._priceAxisViews.append(new SeriesPriceAxisView(this,e)),this._priceAxisViews.append(new ProjectionSeriesPriceAxisView(this,e)),this._symbolInfo=null,this._status=TradingView.Series.STATUS_OFFLINE;var n=this;this._turnaroundCounter=1,this._turnaround="s"+this._turnaroundCounter,this._handler=function(e){n.onData(e)},this.D2.addExclusion&&this.D2.addExclusion("visible"),this._base=100,this._formatter=new PriceFormatter(this._base),this._predictBars=0,this._futureBarsPaneView=null,this.D2.showInDataWindow.listeners().subscribe(e,W79.prototype.fullUpdate),this.marketStatus=new WatchedValue,this._seriesLoaded=!1,this.properties().minTick.listeners().subscribe(this,TradingView.Series.prototype._recreateFormatter),n=this,this.properties().minTick.listeners().subscribe(null,function(){n.m_model.D20(new A22(A22.FULL_UPDATE))}),this._priceLineView=new W23(this),this.bindJapChartsInputs(),this.createExtendedHoursProperty(),this.extendedHours.listeners().subscribe(this,function(){this._extendedHoursChanged.fire()}),this._extendedHoursNotPermitted.subscribe(this,function(){this.D2.extendedHours.setValue(!1)}),this._extendedHoursChanged.subscribe(this,function(){this._status!==TradingView.Series.STATUS_SNAPSHOT&&this.restart()}),this._symbolIntervalChanged.subscribe(this,this.checkInterval),this.properties().showCountdown.listeners().subscribe(this,TradingView.Series.prototype._onChangeShowCountdown),this._onChangeShowCountdown(this.properties().showCountdown),this._recreateFormatter()},inherit(TradingView.Series,PriceDataSource),TradingView.Series.prototype.serverTimeOffset=function(){return this._chartApi.serverTimeOffset()},TradingView.Series.prototype._onChangeShowCountdown=function(e){var t=this;e.value()?this._countdownUpdateTimer=this.m_model.setInterval(function(){t._priceAxisViews.item(0).update(),t.m_model.D20(new A22(A22.LIGHT_UPDATE))},500):(this.m_model.clearInterval(this._countdownUpdateTimer),delete this._countdownUpdateTimer)},TradingView.Series.prototype.lastValueData=function(e,t,i){if(e={},this.m_model.timeScale().isEmpty()||this.priceScale().isEmpty()||this.data().isEmpty())return null;var n=this.m_model.timeScale().visibleBars();if(n.isEmpty())return null;var o;if(t){if(t=this.data().bars().last(),null==t)return null;o=t.value,t=parseInt(t)}else{if(t=this.data().bars().search(n.lastBar(),SEARCH_NEAREST_LEFT),void 0===t)return null;o=this.data().bars().valueAt(t.index),t=t.index}return o=o[CLOSE_PLOT],i&&(e.price=o),this.priceScale().properties().percentage.value()&&(i=this.nearestIndex(n.firstBar(),SEARCH_NEAREST_RIGHT),this.data().valueAt(i),i=this.firstValue(),o=this.priceScale().priceRange().convertToPercent(o,i)),e.text=this.priceScale().formatter().format(o),i=this.barColorer().barStyle(t,!1),e.color=i.barColor,e.floatCoordinate=this.priceScale().priceToCoordinate(o,!0),e.coordinate=Math.round(e.floatCoordinate),e},TradingView.Series.prototype._prepareChartApiParams=function(){return this._requestOptions.startDate?!this._requestOptions.startDate||this._requestOptions.endDate||this._requestOptions.count?this._requestOptions.startDate&&this._requestOptions.endDate?["from_to",this._requestOptions.startDate,this._requestOptions.endDate]:["from_to",this._requestOptions.startDate,this._requestOptions.count]:["from_to",this._requestOptions.startDate]:this._requestOptions.count||DEFAULT_BAR_COUNT},TradingView.Series.prototype._nextSymbolId=1,TradingView.Series.prototype._nextSeriesId=1,TradingView.Series.STYLE_BARS=0,TradingView.Series.STYLE_CANDLES=1,TradingView.Series.STYLE_LINE=2,TradingView.Series.STYLE_LINE_TYPE_MARKERS=0,TradingView.Series.STYLE_LINE_TYPE_STEP=1,TradingView.Series.STYLE_LINE_TYPE_SIMPLE=2,TradingView.Series.STYLE_AREA=3,TradingView.Series.STYLE_RENKO=4,TradingView.Series.STYLE_KAGI=5,TradingView.Series.STYLE_PNF=6,TradingView.Series.STYLE_PB=7,TradingView.Series.STYLE_HEIKEN_ASHI=8,TradingView.Series.STYLE_HOLLOW_CANDLES=9,TradingView.Series.STATUS_OFFLINE=0,TradingView.Series.STATUS_RESOLVING=1,TradingView.Series.STATUS_LOADING=2,TradingView.Series.STATUS_READY=3,TradingView.Series.STATUS_INVALID_SYMBOL=4,TradingView.Series.STATUS_SNAPSHOT=5,TradingView.Series.STATUS_EOD=6,TradingView.Series.STATUS_PULSE=7,TradingView.Series.STATUS_DELAYED=8,TradingView.Series.STATUS_DELAYED_STREAMING=9,TradingView.Series.PERMISSION_DENIED="permission denied",TradingView.Series.PD_REASON_SYMBOL="symbol",TradingView.Series.PD_REASON_EXTENDED_HOURS="extended_hours",TradingView.Series.STUDY_NOT_AUTH="study_not_auth",TradingView.Series.prototype.model=function(){return this.m_model},TradingView.Series.prototype.fixLastBar=function(){if(!this._futureBarsPaneView){var e=parseInt(this.data().last(),10)+1;this._futureBarsPaneView=new TradingView.$79(this,e)}},TradingView.Series.prototype.clearData=function(){this.data().clear()},TradingView.Series.prototype.data=function(){return this.m_data},TradingView.Series.prototype.symbolId=function(){return this._symbolId},TradingView.Series.prototype.isPulse=function(){return this._symbolInfo&&0<this._symbolInfo.resolutions.length},TradingView.Series.prototype.onTagsChanged=function(){return this._tagsChanged},TradingView.Series.prototype.onSymbolIntervalChanged=function(){return this._symbolIntervalChanged},TradingView.Series.prototype.onSymbolResolved=function(){return this._symbolResolved},TradingView.Series.prototype.onSymbolError=function(){return this._symbolError},TradingView.Series.prototype.onSymbolNotPermitted=function(){return this._symbolNotPermitted},TradingView.Series.prototype.onExtendedHoursNotPermitted=function(){return this._extendedHoursNotPermitted},TradingView.Series.prototype.onStartLoading=function(){return this._startLoading},TradingView.Series.prototype.onDataLoaded=function(){return this._dataLoaded},TradingView.Series.prototype.onStatusChanged=function(){return this._onStatusChanged},TradingView.Series.prototype.onTickmarksRangeChanged=function(){return this._tickmarksRangeChanged},TradingView.Series.prototype.onBarReceived=function(){return this._barReceived},TradingView.Series.prototype.onChangedStyle=function(){return this._onChangedStyle},TradingView.Series.prototype.onCompleted=function(){return this._onCompleted},TradingView.Series.prototype.onRestarted=function(){return this._onRestarted},TradingView.Series.prototype.onBoxSizeChanged=function(){return this._boxSizeChanged},TradingView.Series.prototype.status=function(){return this._status},TradingView.Series.prototype.isDWM=function(){return!(3600>+this.D2.interval.value())},TradingView.Series.prototype.lastPriceLabelFixedCoordinate=function(){return this._priceAxisViews.item(0)._fixedCoordinate},TradingView.Series.prototype.$63=function(){this._projectionBarsPaneView=this._paneView=null,this._symbolLabelView=new TradingView.W38(this.m_model,this,CLOSE_PLOT,"firstShortName");var e=this.D2.style.value();switch(e){case TradingView.Series.STYLE_BARS:this._paneView=new W15(this,this.m_model);break;case TradingView.Series.STYLE_CANDLES:this._paneView=new W16(this,this.m_model);break;case TradingView.Series.STYLE_LINE:this._paneView=new W20(this,this.D2.lineStyle.priceSource.value(),this.m_model);break;case TradingView.Series.STYLE_AREA:this._paneView=new W13(this,this.D2.areaStyle.priceSource.value(),this.m_model);break;case TradingView.Series.STYLE_RENKO:this._paneView=new W28(this,this.m_model),this._projectionBarsPaneView=new W27(this,this.m_model);break;case TradingView.Series.STYLE_PB:this._paneView=new W22(this,this.m_model),this._projectionBarsPaneView=new W26(this,this.m_model);break;case TradingView.Series.STYLE_KAGI:this._paneView=new W19(this,this.m_model),this._projectionBarsPaneView=new W24(this,this.m_model);break;case TradingView.Series.STYLE_PNF:this._paneView=new W21(this,this.m_model),this._projectionBarsPaneView=new W25(this,this.m_model);break;case TradingView.Series.STYLE_HEIKEN_ASHI:this._paneView=new W17(this,this.m_model);break;case TradingView.Series.STYLE_HOLLOW_CANDLES:this._paneView=new W18(this,this.m_model);break;default:throw"Unknown chart style assigned: "+e}},TradingView.Series.prototype.invalidateBarColorerCache=function(){delete this._barColorerCache},TradingView.Series.prototype.barColorer=function(){if(this._barColorerCache)return this._barColorerCache;for(var e=null,t=this.m_model.D19().size()-1;t>=0;t--){var i=this.m_model.D19().item(t);i.metaInfo&&isInherited(i.constructor,TradingView.Study)&&i.hasBarColorer()&&i.properties().visible.value()&&(i=i.barColorer(),null===e?e=i:e.pushBackBarColorer(i))}return null===e?e=new SeriesBarColorer(this):e.pushBackBarColorer(new SeriesBarColorer(this)),this._barColorerCache=e},TradingView.Series.prototype.properties=function(){return this.D2},TradingView.Series.prototype.state=function(e){var t={type:this===this.m_model.mainSeries()?"MainSeries":TradingView.className(this.constructor),id:this.id(),state:this.properties().state(),zorder:this.zorder()};return t.state.symbol=this._symbolInfo.ticker||t.state.symbol,e&&(t.bars=this.m_data.m_bars.state(),t.nsBars=this.m_data.m_nsBars.state(),t.symbolInfo=this._symbolInfo,t.rtPrice=this.data().lastProjectionPrice),t.boxSize=this.data().boxSize,t},TradingView.Series.prototype.uniqueId=function(){return this.symbol()+"|"+this.interval()},TradingView.Series.prototype.stateForAlert=function(){var e=this.state();return e.uniqueId=this.uniqueId(),e},TradingView.Series.prototype.restoreData=function(e,t,i,n,o){this._status=TradingView.Series.STATUS_SNAPSHOT,this.m_data.m_bars.restoreState(e),this.m_data.m_nsBars.restoreState(t),this.updateSymbolInfo(i),this.m_data.lastProjectionPrice=n,this.m_data.boxSize=o,o||(this.properties().style.value()==TradingView.Series.STYLE_PNF?this.m_data.boxSize=this.properties().pnfStyle.inputs.boxSize.value():this.properties().style.value()==TradingView.Series.STYLE_RENKO&&(this.m_data.boxSize=this.properties().renkoStyle.inputs.boxSize.value()))},TradingView.Series.prototype.setProperties=function(e){e.timeframe||e.merge({timeframe:""}),e.shortName||e.merge({shortName:""}),this.D2=e,this.D2.symbol.listeners().subscribe(this,TradingView.Series.prototype.changeSymbol),this.D2.interval.listeners().subscribe(this,TradingView.Series.prototype.changeInterval),this.D2.timeframe.listeners().subscribe(this,TradingView.Series.prototype.changeTimeFrame),this.D2.listeners().subscribe(this,TradingView.Series.prototype.changeProperties),this.m_model.properties().scalesProperties.subscribe(this,TradingView.Series.prototype.fullUpdateChartWidget)},TradingView.Series.prototype.changeSymbol=function(){TradingView.trackEvent("GUI","Change symbol"),this.setSymbolIntervalDelayed(),this.m_model.checkLineToolSelection()},TradingView.Series.prototype.changeInterval=function(){TradingView.trackEvent("GUI","Change interval"),this.setSymbolIntervalDelayed()},TradingView.Series.prototype.changeTimeFrame=function(){TradingView.trackEvent("GUI","Change timeframe"),timeframe=this.D2.interval.value()},TradingView.Series.prototype.title=function(){return this.properties().symbol.value()+", "+translatedIntervalString(this.properties().interval.value())},TradingView.Series.prototype.fullUpdateChartWidget=function(){var e=this;setTimeout(function(){e.m_model.fullUpdate()},300)},TradingView.Series.prototype.changeProperties=function(e){e!==this.D2.symbol&&e!==this.D2.interval&&e!==this.D2.timeframe&&(this._tagsChanged.fire(),this.$63(),this.updateAllViews(),this.m_model.updateSource(this),this.fullUpdateChartWidget())},TradingView.Series.prototype._makeNextSymbolId=function(){return"symbol_"+this._nextSymbolId++},TradingView.Series.prototype._makeNextSeriesId=function(){return"s"+this._nextSeriesId++},TradingView.Series.prototype._clearLoadingTimer=function(){this.loadingTimer&&(TradingView.logDebug("Series loading took "+((new Date).getTime()-this._loadingStartTime)+" ms"),clearTimeout(this.loadingTimer),this.loadingTimer=null)},TradingView.Series.prototype.onData=function(e){var t=this;switch(e.method){case"symbol_resolved":if(e.params[0]!==this._symbolId){TradingView.logNormal("command for old symbol. Expected:"+this._symbolId+", actual"+e.params[0]);break}this.updateSymbolInfo(e.params[1]),this.m_model.updateSource(this),this._symbolResolved.fire(this._symbolInfo),this.m_model.realignLineTools();var i=this.symbolInfo().minmov/this.symbolInfo().pricescale,n=this.properties();n.style.value()==TradingView.Series.STYLE_RENKO&&n.renkoStyle.inputs.boxSize.value()<i?n.renkoStyle.inputs.merge({boxSize:i}):n.style.value()==TradingView.Series.STYLE_PNF&&n.pnfStyle.inputs.boxSize.value()<i?n.pnfStyle.inputs.merge({boxSize:i}):n.style.value()==TradingView.Series.STYLE_KAGI&&n.kagiStyle.inputs.reversalAmount.value()<i&&n.kagiStyle.inputs.merge({reversalAmount:i});break;case"symbol_error":if(e.params[0]!==this._symbolId){TradingView.logNormal("command for old symbol. Expected:"+this._symbolId+", actual"+e.params[0]);break}if(this._clearLoadingTimer(),this._setStatus(TradingView.Series.STATUS_INVALID_SYMBOL),this.D2.shortName.setValue(this.D2.symbol.value()),this.m_model.clearAllStudies(),this.updateAllViews(),this.m_model.updateSource(this),e.params[1]==TradingView.Series.PERMISSION_DENIED)switch(e.params[2]){case TradingView.Series.PD_REASON_EXTENDED_HOURS:this._extendedHoursNotPermitted.fire();break;case TradingView.Series.PD_REASON_SYMBOL:this._symbolNotPermitted.fire(e.params[3]);break;default:this._symbolNotPermitted.fire(e.params[2])}else this.m_model.resetTimeScale(),this._symbolError.fire(),A72.sendReport("symbol_error",{chartSession:t._chartApi._sessionid,symbol:t.getSymbolString()});this.m_model.realignLineTools();break;case"series_timeframe":if(e.params[1]!==this._turnaround)break;i=e.params[3],n=e.params[4],this.m_model.setTimeViewport(e.params[2],"undefined"!=typeof n&&n?i:i+10);break;case"series_error":i=e.params[2],this._clearLoadingTimer(),W77.enabled("charting_library_debug_mode")&&console.log("Error reason: "+i),i&&i.startsWith("study_not_auth:")?(i=i.split(":",2)[1].split("@",2)[0],i in{BarSetRenko:!0,BarSetPriceBreak:!0,BarSetKagi:!0,BarSetPnF:!0}?this.chartTypeNotPermitted.fire(i):"BarSetSpread"===i&&this.intradaySpreadNotPermitted.fire()):"resolution_not_entitled"==i?this.intradayExchangeNotPermitted.fire():"custom_resolution"==i&&this.customIntervalNotPermitted.fire(),this._setStatus(TradingView.Series.STATUS_INVALID_SYMBOL);break;case"series_loading":if(e.params[1]!==this._turnaround)break;if(e.params[0]!==this._seriesId){TradingView.logNormal("command for old series. Expected:"+this._seriesId+", actual"+e.params.customId);break}this._setStatus(TradingView.Series.STATUS_LOADING),0==this.m_data.m_bars.size()&&(t._loadingStartTime=(new Date).getTime(),t.loadingTimer=setTimeout(function(){var e={chartSession:t._chartApi._sessionid,symbol:t.getSymbolString(),interval:t.interval()};A72.sendReport("series_loading",e)},15e3));break;case"series_completed":if(e.params[2]!==this._turnaround)break;if(e.params[0]!==this._seriesId){TradingView.logNormal("command for old series. Expected:"+this._seriesId+", actual"+e.params.customId);break}switch(i=e.params[1],"pulsed"==i&&(i="delayed"),i){case"streaming":this._setStatus(TradingView.Series.STATUS_READY);break;case"endofday":this._setStatus(TradingView.Series.STATUS_EOD);break;case"delayed":this._setStatus(TradingView.Series.STATUS_DELAYED);break;case"pulsed":this._setStatus(TradingView.Series.STATUS_PULSE)}i.match(/delayed_streaming/)&&this._setStatus(TradingView.Series.STATUS_DELAYED_STREAMING),this.requestMoreData(),i=this.m_model.paneForSource(this),i.recalculatePriceScale(this.priceScale()),this.m_model.D20(new A22(A22.FULL_UPDATE)),this.m_data.size()&&this._tickmarksRangeChanged.fire({start:this.data().first().value[TIME_PLOT],end:this.data().last().value[TIME_PLOT]}),this.model().recalcVisibleRangeStudy(this.model().D19(),!0),!this.isLockScale()||this.model().timeScale().isEmpty()||this._seriesLoaded||(this.model().timeScale()._correctOffset(),this.model().timeScale().correctBarSpacing(),i=this.model().timeScale().visibleBars(),this.priceScale().setPriceRange(this.priceRange(i.firstBar(),i.lastBar()))),this._seriesLoaded=!0,this._onCompleted.fire();break;case"data_update":if(e.params.customId!==this._seriesId){TradingView.logNormal("command for old series. Expected:"+this._seriesId+", actual"+e.params.customId);break}if(this.status()===TradingView.Series.STATUS_INVALID_SYMBOL)break;this._clearLoadingTimer(),0<e.params.plots.length&&(this._endOfData=!1),e.params.plots.length?(i=this.m_data.m_bars.size(),this.m_data.m_bars.merge(e.params.plots),i!=this.bars().size()&&this._barReceived.fire(this.m_data.m_bars.size()),this.model().recalcVisibleRangeStudy(this.model().D19(),!0)):(this.m_data.clear(),this._startLoading.fire()),i=this.properties().style.value(),!e.params.nonseries||i!==TradingView.Series.STYLE_RENKO&&i!==TradingView.Series.STYLE_KAGI&&i!==TradingView.Series.STYLE_PNF&&i!==TradingView.Series.STYLE_PB?e.params.nonseries||(this.m_data.m_nsBars.clear(),this.m_data.lastProjectionPrice=void 0):(i=this.parseJapProjBars(e.params.nonseries),this.m_data.m_nsBars=i.nsBars,this.m_data.lastProjectionPrice=i.lastPrice,n=this.m_data.boxSize!==i.boxSize,this.m_data.boxSize=i.boxSize,n&&this._boxSizeChanged.fire(this.m_data.boxSize)),i=this.m_model.paneForSource(this),this.m_model.updateAllVolumeStudies(),this.m_model.recalculatePane(i),this.m_model.updateSource(this),this.m_model.updateLineTools()}this._dataLoaded.fire(e)},TradingView.Series.prototype.fixBoxSize=function(){var e=this.model().timeScale(),t=this.priceScale();t.isEmpty()||e.isEmpty()||(this.m_data.boxSize=Math.abs(t.coordinateToPrice(e.barSpacing())-t.coordinateToPrice(0)))},TradingView.Series.prototype.parseJapProjBars=function(e){var t=new PlotList(["time","open","high","low","close"]),i=this.model().timeScale(),n=this.properties().style.value();if(e.d&&""!==e.d)for(var o=JSON.parse(e.d).data,r=o.price,s=o.boxSize,o=o.bars,a=0;o&&a<o.length;a++){var l=[],d=e.indexes[o[a].time];l.push(i.points().valueAt(d)),l.push(o[a].open),l.push(o[a].high),l.push(o[a].low),l.push(o[a].close),l.push(o[a].volume),n===TradingView.Series.STYLE_KAGI?l.push(o[a].additionalPrice):n===TradingView.Series.STYLE_PNF&&l.push(o[a].factor),t.add(d,l)}return{nsBars:t,lastPrice:r,boxSize:s}},TradingView.Series.prototype.disconnect=function(){this._seriesId=this._symbolId=null,this._status=TradingView.Series.STATUS_OFFLINE},TradingView.Series.prototype.isStarted=function(){return!!this._symbolId},TradingView.Series.prototype.restart=function(){this._onRestarted.fire(),this._setStatus(TradingView.Series.STATUS_RESOLVING),this.m_data=new A58(this,this.model()),this._prevSymbolId=this._symbolId,this._symbolId=this._makeNextSymbolId(),this._chartApi.resolveSymbol(this._symbolId,this.getSymbolString(),this._handler),this._seriesId?(this._turnaround="s"+ ++this._turnaroundCounter,this._chartApi.modifySeries(this._seriesId,this._turnaround,this._symbolId,this.D2.interval.value(),this._handler,this._prevSymbolId)):(this._seriesId=this._makeNextSeriesId(),this._chartApi.createSeries(this._seriesId,this._turnaround,this._symbolId,this.D2.interval.value(),this._prepareChartApiParams(),this._handler)),this.D2.showInDataWindow.listeners().subscribe(this.m_model,W79.prototype.fullUpdate),this.m_symbol=this.D2.symbol.value(),this.m_interval=this.D2.interval.value(),this._seriesLoaded=!1},TradingView.Series.prototype._generateTimeframe=function(e,t){var i=t.right(1),n=e;return"ytd"===t?n+=",YTD":"d"===i?(i=t.left(t.length-1),n+=","+i,W77.enabled("daily_timeframe_suffix")&&(n+="D")):"m"===i?(i=t.left(t.length-1),n+=","+i+"M"):"all"===t&&(n+=",ALL"),n},TradingView.Series.prototype.setSymbolIntervalDelayed=function(){this._setSymbolIntervalDelay&&clearTimeout(this._setSymbolIntervalDelay),this._setSymbolIntervalDelay=setTimeout(function(){delete this._setSymbolIntervalDelay,this.setSymbolInterval(this.D2.symbol.value(),this.D2.interval.value())}.bind(this),10)},TradingView.Series.prototype.setSymbolInterval=function(e,t){var i=(t+"").split(","),n=0,o=t;2==i.length&&(o=i[0],n=i[1]);var i=!this.symbolSameAsCurrent(e)||W77.enabled("same_data_requery"),r=this.m_interval!==o||W77.enabled("same_data_requery");if((i||r)&&(this.m_model.realignLineTools(),this.m_symbol=e,this.m_interval=o,this.m_timeframe=n,this._status!==TradingView.Series.STATUS_SNAPSHOT)){if(this._setStatus(TradingView.Series.STATUS_RESOLVING),this._symbolId&&!i||this.updateSymbolInfo(null),this._symbolIntervalChanged.fire(),this._onRestarted.fire(),this._chartApi&&this._chartApi.connected())if((!this._symbolId||i)&&(this._prevSymbolId=this._symbolId,this._symbolId=this._makeNextSymbolId(),n=this.getSymbolString(),this._chartApi.resolveSymbol(this._symbolId,n,this._handler)),this._seriesId){this._modifyTimer&&clearTimeout(this._modifyTimer);var s=this;s._turnaround="s"+ ++s._turnaroundCounter,this._pendingInterval&&(t=this._generateTimeframe(t,this._pendingInterval),delete this._pendingInterval),this._modifyTimer=setTimeout(function(){s._predictBars=0,s._chartApi.modifySeries(s._seriesId,s._turnaround,s._symbolId,t,s._handler,this._prevSymbolId),s._modifyTimer=null},30)}else this._seriesId=this._makeNextSeriesId(),this._chartApi.createSeries(this._seriesId,this._turnaround,this._symbolId,t,this._prepareChartApiParams(),this._handler);this._seriesLoaded=!1,this._haveToScroll=!0}},TradingView.Series.prototype.actualSymbol=function(){return this.symbolInfo()?this.symbolInfo().ticker||this.symbolInfo().full_name:this.symbol()},TradingView.Series.prototype.symbol=function(){return this.properties().symbol.value()},TradingView.Series.prototype.interval=function(){return this.properties().interval.value()},TradingView.Series.prototype.isIntradayInterval=function(){return!!/^\d*$/.test(this.interval())&&1440>=this.interval()},TradingView.Series.prototype.bars=function(){return this.m_data.m_bars},TradingView.Series.prototype.nsBars=function(){return this.m_data.m_nsBars},TradingView.Series.prototype.open=function(e){return this.m_data.valueAt(e)[OPEN_PLOT]},TradingView.Series.prototype.high=function(e){return this.m_data.valueAt(e)[HIGH_PLOT]},TradingView.Series.prototype.low=function(e){return this.m_data.valueAt(e)[LOW_PLOT]},TradingView.Series.prototype.close=function(e){return this.m_data.valueAt(e)[CLOSE_PLOT]},TradingView.Series.prototype.hl2=function(e){return(this.high(e)+this.low(e))/2},TradingView.Series.prototype.hlc3=function(e){return(this.high(e)+this.low(e)+this.close(e))/3},TradingView.Series.prototype.ohlc4=function(e){return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4},TradingView.Series.prototype.priceRange=function(e,t){if(!isInteger(e))return TradingView.logDebug("Series.priceRange: incorrect startBar"),null;if(!isInteger(t))return TradingView.logDebug("Series.priceRange: incorrect endBar"),null;if(this.data().isEmpty())return null;if(this.isLockScale()){var i=this.data().boxSize;void 0===i&&this.fixBoxSize();var n=this.priceScale().internalHeight()/(this.model().timeScale().barSpacing()/this.data().boxSize),i=this.data().search(t,SEARCH_NEAREST_LEFT),i=(i.value[HIGH_PLOT]+i.value[LOW_PLOT])/2,n=new PriceRange(i-.5*n,i+.5*n),i=this.data().search(e,SEARCH_NEAREST_RIGHT);return this.priceScale().properties().percentage.value()&&n?n.convertToPercents(i.value[CLOSE_PLOT]):n}return this.properties().style.value===TradingView.Series.STYLE_PNF&&(i=this.data().boxSize,n.apply(n.minValue()-.5*i,n.maxValue()+.5*i)),n=function(e,t,i){return e.firstBar||(e.firstBar=i),null===e.range?e.range=new PriceRange(i[LOW_PLOT],i[HIGH_PLOT]):e.range.apply(i[LOW_PLOT],i[HIGH_PLOT]),e},i={range:null,firstBar:null},i=this.data().bars().range(e,t).reduce(n,i),i=this.data().nsBars().range(e,t).reduce(n,i),n=i.range,i=i.firstBar,n&&n.minValue()===n.maxValue()&&(n=new PriceRange(n.minValue()-.5,n.maxValue()+.5)),this.priceScale().properties().percentage.value()&&n?n.convertToPercents(i[CLOSE_PLOT]):this.priceScale().isLog()&&n?new PriceRange(this.priceScale().priceToLogical(n.minValue()),this.priceScale().priceToLogical(n.maxValue())):n},TradingView.Series.prototype.nearestData=function(e,t){if(isInteger(e)){var i=this.data().search(e,t);return i?i:void 0}TradingView.logDebug("Series.nearestData: incorrect logicalPoint")},TradingView.Series.prototype.nearestIndex=function(e,t){var i=this.nearestData(e,t);return i?i.index:void 0},TradingView.Series.prototype.paneViews=function(e){return this.properties().visible.value()?(e=(new List).append(this._paneView),this._futureBarsPaneView&&e.append(this._futureBarsPaneView),this._projectionBarsPaneView&&e.append(this._projectionBarsPaneView),e.append(this._priceLineView),e.append(this._symbolLabelView),e):null},TradingView.Series.prototype.dataWindowView=function(){return this._dataWindowView},TradingView.Series.prototype.statusView=function(){return this._statusView},TradingView.Series.prototype.priceAxisViews=function(e,t){return this.m_model.paneForSource(this)===e&&t===this.priceScale()&&(this.m_model.properties().scalesProperties.showSeriesLastValue.value()||this.properties().showCountdown.value())?this._priceAxisViews:null},TradingView.Series.prototype.base=function(){return this._base},TradingView.Series.prototype.formatter=function(){return this._formatter},TradingView.Series.prototype.purgeSymbolInfo=function(){this._symbolInfo=null},TradingView.Series.prototype.symbolInfo=function(){return this._symbolInfo},TradingView.Series.prototype._recreateFormatter=function(){if("default"==this.properties().minTick.value())this._formatter=new PriceFormatter(this._symbolInfo?this._symbolInfo.pricescale:100,this._symbolInfo?this._symbolInfo.minmov:1,this._symbolInfo?this._symbolInfo.fractional:!1,this._symbolInfo?this._symbolInfo.minmove2:void 0);else{var e=this.properties().minTick.value().split(","),t=parseInt(e[0]),i=parseInt(e[1]);this._formatter=new PriceFormatter(t,i,"true"===e[2])}this.priceScale()&&this.priceScale().updateFormatter()},TradingView.Series.prototype.updateSymbolInfo=function(e){var t=this,i=e&&(e.ticker||e.pro_name||e.full_name);(this._symbolInfo=e)&&(this.D2.shortName.setValue(e.name),i&&this.D2.symbol.value().toUpperCase()!==i.toUpperCase()&&this.D2.symbol.setValue(i)),this._base=e?e.pricescale/e.minmov:100,this._recreateFormatter(),this._statusView.update(),this.priceScale().updateFormatter(),"undefined"!=typeof quoteSessionMultiplexerInstance&&(this._quoteSessionClientId||(this._quoteSessionClientId="series-"+TradingView.guid()),this._quoteSessionSymbol&&(quoteSessionMultiplexerInstance.simple.unsubscribe(this._quoteSessionClientId,this._quoteSessionSymbol),this._quoteSessionSymbol=void 0),i&&(this._quoteSessionSymbol=i,quoteSessionMultiplexerInstance.simple.subscribe(this._quoteSessionClientId,this._quoteSessionSymbol,function(e,i){t.quoteData=e&&e.values||null,i&&i.values&&i.values.current_session&&t.marketStatus.setValue(i.values.current_session)}))),this.checkInterval(),this.dataPoweredBy=TradingView.getDataVendorString(e)},TradingView.Series.prototype.symbolSameAsCurrent=function(e){if(this.m_symbol===e)return!0;var t=this._symbolInfo;return!t||t.full_name!==e&&t.pro_name!==e?!1:!0},TradingView.Series.prototype.updateAllViews=function(){this._paneView.update(),this._dataWindowView.update(),this._statusView.update(),this._priceAxisViews.item(0).update(),this._priceAxisViews.item(1).update(),this._futureBarsPaneView&&this._futureBarsPaneView.update(),this._projectionBarsPaneView&&this._projectionBarsPaneView.update(),this._priceLineView.update(),this._symbolInfo&&this._symbolLabelView.update()},TradingView.Series.prototype.tags=function(){var e=[this.D2.symbol.value(),this.D2.interval.value()+"minutes"];if(this._symbolInfo&&this._symbolInfo.description){var t=this._symbolInfo.description.replace(",","").split(" ");e.push(t)}return e},TradingView.Series.prototype._setStatus=function(e){this._status=e,this._statusView.update(),this.m_model.updateSource(this),this._onStatusChanged.fire()},TradingView.Series.prototype.requestMoreData=function(){if((this._status===TradingView.Series.STATUS_READY||this._status===TradingView.Series.STATUS_PULSE||this._status===TradingView.Series.STATUS_DELAYED||this._status===TradingView.Series.STATUS_DELAYED_STREAMING||this._status===TradingView.Series.STATUS_EOD)&&!this.m_model.timeScale().isEmpty()){var e=this.m_model.timeScale().visibleBars();if(!e.isEmpty()&&0!==this.bars().size()){var t=e.lastBar()-this.data().last();this._predictBars<t&&(this._predictBars=t,this._chartApi&&this._chartApi.connected()&&this._chartApi.requestMoreTickmarks(this._seriesId,t,this._handler)),this._endOfData||(e=this.bars()._indexAt(0)-e.firstBar(),0>=e||(this._endOfData=!0,this._chartApi&&this._chartApi.connected()&&this._chartApi.requestMoreData(this._seriesId,e,this._handler),this._setStatus(TradingView.Series.STATUS_LOADING)))}}},TradingView.Series.prototype.bindJapChartsInputs=function(){this.D2.style.listeners().subscribe(this,this.onChartStyleChanged),this.D2.renkoStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this.D2.renkoStyle.inputs.source.listeners().subscribe(this,this.onInputChanged),this.D2.renkoStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this.D2.renkoStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this.D2.pbStyle.inputs.lb.listeners().subscribe(this,this.onInputChanged),this.D2.pbStyle.inputs.source.listeners().subscribe(this,this.onInputChanged),this.D2.kagiStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this.D2.kagiStyle.inputs.source.listeners().subscribe(this,this.onInputChanged),this.D2.pnfStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this.D2.pnfStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this.D2.pnfStyle.inputs.sources.listeners().subscribe(this,this.onInputChanged),this.D2.pnfStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this.D2.pnfStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged);var e=this;this.D2.lockScale.listeners().subscribe(this,function(t){t.value()&&e.model().timeScale().recalcLockedScale()})},TradingView.Series.prototype.createExtendedHoursProperty=function(){function e(){var e=window.user?!!user.extended_session:!1,i=t.model().readOnly(),n=t.D2.extendedHours.value();!n||i||e||(t._extendedHoursNotPermitted.fire(),n=!1),n&&!t.isIntradayInterval()&&(n=!1),t.extendedHours.setValue(n)}var t=this;t.extendedHours=new Property,t.D2.extendedHours.listeners().subscribe(null,e),t.D2.interval.listeners().subscribe(null,e),t.chartWidgetInitialized.subscribe(null,e),e()},TradingView.Series.prototype.isNeedRestart=function(e){if(void 0===e&&(e=this.properties().style.value()),this._prevChartStyle!=e){var t=[TradingView.Series.STYLE_BARS,TradingView.Series.STYLE_CANDLES,TradingView.Series.STYLE_HOLLOW_CANDLES,TradingView.Series.STYLE_LINE,TradingView.Series.STYLE_AREA];if(!(-1<t.indexOf(this._prevChartStyle)&&-1<t.indexOf(e)))return!0}return!1},TradingView.Series.prototype.onChartStyleChanged=function(){this.isNeedRestart()&&(this.data().clear(),this.model().timeScale().scrollToRealtime(!1),this.restart()),this._prevChartStyle=this.properties().style.value(),this._onChangedStyle.fire(this.properties().style.value())},TradingView.Series.prototype.onInputChanged=function(){this.restart()},TradingView.Series.prototype.onExtendedHoursChanged=function(){return this._extendedHoursChanged},TradingView.Series.prototype.getSymbolString=function(){var e;switch(e=W77.enabled("pay_attention_to_ticker_not_symbol")&&this._symbolInfo?this._symbolInfo.ticker:this.D2.symbol.value(),this.extendedHours.value()&&(e={symbol:e,session:"extended"}),this.D2.style.value()){case TradingView.Series.STYLE_RENKO:var t=this.D2.renkoStyle.inputs;e={symbol:e,type:"BarSetRenko@tv-prostudies-1!",inputs:[t.source.value(),t.style.value(),t.boxSize.value(),t.atrLength.value()]};break;case TradingView.Series.STYLE_PB:
t=this.D2.pbStyle.inputs,e={symbol:e,type:"BarSetPriceBreak@tv-prostudies-1!",inputs:[t.source.value(),t.lb.value()]};break;case TradingView.Series.STYLE_KAGI:t=this.D2.kagiStyle.inputs,e={symbol:e,type:"BarSetKagi@tv-prostudies-1!",inputs:[t.source.value(),t.reversalAmount.value()]};break;case TradingView.Series.STYLE_PNF:t=this.D2.pnfStyle.inputs,e={symbol:e,type:"BarSetPnF@tv-prostudies-1!",inputs:[t.sources.value(),t.style.value(),t.boxSize.value(),t.atrLength.value(),t.reversalAmount.value()]};break;case TradingView.Series.STYLE_HEIKEN_ASHI:e={symbol:e,type:"BarSetHeikenAshi@tv-basicstudies-1!",inputs:[]}}return"string"!=typeof e&&(e="="+JSON.stringify(e)),e},TradingView.Series.prototype.getStyleShortName=function(){switch(this.D2.style.value()){case TradingView.Series.STYLE_BARS:return"bar";case TradingView.Series.STYLE_CANDLES:return"candle";case TradingView.Series.STYLE_HOLLOW_CANDLES:return"hollowCandle";case TradingView.Series.STYLE_LINE:return"line";case TradingView.Series.STYLE_AREA:return"area";case TradingView.Series.STYLE_RENKO:return"renko";case TradingView.Series.STYLE_PB:return"pb";case TradingView.Series.STYLE_KAGI:return"kagi";case TradingView.Series.STYLE_PNF:return"pnf";case TradingView.Series.STYLE_HEIKEN_ASHI:return"ha";default:throw Error("Missed short name for style "+this.D2.style.value())}},TradingView.Series.prototype.getInputsProperties=function(){var e=this.D2[this.getStyleShortName()+"Style"];return e.inputs||e.addProperty("inputs"),e.inputs},TradingView.Series.prototype.getRealVisibleRange=function(){var e,t=this.model().timeScale().visibleBars();return e=this.data().search(t.m_firstBar,SEARCH_NEAREST_RIGHT),t=this.data().search(t.m_lastBar,SEARCH_NEAREST_LEFT),void 0===e||void 0===t?null:new BarsRange(e.index,t.index)},TradingView.Series.prototype.isLockScale=function(){return this.properties().lockScale.value()},TradingView.Series.prototype.firstValue=function(){return this.data().firstValue()},TradingView.Series.prototype.firstBar=function(){return this.data().firstBar()},TradingView.Series.prototype.sessionsStudy=function(){if(this._sessionsStudy)return this._sessionsStudy;var e=this.model().paneForSource(this).D19();for(i=0;i<e.size();i++){var t=e.item(i);if(t instanceof TradingView.Study&&"Sessions"==t.metaInfo().shortId)return this._sessionsStudy=t}return!1},TradingView.Series.prototype.createSessStudy=function(){if(!W77.enabled("charting_library")&&!this.sessionsStudy()){var e=StudyMetaInfo.findStudyMetaInfo(this.model().studiesMetaData(),"Sessions@tv-basicstudies");this.model().insertStudy(e,!1,!0),this._onSessionsStudyCreated.fire()}},TradingView.Series.prototype.checkSessStudy=function(){W77.enabled("charting_library")||(this.sessionsStudy()||this.createSessStudy(),this.sessionsStudy().start())},TradingView.Series.prototype.isSpread=function(){return 1<this._symbolInfo.legs.length},TradingView.Series.prototype.firstSymbol=function(){return this._symbolInfo?this._symbolInfo.legs[0]:""},TradingView.Series.prototype.firstShortName=function(){return A68.ticker(this.firstSymbol())},TradingView.Series.prototype.onSessionsStudyCreated=function(){return this._onSessionsStudyCreated},TradingView.Series.prototype.loadDataTo=function(e){e.right(1),this._turnaround="s"+ ++this._turnaroundCounter;var t=this.D2.interval.value(),t=this._generateTimeframe(t,e);this._chartApi.modifySeries(this._seriesId,this._turnaround,this._symbolId,t,this._handler)},TradingView.Series.prototype.checkInterval=function(){if(this._symbolInfo&&(this.isDWM()||this._symbolInfo.has_intraday||this.requestingIntradayWhenNotSupported.fire(),this._symbolInfo.hasOwnProperty("supported_resolutions"))){var e=this.D2.interval.value();-1==this._symbolInfo.supported_resolutions.indexOf(e)&&this.requestingResolutionWhenNotSupported.fire(this._symbolInfo.supported_resolutions[0])}},TradingView.Series.prototype.setPriceScale=function(e){this.m_priceScale!=e&&(this.m_priceScale=e,this.priceScaleChanged.fire(e))},inherit(SeriesDataWindowView,DataWindowView),SeriesDataWindowView.prototype.update=function(){this._invalidated=!0},SeriesDataWindowView.prototype._updateImpl=function(){if(this._series.symbolInfo()?(this._header=[this._series.symbolInfo().name,translatedIntervalString(this._series.interval()),this._series.symbolInfo().exchange].join(", "),this._title=this._series.symbolInfo().description):this._header=this._series.symbol(),this._items.item(0).setValue($.t("n/a")),this._items.item(1).setValue($.t("n/a")),this._items.item(2).setValue($.t("n/a")),this._items.item(3).setValue($.t("n/a")),!this.D0.timeScale().isEmpty()&&0!==this._series.bars().size()){var e=this._series.barColorer(),t=this.D0.crossHairSource().index,t=this._series.nearestIndex(t,SEARCH_NEAREST_LEFT);if(void 0!==t){var i=this._series.data().valueAt(t),n=this._series.formatter();for(this._items.item(0).setValue(n.format(i[OPEN_PLOT])),this._items.item(1).setValue(n.format(i[HIGH_PLOT])),this._items.item(2).setValue(n.format(i[LOW_PLOT])),this._items.item(3).setValue(n.format(i[CLOSE_PLOT])),e=e.barStyle(t,!1).barColor,t=this._series.model().paneForSource(this._series).D2.background.value(),TradingView.colorsAreSimilar(e,t)&&(e=TradingView.invertColor(e)),t=0;4>t;t++)this._items.item(t).setColor(e)}}},SeriesDataWindowView.prototype.items=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items},SeriesDataWindowView.prototype.dump=function(){return{header:this._header,items:this._items}},SeriesDataWindowView.prototype.additional=function(){return this._series.dataPoweredBy?"(Data Provided by "+this._series.dataPoweredBy+")":void 0},W14.prototype.update=function(){this._invalidated=!0},W14.prototype._updateImpl=function(){var e=this;if(this.m_bars.clear(),!this.m_model.timeScale().isEmpty()&&!this.m_series.priceScale().isEmpty()){var t=this.m_model.timeScale().visibleBars();if(!t.isEmpty()&&0!==this.m_series.bars().size()){for(var i=this.m_series.nearestIndex(t.firstBar(),SEARCH_NEAREST_RIGHT),n=this.m_series.nearestIndex(t.lastBar(),SEARCH_NEAREST_LEFT);n>=i&&void 0===this.m_series.bars().valueAt(i);i++);if(!(i>n)){var t=this.m_series.bars().range(i,n),o=void 0;this.m_series.bars().first();var r=this.m_series.priceScale(),s=r.properties().percentage.value(),a=this.m_series.barColorer(),l={};if(t.each(function(t,i){if(void 0!=i[OPEN_PLOT]&&void 0!=i[HIGH_PLOT]&&void 0!=i[LOW_PLOT]&&void 0!=i[CLOSE_PLOT]){void 0===o&&(o=i[CLOSE_PLOT]);var n=new BarItem;n.setTime(Math.round(t)),s?(n.setOpen(100*(i[OPEN_PLOT]-o)/o),n.setHigh(100*(i[HIGH_PLOT]-o)/o),n.setLow(100*(i[LOW_PLOT]-o)/o),n.setClose(100*(i[CLOSE_PLOT]-o)/o)):(n.setOpen(i[OPEN_PLOT]),n.setHigh(i[HIGH_PLOT]),n.setLow(i[LOW_PLOT]),n.setClose(i[CLOSE_PLOT])),l.value=i;var r=a.barStyle(t,!1,l);l.previousValue=i,n.color=r.barColor,n.borderColor=r.barBorderColor,n.hollow=r.isBarHollow,e.m_bars.append(n)}},this),r.barPricesToCoordinates(this.m_bars),this.m_model.timeScale().barIndexesToCoordinates(this.m_bars),this.m_series===this.m_model.selectedSource())for(t=(new SelectionIndexes).calc(i,n),this._selectionData={points:new List},this._selectionData.hittestResult=HitTestResult.REGULAR,i=0;i<t.size();i++){var n=t.item(i),d=this.m_series.bars().valueAt(n);d&&(d=.5*(d[OPEN_PLOT]+d[CLOSE_PLOT]),r.properties().percentage.value()&&(d=100*(d-o)/o),n=this.m_model.timeScale().indexToCoordinate(n),d=this.m_series.priceScale().priceToCoordinate(d),this._selectionData.points.append(new MathEx.Point(n,d)))}}}}},W14.prototype.items=function(){return this.m_bars},W14.prototype.dump=function(){var e={};return e.bars=this.m_bars,e},inherit(W15,W14),W15.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.dontDrawOpen=this.m_series.properties().barStyle.dontDrawOpen.value();var t=new CompositeRenderer;return t.append(new W56(e)),this.m_series===this.m_model.selectedSource()&&t.append(new SelectionRenderer(this._selectionData)),t},inherit(W16,W14),W16.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.drawWick=this.m_series.properties().candleStyle.drawWick.value(),e.drawBorder=this.m_series.properties().candleStyle.drawBorder.value(),e.borderColor=this.m_series.properties().candleStyle.borderColor.value(),e.wickColor=this.m_series.properties().candleStyle.wickColor.value();var t=new CompositeRenderer;return t.append(new W57(e)),this.m_series===this.m_model.selectedSource()&&t.append(new SelectionRenderer(this._selectionData)),t},inherit(W17,W14),W17.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.drawWick=this.m_series.properties().haStyle.drawWick.value(),e.drawBorder=this.m_series.properties().haStyle.drawBorder.value(),e.borderColor=this.m_series.properties().haStyle.borderColor.value(),e.wickColor=this.m_series.properties().haStyle.wickColor.value();var t=new CompositeRenderer;return t.append(new W57(e)),this.m_series===this.m_model.selectedSource()&&t.append(new SelectionRenderer(this._selectionData)),t},inherit(W18,W14),W18.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.drawWick=this.m_series.properties().hollowCandleStyle.drawWick.value(),e.drawBorder=this.m_series.properties().hollowCandleStyle.drawBorder.value(),e.borderColor=this.m_series.properties().hollowCandleStyle.borderColor.value(),e.wickColor=this.m_series.properties().hollowCandleStyle.wickColor.value();var t=new CompositeRenderer;return t.append(new W57(e)),this.m_series===this.m_model.selectedSource()&&t.append(new SelectionRenderer(this._selectionData)),t},W29.prototype.update=function(){if(this.m_items.clear(),!this.m_model.timeScale().isEmpty()&&this.m_series.priceScale()&&!this.m_series.priceScale().isEmpty()){var e=this.m_model.timeScale().visibleBars();if(!e.isEmpty()&&0!==this.m_series.bars().size()){var t=this.m_series.nearestIndex(e.firstBar(),SEARCH_NEAREST_RIGHT),i=this.m_series.nearestIndex(e.lastBar(),SEARCH_NEAREST_LEFT),e=this.m_series.bars().range(t,i);this.m_series.bars();var n=void 0,o=this.m_series.priceScale();this.m_series.barColorer();for(var r={color:this.m_series.properties().lineStyle.color.value()},s=o.properties().percentage.value(),a=e._start;a<e._end;++a){var l=e._indexAt(a),d=e._valueAt(a),d=this._barGetter(d);void 0!==d&&null!==d&&(void 0===n&&(n=d),s&&(d=100*(d-n)/n),l=new MathEx.Point(l,d),l.style=r,this.m_items.append(l))}if(o.pointsArrayToCoordinates(this.m_items.toArray()),this.m_model.timeScale().indexesToCoordinates(this.m_items),this.m_series===this.m_model.selectedSource())for(e=(new SelectionIndexes).calc(t,i),this._selectionData={points:new List},this._selectionData.hittestResult=HitTestResult.REGULAR,a=0;a<e.size();a++)l=e.item(a),t=this.m_series.data().valueAt(l),d=this._barGetter(t),o.properties().percentage.value()&&(d=100*(d-n)/n),l=this.m_model.timeScale().indexToCoordinate(l),t=this.m_series.priceScale().priceToCoordinate(d),this._selectionData.points.append(new MathEx.Point(l,t))}}},inherit(W20,W29),W20.prototype.update=function(){this._invalidated=!0},W20.prototype.renderer=function(){this._invalidated&&(W29.prototype.update.call(this),this._invalidated=!1);var e,t=this.m_series.properties().lineStyle,t={barSpacing:this.m_model.timeScale().barSpacing(),items:this.m_items,lineColor:t.color.value(),lineStyle:t.linestyle.value(),withMarkers:t.styleType.value()===TradingView.Series.STYLE_LINE_TYPE_MARKERS,withSteps:t.styleType.value()===TradingView.Series.STYLE_LINE_TYPE_STEP,lineWidth:t.linewidth.value(),simpleMode:!0},t=new W68(t);return this.m_series===this.m_model.selectedSource()?(e=new CompositeRenderer,e.append(t),e.append(new SelectionRenderer(this._selectionData))):e=t,e},inherit(W13,W29),W13.prototype.update=function(){this._invalidated=!0},W13.prototype.renderer=function(){this._invalidated&&(W29.prototype.update.call(this),this._invalidated=!1);var e={simpleMode:!1};e.barSpacing=this.m_model.timeScale().barSpacing(),e.items=this.m_items,e.lineColor=this.m_series.properties().areaStyle.linecolor.value(),e.lineStyle=this.m_series.properties().areaStyle.linestyle.value(),e.lineWidth=this.m_series.properties().areaStyle.linewidth.value();var t=this.m_series.properties().areaStyle.transparency.value();return e.color1=generateColor(this.m_series.properties().areaStyle.color1.value(),t),e.color2=generateColor(this.m_series.properties().areaStyle.color2.value(),t),e.bottom=this.m_series.priceScale().height(),t=new CompositeRenderer,t.append(new W53(e)),this.m_series===this.m_model.selectedSource()&&t.append(new SelectionRenderer(this._selectionData)),t},inherit(SeriesStatusView,StatusView),SeriesStatusView.prototype.D20=function(){delete this._text,this.update()},SeriesStatusView.prototype.round=function(e,t){var i=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return i?i:""},SeriesStatusView.prototype.update=function(){if(!("_text"in this)){if(this._series.symbolInfo()?this._text=this._series.symbolInfo().description:this._text=this._series.symbol(),this._text+=", "+translatedIntervalString(this._series.interval()),this._series.symbolInfo()&&this._series.symbolInfo().exchange){var e=this._series.symbolInfo().exchange;"forex"==this._series.symbolInfo().type&&(e="FX"),this._text+=", "+e}switch(e=this._series.D2,e.style.value()){case TradingView.Series.STYLE_RENKO:var t=e.renkoStyle.inputs.style.value()+("ATR"===e.renkoStyle.inputs.style.value()?"("+e.renkoStyle.inputs.atrLength.value()+")":"");this._text+=", Renko ["+e.renkoStyle.inputs.source.value()+", "+t+", "+this.round(this._series.data().boxSize,4)+"]";break;case TradingView.Series.STYLE_PB:this._text+=", Line Break ["+e.pbStyle.inputs.source.value()+", "+e.pbStyle.inputs.lb.value()+"]";break;case TradingView.Series.STYLE_KAGI:this._text+=", Kagi ["+e.kagiStyle.inputs.source.value()+", "+e.kagiStyle.inputs.reversalAmount.value()+"]";break;case TradingView.Series.STYLE_PNF:t=e.pnfStyle.inputs.style.value()+("ATR"===e.pnfStyle.inputs.style.value()?"("+e.pnfStyle.inputs.atrLength.value()+")":""),this._text+=", PnF ["+e.pnfStyle.inputs.sources.value()+", "+t+", "+this.round(this._series.data().boxSize,4)+", "+e.pnfStyle.inputs.reversalAmount.value()+"]";break;case TradingView.Series.STYLE_HEIKEN_ASHI:this._text+=", "+$.t("Heiken Ashi")}this._bold=!1,this._size="17px"}},inherit(SeriesPriceAxisView,PriceAxisView),SeriesPriceAxisView.prototype.update=function(){this._invalidated=!0},SeriesPriceAxisView.prototype._updateImpl=function(e){if(this._text="",this._visible=!1,(e=this._series.lastValueData())&&(this._visible=!0,this._text=this.D0.properties().scalesProperties.showSeriesLastValue.value()?e.text:"",e.color!=this._background&&(this._background=e.color,this._color=this.color()),this._coordinate=e.coordinate,this._floatCoordinate=e.floatCoordinate,this._textHeight=this._series.priceScale().m_markBuilder.fontHeight(),this._countdown=null,W77.enabled("countdown")&&this._series.properties().showCountdown.value()&&(e=[TradingView.Series.STYLE_BARS,TradingView.Series.STYLE_CANDLES,TradingView.Series.STYLE_LINE,TradingView.Series.STYLE_AREA,TradingView.Series.STYLE_HOLLOW_CANDLES,TradingView.Series.STYLE_HEIKEN_ASHI],!this._series.isDWM()&&-1!=e.indexOf(this._series.properties().style.value())))){var t=1e3*this._series.data().bars().last().value[0];(new Date).getTimezoneOffset();var i=1e3*this._series.serverTimeOffset();e=this._series.interval(),t=Math.round((t.valueOf()+6e4*e-((new Date).valueOf()+i))/1e3),t>0&&(t=Math.min(t,60*e),e="",t>=3600&&(e=""+Math.floor(t/3600)+":"),t%=3600,i=("0"+Math.floor(t/60)).right(2),t=("0"+Math.floor(t%60)).right(2),this._countdown=e+i+":"+t)}},SeriesPriceAxisView.prototype.font=function(){return"11px Arial"},SeriesPriceAxisView.prototype.coordinate=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.coordinate.call(this)},SeriesPriceAxisView.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._cacheFont!=this.font()&&(this._cacheFont=this.font(),this._cache=new TextWidthCache);var e={text:this._text,coordinate:this._coordinate,color:this._color,background:this._background,textHeight:this._textHeight,visible:this._visible,font:this.font(),secondLine:this._countdown};return new PriceAxisViewRenderer(e,this._cache)},SeriesPriceAxisView.prototype.dump=function(){return{text:this._text,coordinate:this._coordinate,color:this._color,background:this._background,textHeight:this._textHeight,visible:this._visible}},SeriesPriceAxisView.prototype.text=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.text.call(this)},inherit(ProjectionSeriesPriceAxisView,SeriesPriceAxisView),ProjectionSeriesPriceAxisView.prototype.lastPrice=function(){return this._series.data().lastProjectionPrice},ProjectionSeriesPriceAxisView.prototype._updateImpl=function(e){if(this._text="",this._visible=!1,!this.D0.timeScale().isEmpty()&&!this._series.priceScale().isEmpty()&&this.lastPrice()&&(e=this.D0.timeScale().visibleBars(),!e.isEmpty())){var t=this._series.data().search(e.lastBar(),SEARCH_NEAREST_LEFT);if(void 0!==t){e=this._series.nearestIndex(e.firstBar(),SEARCH_NEAREST_RIGHT),e=this._series.data().valueAt(e)[CLOSE_PLOT],this._visible=!0,this._series.data().last();var i=this.lastPrice();this._series.priceScale().properties().percentage.value()&&(i=100*(i-e)/e),this._text=this._series.priceScale().formatter().format(i),this._background=this._series.barColorer().barStyle(t.index,!0).barColor,this._coordinate=this._series.priceScale().priceToCoordinate(i),this._textHeight=this._series.priceScale().m_markBuilder.fontHeight()}}},TradingView.StudyConsts={PLOT_TYPE_LINE:"line",PLOT_TYPE_COLORER:"colorer",PLOT_TYPE_BAR_COLORER:"bar_colorer",PLOT_TYPE_BG_COLORER:"bg_colorer",PLOT_TYPE_SHAPES:"shapes",PLOT_TYPE_CHARS:"chars",PLOT_TYPE_ARROWS:"arrows",PLOT_TYPE_DATAOFFSET:"dataoffset",PLOT_LINE:0,PLOT_HISTOGRAM:1,PLOT_CROSS:3,PLOT_AREA:4,PLOT_COLUMNS:5,PLOT_CIRCLES:6,PLOT_LINE_WITH_BREAKS:7,PLOT_AREA_WITH_BREAKS:8,SCALE_RIGHT:0,SCALE_LEFT:1,SCALE_NONE:2},TradingView.StudyPlotShapes={},TradingView.StudyPlotShapes.Data={},TradingView.StudyPlotShapes.registerPlotShape=function(e,t,i,n){if(e in TradingView.StudyPlotShapes.Data)throw Error("Plot shape "+e+" already registered!");TradingView.StudyPlotShapes.Data[e]={id:e,pineName:t,guiName:i,paneRendererClass:n}},TradingView.StudyPlotShapes.SHAPE_CROSS="shape_cross",TradingView.StudyPlotShapes.SHAPE_XCROSS="shape_xcross",TradingView.StudyPlotShapes.SHAPE_CIRCLE="shape_circle",TradingView.StudyPlotShapes.SHAPE_TRIANGLE_UP="shape_triangle_up",TradingView.StudyPlotShapes.SHAPE_TRIANGLE_DOWN="shape_triangle_down",TradingView.StudyPlotShapes.SHAPE_FLAG="shape_flag",TradingView.StudyPlotShapes.SHAPE_ARROW_UP="shape_arrow_up",TradingView.StudyPlotShapes.SHAPE_ARROW_DOWN="shape_arrow_down",TradingView.StudyPlotShapes.SHAPE_SQUARE="shape_square",TradingView.StudyPlotShapes.SHAPE_DIAMOND="shape_diamond",TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_CROSS,"shape.cross","Cross","W63"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_XCROSS,"shape.xcross","X Cross","W74"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_CIRCLE,"shape.circle","Circle","W59"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_TRIANGLE_UP,"shape.triangleup","Triangle Up","W72"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_TRIANGLE_DOWN,"shape.triangledown","Triangle Down","W71"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_FLAG,"shape.flag","Flag","W64"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_ARROW_UP,"shape.arrowup","Arrow Up","PaneRendererArrowUp"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_ARROW_DOWN,"shape.arrowdown","Arrow Down","PaneRendererArrowDown"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_SQUARE,"shape.square","Square","PaneRendererSquare"),TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_DIAMOND,"shape.diamond","Diamond","PaneRendererDiamond"),W37.prototype.update=function(){this._visible=!1;var e=this.D1.lastValueData(this._plotName,!0);e&&(this._visible=!0,this._points=(new List).append(new MathEx.Point(0,e.coordinate)),this._color=e.color)},W37.prototype.renderer=function(){var e={};return e.points=this._points,e.color=this._color,e.linewidth=this.D1.properties().styles[this._plotName].linewidth.value(),e.linestyle=CanvasEx.LINESTYLE_DOTTED,e.hitTestResult=HitTestResult.REGULAR,e.visible=this._visible,new HorzLineRenderer(e)},TradingView.createStudy=function(e,t,i,n){var o="study_"+(n.classId||n.shortId);return TradingView[o]?new TradingView[o](e,t,i,n):new TradingView.Study(e,t,i,n)},TradingView.prepareStudyProperties=function(e,t,i,n){return TradingView.prepareStudyPropertiesWithRoot(e,t,i,n,"study_"+e.id)},TradingView.prepareStudyPropertiesWithRoot=function(e,t,i,n,o){for(t=TradingView.prepareStudyPropsState(e,t,i,n),o=new $52(o,t,!0),o.addExclusion("visible"),o.addExclusion("precision"),o.addExclusion("minTick"),t=0;t<e.inputs.length;++t)i=e.inputs[t],i.isHidden&&(o.addExclusion("inputs."+t.toString()),o.addExclusion("inputs."+i.id));return o},TradingView.prepareStudyPropertiesForLoadChart=function(e,t,i,n,o){return TradingView.prepareStudyPropertiesForLoadChartWithRoot(e,t,i,n,o,"study_"+e.id)},TradingView.prepareStudyPropertiesForLoadChartWithRoot=function(e,t,i,n,o,r){for(i=TradingView.prepareStudyPropsStateForLoadChart(e,t,i,n,o),r=new $52(r,i,!0),r.addExclusion("visible"),r.addExclusion("precision"),r.addExclusion("minTick"),e=t||e,t=0;t<e.inputs.length;++t)i=e.inputs[t],i.isHidden&&(r.addExclusion("inputs."+t.toString()),r.addExclusion("inputs."+i.id));return r},TradingView.prepareStudyPropsState=function(e,t,i,n){if(1>StudyMetaInfo.versionOf(e))throw Error("This function cannot work with metainfo of the old format version. Required format version >= 1");var o=TradingView.clone(defaults("study"));TradingView.preparePlotStyles(o,e);var r=TradingView.clone(defaults("study_"+e.id,n));return e.isTVScript&&e.TVScriptSourceCode!==r.TVScriptSourceCode&&(r=TradingView.clone(factoryDefaults("study_"+e.id,n))),TradingView.merge(o,r),t&&(assert(!(t instanceof Property),"propsState should not be an instance of Property"),TradingView.merge(o,t)),n=TradingView.convertMetainfoInputsArrayToObject(e),r={},A0.mergeInputs(r,n.defaults.inputs),A0.mergeInputsObjPart(r,o.inputs),A0.mergeInputsArrPart(r,n.inputs),o.inputs=r,delete n.inputs,delete n.defaults.inputs,r={},TradingView.merge(r,n.defaults),TradingView.merge(r,factoryDefaults("study_"+n.id)),TradingView.merge(r,o),TradingView.merge(r,n),delete r.defaults,o=r,e=TradingView.calcDefaultColorsOffset(i,e),TradingView.merge(o,TradingView.shiftDefaultColors(o,e)),t&&TradingView.merge(o.styles,t.styles),o},TradingView.prepareStudyPropsStateForLoadChart=function(e,t,i,n,o){var r=StudyMetaInfo.versionOf(e);e.version&&i.version&&e.version!==i.version&&"undefined"!=typeof console&&console.warn("Serialized metaInfo version "+e.version+" is not equal to the saved state version "+i.version);var s=TradingView.clone(defaults("study"));if(0==r){TradingView.merge(s,TradingView.clone(e));var a=TradingView.convertMetainfoInputsArrayToObject(e);TradingView.merge(s.inputs,a.inputs)}else r>=1&&TradingView.merge(s,TradingView.clone(e.defaults));return TradingView.merge(s,factoryDefaults("study_"+e.id)),TradingView.preparePlotStyles(s,e),TradingView.merge(s,i),r>=1&&(TradingView.merge(s,TradingView.clone(e)),delete s.defaults),s=o.updateStudyState(s,e,t),(e=t||e)&&1<=StudyMetaInfo.versionOf(e)&&(e=TradingView.convertMetainfoInputsArrayToObject(e),t={},A0.mergeInputs(t,e.defaults.inputs),A0.mergeInputs(t,s.inputs),A0.mergeInputsArrPart(t,e.inputs),s.inputs=t,delete e.inputs,delete e.defaults.inputs,t={},TradingView.merge(t,e.defaults),TradingView.merge(t,factoryDefaults("study_"+e.id)),TradingView.merge(t,s),TradingView.merge(t,e),delete t.defaults,s=t),n=TradingView.calcDefaultColorsOffset(n,e),TradingView.merge(s,TradingView.shiftDefaultColors(s,n)),s},TradingView.preparePlotStyles=function(e,t){if(t.plots)for(var i=0;i<t.plots.length;i++){var n=t.plots[i].id,o=t.plots[i].type;if(o!==TradingView.StudyConsts.PLOT_TYPE_COLORER){var r=defaultPlotOptions();r.plottype=o,r.title=n,e.styles&&n in e.styles&&TradingView.merge(r,e.styles[n]),e.styles[n]=r}}},TradingView.convertMetainfoInputsArrayToObject=function(e){var t=TradingView.clone(e);if(t.inputs={},e.inputs)for(var i=0;i<e.inputs.length;i++)t.inputs[e.inputs[i].id]=e.inputs[i].defval,t.inputs[i]=e.inputs[i];return t},TradingView.calcDefaultColorsOffset=function(e,t){var i=0;if(e)for(var n=0;n<e.D19().size();n++){var o=e.D19().item(n);o.metaInfo&&o.metaInfo()&&o.metaInfo().id==t.id&&i++}return i},TradingView.shiftDefaultColors=function(e,t){if(!t)return e;for(var i in e.styles)(color=e.styles[i].color)&&(e.styles[i].color=TradingView.shiftColor(color,t));return e},TradingView.shiftColor=function(e,t){e=new RGBColor(e);var i=TradingView.rgbToHsl(e.r,e.g,e.b),n=i[0]+.05*t;return i[0]=n-Math.floor(n),i=TradingView.hslToRgb(i[0],i[1],i[2]),e.r=i[0],e.g=i[1],e.b=i[2],e.toHex()},TradingView.Study=function(e,t,i,n){if(this._titleCache={},this._resolvedSymbols={},this._priceAxisViewsBase=new List,this._paneViews=new List,this._hlinesPriceAsisViews=new List,this._horizlinesPriceAsisViews=new List,PriceDataSource.call(this,e),this.m_data=new PlotList,this._graphics=new A62(n),this._plotOffsets={},this._plotOffsetsMetaInfoOverride={},this.D0=e,this._chartApi=e._chartApi,this._series=i,this._metaInfo=n,this.D2=t,this.D2.listeners().subscribe(this,TradingView.Study.prototype.changeStyles),void 0!=this.D2.inputs&&this.D2.inputs.listeners().subscribe(this,TradingView.Study.prototype.inputsChanged),this._showStudyArgumentsProperty=this.model().properties().paneProperties.legendProperties.showStudyArguments,this._turnaroundCounter=1,this._turnaround="st"+this._turnaroundCounter,this._status="",this._plotFields=[],t=this.metaInfo().plots)for(i=0,n=t.length;n>i;i++)this._plotFields.push(t[i].id);this.clearData(),this._studyModified=!1,this._tagsChanged=new Delegate,this.createViews();var o=this;this._handler=function(e){o.onData(e)},this._createFormatter(),o=this,this.D2.precision.listeners().subscribe(null,function(){o._createFormatter(),o.D0.D20(new A22(A22.FULL_UPDATE))}),this._showStudyArgumentsProperty.listeners().subscribe(null,function(){o._titleCache={}}),this.D2.description.listeners().subscribe(null,function(){o._titleCache={}}),this.D2.shortDescription&&this.D2.shortDescription.listeners().subscribe(null,function(){o._titleCache={}}),W77.enabled("update_study_formatter_on_symbol_resolve")&&e.mainSeries().onSymbolResolved().subscribe(this,TradingView.Study.prototype._createFormatter),this.D2.showInDataWindow.listeners().subscribe(e,W79.prototype.fullUpdate)},inherit(TradingView.Study,PriceDataSource),TradingView.Study.prototype.lastValueData=function(e,t,i){var n={};if(this.D0.timeScale().isEmpty()||null==this.priceScale()||this.priceScale().isEmpty()||this.data().isEmpty())return null;var o=this.D0.timeScale().visibleBars();if(o.isEmpty())return null;var r;for(r=0;r<this.metaInfo().plots.length&&this.metaInfo().plots[r].id!==e;r++);if(!this.properties().visible.value()||!this.properties().styles[e].visible.value())return null;var s=this.offset(e),o=this.nearestIndex(o.lastBar()-s,SEARCH_NEAREST_LEFT);if(void 0===o)return null;if(this.data(),t=t?this.data().last().value:this.data().valueAt(o),!t||!isNumber(t[r+1]))return null;for(var a=this.metaInfo().plots,o=s=null,l=0;l<a.length;l++)this.isSelfColorerPlot(l)&&a[l].target===e&&(s=l,o=this.metaInfo().palettes[a[l].palette],paletterProps=this.properties().palettes[a[l].palette]);if(r=t[r+1],i&&(n.price=r),this.priceScale().properties().percentage.value()){if(i=this.firstValue(!0),!i)return null;r=this.priceScale().priceRange().convertToPercent(r,i)}return n.text=this.priceScale().formatter().format(r),e=this.properties().styles[e].color.value(),s&&t.length>s+1?(i=t[s+1],n.color=void 0!=i?paletterProps.colors[o.valToIndex?o.valToIndex[i]:i].color.value():e):n.color=e,n.floatCoordinate=this.priceScale().priceToCoordinate(r,!0),n.coordinate=Math.round(n.floatCoordinate),n.item=t,n},TradingView.Study.prototype.series=function(){return this._series},TradingView.Study.prototype.model=function(){return this.D0},TradingView.Study.prototype.clearData=function(){this.m_data=new PlotList(this._plotFields),this._graphics=new A62(this._metaInfo),this._plotOffsets={}},TradingView.Study.prototype.onTagsChanged=function(){return this._tagsChanged},TradingView.Study.prototype.properties=function(){return this.D2},TradingView.Study.prototype.state=function(e){var t={type:TradingView.className(this.constructor),id:this.id(),state:this.properties().state(),zorder:this.zorder()};for(this.metaInfo()instanceof StudyMetaInfo?t.metaInfo=this.metaInfo().state():(t.metaInfo=$.extend({},this.metaInfo()),t.metaInfo.id=StudyMetaInfo.parseIdString(t.metaInfo.id+(t.metaInfo.version?"-"+t.metaInfo.version:"")).fullId),e&&(t.data=this.m_data.state(),t.data.symbols=this._resolvedSymbols,t.data.graphics=this._graphics.graphics(),t.data.plotOffsets=this._plotOffsets),this.ownerSource()&&(t.ownerSource=this.ownerSource().id()),e=0;e<this._metaInfo.inputs.length;e++)if("bar_time"==this._metaInfo.inputs[e].type){var i=this._metaInfo.inputs[e].id,n=t.state.inputs[i];0>n&&(n=this._rightOffsetToUnixTime(-n),t.state.inputs[i]=n&&n>=0?n:0)}return t},TradingView.Study.prototype.uniqueId=function(){return this.id()+"|"+JSON.stringify(this.inputsForAlert())},TradingView.Study.prototype.stateForAlert=function(){var e=this.state();e.data||(e.data={}),e.data.completePlotOffsets={};for(var t=0;t<this._metaInfo.plots.length;++t){var i=this._metaInfo.plots[t].id;e.data.completePlotOffsets[i]=this.offset(i)}return e.uniqueId=this.uniqueId(),e},TradingView.Study.prototype.isSavedInStudyTemplates=function(){for(var e=0;e<this._metaInfo.inputs.length;e++)if("bar_time"==this._metaInfo.inputs[e].type)return!1;return!0},TradingView.Study.prototype.restoreData=function(e){this.m_data.restoreState(e),this._resolvedSymbols=e.symbols,this._graphics.setGraphics(e.graphics),this._postProcessGraphics(),this._plotOffsets=e.plotOffsets},TradingView.Study.prototype.restart=function(){this._restarting=!0,W77.enabled("stop_study_on_restart")&&this.stop(),this._clearLoadingTimer(),this.start()},TradingView.Study.prototype._clearLoadingTimer=function(){this.loadingTimer&&(TradingView.logDebug("Study "+this._metaInfo.description+" loading took "+((new Date).getTime()-this._loadingStartTime)+" ms"),clearTimeout(this.loadingTimer),this.loadingTimer=null)},TradingView.Study.prototype.stop=function(){this._clearLoadingTimer(),this._chartApi&&this._chartApi.connected()&&this._studyId&&this._chartApi.removeStudy(this._studyId,this._handler),W77.enabled("update_study_formatter_on_symbol_resolve")&&this.D0.mainSeries().onSymbolResolved().unsubscribe(this,TradingView.Study.prototype._createFormatter),this._studyId=null,this.clearData(),this._unsubscribeExtendedHours(),this.recalculate()},TradingView.Study.prototype._resolveSymbol=function(e,t){function i(t){n._chartApi.resolveSymbol(n._makeNextSymbolId(),t,function(t){switch(t.method){case"symbol_resolved":n._resolvedSymbols[e]=t.params[1],0!=n._studyId&&n.stop(),n.start();break;case"symbol_error":if("permission denied"===t.params[1]&&t.params[2])switch(t.params[2]){
case TradingView.Series.PD_REASON_EXTENDED_HOURS:break;case TradingView.Series.PD_REASON_SYMBOL:if(t.params[3])return i(t.params[3]);break;default:return i(t.params[2])}n._status=$.t("Invalid Symbol"),n.stop(),n.D0.updateSource(n)}})}var n=this;i(e)},TradingView.Study.prototype._allSymbolsAreResolved=function(){for(var e=!0,t=0;t<this._metaInfo.inputs.length;t++)if("symbol"==this._metaInfo.inputs[t].type){var i=this._metaInfo.inputs[t].id,n=this.D2.inputs[i].value();this._resolvedSymbols[n]||(e=!1,this._resolveSymbol(n,this.D2.inputs[i]))}return e},TradingView.Study.prototype._allInputsAreValid=function(){for(var e=0;e<this._metaInfo.inputs.length;e++)if("bar_time"==this._metaInfo.inputs[e].type){var t=this.D2.inputs[this._metaInfo.inputs[e].id].value();if(void 0==t||null==t)return!1}return!0},TradingView.Study.prototype.sourceId=function(){return this._studyId},TradingView.Study.prototype.isStarted=function(){return!!this._studyId},TradingView.Study.prototype.start=function(){if(this._chartApi&&this._chartApi.connected()&&this._allSymbolsAreResolved()&&(!this.isStarted()||this._restarting)&&(this._studyId=TradingView.Study.makeNextStudyId(),this._restarting=!1,this._allInputsAreValid())){this._inputs=this.inputs();var e=this._metaInfo.id;if("MA"===this._metaInfo.id){switch(this._inputs[2]){case"exp":e="MAExp@tv-basicstudies";break;case"simple":e="MASimple@tv-basicstudies";break;case"weighted":e="MAWeighted@tv-basicstudies";break;case"volume weighted":e="MAVolumeWeighted@tv-basicstudies"}inputs=[inputs[0],inputs[1]]}e+="-"+(this._metaInfo.version||"1!"),e=StudyMetaInfo.cutDollarHash(e),"Script@tv-scripting-1"===e&&(e+="!"),this._chartApi.createStudy(this._studyId,this._turnaround,this._series._seriesId,e,this._inputs,this._handler),this._subscribeExtendedHours()}},TradingView.Study._nextSymbolId=0,TradingView.Study.prototype._makeNextSymbolId=function(){return TradingView.Study._nextSymbolId++,"ss_"+TradingView.Study._nextSymbolId},TradingView.Study._nextStudyId=0,TradingView.Study.makeNextStudyId=function(){return TradingView.Study._nextStudyId++,"st"+TradingView.Study._nextStudyId},TradingView.Study.prototype._rightOffsetToUnixTime=function(e){var t=null;return this._series.bars().size()>=e&&(t=this._series.bars()._valueAt(this._series.bars().lastIndex()-e)[TIME_PLOT]),t},TradingView.Study.prototype.getSymbolString=function(e){return this._series&&this._series.extendedHours.value()?"="+JSON.stringify({symbol:e,session:"extended"}):e},TradingView.Study.prototype.inputsForGUI=function(e){return this.inputs({symbolsForDisplay:!0,skipHiddenInputs:!0,skipFakeInputs:!1})},TradingView.Study.prototype.inputsForAlert=function(){var e=this.offset(),t=this.inputs({symbolsForDisplay:!0,symbolsForChartApi:!0,skipHiddenInputs:!1,skipFakeInputs:!1});return e&&t.push(e),t},TradingView.Study.prototype.inputs=function(e){var t={symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!1,skipFakeInputs:!0};return TradingView.merge(t,e),this._buildInputs(t)},TradingView.Study.prototype._buildInputs=function(e){assert(!!e,"options not set");try{var t=this._prepareInputs(e)}catch(i){console.warn("Failed to prepare study inputs: "+i),t={}}if(!e.symbolsForDisplay&&this._metaInfo.isTVScript)return 0==Object.keys(t).length||this._metaInfo.isTVScriptStub?[this._metaInfo.defaults.inputs.text]:[A57.patchILTemplate(this._metaInfo.defaults.inputs.text,this._metaInfo,t)];if(e.asObject){var n={};Object.keys(t).forEach(function(e){null!=t[e]&&(n[e]=t[e])}),n=$.isEmptyObject(n)?null:n}else n=[],Object.keys(t).forEach(function(e){null!=t[e]&&n.push(t[e])});return n},TradingView.Study.prototype._prepareInputs=function(e){assert(!!e,"options not set");for(var t={},i=0;i<this._metaInfo.inputs.length;i++){var n=this._metaInfo.inputs[i];if((!n.isFake||!e.skipFakeInputs||this._metaInfo.isTVScript)&&(!n.isHidden||!e.skipHiddenInputs)){var o=this._prepareInput(n,e);t[n.id]=o}}return t},TradingView.Study.prototype._prepareInput=function(e,t){var i=e.id;if("symbol"==e.type)return i=this.D2.inputs[i].value(),t&&t.symbolsForDisplay?this._resolvedSymbols&&this._resolvedSymbols[i]&&(i=this._resolvedSymbols[i].name+", "+this._resolvedSymbols[i].exchange):(this._resolvedSymbols&&this._resolvedSymbols[i]&&(i=this._resolvedSymbols[i],i=i.ticker||i.full_name),t&&t.symbolsForChartApi&&(i=this.getSymbolString(i))),i;if("bar_time"==e.type){if(i=this.D2.inputs[i].value(),0>i)var n=this._rightOffsetToUnixTime(-i),i=n&&n>=0?n:i;return i}return this.D2.inputs[i].value()},TradingView.Study.prototype._changeInputs=function(e){this._studyId&&this._chartApi.connected()?(this._turnaround="st"+ ++this._turnaroundCounter,this._allInputsAreValid()?this._allSymbolsAreResolved()&&(this._studyModified=!0,this._chartApi.modifyStudy(this._studyId,this._turnaround,e,this._handler)):this.stop()):(this.stop(),this.start()),this._inputs=e,this._tagsChanged.fire(),this._titleCache={}},TradingView.Study.prototype.changeStyles=function(){if(this._inputs){for(var e=this.inputs(),t=0;t<e.length;t++)if(e[t]!==this._inputs[t]){this._changeInputs(e);break}}else this.restart();this.createViews(),this.recalculate(!0),this.updateAllViews()},TradingView.Study.prototype.inputsChanged=function(){this._metaInfo.isTVScript&&(void 0!=this._pinePatchPropsTimerId&&clearTimeout(this._pinePatchPropsTimerId),this._pinePatchPropsTimerId=setTimeout(this._pinePatchProps.bind(this),250))},TradingView.Study.prototype._pinePatchProps=function(){var e=this._prepareInputs({symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!1,skipFakeInputs:!0});A57.patchPropertiesAsync(this.D2,this._metaInfo,e).done(function(){this.createViews(),this.recalculate(!0),this.updateAllViews()}.bind(this)).fail(function(e){console.error(e)}),this._pinePatchPropsTimerId=null},TradingView.Study.prototype.createViews=function(){if(this._priceAxisViewsBase=new List,this._paneViews=new List,this.metaInfo().plots)for(var e=0;e<this.metaInfo().plots.length;e++)if(!this.isSelfColorerPlot(e)&&!this.isBarColorerPlot(e)){var t=this.metaInfo().plots[e].id;this.isBgColorerPlot(e)?this._paneViews.append(new W30(this,this._series,this.D0,t)):this.isPlotShapesPlot(e)?this._paneViews.append(new W36(this,this._series,this.D0,t)):this.isPlotCharsPlot(e)?this._paneViews.append(new W35(this,this._series,this.D0,t)):this.isPlotArrowsPlot(e)?this._paneViews.append(new W34(this,this._series,this.D0,t)):(this._priceAxisViewsBase.append(new W51(this,this.D0,t)),this._paneViews.append(new W33(this,this._series,this.D0,t)),this.properties().styles[t].trackPrice.value()&&this._paneViews.append(new W37(this,this._series,this.D0,t)))}if(this.D2.bands)for(e=0;e<this.D2.bands.childCount();e++)this.D2.bands[e].visible.value()&&this._paneViews.append(new TradingView.$58(this.D2.bands[e],this));this.D2.bandsBackground&&this._paneViews.append(new TradingView.$57(this)),e=[],this.metaInfo().graphics&&(e=Object.keys(this.metaInfo().graphics),e.sort(function(e,t){return TradingView.Study.graphicsZOrderPriority(e)-TradingView.Study.graphicsZOrderPriority(t)}));for(var i in e){var t=e[i],n="_paneView"+t,o="StudyPaneView_"+t;TradingView.Study[o]&&(this[n]=new TradingView.Study[o](this,this.D0),this._paneViews.append(this[n])),this._dataWindowView||"hhists"!==t||(this._dataWindowView=new StudyHHistsDataWindowView(this,this.D0))}if(this.D2.areaBackground&&this._paneViews.append(new TradingView.$55(this)),this.D2.filledAreas&&this._metaInfo.filledAreas)for(e=0;e<this._metaInfo.filledAreas.length;++e)i=this._metaInfo.filledAreas[e],t=this.D2.filledAreasStyle[i.id],i.type===StudyMetaInfo.FilledArea.TYPE_PLOTS?this._paneViews.append(new TradingView.W2(this,i,t)):i.type===StudyMetaInfo.FilledArea.TYPE_HLINES?this._paneViews.append(new TradingView.$84(this,i,t)):console.warn("Unsupported filledArea type: "+i.type);this._dataWindowView||(this._dataWindowView=new StudyDataWindowView(this,this.D0)),this._statusView||(this._statusView=new StudyStatusView(this,this.D0.properties())),this._priceAxisViews=(new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)},TradingView.Study.prototype.recalculate=function(e){var t=this.D0.paneForSource(this);this.D0.recalculatePane(t,e),this.D0.updateSource(this)},TradingView.Study.prototype.data=function(){return this.m_data},TradingView.Study.prototype.metaInfo=function(){return this._metaInfo},TradingView.Study.prototype.status=function(){return this._status},TradingView.Study.prototype.title=function(e){if(this._titleCache[e])return this._titleCache[e];var t;t=e?this._metaInfo.shortDescription||this.D2.shortDescription&&this.D2.shortDescription.value()||"Study":this._metaInfo.description||this.D2.description&&this.D2.description.value()||"Study",t=$.t(t);var i=this._showStudyArgumentsProperty.value(),n=this.inputsForGUI()||[];return i&&0<n.length&&(t+=" ("+n.join(", ")+")"),this._titleCache[e]=t},TradingView.Study.prototype.graphics=function(){return this._graphics.graphics()},TradingView.Study.prototype._checkTurnaround=function(e){return e===this._turnaround||e===this.D0.mainSeries()._turnaround||e===this.D0.mainSeries()._turnaround+"_"+this._turnaround},TradingView.Study.prototype.onData=function(e){var t=this;switch(e.method){case"study_loading":this._status=$.t("loading..."),this._failed=!1,this._statusView.update(),this.D0.updateSource(this),this._clearLoadingTimer(),-1==["Plot splits","Plot earnings","Plot dividends"].indexOf(t._metaInfo.description)&&(t._loadingStartTime=(new Date).getTime(),t.loadingTimer=setTimeout(function(){var e={chartSession:t._chartApi._sessionid,studyName:t._metaInfo.description,arguments:t.inputs()};A72.sendReport("study_loading",e)},15e3));break;case"study_error":this._clearLoadingTimer(),this._failed=!0,this.clearData(),this._status=e.params[2]?$.t(e.params[2].split(":",2)[0]):"",-1==["Sessions"].indexOf(t._metaInfo.description)&&A72.sendReport("study_error",{chartSession:t._chartApi._sessionid,studyName:t._metaInfo.description,arguments:t.inputs()}),this._statusView.update(),this.D0.updateSource(this);break;case"study_completed":if(!this._checkTurnaround(e.params[1]))break;this._clearLoadingTimer(),this._status="",this._statusView.update(),e=this.D0.paneForSource(this),this.D0.recalculatePane(e,!0),this._updateSources(),this.D0.D20(new A22(A22.FULL_UPDATE));break;case"data_update":if(!this._checkTurnaround(e.params.turnaround))break;t._clearLoadingTimer(),this._studyModified&&(this.clearData(),this._studyModified=!1);var i=0==this.m_data.size();assert(!!e.params.nonseries,"data.params.nonseries is missing"),e.params.nonseries.d=""!==e.params.nonseries.d?JSON.parse(e.params.nonseries.d):"",this._processPlotOffsets(e.params),this.transformData(e.params.plots),this._mergeData(e.params.plots),this._graphics.process(e.params.nonseries),this._postProcessGraphics(),e=this.D0.paneForSource(this),this.D0.recalculatePane(e,i),this._updateSources()}},TradingView.Study.prototype.transformData=function(e){},TradingView.Study.prototype._updateSources=function(){this.D0.updateSource(this),this.hasBarColorer()&&this.D0.updateSource(this.D0.mainSeries())},TradingView.Study.prototype._processPlotOffsets=function(e){e=e.nonseries.d,e&&e.indexes_replace||(this._plotOffsets=e&&e.offsets?e.offsets:{})},TradingView.Study.prototype._mergeData=function(e){this.m_data.merge(e)},TradingView.Study.prototype._postProcessGraphics=function(){var e=this,t=function(t){var i,n=e._graphics.graphics(),o=new List;if(n&&n[t])for(var r=n[t],n=0;n<r.length;n+=1)if(r[n].data)for(i=0;i<r[n].data.length;i+=1)o.append(new TradingView.Study.StudyPriceAxisView_hlines(e,e.D0,r[n].data[i],r[n].styleId,t));return o};this._hlinesPriceAsisViews=t("hlines"),this._horizlinesPriceAsisViews=t("horizlines"),this._priceAxisViews=(new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)},TradingView.Study.prototype.firstValue=function(e){if(this._metaInfo.is_price_study&&"Compare@tv-basicstudies"!==this._metaInfo.id)return this._series.data().firstValue();var t=this.D0.timeScale().visibleBars(),i=t.firstBar(),t=t.lastBar();if(0===this.m_data.size())return null;var n,o=this;return this.m_data.range(i,t).each(function(t,i){for(var r=1;r<i.length;++r)if(!o.isSelfColorerPlot(r-1)){var s=o._metaInfo.plots[r-1].id,s=o.properties().styles[s];if(s.visible&&s.visible.value()&&!(e&&1e-10>Math.abs(i[r])||void 0===i[r]||null===i[r]||n))return n=i[r],!0}}),n},TradingView.Study.prototype.offset=function(e){var t=0;return this._plotOffsets&&void 0!=this._plotOffsets[e]&&(t+=this._plotOffsets[e]),void 0!=this._plotOffsetsMetaInfoOverride[e]?t+=this._plotOffsetsMetaInfoOverride[e]:this.properties().offsets&&void 0!=this.properties().offsets[e]&&(t+=this.properties().offsets[e].val.value()),this.properties().offset&&(t+=this.properties().offset.val.value()),t},TradingView.Study.prototype.priceRange=function(e,t){if(isInteger(e)){if(isInteger(t)){if(0===this.m_data.size())return null;var i=null;if(0==this._metaInfo.plots.length)return null;for(var n=[],o=0;o<this._metaInfo.plots.length;++o){var r=this._metaInfo.plots[o].id,s=this.properties().styles[r],a=this.isLinePlot(o);if((a=a||(this.isPlotShapesPlot(o)||this.isPlotCharsPlot(o))&&s.location.value()==CanvasEx.MARKLOC_ABSOLUTE)&&s.visible.value()){if(s={index:o+1,offset:this.offset(r)},a=this.properties().styles[r].plottype.value(),!this.properties().skipHistogramBaseOnAutoScale&&0<=[TradingView.StudyConsts.PLOT_HISTOGRAM,TradingView.StudyConsts.PLOT_COLUMNS,TradingView.StudyConsts.PLOT_AREA].indexOf(a)){if(r=this.properties().styles[r].histogramBase.value(),!isNumber(r))continue;s.baseValue=r}n.push(s)}}if(n=this.m_data.minMaxOnRange(e,t,n),null!==n.min&&(i=new PriceRange(n.min,n.max)),this._metaInfo.bands)for(o=0;o<this._metaInfo.bands.length;o++)this.properties().bands[o].visible.value()&&(r=this.properties().bands[o].value.value(),isNumber(r)&&(i?i.apply(r,r):i=PriceRange(r,r)));return i&&i.minValue()===i.maxValue()&&(n=.005*i.minValue(),i=new PriceRange(i.minValue()-n,i.maxValue()+n)),this.priceScale().properties().percentage.value()&&i?(n=this.firstValue())?i.convertToPercents(n):null:this.priceScale().isLog()&&i?new PriceRange(this.priceScale().priceToLogical(i.minValue()),this.priceScale().priceToLogical(i.maxValue())):i}TradingView.logDebug("Study.priceRange: incorrect endBar")}else TradingView.logDebug("Study.priceRange: incorrect startBar")},TradingView.Study.prototype.paneViews=function(e){return this.properties().visible.value()?this._paneViews:null},TradingView.Study.prototype.dataWindowView=function(){return this._dataWindowView},TradingView.Study.prototype.statusView=function(){return this._statusView},TradingView.Study.prototype.priceAxisViews=function(e,t){return this.D0.paneForSource(this)===e&&t===this.priceScale()&&(this.D0.properties().scalesProperties.showStudyLastValue.value()||this.properties().oldShowLastValue&&this.properties().oldShowLastValue.value())?this._priceAxisViews:null},TradingView.Study.prototype.isLinePlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_LINE},TradingView.Study.prototype.isSelfColorerPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_COLORER},TradingView.Study.prototype.isBarColorerPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_BAR_COLORER},TradingView.Study.prototype.isBgColorerPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_BG_COLORER},TradingView.Study.prototype.isPlotShapesPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_SHAPES},TradingView.Study.prototype.isPlotCharsPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_CHARS},TradingView.Study.prototype.isPlotArrowsPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_ARROWS},TradingView.Study.prototype.isDataOffsetPlot=function(e){return this._metaInfo.plots[e].type==TradingView.StudyConsts.PLOT_TYPE_DATAOFFSET},TradingView.Study.prototype.hasBarColorer=function(){for(var e=0;e<this._metaInfo.plots.length;++e)if(this.isBarColorerPlot(e))return!0;return!1},TradingView.Study.prototype.barColorer=function(){for(var e=null,t=0;t<this._metaInfo.plots.length;++t)if(this.isBarColorerPlot(t)){var i=new StudyBarColorer(this,t);null===e?e=i:e.pushBackBarColorer(i)}if(null===e)throw Error("Cannot create BarColorer: study doesn't have a bar_colorer plot!");return e},TradingView.Study.prototype.base=function(){return"Volume"===this._metaInfo.id?1:0},TradingView.Study.prototype._createFormatter=function(){var e;"default"==this.properties().precision.value()?this.metaInfo().defaults&&(e=parseInt(this.metaInfo().defaults.precision)):e=parseInt(this.properties().precision.value()),isFinite(e)||(e=-1!==["Volume@tv-basicstudies","VbPVisible@tv-volumebyprice","VbPSessions@tv-volumebyprice"].indexOf(this._metaInfo.id)?0:1e4);var t=this.series().symbolInfo();0==e?(e=0,t&&(e=t.volume_precision?t.volume_precision:t.has_fractional_volume?2:0),this._formatter=new VolumeFormatter(e)):this._formatter=new PriceFormatter(Math.pow(10,e)),this.priceScale()&&this.priceScale().updateFormatter()},TradingView.Study.prototype.formatter=function(){return this._formatter},TradingView.Study.prototype.nearestIndex=function(e,t){if(isInteger(e)){var i=this._series.data().bars().search(e,t);return i?i.index:void 0}TradingView.logDebug("Study.nearestIndex: incorrect logicalPoint")},TradingView.Study.prototype.updateAllViews=function(){for(var e=0;e<this._paneViews.size();e++)this._paneViews.item(e).update();for(this._dataWindowView.update(),this._statusView.update(),e=0;e<this._priceAxisViews.size();e++)this._priceAxisViews.item(e).update()},TradingView.Study.prototype.tags=function(){var e=[];e.push(this._metaInfo.id);var t=this.inputsForGUI();if(0<t.length){for(var i=this._metaInfo.id,n=0;n<t.length;n++)i+="_"+t[n];e.push(i)}return e},TradingView.Study.isPointsBasedStudy=function(e){switch(e){case"VbPFixed@tv-volumebyprice":case"mtp_tsanalysis@mtp-mtpredictor":case"mtp_riskreward@mtp-mtpredictor":case"mtp_decisionpoint@mtp-mtpredictor":case"mtp_ew_main@mtp-mtpredictor":case"mtp_ew_major@mtp-mtpredictor":case"mtp_ew_minor@mtp-mtpredictor":case"mtp_wpt_down1ora@mtp-mtpredictor":case"mtp_wpt_down2orb@mtp-mtpredictor":case"mtp_wpt_down3@mtp-mtpredictor":case"mtp_wpt_down4@mtp-mtpredictor":case"mtp_wpt_down5@mtp-mtpredictor":case"mtp_wpt_downc@mtp-mtpredictor":case"mtp_wpt_up1ora@mtp-mtpredictor":case"mtp_wpt_up2orb@mtp-mtpredictor":case"mtp_wpt_up3@mtp-mtpredictor":case"mtp_wpt_up4@mtp-mtpredictor":case"mtp_wpt_up5@mtp-mtpredictor":case"mtp_wpt_upc@mtp-mtpredictor":return!0;default:return!1}},TradingView.Study.lineToolNameForPointsBasedStudy=function(e){switch(e){case"VbPFixed@tv-volumebyprice":return"LineToolVbPFixed";case"RegressionTrend@tv-basicstudies":return"LineToolRegressionTrend";case"mtp_tsanalysis@mtp-mtpredictor":return"LineStudyMtpAnalysis";case"mtp_riskreward@mtp-mtpredictor":return"LineStudyMtpRiskReward";case"mtp_decisionpoint@mtp-mtpredictor":return"LineStudyMtpDecisionPoint";case"mtp_ew_main@mtp-mtpredictor":return"LineStudyMtpElliotWaveMain";case"mtp_ew_major@mtp-mtpredictor":return"LineStudyMtpElliotWaveMajor";case"mtp_ew_minor@mtp-mtpredictor":return"LineStudyMtpElliotWaveMinor";case"mtp_wpt_down1ora@mtp-mtpredictor":return"LineStudyMtpDownWave1OrA";case"mtp_wpt_down2orb@mtp-mtpredictor":return"LineStudyMtpDownWave2OrB";case"mtp_wpt_down3@mtp-mtpredictor":return"LineStudyMtpDownWave3";case"mtp_wpt_down4@mtp-mtpredictor":return"LineStudyMtpDownWave4";case"mtp_wpt_down5@mtp-mtpredictor":return"LineStudyMtpDownWave5";case"mtp_wpt_downc@mtp-mtpredictor":return"LineStudyMtpDownWaveC";case"mtp_wpt_up1ora@mtp-mtpredictor":return"LineStudyMtpUpWave1OrA";case"mtp_wpt_up2orb@mtp-mtpredictor":return"LineStudyMtpUpWave2OrB";case"mtp_wpt_up3@mtp-mtpredictor":return"LineStudyMtpUpWave3";case"mtp_wpt_up4@mtp-mtpredictor":return"LineStudyMtpUpWave4";case"mtp_wpt_up5@mtp-mtpredictor":return"LineStudyMtpUpWave5";case"mtp_wpt_upc@mtp-mtpredictor":return"LineStudyMtpUpWaveC";default:throw Error("There is no line tool name, associated with study id "+e)}},TradingView.Study.isStudyLineTool=function(e){return e=TradingView[e],"function"==typeof e&&e.prototype instanceof A63},TradingView.Study.prototype.onExtendedHoursChanged=function(){this.restart()},TradingView.Study.prototype.hasSymbolInputs=function(){for(var e=this._metaInfo.inputs.length;e--;)if("symbol"===this._metaInfo.inputs[e].type)return!0;return!1},TradingView.Study.prototype._subscribeExtendedHours=function(){!this._isSubscribedToExtendedHours&&this.hasSymbolInputs()&&(this._series.extendedHours.listeners().subscribe(this,this.onExtendedHoursChanged),this._isSubscribedToExtendedHours=!0)},TradingView.Study.prototype._unsubscribeExtendedHours=function(){this._isSubscribedToExtendedHours&&(this._series.extendedHours.listeners().unsubscribe(this,this.onExtendedHoursChanged),delete this._isSubscribedToExtendedHours)},TradingView.Study.prototype.removeByRemoveAllStudies=function(){return!0},TradingView.StudyStub=function(e,t,i){PriceDataSource.call(this,e),this._origState=t,this._title=i,this.D2=new Property({visible:!0}),this._statusView=new StatusView(e.properties()),this._status=$.t("compiling..."),this._statusView.setText(this._title+" "+this._status),this._formatter=new PriceFormatter(Math.pow(10,2))},inherit(TradingView.StudyStub,PriceDataSource),TradingView.StudyStub.prototype.properties=function(){return this.D2},TradingView.StudyStub.prototype.statusView=function(){return this._statusView},TradingView.StudyStub.prototype.state=function(e){return this._origState},TradingView.StudyStub.prototype.setStatus=function(e){this._status=e,this._statusView.setText(this._title+" "+this._status)},TradingView.StudyStub.prototype.formatter=function(){return this._formatter},TradingView.StudyStub.prototype.title=function(){return this._title},A62=function(e){this._graphics=A62.emptyGraphics(),assert(!!e,"Study metaInfo is absent!"),this._metaInfo=e},A62.emptyGraphics=function(){return{indexes:[]}},A62.prototype.isEmpty=function(){var e=1<Object.keys(this._graphics).length;return 0==this._graphics.indexes.length&&!e},A62.prototype.graphics=function(){return this._graphics},A62.prototype.setGraphics=function(e){this._graphics=e,this._postProcessGraphicsData()},A62.prototype.process=function(e){""!==e.d&&(TradingView.logDebug("nonseries.d is "+JSON.stringify(e.d)),e.d.indexes_replace?this.replaceIndexes(e):e.d.graphicsCmds&&(this.processEraseCmds(e.d.graphicsCmds.erase),this.processCreateCmds(e.d.graphicsCmds.create,e.indexes)))},A62.prototype.replaceIndexes=function(e){""!==e.d&&(assert(!!e.d.indexes_replace),this._graphics.indexes=e.indexes,TradingView.logDebug("timescale has been replaced with a new one (replaceIndexes)"))},A62.prototype.processEraseCmds=function(e){if(e){assert(!!this._graphics,"_graphics object doesn't exist in the study!"),assert(!!this._graphics.indexes,"_graphics.indexes array doesn't exist in the study!");for(var t=0;t<e.length;++t){var i=e[t];if("all"===i.action)this._graphics=A62.emptyGraphics(),TradingView.logDebug("erased ALL the graphics");else if("one"===i.action)for(var n in this._graphics[i.type]){var o=this._graphics[i.type][n],r=A62._findGraphicsObjIndexById(o.data,i.id);r>=0?(o.data.splice(r,1),TradingView.logDebug("erased one the graphics obj with id="+i.id)):TradingView.logDebug("cannot erase obj with id="+i.id+" because it doesn't exist")}else Error("Unknown graphics command "+i.action)}}},A62._findGraphicsObjIndexById=function(e,t){for(var i=0;i<e.length;++i)if(e[i].id===t)return i;return-1},A62.prototype.processCreateCmds=function(e,t){if(e){assert(!!t,"indexes are missing in the study nonseries response!"),assert(!!this._graphics,"_graphics object doesn't exist in the study!"),assert(!!this._graphics.indexes,"_graphics.indexes array doesn't exist in the study!");for(var i in e){assert(i in this._metaInfo.graphics,"There is a '"+i+"' in study response, but it doesn't present in metaInfo!");for(var n=0;n<e[i].length;++n){var o=e[i][n],r=o.styleId;assert(r in this._metaInfo.graphics[i]),this._graphics[i]||(this._graphics[i]=[]);for(var s=null,a=0;a<this._graphics[i].length;++a)if(this._graphics[i][a].styleId===r){s=this._graphics[i][a];break}null===s&&(s={styleId:r,data:[]},this._graphics[i].push(s)),s.data=s.data.concat(o.data),TradingView.logDebug("created "+o.data.length+" graphics objects")}}"nochange"===t?TradingView.logDebug("timescale hasn't changed"):(assert(isArray(t)),this._graphics.indexes=t,TradingView.logDebug("timescale has been replaced with a new one")),this._postProcessGraphicsData()}},A62.prototype._postProcessGraphicsData=function(){if(this._graphics)for(var e in this._graphics.hhists){var t=this._graphics.hhists[e];A62._sortHHistItemsByPrice(t.data),t.dataObj=A62._splitHHistItemsBySession(t.data,this._graphics.indexes)}},A62._sortHHistItemsByPrice=function(e){e.sort(function(e,t){return e.priceLow-t.priceLow})},A62._splitHHistItemsBySession=function(e,t){for(var i={},n=0;n<e.length;++n){var o=e[n],r=t[o.firstBarTime];void 0===r?console.error("Cannot find index "+o.firstBarTime+" in study timescale indexes"):(r in i||(i[r]=[]),i[r].push(o))}return i},A64=function(e){this._studyId=e,this._maxFromVers=this._maxToVers="0",this._migrs=[]},A64.prototype.addMigration=function(e,t,i){A0.isGreater(e,this._maxFromVers)&&(this._maxFromVers=e),A0.isGreater(t,this._maxToVers)&&(this._maxToVers=t),this._migrs.push({fromVers:e,toVers:t,rules:i})},A64.prototype.updateInputs=function(e,t){if(!t)return t;var i=TradingView.clone(t);TradingView.logDebug("Applying migrations to study: "+this._studyId+" from vers: "+e+" to vers: "+this._maxToVers);for(var n=e;A0.isLess(n,this._maxToVers);){var o=this._findMigration(n),i=this._applyMigration(i,o);if(!A0.isLess(n,o.toVers))throw Error("Problems in study migration process... Possible infinite cycle has been detected and stopped.");n=o.toVers,TradingView.logDebug("Applied migration rule to study: "+this._studyId+" from vers: "+o.fromVers+" to vers: "+o.toVers)}return i},A64.prototype._findMigration=function(e){for(var t=-1,i=this._maxFromVers,n=0;n<this._migrs.length;n++){var o=this._migrs[n];!A0.isLess(o.fromVers,e)&&A0.isLessOrEqual(o.fromVers,i)&&(i=o.fromVers,t=n)}if(0>t)throw Error("Could not find matching migration for study: "+this._studyId+" vers: "+e);return this._migrs[t]},A64.prototype._applyMigration=function(e,t){for(var i=e,n=0;n<t.rules.length;n++)var o=t.rules[n],i=this._getApplyRuleFun(o.type)(i,o);return i},A64.prototype._getApplyRuleFun=function(e){if("inputRemoved"==e)return A64._applyInputRemovedRule;if("inputChangedType"==e)return A64._applyInputChangedTypeRule;throw Error("Unknown migration rule type: "+mr.type)},A64._applyInputRemovedRule=function(e,t){if(!(t.inputId in e))return e;var i=A0.findInputKeyById(e,t.inputId);if(!i)return e;delete e[i],delete e[t.inputId];var n,i={},o=0;for(n in e)isNumber(parseInt(n,10))?(i[o]=e[n],o++):i[n]=e[n];return i},A64._applyInputChangedTypeRule=function(e,t){var i=A0.getInputKeyById(e,t.inputId);if("resetToDefVal"!=t.action)throw Error("Unknown action "+t.action+" for rule with type "+t.type);return e[t.inputId]=t.defVal,e[i].defval=t.defVal,e[i].type=t.inputType,e},A0=function(e,t){if(!e)throw Error("No studies metainfo");if(this._studiesMetainfo=e,!t)throw Error("No studies migrations");this._studiesMigrations=t,this._migrations={};for(var i=0;i<this._studiesMigrations.size();i++)for(var n=this._studiesMigrations.item(i),o=0;o<n.length;o++)for(var r=n[o],s=r.versFrom,a=r.versTo,l=0;l<r.studyMigrations.length;l++){var d=r.studyMigrations[l],h=d.studyId;if(0==d.rules.length)throw Error("Study Migration should have at least one convertion rule");var c=h in this._migrations?this._migrations[h]:new A64(h);c.addMigration(s,a,d.rules),this._migrations[h]=c}this._clientMigrations=[function(e,t){if(this._studiesMetainfo.isEmpty()||!e.isTVScript||22<=e.version)return t;for(var i={},n=0,o=0;;){var r=t[o];if(void 0==r)break;var s=t[r.id];r.isFake&&(r.id="in_"+n++),i[o]=r,i[r.id]=s,o++}return i}]},A0.prototype.updateMetaInfo=function(e){if(!e)return e;assert(!e.isTVScript,"This method should update only built-in java indicators metaInfo. For Pine indicators use updateMetaInfoAsync");for(var t=null,i=this._studiesMetainfo,n=0;n<i.size();n++)if(i.item(n).id===e.id){t=i.item(n);break}return TradingView.clone(t)},A0.prototype.updateMetaInfoAsync=function(e,t){var i=$.Deferred(),n=i.promise();if(!e)return i.reject("No old metaInfo was given"),n;if(t)return i.resolve(null),n;if(e.isTVScript&&e.TVScriptSourceCode)if(StudyMetaInfo.versionOf(e)!=StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION){var o=this._studiesMetainfo.isEmpty()?"1":A57.tvScriptingPkgVersion(this._studiesMetainfo),r=e.scriptIdPart||TVScript.createScriptIdPart();A57.translateScriptAsync(e.TVScriptSourceCode,null,r,o).done(function(e){e=StudyMetaInfo.addOrReplaceStudyMetaInfo(this._studiesMetainfo,e),i.resolve(e)}.bind(this)).fail(function(t){console.warn("Could not compile Pine script (skipping): "+e.description+" "+t),i.reject(t)})}else i.resolve(e);else{for(var o=null,r=this._studiesMetainfo,s=0;s<r.size();s++)if(r.item(s).id===e.id){o=r.item(s);break}o?i.resolve(TradingView.clone(o)):i.resolve(null)}return n},A0.prototype.updateStudyState=function(e,t,i){if(e){e=TradingView.clone(e);var n=t.id;if(n in this._migrations){var o=this._migrations[n].updateInputs(t.version,e.inputs);e.inputs=o}for(n=0;n<this._clientMigrations.length;++n)o=this._clientMigrations[n].call(this,t,e.inputs),Object.keys(o).length==Object.keys(e.inputs).length?e.inputs=o:console.warn("StudyVersioning._clientMigrations application returned bad result. Skipping it...")}if(i&&e&&(n={},A0.mergeInputs(n,i.inputs),A0.mergeInputs(n,i.defaults.inputs),A0.mergeInputs(n,e.inputs),e.inputs=n,n=StudyMetaInfo.versionOf(t),t.isTVScript&&t.TVScriptSourceCode&&n>=12&&26>=n)){for(o={},n=0;n<t.plots.length;++n)o[t.plots[n].id]=i.plots[n].id;for(i=Object.keys(e.styles),n=0;n<i.length;++n){t=i[n];var r=e.styles[t];delete e.styles[t],e.styles[o[t]]=r}for(i=Object.keys(e.plots),n=0;n<i.length;++n)r=i[n],t=e.plots[r].id,e.plots[r].id=o[t]}return e},A0.prototype.patchPointsBasedStudyState=function(e){return A0._fixInputsMaxValue(e.state,e.metaInfo),"LineToolRegressionTrend"===e.type&&(e=TradingView.LineToolRegressionTrend.patchSourceState(e)),e},A0.prototype.patchPointsBasedStudyData=function(e,t){if(!e||!t)return t;var i=TradingView.clone(t);return"VbPFixed@tv-volumebyprice"===e.id&&e.version&&4>=e.version&&A0._patchOldVolumeProfiles(0,i),i},A0.prototype.patchStudyData=function(e,t,i,n){t=TradingView.clone(t),i=TradingView.clone(i),n=TradingView.clone(n),"VbPVisible@tv-volumebyprice"===e.id&&e.version&&4>=e.version&&A0._patchOldVolumeProfiles(0,t.graphics),"VbPSessions@tv-volumebyprice"===e.id&&e.version&&4>=e.version&&A0._patchOldVolumeProfiles(0,t.graphics);var o=StudyMetaInfo.versionOf(e);if(e.isTVScript&&e.TVScriptSourceCode&&o>=12&&26>=o)for(e=t.columns,t.columns=[],o=0;o<e.length;++o)t.columns.push("plot_"+o);return{data:t,nsData:i,indexes:n}},A0._patchOldVolumeProfiles=function(e,t){var i,n=t.hhists[e].data,o=[];for(i in n)o=o.concat(n[i]);t.hhists[0].data=o},A0._fixInputsOrder=function(e,t){for(var i=StudyMetaInfo.getOrderedInputIds(t),n=A0.splitInputs(e.inputs),o=n.arr,n=TradingView.merge({},n.obj),r=0;r<i.length;++r){var s=A0.findInputKeyById(o,i[r]);void 0!=s&&(n[r]=o[s])}e.inputs=n},A0._fixInputsMaxValue=function(e,t){if(t.inputs)for(var i=0;i<t.inputs.length;i++)t.inputs[i].max&&253370764800<t.inputs[i].max&&(t.inputs[i].max=253370764800);if(e&&e.inputs){var i=A0.splitInputs(e.inputs),n=i.arr;for(key in n){var o=n[key];o.max&&253370764800<o.max&&(o.max=253370764800)}e.inputs=TradingView.merge(i.obj,i.arr)}},A0.prototype.patchPropsStateAndMetaInfo=function(e,t,i){
if(A0._fixInputsOrder(e,t),A0._fixInputsMaxValue(e,t),t.isTVScript&&"undefined"!=typeof TVScript&&(t.scriptIdPart=t.scriptIdPart||TVScript.createScriptIdPart()),t.isTVScript&&("Script$TV_EARNINGS@tv-scripting"!==t.id&&"Script$TV_DIVIDENDS@tv-scripting"!==t.id&&"Script$TV_SPLITS@tv-scripting"!==t.id||delete t.TVScriptSourceCode),"Volume"!==t.id&&"Volume@tv-basicstudies"!==t.id||0!=t.inputs.length||(t.inputs=[{id:"length",type:"integer",defval:20,min:1,max:1e3}],t.plots.push({id:"vol_ma",type:"line"})),"PivotPointsStandard@tv-basicstudies"===t.id&&(0===t.inputs.length?(e.inputs={kind:"Traditional",showHistoricalPivots:!0},t.inputs=[{defval:"Traditional",id:"kind",type:"text",options:"Traditional Fibonacci Woodie Classic DeMark Camarilla".split(" ")},{id:"showHistoricalPivots",type:"bool",defval:!0}]):1===t.inputs.length&&(e.inputs={kind:"Traditional"},t.inputs=[{defval:"Traditional",id:"kind",type:"text",options:"Traditional Fibonacci Woodie Classic DeMark Camarilla".split(" ")},{id:"showHistoricalPivots",type:"bool",defval:!0}]),void 0==e._hardCodedDefaultsVersion)){e._hardCodedDefaultsVersion=1;var n=e.color;delete e.color,e.levelsStyle={colors:{P:n,"S1/R1":n,"S2/R2":n,"S3/R3":n,"S4/R4":n,"S5/R5":n}}}if("CMF"===t.shortId&&2===t.inputs.length&&(e.inputs={length:e.inputs["length fast"]},t.inputs=t.inputs.splice(0,1),t.inputs[0].id="length"),t.defaults&&!t.defaults.precision&&(-1!=["Volume@tv-basicstudies","VbPVisible@tv-volumebyprice","VbPSessions@tv-volumebyprice"].indexOf(t.id)?t.defaults.precision=0:t.defaults.precision=4),"MA"===t.id){var n=new StudyMetaInfo({id:"MAExp",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgExp",type:"line"}],palettes:{}}),o=new StudyMetaInfo({id:"MASimple",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgSimple",type:"line"}],palettes:{}}),r=new StudyMetaInfo({id:"MAVolumeWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgVolumeWeighted",type:"line"}],palettes:{}}),s=new StudyMetaInfo({id:"MAWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgWeighted",type:"line"}],palettes:{}});switch(e.inputs.type){case"exp":result.metaInfo=n;break;case"simple":result.metaInfo=o;break;case"weighted":result.metaInfo=s;break;case"volume weighted":result.metaInfo=r}e.styles[t.plots[0].id]=e.styles.MovAvg,delete e.styles.MovAvg,delete e.inputs.type}return i.oldShowStudyLastValueProperty&&(e.oldShowLastValue=e.showLastValue),delete e.showLastValue,delete e.showStudyArguments,{propsState:e,metaInfo:t}},A0.compareStudyVersions=function(e,t){e=e.toString(),t=t.toString();var i=e.split("."),n=i[0],n=parseInt(n,10),i=1<i.length?i[1]:"0",i=parseInt(i,10),o=t.split("."),r=o[0],r=parseInt(r,10),o=1<o.length?o[1]:"0",o=parseInt(o,10);return r>n?-1:n>r?1:o>i?-1:i>o?1:0},A0.isLess=function(e,t){return 0>A0.compareStudyVersions(e,t)},A0.isLessOrEqual=function(e,t){return 0>=A0.compareStudyVersions(e,t)},A0.isEqual=function(e,t){return 0==A0.compareStudyVersions(e,t)},A0.isGreater=function(e,t){return 0<A0.compareStudyVersions(e,t)},A0.isGreaterOrEqual=function(e,t){return 0<=A0.compareStudyVersions(e,t)},A0.isVersionTesting=function(e){return e?(e=e.toString(),/\d+.\d+/.exec(e)==e):!1},A0.isVersionHead=function(e){return e?(e=e.toString(),/\d+/.exec(e)==e):!1},A0.mergeInputs=function(e,t){A0.mergeInputsArrPart(e,t),A0.mergeInputsObjPart(e,t)},A0.mergeInputsArrPart=function(e,t){var i,n=A0.splitInputs(t);for(i in n.arr){var o=A0.findInputKeyById(e,n.arr[i].id);o?TradingView.merge(e[o],n.arr[i]):A0.appendInputInfoToArr(e,n.arr[i])}},A0.mergeInputsObjPart=function(e,t){var i=A0.splitInputs(t);TradingView.merge(e,i.obj)},A0.appendInputInfoToArr=function(e,t){var i,n=-1;for(i in e){var o=parseInt(i,10);isNumber(o)&&o>n&&(n=o)}e[n+1]=t},A0.splitInputs=function(e){var t,i={},n={};for(t in e)isNumber(parseInt(t,10))?i[t]=e[t]:n[t]=e[t];return{arr:i,obj:n}},A0.findInputKeyById=function(e,t){var i,n=null;for(i in e)if(isNumber(parseInt(i,10))&&e[i].id==t){n=i;break}return n},A0.getInputKeyById=function(e,t){var i=A0.findInputKeyById(e,t);if(!i)throw Error("Cannot find input with id: "+t);return i},A48=function(e,t,i,n,o){TradingView.Study.call(this,e,t,i,n),this._paneView=o},inherit(A48,TradingView.Study),A48.prototype.onData=function(e){switch(e.method){case"data_update":var t=""!==e.params.nonseries.d?JSON.parse(e.params.nonseries.d):{};t.indexes_replace||(this._nonseriesdata=t.data),this._indexes=e.params.nonseries.indexes,e=this.D0.paneForSource(this),this.D0.recalculatePane(e,!0),this.D0.updateSource(this);break;default:return TradingView.Study.prototype.onData.call(this,e)}},A48.prototype.updateAllViews=function(){this._paneView.update(),this._dataWindowView.update(),this._statusView.update()},A48.prototype.paneViews=function(e){return e=new List,e.append(this._paneView),e},A48.prototype.state=function(e){var t=TradingView.Study.prototype.state.call(this,e);return e&&(t.nonSeriesData=this._nonseriesdata,t.indexes=this._indexes),t},A48.prototype.restoreData=function(e,t,i){TradingView.Study.prototype.restoreData.call(this,e),this._nonseriesdata=t,this._indexes=i},A48.prototype.clearData=function(){this._indexes=this._nonseriesdata=null},LocationToYMixin.prototype._locationToY=function(e,t,i){i||(i=0);var n,o=[],r=this.D1.priceScale();switch(e){case CanvasEx.MARKLOC_ABOVEBAR:n=HIGH_PLOT;break;case CanvasEx.MARKLOC_BELOWBAR:n=LOW_PLOT}var s=this.D1.firstValue();i>=1&&--i;for(var a=-i;i>=a;a++){var l=this.D1.series().bars().valueAt(t+a);l&&(l=l[n],r.isPercent()&&(l=r.priceRange().convertToPercent(l,s)),o.push(r.priceToCoordinate(l)))}switch(e){case CanvasEx.MARKLOC_ABOVEBAR:return MathEx.min(o)-15;case CanvasEx.MARKLOC_BELOWBAR:return MathEx.max(o)+15}},W33.isNaNOrUndefOrNull=function(e){return isNaN(e)||void 0===e||null===e},W33.isIndexValid=function(e,t){return e>=0&&e<t._length()},W33.prototype.items=function(){return this.m_items},W33.prototype.update=function(){this._invalidated=!0},W33.prototype._updateImpl=function(){if(this.m_items.clear(),this._histogramBase=null,!this.m_model.timeScale().isEmpty()&&!this.m_study.priceScale().isEmpty()){var e=this.m_model.timeScale().visibleBars().clone();if(!e.isEmpty()){var t=this.m_series.nearestIndex(e.firstBar(),SEARCH_NEAREST_RIGHT),i=this.m_series.nearestIndex(e.lastBar(),SEARCH_NEAREST_LEFT),n=this.m_study.offset(this._plotName);n>0?(t-=n,i+=n):(t+=n,i-=n);var e=this.m_study.properties().styles[this._plotName].plottype.value(),o=0<=[TradingView.StudyConsts.PLOT_LINE,TradingView.StudyConsts.PLOT_AREA,TradingView.StudyConsts.PLOT_CIRCLES,TradingView.StudyConsts.PLOT_CROSS].indexOf(e),e=this.m_study.data(),r=this.m_study.firstValue();if(o&&0<e._length()){for(var s=e._bsearch(t);W33.isIndexValid(s,e)&&W33.isNaNOrUndefOrNull(e._valueAt(s)[this._plotIndex+1]);)--s;for(t=W33.isIndexValid(s,e)?e._indexAt(s):t,s=e._bsearch(i);W33.isIndexValid(s,e)&&W33.isNaNOrUndefOrNull(e._valueAt(s)[this._plotIndex+1]);)s+=1;i=W33.isIndexValid(s,e)?e._indexAt(s):i}for(var a=e.range(t,i),s=this.m_study.priceScale(),l=s.properties().percentage.value(),e=this._getTranspValue(),d={},h=function(e,t){var i=e+"@"+t;return d[i]||(d[i]=generateColor(e,t)),d[i]},c=a._start;c<a._end;++c){var p=a._indexAt(c),p=p+n,p=Math.floor(p),u=a._valueAt(c),f=u[this._plotIndex+1],f=null!==f&&void 0!==f?f:NaN;if(l&&!isNaN(f)&&(f=100*(f-r)/r),!o||!isNaN(f)){if(p=new MathEx.Point(p,f),f=void 0!==u[this._colorer+1]||this._palette&&this._palette.addDefaultColor,this._colorer&&f){if(f=u[this._colorer+1],p.style={},u=this.m_study.properties().styles[this._plotName],void 0!=f){var g=this._palette.valToIndex?this._palette.valToIndex[f]:f,m=this._paletterProps.colors[g],f=m.color.value();p.style.color=h(f,e)}else f=u.color.value(),p.style.color=h(f,100);f=void 0!=g?m.width.value():u.linewidth.value(),u=void 0!=g?m.style.value():u.linestyle.value(),p.style.width=f,p.style.style=u}this.m_items.append(p)}}if(s.pricesToCoordinates(this.m_items),this.m_model.timeScale().indexesToCoordinates(this.m_items),this.m_study.properties().styles[this._plotName].histogramBase&&(this._histogramBase=this.m_study.priceScale().priceToCoordinate(this.m_study.properties().styles[this._plotName].histogramBase.value())),this.m_study===this.m_model.selectedSource())for(t=(new SelectionIndexes).calc(t,i),this._selectionData={points:new List},this._selectionData.hittestResult=HitTestResult.REGULAR,c=0;c<t.size();c++)p=t.item(c),u=this.m_study.data().valueAt(p),p+=n,void 0!==u&&(f=u[this._plotIndex+1],s.properties().percentage.value()&&(f=100*(f-r)/r),g=this.m_model.timeScale().indexToCoordinate(Math.floor(p)),m=this.m_study.priceScale().priceToCoordinate(f),this._selectionData.points.append(new MathEx.Point(g,m)));n=this.m_study.properties().styles[this._plotName],this._lineColor=generateColor(n.color.value(),e),this._lineWidth=n.linewidth.value(),n=n.color.value(),this._colorer&&(n=this._paletterProps.colors[0].color.value(),this._lineWidth=this._paletterProps.colors[0].width.value(),this._lineColor=generateColor(this._paletterProps.colors[0].color.value(),e)),this._color2=generateColor(n,e),n=new RGBColor(n),r=TradingView.rgbToHsl(n.r,n.g,n.b),t=r[0]+.05,r[0]=t-Math.floor(t),r=TradingView.hslToRgb(r[0],r[1],r[2]),n.r=r[0],n.g=r[1],n.b=r[2],n=n.toHex(),this._color1=generateColor(n,e)}}},W33.prototype._getTranspValue=function(){var e=0;this.m_study.properties().transparency&&(e=this.m_study.properties().transparency.value(),e=isNumber(e)?e:50);var t=this.m_study.properties().styles[this._plotName],i=t.plottype.value();return"Volume@tv-basicstudies"===this.m_study.metaInfo().id&&i===TradingView.StudyConsts.PLOT_COLUMNS?e:(0<=[TradingView.StudyConsts.PLOT_AREA,TradingView.StudyConsts.PLOT_AREA_WITH_BREAKS,TradingView.StudyConsts.PLOT_COLUMNS].indexOf(i)&&t.transparency&&(e=t.transparency.value(),e=isNumber(e)?e:50),e)},W33.prototype.renderer=function(){var e=this.m_study.properties().styles[this._plotName];if(e.visible.value()&&this.m_study.priceScale()){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var t={};this._getTranspValue(),e.color.value(),t.barSpacing=this.m_model.timeScale().barSpacing(),t.items=this.m_items,t.histogramBase=this._histogramBase?this._histogramBase:this.m_study.priceScale().height(),t.lineIndex=0,t.lineStyle=e.linestyle.value(),t.lineColor=this._lineColor,t.lineWidth=this._lineWidth,t.lineWidth=isNumber(t.lineWidth)?t.lineWidth:1,t.color1=this._color1,t.color2=this._color2,t.bottom=t.histogramBase,this._colorer||(t.simpleMode=!0);var i=new CompositeRenderer,n=e.joinPoints?e.joinPoints.value():!1;switch(e.plottype.value()){case TradingView.StudyConsts.PLOT_LINE:case TradingView.StudyConsts.PLOT_LINE_WITH_BREAKS:i.append(new W68(t));break;case TradingView.StudyConsts.PLOT_AREA:case TradingView.StudyConsts.PLOT_AREA_WITH_BREAKS:i.append(new W53(t));break;case TradingView.StudyConsts.PLOT_HISTOGRAM:i.append(new W66(t));break;case TradingView.StudyConsts.PLOT_COLUMNS:i.append(new W60(t));break;case TradingView.StudyConsts.PLOT_CROSS:i.append(new W61(t)),n&&(e=TradingView.merge({},t),e.lineWidth=1,e.forceLineWidth=!0,i.append(new W68(e)));break;case TradingView.StudyConsts.PLOT_CIRCLES:i.append(new W58(t)),n&&(e=TradingView.merge({},t),e.lineWidth=1,e.ignorePaletteLineWidth=!0,i.append(new W68(e)));break;default:i.append(new W68(t))}return this.m_study===this.m_model.selectedSource()&&i.append(new SelectionRenderer(this._selectionData)),i}},W30.prototype.items=function(){return this._items},W30.prototype.update=function(){this._invalidated=!0},W30.prototype._scalesReady=function(){var e=this.D0.timeScale(),t=this.D1.priceScale();return e&&t&&!e.isEmpty()&&!t.isEmpty()},W30.prototype._updateImpl=function(){this._items.clear(),assert(this._scalesReady(),"Scales must be ready!");var e=this.D0.timeScale().visibleBars().clone();if(!e.isEmpty()){var t=this.D1.metaInfo().plots[this._plotIndex].palette,i=this.D1.properties().palettes[t].colors,t=this.D1.metaInfo().palettes[t],n=this.D1.properties().styles[this._plotName].transparency.value(),o=this._series.nearestIndex(e.firstBar(),SEARCH_NEAREST_RIGHT),r=this._series.nearestIndex(e.lastBar(),SEARCH_NEAREST_LEFT),e=this.D1.offset(this._plotName);for(e>0?(o-=e,r+=e):(o+=e,r-=e),o=this.D1.data().range(o,r),r=o._start;r<o._end;++r){var s=o._indexAt(r),s=s+e,a=o._valueAt(r)[this._plotIndex+1],s=new MathEx.Point(Math.floor(s)-.5),l=isNumber(n)?n:50,l=Math.min(l,100),l=Math.max(l,0);void 0!=a?(colorIndexInPalette=t.valToIndex?t.valToIndex[a]:a,s.color=generateColor(i[colorIndexInPalette].color.value(),l)):s.color=null,this._items.append(s)}this.D0.timeScale().indexesToCoordinates(this._items)}},W30.prototype.renderer=function(){if(this.D1.properties().styles[this._plotName].visible&&this.D1.properties().styles[this._plotName].visible.value()&&this._scalesReady()){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={items:this._items,y:0,h:this.D1.priceScale().height(),w:Math.ceil(this.D0.timeScale().barSpacing())},t=new CompositeRenderer;return t.append(new W55(e)),t}},StudyPlotShapesPaneViewBase.prototype.items=function(){return this.m_items},StudyPlotShapesPaneViewBase.prototype.update=function(){this.m_invalidated=!0},StudyPlotShapesPaneViewBase.prototype._scalesReady=function(){var e=this.m_model.timeScale(),t=this.m_study.priceScale();return e&&t&&!e.isEmpty()&&!t.isEmpty()},StudyPlotShapesPaneViewBase.prototype._updateImpl=function(){if(this.m_items.clear(),this._scalesReady()){var e=this.m_model.timeScale(),t=this.m_study.priceScale(),e=e.visibleBars().clone();if(!e.isEmpty()){var i=this.m_series.nearestIndex(e.firstBar(),SEARCH_NEAREST_RIGHT),n=this.m_series.nearestIndex(e.lastBar(),SEARCH_NEAREST_LEFT),e=this.m_study.offset(this.m_plotName);e>0?(i-=e,n+=e):(i+=e,n-=e);var o=this.m_study.data(),r=this.m_study.firstValue(),o=o.range(i,n),s=t.properties().percentage.value();t.priceRange(),t=this._getTranspValue(),i=(new SelectionIndexes).calc(i,n).toArray(),(n=this.m_study===this.m_model.selectedSource())&&(this.m_selectionData={points:new List,hittestResult:HitTestResult.REGULAR,vertOffset:0});var a=this.m_series.properties().style.value();if(a=a===TradingView.Series.STYLE_LINE?"lineStyle":a===TradingView.Series.STYLE_AREA?"areaStyle":null)var l=a=this.m_series.properties()[a].priceSource.value();else a="high",l="low";for(var d=o._start;d<o._end;++d){var h=o._indexAt(d),c=Math.floor(h+e),p=function(e){try{var t=this.m_series[e||"close"](c)}catch(i){t=null}return t}.bind(this),u=o._valueAt(d),f=u[this.m_plotIndex+1];if(null!==f&&void 0!==f){s&&(f=100*(f-r)/r);var g=this.m_study.metaInfo().plots[this.m_plotIndex].type,m=this.m_study.properties().styles[this.m_plotName].location;if(g=(g=g==TradingView.StudyConsts.PLOT_TYPE_ARROWS)||m&&0<=[CanvasEx.MARKLOC_ABOVEBAR,CanvasEx.MARKLOC_BELOWBAR].indexOf(m.value())){if(m=p(a),p=p(l),void 0==m||void 0==p)continue}else p=m=f;p=this._createItem(c,f,m,p),void 0!=p&&(f=void 0!==u[this._colorer+1]||this._palette&&this._palette.addDefaultColor,this._colorer&&f&&(f=u[this._colorer+1],p.style={},void 0!=f?(f=this._paletterProps.colors[this._palette.valToIndex?this._palette.valToIndex[f]:f].color.value(),p.style.color=generateColor(f,t)):(f=this.m_study.properties().styles[this.m_plotName].color.value(),p.style.color=generateColor(f,100)),p.style.borderColor=generateColor(f,t>9?t-10:0)),this.m_model.timeScale().indexToCoordinate(Math.floor(c)),this.m_study.priceScale().priceToCoordinate(u),n&&-1!==$.inArray(h,i)&&this.m_selectionData.points.append(p),this.m_items.append(p))}}this._convertItemsToCoordinates()}}},StudyPlotShapesPaneViewBase.prototype._getTranspValue=function(){var e=0;this.m_study.properties().transparency&&(e=this.m_study.properties().transparency.value(),e=isNumber(e)?e:50);var t=this.m_study.properties().styles[this.m_plotName];return t.transparency&&(e=t.transparency.value(),e=isNumber(e)?e:50),e},StudyPlotShapesPaneViewBase.prototype._createItem=function(e,t,i,n){var o=this.m_study.properties().styles[this.m_plotName].location.value(),r=this.m_study.priceScale(),s=r.coordinateToPrice(r.height()*r.topMargin()),r=r.coordinateToPrice(r.height()*(1-r.bottomMargin()));if(!t&&o!=CanvasEx.MARKLOC_ABSOLUTE)return null;switch(o){case CanvasEx.MARKLOC_ABOVEBAR:t=i;break;case CanvasEx.MARKLOC_BELOWBAR:t=n;break;case CanvasEx.MARKLOC_TOP:t=s;break;case CanvasEx.MARKLOC_BOTTOM:t=r;break;case CanvasEx.MARKLOC_ABSOLUTE:break;default:throw Error("Bad value: "+o)}return new MathEx.Point(e,t)},StudyPlotShapesPaneViewBase.prototype._convertItemsToCoordinates=function(){var e=this.m_model.timeScale(),t=this.m_study.priceScale();e.indexesToCoordinates(this.m_items),t.pricesToCoordinatesEx(this.m_items.toArray(),function(e){return e.y},function(e,t){e.y=t})},StudyPlotShapesPaneViewBase.prototype._calculateVerticalOffset=function(e,t){var i;switch(e){case CanvasEx.MARKLOC_ABOVEBAR:case CanvasEx.MARKLOC_BOTTOM:i=-t;break;case CanvasEx.MARKLOC_BELOWBAR:case CanvasEx.MARKLOC_TOP:i=t;break;default:i=0}return i},StudyPlotShapesPaneViewBase.prototype._calculateShapeHeight=function(e){return Math.round(e/2)},StudyPlotShapesPaneViewBase.prototype.renderer=function(){if(this.m_study.properties().styles[this.m_plotName].visible&&this.m_study.properties().styles[this.m_plotName].visible.value()&&this._scalesReady()){var e=this.m_model.timeScale();this.m_invalidated&&(this._updateImpl(),this.m_invalidated=!1);var t={},i=this._getTranspValue(),n=e.barSpacing(),o=this._calculateShapeHeight(n),e=this.m_study.properties().styles[this.m_plotName].location.value(),e=this._calculateVerticalOffset(e,o+o/2);return t.barSpacing=n,t.items=this.m_items,t.color=generateColor(this.m_study.properties().styles[this.m_plotName].color.value(),i),t.height=o,t.vertOffset=e,n=this.m_study.properties().styles[this.m_plotName].plottype.value(),i=TradingView.StudyPlotShapes.Data[n],void 0==i&&console.error("Unknown style "+n),n=new CompositeRenderer,n.append(new window[i.paneRendererClass](t)),this.m_study===this.m_model.selectedSource()&&(this.m_selectionData.vertOffset=e,n.append(new SelectionRenderer(this.m_selectionData))),n}},inherit(W36,StudyPlotShapesPaneViewBase),W36.prototype._calculateTextVerticalOffset=function(e,t){var i;switch(e){case CanvasEx.MARKLOC_ABOVEBAR:case CanvasEx.MARKLOC_BOTTOM:i=2.5*-t;break;case CanvasEx.MARKLOC_BELOWBAR:case CanvasEx.MARKLOC_TOP:case CanvasEx.MARKLOC_ABSOLUTE:i=2.1*t;break;default:console.error("Unexpected location value: "+e),i=0}return i},W36.prototype._createTextData=function(e,t,i,n){var o={};return o.text=e,o.color=n,o.font="Arial",o.fontsize=12,o.offsetX=0,o.offsetY=i,o.vertAlign=i>0?"top":"bottom",o.horzAlign="center",o.bold=!1,o.italic=!1,o.points=new List,o.points.append(t),o.highlightBorder=!0,o},W36.prototype.renderer=function(){var e=this.m_study.properties().styles[this.m_plotName];if(e.visible&&e.visible.value()&&this._scalesReady()){var t=this.m_model.timeScale();this.m_invalidated&&(this._updateImpl(),this.m_invalidated=!1);var i={},n=this._getTranspValue(),o=t.barSpacing(),r=this._calculateShapeHeight(o),s=e.location.value(),t=generateColor(e.color.value(),n),a=n>19?n-10:0,n=this._calculateVerticalOffset(s,Math.round(1.5*r)),s=this._calculateTextVerticalOffset(s,r);if(i.barSpacing=o,i.items=this.items(),i.color=t,i.borderColor=generateColor(e.color.value(),a),i.height=r,i.vertOffset=n,r=e.plottype.value(),o=TradingView.StudyPlotShapes.Data[r],void 0==o&&console.error("Unknown style "+r),r=new CompositeRenderer,e=e.text?e.text.value():void 0,void 0!=e&&""!==e.trim())for(e=e.trim().replace(/\\n/gm,"\n"),a=0;a<this.m_items.size();a++){var l=this._createTextData(e,this.m_items.item(a),s,t);r.append(new TextRenderer(l,this._rendererCache,new HitTestResult(HitTestResult.REGULAR)))}return r.append(new window[o.paneRendererClass](i)),this.m_study===this.m_model.selectedSource()&&(this.m_selectionData.vertOffset=n,r.append(new SelectionRenderer(this.m_selectionData))),r}},inherit(W35,W36),W35.prototype._calculateShapeHeight=function(e){return Math.round(e)},W35.prototype._calculateTextVerticalOffset=function(e,t){var i;switch(e){case CanvasEx.MARKLOC_ABOVEBAR:case CanvasEx.MARKLOC_BOTTOM:i=1.3*-t;break;case CanvasEx.MARKLOC_BELOWBAR:case CanvasEx.MARKLOC_TOP:case CanvasEx.MARKLOC_ABSOLUTE:i=1.5*t;break;default:console.error("Unexpected location value: "+e),i=0}return i},W35.prototype.renderer=function(){var e=this.m_study.properties().styles[this.m_plotName];if(e.visible&&e.visible.value()&&this._scalesReady()){var t=this.m_model.timeScale();this.m_study.priceScale(),this.m_invalidated&&(this._updateImpl(),this.m_invalidated=!1);var i={},n=this._getTranspValue(),t=t.barSpacing(),o=this._calculateShapeHeight(t),r=e.location.value(),n=generateColor(e.color.value(),n),t=this._calculateVerticalOffset(r,o),r=this._calculateTextVerticalOffset(r,o);if(i.items=this.items(),i["char"]=e["char"].value(),i.height=o,i.vertOffset=t,i.color=n,o=new CompositeRenderer,e=e.text?e.text.value():void 0,void 0!=e&&""!==e.trim())for(var e=e.trim().replace(/\\n/gm,"\n"),s=0;s<this.m_items.size();s++){var a=this._createTextData(e,this.m_items.item(s),r,n);o.append(new TextRenderer(a,this._rendererCache,new HitTestResult(HitTestResult.REGULAR)))}return o.append(new W73(i)),this.m_study===this.m_model.selectedSource()&&(this.m_selectionData.vertOffset=t,o.append(new SelectionRenderer(this.m_selectionData))),o}},inherit(W34,StudyPlotShapesPaneViewBase),W34.prototype.renderer=function(){if(this.m_study.properties().styles[this.m_plotName].visible&&this.m_study.properties().styles[this.m_plotName].visible.value()&&this._scalesReady()){this.m_invalidated&&(this._updateImpl(),this.m_invalidated=!1);var e={},t=this._getTranspValue(),i=this.m_model.timeScale().barSpacing();return e.items=this.m_items,e.barSpacing=i,e.colorup=generateColor(this.m_study.properties().styles[this.m_plotName].colorup.value(),t),e.colordown=generateColor(this.m_study.properties().styles[this.m_plotName].colordown.value(),t),e.colorBorder=generateColor("#000000",t),e.minHeight=this.m_study.properties().styles[this.m_plotName].minHeight.value(),e.maxHeight=this.m_study.properties().styles[this.m_plotName].maxHeight.value(),t=new CompositeRenderer,t.append(new W54(e)),this.m_study===this.m_model.selectedSource()&&(e=this.m_selectionData,e.barSpacing=i,t.append(new SelectionRendererArrowsUpDown(e))),t}},W34.prototype._createItem=function(e,t,i,n){if(0!==t){Math.abs(t)>this._maxAbsValue&&(this._maxAbsValue=Math.abs(t));var o=t>0;return new PaneRendererArrowsUpDownItem(e,o?n:i,t,o)}},W34.prototype._convertItemsToCoordinates=function(){var e=this.m_model.timeScale(),t=this.m_study.priceScale();if(e.indexesToCoordinates(this.m_items),t.pricesToCoordinatesEx(this.m_items.toArray(),function(e){return e.y},function(e,t){e.y=t}),e=Math.abs(this.m_study.properties().styles[this.m_plotName].minHeight.value()),t=Math.abs(this.m_study.properties().styles[this.m_plotName].maxHeight.value()),e>t)var i=e,e=t,t=i;for(var t=(t-e)/this._maxAbsValue,i=this.m_items.toArray(),n=0;n<i.length;n++){var o=i[n],r=Math.abs(o.height);o.height=r*t+e}},inherit(W51,PriceAxisView),W51.prototype.update=function(){this._invalidated=!0},W51.prototype._updateImpl=function(){this._visible=!1,this._text="";var e=this.D1.lastValueData(this._plotIndex);e&&(this._visible=!0,this._text=e.text,this._coordinate=e.coordinate,this._floatCoordinate=e.floatCoordinate,this._background!=e.color&&(this._background=e.color,this._color=this.color()),this._textHeight=this.D1.priceScale().m_markBuilder.fontHeight())},W51.prototype.coordinate=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.coordinate.call(this)},W51.prototype.renderer=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),new PriceAxisViewRenderer({text:this._text,coordinate:this._coordinate,color:this._color,background:this._background,textHeight:this._textHeight,visible:this._visible},this._cache)},W51.prototype.text=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.text.call(this)},inherit(StudyDataWindowView,DataWindowView),StudyDataWindowView.prototype.update=function(){this._invalidated=!0},StudyDataWindowView.prototype._updateImpl=function(){this._header=this.D1.title(!0),this._title=this.D1.title();for(var e=$.t("n/a"),t=0;t<this._items.size();++t)this._items.item(t).setValue(e);if(!this.D0.timeScale().isEmpty()){var i=this.D1.metaInfo().plots,n=null,e={};if(i)for(t=0;t<i.length;t++)this.D1.isSelfColorerPlot(t)&&(e[i[t].target]={index:t},e[i[t].target].palette=this.D1.metaInfo().palettes[i[t].palette],e[i[t].target].paletterProps=this.D1.properties().palettes[i[t].palette]);for(var i=this.D0.crossHairSource().index,o=this.D1.formatter(),t=0;t<this._items.size();++t){var r=this._items.item(t).plotId,n=this._items.item(t).plotIndex,s=this.D1.offset(r),s=this.D1.nearestIndex(i-s,SEARCH_NEAREST_LEFT);void 0!==s&&(s=this.D1.data().valueAt(s)||this.D1.data().last())&&(n=s[n+1],isNumber(n)&&(this._items.item(t).setValue(o.format(n)),n=this.D1.properties().styles[r].color.value(),e[r]&&s.length>e[r].index+1?(s=s[e[r].index+1],void 0!=s?(n=e[r].palette,r=e[r].paletterProps,n=n.valToIndex?n.valToIndex[s]:s,this._items.item(t).setColor(r.colors[n].color.value())):this._items.item(t).setColor(n)):this._items.item(t).setColor(n)))}}},StudyDataWindowView.prototype.items=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items},inherit(DataVendorStudyDataWindowView,StudyDataWindowView),DataVendorStudyDataWindowView.prototype.additional=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional},DataVendorStudyDataWindowView.prototype._updateImpl=function(){var e=TradingView.getDataVendorString(this.D1.symbolInfo());return this._additional=e?"(Data Provided by "+e+")":void 0,StudyDataWindowView.prototype._updateImpl.call(this)},inherit(StudyStatusView,StatusView),StudyStatusView.prototype.color=function(){return this.D1._failed||this.D1.metaInfo().isTVScriptStub?"#ff0000":StatusView.prototype.color.call(this)},StudyStatusView.prototype.update=function(){this._text=this.D1._failed?this.D1.title(!0)+": "+this.D1.status():this.D1.title(!0)+" "+this.D1.status()},$90.prototype.addAnchors=function(e){if(this.isAnchorsRequired()){var t=this._points.clone();this.D0.lineBeingCreated()==this.W99&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))}},$90.prototype.update=function(){var e=this.W99.priceScale(),t=this.D0.timeScale();if(e&&!e.isEmpty()&&!t.isEmpty())for(this._points=new List,this._floatPoints=new List,e=this.W99.points(),t=0;t<e.size();t++){var i=e.item(t),n=this.W99.pointToScreenPoint(i);if(!n)break;i=n[0],i.data=t,n=n[1],n.data=t,this._floatPoints.append(i),this._points.append(n)}},$90.prototype.currentPoint=function(){var e=this.D0.crossHairSource();return new MathEx.Point(e.x,e.y)},$90.prototype.anchorColor=function(){return this.W99.isBeingEdited()?"#D61AD3":this.D0.isDark()?"#FFFFFF":"#606060"},$90.prototype.isHoveredSource=function(){return this.W99===this.D0.hoveredSource()},$90.prototype.isSelectedSource=function(){return this.W99===this.D0.selectedSource()},$90.prototype.isAnchorsRequired=function(){return this.isHoveredSource()||this.isSelectedSource()},$90.prototype.createLineAnchor=function(e){return new LineAnchor($.extend({color:this.anchorColor(),backgroundColor:this.D0.backgroundColor(),currentPoint:this.currentPoint(),linePointBeingEdited:this.D0.linePointBeingEdited(),hittestResult:HitTestResult.CHANGEPOINT,radius:(TradingView.isMobile.any()?15:7)+(this.isSelectedSource()?1:0),strokeWidth:(TradingView.isMobile.any()?3:1)+(this.isSelectedSource()?1:0)},e))},TradingView.study_Compare=function(e,t,i,n){this._symbolLabelView=new TradingView.W38(e,this,"compare"),TradingView.Study.call(this,e,t,i,n);var o=this;this.D2.minTick.listeners().subscribe(null,function(){o._createFormatter()}),this.properties().minTick.listeners().subscribe(null,function(){o.D0.D20(new A22(A22.FULL_UPDATE))}),this.D2.merge({skipHistogramBaseOnAutoScale:!0})},inherit(TradingView.study_Compare,TradingView.Study),TradingView.study_Compare.prototype.createViews=function(){this._dataWindowView||(this._dataWindowView=new DataVendorStudyDataWindowView(this,this.D0)),TradingView.Study.prototype.createViews.call(this),this._paneViews.append(this._symbolLabelView)},TradingView.study_Compare.prototype._createFormatter=function(){var e=this.properties().inputs.symbol.value(),e=this._resolvedSymbols?this._resolvedSymbols[e]:null;if("default"==this.properties().minTick.value())this._formatter=new PriceFormatter(e?e.pricescale:100,e?e.minmov:1,e?e.fractional:!1);else{var e=this.properties().minTick.value(),e=isNumber(e)?["100","1","false"]:e.split(","),t=parseInt(e[0]),i=parseInt(e[1]);this._formatter=new PriceFormatter(t,i,"true"===e[2])}this.priceScale()&&this.priceScale().updateFormatter()},TradingView.study_Compare.prototype.symbol=function(){var e=this.properties().inputs.symbol.value(),t=this._resolvedSymbols?this._resolvedSymbols[e]:null;return(t?t.name:e).toUpperCase()},TradingView.study_Compare.prototype.title=function(e){e=this.properties().inputs.symbol.value();var t=this._resolvedSymbols?this._resolvedSymbols[e]:null;return(t?t.name+", "+t.exchange:e).toUpperCase()},TradingView.study_Compare.prototype.symbolInfo=function(){if(!this._resolvedSymbols)return null;var e=this.D2.inputs.symbol.value();return e?this._resolvedSymbols[e]:null},TradingView.study_Compare.prototype.lastPriceLabelFixedCoordinate=function(){return this._priceAxisViews.item(0)._fixedCoordinate},AreaBackgroundRenderer.prototype.hitTest=function(e){selectionTolerance(this.lineWidth);for(var t=1;t<this._data.points1.length;++t)if(currY1=this._data.points1[t],currY2=this._data.points2[t],x=this._data.timePoints[t],x==e.x&&(e.y>=currY1&&e.y<=currY2||e.y<=currY1&&e.y>=currY2))return new HitTestResult(HitTestResult.REGULAR);return null},AreaBackgroundRenderer.prototype.draw=function(e){if(0!==this._data.points1.length&&0!==this._data.points2.length)for(var t,i,n,o,r,s,a=this._data.timePoints,l=this._data.points1,d=this._data.points2,h=this._data.getBarSpacing()/4,c=paneRendererCoordinateIsValid,p=isNumber(this._data.transparency)?this._data.transparency:50,p=Math.min(p,100),p=Math.max(p,0),p=generateColor(this._data.backcolor,p),u=0;u<this._data.timePoints.length;u++)if(i=a[u],n=l[u],o=d[u],r=l[u+1],s=d[u+1],c(n)&&c(o)&&(t||(t={points1:[],points2:[],timePoints:[]}),t.points1.push(n),t.points2.push(o),t.timePoints.push(i)),t&&(!c(r)||!c(s))){for(1===t.timePoints.length&&(t.timePoints=[t.timePoints[0]-h,t.timePoints[0]+h],t.points1.push(t.points1[0]),t.points2.push(t.points2[0])),e.beginPath(),e.moveTo(t.timePoints[0],t.points1[0]),i=1;i<t.timePoints.length;i++)e.lineTo(t.timePoints[i],t.points1[i]);for(0<t.timePoints.length&&0<t.points2.length&&e.lineTo(t.timePoints[t.timePoints.length-1],t.points2[t.timePoints.length-1]),i=t.timePoints.length-2;i>=0;i--)e.lineTo(t.timePoints[i],t.points2[i]);e.closePath(),e.fillStyle=p,e.fill(),t=null}},TradingView.$53=function(e){this.W99=e,this._points1=[],this._points2=[],this._timePoints=[],this._getBarSpacing=e.model().timeScale().barSpacing.bind(e.model().timeScale()),this._invalidated=!0},TradingView.$53.prototype.update=function(){this._invalidated=!0},TradingView.$53.prototype._updateImpl=function(){
if(this._points1=[],this._points2=[],this._timePoints=[],this._visible()){var e=this.W99.priceScale(),t=this.W99.D0.timeScale();if(e&&!e.isEmpty()&&!this.W99.D0.timeScale().isEmpty()&&!this.W99._series.bars().isEmpty()){var i=this.W99.data()._columns.indexOf(this._plotAId())+1,n=this.W99.data()._columns.indexOf(this._plotBId())+1,o=this.W99.D0.timeScale().visibleBars();if(!o.isEmpty()){var r=this.W99.offset(this._plotAId()),s=this.W99._series.nearestIndex(o.firstBar(),SEARCH_NEAREST_RIGHT),o=this.W99._series.nearestIndex(o.lastBar(),SEARCH_NEAREST_LEFT);if(r>0?(s-=r,o+=r):(s+=r,o-=r),s=this.W99.data().range(s,o),0<this.W99.data()._items.length){this.W99.data();for(var o=this.W99.firstValue(),a=s._start;a<s._end;++a){var l=s._indexAt(a),d=s._valueAt(a),l=l+r,h=d[i];e.properties().percentage.value()&&(h=100*(h-o)/o),this._points1.push(h),d=d[n],e.properties().percentage.value()&&(d=100*(d-o)/o),this._points2.push(d),this._timePoints.push(t.indexToCoordinate(l))}}e.pricesArrayToCoordinates(this._points1),e.pricesArrayToCoordinates(this._points2)}}}},TradingView.$53.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.points1=this._points1,e.points2=this._points2,e.timePoints=this._timePoints,e.getBarSpacing=this._getBarSpacing,e.backcolor=this._color(),e.transparency=this._transparency(),new AreaBackgroundRenderer(e)},TradingView.$53.prototype._plotAId=function(){assert(!1,"Pure virtual call!")},TradingView.$53.prototype._plotBId=function(){assert(!1,"Pure virtual call!")},TradingView.$53.prototype._color=function(){assert(!1,"Pure virtual call!")},TradingView.$53.prototype._transparency=function(){assert(!1,"Pure virtual call!")},TradingView.$53.prototype._visible=function(){assert(!1,"Pure virtual call!")},TradingView.$55=function(e){TradingView.$53.call(this,e)},inherit(TradingView.$55,TradingView.$53),TradingView.$55.prototype._plotAId=function(){return this.W99.properties().area[0].name.value()},TradingView.$55.prototype._plotBId=function(){return this.W99.properties().area[1].name.value()},TradingView.$55.prototype._color=function(){return this.W99.properties().areaBackground.backgroundColor.value()},TradingView.$55.prototype._transparency=function(){return this.W99.properties().areaBackground.transparency.value()},TradingView.$55.prototype._visible=function(){return this.W99.properties().areaBackground.fillBackground.value()},TradingView.W2=function(e,t,i){TradingView.$53.call(this,e),assert(t.type===StudyMetaInfo.FilledArea.TYPE_PLOTS,"Wrong filledArea type: "+t.type),this._fillMetaInfo=t,this._fillStyleProps=i},inherit(TradingView.W2,TradingView.$53),TradingView.W2.prototype._plotAId=function(){return this._fillMetaInfo.objAId},TradingView.W2.prototype._plotBId=function(){return this._fillMetaInfo.objBId},TradingView.W2.prototype._color=function(){return this._fillStyleProps.color.value()},TradingView.W2.prototype._transparency=function(){return this._fillStyleProps.transparency.value()},TradingView.W2.prototype._visible=function(){return this._fillStyleProps.visible.value()},TradingView.$58=function(e,t){this.W99=t,this.D2=e,this._points=new List,this._points.append(new MathEx.Point(-1,-1))},TradingView.$58.prototype.update=function(){var e=this.W99.priceScale();if(!e||e.isEmpty())this._points.setItem(0,new MathEx.Point(-1,-1));else{var t=this.D2.value.value();isNumber(t)?this._points.setItem(0,new MathEx.Point(-1,e.priceToCoordinate(t))):this._points.setItem(0,new MathEx.Point(-1,NaN))}},TradingView.$58.prototype.renderer=function(){var e={};return e.points=this._points,e.color=this.D2.color.value(),e.linewidth=this.D2.linewidth.value(),e.linestyle=this.D2.linestyle.value(),e.hitTestResult=HitTestResult.REGULAR,new HorzLineRenderer(e)},BandBackgroundRenderer.prototype.draw=function(e){if(0!==this._data.points.length){var t=e.canvas.width;e.fillStyle=generateColor(this._data.backcolor,this._data.transparency);var i=Math.min(this._data.points[0],this._data.points[1]),n=Math.max(this._data.points[0],this._data.points[1]);e.fillRect(0,i,t,n-i)}},BandBackgroundRenderer.prototype.hitTest=function(e){return null},TradingView.$57=function(e){this.W99=e,this._points=[]},TradingView.$57.prototype.update=function(){if(this._points=[],this.W99.properties().bandsBackground.fillBackground.value()){var e=this.W99.properties().bands[0],t=this.W99.properties().bands[1],i=this.W99.priceScale();i&&!i.isEmpty()&&(this._points.push(i.priceToCoordinate(e.value.value())),this._points.push(i.priceToCoordinate(t.value.value())))}},TradingView.$57.prototype.renderer=function(){var e={};return e.points=this._points,e.backcolor=this.W99.properties().bandsBackground.backgroundColor.value(),e.transparency=this.W99.properties().bandsBackground.transparency.value(),new BandBackgroundRenderer(e)},TradingView.$84=function(e,t,i){this.W99=e,this._points=[],assert(t.type===StudyMetaInfo.FilledArea.TYPE_HLINES,"Wrong filledArea type: "+t.type),this._initBandIndexes(t.objAId,t.objBId),this._fillStyleProps=i},TradingView.$84.prototype._initBandIndexes=function(e,t){this._bandBKey=this._bandAKey=null;for(var i=0;i<this.W99.metaInfo().bands.length;++i){var n=this.W99.metaInfo().bands[i];void 0==this._bandAKey&&n.id===e?this._bandAKey=i:void 0==this._bandBKey&&n.id===t&&(this._bandBKey=i)}},TradingView.$84.prototype.update=function(){if(this._points=[],this._fillStyleProps.visible.value()){var e=this.W99.properties().bands[this._bandAKey],t=this.W99.properties().bands[this._bandBKey],i=this.W99.priceScale();i&&!i.isEmpty()&&(this._points.push(i.priceToCoordinate(e.value.value())),this._points.push(i.priceToCoordinate(t.value.value())))}},TradingView.$84.prototype.renderer=function(){var e={};return e.points=this._points,e.backcolor=this._fillStyleProps.color.value(),e.transparency=this._fillStyleProps.transparency.value(),new BandBackgroundRenderer(e)},W50.prototype.minIndex=void 0,W50.prototype.maxIndex=void 0,W50.prototype.merge=function(e){for(var t=this._marksBySpan,i={},n=0;n<e.length;n++){var o=e[n],r=o.index,s=o.span,a=this._marksByIndex[o.index];if(a){if(a.index===o.index&&a.span===o.span){a.time=o.time;continue}this._removeTickmark(a)}this._marksByIndex[r]=o,this.minIndex<=r||(this.minIndex=r),this.maxIndex>=r||(this.maxIndex=r),t[s]||(t[s]=[]),t[s].push(o),i[s]=!0}for(s=t.length;s--;)t[s]&&(t[s].length||delete t[s],i[s]&&t[s].sort(this._sortByIndexAsc));delete this._cache},W50.prototype._removeTickmark=function(e){var t=e.index;this._marksByIndex[t]===e&&(delete this._marksByIndex[t],t<=this.minIndex&&this.minIndex++,t>=this.maxIndex&&this.maxIndex--,this.maxIndex<this.minIndex&&(delete this.minIndex,delete this.maxIndex),t=this._marksBySpan[e.span],e=t.indexOf(e),-1!==e&&t.splice(e,1))},W50.prototype._sortByIndexAsc=function(e,t){return e.index-t.index},W50.prototype.removeTail=function(e){var t={};this.maxIndex=0;for(var i in this._marksByIndex)this._marksByIndex[i].time<e&&(t[i]=this._marksByIndex[i],this.maxIndex=Math.max(this.maxIndex,i));this._marksByIndex=t},W50.prototype.addTail=function(e){for(var t=0;t<e.length;t++)e[t].index=this.maxIndex+t+1;this.merge(e)},W50.prototype.indexToTime=function(e){return(e=this._marksByIndex[e])?new Date(1e3*e.time):null},W50.prototype.build=function(e,t){var i=Math.ceil(t/e);if(this._maxbar===i&&this._cache)return this._cache;this._maxbar=i;for(var n=[],o=this._marksBySpan.length;o--;)if(this._marksBySpan[o]){for(var r=n,n=[],s=r.length,a=0,l=this._marksBySpan[o],d=l.length,h=1/0,c=-(1/0),p=0;d>p;p++){for(var u=l[p],f=u.index;s>a;){var h=r[a],g=h.index;if(!(f>g)){h=g;break}a++,n.push(h),c=g,h=1/0}h-f>=i&&f-c>=i&&(n.push(u),c=f)}for(;s>a;a++)n.push(r[a])}return this._cache=n},W50.prototype.state=function(){for(var e=[],t=this._marksBySpan.length;t--;)this._marksBySpan[t]&&(e=e.concat(this._marksBySpan[t]));return{marks:e}},W50.prototype.restoreState=function(e){this._marksByIndex={},this._marksBySpan=[],delete this.maxIndex,delete this.minIndex,e&&e.marks&&e.marks.length&&this.merge(e.marks)},TimePoint.prototype.date=function(){return this.m_date},TimePoint.prototype.setDate=function(e){this.m_date=e};var MONTH_NAMES=void 0,MINUTE_SPAN=20,HOUR_SPAN=30,DAY_SPAN=40,WEEK_SPAN=50,MONTH_SPAN=60,YEAR_SPAN=70,DEFAULT_BAR_SPACING=6,MAX_BAR_SPACING=50,MIN_BAR_SPACING=.5,DEFAULT_RIGHT_OFFSET=5;W49.prototype.reset=function(){this._visibleBarsCache=null,this.m_points=new TimeIndexes,this.m_stateSnapshot=this.m_scaleStartPoint=this.m_scrollStartPoint=null,this.m_tickmarks=new W50},W49.prototype.restoreDefault=function(){this._visibleBarsCache=null,this.m_barSpacing=DEFAULT_BAR_SPACING,this.m_rightOffset=this.D2.rightOffset.value(),this.saveDefault("barSpacing"),this._correctOffset(),this.recalcLockedScale()},W49.prototype.rightOffset=function(){return this.m_rightOffset},W49.prototype.scrollToRealtime=function(e){var t=this.D2.rightOffset.value();if(e){var i=this;e=this.m_rightOffset;var n=this.m_width/this.m_barSpacing-10;n>0&&t>n&&(t=n);var o=this.D0;$({offset:e}).animate({offset:t},{duration:1e3,easing:"easeInOutQuint",step:function(e){i._visibleBarsCache=null,i.m_rightOffset=e,o.recalculateAllPanes(),o.D20(new A22(A22.LIGHT_UPDATE)),o.recalcVisibleRangeStudy(o.D19())}})}else this._visibleBarsCache=null,this.m_rightOffset=t,this._correctOffset()},W49.prototype.points=function(){return this.m_points},W49.prototype.width=function(){return this.m_width},W49.prototype.barSpacing=function(){return this.m_barSpacing},W49.prototype.setWidth=function(e){this._visibleBarsCache=null,!isFinite(e)||0>=e||(this._locked&&this.m_width&&(this.m_barSpacing*=e/this.m_width),this.m_width=e,this._correctOffset())},W49.prototype.visibleBars=function(){if(this._visibleBarsCache)return this._visibleBarsCache;if(!this.isEmpty()){var e=Math.ceil(this.m_width/this.m_barSpacing)-1,t=Math.round(this.m_rightOffset+this.m_points.lastTimePointIndex());return this._visibleBarsCache=e=new BarsRange(t-e,t)}},W49.prototype.isEmpty=function(){return 0===this.m_width||0===this.m_points.size()},W49.prototype.indexToCoordinate=function(e,t){if(this.isEmpty()||!isInteger(e))return 0;var i=this.m_points.lastTimePointIndex()+this.m_rightOffset-e,i=this.m_width-(i+.5)*this.m_barSpacing;return t?i:Math.round(i)},W49.prototype.barIndexesToCoordinates=function(e){e=e.toArray();for(var t=0;t<e.length;t++){var i=e[t].time,i=this.m_points.lastTimePointIndex()+this.m_rightOffset-i,i=this.m_width-(i+.5)*this.m_barSpacing;e[t].time=Math.round(i),e[t].exactTime=i}},W49.prototype.indexesToCoordinates=function(e){e=e.toArray();for(var t=this.m_points.lastTimePointIndex()+this.m_rightOffset,t=this.m_width-t*this.m_barSpacing-.5*this.m_barSpacing,i=0;i<e.length;i++)e[i].x=Math.round(t+e[i].x*this.m_barSpacing)},W49.prototype.coordinateToIndex=function(e){return e=(this.m_width+1-e)/this.m_barSpacing,e=this.m_points.lastTimePointIndex()+this.m_rightOffset-e,e=Math.round(1e6*e)/1e6,Math.ceil(e)},W49.prototype.timeToCoordinate=function(e){function t(e){return 0>=e||e>=this.m_width}var i=this.m_points.closestIndexLeft(e),n=this.m_points.valueAt(i),i=this.indexToCoordinate(i,!0);if(t(i))return null;var o=this.barSpacing(),r=function(){var e=this.m_points.lastTimePointIndex();return this.m_points.valueAt(e)-this.m_points.valueAt(e-1)}.call(this);return e=Math.round(i+(e-n)/r*o)+1,t(e)?null:e},W49.prototype.alignCoordinate=function(e){return this.isEmpty()?e:(e=this.coordinateToIndex(e),this.indexToCoordinate(e))},W49.prototype.timePointToIndex=function(e){return this.m_points.indexOf(e,!0)},W49.prototype.indexToTimePoint=function(e){return(e=this.m_points.valueAt(e))?new Date(1e3*e):null},W49.prototype.indexToUserTime=function(e){return this.m_tickmarks.indexToTime(e)},W49.prototype.marks=function(){if(this.isEmpty())return null;for(var e=this.m_barSpacing,t=Math.round(75/e),i=this.visibleBars(),n=Math.max(i.firstBar(),i.firstBar()-t),t=Math.max(i.lastBar(),i.lastBar()-t),e=this.m_tickmarks.build(e,75),i=[],o=0;o<e.length;++o){var r=e[o];if(n<=r.index&&r.index<=t){var s=this.m_tickmarks.indexToTime(r.index);null!==s&&i.push({coord:this.indexToCoordinate(r.index),label:this.formatLabel(s,r.span),span:r.span,major:r.label>=DAY_SPAN?1:0})}}return i},W49.prototype.state=function(e){var t={};return t.m_barSpacing=this.barSpacing(),t.m_rightOffset=this.m_rightOffset,e&&(0<this.m_points.size()&&(t.m_lastVisibleBar=this.m_points.valueAt(this.m_points.lastTimePointIndex())),t.points=this.m_points.state(),t.tickmarks=this.m_tickmarks.state(),t.width=this.m_width),t},W49.prototype.restoreState=function(e,t,i){this._visibleBarsCache=null,void 0===e.m_barSpacing?TradingView.logDebug("W49.restoreState: invalid state"):void 0===e.m_rightOffset?TradingView.logDebug("W49.restoreState: invalid state"):(this.m_barSpacing=e.m_barSpacing,this.m_rightOffset=e.m_rightOffset,this.m_restoredLastTimePoint=e.m_lastVisibleBar,i&&this.m_restoredLastTimePoint&&(i=this.m_points.indexOf(this.m_restoredLastTimePoint),lastIndex=this.m_points.lastTimePointIndex(),offset=lastIndex-i,this.m_rightOffset=-offset+e.m_rightOffset),t&&(this.m_points.restoreState(e.points),this.m_tickmarks.restoreState(e.tickmarks),e.width&&(this._locked=!0,0<this.m_width&&(this.m_barSpacing*=this.m_width/e.width))),this._correctOffset())},W49.prototype.setOffset=function(e){this._visibleBarsCache=null,void 0===e?TradingView.logDebug("W49.setOffset: invalid state"):(this.m_rightOffset=e,this._correctOffset())},W49.prototype.setBarSpacing=function(e){this._visibleBarsCache=null,void 0===e?TradingView.logDebug("W49.setBarSpacing: invalid state"):this.m_barSpacing=e},W49.prototype._correctOffset=function(){if(!this.isEmpty()){var e=this.m_width/this.m_barSpacing-10;e>0&&this.m_rightOffset>e&&(this.m_rightOffset=e,this._visibleBarsCache=null),e=this.m_points.size()-10,this.m_rightOffset<-e&&(this.m_rightOffset=-e,this._visibleBarsCache=null)}},W49.prototype.maxOffset=function(){return this.m_width/this.m_barSpacing-10},W49.prototype.startScale=function(e){this.m_scrollStartPoint&&this.endScroll(),null!==this.m_scaleStartPoint||null!==this.m_stateSnapshot||this.isEmpty()||(this.m_scaleStartPoint=e,this.m_stateSnapshot=this.state())},W49.prototype.scaleTo=function(e){if(this._visibleBarsCache=null,delete this.m_restoredLastTimePoint,null!==this.m_stateSnapshot){e=MathEx.clamp(this.m_width-e,0,this.m_width);var t=MathEx.clamp(this.m_width-this.m_scaleStartPoint,0,this.m_width);0!==e&&0!==t&&(this.m_barSpacing=this.m_stateSnapshot.m_barSpacing*e/t,this.m_barSpacing<MIN_BAR_SPACING?this.m_barSpacing=MIN_BAR_SPACING:this.m_barSpacing>MAX_BAR_SPACING&&(this.m_barSpacing=MAX_BAR_SPACING),this._correctOffset(),this.recalcLockedScale())}},W49.prototype.endScale=function(){null!==this.m_scaleStartPoint&&(this.m_stateSnapshot=this.m_scaleStartPoint=null,this.saveDefault("barSpacing"))},W49.prototype.saveDefault=function(e){TradingView.saveDefaultProperties(!0),this.D2[e].setValue(this["m_"+e]),TradingView.saveDefaultProperties(!1)},W49.prototype.startScroll=function(e){null!==this.m_scrollStartPoint||null!==this.m_stateSnapshot||this.isEmpty()||(this.m_scrollStartPoint=e,this.m_stateSnapshot=this.state())},W49.prototype.scrollTo=function(e){this._visibleBarsCache=null,delete this.m_restoredLastTimePoint,null!==this.m_scrollStartPoint&&(e=(this.m_scrollStartPoint-e)/this.barSpacing(),this.m_rightOffset=this.m_stateSnapshot.m_rightOffset+e,this._correctOffset(),this.D0.mainSeries().priceScale().properties().percentage.value()&&this.recalcLockedScale())},W49.prototype.scrollToOffsetAnimated=function(e,t){if(!isFinite(e))throw new RangeError("offset is required and must be finite number");if(void 0===t&&(t=400),!isFinite(t)||0>=t)throw new RangeError("animationDuration (optional) must be finite positive number");var i=this,n=this.m_rightOffset,o=+new Date,r=this.D0;!function s(){i._visibleBarsCache=null;var a=(new Date-o)/t;a>=1?(i.m_rightOffset=e,i._visibleBarsCache=null,r.recalculateAllPanes(),r.D20(new A22(A22.LIGHT_UPDATE))):(i.m_rightOffset=n+(e-n)*a,r.recalculateAllPanes(),setTimeout(s,20))}()},W49.prototype.endScroll=function(){null!==this.m_scrollStartPoint&&(this.m_stateSnapshot=this.m_scrollStartPoint=null)},W49.prototype._currentSavedPosition=function(){if(!this.isEmpty()){var e=this.m_points.indexOf(this.m_restoredLastTimePoint,!0);isInteger(e)&&(e=this.m_points.lastTimePointIndex()-e,this.m_rightOffset-=e),delete this.m_restoredLastTimePoint}},W49.prototype.update=function(e,t,i,n){this._visibleBarsCache=null,this.m_tickmarks.merge(n),this.m_points.merge(e,t,i),this.m_restoredLastTimePoint&&this._currentSavedPosition()},W49.prototype.addTail=function(e,t,i){this.m_tickmarks.removeTail(t),e=e.params,t=this.m_tickmarks.maxIndex+(i?0:1);for(var n=0;n<e.marks.length;n++)e.marks[n].index=t+n;this.m_tickmarks.addTail(e.marks),this.m_points.addTail(e.changes,i),this.m_rightOffset-=e.changes.length},W49.prototype.formatLabel=function(e,t){if(this._formattedBySpan[t])return this._formattedBySpan[t].format(e.valueOf());var i=this;return this._formattedBySpan[t]=new FormattedLabelsCache(function(e){return i.formatLabelImpl(new Date(e),t)}),this._formattedBySpan[t].format(e)},W49.prototype.formatLabelImpl=function(e,t){if(!(e&&e instanceof Date))return"incorrect time";var i=this.D0.mainSeries().isDWM();return MINUTE_SPAN>t&&!i?numberToStringWithLeadingZero(e.getUTCHours(),2)+":"+numberToStringWithLeadingZero(e.getUTCMinutes(),2)+":"+numberToStringWithLeadingZero(e.getUTCSeconds(),2):DAY_SPAN>t&&!i?numberToStringWithLeadingZero(e.getUTCHours(),2)+":"+numberToStringWithLeadingZero(e.getUTCMinutes(),2):WEEK_SPAN>t||MONTH_SPAN>t?e.getUTCDate():YEAR_SPAN>t?(MONTH_NAMES||(MONTH_NAMES=_createMonthNames()),MONTH_NAMES[e.getUTCMonth()]):e.getUTCFullYear()},W49.prototype.normalizeBarIndex=function(e){var t=0,i=0;return e<this.m_points.firstTimePointIndex()?(t=this.m_points.valueAt(this.m_points.firstTimePointIndex()),i=e-this.m_points.firstTimePointIndex()):e>this.m_points.lastTimePointIndex()?(t=this.m_points.valueAt(this.m_points.lastTimePointIndex()),i=e-this.m_points.lastTimePointIndex()):(t=this.m_points.valueAt(e),i=0),{time_t:t,offset:i}},W49.prototype.denormalizeTimePoint=function(e){var t=this.m_points.closestIndexLeft(e.time_t);return void 0===t?void 0:t+e.offset},W49.prototype.zoomToBarsRange=function(e,t){if(!(e>=t)){var i=this.m_points.lastTimePointIndex();i&&(this.m_rightOffset=t-i),this.m_barSpacing=this.width()/(t-e+1),this._visibleBarsCache=null}},W49.prototype.recalcLockedScale=function(){if(this.D0.m_mainSeries.properties().lockScale.value()&&!this.isEmpty()){var e=this.D0.m_mainSeries.priceScale(),t=this.D0.m_mainSeries,i=t.data().boxSize;if(i||(t.fixBoxSize(),i=t.data().boxSize),i){if(e.properties().percentage.value())var n=t.data().search(t.getRealVisibleRange().m_firstBar).value[CLOSE_PLOT],i=PriceRange.prototype.convertToPercent.call(null,n+i,n)-PriceRange.prototype.convertToPercent.call(null,n,n);i=e.internalHeight()/(this.barSpacing()/i),e=t.priceScale().priceRange(),e&&i==e.length()||(!e||e.isEmpty()?(e=this.visibleBars(),e=t.priceRange(e.firstBar(),e.lastBar())):(i=(i-e.length())/2,e.m_minValue-=i,e.m_maxValue+=i),t.priceScale().setPriceRange(e))}}},W49.prototype.correctBarSpacing=function(){!this.isEmpty()&&this.points().size()<this.width()/this.barSpacing()&&(this.setOffset(DEFAULT_RIGHT_OFFSET),this.setBarSpacing(Math.min(this.width()/(this.points().size()+this.rightOffset()),MAX_BAR_SPACING)))},W49.prototype.canZoomIn=function(){return this.m_barSpacing<MAX_BAR_SPACING},W49.prototype.canZoomOut=function(){return this.m_barSpacing>MIN_BAR_SPACING},SelectionRenderer.RADIUS=3.5,SelectionRenderer.prototype.tolerance=2,SelectionRenderer.prototype.draw=function(e){if(this._data){e.strokeStyle="#6B6B6B",e.fillStyle="#D6D6D6";for(var t=this._data.vertOffset||0,i=0;i<this._data.points.size();i++){var n=this._data.points.item(i),o=n;void 0===o.x||isNaN(o.x)||null===o.x||void 0===o.y||isNaN(o.y)||null===o.y||this._drawMarker(e,n,t)}}},SelectionRenderer.prototype._drawMarker=function(e,t,i){e.beginPath(),e.arc(t.x+.5,t.y+.5+i,SelectionRenderer.RADIUS,0,2*Math.PI,!0),e.closePath(),e.fill(),e.stroke()},SelectionRenderer.prototype.hitTest=function(e){if(!this._data)return null;for(var t=0;t<this._data.points.size();t++){var i=this._data.points.item(t);if(i.substract(e).length()<=SelectionRenderer.RADIUS+this.tolerance)return new HitTestResult(this._data.hittestResult,i.data)}return null},LineAnchor.OUTER_RADIUS=TradingView.isMobile.any()?16:8,LineAnchor.prototype.tolerance=2,LineAnchor.prototype.draw=function(e){for(var t=this._data.currentPoint,i=this._data.outerStrokeWidth||1,n=0;n<this._data.points.size();n++){var o=this._data.points.item(n),r=o.substract(t).length(),s=isInteger(o.data)&&this._data.linePointBeingEdited===o.data,a=this.radius,l=this._data.strokeWidth||2,r=r<=a+this.tolerance?1:0,a=a+r,l=l+r;s||(o.square?(e.fillStyle=this._data.backgroundColor,e.fillRect(o.x-a,o.y-a,2*a,2*a),e.fillStyle=this._data.color,s=a-i,e.fillRect(o.x-s,o.y-s,2*s,2*s),s=a-i-l,e.fillStyle=this._data.backgroundColor,e.fillRect(o.x-s,o.y-s,2*s,2*s)):(e.beginPath(),e.arc(o.x,o.y,a,0,2*Math.PI,!0),e.closePath(),e.fillStyle=this._data.backgroundColor,e.fill(),e.beginPath(),e.arc(o.x,o.y,a-i,0,2*Math.PI,!0),e.closePath(),e.fillStyle=this._data.color,e.fill(),e.beginPath(),e.arc(o.x,o.y,a-i-l,0,2*Math.PI,!0),e.closePath(),e.fillStyle=this._data.backgroundColor,e.fill()))}},LineAnchor.prototype.hitTest=function(e){for(var t=0;t<this._data.points.size();t++){var i=this._data.points.item(t);if(i.substract(e).length()<=this.radius+this.tolerance)return new HitTestResult(this._data.hittestResult,i.data)}return null},SelectionRendererArrowsUpDown=function(e){SelectionRenderer.call(this,e)},inherit(SelectionRendererArrowsUpDown,SelectionRenderer),SelectionRendererArrowsUpDown.prototype._drawMarker=function(e,t,i){var n=t.isUp?1:-1,o=W54.prototype._calculateVerticalOffset(this._data.barSpacing),r=W54.prototype._calculateMinHeight(this._data.barSpacing);i=i+n*o+n*r,e.beginPath(),e.arc(t.x+.5,t.y+.5+i,SelectionRenderer.RADIUS,0,2*Math.PI,!0),e.closePath(),e.fill(),e.stroke()},CompositeRenderer.prototype.append=function(e){this._renderers.append(e)},CompositeRenderer.prototype.insert=function(e,t){this._renderers.insert(e,t)},CompositeRenderer.prototype.draw=function(e){for(var t=0;t<this._renderers.size();t++)e.save(),this._renderers.item(t).draw(e),e.restore()},CompositeRenderer.prototype.drawBackground=function(e){for(var t=0;t<this._renderers.size();t++)this._renderers.item(t).drawBackground&&this._renderers.item(t).drawBackground(e)},CompositeRenderer.prototype.hitTest=function(e){for(var t=this._renderers.size()-1;t>=0;t--){var i=this._renderers.item(t).hitTest(e);if(i)return i}return!1},SelectionIndexes.DENSITY=10,SelectionIndexes.prototype.calc=function(e,t){for(var i=new List,n=e;t>=n;n++)0===n%SelectionIndexes.DENSITY&&i.append(n);return i},inherit(W48,PriceAxisView),W48.prototype.update=function(){this._invalidated=!0},W48.prototype.setActive=function(e){this._active=e},W48.prototype._updateImpl=function(){if(this._visible=!1,this._text="",this.D0.timeScale()&&!this.D0.timeScale().isEmpty()&&this._linetool.priceScale()&&!this._linetool.priceScale().isEmpty()&&!(this.D0.selectedSource()!==this._linetool&&!this._linetool.customization.forcePriceAxisLabel||this.D0.timeScale().visibleBars().isEmpty()||this._linetool.points().size()<=this._pointIndex)){var e=this._linetool.points().item(this._pointIndex);if(isFinite(e.price)){var t=this._linetool.priceScale();if(t.isPercent()){var i=this._linetool.ownerSource().firstValue();if(!isNumber(i))return;e.price=t.priceRange().convertToPercent(e.price,i)}this._text=t.formatter().format(e.price),this._coordinate=t.priceToCoordinate(e.price),this._textHeight=t.m_markBuilder.fontHeight(),this._visible=!0}}},W48.prototype.renderer=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),new PriceAxisViewRenderer({text:this._text,coordinate:this._coordinate,color:this._color,borderColor:this._borderColor,background:this._active?this._activeBackground:this._background,textHeight:this._textHeight,visible:this._visible})},W48.prototype.text=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.text.call(this)},inherit(LineToolTimeAxisView,TimeAxisView),LineToolTimeAxisView.prototype.setActive=function(e){this._active=e},LineToolTimeAxisView.prototype.update=function(){this._invalidated=!0},LineToolTimeAxisView.prototype.updateImpl=function(){if(this._visible=!1,!(this.D0.timeScale().isEmpty()||this._linetool.points().size()<=this._pointindex||this._linetool!==this.D0.selectedSource())){this._text="";var e=this._linetool.points().item(this._pointindex).index;this._coordinate=this.D0.timeScale().indexToCoordinate(e),(e=this.D0.timeScale().indexToUserTime(e))&&(this._text=new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(e)),this._visible=!0,this._invalidated=!1}},LineToolTimeAxisView.prototype.renderer=function(){return this._invalidated&&this.updateImpl(),new TimeAxisViewRenderer({text:this._text,coordinate:this._coordinate,color:this._color,background:this._active?this._activeBackground:this._background,borderColor:this._borderColor,textHeight:this._textHeight,visible:this._visible})},inherit(W47,DataSource),W47.LINEEND_NORMAL=0,W47.LINEEND_ARROW=1,W47.LINEEND_CIRCLE=2,W47.PointPriceProperty=function(e,t){Property.call(this),this._lineSource=e,this._pointIndex=t},inherit(W47.PointPriceProperty,Property),W47.prototype.getType=function(){return TradingView.className(this.constructor)},W47.prototype.getConstructor=function(){return this._constructor||null},W47.prototype.isActualSymbol=function(){return this._isActualSymbol},W47.prototype.calcIsActualSymbol=function(){var e=this.D2,t=this.D0.mainSeries(),i=t.symbolInfo();this._isActualSymbol=i&&e.symbolInfo?e.symbolInfo.listed_exchange.value()===i.listed_exchange&&e.symbolInfo.short_name.value()===i.name:e.symbol.value()===t.symbol()||e.symbol.value().split(":").slice(-1)[0]===t.symbol().split(":").slice(-1)[0]},W47.PointPriceProperty.prototype.value=function(){var e=this._lineSource.points().item(this._pointIndex).price;return parseFloat(this._lineSource.priceScale().formatter().format(e))},W47.PointPriceProperty.prototype.setValue=function(e){var t=this._lineSource.points().item(this._pointIndex);t.price=parseFloat(e),this._lineSource.setPoint(this._pointIndex,t),this._lineSource.D0.updateSource(this._lineSource),this._listeners.fire(this),this._lineSource.endChanging(!0)},W46=function(e,t){Property.call(this),this._lineSource=e,this._pointIndex=t},inherit(W46,Property),W46.prototype.value=function(){return this._lineSource.points().item(this._pointIndex).index},W46.prototype.setValue=function(e){var t=this._lineSource.points().item(this._pointIndex);if(t.index=e,e=this._lineSource.priceScale(),e.isPercent()){var i=this._lineSource.ownerSource().firstValue();t.price=e.priceRange().convertToPercent(t.price,i)}this._lineSource.setPoint(this._pointIndex,t),this._lineSource.D0.updateSource(this._lineSource),this._listeners.fire(this),this._lineSource.endChanging(!0)},W47.prototype._createPointsProperties=function(){this.D2.addProperty("points");for(var e=this.D2.points,t=0;t<this.pointsCount();t++){e.addProperty(t);var i=e[t];i.addProperty("price"),i.price=new W47.PointPriceProperty(this,t),i.addProperty("bar"),i.bar=new W46(this,t)}},W47.prototype.priceScale=function(){return this._ownerSource?this._ownerSource.m_priceScale:null},W47.prototype.symbol=function(){return this.D2.symbol.value()},W47.prototype.properties=function(){return this.D2},W47.prototype.isSavedInStudyTemplates=function(){return!1},W47.prototype.state=function(e){var t={type:TradingView.className(this.constructor),id:this.id(),state:this.properties().state(),points:this._timePoint.toArray(),zorder:this.zorder()};return delete t.state.points,e&&(t.indexes=this._points.toArray()),this.ownerSource()&&(t.ownerSource=this.ownerSource().id()),this.isFixed()&&(t.positionPercents=(this._positionPercents||this.calcPositionPercents()).toArray()),"version"in this&&1!==this.version&&(t.version=this.version),this.hasAlert.value()&&(t.alertId=this._alertId),t},W47.prototype.template=function(){var e=this.properties().state();return delete e.points,delete e.symbol,delete e.symbolInfo,e},W47.prototype.restoreTemplate=function(e){delete e.symbolInfo,this.D0._undoModel.drawingLoadTemplate(this,e)},W47.prototype.clearData=function(){this._points=new List},W47.prototype.currentPointsetId=function(){return"pointset_"+this._currentPointsetId},W47.prototype.stop=function(){this._currentPointsetId&&(this.D0.chartApi().removePointset(this.currentPointsetId()),this._currentPointsetId=null),this.hasAlert.value()&&TradingView.alertsDispatcher.deleteAlert(this._alertId)},W47.prototype.isStarted=function(){return!!this._currentPointsetId},W47.prototype.restart=function(){this.isFixed()||(this._currentPointsetId=0,this.createServerPoints())},W47.prototype.tryCreateServerPoints=function(){this.isFixed()||this._currentPointsetId||this.createServerPoints()},W47.prototype.normalizePoint=function(e){var t=this.D0.timeScale().normalizeBarIndex(e.index);return t.price=e.price,t},W47.prototype.normalizePoints=function(){this._timePoint.clear();for(var e=0;e<this._points.size();e++){var t=this.D0.timeScale().normalizeBarIndex(this._points.item(e).index);if(!t.time_t){this._timePoint.clear();break}t.price=this._points.item(e).price,this._timePoint.append(t)}},W47.prototype.denormalizeTimePoints=function(){for(var e=[],t=0;t<this._timePoint.size();t++){var i=this.D0.timeScale().denormalizeTimePoint(this._timePoint.item(t));if(void 0===i){e=[];break}e.push({index:i,price:this._timePoint.item(t).price})}0<e.length&&(this._points=new List(e))},W47.prototype.restorePoints=function(e,t,i){this._timePoint=new List(e),this._points=new List(t),i||this.denormalizeTimePoints()},W47.prototype.restorePositionPercents=function(e){this._positionPercents=new List(e)},W47.prototype.propertiesChanged=function(){this.updateAllViews(),this.D0.updateSource(this)},W47.prototype.points=function(){for(var e=[],t=0;t<this._points.size();t++){var i=this._points.item(t);e.push({index:i.index,price:i.price,time:i.time})}return this._lastPoint&&e.push({index:this._lastPoint.index,price:this._lastPoint.price,time:this._lastPoint.time}),e=new List(e),this._currentMovingPoint&&this._startMovingPoint&&this.correctPoints(e),e},W47.prototype.fixedPoints=function(){var e=new List;if(this._positionPercents&&!this.priceScale().isEmpty())for(var t=0;t<this._positionPercents.size();t++){var i=this._positionPercents.item(t),n=this.D0.timeScale().width()*i.x,i=this.priceScale().height()*i.y;e.append(new MathEx.Point(n,i))}else for(t=0;t<this._fixedPoints.size();t++)e.append(this._fixedPoints.item(t).clone());return this._lastPoint&&e.append(this._lastPoint.clone()),this._currentMovingPoint&&this._startMovingPoint&&this.correctFixedPoints(e),e},W47.prototype.addPoint=function(e,t){t&&t.shift&&2<=this.points().size()&&this.D2.snapTo45Degrees&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2));var i=this.priceScale();if(i.isPercent()){var n=this.ownerSource().firstValue();e.price=i.priceRange().convertFromPercent(e.price,n)}return this._points.append(e),(i=this._points.size()==this.pointsCount())?(this._lastPoint=null,this.normalizePoints(),this.createServerPoints()):this._lastPoint=e,i},W47.prototype.addFixedPoint=function(e){return this._fixedPoints.append(e),(e=this._fixedPoints.size()==this.pointsCount())&&this.calcPositionPercents(),e},W47.prototype.calcPositionPercents=function(){if(!this.priceScale()||this.priceScale().isEmpty())return new List;this._positionPercents=new List;for(var e=0;e<this._fixedPoints.size();e++){var t=this._fixedPoints.item(0),i=t.x/this.D0.timeScale().width(),t=t.y/this.priceScale().height();this._positionPercents.append({x:i,y:t})}return this._positionPercents},W47.prototype.restoreFixedPoints=function(){
this._fixedPoints=this.fixedPoints()},W47.prototype.onData=function(e){if(e.params.customId===this.currentPointsetId()&&0!==e.params.plots.length){for(var t=0;t<e.params.plots.length;t++){var i=e.params.plots[t],n=this._timePoint.item(i.index),n={index:i.value[0],time:new Date(1e3*i.value[1]),price:n.price};this._points.size()<=i.index?this._points.append(n):this._points.setItem(i.index,n)}this.checkAlert&&this.checkAlert(),this.updateAllViews(),this.D0.updateSource(this)}},W47.prototype.correctPricesToPercents=function(){for(var e=this.priceScale(),t=this.ownerSource().firstValue(),i=0;i<this._points.size();i++){var n=this._points.item(i);n.price=e.priceRange().convertFromPercent(n.price,t)}},W47.prototype.startChanging=function(e,t){e<this.m_priceAxisViews.size()&&this.m_priceAxisViews.item(e).setActive(!0),e<this.m_timeAxisViews.size()&&this.m_timeAxisViews.item(e).setActive(!0)},W47.prototype.setPoint=function(e,t,i){if(i&&i.shift&&this.D2.snapTo45Degrees&&(i=0===e?1:e-1,this._snapPoint45Degree(t,this.points().item(i))),i=this.priceScale(),i.isPercent()){var n=this.ownerSource().firstValue();t.price=i.priceRange().convertFromPercent(t.price,n)}this._points.setItem(e,t),this.normalizePoints()},W47.prototype.startMoving=function(e){this.isFixed()&&this.restoreFixedPoints();var t=this.priceScale();if(t.isPercent()){var i=this.ownerSource().firstValue();e.price=t.priceRange().convertFromPercent(e.price,i)}this._startMovingPoint=e},W47.prototype.move=function(e){var t=this.priceScale();if(t.isPercent()){var i=this.ownerSource().firstValue();e.price=t.priceRange().convertFromPercent(e.price,i)}this._currentMovingPoint=e,this.updateAllViews()},W47.prototype.correctPoints=function(e){for(var t=this._currentMovingPoint.index-this._startMovingPoint.index,i=this._currentMovingPoint.price-this._startMovingPoint.price,n=0;n<e.size();n++){var o=e.item(n);o.index+=t,o.price+=i,e.setItem(n,o)}},W47.prototype.correctFixedPoints=function(e){for(var t=this._currentMovingPoint.substract(this._startMovingPoint),i=0;i<e.size();i++)e.setItem(i,e.item(i).add(t))},W47.prototype.endMoving=function(){this.D2.interval.setValue(this.D0.mainSeries().interval());var e=!1,t=!1;this._currentMovingPoint&&this._startMovingPoint&&(e=this._currentMovingPoint.index!=this._startMovingPoint.index,t=this._currentMovingPoint.price!=this._startMovingPoint.price,this.isFixed()?this.correctFixedPoints(this._fixedPoints):this.correctPoints(this._points),this._currentMovingPoint=this._startMovingPoint=null),this.isFixed()?(this.calcPositionPercents(),this.updateAllViews()):(this.normalizePoints(),this.updateAllViews(),e&&this.createServerPoints(),(t||e)&&this.synchronizeAlert(!0))},W47.prototype.endChanging=function(e){this.D2.interval.setValue(this.D0.mainSeries().interval()),this.normalizePoints(),this.createServerPoints();for(var t=0;t<this.m_priceAxisViews.size();t++)this.m_priceAxisViews.item(t).setActive(!1);for(t=0;t<this.m_timeAxisViews.size();t++)this.m_timeAxisViews.item(t).setActive(!1);this.synchronizeAlert(!e)},W47.prototype.paneViews=function(e){if(!this._isActualSymbol||!this.D2.visible.value()||TradingView.drawingState.hideAllDrawings().value()&&this.userEditEnabled())return null;e=new List;for(var t=this._paneViews.length-1;t>=0;--t)e.append(this._paneViews[t]);return e},W47.prototype.dataWindowView=function(){return null},W47.prototype.statusView=function(){return null},W47.prototype.priceAxisViews=function(e,t){if(this._isActualSymbol&&e.D19().contains(this)&&t===this.priceScale()){var i=new List;if(this.D0.lineBeingEdited()===this){var n=this.D0.linePointBeingEdited();if(n<this.m_priceAxisViews.size()){var i=this.m_priceAxisViews.clone(),o=i.item(n);return i.removeAt(n),i.append(o),i}}return this.m_priceAxisViews}return null},W47.prototype.timeAxisViews=function(){if(this.D0.lineBeingEdited()===this){var e=this.D0.linePointBeingEdited();if(e<this.m_timeAxisViews.size()){var t=this.m_timeAxisViews.clone(),i=t.item(e);return t.removeAt(e),t.append(i),t}}return this.m_timeAxisViews},W47.prototype.updateAllViews=function(){if(!this._isActualSymbol||!this.D2.visible.value())return null;var e=this.paneViews();if(null!==e)for(var e=e.toArray(),t=0;t<e.length;t++)e[t].update();for(e=this.m_priceAxisViews.toArray(),t=0;t<e.length;t++)e[t].update();for(e=this.m_timeAxisViews.toArray(),t=0;t<e.length;t++)e[t].update()},W47.prototype.setLastPoint=function(e,t){t&&t.shift&&2<=this.points().size()&&this.D2.snapTo45Degrees&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2));var i=this.priceScale();if(i.isPercent()){var n=this.ownerSource().firstValue();e.price=i.priceRange().convertFromPercent(e.price,n)}this._lastPoint=e,this.updateAllViews()},W47.prototype.setLastFixedPoint=function(e){this._lastFixedPoint=e,this.updateAllViews()},W47.prototype.title=function(){return"Line Tool"},W47._pointSetId=1,W47.prototype.start=function(){this.createServerPoints()},W47.prototype.tryRemoveOffsetFromPoints=function(){var e=this.D0.timeScale();if(e&&!e.isEmpty())for(var t=e.points().lastTimePointIndex(),i=e.points().valueAt(t),n=0;n<this._timePoint.size();n++){var o=this._timePoint.item(n);if(0!==o.offset&&!(o.time_t>=i)){var r=e.points().indexOf(o.time_t,!0);r+o.offset<=t?(o.time_t=e.points().valueAt(r+o.offset),o.offset=0):(o.time_t=i,o.offset-=t-r)}}},W47.prototype.createServerPoints=function(){if(!this._recursiveGuard&&this._isActualSymbol&&this.D0.chartApi().connected()&&(this._currentPointsetId&&this.D0.chartApi().removePointset(this.currentPointsetId()),!this.D0.timeScale().isEmpty()&&(0===this._timePoint.size()&&this.normalizePoints(),0!==this._timePoint.size()))){this.tryRemoveOffsetFromPoints(),this._currentPointsetId=++W47._pointSetId;for(var e=this.D0.mainSeries().symbolId(),t=this.properties().interval.value(),i=[],n=0;n<this._timePoint.size();n++){var o=this._timePoint.item(n);i.push([o.time_t,o.offset])}var r=this;this.D0.chartApi().createPointset(this.currentPointsetId(),"turnaround",e,t,i,function(e){r.onData(e)})}},W47.prototype.isBeingEdited=function(){return this===this.D0.lineBeingEdited()||this===this.D0.sourceBeingMoved},W47.prototype.isFixed=function(){return this.properties().locked&&this.properties().locked.value()},W47.prototype.isLocked=W47.prototype.isFrozen=function(){return this.properties().frozen&&this.properties().frozen.value()},W47.prototype._tooltipFieldsHash={},W47.prototype._tooltipFieldsOrder="time price index time0 price0 time1 price1 time2 price2 time3 price3 time4 price4 distance term pointsPerBar".split(" "),W47.prototype._tooltipFieldsOrdered=null,W47.prototype._formatTooltip=function(){return null===this._tooltipFieldsOrdered&&(this._tooltipFieldsOrdered=new OrderedHash(this._tooltipFieldsHash,OrderedHash.byOrder(this._tooltipFieldsOrder))),this._tooltipFieldsOrdered.array.filter(function(e){return null!==e.value&&""!==e.value}).map(function(e){return"<span>"+e.title+":</span> "+e.value}).join("<br />")},W47.prototype.pointToScreenPoint=function(e){var t=this.D0.timeScale(),i=this.priceScale();if(!i||i.isEmpty()||t.isEmpty())return new MathEx.Point(0,0);var n=null;if(i.isPercent()){if(!this.ownerSource())return;if(n=this.ownerSource().firstValue(),null===n||!isFinite(n))return}var o=t.indexToCoordinate(e.index,!0),r=e.price;i.isPercent()&&(r=i.priceRange().convertToPercent(r,n));var s=i.priceToCoordinate(r,!0),n=new MathEx.Point(o,s),o=t.indexToCoordinate(e.index,!1),s=i.priceToCoordinate(r,!1);return e=new MathEx.Point(o,s),[n,e]},W47.prototype.screenPointToPoint=function(e){var t=this.D0.timeScale(),i=this.priceScale(),t=t.coordinateToIndex(e.x);e=i.coordinateToPrice(e.y);var n=null;if(i.isPercent()){if(!this.ownerSource())return;if(n=this.ownerSource().firstValue(),null===n||!isFinite(n))return}return i.isPercent()&&(e=i.priceRange().convertFromPercent(e,n)),{price:e,index:t}},W47.prototype.tags=function(){return[this._constructor]},W47.prototype._snapPoint45Degree=function(e,t,i){var n=this.D0.timeScale(),o=n.indexToCoordinate(t.index),r=n.indexToCoordinate(e.index)-o,s=this.m_priceScale,a=t.price,l=e.price;firstValue=this.ownerSource().firstValue(),s.isPercent()&&(a=s.priceRange().convertToPercent(a,firstValue));var d=s.priceToCoordinate(a),l=s.priceToCoordinate(l)-d;switch(Math.round(Math.atan2(r,l)/Math.PI*4)){case 2:case-2:if(!i){e.price=a;break}case 0:case 4:case-4:if(!i){e.index=t.index;break}default:a=Math.sqrt(r*r+l*l),i=0>r?-1:1,t=0>l?-1:1,r=Math.max(Math.abs(l),Math.abs(r)),l=r*Math.sqrt(2)/a,r=Math.round(n.coordinateToIndex(o+r/l*i)),correctedDiff=Math.abs(n.indexToCoordinate(r)-o),n=s.coordinateToPrice(d+correctedDiff*t),e.index=r,e.price=n}},W47.prototype.createPriceAxisView=function(e){return new W48(this,e)},W47.prototype.version=1,W47.isLineTool=function(e){return(e=TradingView[e])?isInherited(e,W47):!1},W47.prototype.alertId=function(){return this._alertId},W47.prototype.setAlert=function(e,t,i,n){if(this.canHasAlert()&&(e=e instanceof TradingView.Alert?e.id():parseInt(e),!isNaN(e))){t="function"==typeof t?t:function(){};var o=function(){A83.showGoProDialog({feature:"savedChartsForAlertLimit"}),"function"==typeof i&&i()};this._alertId=e,this._alert=null,this.hasAlert.setValue(!0),this._processAlertHanders("unsubscribe"),this._processAlertHanders("subscribe"),n?t():window.saver?saver.saveChartSilently(t,!1,o,{noDefaultOnFail:!0}):t()}},W47.prototype._processAlertHanders=function(e){function t(e){this.synchronizeAlert(!1)}e="subscribe"===e?"subscribe":"unsubscribe",TradingView.alertsDispatcher.alertDeleted[e](this,this.removeAlert),TradingView.alertsDispatcher.alertDeletingStarted[e](this,this.removeAlert),TradingView.alertsDispatcher.alertDeletingAllStarted[e](this,this.removeAlert),TradingView.alertsDispatcher.alertHovered[e](function(){var e=this.D0.hoveredSource(),e=e&&e.canHasAlert()&&e.alertId(),t=TradingView.alertsDispatcher.alertHovered.value(),t=t&&t.id();t===this._alertId&&t!==e?this.D0.setHoveredSource(this):t!==this._alertId&&this._alertId===e&&this.D0.setHoveredSource(null)}.bind(this)),TradingView.alertsDispatcher.alertSelected[e](function(){var e=this.D0.selectedSource(),e=e&&e.canHasAlert()&&e.alertId(),t=TradingView.alertsDispatcher.alertSelected.value(),t=t&&t.id();t===this._alertId&&t!==e?this.D0.setSelectedSource(this):t!==this._alertId&&this._alertId===e&&this.D0.setSelectedSource(null)}.bind(this)),this.properties().extendLeft&&this.properties().extendRight&&(this.properties().extendLeft[e](this,t),this.properties().extendRight[e](this,t))},W47.prototype.removeAlert=function(e){e&&e!==this._alertId||(delete this._alertId,delete this._alert,this.hasAlert.setValue(!1),this._processAlertHanders("unsubscribe"))},W47.prototype.getAlert=function(e,t){var i={};i.success="function"==typeof e?e:function(){},i.cacheOnly="boolean"==typeof t?t:void 0,this.hasAlert.value()?TradingView.alertsDispatcher?TradingView.alertsDispatcher.requestAlert(this._alertId,i):console.error("[Alerts] Can't get alert without alert alerts dispatcher"):_callback(null)},W47.prototype.synchronizeAlert=function(e){var t=this;t.hasAlert.value()&&t.getAlert(function(i){if(i){var n=t.D2.interval.value();n!==i.resolution()&&i.resolution(n),i.extra().drawing(t),t.needSynchronizeAlertWithServer=!0,e&&(i.generateScript(!0),restartAlert(i,null,function(){t.needSynchronizeAlertWithServer=!1}))}})},W47.prototype.stateForAlert=function(){if(this.canHasAlert()){var e=this.state();e.uniqueId=this.uniqueId(),e.title=this.title();var t=this._getAlertPlots();return t&&(e.plots=t),e}},W47.prototype._getAlertPlots=function(){return null},W47.prototype._linePointsToAlertPlot=function(e,t,i,n){if(2!==e.length)return console.error("[Drawing Alert] Wrong points"),null;var o=this.D0.timeScale();return!o||o.isEmpty()?null:{type:"LinePlot",title:t||this.title(),timestamp:Math.round(o.indexToTimePoint(0).getTime()/1e3),offset1:e[0].index,offset2:e[1].index,price1:e[0].price,price2:e[1].price,extendBackward:i||!1,extendForward:n||!1}},W47.prototype.getAlertIsActive=function(e){this.getAlert(function(t){e(t?t.active():!1)},!0)},A63=function(e,t,i,n){var o=new $92(this,e);t.push(o),W47.call(this,e,t,i),this.properties().listeners().subscribe(this,A63.prototype.changeStyles),this._constructor=n,this._inputs=this._graphics=this._metaInfo=this._indexes=this._nonseriesdata=this._studyId=null},inherit(A63,W47),A63.prototype.pointsCount=function(){throw Error("Reimplement this in a child class")},A63.prototype.title=function(){return this._metaInfo.description},A63.prototype.studyId=function(){return this._metaInfo.id},A63.prototype._requestStudy=function(){throw Error("Reimplement this in a child class")},A63.prototype.changeStyles=function(){if(this._inputs){var e,t=A0.splitInputs(this.properties().inputs.state()),t=t.obj;for(e in t)if(t[e]!==this._inputs[e]){this._inputs=t,this._requestStudy();break}}else{var t=A0.splitInputs(this.properties().inputs.state());this._inputs=TradingView.clone(t.obj),this._requestStudy()}},A63.prototype._checkTurnaround=function(e){return e===this._turnaround||e==this.D0.mainSeries()._turnaround||e===this.D0.mainSeries()._turnaround+"_"+this._turnaround},A63.prototype.stop=function(){W47.prototype.stop.call(this),this._studyId&&this.D0.chartApi().removeStudy(this._studyId)},A63.prototype.onData=function(e){throw Error("Reimplement this in a child class")},A63.prototype._correctedPoint=function(e){var t=parseInt(this.D0.mainSeries().bars().first(),10),i=parseInt(this.D0.mainSeries().bars().last(),10);return e.index=Math.max(e.index,t),e.index=Math.min(e.index,i),e},A63.prototype.addPoint=function(e){return W47.prototype.addPoint.call(this,this._correctedPoint(e))},A63.prototype.setLastPoint=function(e){return W47.prototype.setLastPoint.call(this,this._correctedPoint(e))},A63.prototype.move=function(e){},A63.prototype.clearData=function(){this._indexes=this._nonseriesdata=null,this._graphics=new A62(this._metaInfo),this.updateAllViews()},A63.prototype.state=function(e){var t=W47.prototype.state.call(this,e);return e&&(t.nonseriesdata=this._nonseriesdata,t.nonseriesindexes=this._indexes,t.graphics=this._graphics.graphics()),this.metaInfo()instanceof StudyMetaInfo?t.metaInfo=this.metaInfo().state():(t.metaInfo=$.extend({},this.metaInfo()),t.metaInfo.id=StudyMetaInfo.parseIdString(t.metaInfo.id+(t.metaInfo.version?"-"+t.metaInfo.version:"")).fullId),t},A63.prototype.restoreData=function(e){this._nonseriesdata=e.nonseriesdata?e.nonseriesdata:null,this._indexes=e.nonseriesindexes?e.nonseriesindexes:null,this._graphics.setGraphics(e.graphics?e.graphics:A62.emptyGraphics())},A63.prototype.setPoint=function(e,t){this._indexes=this._nonseriesdata=null,W47.prototype.setPoint.call(this,e,this._correctedPoint(t))},A63.prototype.disconnect=function(){this._studyId=0},A63.prototype.graphics=function(){return this._graphics.graphics()},A63.prototype.firstValue=function(){return this.D0.mainSeries().data().firstValue()},A63.prototype.formatter=function(){return this.D0.mainSeries().data().formatter()},A63.prototype.metaInfo=function(){return this._metaInfo},inherit($92,$90),$92.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||this.W99._nonseriesdata||this.W99._graphics&&!this.W99._graphics.isEmpty())return e;var t=this._points.item(0),i=this._points.item(1);Math.min(t.x,i.x),Math.max(t.x,i.x);var n={};return n.points=(new List).append(t),n.color="#808080",n.linewidth=this.W99._doNotNeedLine?0:1,n.linestyle=CanvasEx.LINESTYLE_SOLID,e.append(new VertLineRenderer(n)),n={},n.points=(new List).append(i),n.color="#808080",n.linewidth=this.W99._doNotNeedLine?0:1,n.linestyle=CanvasEx.LINESTYLE_SOLID,e.append(new VertLineRenderer(n)),t={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:"#808080",linewidth:this.W99._doNotNeedLine?0:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t)),e},inherit(W31,$90),W31.prototype.renderer=function(){var e=new CompositeRenderer;return this.isAnchorsRequired()&&(e.append(new SelectionRenderer({points:this._points})),e.append(this.createLineAnchor({points:this._points}))),e},A67=function(e){this._data=e},A67.prototype.hitTest=function(e){return null},A67.prototype.draw=function(e){e.font=this._data.textHeight+" Arial",e.fillStyle=this._data.backColor;var t=e.measureText(this._data.text).width,i=this._data.pos;"left"==this._data.align&&(i=t+4+2-1),e.save(),e.translate(.5,.5),e.fillRect(i-4-2-t,this._data.coordinate-this._data.textHeight/2-1,t+4+2,this._data.textHeight+2),e.fillStyle=this._data.color,e.textBaseline="middle",e.fillText(this._data.text,i-2-t,this._data.coordinate),e.restore()},TradingView.W38=function(e,t,i,n){this.D0=e,this.W99=t,this._plotIndex=i,this._getterName=n?n:"symbol",this._cache={},this._invalidated=!0},TradingView.W38.prototype.update=function(){this._invalidated=!0},TradingView.W38.prototype.updateImpl=function(){this._visible=!1;var e=this.W99.lastValueData(this._plotIndex,!1);e&&this.W99.priceScale().properties().showSymbolLabels.value()&&(this._visible=!0,this._coordinate=e.coordinate,this._color=e.color,this._text=this.W99[this._getterName](),this._textHeight=this.W99.priceScale().m_markBuilder.fontHeight())},TradingView.W38.prototype.renderer=function(){if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),!this._visible)return new CompositeRenderer;var e=this.D0.paneForSource(this.W99),t="right";e.leftPriceScale()==this.W99.priceScale()&&(t="left");var i=this.D0.properties();return(e=!e.leftPriceScale().mainSource()||!e.rightPriceScale().mainSource())&&i.scalesProperties.showLeftScale.value()&&!i.scalesProperties.showRightScale.value()&&(t="left"),e||("left"!=t||i.scalesProperties.showLeftScale.value())&&("right"!=t||i.scalesProperties.showRightScale.value())?(i=this._coordinate,this.W99.lastPriceLabelFixedCoordinate&&(i=this.W99.lastPriceLabelFixedCoordinate()||i),t={coordinate:i,backColor:this._color,color:new RGBColor(this._color).blackWhiteContrast(),text:this._text,pos:this.D0.timeScale().width(),textHeight:this._textHeight,align:t},new A67(t)):new CompositeRenderer},PoligonRenderer.prototype.draw=function(e){if(!this._data.points.isEmpty()){e.beginPath(),e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t=this._data.points.item(0);for(e.moveTo(t.x,t.y),t=0;t<this._data.points.size();t++){var i=this._data.points.item(t);e.lineTo(i.x,i.y)}this._data.filled&&this._data.fillBackground&&(e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill()),this._data.filled&&!this._data.skipClosePath&&e.closePath(),0<this._data.linewidth&&e.stroke()}},PoligonRenderer.prototype.hitTest=function(e){if(void 0!==this._data.mouseTouchable&&!this._data.mouseTouchable)return null;for(var t=TradingView.isMobile.any()?24:3,i=1;i<this._data.points.size();i++){var n=this._data.points.item(i-1),o=this._data.points.item(i);if(MathEx.distanceToSegment(n,o,e).distance<=t)return this._hittest}return this._data.filled&&this._data.fillBackground&&MathEx.isInPolygon(this._data.points,e)?this._hittest:null},TradingView.$60=function(e,t){$90.call(this,e,t)},inherit(TradingView.$60,$90),TradingView.$60.prototype.renderer=function(){if(this._pattern&&2==this.W99.points().size()){var e=this.W99.points().item(0).index,t=this.W99.points().item(1).index,t=t>e?this._points.item(0):this._points.item(1);if(!t)return new CompositeRenderer;var i=Math.abs((this._points.item(0).x-this._points.item(1).x)/(this._pattern.length-1));if(this.W99.properties().mode.value()==TradingView.LineToolBarsPattern.BARS_MODE){e=new CompositeRenderer,new List;for(var n=0;n<this._pattern.length;n++){var o=Math.round(t.x+n*i+.5),r=t.y+Math.round(this._pattern[n].high),s=t.y+Math.round(this._pattern[n].low),a={};a.points=(new List).append(new MathEx.Point(o-1,r)).append(new MathEx.Point(o+1,s)),a.color=this.W99.properties().color.value(),a.linewidth=1,a.backcolor=this.W99.properties().color.value(),a.fillBackground=!0,a.transparency=10,e.append(new RectangleRenderer(a))}}else e=new CompositeRenderer,a={},a.barSpacing=i,a.items=this._pattern,a.histogramBase=0,a.lineIndex=0,a.lineColor=generateColor(this.W99.properties().color.value(),10),a.lineStyle=CanvasEx.LINESTYLE_SOLID,a.lineWidth=2,a.hittest=new HitTestResult(HitTestResult.MOVEPOINT),e.append(new W68(a));this.isAnchorsRequired()&&e.append(this.createLineAnchor({points:this._points}))}else{if(e=new CompositeRenderer,2>this._points.size())return e;t=this._points.item(0),i=this._points.item(1),Math.min(t.x,i.x),Math.max(t.x,i.x),n={},n.points=(new List).append(t),n.color="#808080",n.linewidth=1,n.linestyle=CanvasEx.LINESTYLE_SOLID,e.append(new VertLineRenderer(n)),n={},n.points=(new List).append(i),n.color="#808080",n.linewidth=1,n.linestyle=CanvasEx.LINESTYLE_SOLID,e.append(new VertLineRenderer(n)),t={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t))}return e},TradingView.$60.prototype.update=function(){if($90.prototype.update.call(this),!(!this.W99.priceScale()||this.W99.priceScale().isEmpty()||2>this._points.size()))if(this.W99._pattern&&0<this.W99._pattern.length&&2==this.W99.points().size()){var e=Math.abs((this._points.item(0).x-this._points.item(1).x)/(this.W99._pattern.length-1)),t=this.W99.priceScale(),i=this.W99._pattern;if(this.W99.properties().mode.value()==TradingView.LineToolBarsPattern.BARS_MODE){if(this._pattern=[],t.isPercent()){for(var n=this.W99.ownerSource().firstValue(),o=[],r=t.priceRange(),s=i.length;s--;)o[s]=[],o[s][HIGH_PLOT]=r.convertToPercent(i[s][HIGH_PLOT],n),o[s][LOW_PLOT]=r.convertToPercent(i[s][LOW_PLOT],n);i=o}for(n=t.priceToCoordinate(i[0][HIGH_PLOT]),s=0;s<i.length;s++)e=t.priceToCoordinate(i[s][HIGH_PLOT])-n,o=t.priceToCoordinate(i[s][LOW_PLOT])-n,this._pattern.push({high:e,low:o})}else{if(this._pattern=new List,t.isPercent()){for(n=this.W99.ownerSource().firstValue(),o=[],r=t.priceRange(),s=i.length;s--;)o[s]=[],o[s][CLOSE_PLOT]=r.convertToPercent(i[s][CLOSE_PLOT],n);i=o}for(n=t.priceToCoordinate(i[0][CLOSE_PLOT]),s=this.W99.points().item(0).index,o=this.W99.points().item(1).index,o=this._points.item(s>o?1:0),r=o.x,s=0;s<i.length;s++){var a=o.y+t.priceToCoordinate(i[s][CLOSE_PLOT])-n,a=new MathEx.Point(r+s*e,a);this._pattern.append(a)}}}else delete this._pattern},TradingView.LineToolBarsPattern=function(e,t){this._constructor="LineToolBarsPattern";var i=t?t:new $52("linetoolbarspattern");W47.call(this,e,new TradingView.$60(this,e),i),i.mirrored.listeners().subscribe(this,TradingView.LineToolBarsPattern.prototype.mirror),i.flipped.listeners().subscribe(this,TradingView.LineToolBarsPattern.prototype.flip),i.addExclusion("mirrored"),i.addExclusion("flipped")},inherit(TradingView.LineToolBarsPattern,W47),TradingView.LineToolBarsPattern.BARS_MODE=0,TradingView.LineToolBarsPattern.LINE_MODE=1,TradingView.LineToolBarsPattern.prototype.additionalActions=function(e){var t=new Action({checked:this.properties().mirrored.value(),checkable:!0,text:$.t("Mirrored"),callbackContext:{target:this}}),i=new Action({checked:this.properties().flipped.value(),checkable:!0,text:$.t("Flipped"),callbackContext:{target:this}});return t.callbacks().subscribe(null,function(t){t=t.callbackContext().target,e.setProperty(t.properties().mirrored,!t.properties().mirrored.value(),"Bats Pattern Mirroring"),t.updateAllViews(),t.D0.updateSource(t)}),i.callbacks().subscribe(null,function(t){t=t.callbackContext().target,e.setProperty(t.properties().flipped,!t.properties().flipped.value(),"Bats Pattern Flipping"),t.updateAllViews(),t.D0.updateSource(t)}),[t,i]},TradingView.LineToolBarsPattern.prototype.pointsCount=function(){return 2},TradingView.LineToolBarsPattern.prototype.state=function(e){return e=W47.prototype.state.call(this,e),e.pattern=this._pattern,e},TradingView.LineToolBarsPattern.prototype.restoreData=function(e){e.pattern&&(this._pattern=e.pattern)},TradingView.LineToolBarsPattern.prototype.title=function(){return"Bars Pattern"},TradingView.LineToolBarsPattern.prototype.cloneData=function(e){this._pattern=TradingView.clone(e._pattern)},TradingView.LineToolBarsPattern.prototype.mirror=function(){for(var e=this._pattern,t=e[0][HIGH_PLOT],i=Math.min(e[0][LOW_PLOT],e[0][HIGH_PLOT]),n=Math.max(e[0][LOW_PLOT],e[0][HIGH_PLOT]),o=1;o<e.length;o++)i=Math.min(i,e[o][LOW_PLOT]),n=Math.max(n,e[o][HIGH_PLOT]);if(n>i)for(i=(i+n)/2,o=0;o<e.length;o++)e[o][HIGH_PLOT]=i-(e[o][HIGH_PLOT]-i),e[o][LOW_PLOT]=i-(e[o][LOW_PLOT]-i),e[o][OPEN_PLOT]=i-(e[o][OPEN_PLOT]-i),e[o][CLOSE_PLOT]=i-(e[o][CLOSE_PLOT]-i);t=e[0][HIGH_PLOT]-t,e=e[e.length-1][LOW_PLOT]-e[0][HIGH_PLOT],this._points.item(0).price+=t,this._points.item(1).price=this._points.item(0).price+e,this.updateAllViews()},TradingView.LineToolBarsPattern.prototype.flip=function(){this._points.item(0).price=this._points.item(1).price;for(var e=0;e<this._pattern.length/2;e++){var t=this._pattern[e];this._pattern[e]=this._pattern[this._pattern.length-e-1],this._pattern[this._pattern.length-e-1]=t}e=this._pattern[this._pattern.length-1][LOW_PLOT]-this._pattern[0][HIGH_PLOT],this._points.item(1).price=this._points.item(0).price+e,this.updateAllViews()},TradingView.LineToolBarsPattern.prototype.addPoint=function(e,t){var i=this.D0.mainSeries(),n=i.nearestIndex(e.index,SEARCH_NEAREST_RIGHT);if(this.properties().mode.value()==TradingView.LineToolBarsPattern.BARS_MODE?e.price=i.bars().valueAt(n)[HIGH_PLOT]:e.price=i.bars().valueAt(n)[CLOSE_PLOT],n=this.priceScale().priceRange().length(),e.price+=.05*n,n=i.priceScale(),n.isPercent()&&(i=i.firstValue(),e.price=n.priceRange().convertToPercent(e.price,i)),i=W47.prototype.addPoint.call(this,e,t)){var n=Math.min(this.points().item(0).index,this.points().item(1).index),o=Math.max(this.points().item(0).index,this.points().item(1).index),n=this.D0.mainSeries().nearestIndex(n,SEARCH_NEAREST_RIGHT),o=this.D0.mainSeries().nearestIndex(o,SEARCH_NEAREST_LEFT);for(this.points().item(0).index>this.points().item(1).index&&(this._points.item(0).price=this._points.item(1).price),this._pattern=[];o>=n;n++){var r=this.D0.mainSeries().data().valueAt(n);this._pattern.push(TradingView.clone(r))}}return i},TradingView.LineToolBarsPattern.prototype.setPoint=function(e,t,i){var n=this._points.item(0).price-this._points.item(1).price;1==e&&t.index<=this._points.item(0).index&&(t.index=this._points.item(0).index+1),0==e&&t.index>=this._points.item(1).index&&(t.index=this._points.item(1).index-1),W47.prototype.setPoint.call(this,e,t,i),1==e?this._points.item(0).price=this._points.item(1).price+n:this._points.item(1).price=this._points.item(0).price-n},inherit($66,$90),$66.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||2>this.W99.points().size())return e;var t=this.W99.properties();if(t.fillBackground&&t.fillBackground.value()){var i={};i.points=this._points,i.color="white",i.linewidth=0,i.backcolor=t.backgroundColor.value(),i.fillBackground=!0,i.transparency=t.backgroundTransparency.value(),e.append(new RectangleRenderer(i))}var n=this,o=function(t,i){var o={};o.points=(new List).append(t).append(i),o.width=n.D0.timeScale().width(),o.height=n.W99.priceScale().height(),o.color=n.W99.properties().linecolor.value(),o.linewidth=n.W99.properties().linewidth.value(),o.linestyle=CanvasEx.LINESTYLE_SOLID,o.extendleft=!1,o.extendright=!1,o.leftend=W47.LINEEND_NORMAL,o.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(o))},r=this._points.item(0),s=this._points.item(1),s=new MathEx.Point(r.x,s.y);o(r,s),r=this._points.item(0),s=this._points.item(1),r=new MathEx.Point(s.x,r.y),o(r,s);var r=this._points.item(0),s=this._points.item(1),i=(r.y+s.y)/2,o=new MathEx.Point(r.x,i),a=new MathEx.Point(s.x,i),i={};i.points=(new List).append(o).append(a),i.width=n.D0.timeScale().width(),i.height=n.W99.priceScale().height(),i.color=n.W99.properties().linecolor.value(),i.linewidth=n.W99.properties().linewidth.value(),i.linestyle=CanvasEx.LINESTYLE_DASHED,i.extendleft=!1,i.extendright=!1,i.leftend=W47.LINEEND_NORMAL,i.rightend=W47.LINEEND_ARROW,e.append(new TrendLineRenderer(i));var i=this.W99.points().item(0).index,a=this.W99.points().item(1).index,o=a-i,i=this.D0.timeScale().indexToUserTime(i),l=this.D0.timeScale().indexToUserTime(a),a="";return i&&l&&(i=(l.valueOf()-i.valueOf())/1e3,a=", "+(new TimeSpanFormatter).format(i)),i={},i.points=(new List).append(r.add(s).scaled(.5)),i.text=$.t("{0} bars").format(o)+a,i.color=t.textcolor.value(),i.font=t.font.value(),i.offsetX=0,i.offsetY=0,i.vertAlign="top",i.horzAlign="center",i.backgroundRoundRect=0,i.backgroundHorzInflate=.4*t.fontsize.value(),i.backgroundVertInflate=.2*t.fontsize.value(),i.fontsize=t.fontsize.value(),t.fillLabelBackground&&t.fillLabelBackground.value()&&(i.backgroundColor=t.labelBackgroundColor.value(),i.backgroundTransparency=1-t.labelBackgroundTransparency.value()/100||0),t.drawBorder&&t.drawBorder.value()&&(i.borderColor=t.borderColor.value()),e.append(new TextRenderer(i,this._rendererCache)),this.isAnchorsRequired()&&e.append(this.createLineAnchor({points:this._points})),e},TradingView.LineToolDateRange=function(e,t){this._constructor="LineToolDateRange";var i=t?t:new $52("linetooldaterange");W47.call(this,e,new $66(this,e),i)},inherit(TradingView.LineToolDateRange,W47),TradingView.LineToolDateRange.prototype.pointsCount=function(){return 2},TradingView.LineToolDateRange.prototype.title=function(){return"Date Range"},inherit(W6,$90),W6.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||2>this.W99.points().size())return e;var t=this.W99.properties();if(t.fillBackground&&t.fillBackground.value()){var i={};i.points=this._points,i.color="white",i.linewidth=0,i.backcolor=t.backgroundColor.value(),i.fillBackground=!0,i.transparency=t.backgroundTransparency.value(),e.append(new RectangleRenderer(i))}var n=this,i=function(t,i){var o={};o.points=(new List).append(t).append(i),o.width=n.D0.timeScale().width(),o.height=n.W99.priceScale().height(),o.color=n.W99.properties().linecolor.value(),o.linewidth=n.W99.properties().linewidth.value(),o.linestyle=CanvasEx.LINESTYLE_SOLID,o.extendleft=!1,o.extendright=!1,o.leftend=W47.LINEEND_NORMAL,o.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(o))},o=this._points.item(0),r=this._points.item(1),r=new MathEx.Point(r.x,o.y);i(o,r),o=this._points.item(0),r=this._points.item(1),o=new MathEx.Point(o.x,r.y),i(o,r);var o=this._points.item(0),r=this._points.item(1),i=(o.x+r.x)/2,s=new MathEx.Point(i,o.y),a=new MathEx.Point(i,r.y),i={};i.points=(new List).append(s).append(a),i.width=n.D0.timeScale().width(),i.height=n.W99.priceScale().height(),i.color=n.W99.properties().linecolor.value(),i.linewidth=n.W99.properties().linewidth.value(),i.linestyle=CanvasEx.LINESTYLE_DASHED,i.extendleft=!1,i.extendright=!1,i.leftend=W47.LINEEND_NORMAL,i.rightend=W47.LINEEND_ARROW,e.append(new TrendLineRenderer(i));var s=this.W99.points().item(0).price,a=this.W99.points().item(1).price,i=a-s,l=100*i/s,l=this.W99.priceScale().formatter().format(i)+" ("+Math.round(100*l)/100+"%)",i={};return a>s?(s=r.clone(),s.y-=2*t.fontsize.value(),s.x=.5*(o.x+r.x)):(s=r.clone(),s.x=.5*(o.x+r.x),s.y+=.7*t.fontsize.value()),i.points=(new List).append(s),i.text=l,i.color=t.textcolor.value(),i.font=t.font.value(),i.offsetX=0,i.offsetY=0,i.vertAlign="middle",i.horzAlign="center",i.fontsize=t.fontsize.value(),i.backgroundRoundRect=0,i.backgroundHorzInflate=.4*t.fontsize.value(),i.backgroundVertInflate=.2*t.fontsize.value(),t.fillLabelBackground&&t.fillLabelBackground.value()&&(i.backgroundColor=t.labelBackgroundColor.value(),i.backgroundTransparency=1-t.labelBackgroundTransparency.value()/100||0),t.drawBorder&&t.drawBorder.value()&&(i.borderColor=t.borderColor.value()),
e.append(new TextRenderer(i,this._rendererCache)),this.isAnchorsRequired()&&e.append(this.createLineAnchor({points:this._points})),e},TradingView.LineToolPriceRange=function(e,t){this._constructor="LineToolPriceRange";var i=t?t:new $52("linetoolpricerange");W47.call(this,e,new W6(this,e),i)},inherit(TradingView.LineToolPriceRange,W47),TradingView.LineToolPriceRange.prototype.pointsCount=function(){return 2},TradingView.LineToolPriceRange.prototype.title=function(){return"Price Range"},ParallelChannelRenderer.prototype.extendPoints=function(e,t,i,n){var o=new MathEx.Point(0,0);return i=new MathEx.Point(i,n),this._data.extendleft&&(n=e.substract(t),(n=MathEx.intersectRayWithRect(e,e.add(n),o,i))&&(e=n)),this._data.extendright&&(n=t.substract(e),(n=MathEx.intersectRayWithRect(t,t.add(n),o,i))&&(t=n)),this._data.extendleft&&!MathEx.pointInRect(e,o,i)&&MathEx.pointInRect(t,o,i)&&(n=MathEx.intersectRayWithRect(t,e,o,i))&&(e=n),this._data.extendright&&!MathEx.pointInRect(t,o,i)&&MathEx.pointInRect(e,o,i)&&(n=MathEx.intersectRayWithRect(e,t,o,i))&&(t=n),[e,t]},ParallelChannelRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t=this._data.points.item(0),i=this._data.points.item(1),t=this.extendPoints(t,i,this._data.width,this._data.height);if(this._data.skipLines||CanvasEx.drawLine(e,t[0].x,t[0].y,t[1].x,t[1].y),4==this._data.points.size()){var i=this._data.points.item(2),n=this._data.points.item(3);if(i&&n){if(i=this.extendPoints(i,n,this._data.width,this._data.height),this._data.skipLines||this._data.skipTopLine||CanvasEx.drawLine(e,i[0].x,i[0].y,i[1].x,i[1].y),this._data.fillBackground){var n=Math.max(t[1].x,i[1].x),o=Math.max(t[1].y,i[1].y),r=Math.min(i[0].x,t[0].x),s=Math.min(i[0].y,t[0].y);if(!(isFinite(n)&&isFinite(o)&&isFinite(r)&&isFinite(s)))return;e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),this._data.extendright&&(n=MathEx.optionalCorner(t[1],i[1],this._data.width,this._data.height))&&e.lineTo(n.x,n.y),e.lineTo(i[1].x,i[1].y),e.lineTo(i[0].x,i[0].y),this._data.extendleft&&(n=MathEx.optionalCorner(i[0],t[0],this._data.width,this._data.height))&&e.lineTo(n.x,n.y),e.lineTo(t[0].x,t[0].y),e.fill()}this._data.showMidline&&!this._data.skipLines&&(e.strokeStyle=this._data.midcolor,e.lineWidth=this._data.midlinewidth,e.lineStyle=this._data.midlinestyle,t=this._data.points.item(0).add(this._data.points.item(2)).scaled(.5),i=this._data.points.item(1).add(this._data.points.item(3)).scaled(.5),i=this.extendPoints(t,i,this._data.width,this._data.height),(t=TrendLineRenderer.prototype.lineClipping(i[0],i[1],this._data.width,this._data.height))&&CanvasEx.drawLine(e,Math.round(t[0].x),Math.round(t[0].y),Math.round(t[1].x),Math.round(t[1].y)))}}}},ParallelChannelRenderer.prototype.hitTest=function(e){if(2>this._data.points.size())return null;if(this._data.floatPoints)var t=this._data.floatPoints.item(0),i=this._data.floatPoints.item(1);else t=this._data.points.item(0),i=this._data.points.item(1);var n=this.extendPoints(t,i,this._data.width,this._data.height),n=MathEx.distanceToSegment(n[0],n[1],e);if(3>=n.distance)return new HitTestResult(HitTestResult.MOVEPOINT);if(this._data.floatPoints)var o=this._data.floatPoints.item(2),r=this._data.floatPoints.item(3);else o=this._data.points.item(2),r=this._data.points.item(3);if(4==this._data.points.size()&&!this._data.skipTopLine){if(!o||!r)return null;if(n=this.extendPoints(o,r,this._data.width,this._data.height),n=MathEx.distanceToSegment(n[0],n[1],e),3>=n.distance)return new HitTestResult(HitTestResult.MOVEPOINT);if(this._data.showMidline&&!this._data.skipLines){var n=this._data.points.item(0).add(this._data.points.item(2)).scaled(.5),s=this._data.points.item(1).add(this._data.points.item(3)).scaled(.5),n=this.extendPoints(n,s,this._data.width,this._data.height),n=MathEx.distanceToSegment(n[0],n[1],e);if(3>=n.distance)return new HitTestResult(HitTestResult.MOVEPOINT)}}return this._data.hittestOnBackground&&this._data.fillBackground&&4==this._data.points.size()&&(t=(new List).append(t).append(i).append(r).append(o),MathEx.isInPolygon(t,e))?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit($98,$90),$98.prototype.update=function(){if($90.prototype.update.call(this),this.W99.priceScale()&&!this.W99.priceScale().isEmpty()&&0!=this.W99.points().size()&&(this.W99._priceOffset||this.W99.calculatePriceDiff(),3===this._points.size()&&this.W99._priceOffset)){var e=this._points.item(0),t=this._points.item(1),i=this.W99._priceOffset+this.W99.points().item(0).price,n=this.W99._priceOffset+this.W99.points().item(1).price;this._p3=e.clone(),this._p4=t.clone(),e=this.W99.priceScale(),e.isLog()?(e=.5*(i+n)-this.W99._priceOffset,i=.5*(i+n),n=this.W99.priceScale().priceToCoordinate(e),i=this.W99.priceScale().priceToCoordinate(i)-n,this._p3.y+=i,this._p4.y+=i):(e.isPercent()&&(t=this.W99.ownerSource().firstValue(),i=e.priceRange().convertToPercent(i,t),n=e.priceRange().convertToPercent(n,t)),this._p3.y=this.W99.priceScale().priceToCoordinate(i),this._p4.y=this.W99.priceScale().priceToCoordinate(n))}},$98.prototype.renderer=function(){var e={};e.points=new List,1<this._points.size()&&(e.points.append(this._points.item(0)),e.points.append(this._points.item(1))),2<this._points.size()&&(e.points.append(this._p3),e.points.append(this._p4)),e.color=this.W99.properties().linecolor.value(),e.width=this.D0.timeScale().width(),e.height=this.W99.priceScale().height();var t=this.W99.properties();e.linewidth=t.linewidth.value(),e.linestyle=t.linestyle.value(),e.extendleft=t.extendLeft.value(),e.extendright=t.extendRight.value(),e.fillBackground=t.fillBackground.value(),e.backcolor=t.backgroundColor.value(),e.transparency=t.transparency.value(),e.showMidline=t.showMidline.value(),e.midlinewidth=t.midlinewidth.value(),e.midlinestyle=t.midlinestyle.value(),e.midcolor=t.midlinecolor.value(),e.fillBackground=t.fillBackground.value(),e.hittestOnBackground=TradingView.isMobile.any();var i=new CompositeRenderer;if(i.append(new ParallelChannelRenderer(e)),this.isAnchorsRequired()){e=new List,e.append(this._points.item(0)),this._points.item(1)&&e.append(this._points.item(1)),this._p3&&(e.append(this._p3.add(this._p4).scaled(.5)),e.item(2).data=2);var n=3==this._points.size()&&!this._p3;this.D0.lineBeingCreated()!=this.W99||n||e.removeAt(e.size()-1),i.append(this.createLineAnchor({points:e}))}if(!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&2<=this._points.size()){var o=this._points;this.W99.getAlertIsActive(function(e){i.append(new PaneRendererClockIcon({point1:o.item(0),point2:o.item(1),color:e?t.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))})}return i},TradingView.LineToolParallelChannel=function(e,t){this._constructor="LineToolParallelChannel";var i=t?t:new $52("linetoolparallelchannel");W47.call(this,e,new $98(this,e),i)},inherit(TradingView.LineToolParallelChannel,W47),TradingView.LineToolParallelChannel.prototype.addPoint=function(e){if(e=W47.prototype.addPoint.call(this,e)){var t=this.points().item(0);this._points.item(2).index=t.index,this._points.item(2).price=t.price+this._priceOffset}return e},TradingView.LineToolParallelChannel.prototype.calculatePriceDiff=function(){if(3===this.points().size()){var e=this.points().item(0),t=this.points().item(1),i=this.points().item(2);if(e.index!==t.index){var n=this.priceScale();if(null!==n)if(n.isLog()){var o=this.D0.timeScale();if(!o.isEmpty()){var r=o.indexToCoordinate(e.index),s=o.indexToCoordinate(t.index),e=n.priceToCoordinate(e.price),t=n.priceToCoordinate(t.price),o=o.indexToCoordinate(i.index);n.priceToCoordinate(i.price),r=e+(t-e)/(s-r)*(o-r),i=n.priceToCoordinate(i.price)-r,e=.5*(e+t),r=n.coordinateToPrice(e),this._priceOffset=n.coordinateToPrice(e+i)-r}}else n=(t.price-e.price)/(t.index-e.index),this._priceOffset=i.price-(e.price+n*(i.index-e.index))}}},TradingView.LineToolParallelChannel.prototype.setLastPoint=function(e,t){t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(0)),W47.prototype.setLastPoint.call(this,e),this.calculatePriceDiff()},TradingView.LineToolParallelChannel.prototype.restorePoints=function(e,t,i){W47.prototype.restorePoints.call(this,e,t,i),e&&3<=e.length&&(this._priceOffset=e[2].price-e[0].price)},TradingView.LineToolParallelChannel.prototype.setPoint=function(e,t,i){i&&i.shift&&2>e&&this._snapPoint45Degree(t,this.points().item(1-e)),W47.prototype.setPoint.call(this,e,t,i),2===e&&this.calculatePriceDiff(),e=this.points().item(0),this._points.item(2).index=e.index,this._points.item(2).price=e.price+this._priceOffset},TradingView.LineToolParallelChannel.prototype.pointsCount=function(){return 3},TradingView.LineToolParallelChannel.prototype.title=function(){return"Parallel Channel"},TradingView.LineToolParallelChannel.prototype.addPoint=function(e,t){return t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(0)),W47.prototype.addPoint.call(this,e,t)},TradingView.LineToolParallelChannel.prototype.fixAfterRestorePriceAxis=function(){this.priceScale().isLog()||delete this._priceOffset},TradingView.LineToolParallelChannel.prototype.cloneData=function(e){this._priceOffset=e._priceOffset},TradingView.LineToolParallelChannel.prototype.restoreData=function(e){e.priceOffset&&(this._priceOffset=e.priceOffset)},TradingView.LineToolParallelChannel.prototype.state=function(e){return e=W47.prototype.state.call(this,e),e.priceOffset=this._priceOffset,e},TradingView.LineToolParallelChannel.prototype.canHasAlert=function(){return!0},TradingView.LineToolParallelChannel.prototype._getAlertPlots=function(){function e(e,t){return e.index<=t.index?[e,t]:[t,e]}var t,i=this._points.clone().toArray().splice(0,2),i=i.concat([{price:i[0].price+this._priceOffset,time:i[0].time,index:i[0].index},{price:i[1].price+this._priceOffset,time:i[1].time,index:i[1].index}]),n=e(i[0],i[1]),o=e(i[2],i[3]);0>this._priceOffset?t=o:(t=n,n=o);var o=this.properties().extendLeft.value(),r=this.properties().extendRight.value();return i[0].index<=i[1].index?(i=o,o=r):i=r,[this._linePointsToAlertPlot(n,"Upper",i,o),this._linePointsToAlertPlot(t,"Lower",i,o)]},function(){var e,t={priceRange:{width:15,height:14,data:[134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255]},barsRange:{width:16,height:15,data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,136,136,136,56,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,136,136,136,56,134,134,138,255,134,134,138,255,136,136,136,56,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,136,136,136,56,134,134,138,255,134,134,138,255,136,136,136,56,134,134,138,255,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,134,134,138,255,136,136,136,56,134,134,138,255,134,134,138,255,136,136,136,56,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,136,136,136,56,134,134,138,255,134,134,138,255,137,137,137,74,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,137,137,137,74,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},angle:{width:14,height:12,data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,130,130,134,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255,134,134,138,255]}};TrendLineStatsRenderer.prototype._preRender=function(){if(!this._preRendered){if(!e){var t=document.createElement("canvas");t.width=0,t.height=0,e=t.getContext("2d")}this._data.points.item(0);var i=textX=this._data.points.item(0).x+(this._data.offsetX||0),n=textY=this._data.points.item(0).y+(this._data.offsetY||0),o=this._fontSize,t=this._lineSpacing,r=(o+t)*this._lines.length-t;e.textBaseline="top",e.font=this.fontStyle();var s,t=[];if(this._data.wordWrapWidth){s=this._data.wordWrapWidth;for(var a=0;a<this._lines.length;a++)t.push(this._data.wordWrapWidth)}else for(a=s=0;a<this._lines.length;a++){var l=e.measureText(this._lines[a]).width;t.push(l),s=Math.max(s,l)}if(this._data.backgroundColor||this._data.borderColor||this._data.highlightBorder&&this._data.wordWrapWidth){var l={top:this._data.paddingTop||0,right:this._data.paddingRight||0,bottom:this._data.paddingBottom||0,left:this._data.paddingLeft||0},d=0,h=0;this._data.backgroundHorzInflate&&(d=this._data.backgroundHorzInflate/2,l.left+=d,l.right+=d,d=-d),this._data.backgroundVertInflate&&(h=this._data.backgroundVertInflate/2,l.top+=h,l.bottom+=h,h=-h),o="number"==typeof this._data.padding?this._data.padding:~~(o/6);for(a in l)l[a]||(l[a]=o);r={x:Math.floor(i+d),y:Math.floor(n+h),w:Math.ceil(s+l.left+l.right),h:Math.ceil(r+l.top+l.bottom)},textX+=l.left+d,textY+=l.top+h,("bottom"==this._data.vertAlign||"middle"==this._data.vertAlign)&&(n="middle"==this._data.vertAlign?n-r.h/2:n-r.h-(r.y-n),textY+=n-r.y,r.y=n),("right"==this._data.horzAlign||"center"==this._data.horzAlign)&&(i="center"==this._data.horzAlign?i-r.w/2:i-r.w-(r.x-i),textX+=i-r.x,r.x=i,!0!==this._data.doNotAlignText&&("right"==this._data.horzAlign?(e.textAlign="end",textX+=s):(e.textAlign="center",textX+=s/2))),0!=r.w%2&&r.w++,r.x+=.5,r.y+=.5,this._boundingRect=[new MathEx.Point(r.x,r.y),new MathEx.Point(r.x+r.w,r.y+r.h)],this._rect=r,this._padding=l,this._defaultPadding=o}else("bottom"==this._data.vertAlign||"middle"==this._data.vertAlign)&&(textY-=Math.round(r*("middle"==this._data.vertAlign?.5:1))),i=textX,("right"==this._data.horzAlign||"center"==this._data.horzAlign)&&(i-=Math.round(s*("center"==this._data.horzAlign?.5:1))),this._boundingRect=[new MathEx.Point(i,textY),new MathEx.Point(i+s,textY+r)];this._textPoint={x:textX,y:textY},this._textSizeCache&&(this._textSizeCache.widths=t),this._preRendered=!0}},TrendLineStatsRenderer.prototype._drawIcon=function(e,i,n,o){if(t.hasOwnProperty(o)){if(o=t[o],!o.src){o.src=document.createElement("canvas"),o.src.width=o.width,o.src.height=o.height;for(var r=o.src.getContext("2d"),s=r.createImageData(o.width,o.height),a=0;a<o.data.length;a++)s.data[a]=o.data[a];r.putImageData(s,0,0)}e.drawImage(o.src,i,n)}}}(),TrendLineStatsRenderer.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._fontSize+"px "+this._data.font},TrendLineStatsRenderer.prototype.draw=function(e){if(0!==this._data.points.size()){this._preRender();var t=this._fontSize,i=t+this._lineSpacing;if(e.textBaseline="top",e.font=this.fontStyle(),(this._data.backgroundColor||this._data.borderColor||this._data.highlightBorder&&this._data.wordWrapWidth)&&this._rect){var n=this._rect;if("right"!=this._data.horzAlign&&"center"!=this._data.horzAlign||!0===this._data.doNotAlignText||(e.textAlign="right"==this._data.horzAlign?"end":"center"),this._data.backgroundRoundRect){if(e.roundRect(n.x,n.y,n.w,n.h,this._data.backgroundRoundRect),this._data.backgroundColor&&(e.fillStyle=this._data.backgroundColor,e.globalAlpha=this._data.backgroundTransparency,e.fill(),e.globalAlpha=1),this._data.borderColor){var o="number"==typeof this._data.borderWidth?this._data.borderWidth:~~Math.max(t/12,1);e.strokeStyle=this._data.borderColor,e.lineWidth=o,e.stroke()}}else if(this._data.backgroundColor&&(e.fillStyle=this._data.backgroundColor,e.globalAlpha=this._data.backgroundTransparency,e.fillRect(n.x,n.y,n.w,n.h),e.globalAlpha=1),this._data.borderColor)o="number"==typeof this._data.borderWidth?this._data.borderWidth:~~Math.max(t/12,1),e.strokeStyle=this._data.borderColor,e.lineWidth=o,e.strokeRect(n.x-o/2,n.y-o/2,n.w+o,n.h+o);else if(this._data.highlightBorder){e.strokeStyle=this._data.color,e.lineWidth=1,e.beginPath();var r=[3,1];e.dashedLineTo(n.x-.5,o=n.y-.5,t=n.x+n.w+.5,o,r),e.dashedLineTo(t,o,t,o=n.y+n.h+.5,r),e.dashedLineTo(t=n.x-.5,o,n.x+n.w+.5,o,r),e.dashedLineTo(t,n.y-.5,t,o,r),e.globalAlpha=.5,e.stroke(),e.globalAlpha=1}this._data.icons&&this._data.icons.forEach(function(t,o){this._drawIcon(e,n.x+this._defaultPadding,n.y+this._padding.top+i*o,t)},this)}else"right"==this._data.horzAlign?e.textAlign="end":"center"==this._data.horzAlign&&(e.textAlign="center");for(o=this._textPoint.x,t=this._textPoint.y,e.fillStyle=this._data.color,r=0;r<this._lines.length;r++)e.fillText(this._lines[r],o,t),t+=i}},TrendLineStatsRenderer.prototype.hitTest=function(e){return 0===this._data.points.size()?null:(this._preRender(),this._boundingRect&&MathEx.pointInRect(e,this._boundingRect[0],this._boundingRect[1])?this._hittest:null)},TrendLineRenderer.prototype.drawArrow=function(e,t,i,n){if(!(1>t.substract(e).length())){var o=t.substract(e).normalized();e=o.scaled(5*n),e=t.substract(e),o=o.transponed().scaled(3*n),n=e.add(o),e=e.substract(o),CanvasEx.drawLine(i,Math.round(n.x),Math.round(n.y),t.x,t.y),CanvasEx.drawLine(i,Math.round(e.x),Math.round(e.y),t.x,t.y)}},TrendLineRenderer.prototype.lineClipping=function(e,t,i,n){return(e=CohenSutherland(e.x,e.y,t.x,t.y,0,0,i,n))?[{x:e[0],y:e[1]},{x:e[2],y:e[3]}]:!1},TrendLineRenderer.prototype.expandPoints=function(e,t,i,n){var o=new MathEx.Point(0,0);return i=new MathEx.Point(i,n),this._data.extendleft&&(n=e.substract(t),(n=MathEx.intersectRayWithRect(e,e.add(n),o,i))&&(e=n)),this._data.extendright&&(n=t.substract(e),(n=MathEx.intersectRayWithRect(t,t.add(n),o,i))&&(t=n)),[e,t]},TrendLineRenderer.prototype.drawCircle=function(e,t,i,n){n=$.extend({fillStyle:"#000000"},n),t.save(),t.fillStyle=n.fillStyle,t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI,!1),t.fill(),n.strokeWidth&&(t.lineWidth=n.strokeWidth,t.stroke()),t.restore()},TrendLineRenderer.prototype.draw=function(e){if(!(this._data.points&&2>this._data.points.size()||this._data.floatPoints&&2>this._data.floatPoints.size())){if(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,this._data.floatPoints)var t=this._data.floatPoints.item(0),i=this._data.floatPoints.item(1);else t=this._data.points.item(0),i=this._data.points.item(1);if(this._data.overlayLineEndings)var n=[$.extend(!0,{},t),$.extend(!0,{},i)];else this.drawEnds(e,[t,i]);t=this.expandPoints(t,i,this._data.width,this._data.height),(t=this.lineClipping(t[0],t[1],this._data.width,this._data.height))&&0<this._data.linewidth&&CanvasEx.drawLine(e,Math.round(t[0].x),Math.round(t[0].y),Math.round(t[1].x),Math.round(t[1].y)),this._data.overlayLineEndings&&this.drawEnds(e,n)}},TrendLineRenderer.prototype.drawEnds=function(e,t){var i=t[0],n=t[1];switch(this._data.leftend){case W47.LINEEND_ARROW:this.drawArrow(n,i,e,e.lineWidth);break;case W47.LINEEND_CIRCLE:this.drawCircle(i,e,e.lineWidth,this._data.endstyle)}switch(this._data.rightend){case W47.LINEEND_ARROW:this.drawArrow(i,n,e,e.lineWidth);break;case W47.LINEEND_CIRCLE:this.drawCircle(n,e,e.lineWidth,this._data.endstyle)}},TrendLineRenderer.prototype.hitTest=function(e){if(this._data.points&&2>this._data.points.size()||this._data.floatPoints&&2>this._data.floatPoints.size())return null;var t=TradingView.isMobile.any()?24:3;if(this._data.floatPoints)var i=this._data.floatPoints.item(0),n=this._data.floatPoints.item(1);else i=this._data.points.item(0),n=this._data.points.item(1);return i=this.expandPoints(i,n,this._data.width,this._data.height),MathEx.distanceToSegment(i[0],i[1],e).distance<=t?this._hittest:null},inherit(W43,$90),W43.prototype.update=function(){this._invalidated=!0},W43.prototype.updateImpl=function(){var e=this.W99.points();if(!(2>e.size())){var t=e.item(0),e=e.item(1),i=this.D0.timeScale().visibleBars();if(void 0!=i&&!i.isEmpty()){i=i.clone(),this._label=null;var n=this.W99.properties();if((!(t.index<i.firstBar()&&e.index<i.firstBar())||n.extendLeft.value()||n.extendRight.value())&&($90.prototype.update.call(this),!(0>this._points.item(0).x&&0>this._points.item(1).x)||n.extendLeft.value()||n.extendRight.value())){var o,r,s,a,l,i=[];this.W99.properties().showPriceRange.value()&&this.W99.priceScale()&&(a=e.price-t.price,o=a/t.price,o=this.W99.priceScale().formatter().format(a)+" ("+(new PercentageFormatter).format(100*o)+")",(n=this.D0.mainSeries().base())&&(n=Math.round(a*n),o+=", "+n),i.push("priceRange"));var n=this.W99.properties().showBarsRange.value(),d=this.W99.properties().showDateTimeRange.value(),h=this.W99.properties().showDistance.value();if(n||d||h){if(r="",n&&(l=e.index-t.index,r+=$.t("{0} bars").format(l)),d){var d=this.D0.timeScale().indexToUserTime(t.index),c=this.D0.timeScale().indexToUserTime(e.index);d&&c&&(d=(c.valueOf()-d.valueOf())/1e3,(d=(new TimeSpanFormatter).format(d))&&(r+=n?" ("+d+")":d))}h&&(r&&(r+=", "),"undefined"==typeof a&&(a=e.price-t.price),"undefined"==typeof l&&(l=e.index-t.index),a=Math.round(1e5*Math.sqrt(a*a+l*l))/1e5,r+=$.t("distance: {0}").format(a)),r&&i.push("barsRange")}if(this.W99.properties().showAngle.value()){var p,t=this.W99.pointToScreenPoint(t),e=this.W99.pointToScreenPoint(e),t=t instanceof Array?t[0]:t instanceof MathEx.Point?t:null,e=e instanceof Array?e[0]:e instanceof MathEx.Point?e:null;t instanceof MathEx.Point&&e instanceof MathEx.Point&&(t=e.substract(t),0<t.length()&&(t=t.normalized(),p=Math.acos(t.x),0<t.y&&(p=-p))),"number"!=typeof p||isNaN(p)||(s=Math.round(180*p/Math.PI)+"º",i.push("angle"))}this._label=[o,r,s].filter(function(e){return e}).join("\n")||null,this._icons=i,this._invalidated=!1}}}},W43.prototype.renderer=function(){this._invalidated&&this.updateImpl();var e=new CompositeRenderer;if(this._invalidated||!this.W99.priceScale())return e;var t={};t.points=this._points,t.floatPoints=this._floatPoints,t.width=this.D0.timeScale().width(),t.height=this.W99.priceScale().height(),t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),t.extendleft=this.W99.properties().extendLeft.value(),t.extendright=this.W99.properties().extendRight.value(),t.leftend=this.W99.properties().leftEnd.value(),t.rightend=this.W99.properties().rightEnd.value(),e.append(new TrendLineRenderer(t));var i=this.isAnchorsRequired();if((i||this.W99.properties().alwaysShowStats.value())&&this._label&&2==this._points.size()){var n={points:(new List).append(this._points.item(1)),text:this._label,color:this.W99.properties().textcolor.value(),font:TradingView.LineToolTrendLine.LABEL_FONT,fontsize:TradingView.LineToolTrendLine.LABEL_FONTSIZE,lineSpacing:TradingView.LineToolTrendLine.LABEL_LINESPACING,backgroundColor:TradingView.LineToolTrendLine.LABEL_BGCOLOR,borderColor:TradingView.LineToolTrendLine.LABEL_BORDERCOLOR,borderWidth:1,padding:TradingView.LineToolTrendLine.LABEL_PADDING,paddingLeft:30,doNotAlignText:!0,icons:this._icons},o=TradingView.LineToolTrendLine.LABEL_OFFSET;this._points.item(1).y<this._points.item(0).y?(n.vertAlign="bottom",n.offsetY=-o):n.offsetY=o,this._points.item(1).x<this._points.item(0).x?(n.horzAlign="right",n.offsetX=-o):n.offsetX=o,e.append(new TrendLineStatsRenderer(n,this._rendererCache))}return i&&(i=t.points.clone(),this.D0.lineBeingCreated()==this.W99&&i.removeAt(i.size()-1),e.append(this.createLineAnchor({points:i}))),!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&2<=t.points.size()&&this.W99.getAlertIsActive(function(i){e.append(new PaneRendererClockIcon({point1:t.points.item(0),point2:t.points.item(1),color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))}),e},TradingView.LineToolTrendLine=function(e,t){this._constructor="LineToolTrendLine";var i=t?t:new $52("linetooltrendline");W47.call(this,e,new W43(this,e),i)},inherit(TradingView.LineToolTrendLine,W47),TradingView.LineToolTrendLine.LABEL_OFFSET=8,TradingView.LineToolTrendLine.LABEL_FONT="Arial",TradingView.LineToolTrendLine.LABEL_FONTSIZE=12,TradingView.LineToolTrendLine.LABEL_LINESPACING=10,TradingView.LineToolTrendLine.LABEL_BGCOLOR="rgba(255,255,255,.8)",TradingView.LineToolTrendLine.LABEL_BORDERCOLOR="#e3e3e3",TradingView.LineToolTrendLine.LABEL_PADDING=8,TradingView.LineToolTrendLine.prototype.pointsCount=function(){return 2},TradingView.LineToolTrendLine.prototype.title=function(){return"Trend Line"},TradingView.LineToolTrendLine.prototype.canHasAlert=function(){return!0},TradingView.LineToolTrendLine.prototype._getAlertPlots=function(){return[this._linePointsToAlertPlot(this._points.toArray(),null,this.properties().extendLeft.value(),this.properties().extendRight.value())]},function(){function e(e,t,i,n,o,r){var s=0;return i>e?s|=1:e>o&&(s|=2),n>t?s|=4:t>r&&(s|=8),s}window.CohenSutherland=function(t,i,n,o,r,s,a,l){for(var d,h,c,p=e(t,i,r,s,a,l),u=e(n,o,r,s,a,l),f=!1,g=0;;){if(g>1e3)throw Error("Cohen - Sutherland algorithm: infinity loop");if(g++,!(p|u)){f=!0;break}if(p&u)break;c=p?p:u,8&c?(d=t+(n-t)*(l-i)/(o-i),h=l):4&c?(d=t+(n-t)*(s-i)/(o-i),h=s):2&c?(h=i+(o-i)*(a-t)/(n-t),d=a):(h=i+(o-i)*(r-t)/(n-t),d=r),c==p?(t=d,i=h,p=e(t,i,r,s,a,l)):(n=d,o=h,u=e(n,o,r,s,a,l))}return f?[t,i,n,o]:!1}}(),RectangleRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t=this._data.points.item(0),i=this._data.points.item(1).substract(t);e.beginPath(),e.rect(t.x,t.y,i.x,i.y),0<this._data.linewidth&&e.stroke(),this._data.fillBackground&&(e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill())}},RectangleRenderer.prototype.hitTest=function(e){if(2>this._data.points.size()||this._data.nohittest)return null;var t=this._data.points.item(0),i=this._data.points.item(1),n=new MathEx.Point(i.x,t.y),o=new MathEx.Point(t.x,n.y),r=MathEx.distanceToSegment(t,n,e);return 3>=r.distance?new HitTestResult(HitTestResult.MOVEPOINT):(r=MathEx.distanceToSegment(n,i,e),3>=r.distance?new HitTestResult(HitTestResult.MOVEPOINT):(r=MathEx.distanceToSegment(i,o,e),3>=r.distance?new HitTestResult(HitTestResult.MOVEPOINT):(r=MathEx.distanceToSegment(o,t,e),3>=r.distance||this._data.fillBackground&&(n=Math.min(t.x,i.x),o=Math.max(t.x,i.x),r=Math.min(t.y,i.y),i=Math.max(t.y,i.y),t=new MathEx.Point(n,r),i=new MathEx.Point(o,i),MathEx.pointInRect(e,t,i))?new HitTestResult(HitTestResult.MOVEPOINT):null)))},inherit(W8,$90),W8.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().color.value(),e.linewidth=this.W99.properties().linewidth.value(),e.backcolor=this.W99.properties().backgroundColor.value(),e.fillBackground=this.W99.properties().fillBackground.value(),e.transparency=this.W99.properties().transparency.value(),this.isAnchorsRequired()){var t=new CompositeRenderer;return t.append(new RectangleRenderer(e)),e=e.points.clone(),this.D0.lineBeingCreated()==this.W99&&e.removeAt(e.size()-1),t.append(this.createLineAnchor({points:e})),t}return new RectangleRenderer(e)},TradingView.LineToolRectangle=function(e,t){
this._constructor="LineToolRectangle";var i=t?t:new $52("linetoolrectangle");W47.call(this,e,new W8(this,e),i)},inherit(TradingView.LineToolRectangle,W47),TradingView.LineToolRectangle.prototype.pointsCount=function(){return 2},TradingView.LineToolRectangle.prototype.title=function(){return"Rectangle"},EllipseRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){var t=this._data.points.item(0),i=this._data.points.item(1);if(3>this._data.points.size())e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke();else{var n=this._data.points.item(2),n=MathEx.distanceToLine(t,i,n).distance;if(1>n)e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke();else{var o=i.substract(t),t=t.add(i).scaled(.5),i=new MathEx.Point(-o.y,o.x),i=i.normalized();t.add(i.scaled(n)),t.add(i.scaled(-n)),e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth;var i=o.length(),r=o.y/i,o=Math.acos(o.x/i);0>r&&(o=-o);var r=this._data.points.item(2),s=MathEx.Matrix.translate(-t.x,-t.y),r=s.mult(r),s=MathEx.Matrix.rotate(-o),r=s.mult(r),s=MathEx.Matrix.scale(1,i/(2*n)),r=s.mult(r);this._data.clockwise=0>r.y?!0:!1,e.save(),e.beginPath(),e.translate(t.x,t.y),e.rotate(o),e.scale(1,2*n/i),e.arc(0,0,.5*i,this._data.angleFrom,this._data.angleTo,this._data.clockwise),e.restore(),e.stroke(),this._data.fillBackground&&(e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill())}}}},EllipseRenderer.prototype._additionalPointTest=function(e,t){return!0},EllipseRenderer.prototype.hitTest=function(e){if(3>this._data.points.size())return null;var t=this._data.points.item(0),i=this._data.points.item(1),n=this._data.points.item(2),n=MathEx.distanceToLine(t,i,n).distance,o=i.substract(t),i=t.add(i).scaled(.5),t=new MathEx.Point(-o.y,o.x),t=t.normalized();i.add(t.scaled(n)),i.add(t.scaled(-n));var t=o.length(),r=o.y/t,o=Math.acos(o.x/t);if(0>r&&(o=-o),r=MathEx.Matrix.translate(-i.x,-i.y),e=r.mult(e),i=r.mult(this._data.points.item(2)),r=MathEx.Matrix.rotate(-o),e=r.mult(e),i=r.mult(i),r=MathEx.Matrix.scale(1,t/(2*n)),e=r.mult(e),i=r.mult(i),n=e.length(),!this._additionalPointTest(e,i))return null;if(this._data.fillBackground&&!this._data.noHitTestOnBackground){if(.5*t>=n)return new HitTestResult(HitTestResult.MOVEPOINT)}else if(3>=Math.abs(n-.5*t))return new HitTestResult(HitTestResult.MOVEPOINT);return null},inherit($69,$90),$69.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t={};if(t.points=this._points,t.color=this.W99.properties().color.value(),t.linewidth=this.W99.properties().linewidth.value(),t.backcolor=this.W99.properties().backgroundColor.value(),t.fillBackground=this.W99.properties().fillBackground.value(),t.transparency=this.W99.properties().transparency.value(),e.append(new EllipseRenderer(t)),this.isAnchorsRequired()){var i=t.points.item(0),n=t.points.item(1);if(2==this._points.size())return this.addAnchors(e),e;var t=t.points.item(2),o=MathEx.distanceToLine(i,n,t).distance,t=n.substract(i),r=i.add(n).scaled(.5),s=new MathEx.Point(-t.y,t.x),s=s.normalized(),t=r.add(s.scaled(o)),o=r.add(s.scaled(-o)),i=new MathEx.Point(i.x,i.y);i.data=0,n=new MathEx.Point(n.x,n.y),n.data=1,t=new MathEx.Point(t.x,t.y),t.data=2,o=new MathEx.Point(o.x,o.y),o.data=3,r=new List,r.append(i).append(n).append(t).append(o),e.append(this.createLineAnchor({points:r}))}return e},TradingView.LineToolEllipse=function(e,t){this._constructor="LineToolEllipse";var i=t?t:new $52("linetoolellipse");W47.call(this,e,new $69(this,e),i),this.version=TradingView.LineToolEllipse.version},inherit(TradingView.LineToolEllipse,W47),TradingView.LineToolEllipse.prototype.startChanging=function(e,t){if(W47.prototype.startChanging.call(this,e,t),0==e||1==e){var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0];this._dist=MathEx.distanceToLine(i,n,o).distance}},TradingView.LineToolEllipse.prototype.setPoint=function(e,t){var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0],r=this.priceScale();if(r.isPercent()){var s=this.ownerSource().firstValue();t.price=r.priceRange().convertFromPercent(t.price,s)}switch(e){case 0:i=this.pointToScreenPoint(t)[0],r=n.substract(i),i=i.add(n).scaled(.5),n=new MathEx.Point(-r.y,r.x),n=n.normalized(),o=i.add(n.scaled(this._dist)),o=this.screenPointToPoint(o),this._points.setItem(0,t),this._points.setItem(2,o);break;case 1:o=MathEx.distanceToLine(i,n,o).distance,n=this.pointToScreenPoint(t)[0],r=n.substract(i),i=i.add(n).scaled(.5),n=new MathEx.Point(-r.y,r.x),n=n.normalized(),o=i.add(n.scaled(this._dist)),o=this.screenPointToPoint(o),this._points.setItem(1,t),this._points.setItem(2,o);break;case 2:t=this.pointToScreenPoint(t)[0],o=MathEx.distanceToLine(i,n,t).distance,r=n.substract(i),i=i.add(n).scaled(.5),n=new MathEx.Point(-r.y,r.x),n=n.normalized(),o=i.add(n.scaled(o)),o=this.screenPointToPoint(o),this._points.setItem(2,o);break;case 3:t=this.pointToScreenPoint(t)[0],o=MathEx.distanceToLine(i,n,t).distance,r=n.substract(i),i=i.add(n).scaled(.5),n=new MathEx.Point(-r.y,r.x),n=n.normalized(),o=i.add(n.scaled(o)),o=this.screenPointToPoint(o),this._points.setItem(2,o)}this.normalizePoints()},TradingView.LineToolEllipse.prototype.pointsCount=function(){return 3},TradingView.LineToolEllipse.prototype.title=function(){return"Ellipse"},TradingView.LineToolEllipse.version=2,TradingView.LineToolEllipse.prototype.migrateVersion=function(e,t,i){1==e&&2==this._points.size()&&(t=this._points.item(0).price,i=.5*(this._points.item(0).price+this._points.item(1).price),this._points.setItem(0,{price:i,index:this._points.item(0).index}),this._points.setItem(1,{price:i,index:this._points.item(1).index}),this._points.append({price:t,index:this._points.item(0).index})),1==e&&2==this._timePoint.size()&&(t=this._timePoint.item(0).price,i=.5*(this._timePoint.item(0).price+this._timePoint.item(1).price),this._timePoint.item(0).price=i,this._timePoint.item(1).price=i,e={price:t,offset:this._timePoint.item(0).offset,time_t:this._timePoint.item(0).time_t},this._timePoint.append(e))},HorzLineRenderer.prototype.draw=function(e){if(0===this._data.points.size())return null;if(!1!==this._data.visible){var t=this._data.points.item(0).y,i=e.canvas.width;e.lineCap="square",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,CanvasEx.drawLine(e,0,t,i,t)}},HorzLineRenderer.prototype.hitTest=function(e){return!1===this._data.visible||0===this._data.points.size()?null:3>=Math.abs(e.y-this._data.points.item(0).y)?new HitTestResult(this._data.hitTestResult):null},inherit($85,$90),$85.prototype.renderer=function(){var e=new CompositeRenderer,t={};t.points=this._points,t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),t.hitTestResult=HitTestResult.MOVEPOINT;var i=this.W99.properties();if(e.append(new HorzLineRenderer(t)),this.W99.properties().showLabel.value()&&1==this._points.size()){var n=i.vertLabelsAlign.value(),o=i.horzLabelsAlign.value(),r=this._points.item(0),s=0,a=0;"left"==o?r.x=3:"right"==o?(r.x=this.D0.timeScale().width(),a=-5):r.x=this.D0.timeScale().width()/2,"middle"==n?s=-this.W99.properties().fontsize.value()/6:"bottom"==n&&(s=-4),i={points:(new List).append(r),text:i.text.value(),color:i.textcolor.value(),vertAlign:n,horzAlign:o,font:i.font.value(),offsetX:a,offsetY:s,bold:this.W99.properties().bold.value(),italic:this.W99.properties().italic.value(),fontsize:this.W99.properties().fontsize.value()},e.append(new TextRenderer(i,this._rendererCache))}if(this.isAnchorsRequired()&&(e.append(new HorzLineRenderer(t)),i=new List,i.append(new MathEx.Point(this.D0.timeScale().width()/2,this._points.item(0).y)),e.append(this.createLineAnchor({points:i,hittestResult:HitTestResult.MOVEPOINT}))),!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&1==this._points.size()){var l=new MathEx.Point(this.D0.timeScale().width()/2,this._points.item(0).y);this.W99.getAlertIsActive(function(i){e.append(new PaneRendererClockIcon({point1:l,color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))})}return e},inherit(LineToolHorzLinePriceAxisView,PriceAxisView),LineToolHorzLinePriceAxisView.prototype.update=function(){this._invaildated=!0},LineToolHorzLinePriceAxisView.prototype.updateImpl=function(){if(0!==this.W99.points().size()&&this.W99.priceScale()&&!this.W99.priceScale().isEmpty()){var e=this.W99.properties().linecolor.value();if(e!=this._background&&(this._background=e,this._color=this.color()),e=this.W99.points().item(0).price,this.W99.priceScale().isPercent()){var t=this.W99.ownerSource().firstValue();if(null===t)return;e=this.W99.priceScale().priceRange().convertToPercent(e,t)}this._floatCoordinate=this.W99.priceScale().priceToCoordinate(e,!0),this._coordinate=Math.round(this._floatCoordinate),this._textHeight=this.W99.priceScale().m_markBuilder.fontHeight(),this.W99.priceScale().formatter()&&(this._text=this.W99.priceScale().formatter().format(e))}},LineToolHorzLinePriceAxisView.prototype.renderer=function(){return this._invaildated&&this.updateImpl(),new PriceAxisViewRenderer({text:this._text,coordinate:this._coordinate,color:this._color,background:this._background,textHeight:this._textHeight,visible:!0})},LineToolHorzLinePriceAxisView.prototype.coordinate=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.coordinate.call(this)},TradingView.LineToolHorzLine=function(e,t){this._constructor="LineToolHorzLine";var i=t?t:new $52("linetoolhorzline");W47.call(this,e,new $85(this,e),i),this._priceAxisView=new LineToolHorzLinePriceAxisView(this,e)},inherit(TradingView.LineToolHorzLine,W47),TradingView.LineToolHorzLine.prototype.pointsCount=function(){return 1},TradingView.LineToolHorzLine.prototype.title=function(){return"Horizontal Line"},TradingView.LineToolHorzLine.prototype.priceAxisViews=function(e,t){return this.isActualSymbol()&&this.D0.paneForSource(this)===e&&t===this.priceScale()&&this.properties().showPrice.value()?(new List).append(this._priceAxisView):null},TradingView.LineToolHorzLine.prototype.updateAllViews=function(){W47.prototype.updateAllViews.call(this),this._priceAxisView.update()},TradingView.LineToolHorzLine.prototype.canHasAlert=function(){return!0},TradingView.LineToolHorzLine.prototype._getAlertPlots=function(){return[this.points().item(0).price]},HorzRayRenderer.prototype.draw=function(e){if(0===this._data.points.size())return null;var t=e.canvas.width,i=this._data.points.item(0).y,n=Math.max(0,this._data.points.item(0).x),t=Math.max(t,this._data.points.item(0).x);e.lineCap="square",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,CanvasEx.drawLine(e,n,i,t,i)},HorzRayRenderer.prototype.hitTest=function(e){return 0===this._data.points.size()||e.x<this._data.points.item(0).x?null:3>=Math.abs(e.y-this._data.points.item(0).y)?new HitTestResult(this._data.hitTestResult):null},inherit($86,$90),$86.prototype.renderer=function(){var e=new CompositeRenderer,t={};t.points=this._points,t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),t.hitTestResult=HitTestResult.MOVEPOINT;var i=this.W99.properties();if(e.append(new HorzRayRenderer(t)),this.W99.properties().showLabel.value()&&1==this._points.size()){var n=i.vertLabelsAlign.value(),o=i.horzLabelsAlign.value(),r=this._points.item(0).clone(),s=0,a=0;"right"==o?(r.x=this.D0.timeScale().width(),a=-5):"center"==o&&(r.x=(r.x+this.D0.timeScale().width())/2),"middle"==n?s=-this.W99.properties().fontsize.value()/6:"bottom"==n&&(s=-4),i={points:(new List).append(r),text:i.text.value(),color:i.textcolor.value(),vertAlign:n,horzAlign:o,font:i.font.value(),offsetX:a,offsetY:s,bold:this.W99.properties().bold.value(),italic:this.W99.properties().italic.value(),fontsize:this.W99.properties().fontsize.value()},e.append(new TextRenderer(i,this._rendererCache))}return this.isAnchorsRequired()&&(i=new List,i.append(this._points.item(0)),e.append(this.createLineAnchor({points:i}))),TradingView.printing||!this.W99.hasAlert.value()||this.D0.readOnly()||1!=this._points.size()||this.W99.getAlertIsActive(function(i){e.append(new PaneRendererClockIcon({point1:t.points.clone().item(0),color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))}),e},inherit(LineToolHorzRayPriceAxisView,PriceAxisView),LineToolHorzRayPriceAxisView.prototype.update=function(){0!==this.W99.points().size()&&this.W99.priceScale()&&!this.W99.priceScale().isEmpty()&&(this._background=this.W99.properties().linecolor.value(),this._coordinate=this.W99.priceScale().priceToCoordinate(this.W99.points().item(0).price),this._textHeight=this.W99.priceScale().m_markBuilder.fontHeight(),this._text=this.W99.priceScale().formatter().format(this.W99.points().item(0).price))},LineToolHorzRayPriceAxisView.prototype.renderer=function(){var e={text:this._text,coordinate:this._coordinate,color:this.color(),background:this._background,textHeight:this._textHeight,visible:!0};return new PriceAxisViewRenderer(e)},TradingView.LineToolHorzRay=function(e,t){this._constructor="LineToolHorzRay";var i=t?t:new $52("linetoolhorzray");W47.call(this,e,new $86(this,e),i),this._priceAxisView=new LineToolHorzRayPriceAxisView(this,e)},inherit(TradingView.LineToolHorzRay,W47),TradingView.LineToolHorzRay.prototype.pointsCount=function(){return 1},TradingView.LineToolHorzRay.prototype.title=function(){return"Horizontal Ray"},TradingView.LineToolHorzRay.prototype.priceAxisViews=function(e,t){return this.symbol()!==this.D0.mainSeries().symbol()?null:this.D0.paneForSource(this)===e&&t===this.priceScale()&&this.properties().showPrice.value()?(new List).append(this._priceAxisView):null},TradingView.LineToolHorzRay.prototype.updateAllViews=function(){W47.prototype.updateAllViews.call(this),this._priceAxisView.update()},TradingView.LineToolHorzRay.prototype.canHasAlert=function(){return!0},TradingView.LineToolHorzRay.prototype._getAlertPlots=function(){var e=this._points.clone().item(0);return[this._linePointsToAlertPlot([e,{index:e.index+1,price:e.price}],null,!1,!0)]},VertLineRenderer.prototype.draw=function(e){if(0!==this._data.points.size()&&!(0>=this._data.linewidth)){var t=this._data.points.item(0).x;e.translate(1,0);var i=e.canvas.width;e.lineCap="square",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,CanvasEx.drawLine(e,t,0,t,i)}},VertLineRenderer.prototype.hitTest=function(e){if(0===this._data.points.size())return null;var t=this._hittest||new HitTestResult(HitTestResult.MOVEPOINT);return 3>=Math.abs(e.x-this._data.points.item(0).x)?t:null},inherit(W45,$90),W45.prototype.renderer=function(){var e={};e.points=this._points,e.color=this.W99.properties().linecolor.value(),e.linewidth=this.W99.properties().linewidth.value(),e.linestyle=this.W99.properties().linestyle.value();var t=new CompositeRenderer;if(t.append(new VertLineRenderer(e)),this.isAnchorsRequired()){var i=new List;i.append(new MathEx.Point(this._points.item(0).x,this.W99.priceScale().height()/2)),t.append(this.createLineAnchor({points:i,hittestResult:HitTestResult.MOVEPOINT}))}if(!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&1==e.points.size()){var n=new MathEx.Point(this._points.item(0).x,this.W99.priceScale().height()/2);this.W99.getAlertIsActive(function(i){t.append(new PaneRendererClockIcon({point1:n,color:i?e.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))})}return t},inherit(LineToolVertLineTimeAxisView,TimeAxisView),LineToolVertLineTimeAxisView.prototype.update=function(){this._invalidated=!0},LineToolVertLineTimeAxisView.prototype.updateImpl=function(){if(!this.D0.timeScale().isEmpty()&&0!==this.W99.points().size()){this._text="",this._background=this.W99.properties().linecolor.value();var e=this.W99.points().item(0).index;this._coordinate=this.D0.timeScale().indexToCoordinate(e),(e=this.D0.timeScale().indexToUserTime(e))&&(this._text=new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(e)),this._invalidated=!1}},LineToolVertLineTimeAxisView.prototype.renderer=function(){this._invalidated&&this.updateImpl();var e={text:this._text,coordinate:this._coordinate,color:this.color(),background:this._background,textHeight:18};return new TimeAxisViewRenderer(e)},TradingView.LineToolVertLine=function(e,t){this._constructor="LineToolVertLine";var i=t?t:new $52("linetoolvertline");W47.call(this,e,new W45(this,e),i),this._timeAxisView=new LineToolVertLineTimeAxisView(this,e)},inherit(TradingView.LineToolVertLine,W47),TradingView.LineToolVertLine.prototype.pointsCount=function(){return 1},TradingView.LineToolVertLine.prototype.title=function(){return"Vertical Line"},TradingView.LineToolVertLine.prototype.timeAxisViews=function(){return this.symbol()!==this.D0.mainSeries().symbol()?null:this.properties().showTime.value()?(new List).append(this._timeAxisView):null},TradingView.LineToolVertLine.prototype.updateAllViews=function(){W47.prototype.updateAllViews.call(this),this._timeAxisView.update()},TradingView.LineToolVertLine.prototype.canHasAlert=function(){return!0},TradingView.LineToolVertLine.prototype._getAlertPlots=function(){var e=this._points.clone().item(0);return[this._linePointsToAlertPlot([e,{index:e.index,price:e.price+1}],null,!0,!0)]},ChannelRenderer.prototype.extendPoints=function(e,t,i){var n=new MathEx.Point(0,-5e3);i=new MathEx.Point(i,5e3);var o=t.substract(e);return(o=MathEx.intersectRayWithRect(t,t.add(o),n,i))&&(t=o),!MathEx.pointInRect(e,n,i)&&MathEx.pointInRect(t,n,i)&&(o=MathEx.intersectRayWithRect(t,e,n,i))&&(e=o),!MathEx.pointInRect(t,n,i)&&MathEx.pointInRect(e,n,i)&&(o=MathEx.intersectRayWithRect(e,t,n,i))&&(t=o),[e,t]},ChannelRenderer.prototype.draw=function(e){var t=e.canvas.width,i=this.extendPoints(this._data.p1,this._data.p2,t),t=this.extendPoints(this._data.p3,this._data.p4,t);e.beginPath(),e.moveTo(i[0].x,i[0].y),e.lineTo(i[1].x,i[1].y),i[1].x<t[1].x&&e.lineTo(t[1].x,i[1].y),e.lineTo(t[1].x,t[1].y),e.lineTo(t[0].x,t[0].y),e.lineTo(i[0].x,i[0].y),e.fillStyle=generateColor(this._data.color,this._data.transparency),e.fill()},ChannelRenderer.prototype.hitTest=function(e){if(!this._data.hittestOnBackground)return null;var t=this._data.width,i=this.extendPoints(this._data.p1,this._data.p2,t),t=this.extendPoints(this._data.p3,this._data.p4,t),n=[new MathEx.Point(i[0].x,i[0].y),new MathEx.Point(i[1].x,i[1].y)];return i[1].x<t[1].x&&n.push(new MathEx.Point(t[1].x,i[1].y)),n.push(new MathEx.Point(t[1].x,t[1].y)),n.push(new MathEx.Point(t[0].x,t[0].y)),n.push(new MathEx.Point(i[0].x,i[0].y)),MathEx.isInPolygon(new List(n),e)?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit(W1,$90),W1.prototype.update=function(){$90.prototype.update.call(this),0!==this._points.size()&&(3===this._points.size()?this._medianPoint=this._points.item(1).add(this._points.item(2)).scaled(.5):2===this._points.size()?this._medianPoint=this._points.item(1):this._medianPoint=this._points.item(0),this._medianPoint.data=3)},W1.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||!this._medianPoint)return e;var t={points:(new List).append(this._points.item(0)).append(this._medianPoint),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(t)),3>this._points.size())return this.addAnchors(e),e;t={points:(new List).append(this._points.item(1)).append(this._points.item(2)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t));for(var t=this._points.item(2).substract(this._points.item(1)).scaled(.5),i=this._medianPoint.substract(this._points.item(0)),n=0,o=this.W99.properties().fillBackground.value(),r=this.W99.properties().transparency.value(),s=0;8>=s;s++){var a="level"+s,a=this.W99.properties()[a];if(a.visible.value()){var l=this._medianPoint.addScaled(t,a.coeff.value()),d=l.add(i),h=this._medianPoint.addScaled(t,-a.coeff.value()),c=h.add(i);if(o){var p={};p.width=this.D0.timeScale().width(),p.p1=l,p.p2=d,p.p3=this._medianPoint.addScaled(t,n),p.p4=p.p3.add(i),p.color=a.color.value(),p.transparency=r,p.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(p)),p={},p.width=this.D0.timeScale().width(),p.p1=h,p.p2=c,p.p3=this._medianPoint.addScaled(t,-n),p.p4=p.p3.add(i),p.color=a.color.value(),p.transparency=r,p.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(p))}n=a.coeff.value(),d={points:(new List).append(l).append(d),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:a.color.value(),linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},l=new HitTestResult(HitTestResult.MOVEPOINT,null,s),e.append(new TrendLineRenderer(d,l)),a={points:(new List).append(h).append(c),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:a.color.value(),linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},l=new HitTestResult(HitTestResult.MOVEPOINT,null,s),e.append(new TrendLineRenderer(a,l))}}return this.addAnchors(e),e},inherit(W12,W1),W12.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(t)),!this._medianPoint||!this._modifiedBase)return this.addAnchors(e),e;var i={points:(new List).append(this._modifiedBase).append(this._medianPoint),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(i)),3>this._points.size())return this.addAnchors(e),e;i={points:(new List).append(this._points.item(1)).append(this._points.item(2)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(i));for(var i=this._points.item(2).substract(this._points.item(1)).scaled(.5),n=this._medianPoint.substract(this._modifiedBase),o=0,r=this.W99.properties().fillBackground.value(),s=this.W99.properties().transparency.value(),a=0;8>=a;a++){var l="level"+a,l=this.W99.properties()[l];if(l.visible.value()){var d=this._medianPoint.addScaled(i,l.coeff.value()),h=d.add(n),c=this._medianPoint.addScaled(i,-l.coeff.value()),p=c.add(n);r&&(t={},t.p1=d,t.p2=h,t.p3=this._medianPoint.addScaled(i,o),t.p4=t.p3.add(n),t.color=l.color.value(),t.transparency=s,e.append(new ChannelRenderer(t)),t={},t.p1=c,t.p2=p,t.p3=this._medianPoint.addScaled(i,-o),t.p4=t.p3.add(n),t.color=l.color.value(),t.transparency=s,e.append(new ChannelRenderer(t))),o=l.coeff.value(),d={points:(new List).append(d).append(h),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l.color.value(),linewidth:l.linewidth.value(),linestyle:l.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t=new HitTestResult(HitTestResult.MOVEPOINT,null,a),e.append(new TrendLineRenderer(d,t)),l={points:(new List).append(c).append(p),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l.color.value(),linewidth:l.linewidth.value(),linestyle:l.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t=new HitTestResult(HitTestResult.MOVEPOINT,null,a),e.append(new TrendLineRenderer(l,t))}}return this.addAnchors(e),e},W12.prototype.update=function(){W1.prototype.update.call(this),1<this._points.size()&&(this._modifiedBase=this._points.item(0).add(this._points.item(1)).scaled(.5))},inherit(W11,W12),W11.prototype.update=function(){if(W1.prototype.update.call(this),2<this._points.size()){var e=this._points.item(0).x,t=.5*(this._points.item(0).y+this._points.item(1).y);this._modifiedBase=new MathEx.Point(e,t)}},inherit($88,W1),$88.prototype.update=function(){W1.prototype.update.call(this),1<this._points.size()&&(this._modifiedBase=this._points.item(0).add(this._points.item(1)).scaled(.5))},$88.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;if(!this._medianPoint||!this._modifiedBase)return this.addAnchors(e),e;if(3==this._points.size()){var t={points:(new List).append(this._modifiedBase).append(this._points.item(2)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};e.append(new TrendLineRenderer(t))}var i={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(i)),3>this._points.size())return this.addAnchors(e),e;t={points:(new List).append(this._points.item(1)).append(this._points.item(2)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t));var t=this._points.item(2).substract(this._points.item(1)).scaled(.5),n=this._points.item(2).substract(this._modifiedBase),o=0,r=this.W99.properties().fillBackground.value(),s=this.W99.properties().transparency.value(),a={points:(new List).append(this._medianPoint).append(this._medianPoint.add(n)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};for(e.append(new TrendLineRenderer(a)),a=0;8>=a;a++){var l="level"+a,l=this.W99.properties()[l];if(l.visible.value()){var d=this._medianPoint.addScaled(t,l.coeff.value()),h=d.add(n),c=this._medianPoint.addScaled(t,-l.coeff.value()),p=c.add(n);r&&(i={},i.p1=d,i.p2=h,i.p3=this._medianPoint.addScaled(t,o),i.p4=i.p3.add(n),i.color=l.color.value(),i.transparency=s,e.append(new ChannelRenderer(i)),i={},i.p1=c,i.p2=p,i.p3=this._medianPoint.addScaled(t,-o),i.p4=i.p3.add(n),i.color=l.color.value(),i.transparency=s,e.append(new ChannelRenderer(i))),o=l.coeff.value(),d={points:(new List).append(d).append(h),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l.color.value(),linewidth:l.linewidth.value(),linestyle:l.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},i=new HitTestResult(HitTestResult.MOVEPOINT,null,a),e.append(new TrendLineRenderer(d,i)),l={points:(new List).append(c).append(p),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l.color.value(),linewidth:l.linewidth.value(),linestyle:l.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},i=new HitTestResult(HitTestResult.MOVEPOINT,null,a),e.append(new TrendLineRenderer(l,i))}}return this.addAnchors(e),e},TradingView.LineToolPitchfork=function(e,t){this._constructor="LineToolPitchfork";var i=t?t:new $52("linetoolpitchfork");W47.call(this,e,new W1(this,e),i),this.D2.style.listeners().subscribe(this,TradingView.LineToolPitchfork.prototype._recreatePaneView),this._recreatePaneView()},inherit(TradingView.LineToolPitchfork,W47),TradingView.LineToolPitchfork.STYLE_ORIGINAL=0,TradingView.LineToolPitchfork.STYLE_SCHIFF=1,TradingView.LineToolPitchfork.STYLE_INSIDE=2,TradingView.LineToolPitchfork.STYLE_SCHIFF2=3,TradingView.LineToolPitchfork.prototype.additionalActions=function(){for(var e=[],t=["Original","Modified Schiff","Inside","Schiff"],i=0;4>i;i++){var n=new Action({checked:this.properties().style.value()==i,checkable:!0,text:$.t(t[i]),callbackContext:{target:this,value:i}});n.callbacks().subscribe(null,function(e){var t=e.callbackContext();e=t.target,t=t.value,e.properties().style.setValue(t),e.updateAllViews(),e.D0.updateSource(e)}),e.push(n)}return[e[0],e[3],e[1],e[2]]},TradingView.LineToolPitchfork.prototype._recreatePaneView=function(){this.D2.style.value()==TradingView.LineToolPitchfork.STYLE_ORIGINAL?this._paneViews=[new W1(this,this.D0)]:this.D2.style.value()==TradingView.LineToolPitchfork.STYLE_SCHIFF?this._paneViews=[new W12(this,this.D0)]:this.D2.style.value()==TradingView.LineToolPitchfork.STYLE_SCHIFF2?this._paneViews=[new W11(this,this.D0)]:this.D2.style.value()==TradingView.LineToolPitchfork.STYLE_INSIDE&&(this._paneViews=[new $88(this,this.D0)])},TradingView.LineToolPitchfork.prototype.pointsCount=function(){return 3},TradingView.LineToolPitchfork.prototype.title=function(){return $.t("Pitchfork")},TradingView.LineToolPitchfork.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit(W0,$90),W0.prototype.update=function(){$90.prototype.update.call(this),0!==this._points.size()&&(3===this._points.size()?this._medianPoint=this._points.item(1).add(this._points.item(2)).scaled(.5):2===this._points.size()?this._medianPoint=this._points.item(1):this._medianPoint=this._points.item(0),this._medianPoint.data=3)},W0.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||!this._medianPoint)return e;var t={points:(new List).append(this._points.item(0)).append(this._medianPoint),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(t)),
3>this._points.size())return this.addAnchors(e),e;t={points:(new List).append(this._points.item(1)).append(this._points.item(2)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this.W99.properties().median.color.value(),linewidth:this.W99.properties().median.linewidth.value(),linestyle:this.W99.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t));for(var t=0,i=this._points.item(2).substract(this._points.item(1)).scaled(.5),n=this.W99.properties().fillBackground.value(),o=this.W99.properties().transparency.value(),r=0;8>=r;r++){var s="level"+r,s=this.W99.properties()[s];if(s.visible.value()){var a=this._medianPoint.addScaled(i,s.coeff.value()),l=this._medianPoint.addScaled(i,-s.coeff.value());if(n){var d={};d.width=this.D0.timeScale().width(),d.p1=this._points.item(0),d.p2=a,d.p3=this._points.item(0),d.p4=this._medianPoint.addScaled(i,t),d.color=s.color.value(),d.transparency=o,d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d)),d={},d.width=this.D0.timeScale().width(),d.p1=this._points.item(0),d.p2=l,d.p3=this._points.item(0),d.p4=this._medianPoint.addScaled(i,-t),d.color=s.color.value(),d.transparency=o,d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d))}t=s.coeff.value(),d={points:(new List).append(this._points.item(0)).append(a),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:s.color.value(),linewidth:s.linewidth.value(),linestyle:s.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},a=new HitTestResult(HitTestResult.MOVEPOINT,null,r),e.append(new TrendLineRenderer(d,a)),s={points:(new List).append(this._points.item(0)).append(l),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:s.color.value(),linewidth:s.linewidth.value(),linestyle:s.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},a=new HitTestResult(HitTestResult.MOVEPOINT,null,r),e.append(new TrendLineRenderer(s,a))}}return this.addAnchors(e),e},TradingView.LineToolPitchfan=function(e,t){this._constructor="LineToolPitchfan";var i=t?t:new $52("linetoolpitchfan");W47.call(this,e,new W0(this,e),i)},inherit(TradingView.LineToolPitchfan,W47),TradingView.LineToolPitchfan.prototype.pointsCount=function(){return 3},TradingView.LineToolPitchfan.prototype.title=function(){return"Pitchfan"},TradingView.LineToolPitchfan.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},TradingView.LineToolSchiffPitchfork=function(e,t){var i=t?t:new $52("linetoolschiffpitchfork");TradingView.LineToolPitchfork.call(this,e,i),this._constructor="LineToolSchiffPitchfork"},inherit(TradingView.LineToolSchiffPitchfork,TradingView.LineToolPitchfork),TradingView.LineToolSchiffPitchfork.prototype.title=function(){return $.t("Modified Schiff Pitchfork")},TradingView.LineToolSchiffPitchfork2=function(e,t){var i=t?t:new $52("linetoolschiffpitchfork2");TradingView.LineToolPitchfork.call(this,e,i),this._constructor="LineToolSchiffPitchfork2"},inherit(TradingView.LineToolSchiffPitchfork2,TradingView.LineToolPitchfork),TradingView.LineToolSchiffPitchfork2.prototype.title=function(){return $.t("Schiff Pitchfork")},TradingView.LineToolInsidePitchfork=function(e,t){var i=t?t:new $52("linetoolinsidepitchfork");TradingView.LineToolPitchfork.call(this,e,i),this._constructor="LineToolInsidePitchfork"},inherit(TradingView.LineToolInsidePitchfork,TradingView.LineToolPitchfork),TradingView.LineToolInsidePitchfork.prototype.title=function(){return $.t("Inside Pitchfork")},function(){var e;TextRenderer.prototype.wordWrap=function(t,i,n){if(!e){var o=document.createElement("canvas");o.width=0,o.height=0,e=o.getContext("2d")}if(i=+i,t=(t+"").split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/),t[t.length-1]||t.pop(),!isFinite(i)||0>=i)return t;for(e.font=n||this.fontStyle(),n=[],o=0;o<t.length;o++){var r=t[o],s=e.measureText(r).width;if(i>=s)n.push(r);else for(r=r.split(/([-\)\]\},.!?:;])|(\s+)/);r.length;){if(s=~~(i/s*(r.length+2)/3),0>=s||e.measureText(r.slice(0,3*s-1).join("")).width<=i)for(;e.measureText(r.slice(0,3*(s+1)-1).join("")).width<=i;)s++;else for(;s>0&&e.measureText(r.slice(0,3*--s-1).join("")).width>i;);if(s>0)n.push(r.slice(0,3*s-1).join("")),r.splice(0,3*s);else{var s=r[0]+(r[1]||""),a=1===a?1:~~(i/e.measureText(s)*s.length);if(e.measureText(s.substr(0,a)).width<=i)for(;e.measureText(s.substr(0,a+1)).width<=i;)a++;else for(;a>1&&e.measureText(s.substr(0,--a)).width>i;);1>a&&(a=1),n.push(s.substr(0,a)),r[0]=s.substr(a),r[1]=""}if(s=e.measureText(r.join("")).width,i>=s){n.push(r.join(""));break}}}return n}}(),TextRenderer.prototype._x=function(){return this._data.points.item(0).x+this._data.offsetX},TextRenderer.prototype._y=function(){var e=this._fontSize*this._lines.length;this._data.scaleY&&(e*=this._data.scaleY);var t=this._data.points.item(0).y+this._data.offsetY+e;switch(this._data.vertAlign){case"bottom":t-=e;break;case"middle":t-=e/2}return t},TextRenderer.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._fontSize+"px "+this._data.font},TextRenderer.prototype.draw=function(e){if(0!==this._data.points.size()){var t=this._x(),i=this._y(),n=this._fontSize;switch(this._data.scaleY&&(n*=this._data.scaleY),i-=n*(this._lines.length-1),e.textBaseline="alphabetic",e.font=this.fontStyle(),this._data.horzAlign){case"left":e.textAlign="start";break;case"right":e.textAlign="end";break;case"center":e.textAlign="center"}if(e.translate(t+.5,i+.5),i=t=0,n=this._fontSize,this._data.scaleX&&this._data.scaleY){var o=Math.min(this._data.scaleX,this._data.scaleY);e.scale(o,o)}var r,o=[];if(this._data.wordWrapWidth){r=this._data.wordWrapWidth;for(var s=0;s<this._lines.length;s++)o.push(this._data.wordWrapWidth)}else for(s=r=0;s<this._lines.length;s++){var a=e.measureText(this._lines[s]).width;o.push(a),r=Math.max(r,a)}if(this._data.backgroundColor||this._data.borderColor||this._data.highlightBorder&&this._data.wordWrapWidth){switch(s=t,this._data.horzAlign){case"right":s-=r;break;case"center":s-=r/2}var l=n*this._lines.length,d=~~(n/6);if(this._data.backgroundHorzInflate&&(r+=2*this._data.backgroundHorzInflate,s-=this._data.backgroundHorzInflate),this._data.backgroundVertInflate&&(l+=2*this._data.backgroundVertInflate,i+=this._data.backgroundVertInflate),s=Math.floor(s-d),a=Math.floor(i-n),r=Math.ceil(r+2*d),l=Math.ceil(l+2*d),0!=r%2&&r++,this._data.backgroundVertInflate&&(i+=this._data.backgroundVertInflate),this._data.backgroundRoundRect){if(e.roundRect(s,a,r,l,this._data.backgroundRoundRect),this._data.backgroundColor&&(e.fillStyle=this._data.backgroundColor,e.globalAlpha=this._data.backgroundTransparency,e.fill(),e.globalAlpha=1),this._data.borderColor){var h=~~Math.max(n/12,1);e.strokeStyle=this._data.borderColor,e.lineWidth=h,e.stroke()}}else if(this._data.backgroundColor&&(e.fillStyle=this._data.backgroundColor,e.globalAlpha=this._data.backgroundTransparency,e.fillRect(s,a,r,l),e.globalAlpha=1),this._data.borderColor)h=~~Math.max(n/12,1),e.strokeStyle=this._data.borderColor,e.lineWidth=h,e.strokeRect(s-h/2,a-h/2,r+h,l+h);else if(this._data.highlightBorder){e.strokeStyle=this._data.color,e.lineWidth=1,e.beginPath();var c=[3,1];e.dashedLineTo(s-.5,h=a-.5,d=s+r+.5,h,c),e.dashedLineTo(d,h,d,h=a+l+.5,c),e.dashedLineTo(d=s-.5,h,s+r+.5,h,c),e.dashedLineTo(d,a-.5,d,h,c),e.globalAlpha=.5,e.stroke(),e.globalAlpha=1}}for(e.fillStyle=this._data.color,s=0;s<this._lines.length;s++)e.fillText(this._lines[s],t,i),i+=n;this._textSizeCache&&(this._textSizeCache.widths=o)}},TextRenderer.prototype.hitTest=function(e){if(0===this._data.points.size())return null;var t=this._fontSize;this._data.scaleY&&(t*=this._data.scaleY);var i=this._textSizeCache.widths;if(!i)return null;for(var n=0,o=0;o<i.length;o++)n=Math.max(n,i[o]);this._data.scaleX&&(n*=this._data.scaleX),i=this._data.points.item(0).x+this._data.offsetX,o=this._data.points.item(0).y+this._data.offsetY,"bottom"==this._data.vertAlign&&(o-=this._lines.length*this._fontSize),"middle"==this._data.vertAlign&&(o-=this._lines.length*this._fontSize/2),"right"==this._data.horzAlign?i-=n:"center"==this._data.horzAlign&&(i-=n/2);var r=this._data.backgroundColor||this._data.borderColor?~~(t/6):0,t=this._data.borderColor?~~Math.max(t/12,1):0;return e.x>=i-r-t&&e.x<=i+n+r+t&&e.y>=o-t&&e.y<=o+this._lines.length*this._fontSize+2*r+t?this._hittest:null},inherit(W39,$90),W39.prototype.update=function(){this._renderer=null,$90.prototype.update.call(this)},W39.prototype.renderer=function(){if(this._renderer)return this._renderer;var e=this.W99.priceScale();if(!e||e.isEmpty())return this._renderer=new CompositeRenderer;var t={},i=this.W99.properties(),n=i.locked&&i.locked.value();return t.points=n?this.W99.fixedPoints():this._points,t.text=i.text.value(),t.color=i.color.value(),t.font=i.font.value(),t.offsetX=this._offsetX?this._offsetX:0,t.offsetY=this._offsetY?this._offsetY:0,t.vertAlign=this._vertAlign?this._vertAlign:"top",t.horzAlign=this._horzAlign?this._horzAlign:"left",t.fontsize=i.fontsize.value(),i.fillBackground&&i.fillBackground.value()&&(t.backgroundColor=i.backgroundColor.value(),t.backgroundTransparency=1-i.backgroundTransparency.value()/100||0),i.drawBorder&&i.drawBorder.value()&&(t.borderColor=i.borderColor.value()),i.wordWrap&&i.wordWrap.value()&&(t.wordWrapWidth=i.wordWrapWidth.value()),t.bold=i.bold&&i.bold.value(),t.italic=i.italic&&i.italic.value(),t.highlightBorder=this.D0.selectedSource()===this.W99,n||!i.fixedSize||i.fixedSize.value()||(t.scaleX=this.W99.D0.timeScale().barSpacing()/this.W99._barSpacing,i=e.height()/e.priceRange().length(),this.W99._isPriceDencityLog&&!e.isLog()&&(i=e.priceRange().minValue(),n=e.priceRange().maxValue(),i=e._toLog(i),n=e._toLog(n),i=n-i,i=e.height()/i),!this.W99._isPriceDencityLog&&e.isLog()&&(i=e.priceRange().minValue(),n=e.priceRange().maxValue(),i=e._fromLog(i),n=e._fromLog(n),i=n-i,i=e.height()/i),t.scaleY=i/this.W99._priceDencity,(!isFinite(t.scaleY)||0>=t.scaleY)&&delete t.scaleY),i=new TextRenderer(t,this._rendererCache),this.isAnchorsRequired()&&1===t.points.size()&&!this._noSelection?(n=t.points.item(0),e=new CompositeRenderer,e.append(i),t.wordWrapWidth&&(t=new MathEx.Point(n.x+t.wordWrapWidth+~~(t.fontsize/6),n.y+(t.lines?t.lines.length*t.fontsize/2+~~(t.fontsize/6):0)),t.data=0,e.append(this.createLineAnchor({points:(new List).append(t)}))),this._renderer=e):this._renderer=i,this._renderer},TradingView.LineToolText=function(e,t){this._constructor="LineToolText";var i=t?t:new $52("linetooltext");W47.call(this,e,new W39(this,e),i),this._timeScale=e.timeScale(),this._barSpacing=e.timeScale().barSpacing()},inherit(TradingView.LineToolText,W47),TradingView.LineToolText.MIN_WIDTH=100,TradingView.LineToolText.prototype.setPoint=function(e,t){var i=this.properties();if(0===e&&i.wordWrapWidth&&i.wordWrapWidth.value()){var n=i.locked&&i.locked.value()?this.fixedPoints().item(0).x:this._timeScale.indexToCoordinate(this.points().item(0).index),n=this._timeScale.indexToCoordinate(t.index)-n-~~(i.fontsize.value()/6);isFinite(n)&&i.wordWrapWidth.setValue(Math.max(TradingView.LineToolText.MIN_WIDTH,n))}},TradingView.LineToolText.prototype.pointsCount=function(){return 1},TradingView.LineToolText.prototype.title=function(){return $.t("Text")},TradingView.LineToolText.prototype.setPriceScale=function(e){DataSource.prototype.setPriceScale.call(this,e),e&&e.priceRange()&&(this._priceDencity=e.height()/e.priceRange().length(),this._isPriceDencityLog=e.isLog())},TradingView.LineToolText.prototype.restoreSize=function(){this._barSpacing=this.D0.timeScale().barSpacing(),this._priceDencity=this.priceScale().height()/this.priceScale().priceRange().length(),this.updateAllViews(),this.D0.updateSource(this)},TradingView.LineToolText.prototype.restoreTemplate=function(e){delete e.locked,delete e.text,W47.prototype.restoreTemplate.call(this,e)},TradingView.LineToolTextAbsolute=function(e,t){var i=t?t:new $52("linetooltextabsolute");i.locked.value()||i.locked.setValue(!0),TradingView.LineToolText.call(this,e,i)},inherit(TradingView.LineToolTextAbsolute,TradingView.LineToolText),TradingView.LineToolTextAbsolute.prototype.title=function(){return $.t("Anchored Text")},TradingView.LineToolText.prototype.state=function(e){var t=W47.prototype.state.call(this,e);return e&&(t.state.fixedSize=!1),t},TradingView.LineToolThumbUp=function(e,t){this._constructor="LineToolThumbUp";var i=t?t:new Property(defaults("linetoolthumbup"));W47.call(this,e,new $97(this,e,this.image,20,20,-11,0),i),this._paneViews[0].setAnchors(new MathEx.Point(0,0))},inherit(TradingView.LineToolThumbUp,W47),TradingView.LineToolThumbUp.prototype.image=new Image,TradingView.LineToolThumbUp.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACG0lEQVR4AWMgBajE205TTrD7D8R7VRJtQxgoBSDD9r++8n/68bX/leNt91NkmEKCg4BOhvv/7S/O/d/y9DTIlT8pMlAx3q4kqDv7/9KHB/8vfXAAZOAfsg0DhpeoerLT/zmXtv6ffXfn/6ZD8/4rxdqcJT/s4m168pa0/V/1+Mj/6Xe2/XdvTfovF2SWS57rEmxCjfP9/q95cOT//Pt7/k+6sem/SpLDfwZBQX4yYtXBA+TVicdW/l/+6ND/aXe2gl0YPa0MFIYQnGi3TjHB3hVFI0wSxoZhy5Lg/70Hlv5f//TE/zn3dv2feGvj/5l3d4D5e19dAieh3v1LgGptN+AzEKQQjPcANW16dvr/wgf7/k+5vfl//80N/6fd3gqO6Y3PTv7f8vzM/x0vzoP14jVw24uzQINO/V/75DjYsKlAQybc3AgyEORKsKGzgC6dC3T1ikeHCRu45OEBcPKYcWf7/8m3N8MMQ8cgcZChhA2cfW8nRBNhDFI7yA3sPb/6v3Kc7VOqGZi2rPm/fITFLKoY2Hxq8X+dTPf/km66xkQlbM101/+WFaH/XVoT/6esbPrfcmbJ/+6ra/4X75r0P3p+5X8toLxckEknUBsbvhzHCcRSoGzMKSNsJmKmFClup1EhG2C6QzHG+h2wYP0pH2p+RcbPaImgtpQ1UB0XEDMSzMdQRcxAzA7EvEAsCsSyQCwPtVAAiFnRDQMAkGceWYhDo88AAAAASUVORK5CYII=",TradingView.LineToolThumbUp.prototype.pointsCount=function(){return 1},TradingView.LineToolThumbUp.prototype.title=function(){return"Thumb Up"},TradingView.LineToolThumbDown=function(e,t){this._constructor="LineToolThumbDown";var i=t?t:new $52("linetoolthumbdown");W47.call(this,e,new $97(this,e,this.image,20,20,-6,-18),i),this._paneViews[0].setAnchors(new MathEx.Point(0,0))},inherit(TradingView.LineToolThumbDown,W47),TradingView.LineToolThumbDown.prototype.image=new Image,TradingView.LineToolThumbDown.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAB70lEQVR4AWNAB4dsVUT3WCrU7bOQP7zXQuH/Xgv523stFSbsNley2e+gzcNACgBqLNhvq/r/SkbQ/wcNWf9fT6n//7Sj6P+N/Ij/JwIs/4PkIJYgMFgfgo0Au8xlVA/Yq/9/3JL//3lrwf+nNan/H1ck/n9Slfz/WVPO/xddpf9fTaj+/2pSLRi/ntaI38Ad5goTrmUF/39am/7/IdBFD7KC/t9P9///IDPw/8Oc0P+PCqP+PyqJ/f+4NA6MnzVk4Tdwj4XCg0dVKf8f5oX/v5/mRwiDDMVtIFQQ5D2Qi6hn4OOyeJBiqhkIUjSSDNxsKrf3RoovKKlgMwAsfj3W9f8RJy3iEvZ8A5moVcayJ2CS5wIt/z/ICIAbdjPR8/8+K6X/TepiZUDlakAsBcSc+HIeGxCLArGCNh+r6V5Lxf8Pc0PBBt7LDPp/yEHj/1QdiWKgPBcQM5GUp7eYycWf9Lf4/6goGuzKixEO/xcbyC6AuoiRgVSw01z+2L3S+P+PCiL/30kP+L/fRuV/oZKgLumGIWL8z9PaNGA2DPt/OsDi/0I9mS6gMCvpJiHy9a9HZXHgQuKAnfr/UhUxZbDryAXbzOQv384KBpUusOTAwkAJWGokXbjRWO4WyLANJnILwa6jELADsTgQS4JjlgQAAD+B93SzAgQRAAAAAElFTkSuQmCC",TradingView.LineToolThumbDown.prototype.pointsCount=function(){return 1},TradingView.LineToolThumbDown.prototype.title=function(){return"Thumb Down"},TradingView.LineToolThumbDown.prototype.version=TradingView.LineToolThumbUp.prototype.version=2,TradingView.LineToolThumbUp.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=0,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(12,0)))},TradingView.LineToolThumbDown.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=0,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(7,18)))},BalloonRenderer.prototype.draw=function(e){if(0!==this._data.points.size()){e.font=[this._data.fontWeight,this._data.fontSize+"px",this._data.fontFamily].join(" ");var t=e.measureText(this._data.label);t.height=this._data.fontSize;var i={left:15,top:(30-t.height)/2},t=t.width+2*i.left,n=this._data.points.item(0).x-(i.left+20),o=this._data.points.item(0).y-39;this._measureCache&&$.extend(this._measureCache,{innerWidth:t,innerHeight:30,padding:i}),e.translate(.5+n,.5+o),e.beginPath(),e.moveTo(24,30),e.lineTo(15,30),e.arcTo(-1e3,0,1e3,0,15),e.lineTo(t-15,0),e.arcTo(1e3,30,-1e3,30,15),e.lineTo(33,30),e.quadraticCurveTo(33,34,35,39),e.quadraticCurveTo(27,36,24,30),e.fillStyle=generateColor(this._data.backgroundColor,this._data.transparency),e.fill(),e.strokeStyle=this._data.borderColor,e.lineWidth=2,e.stroke(),e.closePath(),e.textBaseline="top",e.fillStyle=this._data.color,e.fillText(this._data.label,i.left,i.top-1)}},BalloonRenderer.prototype.hitTest=function(e){if(0===this._data.points.size()||!this._measureCache.padding)return null;var t=this._data.points.item(0).x-(this._measureCache.padding.left+20),i=this._data.points.item(0).y-(this._measureCache.innerHeight+9);return MathEx.pointInRect(e,new MathEx.Point(t,i),new MathEx.Point(t+this._measureCache.innerWidth,i+this._measureCache.innerHeight))?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit($56,$90),$56.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().color.value(),e.borderColor=this.W99.properties().borderColor.value(),e.backgroundColor=this.W99.properties().backgroundColor.value(),e.transparency=this.W99.properties().transparency.value(),e.fontWeight=this.W99.properties().fontWeight.value(),e.fontSize=this.W99.properties().fontsize.value(),e.fontFamily=this.W99.properties().font.value(),e.label=this.W99.properties().text.value(),e.image=this._image,this.isAnchorsRequired()&&1==e.points.size()){var t=new CompositeRenderer;return t.append(new BalloonRenderer(e,this._rendererCache)),t.append(new SelectionRenderer({points:e.points})),t}return new BalloonRenderer(e,this._rendererCache)},TradingView.LineToolBalloon=function(e,t){this._constructor="LineToolBalloon";var i=t?t:new $52("linetoolballoon");W47.call(this,e,new $56(this,e),i)},inherit(TradingView.LineToolBalloon,W47),TradingView.LineToolBalloon.prototype.pointsCount=function(){return 1},TradingView.LineToolBalloon.prototype.title=function(){return"Balloon"},CalloutRenderer.ROUND_RADIUS=8,CalloutRenderer.TEXT_MARGINS=2,function(){var e;CalloutRenderer.prototype.wordWrap=function(t,i){if(!e){var n=document.createElement("canvas");n.width=0,n.height=0,e=n.getContext("2d")}if(i=+i,n=(t+"").split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/),n[n.length-1]||n.pop(),!isFinite(i)||0>=i)return n;e.font=this.fontStyle();for(var o=[],r=0;r<n.length;r++){var s=n[r],a=e.measureText(s).width;if(i>=a)o.push(s);else for(s=s.split(/([-\)\]\},.!?:;])|(\s+)/);s.length;){if(a=~~(i/a*(s.length+2)/3),0>=a||e.measureText(s.slice(0,3*a-1).join("")).width<=i)for(;e.measureText(s.slice(0,3*(a+1)-1).join("")).width<=i;)a++;else for(;a>0&&e.measureText(s.slice(0,3*--a-1).join("")).width>i;);if(a>0)o.push(s.slice(0,3*a-1).join("")),s.splice(0,3*a);else{var a=s[0]+(s[1]||""),l=1===l?1:~~(i/e.measureText(a)*a.length);if(e.measureText(a.substr(0,l)).width<=i)for(;e.measureText(a.substr(0,l+1)).width<=i;)l++;else for(;l>1&&e.measureText(a.substr(0,--l)).width>i;);1>l&&(l=1),o.push(a.substr(0,l)),s[0]=a.substr(l),s[1]=""}if(a=e.measureText(s.join("")).width,i>=a){o.push(s.join(""));break}}}return o}}(),CalloutRenderer.prototype.hitTest=function(e){if(2>this._data.points.size())return null;var t=this._data.points.item(0),i=this._data.points.item(1);return 3>t.substract(e).length()?new HitTestResult(HitTestResult.CHANGEPOINT,0):(t=i.x-this._textSizeCache.totalWidth/2,i=i.y-this._textSizeCache.totalHeight/2,e.x>=t&&e.x<=t+this._textSizeCache.totalWidth&&e.y>=i&&e.y<=i+this._textSizeCache.totalHeight?new HitTestResult(HitTestResult.MOVEPOINT):null)},CalloutRenderer.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},CalloutRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){var t=this._data.points.item(0).clone(),i=this._data.points.item(1).clone();e.lineCap="butt",e.strokeStyle=this._data.bordercolor,e.lineWidth=this._data.linewidth,e.textBaseline="bottom",e.font=this.fontStyle();var n=this._data.fontSize*this._data.lines.length,o=this._data.wordWrapWidth||this._data.lines.reduce(function(t,i){return Math.max(t,e.measureText(i).width)},0);this._textSizeCache.textHeight=n,this._textSizeCache.textHeight=o;var r=CalloutRenderer.ROUND_RADIUS,s=CalloutRenderer.TEXT_MARGINS,a=o+2*s+2*r,l=n+2*s+2*r;this._textSizeCache.totalWidth=a,this._textSizeCache.totalHeight=l;var d=i.x-a/2,h=i.y-l/2,c=0,o=o+2*s>2*r,n=n+2*s>2*r;for(t.x>d+a?c=20:t.x>d&&(c=10),t.y>h+l?c+=2:t.y>h&&(c+=1),e.save(),e.translate(d,h),t.x-=d,t.y-=h,i.x-=d,i.y-=h,e.beginPath(),e.moveTo(r,0),10==c&&(o?(e.lineTo(i.x-r,0),e.lineTo(t.x,t.y),e.lineTo(i.x+r,0)):e.lineTo(t.x,t.y)),e.lineTo(a-r,0),20==c?(e.lineTo(t.x,t.y),e.lineTo(a,r)):e.arcTo(a,0,a,r,r),21==c&&(n?(e.lineTo(a,i.y-r),e.lineTo(t.x,t.y),e.lineTo(a,i.y+r)):e.lineTo(t.x,t.y)),e.lineTo(a,l-r),22==c?(e.lineTo(t.x,t.y),e.lineTo(a-r,l)):e.arcTo(a,l,a-r,l,r),12==c&&(o?(e.lineTo(i.x+r,l),e.lineTo(t.x,t.y),e.lineTo(i.x-r,l)):e.lineTo(t.x,t.y)),e.lineTo(r,l),2==c?(e.lineTo(t.x,t.y),e.lineTo(0,l-r)):e.arcTo(0,l,0,l-r,r),1==c&&(n?(e.lineTo(0,i.y+r),e.lineTo(t.x,t.y),e.lineTo(0,i.y-r)):e.lineTo(t.x,t.y)),e.lineTo(0,r),0==c?(e.lineTo(t.x,t.y),e.lineTo(r,0)):e.arcTo(0,0,r,0,r),e.stroke(),e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill(),e.fillStyle=this._data.color,h=r+s+this._data.fontSize,d=r+s,t=0;t<this._data.lines.length;t++)e.fillText(this._data.lines[t],d,h),h+=this._data.fontSize;e.restore()}},inherit($62,$90),$62.prototype.update=function(){$90.prototype.update.call(this),this.W99._calculatePoint2()},$62.prototype.renderer=function(){if(!this._points.item(0))return new CompositeRenderer;if(!(2>this._points.size(0))){var e=this.W99.properties(),t={};t.points=new List,t.points.append(this._points.item(0));var i=this._points.item(1).clone();if(i.x=this._points.item(0).x+this.W99._barOffset*this.D0.timeScale().barSpacing(),t.points.append(i),t.color=e.color.value(),t.linewidth=e.linewidth.value(),t.backcolor=e.backgroundColor.value(),t.transparency=e.transparency.value(),t.text=e.text.value(),t.font=e.font.value(),t.fontSize=e.fontsize.value(),t.bordercolor=e.bordercolor.value(),e.wordWrap&&e.wordWrap.value()&&(t.wordWrapWidth=e.wordWrapWidth.value()),t.bold=e.bold&&e.bold.value(),t.italic=e.italic&&e.italic.value(),i=new CalloutRenderer(t,this._textSizeCache),this.isAnchorsRequired()){e=new CompositeRenderer,e.append(i);var i=t.points.item(1),n=t.points.clone();return n.removeAt(n.size()-1),e.append(this.createLineAnchor({points:n})),t.wordWrapWidth&&(t=new MathEx.Point(i.x+(t.wordWrapWidth>>1)+CalloutRenderer.ROUND_RADIUS+CalloutRenderer.TEXT_MARGINS,i.y),t.data=1,e.append(this.createLineAnchor({points:(new List).append(t)}))),e}return i}},TradingView.LineToolCallout=function(e,t){this._constructor="LineToolCallout";var i=t?t:new $52("linetoolcallout");W47.call(this,e,new $62(this,e),i),this._barOffset=0,this._timeScale=e.timeScale()},inherit(TradingView.LineToolCallout,W47),TradingView.LineToolCallout.MIN_WIDTH=100,TradingView.LineToolCallout.prototype.pointsCount=function(){return 2},TradingView.LineToolCallout.prototype.title=function(){return"Callout"},TradingView.LineToolCallout.prototype.correctPoints=function(e){var t=this._currentMovingPoint.index-this._startMovingPoint.index,i=this._currentMovingPoint.price-this._startMovingPoint.price,n=e.item(1);n.index+=t,n.price+=i,e.setItem(1,n)},TradingView.LineToolCallout.prototype.addPoint=function(e){return(e=W47.prototype.addPoint.call(this,e))&&this._calculateBarOffset(),e},TradingView.LineToolCallout.prototype._calculateBarOffset=function(){1<this.points().size()&&(this._barOffset=this.points().item(1).index-this.points().item(0).index)},TradingView.LineToolCallout.prototype.setLastPoint=function(e){W47.prototype.setLastPoint.call(this,e),2==this.points().size()&&this._calculateBarOffset()},TradingView.LineToolCallout.prototype.setPoint=function(e,t){switch(e){case 0:W47.prototype.setPoint.call(this,e,t),this._calculateBarOffset();break;case 1:var i=this.properties();if(!i.wordWrapWidth)break;var n=this._points,o=this._dragStartLeftEdgeIndex,r=Math.round((t.index-o)/2);if(isFinite(o)&&isFinite(r)){if(n.setItem(1,{index:o+r,price:n.item(1).price}),this._calculateBarOffset(),this.normalizePoints(),n=this._timeScale.indexToCoordinate(o+2*r)-this._timeScale.indexToCoordinate(o)-CalloutRenderer.ROUND_RADIUS-CalloutRenderer.TEXT_MARGINS,!isFinite(n))break;i.wordWrapWidth.setValue(Math.max(TradingView.LineToolCallout.MIN_WIDTH,n))}else n.setItem(1,t),this._calculateBarOffset(),this.normalizePoints()}},TradingView.LineToolCallout.prototype.startDragPoint=function(e,t){var i=this.properties();1===e&&i.wordWrap&&i.wordWrap.value()&&(this._dragStartLeftEdgeIndex=2*this.points().item(1).index-t.index)},TradingView.LineToolCallout.prototype.move=function(e){W47.prototype.move.call(this,e),this._calculateBarOffset()},TradingView.LineToolCallout.prototype.state=function(e){return e=W47.prototype.state.call(this,e),e.barOffset=this._barOffset,e},TradingView.LineToolCallout.prototype.restoreData=function(e){e.barOffset?this._barOffset=e.barOffset:this._calculateBarOffset(),this._calculatePoint2()},TradingView.LineToolCallout.prototype.setPriceScale=function(e){DataSource.prototype.setPriceScale.call(this,e),e&&e.priceRange()&&this._calculatePoint2()},TradingView.LineToolCallout.prototype._calculatePoint2=function(){if(this.D0.lineBeingEdited()!=this&&this.D0.sourceBeingMoved()!=this&&!(2>this._points.size())){var e=this.points().item(0),t=this.points().item(1);this._points.setItem(1,{price:t.price,index:e.index+this._barOffset})}},TriangleRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t,i=this._data.points.item(0),n=this._data.points.item(1);t=2==this._data.points.size()?n:this._data.points.item(2),e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(n.x,n.y),e.lineTo(t.x,t.y),e.lineTo(i.x,i.y),this._data.fillBackground&&(e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill()),e.stroke()}},TriangleRenderer.prototype.hitTest=function(e){if(2>this._data.points.size())return null;var t=this._data.points.item(0),i=this._data.points.item(1),n=this._data.points.item(2),o=MathEx.distanceToSegment(t,i,e);return 3>=o.distance?new HitTestResult(HitTestResult.MOVEPOINT):(o=MathEx.distanceToSegment(i,n,e),3>=o.distance?new HitTestResult(HitTestResult.MOVEPOINT):(o=MathEx.distanceToSegment(n,t,e),3>=o.distance||this._data.fillBackground&&MathEx.pointInTriangle(t,i,n,e)?new HitTestResult(HitTestResult.MOVEPOINT):null))},inherit(W44,$90),W44.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().color.value(),e.linewidth=this.W99.properties().linewidth.value(),e.backcolor=this.W99.properties().backgroundColor.value(),e.fillBackground=this.W99.properties().fillBackground.value(),e.transparency=this.W99.properties().transparency.value(),this.isAnchorsRequired()){var t=new CompositeRenderer;return t.append(new TriangleRenderer(e)),e=e.points.clone(),this.D0.lineBeingCreated()==this.W99&&e.removeAt(e.size()-1),t.append(this.createLineAnchor({points:e})),t}return new TriangleRenderer(e)},TradingView.LineToolTriangle=function(e,t){this._constructor="LineToolTriangle";var i=t?t:new $52("linetooltriangle");W47.call(this,e,new W44(this,e),i)},inherit(TradingView.LineToolTriangle,W47),TradingView.LineToolTriangle.prototype.pointsCount=function(){return 3},TradingView.LineToolTriangle.prototype.title=function(){return"Triangle"},inherit(ArcRenderer,EllipseRenderer),ArcRenderer.prototype._additionalPointTest=function(e,t){return 0<=e.y*t.y},ArcRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){var t=this._data.points.item(0),i=this._data.points.item(1);if(3>this._data.points.size())e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke();else{var n=this._data.points.item(2),n=MathEx.distanceToLine(t,i,n).distance;if(1>n)e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke();else{var o=i.substract(t),r=t.add(i).scaled(.5),i=new MathEx.Point(-o.y,o.x),i=i.normalized();r.add(i.scaled(n)),r.add(i.scaled(-n)),e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth;var i=o.length(),s=o.y/i,o=Math.acos(o.x/i);0>s&&(o=-o),s=this._data.points.item(2),r=MathEx.Matrix.translate(-r.x,-r.y),s=r.mult(s),r=MathEx.Matrix.rotate(-o),s=r.mult(s),r=MathEx.Matrix.scale(1,i/(2*n)),s=r.mult(s),this._data.clockwise=0>s.y?!0:!1,e.save(),e.beginPath(),e.translate(t.x,t.y),e.rotate(o),t=1-Math.sqrt(3)/2,e.scale(1,n/(i*t)),this._data.clockwise?e.arc(.5*i,i*Math.sqrt(3)/2,i,-2*Math.PI/3,-Math.PI/3,!1):e.arc(.5*i,-i*Math.sqrt(3)/2,i,Math.PI/3,2*Math.PI/3,!1),e.restore(),e.stroke(),this._data.fillBackground&&(e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill())}}}},inherit($54,$90),$54.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().color.value(),e.linewidth=this.W99.properties().linewidth.value(),e.backcolor=this.W99.properties().backgroundColor.value(),e.fillBackground=this.W99.properties().fillBackground.value(),e.transparency=this.W99.properties().transparency.value(),this.isAnchorsRequired()){var t=new CompositeRenderer;t.append(new ArcRenderer(e));var i=new List,n=e.points.item(0),o=new MathEx.Point(n.x,n.y);if(o.data=0,i.append(o),1==e.points.size())return t;var r=e.points.item(1),o=new MathEx.Point(r.x,r.y);if(o.data=1,2==e.points.size())return this.addAnchors(t),t;i.append(o);var o=e.points.item(2),s=MathEx.distanceToLine(n,r,o).distance,a=r.substract(n),n=n.add(r).scaled(.5),r=new MathEx.Point(-a.y,a.x),r=r.normalized(),o=n.add(r.scaled(s)),r=n.add(r.scaled(-s)),l=a.length(),d=a.y/l,a=Math.acos(a.x/l);return 0>d&&(a=-a),e=e.points.item(2),n=MathEx.Matrix.translate(-n.x,-n.y),e=n.mult(e),n=MathEx.Matrix.rotate(-a),e=n.mult(e),n=MathEx.Matrix.scale(1,l/(2*s)),e=n.mult(e),e=0<=e.y?new MathEx.Point(o.x,o.y):new MathEx.Point(r.x,r.y),e.data=2,i.append(e),t.append(this.createLineAnchor({points:i})),t}return new ArcRenderer(e)},TradingView.LineToolArc=function(e,t){this._constructor="LineToolArc";var i=t?t:new $52("linetoolarc");W47.call(this,e,new $54(this,e),i),this.version=TradingView.LineToolArc.version},inherit(TradingView.LineToolArc,W47),TradingView.LineToolArc.prototype.startChanging=function(e,t){if(W47.prototype.startChanging.call(this,e,t),0==e||1==e){var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0];this._dist=MathEx.distanceToLine(i,n,o).distance}},TradingView.LineToolArc.prototype.pointsCount=function(){return 3},TradingView.LineToolArc.prototype.title=function(){return"Arc"},TradingView.LineToolArc.prototype.setPoint=function(e,t){var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0],r=this.priceScale();if(r.isPercent()){var s=this.ownerSource().firstValue();t.price=r.priceRange().convertFromPercent(t.price,s)}switch(e){case 0:var i=this.pointToScreenPoint(t)[0],s=n.substract(i),a=i.add(n).scaled(.5),i=new MathEx.Point(-s.y,s.x),i=i.normalized(),o=a.add(i.scaled(this._dist)),o=this.screenPointToPoint(o);this._points.setItem(0,t),this._points.setItem(2,o);break;case 1:r=MathEx.distanceToLine(i,n,o).distance,n=this.pointToScreenPoint(t)[0],s=n.substract(i),a=i.add(n).scaled(.5),i=new MathEx.Point(-s.y,s.x),i=i.normalized(),o=a.add(i.scaled(this._dist)),o=this.screenPointToPoint(o),this._points.setItem(1,t),this._points.setItem(2,o);
break;case 2:t=this.pointToScreenPoint(t)[0];var r=MathEx.distanceToLine(i,n,t).distance,s=n.substract(i),a=i.add(n).scaled(.5),i=new MathEx.Point(-s.y,s.x),i=i.normalized(),o=a.add(i.scaled(r)),i=a.add(i.scaled(-r)),n=s.length(),l=s.y/n,s=Math.acos(s.x/n);0>l&&(s=-s),a=MathEx.Matrix.translate(-a.x,-a.y),t=a.mult(t),l=a.mult(o),a=MathEx.Matrix.rotate(-s),t=a.mult(t),l=a.mult(l),a=MathEx.Matrix.scale(1,n/(2*r)),t=a.mult(t),l=a.mult(l),o=0<=t.y*l.y?new MathEx.Point(o.x,o.y):new MathEx.Point(i.x,i.y),o=this.screenPointToPoint(o),this._points.setItem(2,o)}this.normalizePoints()},TradingView.LineToolArc.version=2,TradingView.LineToolArc.prototype.migrateVersion=function(e,t,i){1==e&&2==this._points.size()&&(t=(2*this._points.item(0).price+3*this._points.item(1).price)/5,this._points.append({price:t,index:this._points.item(1).index})),1==e&&2==this._timePoint.size()&&(t=(2*this._timePoint.item(0).price+3*this._timePoint.item(1).price)/5,e={price:t,offset:this._timePoint.item(1).offset,time_t:this._timePoint.item(1).time_t},this._timePoint.append(e))},TradingView.LineToolArrow=function(e,t){this._constructor="LineToolArrow";var i=t?t:new $52("linetoolarrow");TradingView.LineToolTrendLine.call(this,e,i)},inherit(TradingView.LineToolArrow,TradingView.LineToolTrendLine),TradingView.LineToolArrow.prototype.title=function(){return"Arrow"},inherit($61,$90),$61.prototype.update=function(){this._invalidated=!0},$61.prototype._smoothArray=function(e,t){for(var i=Array(e.length),n=0;n<e.length;n++){for(var o=new MathEx.Point(0,0),r=0;t>r;r++)var s=Math.max(n-r,0),a=Math.min(n+r,e.length-1),o=o.add(e[s]),o=o.add(e[a]);i[n]=o.scaled(.5/t)}return i.push(e[e.length-1]),i},$61.prototype._updateInternal=function(){$90.prototype.update.call(this);var e=Math.max(1,this.W99.properties().smooth.value()),t=this._points.toArray();if(0!=t.length){for(var i=[t[0]],n=1;n<t.length;n++){for(var o=t[n].substract(t[n-1]),r=o.length(),s=Math.floor(r/e),o=o.normalized().scaled(r/s),r=0;s-1>r;r++)i.push(t[n-1].add(o.scaled(r)));i.push(t[n])}e=this._smoothArray(i,e),this._points=new List(e)}},$61.prototype.renderer=function(){this._invalidated&&(this._updateInternal(),this._invalidated=!1);var e={},t=this.W99.properties();if(e.points=this._points,e.color=t.linecolor.value(),e.linewidth=t.linewidth.value(),e.linestyle=t.linestyle.value(),e.skipClosePath=!0,t.fillBackground.value()&&this.D0.lineBeingCreated()!==this.W99&&(e.filled=!0,e.fillBackground=!0,e.backcolor=t.backgroundColor.value(),e.transparency=t.transparency.value()),this.isAnchorsRequired()&&this.W99.finished()){if(t=new CompositeRenderer,t.append(new PoligonRenderer(e)),0<e.points.size()){var i=new List;i.append(e.points.item(0)),i.append(e.points.item(e.points.size()-1)),t.append(new SelectionRenderer({points:i}))}return t}return new PoligonRenderer(e)},TradingView.LineToolBrush=function(e,t){this._constructor="LineToolBrush";var i=t?t:new $52("linetoolbrush");W47.call(this,e,new $61(this,e),i),this._finished=!1},inherit(TradingView.LineToolBrush,W47),TradingView.LineToolBrush.prototype.pointsCount=function(){return-1},TradingView.LineToolBrush.prototype.finished=function(){return this._finished},TradingView.LineToolBrush.prototype.finish=function(){this._finished=!0,this._lastPoint=null,this.normalizePoints(),this.createServerPoints()},TradingView.LineToolBrush.prototype.title=function(){return"Brush"},TradingView.LineToolBrush.prototype.percentDistance=function(e,t){return Math.abs((t-e)/e)},TradingView.LineToolBrush.prototype.addPoint=function(e){if(this._finished)return!0;if(this._lastPoint=null,0<this._points.size()){var t=this._points.item(this._points.size()-1),t=this.pointToScreenPoint(t)[1];if(2>this.pointToScreenPoint(e)[1].substract(t).length())return this._finished}return W47.prototype.addPoint.call(this,e),this._finished},TradingView.LineToolBrush.prototype.restorePoints=function(e,t,i){W47.prototype.restorePoints.call(this,e,t,i),this._finished=!0},TradingView.LineToolRay=function(e,t){this._constructor="LineToolRay";var i=t?t:new $52("linetoolray");TradingView.LineToolTrendLine.call(this,e,i)},inherit(TradingView.LineToolRay,TradingView.LineToolTrendLine),TradingView.LineToolRay.prototype.title=function(){return"Ray"},TradingView.LineToolExtended=function(e,t){this._constructor="LineToolExtended";var i=t?t:new $52("linetoolextended");TradingView.LineToolTrendLine.call(this,e,i)},inherit(TradingView.LineToolExtended,TradingView.LineToolTrendLine),TradingView.LineToolExtended.prototype.title=function(){return"Extended Line"},TradingView.LineToolArrowMark=function(e,t){var i=t?t:new $52("linetoolarrowmark");W47.call(this,e,new $97(this,e,this.image,this.width,this.height,this.offsetX,this.offsetY),i)},inherit(TradingView.LineToolArrowMark,W47),TradingView.LineToolArrowMark.prototype.width=21,TradingView.LineToolArrowMark.prototype.height=21,TradingView.LineToolArrowMark.prototype.offsetX=0,TradingView.LineToolArrowMark.prototype.offsetY=0,TradingView.LineToolArrowMark.prototype.paneViews=function(e){return e=W47.prototype.paneViews.call(this,e),null!==e&&this._textPaneView&&e.append(this._textPaneView),e},TradingView.LineToolArrowMark.prototype.pointsCount=function(){return 1},TradingView.LineToolArrowMark.prototype.title=function(){return"Arrow Mark"},TradingView.LineToolArrowMarkLeft=function(e,t){this._constructor="LineToolArrowMarkLeft",TradingView.LineToolArrowMark.call(this,e,t),this._textPaneView=new W39(this,e,22,-3,"middle","left"),this._textPaneView._noSelection=!0},inherit(TradingView.LineToolArrowMarkLeft,TradingView.LineToolArrowMark),TradingView.LineToolArrowMarkLeft.prototype.image=new Image,TradingView.LineToolArrowMarkLeft.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB50lEQVR4AWMgETAKKAgIAGkQ5mCgAmCWdtTWV4yxvgFkWwKxOKUGssr5Gccrx9t+Vk6w+w/kxwKxIrmGMTKIivIohFvONKsI+e/cl/ofamgGECuTYyCTqJ2mqlK01Vnr+uj/HjNy/1v1J8AMzSTHUBYZP6MgpTjb97bNsf9dpmf9N++J/W/UEQEztAiIbUEGo2EpIObE8C4oVuVDzLuBmv869aT8t5+c+t+0K/q/YXs4GGsWeIAMRscwy/yhBiO8K2ijJKcYZXXYuj7qv/u0nP/W/Yn/jTsjQYYRwliDhUXKy8BVKdbmuW1T7H+3Gdn/LXrjQN4FaSDLUBa5MItyoOAvp67k/45T0pC9S56hSrHWhY4tif9D5pUDXZjz36w7Blkx+S5VDLNoBUWMY3fKfwdExMAw+WEq7Wvkoxhn+waUhFwRSYhcQxGxL26jpqQYbX3CBpjY3aeDYj+BothHpFNxcW75cIvJpmXB/516Uv/bT0r5b9IVRUY6xQSssr6GkcAc9dGuNe6/y7RMMnMUJmCWcNTSBgbHZeuG6P+eM/P+W/VRlPcRwSGoJMgvH265yKIq/L9LfzqKoZSXp0Em6cDy9BvU0Dhyy1PM4PAwMFWKs7kFZFsBsQQDlQAjr4a0MJAWxFdHAQAcI3sGHsO1dgAAAABJRU5ErkJggg==",TradingView.LineToolArrowMarkLeft.prototype.offsetX=1,TradingView.LineToolArrowMarkLeft.prototype.offsetY=-10,TradingView.LineToolArrowMarkLeft.prototype.title=function(){return"Arrow Mark Left"},TradingView.LineToolArrowMarkUp=function(e,t){this._constructor="LineToolArrowMarkUp",TradingView.LineToolArrowMark.call(this,e,t),this._textPaneView=new W39(this,e,0,18,"top","center"),this._textPaneView._noSelection=!0},inherit(TradingView.LineToolArrowMarkUp,TradingView.LineToolArrowMark),TradingView.LineToolArrowMarkUp.prototype.image=new Image,TradingView.LineToolArrowMarkUp.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAACBklEQVR4AWMgErAoxVoXgmgGKgEWxTCLVseWxP9yYRbl1DCYSdrXyEc5we5vyLzy/0D6l5SXgStInFwDGcVt1JQU42zfOHan/HebkfPfqSv5v1KszXNBGyU5kDzpRoqLcytGW5+wbY797zA59b9Zd8x/xylp/22bYv8rRlkdBqrgINVIVvlwi8k29dH/Xadn/Tftiv5v2B4Opt1mZP+3ro/6Lx9i3k1K+DLL+hpGmpYF/3efnvPfvCcWZCAcW/TG/XeflvMfFM4yfkZBxIQvo4SjlrZSnO1Hp57U/9b9Cf+NOiKQDQXxgeKJ/516Uv4D1b0XtdNUxRu+gkqC/MBwvGzXGvffflLKf+POSISBCAwWtweGMyi8laKtzjKIivLgCUfLRdYN0f9dpmX+N+mKghiCieHh6wIMb2tguCuEW84E6ccIR7kgk3SLqvD/njPzYOFICIPVeczI/W9WEfJfzs84HmQOIhw9DEyV422/ufSn/7fqg4cjIQxWZwUMd+e+1P9A/Z+lHbX1weHLqyEtrBRncwsYm/+RsWaBBz4DwfLoehRjrG8IKAgIgOMHiK2AOA6IM6G4CKgIr6EgeZA6qPoMII4FYksgFmCA5gwJIFYEYmUotiXSUFuYHqh+cXw5TZlIQ5WxaR4mhuLBZBkqBcT+oJjFg/3B6kgAnFANyniwFEQdJgAAOuN7Bp7MBuYAAAAASUVORK5CYII=",TradingView.LineToolArrowMarkUp.prototype.offsetX=-9,TradingView.LineToolArrowMarkUp.prototype.offsetY=0,TradingView.LineToolArrowMarkUp.prototype.title=function(){return"Arrow Mark Up"},TradingView.LineToolArrowMarkRight=function(e,t){this._constructor="LineToolArrowMarkRight",TradingView.LineToolArrowMark.call(this,e,t),this._textPaneView=new W39(this,e,-22,-3,"middle","right"),this._textPaneView._noSelection=!0},inherit(TradingView.LineToolArrowMarkRight,TradingView.LineToolArrowMark),TradingView.LineToolArrowMarkRight.prototype.image=new Image,TradingView.LineToolArrowMarkRight.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB60lEQVR4AWPAAziAWJBXQ1oYSDMyUAlIALGVUpzNLQkPA1Mgm5kahioCcZxygt1/5Xjbb3JBJulAPiulhioDcSbIUJf+9P8WVeH/5cMtFwkqCfKDgoNiQ636Ev57zsz7b90Q/V8x2vqyhKOWNqHg4ARiKZAhaNgWiItAhhp1RPw374n97zIt879da9x/pTjbj7K+hpE4gwNqoD9IMzasWeDx37A9HIxNuqL+209K+e/Uk/rftCwYGBwWkxnExbkRwYHpTZBGgti4M/K/dX/Cf/fpOf9t6sHBcULcRk0JaAYT6YYiMDw4XKdn/bdtjv2vGGf7RtrXyAdoDguZhiKwaVf0f4fJqf8du1NAQfVXMcyiFWQwmYYisFl3zH+3GTn/Q+aV/3dsSfyvFGtdSLFLHaek/XfqSga59JdcmEU5yKVkh6lFbxzQhdn/bZtiga6zeS7lZeAKMpCC2E/87z4t5791fdR/xSirw4I2SnKg2CcxnSK8aw+MGKceSMTIh5h3Q0szRvJzFCQJgXLUexk/oyCQd8nP+8DE7jEjF+jd6P9K0VZnRe00VWHeJcfQDJChzn2p/80qQv4rhFvOZBAV5QF5l5LyNBZann6W8zOOp0Z5Kg7Eloox1jekHbX1qVLyQ2NVQEBBQIBU7wIAOFZ7BmG7RzYAAAAASUVORK5CYII=",TradingView.LineToolArrowMarkRight.prototype.offsetX=-19,TradingView.LineToolArrowMarkRight.prototype.offsetY=-10,TradingView.LineToolArrowMarkRight.prototype.title=function(){return"Arrow Mark Right"},TradingView.LineToolArrowMarkDown=function(e,t){this._constructor="LineToolArrowMarkDown",TradingView.LineToolArrowMark.call(this,e,t),this._textPaneView=new W39(this,e,0,-23,"bottom","center"),this._textPaneView._noSelection=!0},inherit(TradingView.LineToolArrowMarkDown,TradingView.LineToolArrowMark),TradingView.LineToolArrowMarkDown.prototype.image=new Image,TradingView.LineToolArrowMarkDown.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB/UlEQVR4AWPAATj3Wij8J4RB6hhIAFIgTS9a8nBhmKFSpBiqDNJ0P80PF4YZqkyyobfD7HDh4WJolaKY+G5zhXvoMXva2xifoWB5dD07zeTvFKvxioDMFY6RFUgEGvzzQVk8OGafVib9v5fkhc9QkDxIHVj9vaKY/7vM5b+HS/JFA80TAhnKA8TGZSoiS057GYFiFqzhTpQTPkNB8iB1YPUnPQz+5ykKzQGaYwjE3CBDmUCuBWKHabqSZ0656oI0EY1B6idoSx4F6reDupIJFrTMQCwtxsYcvNZY5uU5T0OiDDwLdOFKI9knvMzM/kD9kmBz0AAbEKs6iHAX7zSX/3nF3xyvgZd8Tf9vM5P/ZiXAmQdNBazYEgIjEHOBwiVHXmjWcSctnAbeDLH5f8xR83+SjNBEoHo9sD4owGWwIBDb9mtJHMIVviDxDg3x3UB11kDMD9ZHADCDwkeAmdlvhZHMI2C4oRh4xl3//1IDmbvszAxeQHXiUPWEATR8lE0EubJB4QYMP7CBF31M/m82k/usy8uRCpRXAKsjEXCCwiteVqD/qIPG/+tBVv/3WCj8C5Pi7wCKawMxBwMZgBEaXlbtGuI7T7ro/G9QFdsI5JsDMR/+cCQcvuLsLAzubRoSa4FsJyAWBSdwsgEifKVBXoYmcBYGagCoQZzEGggAoyq6zKXuV5gAAAAASUVORK5CYII=",TradingView.LineToolArrowMarkDown.prototype.offsetX=-9,TradingView.LineToolArrowMarkDown.prototype.offsetY=-18,TradingView.LineToolArrowMarkDown.prototype.title=function(){return"Arrow Mark Down"},TradingView.LineToolArrowMarkRight.prototype.version=TradingView.LineToolArrowMarkLeft.prototype.version=TradingView.LineToolArrowMarkDown.prototype.version=TradingView.LineToolArrowMarkUp.prototype.version=2,TradingView.LineToolArrowMarkDown.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=-10,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(0,21)),this._textPaneView._offsetX=0,this._textPaneView._offsetY=-4)},TradingView.LineToolArrowMarkUp.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=-10,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(0,0)),this._textPaneView._offsetX=0,this._textPaneView._offsetY=18)},TradingView.LineToolArrowMarkRight.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=0,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(0,0)),this._textPaneView._offsetX=0,this._textPaneView._offsetY=10)},TradingView.LineToolArrowMarkLeft.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=0,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(0,0)),this._textPaneView._offsetX=21,this._textPaneView._offsetY=10)},TradingView.LineToolFlagMark=function(e,t){this._constructor="LineToolFlagMark";var i=t?t:new $52("linetoolflagmark");W47.call(this,e,new $97(this,e,this.image,25,25,-8,-21),i),this._paneViews[0].setAnchors(new MathEx.Point(0,0))},inherit(TradingView.LineToolFlagMark,W47),TradingView.LineToolFlagMark.prototype.image=new Image,TradingView.LineToolFlagMark.prototype.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAsElEQVR4AWMYWcDExOS/YUd4hWF7+H90bNAePpO2liDwJTxyi2htyVXLvlBOWlry2bAtVIumwWXQERFF4zgJ20iPiP8JDCpLeqSuJ6ZdoRJ0SMIRx7QbQtmItgSXnGFbRCzMEnIzK8ISWgL6WzJqibGxsYaFhYUC7SxBWMQPNMjazMxMjebBZWhoKAq00NHc3FyL5nFiaWkpDTTYz8jISI/mEW9qaqoExGFgS+gFRgEAaE0hWxrw50oAAAAASUVORK5CYII=",TradingView.LineToolFlagMark.prototype.pointsCount=function(){return 1},TradingView.LineToolFlagMark.prototype.title=function(){return"Flag Mark"},TradingView.LineToolFlagMark.prototype.version=2,TradingView.LineToolFlagMark.prototype.migrateVersion=function(e){1==e&&(this.version=1,this._paneViews[0]._offsetX=0,this._paneViews[0]._offsetY=0,this._paneViews[0].setAnchors(new MathEx.Point(9,21)))},NoteRendererSource.prototype.update=function(e){this._data&&(!this._data||e.markerColor==this._data.markerColor&&e.width==this._data.width&&e.height==this._data.height)||this._createSource(e.width,e.height,e.markerColor),this._data=e},NoteRendererSource.prototype._createSource=function(e,t,i){this._sourceCanvas=document.createElement("canvas"),this._sourceCanvas.width=e,this._sourceCanvas.height=t,this._translate=new MathEx.Point(-e/2,-t+.5),0==this._translate.x%1&&(this._translate.x+=.5);var n=this._sourceCanvas.getContext("2d"),o=.6*e;n.fillStyle=i,n.beginPath(),n.moveTo(e/2,t),n.quadraticCurveTo(e,e/1.15,e,e/2),n.arc(e/2,e/2,e/2,0,Math.PI,!0),n.quadraticCurveTo(0,e/1.15,e/2,t),n.fill(),n.globalCompositeOperation="destination-out",n.beginPath(),n.moveTo((e-o)/2,e/2),n.arc(e/2,e/2,o/2,0,2*Math.PI),n.fill()},NoteRendererSource.prototype.drawOn=function(e){var t=new MathEx.Point(Math.round(this._data.point.x),Math.round(this._data.point.y)).add(this._translate);e.drawImage(this._sourceCanvas,t.x,t.y)},NoteRendererSource.prototype.hasPoint=function(e){var t=this._data.point.add(this._translate),i=new MathEx.Point(this._data.point.x-this._translate.x,this._data.point.y);return MathEx.pointInRect(e,t,i)},NoteRenderer.prototype.draw=function(e){this.W99.drawOn(e),this._data.tooltipVisible&&this.drawTooltipOn(e)},NoteRenderer.prototype.drawTooltipOn=function(e){e.save();var t=String(this._data.text).replace(/^\s+|\s+$/g,"").replace(/[\r\n]+/g,"\n");e.font=(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font;var t=TextRenderer.prototype.wordWrap(t,TradingView.LineToolNote.TOOLTIP_WIDTH-2*TradingView.LineToolNote.TOOLTIP_PADDING,e.font),n=this._data.point,o=TradingView.LineToolNote.TOOLTIP_LINESPACING,r=TradingView.LineToolNote.TOOLTIP_WIDTH,s=t.length*this._data.fontSize+2*TradingView.LineToolNote.TOOLTIP_PADDING;1<t.length&&(s+=(t.length-1)*o);var a=Math.round(n.x-r/2),l=Math.round(n.y-this._data.height-s-8),d=20>n.x||n.x+20>this._data.vpWidth,h=d?null:"top",c=d?null:Math.round(n.x);for(10>l?l=n.y+13:h="bottom",10>a?a+=Math.abs(a-10):a+r+10>this._data.vpWidth&&(a-=a+r+10-this._data.vpWidth),e.fillStyle=generateColor(this._data.backgroundColor,this._data.backgroundTransparency),e.strokeStyle=this._data.markerColor,e.lineWidth=1,e.beginPath(),e.moveTo(a,l),d||"top"!=h||(e.lineTo(c-7,l),e.lineTo(c,l-7),e.lineTo(c+7,l)),e.lineTo(a+r,l),e.lineTo(a+r,l+s),d||"bottom"!=h||(e.lineTo(c+7,l+s),e.lineTo(c,l+s+7),e.lineTo(c-7,l+s)),e.lineTo(a,l+s),e.closePath(),e.fill(),e.stroke(),e.textBaseline="middle",e.fillStyle=this._data.textColor,n=a+TradingView.LineToolNote.TOOLTIP_PADDING,l=l+TradingView.LineToolNote.TOOLTIP_PADDING+this._data.fontSize/2,i=0;i<t.length;i++)e.fillText(t[i].replace(/^\s+/,""),n,l),l+=this._data.fontSize+o;e.restore()},NoteRenderer.prototype.hitTest=function(e){return this.W99.hasPoint(e)?new HitTestResult(HitTestResult.MOVEPOINT):void 0},inherit(NotePaneView,$90),NotePaneView.prototype.renderer=function(){var e=new CompositeRenderer,t=this.W99.properties(),i=t.locked&&t.locked.value()?this.W99.fixedPoints():this._points;if(1>i.size())return e;var n=this.isAnchorsRequired(),t=$.extend(t.state(),{point:i.item(0),width:24,height:32,tooltipVisible:n,vpWidth:this.D0.m_timeScale.m_width,vpHeight:this.W99.m_priceScale.m_height});return this._rendererSource.update(t),e.append(new NoteRenderer(this._rendererSource,t)),n&&e.append(new SelectionRenderer({points:i})),e},TradingView.LineToolNote=function(e,t){this._constructor="LineToolNote";var i=t?t:new $52("linetoolnote");W47.call(this,e,new NotePaneView(this,e),i),this.version=TradingView.LineToolNote.version},inherit(TradingView.LineToolNote,W47),TradingView.LineToolNote.TOOLTIP_WIDTH=300,TradingView.LineToolNote.TOOLTIP_PADDING=10,TradingView.LineToolNote.TOOLTIP_LINESPACING=5,TradingView.LineToolNote.version=1,TradingView.LineToolNote.prototype.pointsCount=function(){return 1},TradingView.LineToolNote.prototype.title=function(){return $.t("Note")},TradingView.LineToolNote.prototype.restoreTemplate=function(e){delete e.locked,delete e.text,W47.prototype.restoreTemplate.call(this,e)},TradingView.LineToolNoteAbsolute=function(e,t){var i=t?t:new $52("linetoolnoteabsolute");i.locked.value()||i.locked.setValue(!0),TradingView.LineToolNote.call(this,e,i)},inherit(TradingView.LineToolNoteAbsolute,TradingView.LineToolNote),TradingView.LineToolNoteAbsolute.prototype.title=function(){return $.t("Anchored Note")},TradingView.LineToolNote.prototype.state=function(e){var t=W47.prototype.state.call(this,e);return e&&(t.state.fixedSize=!1),t},PriceLabelRenderer.prototype.draw=function(e){if(0!==this._data.points.size()){e.font=[this._data.fontWeight,this._data.fontSize+"px",this._data.fontFamily].join(" ");var t=e.measureText(this._data.label);t.height=this._data.fontSize;var i=t.width+20,t=t.height+10,n=this._data.points.item(0).x- -9,o=this._data.points.item(0).y-(t+15);this._measureCache&&$.extend(this._measureCache,{innerWidth:i,innerHeight:t,tailLeft:-9,tailHeight:15}),e.translate(.5+n,.5+o),e.beginPath(),e.moveTo(12,t),e.lineTo(-9,t+15),e.lineTo(-10,t+15-1),e.lineTo(5,t),e.lineTo(3,t),e.arcTo(0,t,0,0,3),e.lineTo(0,3),e.arcTo(0,0,i,0,3),e.lineTo(i-3,0),e.arcTo(i,0,i,t,3),e.lineTo(i,t-3),e.arcTo(i,t,0,t,3),e.lineTo(12,t),e.fillStyle=generateColor(this._data.backgroundColor,this._data.transparency),e.fill(),e.strokeStyle=this._data.borderColor,e.lineWidth=2,e.stroke(),e.closePath(),e.textBaseline="top",e.fillStyle=this._data.color,e.fillText(this._data.label,10,4),e.translate(-.5,-.5),e.beginPath(),e.arc(-9,t+15,2.5,0,2*Math.PI,!1),e.fillStyle=generateColor(this._data.borderColor,this._data.transparency),e.fill(),e.strokeStyle=this._chartModel.backgroundColor(),e.lineWidth=1,e.stroke(),e.closePath()}},PriceLabelRenderer.prototype.hitTest=function(e){if(0===this._data.points.size())return null;var t=this._data.points.item(0).x-this._measureCache.tailLeft,i=this._data.points.item(0).y-(this._measureCache.innerHeight+this._measureCache.tailHeight);return MathEx.pointInRect(e,new MathEx.Point(t,i),new MathEx.Point(t+this._measureCache.innerWidth,i+this._measureCache.innerHeight))?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit(W5,$90),W5.prototype.update=function(){if($90.prototype.update.call(this),0<this.W99.points().size()){var e=this.W99.points().item(0).price,t=this.W99.priceScale();if(t&&!t.isEmpty()){if(t.isPercent())var i=this.W99.ownerSource().firstValue(),e=t.priceRange().convertToPercent(e,i);this._priceLabel=t.formatter().format(e)}}},W5.prototype.renderer=function(){var e={};if(e.points=this._points,e.borderColor=this.W99.properties().borderColor.value(),e.backgroundColor=this.W99.properties().backgroundColor.value(),e.color=this.W99.properties().color.value(),e.fontWeight=this.W99.properties().fontWeight.value(),e.fontSize=this.W99.properties().fontsize.value(),e.fontFamily=this.W99.properties().font.value(),e.transparency=this.W99.properties().transparency.value(),e.label=this._priceLabel,e.image=this._image,this.isAnchorsRequired()&&1==e.points.size()){var t=new CompositeRenderer;return t.append(new PriceLabelRenderer(e,this._rendererCache,this.D0)),t.append(new SelectionRenderer({points:e.points})),t}return new PriceLabelRenderer(e,this._rendererCache,this.D0)},TradingView.LineToolPriceLabel=function(e,t){this._constructor="LineToolPriceLabel";var i=t||new $52("linetoolpricelabel");W47.call(this,e,new W5(this,e),i)},inherit(TradingView.LineToolPriceLabel,W47),TradingView.LineToolPriceLabel.prototype.pointsCount=function(){return 1},TradingView.LineToolPriceLabel.prototype.title=function(){return"Price Label"},PredictionRenderer.prototype.drawBalloon=function(e,t,i,n,o,r){return r=r||20,e.beginPath(),"down"===o?(t=new MathEx.Point(t.x-r,t.y-6-5-n),e.moveTo(t.x+3,t.y),e.lineTo(t.x+i-3,t.y),e.arcTo(t.x+i,t.y,t.x+i,t.y+3,3),e.lineTo(t.x+i,t.y+n-3),e.arcTo(t.x+i,t.y+n,t.x+i-3,t.y+n,3),e.lineTo(t.x+r+5,t.y+n),e.lineTo(t.x+r,t.y+n+5),e.lineTo(t.x+r-5,t.y+n),e.lineTo(t.x+3,t.y+n),e.arcTo(t.x,t.y+n,t.x,t.y+n-3,3),e.lineTo(t.x,t.y+3),e.arcTo(t.x,t.y,t.x+3,t.y,3),t):(t=new MathEx.Point(t.x-r,t.y+6+5+n),e.moveTo(t.x+3,t.y),e.lineTo(t.x+i-3,t.y),e.arcTo(t.x+i,t.y,t.x+i,t.y-3,3),e.lineTo(t.x+i,t.y-n+3),e.arcTo(t.x+i,t.y-n,t.x+i-3,t.y-n,3),e.lineTo(t.x+r+5,t.y-n),e.lineTo(t.x+r,t.y-n-5),e.lineTo(t.x+r-5,t.y-n),e.lineTo(t.x+3,t.y-n),e.arcTo(t.x,t.y-n,t.x,t.y-n+3,3),e.lineTo(t.x,t.y-3),e.arcTo(t.x,t.y,t.x+3,t.y,3),new MathEx.Point(t.x,t.y-n))},PredictionRenderer.prototype.drawTargetLabel=function(e){var t=this._data.points.item(1);e.save(),e.translate(.5,.5),e.font="normal "+this._targetFontSize3+"px "+this._font;var i=1.5*this._targetFontSize1+1.5*this._targetFontSize2+3,n=e.measureText(this._data.targetLine1).width,o=e.measureText(this._data.targetLine2).width;e.font="normal "+this._targetFontSize2+"px "+this._font;var r=e.measureText(this._data.targetLine3).width,s=e.measureText(this._data.targetLine4).width,o=Math.max(n+o,r+s+10)+20,s="up"===this._data.direction?"down":"up",a=t.x+o-e.canvas.width+5,a=Math.max(20,Math.min(o-15,a)),s=this.drawBalloon(e,t,o,i,s,a);if(e.save(),e.fillStyle=generateColor(this._data.targetBackColor,this._data.transparency),e.fill(),e.restore(),e.save(),e.lineWidth=2,e.strokeStyle=generateColor(this._data.targetStrokeColor,this._data.transparency),e.stroke(),e.restore(),e.beginPath(),e.arc(t.x,t.y,3,0,2*Math.PI,!1),e.fillStyle=this._data.centersColor,e.fill(),e.textAlign="left",e.fillStyle=this._data.targetTextColor,e.font="normal "+this._targetFontSize3+"px "+this._font,e.fillText(this._data.targetLine1,s.x+6,s.y+this._targetFontSize1+4),e.fillText(this._data.targetLine2,s.x+6+n+5,s.y+this._targetFontSize1+4),e.font="normal "+this._targetFontSize2+"px "+this._font,t=s.y+this._targetFontSize1+8+this._targetFontSize2,e.fillText(this._data.targetLine3,s.x+6,t),e.drawImage(this._data.clockWhite,s.x+6+r+6,t-this._targetFontSize2+3),e.fillText(this._data.targetLine4,s.x+6+r+13+5,t),this._data.status){r=this._targetFontSize1+4,e.font="bold "+this._targetFontSize1+"px "+this._font;var l,d,h,c;switch(this._data.status){case TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS:l=$.t("SUCCESS"),d=generateColor(this._data.successBackground,this._data.transparency),h=this._data.successTextColor,c=this._data.successIcon;break;case TradingView.LineToolPrediction.ALERT_STATUS_FAILURE:l=$.t("FAILURE"),d=generateColor(this._data.failureBackground,this._data.transparency),h=this._data.failureTextColor,c=this._data.failureIcon}t=e.measureText(l).width,t=Math.round((o-t)/2),e.fillStyle=d,"up"===this._data.direction?(e.roundRect(s.x-1,s.y-r-2,o+2,r,5),e.fill(),e.fillStyle=h,e.fillText(l,s.x+t,s.y-5),e.drawImage(c,s.x+t-13,s.y-14)):(e.roundRect(s.x-1,s.y+i+3,o+2,r,5),e.fill(),e.fillStyle=h,e.fillText(l,s.x+t,s.y+i+r-1),e.drawImage(c,s.x+t-13,s.y+i+5))}e.restore()},PredictionRenderer.prototype.drawStartLabel=function(e){e.save(),e.translate(.5,.5),e.font="normal "+this._sourceFontSize1+"px "+this._font;var t=1.5*this._sourceFontSize1+1.5*this._sourceFontSize2,i=e.measureText(this._data.sourceLine1).width;e.font="normal "+this._fontsize2+"px "+this._font;var n=e.measureText(this._data.sourceLine2).width,n=Math.max(i,n)-5,i=this._data.points.item(0),t=this.drawBalloon(e,i,n,t,this._data.direction);e.fillStyle=generateColor(this._data.sourceBackColor,this._data.transparency),e.fill(),e.lineWidth=2,e.strokeStyle=generateColor(this._data.sourceStrokeColor,this._data.transparency),e.stroke(),e.beginPath(),e.arc(i.x,i.y,3,0,2*Math.PI,!1),e.fillStyle=this._data.centersColor,e.fill(),e.textAlign="left",e.fillStyle=this._data.sourceTextColor,e.font="normal "+this._sourceFontSize1+"px "+this._font,e.fillText(this._data.sourceLine1,t.x+3,t.y+this._sourceFontSize1+2),e.font="normal "+this._sourceFontSize2+"px "+this._font,e.fillText(this._data.sourceLine2,t.x+3,t.y+this._sourceFontSize1+4+this._sourceFontSize2),e.restore()},PredictionRenderer.prototype.draw=function(e){if(!(2>this._data.points.size())){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t=this._data.points.item(0),i=this._data.points.item(1);new MathEx.Point(t.y,i.x);var n=i.substract(t);1>Math.abs(n.x)||1>Math.abs(n.y)?(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y)):(e.save(),e.beginPath(),e.translate(t.x,t.y),e.scale(1,n.y/n.x),e.moveTo(0,0),e.arcTo(n.x,0,n.x,n.x,Math.abs(n.x)),e.lineTo(n.x,n.x),e.restore()),e.stroke(),this.drawTargetLabel(e),this.drawStartLabel(e),t=Math.max(8,4*this._data.linewidth),e.fillStyle=this._data.color;var o=0>n.y?1:-1;if(1>Math.abs(n.x)||1>Math.abs(n.y))var r=Math.atan(n.x/n.y);else{var s=Math.abs(n.x),a=Math.abs(n.y);Math.sqrt((3*s+a)*(3*a+s));var l=0,d=Math.PI/2,h=(l+d)/2;if(n.length()>t)for(;;){var r=s*Math.sin(h),c=a*(1-Math.cos(h)),p=Math.sqrt((r-s)*(r-s)+(c-a)*(c-a));if(1>Math.abs(p-t))break;p>t?l=h:d=h,h=(l+d)/2}r=Math.atan((s-r)/(a-c)),0>n.x*n.y&&(r=-r)}e.save(),e.beginPath(),e.translate(i.x,i.y),e.rotate(-r),e.moveTo(0,0),e.lineTo(-t/2,o*t),e.lineTo(t/2,o*t),e.lineTo(0,0),e.restore(),e.fill()}},PredictionRenderer.prototype.targetLabelHitTest=function(e){var t=this._data.points.item(1),i=1.5*this._targetFontSize1+1.5*this._targetFontSize2,n=this._targetFontSize1*this._data.targetLine1.length,o=this._targetFontSize1*this._data.targetLine2.length,r=this._targetFontSize2*this._data.targetLine3.length,s=this._targetFontSize2*this._data.targetLine4.length;return this._data.status&&(i+=1.5*this._targetFontSize1),n=Math.max(n+o,r+s)-20,s="up"===this._data.direction?-1:1,o=t.x-20,r=t.y+5*s,i=t.y+(5+i)*s,t=Math.min(r,i),i=Math.max(r,i),e.x>=o&&e.x<=o+n&&e.y>=t&&e.y<=i?new HitTestResult(HitTestResult.MOVEPOINT):null},PredictionRenderer.prototype.sourceLabelHitTest=function(e){var t=1.5*this._sourceFontSize1+1.5*this._sourceFontSize2,i=Math.max(this._sourceFontSize1*this._data.sourceLine1.length,this._sourceFontSize2*this._data.sourceLine2.length),n=this._data.points.item(0),o="up"===this._data.direction?1:-1,r=n.x-20,s=n.y+5*o,n=n.y+(5+t)*o,t=Math.min(s,n),s=Math.max(s,n);return e.x>=r&&e.x<=r+i&&e.y>=t&&e.y<=s?new HitTestResult(HitTestResult.MOVEPOINT):null},PredictionRenderer.prototype.hitTest=function(e){if(2>this._data.points.size())return null;var t=this._data.points.item(0),i=this._data.points.item(1),n=i.substract(t);new MathEx.Point(t.y,i.x);var n=i.substract(t),t=e.substract(t),i=Math.abs(n.x),o=Math.abs(n.y),n=MathEx.sign(n.y)*(o-o*Math.sqrt(1-t.x*t.x/(i*i)));return 3>Math.abs(n-t.y)?new HitTestResult(HitTestResult.MOVEPOINT):(n=this.targetLabelHitTest(e))?n:this.sourceLabelHitTest(e)},inherit(W4,$90),W4.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().linecolor.value(),e.linewidth=this.W99.properties().linewidth.value(),e.targetLine1=this._targetLine1,e.targetLine2=this._targetLine2,e.targetLine3=this._targetLine3,e.targetLine4=this._targetLine4,e.status=this.W99.properties().status.value(),e.transparency=this.W99.properties().transparency.value(),e.targetBackColor=this.W99.properties().targetBackColor.value(),e.targetStrokeColor=this.W99.properties().targetStrokeColor.value(),e.targetTextColor=this.W99.properties().targetTextColor.value(),e.sourceBackColor=this.W99.properties().sourceBackColor.value(),e.sourceStrokeColor=this.W99.properties().sourceStrokeColor.value(),e.sourceTextColor=this.W99.properties().sourceTextColor.value(),e.successBackground=this.W99.properties().successBackground.value(),e.successTextColor=this.W99.properties().successTextColor.value(),e.failureBackground=this.W99.properties().failureBackground.value(),e.failureTextColor=this.W99.properties().failureTextColor.value(),e.intermediateBackColor=this.W99.properties().intermediateBackColor.value(),e.intermediateTextColor=this.W99.properties().intermediateTextColor.value(),e.sourceLine1=this._sourceLine1,e.sourceLine2=this._sourceLine2,e.direction=this._direction,e.clockWhite=this._clockWhite,e.clockBlack=this._clockBlack,e.successIcon=this._successIcon,e.failureIcon=this._failureIcon,e.finished=this._finished,e.centersColor=new RGBColor(this.D0.D2.paneProperties.background._value).blackWhiteContrast(),this.isAnchorsRequired()){var t=new CompositeRenderer;return t.append(new PredictionRenderer(e)),e=e.points.clone(),this.D0.lineBeingCreated()==this.W99&&e.removeAt(e.size()-1),t.append(this.createLineAnchor({points:e})),t}return new PredictionRenderer(e)},W4.prototype.update=function(){if($90.prototype.update.call(this),this._targetLine4=this._targetLine3=this._targetLine2=this._targetLine1="",!(2>this.W99.points().size())&&this.W99.priceScale()){var e=this.W99.points().item(1),t=this.W99.points().item(0);this._targetLine3=this.W99.priceScale().formatter().format(e.price);var i=e.price-t.price,n=0>i?"-":"+";this._targetLine1=this.W99.priceScale().formatter().format(Math.abs(i)),i=Math.abs((Math.round(i/t.price*1e4)/100).toPrecision(3)),this._targetLine1=n+this._targetLine1+" ("+n+i+"%)",n=this.D0.timeScale().indexToUserTime(t.index),i=this.D0.timeScale().indexToUserTime(e.index),t.time&&e.time&&(n=isString(t.time)?new Date(Date.parse(t.time)):t.time,i=isString(e.time)?new Date(Date.parse(e.time)):e.time),i&&n&&(this._targetLine4=(new DateFormatter).format(i),this.D0.mainSeries().isDWM()||(this._targetLine4=this._targetLine4+"  "+new TimeFormatter("%h:%m").format(i)),e=(i.valueOf()-n.valueOf())/1e3,this._targetLine2=$.t("in",{context:"dates"})+" "+(new TimeSpanFormatter).format(e)),this._sourceLine1=this.W99.priceScale().formatter().format(t.price),this._sourceLine2="",(t=this.D0.timeScale().indexToUserTime(t.index))&&(this._sourceLine2=(new DateFormatter).format(t),this.D0.mainSeries().isDWM()||(this._sourceLine2=this._sourceLine2+" "+new TimeFormatter("%h:%m").format(t))),this._direction=this.W99.direction()===TradingView.LineToolPrediction.DIRECTION_UP?"up":"down",this._finished=this.D0.lineBeingCreated()!==this.W99&&this.D0.lineBeingEdited()!==this.W99&&this.D0.sourceBeingMoved()!==this.W99}},TradingView.LineToolPrediction=function(e,t){this._constructor="LineToolPrediction";var i=t?t:new $52("linetoolprediction");i.merge({status:TradingView.LineToolPrediction.ALERT_STATUS_WAITING}),W47.call(this,e,new W4(this,e),i)},TradingView.LineToolPrediction.ALERT_STATUS_WAITING=0,TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS=1,TradingView.LineToolPrediction.ALERT_STATUS_FAILURE=2,TradingView.LineToolPrediction.DIRECTION_UP=1,TradingView.LineToolPrediction.DIRECTION_DOWN=2,inherit(TradingView.LineToolPrediction,W47),TradingView.LineToolPrediction.prototype.status=function(){return this.D2.status.value()},TradingView.LineToolPrediction.prototype.setStatus=function(e){return this.D2.status.setValue(e)},TradingView.LineToolPrediction.prototype.pointsCount=function(){
return 2},TradingView.LineToolPrediction.prototype.title=function(){return"Forecast"},TradingView.LineToolPrediction.prototype.restorePoints=function(e,t,i){W47.prototype.restorePoints.call(this,e,t,i),this.checkAlert()},TradingView.LineToolPrediction.prototype.checkAlert=function(){if(!(2>this._points.size()||this.D0.mainSeries().bars().isEmpty())){var e=this._points.item(1);if(this.status())e.index>this.D0.timeScale().points().lastTimePointIndex()&&this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING);else if(this.D0.mainSeries().bars().last(),this.D0.timeScale().indexToTimePoint(e.index)){var t=this.D0.mainSeries().bars().valueAt(e.index),i=this.direction();i===TradingView.LineToolPrediction.DIRECTION_UP&&t[HIGH_PLOT]>=e.price?this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS):i===TradingView.LineToolPrediction.DIRECTION_DOWN&&t[LOW_PLOT]<=e.price?this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS):(e=this.D0.mainSeries().bars().last().value,t[TIME_PLOT]!==e[TIME_PLOT]&&this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_FAILURE))}}},TradingView.LineToolPrediction.prototype.addPoint=function(e){return(e=W47.prototype.addPoint.call(this,e))&&this.checkAlert(),e},TradingView.LineToolPrediction.prototype.endChanging=function(){W47.prototype.endChanging.call(this),this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING),this.checkAlert()},TradingView.LineToolPrediction.prototype.onData=function(e){W47.prototype.onData.call(this,e),this.checkAlert()},TradingView.LineToolPrediction.prototype.endMoving=function(){W47.prototype.endMoving.call(this),this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING),this.checkAlert()},TradingView.LineToolPrediction.prototype.direction=function(){if(2>this.points().size())return TradingView.LineToolPrediction.DIRECTION_UP;var e=this.points().item(0);return this.points().item(1).price>e.price?TradingView.LineToolPrediction.DIRECTION_UP:TradingView.LineToolPrediction.DIRECTION_DOWN},inherit(W3,$90),W3.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().linecolor.value(),e.linewidth=this.W99.properties().linewidth.value(),e.linestyle=this.W99.properties().linestyle.value(),e.filled=this.W99.properties().filled.value(),e.backcolor=this.W99.properties().backgroundColor.value(),e.fillBackground=this.W99.properties().fillBackground.value(),e.transparency=this.W99.properties().transparency.value(),this.isAnchorsRequired()){var t=new CompositeRenderer;return t.append(new PoligonRenderer(e)),e=e.points.clone(),this.D0.lineBeingCreated()==this.W99&&e.removeAt(e.size()-1),t.append(this.createLineAnchor({points:e})),t}return new PoligonRenderer(e)},TradingView.LineToolPolyline=function(e,t){this._constructor="LineToolPolyline";var i;t?i=t:(i=new $52("linetoolpolyline"),i.filled.setValue(!1)),W47.call(this,e,new W3(this,e),i)},inherit(TradingView.LineToolPolyline,W47),TradingView.LineToolPolyline.prototype.pointsCount=function(){return-1},TradingView.LineToolPolyline.prototype.title=function(){return"Polyline"},TradingView.LineToolPolyline.prototype.addPoint=function(e){var t=this.D0.timeScale().indexToCoordinate(e.index),i=e.price,n=null;if(this.priceScale().isPercent()&&(n=this.ownerSource().firstValue()),i=this.priceScale().priceToCoordinate(i),0<this._points.size()){var o=this._points.item(this._points.size()-1),r=this.D0.timeScale().indexToCoordinate(o.index),o=o.price;if(this.priceScale().isPercent()&&(o=this.priceScale().priceRange().convertToPercent(o,n)),o=this.priceScale().priceToCoordinate(o),5>new MathEx.Point(t,i).substract(new MathEx.Point(r,o)).length())return this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0;if(o=this._points.item(0),r=this.D0.timeScale().indexToCoordinate(o.index),o=o.price,this.priceScale().isPercent()&&(o=this.priceScale().priceRange().convertToPercent(o,n)),n=this.priceScale().priceToCoordinate(o),5>new MathEx.Point(t,i).substract(new MathEx.Point(r,n)).length())return this.D2.filled.setValue(!0),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}return W47.prototype.addPoint.call(this,e)},TradingView.LineToolPolyline.prototype.setPoint=function(e,t){if(W47.prototype.setPoint.call(this,e,t),!(this.D0.timeScale().isEmpty()||this.priceScale().isEmpty()||e!==this._points.size()-1&&0!==e)){var i=this.D0.timeScale().indexToCoordinate(t.index),n=this.priceScale().priceToCoordinate(t.price),o=this._points.item(0),r=this.D0.timeScale().indexToCoordinate(o.index),o=this.priceScale().priceToCoordinate(o.price);5>new MathEx.Point(i,n).substract(new MathEx.Point(r,o)).length()&&this.D2.filled.setValue(!0)}},inherit($82,$90),$82.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return console.log("$82:1 point"),this.addAnchors(e),e;for(var t=this._points.item(0),i=this._points.item(1),n=Math.min(t.x,i.x),o=Math.min(t.y,i.y),r=Math.max(t.x,i.x),s=Math.max(t.y,i.y),a=this.W99.properties(),l=this.W99.properties().fillHorzBackground.value(),d=this.W99.properties().horzTransparency.value(),h=this.W99.properties().fillVertBackground.value(),c=this.W99.properties().vertTransparency.value(),p=0;p<this._hlevels.length;p++){if(p>0&&l){var u=this._hlevels[p-1],t=new MathEx.Point(n,this._hlevels[p].y),i=new MathEx.Point(r,u.y),u={nohittest:!0};u.points=(new List).append(t).append(i),u.color=this._hlevels[p].color,u.linewidth=0,u.backcolor=this._hlevels[p].color,u.fillBackground=!0,u.transparency=d,e.append(new RectangleRenderer(u))}t=new MathEx.Point(n,this._hlevels[p].y),i=new MathEx.Point(r,this._hlevels[p].y),u={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._hlevels[p].color,linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(u)),a.showLeftLabels.value()&&(t={points:(new List).append(t),text:""+this._hlevels[p].coeff,color:this._hlevels[p].color,vertAlign:"middle",horzAlign:"right",font:a.font.value(),offsetX:-5,offsetY:0,fontsize:12},e.append(new TextRenderer(t,this._rendererCache))),a.showRightLabels.value()&&(i={points:(new List).append(i),text:""+this._hlevels[p].coeff,color:this._hlevels[p].color,vertAlign:"middle",horzAlign:"left",font:a.font.value(),offsetX:5,offsetY:0,fontsize:12},e.append(new TextRenderer(i,this._rendererCache)))}for(p=0;p<this._vlevels.length;p++)t=new MathEx.Point(this._vlevels[p].x,o),i=new MathEx.Point(this._vlevels[p].x,s),p>0&&h&&(u=this._vlevels[p-1],n=new MathEx.Point(u.x,o),u={nohittest:!0},u.points=(new List).append(n).append(i),u.color=this._vlevels[p].color,u.linewidth=0,u.backcolor=this._vlevels[p].color,u.fillBackground=!0,u.transparency=c,e.append(new RectangleRenderer(u))),u={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._vlevels[p].color,linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(u)),a.showTopLabels.value()&&(n={points:(new List).append(t),text:""+this._vlevels[p].coeff,color:this._vlevels[p].color,vertAlign:"bottom",horzAlign:"center",font:a.font.value(),offsetX:0,offsetY:-5,fontsize:12},e.append(new TextRenderer(n,this._rendererCache))),a.showBottomLabels.value()&&(i={points:(new List).append(i),text:""+this._vlevels[p].coeff,color:this._vlevels[p].color,vertAlign:"top",horzAlign:"center",font:a.font.value(),offsetX:0,offsetY:5,fontsize:12},e.append(new TextRenderer(i,this._rendererCache)));return this.addAnchors(e),e},$82.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0),t=this.W99.points().item(1);this._hlevels=[];var i,n=t.price-e.price;this.W99.priceScale().isPercent()&&(i=this.W99.ownerSource().firstValue());for(var o=1;7>=o;o++){var r="hlevel"+o,s=this.W99.properties()[r];if(s.visible.value()){var r=s.coeff.value(),s=s.color.value(),a=e.price+r*n;this.W99.priceScale().isPercent()&&(a=this.W99.priceScale().priceRange().convertToPercent(a,i)),a=this.W99.priceScale().priceToCoordinate(a),this._hlevels.push({coeff:r,color:s,y:a})}}for(this._vlevels=[],t=t.index-e.index,o=1;7>=o;o++)r="vlevel"+o,s=this.W99.properties()[r],s.visible.value()&&(r=s.coeff.value(),s=s.color.value(),n=Math.round(e.index+r*t),n=this.D0.timeScale().indexToCoordinate(n),this._vlevels.push({coeff:r,color:s,x:n}))}},TradingView.LineToolGannSquare=function(e,t){this._constructor="LineToolGannSquare";var i=t?t:new $52("linetoolgannsquare");W47.call(this,e,new $82(this,e),i)},inherit(TradingView.LineToolGannSquare,W47),TradingView.LineToolGannSquare.prototype.pointsCount=function(){return 2},TradingView.LineToolGannSquare.prototype.title=function(){return"Gann Box"},inherit($81,$90),$81.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this._points.item(0),t=this._points.item(1);this._fans=[];for(var i=t.x-e.x,n=t.y-e.y,o=1;9>=o;o++){var r="level"+o,r=this.W99.properties()[r];if(r.visible.value()){var s=r.coeff1.value(),a=r.coeff2.value(),l=s/a,d=r.color.value(),h=""+s+"/"+a;s>a?(s=t.x,l=e.y+n/l):(s=e.x+i*l,l=t.y),this._fans.push({label:h,color:d,x:s,y:l,index:o,linewidth:r.linewidth.value(),linestyle:r.linestyle.value(),index:o})}}}},$81.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0);this._points.item(1);for(var i=this.W99.properties(),n=this.W99.properties().fillBackground.value(),o=this.W99.properties().transparency.value(),r=0;r<this._fans.length;r++){var s=new MathEx.Point(this._fans[r].x,this._fans[r].y);if(n)if(4>this._fans[r].index){var a=new MathEx.Point(this._fans[r+1].x,this._fans[r+1].y),l={};l.width=this.D0.timeScale().width(),l.p1=t,l.p2=s,l.p3=t,l.p4=a,l.color=this._fans[r].color,l.transparency=o,l.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(l))}else 4<this._fans[r].index&&r>0&&(a=new MathEx.Point(this._fans[r-1].x,this._fans[r-1].y),l={},l.width=this.D0.timeScale().width(),l.p1=t,l.p2=s,l.p3=t,l.p4=a,l.color=this._fans[r].color,l.transparency=o,l.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(l)));a={points:(new List).append(t).append(s),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._fans[r].color,linewidth:this._fans[r].linewidth,linestyle:this._fans[r].linestyle,extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},l=new HitTestResult(HitTestResult.MOVEPOINT,null,this._fans[r].index),e.append(new TrendLineRenderer(a,l)),i.showLabels.value()&&(s={points:(new List).append(s),text:this._fans[r].label,color:this._fans[r].color,vertAlign:"middle",horzAlign:"left",font:i.font.value(),offsetX:0,offsetY:-5,fontsize:12},e.append(new TextRenderer(s,this._rendererCache)))}return this.isAnchorsRequired()&&(t=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))),e},TradingView.LineToolGannFan=function(e,t){this._constructor="LineToolGannFan";var i=t?t:new $52("linetoolgannfan");W47.call(this,e,new $81(this,e),i)},inherit(TradingView.LineToolGannFan,W47),TradingView.LineToolGannFan.prototype.pointsCount=function(){return 2},TradingView.LineToolGannFan.prototype.title=function(){return"Gann Fan"},TradingView.LineToolGannFan.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit($72,$90),$72.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0),t=this.W99.points().item(1),i=!1,n=this.W99.properties();n.reverse&&n.reverse.value()&&(i=n.reverse.value()),this._levels=[];var o,r=i?t.price-e.price:e.price-t.price,e=i?e.price:t.price;if(this.W99.priceScale().isPercent()&&(o=this.W99.ownerSource().firstValue(),null===o))return;for(t=1;11>=t;t++)if(i=n["level"+t],i.visible.value()){var s=i.coeff.value(),a=i.color.value(),l=e+s*r;this.W99.priceScale().isPercent()&&(l=this.W99.priceScale().priceRange().convertToPercent(l,o));var d,h=this.W99.priceScale().priceToCoordinate(l),c=function(e){return n.coeffsAsPercents.value()?""+Math.round(1e4*e)/100+"%":""+e};n.showCoeffs.value()&&n.showPrices.value()?d=""+c(s)+"("+this.W99.priceScale().formatter().format(l)+")":n.showCoeffs.value()?d=""+c(s):n.showPrices.value()&&(d=""+this.W99.priceScale().formatter().format(l)),this._levels.push({coeff:s,color:a,y:h,label:d,linewidth:i.linewidth.value(),linestyle:i.linestyle.value(),index:t})}}},$72.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=Math.min(t.x,i.x);Math.min(t.y,i.y);var o=Math.max(t.x,i.x);Math.max(t.y,i.y);for(var r=this.W99.properties(),s=r.fillBackground.value(),a=r.transparency.value(),l=r.extendLines.value()?this.D0.timeScale().width():o,d=0;d<this._levels.length;d++){if(d>0&&s){var i=this._levels[d-1],t=new MathEx.Point(n,this._levels[d].y),i=new MathEx.Point(l,i.y),h={};h.nohittest=!TradingView.isMobile.any(),h.points=(new List).append(t).append(i),h.color=this._levels[d].color,h.linewidth=0,h.backcolor=this._levels[d].color,h.fillBackground=!0,h.transparency=a,e.append(new RectangleRenderer(h))}var t=new MathEx.Point(n,this._levels[d].y),i=new MathEx.Point(o,this._levels[d].y),h={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._levels[d].color,linewidth:this._levels[d].linewidth,linestyle:this._levels[d].linestyle,extendleft:!1,extendright:r.extendLines.value(),leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},c=new HitTestResult(HitTestResult.MOVEPOINT,null,this._levels[d].index);if(e.append(new TrendLineRenderer(h,c)),r.showCoeffs.value()||r.showPrices.value()){var p,u,h=r.vertLabelsAlign.value();switch(r.horzLabelsAlign.value()){case"left":p=t,u="right";break;case"center":p=t.add(i).scaled(.5),u="center";break;case"right":r.extendLines.value()?(p=new MathEx.Point(l-4,this._levels[d].y),u="right"):(p=new MathEx.Point(l+4,this._levels[d].y),u="left")}t={points:(new List).append(p),text:this._levels[d].label,color:this._levels[d].color,vertAlign:h,horzAlign:u,font:r.font.value(),offsetX:-5,offsetY:"top"==h?0:-5,fontsize:12},e.append(new TextRenderer(t,this._rendererCache))}}return r.trendline.visible.value()&&(h={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:r.trendline.color.value(),linewidth:r.trendline.linewidth.value(),linestyle:r.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(h))),this.isAnchorsRequired()&&(n=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&n.removeAt(n.size()-1),e.append(this.createLineAnchor({points:n}))),e},TradingView.LineToolFibRetracement=function(e,t){this._constructor="LineToolFibRetracement";var i=t?t:new $52("linetoolfibretracement");W47.call(this,e,new $72(this,e),i),this.version=TradingView.LineToolFibRetracement.version},inherit(TradingView.LineToolFibRetracement,W47),TradingView.LineToolFibRetracement.version=2,TradingView.LineToolFibRetracement.prototype.pointsCount=function(){return 2},TradingView.LineToolFibRetracement.prototype.title=function(){return"Fib Retracement"},TradingView.LineToolFibRetracement.prototype.migrateVersion=function(e,t,i){1==e&&this.properties().extendLines.setValue(!0)},TradingView.LineToolFibRetracement.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit(W41,$90),W41.prototype.update=function(){if($90.prototype.update.call(this),!(3>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0),t=this.W99.points().item(1),i=this.W99.points().item(2),n=!1,o=this.W99.properties();o.reverse&&o.reverse.value()&&(n=o.reverse.value()),this._levels=[];var r,e=n?e.price-t.price:t.price-e.price;for(this.W99.priceScale().isPercent()&&(r=this.W99.ownerSource().firstValue()),t=1;11>=t;t++)if(n=o["level"+t],n.visible.value()){var s=n.coeff.value(),a=n.color.value(),l=i.price+s*e;this.W99.priceScale().isPercent()&&(l=this.W99.priceScale().priceRange().convertToPercent(l,r));var d,h=function(e){return o.coeffsAsPercents.value()?""+Math.round(1e4*e)/100+"%":""+e},c=this.W99.priceScale().priceToCoordinate(l);o.showCoeffs.value()&&o.showPrices.value()?d=""+h(s)+"("+this.W99.priceScale().formatter().format(l)+")":o.showCoeffs.value()?d=""+h(s):o.showPrices.value()&&(d=""+this.W99.priceScale().formatter().format(l)),this._levels.push({coeff:s,color:a,y:c,label:d,linewidth:n.linewidth.value(),linestyle:n.linestyle.value(),index:t})}}},W41.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=this.W99.properties(),o={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(o)),3>this._points.size())return this.addAnchors(e),e;var r=this._points.item(2),o={points:(new List).append(i).append(r),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};e.append(new TrendLineRenderer(o));var s=Math.min(r.x,i.x);Math.min(t.y,i.y),r=Math.max(r.x,i.x),Math.max(t.y,i.y);for(var a=n.fillBackground.value(),l=n.transparency.value(),d=n.extendLines.value()?this.D0.timeScale().width():r,h=0;h<this._levels.length;h++){h>0&&a&&(i=this._levels[h-1],t=new MathEx.Point(s,this._levels[h].y),i=new MathEx.Point(d,i.y),o={},o.nohittest=!TradingView.isMobile.any(),o.points=(new List).append(t).append(i),o.color=this._levels[h].color,o.linewidth=0,o.backcolor=this._levels[h].color,o.fillBackground=!0,o.transparency=l,e.append(new RectangleRenderer(o)));var t=new MathEx.Point(s,this._levels[h].y),i=new MathEx.Point(r,this._levels[h].y),o={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._levels[h].color,linewidth:this._levels[h].linewidth,linestyle:this._levels[h].linestyle,extendleft:!1,extendright:n.extendLines.value(),leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},c=new HitTestResult(HitTestResult.MOVEPOINT,null,this._levels[h].index);if(e.append(new TrendLineRenderer(o,c)),n.showCoeffs.value()||n.showPrices.value()){var p,u,o=n.vertLabelsAlign.value();switch(n.horzLabelsAlign.value()){case"left":p=t,u="right";break;case"center":p=t.add(i).scaled(.5),u="center";break;case"right":n.extendLines.value()?(p=new MathEx.Point(d-4,this._levels[h].y),u="right"):(p=new MathEx.Point(d+4,this._levels[h].y),u="left")}t={points:(new List).append(p),text:this._levels[h].label,color:this._levels[h].color,vertAlign:o,horzAlign:u,font:n.font.value(),offsetX:-5,offsetY:"top"==o?0:-5,fontsize:12},e.append(new TextRenderer(t,this._rendererCache))}}return this.addAnchors(e),e},TradingView.LineToolTrendBasedFibExtension=function(e,t){this._constructor="LineToolTrendBasedFibExtension";var i=t?t:new $52("linetooltrendbasedfibextension");W47.call(this,e,new W41(this,e),i),this.version=TradingView.LineToolTrendBasedFibExtension.version},inherit(TradingView.LineToolTrendBasedFibExtension,W47),TradingView.LineToolTrendBasedFibExtension.version=2,TradingView.LineToolTrendBasedFibExtension.prototype.pointsCount=function(){return 3},TradingView.LineToolTrendBasedFibExtension.prototype.title=function(){return"Trend-Based Fib Extension"},TradingView.LineToolTrendBasedFibExtension.prototype.migrateVersion=function(e,t,i){1==e&&this.properties().extendLines.setValue(!0)},TradingView.LineToolTrendBasedFibExtension.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit($74,$90),$74.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0),t=this.W99.points().item(1);this._hlevels=[];var i,n=t.price-e.price;this.W99.priceScale().isPercent()&&(i=this.W99.ownerSource().firstValue());for(var o=1;7>=o;o++){var r="hlevel"+o,s=this.W99.properties()[r];if(s.visible.value()){var r=s.coeff.value(),s=s.color.value(),a=e.price+r*n;this.W99.priceScale().isPercent()&&(a=this.W99.priceScale().priceRange().convertToPercent(a,i)),a=this.W99.priceScale().priceToCoordinate(a),this._hlevels.push({coeff:r,color:s,y:a,index:o})}}for(this._vlevels=[],t=t.index-e.index,o=1;7>=o;o++)r="vlevel"+o,s=this.W99.properties()[r],s.visible.value()&&(r=s.coeff.value(),s=s.color.value(),n=Math.round(e.index+r*t),n=this.D0.timeScale().indexToCoordinate(n),this._vlevels.push({coeff:r,color:s,x:n,index:o}))}},$74.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;for(var t=this._points.item(0),i=this._points.item(1),n=Math.min(t.x,i.x),o=Math.min(t.y,i.y),r=Math.max(t.x,i.x),s=Math.max(t.y,i.y),a=this.W99.properties(),l=a.grid.color.value(),d=a.grid.linewidth.value(),h=a.grid.linestyle.value(),c=0;c<this._hlevels.length;c++){if(t=new MathEx.Point(n,this._hlevels[c].y),i=new MathEx.Point(r,this._hlevels[c].y),a.grid.visible.value()){var p={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l,linewidth:d,linestyle:h,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};e.append(new TrendLineRenderer(p))}a.showLeftLabels.value()&&(t={points:(new List).append(t),text:""+this._hlevels[c].coeff,color:this._hlevels[c].color,vertAlign:"middle",horzAlign:"right",font:a.font.value(),offsetX:-5,offsetY:0,fontsize:12},e.append(new TextRenderer(t,this._rendererCache))),a.showRightLabels.value()&&(i={points:(new List).append(i),text:""+this._hlevels[c].coeff,color:this._hlevels[c].color,vertAlign:"middle",horzAlign:"left",font:a.font.value(),offsetX:5,offsetY:0,fontsize:12},e.append(new TextRenderer(i,this._rendererCache)))}for(c=0;c<this._vlevels.length;c++)t=new MathEx.Point(this._vlevels[c].x,o),i=new MathEx.Point(this._vlevels[c].x,s),a.grid.visible.value()&&(p={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:l,linewidth:d,linestyle:h,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(p))),a.showTopLabels.value()&&(t={points:(new List).append(t),text:""+this._vlevels[c].coeff,color:this._vlevels[c].color,vertAlign:"bottom",horzAlign:"center",font:a.font.value(),offsetX:0,offsetY:-5,fontsize:12},e.append(new TextRenderer(t,this._rendererCache))),a.showBottomLabels.value()&&(i={points:(new List).append(i),text:""+this._vlevels[c].coeff,color:this._vlevels[c].color,vertAlign:"top",horzAlign:"center",font:a.font.value(),offsetX:0,offsetY:5,fontsize:12},e.append(new TextRenderer(i,this._rendererCache)));for(o=a.fillBackground.value(),s=a.transparency.value(),t=this._points.item(0),i=this._points.item(1),c=0;c<this._hlevels.length;c++)h=new MathEx.Point(i.x,this._hlevels[c].y),c>0&&o&&(l=new MathEx.Point(i.x,this._hlevels[c-1].y),d={},d.width=this.D0.timeScale().width(),d.p1=t,d.p2=h,d.p3=t,d.p4=l,d.color=this._hlevels[c].color,d.transparency=s,d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d))),p={points:(new List).append(t).append(h),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._hlevels[c].color,linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},l=new HitTestResult(HitTestResult.MOVEPOINT,null,{type:"h",index:this._hlevels[c].index}),e.append(new TrendLineRenderer(p,l));for(c=0;c<this._vlevels.length;c++)h=new MathEx.Point(this._vlevels[c].x,i.y),c>0&&o&&(l=new MathEx.Point(this._vlevels[c-1].x,i.y),d={},d.width=this.D0.timeScale().width(),d.p1=t,d.p2=h,d.p3=t,d.p4=l,d.color=this._vlevels[c].color,d.transparency=s,d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d))),p={points:(new List).append(t).append(h),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:this._vlevels[c].color,linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:!1,extendright:!0,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},l=new HitTestResult(HitTestResult.MOVEPOINT,null,{type:"v",index:this._vlevels[c].index}),e.append(new TrendLineRenderer(p,l));return this.isAnchorsRequired()&&(a=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&a.removeAt(a.size()-1),e.append(this.createLineAnchor({points:a}))),e},TradingView.LineToolFibSpeedResistanceFan=function(e,t){this._constructor="LineToolFibSpeedResistanceFan";var i=t?t:new $52("linetoolfibspeedresistancefan");W47.call(this,e,new $74(this,e),i)},inherit(TradingView.LineToolFibSpeedResistanceFan,W47),TradingView.LineToolFibSpeedResistanceFan.prototype.pointsCount=function(){return 2},TradingView.LineToolFibSpeedResistanceFan.prototype.title=function(){return"Fib Speed Resistance Fan"},TradingView.LineToolFibSpeedResistanceFan.prototype.processErase=function(e,t){var i="h"==t.type?"hlevel"+t.index:"vlevel"+t.index,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},FibArcRenderer.prototype.draw=function(e){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.translate(this._data.center.x,this._data.center.y),e.beginPath(),0<this._data.dir?e.arc(0,0,this._data.radius,0,Math.PI,!1):e.arc(0,0,this._data.radius,Math.PI,0,!1),e.stroke(),this._data.fillBackground&&(this._data.radius2&&(0<this._data.dir?e.arc(0,0,this._data.radius2,Math.PI,0,!0):e.arc(0,0,this._data.radius2,0,Math.PI,!0)),e.fillStyle=generateColor(this._data.color,this._data.transparency),e.fill())},FibArcRenderer.prototype.hitTest=function(e){if(MathEx.sign(e.y-this._data.center.y)!==this._data.dir)return null;e=e.substract(this._data.center).length();var t=this._hittest||new HitTestResult(HitTestResult.MOVEPOINT);if(this._data.hittestOnBackground){if(Math.abs(e)<=this._data.radius+3)return t}else if(3>Math.abs(e-this._data.radius))return t;return null},inherit($73,$90),$73.prototype.update=function(){if($90.prototype.update.call(this),!(2>this._points.size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this._points.item(0),t=this._points.item(1),i=e.substract(t).length();this._levels=[];for(var n=this.W99.properties(),o=1;11>=o;o++){var r=n["level"+o];if(r.visible.value()){var s,a=r.coeff.value(),l=r.color.value(),d=t.substract(e).length()*a;n.showCoeffs.value()&&(s=""+a);var h=MathEx.sign(t.y-e.y),c=new MathEx.Point(e.x,e.y+h*i*a);this._levels.push({coeff:a,color:l,label:s,radius:d,dir:h,labelPoint:c,linewidth:r.linewidth.value(),linestyle:r.linestyle.value(),index:o})}}}},$73.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0);this._points.item(1);for(var i=this.W99.properties(),n=i.fillBackground.value(),o=i.transparency.value(),r=0;r<this._levels.length;r++){var s=this._levels[r],a={};a.center=t,a.color=s.color,a.linewidth=s.linewidth,a.radius=s.radius,a.dir=s.dir,a.transparency=o,a.fillBackground=n,a.hittestOnBackground=TradingView.isMobile.any(),r>0&&(a.radius2=this._levels[r-1].radius);var l=new HitTestResult(HitTestResult.MOVEPOINT,null,s.index);e.append(new FibArcRenderer(a,l)),i.showCoeffs.value()&&(s={points:(new List).append(s.labelPoint),text:this._levels[r].label,color:this._levels[r].color,vertAlign:"middle",horzAlign:"right",font:i.font.value(),offsetX:0,offsetY:0,fontsize:12},e.append(new TextRenderer(s,this._rendererCache)))}return i.trendline.visible.value()&&(t={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:i.trendline.color.value(),linewidth:i.trendline.linewidth.value(),linestyle:i.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t))),this.isAnchorsRequired()&&(t=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))),e},TradingView.LineToolFibSpeedResistanceArcs=function(e,t){this._constructor="LineToolFibSpeedResistanceArcs";var i=t?t:new $52("linetoolfibspeedresistancearcs");W47.call(this,e,new $73(this,e),i)},inherit(TradingView.LineToolFibSpeedResistanceArcs,W47),TradingView.LineToolFibSpeedResistanceArcs.prototype.pointsCount=function(){return 2},TradingView.LineToolFibSpeedResistanceArcs.prototype.title=function(){return"Fib Speed Resistance Arcs"},TradingView.LineToolFibSpeedResistanceArcs.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit($76,$90),$76.prototype.update=function(){if($90.prototype.update.call(this),!(1>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0);if(2===this.W99.points().size())var t=this.W99.points().item(1);var i=this.W99.properties(),n=this.W99.points().item(0).index;if(!this.D0.timeScale().visibleBars().isEmpty())for(this._levels=[],e=t?t.index-e.index:1,t=1;11>=t;t++){var o=i["level"+t];if(o.visible.value()){var r=Math.round(n+o.coeff.value()*e),r=this.D0.timeScale().indexToCoordinate(r),r={index:t,x:r,color:o.color.value(),width:o.linewidth.value(),style:o.linestyle.value()};i.showLabels.value()&&(r.text=o.coeff.value(),r.y=this.W99.priceScale().height()),this._levels.push(r)}}}},$76.prototype.renderer=function(){for(var e=new CompositeRenderer,t=this.W99.properties(),i=0;i<this._levels.length;i++){var n={};n.points=(new List).append(new MathEx.Point(this._levels[i].x,0)),n.color=this._levels[i].color,n.linewidth=this._levels[i].width,n.linestyle=this._levels[i].style;var o=new HitTestResult(HitTestResult.MOVEPOINT,null,this._levels[i].index);if(e.append(new VertLineRenderer(n,o)),i>0&&t.fillBackground.value()){var r=this._levels[i-1],o=new MathEx.Point(this._levels[i].x,0),r=new MathEx.Point(r.x,this.W99.priceScale().height()),s={nohittest:!0};s.points=(new List).append(o).append(r),s.color=this._levels[i].color,s.linewidth=0,s.backcolor=this._levels[i].color,s.fillBackground=!0,s.transparency=t.transparency.value(),e.append(new RectangleRenderer(s))}if(void 0!==this._levels[i].text){var a,l,d,o=t.horzLabelsAlign.value(),o="left"==o?"right":"right"==o?"left":"center";switch(o){case"left":l=3;break;case"center":l=0;break;case"right":l=-3}switch(t.vertLabelsAlign.value()){case"top":a=new MathEx.Point(this._levels[i].x,0),d=5;break;case"middle":a=new MathEx.Point(this._levels[i].x,.5*this._levels[i].y),d=0;break;case"bottom":a=new MathEx.Point(this._levels[i].x,this._levels[i].y),
d=-10}n={points:(new List).append(a),text:""+this._levels[i].text,color:n.color,vertAlign:"middle",horzAlign:o,font:t.font.value(),offsetX:l,offsetY:d,fontsize:12},e.append(new TextRenderer(n,this._rendererCache))}}return 2===this._points.size()&&(t={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t))),this.isAnchorsRequired()&&(2===this.W99.points().size()?(t=this._points.clone(),e.append(this.createLineAnchor({points:t}))):0<this._points.size()&&(t=new List,t.append(new MathEx.Point(this._points.item(0).x,this.W99.priceScale().height()/2)),e.append(this.createLineAnchor({points:t,hittestResult:HitTestResult.MOVEPOINT})))),e},TradingView.LineToolFibTimeZone=function(e,t){this._constructor="LineToolFibTimeZone";var i=t?t:new $52("linetoolfibtimezone");W47.call(this,e,new $76(this,e),i),this.version=TradingView.LineToolFibTimeZone.version},inherit(TradingView.LineToolFibTimeZone,W47),TradingView.LineToolFibTimeZone.version=2,TradingView.LineToolFibTimeZone.prototype.migrateVersion=function(e,t,i){if(1===e){for(i.properties.level1.color.setValue(i.properties.baselinecolor.value()),e=2;11>=e;e++)i.properties["level"+e].color.setValue(i.properties.linecolor.value());for(e=1;11>=e;e++)i.properties["level"+e].linewidth.setValue(i.properties.linewidth.value()),i.properties["level"+e].linestyle.setValue(i.properties.linestyle.value())}},TradingView.LineToolFibTimeZone.prototype.pointsCount=function(){return 2},TradingView.LineToolFibTimeZone.prototype.title=function(){return"Fib Time Zone"},TradingView.LineToolFibTimeZone.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},EllipseRendererSimple.prototype.draw=function(e){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle;var t=this._data.points.item(0),i=this._data.points.item(1),n=Math.abs(t.x-i.x),o=Math.abs(t.y-i.y),t=t.add(i).scaled(.5);if(!(1>n||1>o)){if(this._data.wholePoints){var i=this._data.wholePoints.item(0),r=this._data.wholePoints.item(1),s=Math.abs(i.x-r.x);Math.abs(i.y-r.y)}e.save(),e.translate(t.x,t.y),e.scale(1,o/n),e.beginPath(),e.arc(0,0,n/2,0,2*Math.PI,!1),e.restore(),e.stroke(),this._data.fillBackground&&(this._data.wholePoints&&(e.translate(t.x,t.y),e.scale(1,o/n),e.arc(0,0,s/2,0,2*Math.PI,!0)),e.fillStyle=generateColor(this._data.backcolor,this._data.transparency),e.fill())}},EllipseRendererSimple.prototype.hitTest=function(e){if(2>this._data.points.size())return null;var t=this._data.points.item(0),i=this._data.points.item(1),n=.5*Math.abs(t.x-i.x);Math.abs(t.y-i.y);var o=Math.abs(t.x-i.x),r=Math.abs(t.y-i.y),s=t.add(i).scaled(.5);if(e=e.substract(s),1>o||1>r)return null;if(e.y/=(i.y-t.y)/(i.x-t.x),t=e.x*e.x+e.y*e.y-n*n,t=MathEx.sign(t)*Math.sqrt(Math.abs(t/n)),n=this._hittest||new HitTestResult(HitTestResult.MOVEPOINT),this._data.fillBackground&&!this._data.noHitTestOnBackground){if(3>t)return n}else if(3>Math.abs(t))return n;return null},inherit($71,$90),$71.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this._points.item(0),t=this._points.item(1);this._center=e.add(t).scaled(.5);var i=Math.abs(t.x-e.x),e=Math.abs(t.y-e.y);this._levels=[];for(var t=this.W99.properties(),n=1;11>=n;n++){var o=t["level"+n];if(o.visible.value()){var r=o.coeff.value(),s=o.color.value(),a=new List;a.append(new MathEx.Point(this._center.x-.5*i*r,this._center.y-.5*e*r)),a.append(new MathEx.Point(this._center.x+.5*i*r,this._center.y+.5*e*r));var l;t.showCoeffs.value()&&(l=r,l=t.coeffsAsPercents.value()?""+Math.round(1e4*l)/100+"%":""+l);var d=new MathEx.Point(this._center.x,this._center.y+.5*e*r);this._levels.push({coeff:r,color:s,label:l,points:a,labelPoint:d,linewidth:o.linewidth.value(),linestyle:o.linestyle.value(),index:n})}}}},$71.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;this._points.item(0),this._points.item(1);for(var t=this.W99.properties(),i=t.fillBackground.value(),n=t.transparency.value(),o=0;o<this._levels.length;o++){var r=this._levels[o],s={};s.points=r.points,s.color=r.color,s.linewidth=r.linewidth,s.backcolor=r.color,o>0&&(s.wholePoints=this._levels[o-1].points),s.fillBackground=i,s.transparency=n,s.noHitTestOnBackground=!TradingView.isMobile.any();var a=new HitTestResult(HitTestResult.MOVEPOINT,null,r.index);e.append(new EllipseRendererSimple(s,a)),t.showCoeffs.value()&&(r={points:(new List).append(r.labelPoint),text:this._levels[o].label,color:this._levels[o].color,vertAlign:"middle",horzAlign:"right",font:t.font.value(),offsetX:0,offsetY:0,fontsize:12},e.append(new TextRenderer(r,this._rendererCache)))}return t.trendline.visible.value()&&(t={points:(new List).append(this._points.item(0)).append(this._points.item(1)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(t))),this.isAnchorsRequired()&&(t=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))),e},TradingView.LineToolFibCircles=function(e,t){this._constructor="LineToolFibCircles";var i=t?t:new $52("linetoolfibcircles");W47.call(this,e,new $71(this,e),i)},inherit(TradingView.LineToolFibCircles,W47),TradingView.LineToolFibCircles.prototype.pointsCount=function(){return 2},TradingView.LineToolFibCircles.prototype.title=function(){return"Fib Circles"},TradingView.LineToolFibCircles.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},ArcWedgeRenderer.prototype.draw=function(e){if(e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.arc(this._data.center.x,this._data.center.y,this._data.radius,this._data.edge1,this._data.edge2,!0),e.stroke(),this._data.fillBackground){if(e.arc(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.edge2,this._data.edge1,!1),this._data.gradient){var t=e.createRadialGradient(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.center.x,this._data.center.y,this._data.radius);t.addColorStop(0,generateColor(this._data.color1,this._data.transparency)),t.addColorStop(1,generateColor(this._data.color2,this._data.transparency)),e.fillStyle=t}else e.fillStyle=generateColor(this._data.color,this._data.transparency);e.fill()}},ArcWedgeRenderer.prototype.hitTest=function(e){var t=e.substract(this._data.center).length(),i=this._hittest||new HitTestResult(HitTestResult.MOVEPOINT);if(this._data.fillBackground){if(t<=this._data.radius){var n=this._data.p1.substract(this._data.center).normalized(),o=this._data.p2.substract(this._data.center).normalized(),t=e.substract(this._data.center).normalized();if(e=n.dotProduct(o),n=t.dotProduct(n),t=t.dotProduct(o),n>=e&&t>=e)return i}}else if(4>=Math.abs(t-this._data.radius)&&(t=e.substract(this._data.p1).length(),o=e.substract(this._data.p2).length(),t=Math.max(t,o),o=this._data.p1.substract(this._data.p2).length(),o>=t))return i;return null},inherit($77,$90),$77.prototype._levelsCount=function(){return 11},$77.prototype.update=function(){if($90.prototype.update.call(this),this._levels=[],!(3>this._points.size())){var e=this._points,t=e.item(0),i=e.item(1),n=e.item(2),e=i.substract(t).normalized(),n=n.substract(t).normalized(),o=new MathEx.Point(1,0),r=new MathEx.Point(0,1),s=Math.acos(e.dotProduct(o));for(0>e.dotProduct(r)&&(s=2*Math.PI-s),this._edge1=s,o=Math.acos(n.dotProduct(o)),0>n.dotProduct(r)&&(o=2*Math.PI-o),this._edge2=o,o>s&&(this._edge1=Math.max(s,o),this._edge2=Math.min(s,o)+2*Math.PI),Math.abs(s-o)>Math.PI&&(this._edge1=Math.min(s,o),this._edge2=Math.max(s,o)-2*Math.PI),r=this.W99.properties(),s=1;s<=this._levelsCount();s++)if(o=r["level"+s],o.visible.value()){var a,l=o.coeff.value(),d=o.color.value(),h=i.substract(t).length()*l;r.showCoeffs.value()&&(a=""+l);var c=e.add(n).scaled(.5).normalized().scaled(h),c=t.add(c);this._levels.push({coeff:l,color:d,label:a,radius:h,labelPoint:c,p1:t.add(e.scaled(h)),p2:t.add(n.scaled(h)),linewidth:o.linewidth.value(),linestyle:o.linestyle.value(),index:s})}}},$77.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this.W99.properties(),i=this._points,n=i.item(0),o=i.item(1),r={points:(new List).append(n).append(o),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(r)),3>this._points.size())return this.addAnchors(e),e;var s=i.item(2),i=s.data,r=o.substract(n).length();for(o.substract(n).normalized(),s=s.substract(n).normalized(),s=n.add(s.scaled(r)),s.data=i,r={points:(new List).append(n).append(s),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(r)),i=this._levels.length-1;i>=0;i--){var r=this._levels[i],a={};a.center=this._points.item(0),a.radius=r.radius,a.prevRadius=i>0?this._levels[i-1].radius:0,a.edge=this._edge,a.color=r.color,a.linewidth=1,a.edge1=this._edge1,a.edge2=this._edge2,a.p1=r.p1,a.p2=r.p2,a.fillBackground=t.fillBackground.value(),a.transparency=t.transparency.value();var l=new HitTestResult(HitTestResult.MOVEPOINT,null,r.index);e.append(new ArcWedgeRenderer(a,l)),t.showCoeffs.value()&&(r={points:(new List).append(r.labelPoint),text:this._levels[i].label,color:this._levels[i].color,vertAlign:"middle",horzAlign:"center",font:t.font.value(),offsetX:0,offsetY:0,fontsize:12,bold:!0},e.append(new TextRenderer(r,this._rendererCache)))}return this.isAnchorsRequired()&&(i=(new List).append(n).append(o),this.D0.lineBeingCreated()!=this.W99&&i.append(s),e.append(this.createLineAnchor({points:i}))),e},TradingView.LineToolFibWedge=function(e,t){this._constructor="LineToolFibSpeedResistanceArcs";var i=t?t:new $52("linetoolfibwedge");W47.call(this,e,new $77(this,e),i)},inherit(TradingView.LineToolFibWedge,W47),TradingView.LineToolFibWedge.prototype.pointsCount=function(){return 3},TradingView.LineToolFibWedge.prototype.title=function(){return"Fib Wedge"},TradingView.LineToolFibWedge.prototype.setPoint=function(e,t){if(W47.prototype.setPoint.call(this,e,t),!this._recursiveGuard){if(this._recursiveGuard=!0,2==e){var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0],o=o.substract(i).length(),n=n.substract(i).normalized(),n=i.add(n.scaled(o)),i=this.priceScale().coordinateToPrice(n.y);e=Math.round(this.D0.timeScale().coordinateToIndex(n.x)),this.D2.points[1].price.setValue(i),this.D2.points[1].bar.setValue(e)}else{var i=this.pointToScreenPoint(this._points.item(0))[0],n=this.pointToScreenPoint(this._points.item(1))[0],o=this.pointToScreenPoint(this._points.item(2))[0],r=n.substract(i).length(),n=o.substract(i).normalized(),o=i.add(n.scaled(r)),i=this.priceScale().coordinateToPrice(o.y);e=Math.round(this.D0.timeScale().coordinateToIndex(o.x)),this.D2.points[2].price.setValue(i),this.D2.points[2].bar.setValue(e)}this._recursiveGuard=!1}},TradingView.LineToolFibWedge.prototype.addPoint=function(e){if(2==this._points.size()){var t=this.pointToScreenPoint(this._points.item(0))[0],i=this.pointToScreenPoint(this._points.item(1))[0];if(this.priceScale().isPercent()){var n=this.ownerSource().firstValue();e.price=this.priceScale().priceRange().convertFromPercent(e.price,n)}e=this.pointToScreenPoint(e)[0],i=i.substract(t).length(),e=e.substract(t).normalized(),e=t.add(e.scaled(i)),t=this.priceScale().coordinateToPrice(e.y),e={index:Math.round(this.D0.timeScale().coordinateToIndex(e.x)),price:t}}return W47.prototype.addPoint.call(this,e)},TradingView.LineToolFibWedge.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},inherit(W7,$77),W7.prototype.update=function(){$77.prototype.update.call(this)},W7.prototype._levelsCount=function(){return 1},W7.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this.W99.properties(),i=this._points,n=i.item(0),o=i.item(1),r={points:(new List).append(n).append(o),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(r)),3>this._points.size())return this.addAnchors(e),e;var s=i.item(2),i=s.data,r=o.substract(n).length();return o.substract(n).normalized(),o=s.substract(n).normalized(),s=n.add(o.scaled(r)),s.data=i,r={points:(new List).append(n).append(s),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:t.trendline.color.value(),linewidth:t.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(r)),n=this._levels[0],o={},o.center=this._points.item(0),o.radius=n.radius,o.prevRadius=0,o.edge=this._edge,o.color=t.trendline.color.value(),o.color1=t.color1.value(),o.color2=t.color2.value(),o.linewidth=t.linewidth.value(),o.edge1=this._edge1,o.edge2=this._edge2,o.p1=n.p1,o.p2=n.p2,o.fillBackground=t.fillBackground.value(),o.transparency=t.transparency.value(),o.gradient=!0,e.append(new ArcWedgeRenderer(o)),this.addAnchors(e),e},TradingView.LineToolProjection=function(e,t){this._constructor="LineToolProjection";var i=t?t:new $52("linetoolprojection");W47.call(this,e,new W7(this,e),i)},inherit(TradingView.LineToolProjection,TradingView.LineToolFibWedge),TradingView.LineToolProjection.prototype.title=function(){return"Projection"},inherit($68,$90),$68.prototype.renderer=function(){if(!this._wave)return null;for(var e=new CompositeRenderer,t=this.W99.properties(),i=t.wavesize.value(),n=this.W99.labels(),o=0;o<this._wave.length;o++)e.append(new TrendLineRenderer(this._wave[o]));var r=1;if(2<this._points.size())var s=this._points.item(2),o=this._points.item(1),r=MathEx.sign(s.y-o.y);var s=[],a=0;this.D0.lineBeingCreated()==this.W99&&(a=1);for(var l=new RGBColor(this.D0.backgroundColor()).blackWhiteContrast(),d=t.color.value(),o=0;o<this._points.size()-a;o++,r=-r){var h=n[i][o],c={points:(new List).append(this._points.item(o)),text:h,color:new RGBColor(d).darken("black"==l?15:-15).toHex(),vertAlign:1==r?"top":"bottom",horzAlign:"center",font:"Arial",offsetX:0,offsetY:1==r?5:-10,fontsize:12};s.push(c),t.showBackground.value()&&(c.borderColor=d,c.backgroundColor=generateColor(d,60)),""!=h&&e.append(new TextRenderer(c,this._rendererCache[o],new HitTestResult(HitTestResult.CHANGEPOINT,o)))}if(this.isAnchorsRequired()){for(t=new List,i=0;i<s.length;i++)n=this._points.item(i).clone(),n.y=s[i].points.item(0).y,n.data=i,t.append(n);this.D0.lineBeingCreated()==this.W99&&0<t.size()&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))}return e},$68.prototype.update=function(){$90.prototype.update.call(this),this._wave=[];var e=this.W99.properties(),t=this.W99.priceScale(),i=this.D0.timeScale();if(t&&!t.isEmpty()&&!i.isEmpty()){var n;this.W99.priceScale().isPercent()&&(n=this.W99.ownerSource().firstValue());var o=e.color.value();if(e.showWave.value())for(var e=this.W99.points(),r=1;r<e.size();r++){var s=e.item(r-1),a=e.item(r);this.D0.mainSeries().bars().valueAt(s.index),this.D0.mainSeries().bars().valueAt(a.index);var l=i.indexToCoordinate(s.index),d=i.indexToCoordinate(a.index),s=s.price,a=a.price;this.W99.priceScale().isPercent()&&(s=this.W99.priceScale().priceRange().convertToPercent(s,n),a=this.W99.priceScale().priceRange().convertToPercent(a,n)),s=t.priceToCoordinate(s),a=t.priceToCoordinate(a),l={points:(new List).append(new MathEx.Point(l,s)).append(new MathEx.Point(d,a)),width:i.width(),height:t.height(),color:generateColor(o,0),linewidth:3,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_CIRCLE,rightend:W47.LINEEND_CIRCLE,endstyle:{strokeWidth:1,fillStyle:this.D0.backgroundColor()},overlayLineEndings:!0},this._wave.push(l)}}},TradingView.LineToolElliott=function(e,t){var i=t?t:new $52("linetoolelliott");W47.call(this,e,new $68(this,e),i)},inherit(TradingView.LineToolElliott,W47),TradingView.LineToolElliott.prototype.title=function(){return"Elliott Labels"},TradingView.LineToolElliott5Points=function(e,t){var i=t?t:new $52("linetoolelliott");W47.call(this,e,new $68(this,e),i),this.version=TradingView.LineToolElliott5Points.version},inherit(TradingView.LineToolElliott5Points,TradingView.LineToolElliott),TradingView.LineToolElliott5Points.version=2,TradingView.LineToolElliott5Points.prototype.pointsCount=function(){return 6},TradingView.LineToolElliott5Points.prototype.labels=function(){return[" i ii iii iv v".split(" ")," (i) (ii) (iii) (iv) (v)".split(" ")," ((i)) ((ii)) ((iii)) ((iv)) ((v))".split(" ")," 1 2 3 4 5".split(" ")," (1) (2) (3) (4) (5)".split(" ")," ((1)) ((2)) ((3)) ((4)) ((5))".split(" ")," I II III IV V".split(" ")," (I) (II) (III) (IV) (V)".split(" ")," ((I)) ((II)) ((III)) ((IV)) ((V))".split(" ")]},TradingView.LineToolElliott5Points.prototype.migrateVersion=function(e,t,i){1==e&&(e=$.extend({},this._timePoint.item(0)),this._timePoint.insert(e,0),0<this._points.size()&&(e=$.extend({},this._points.item(0)),this._points.insert(e,0)))},TradingView.LineToolElliottSubminuette=function(e,t){this._constructor="LineToolElliottSubminuette";var i=t?t:new $52("linetoolelliottsubminuette");TradingView.LineToolElliott5Points.call(this,e,i)},inherit(TradingView.LineToolElliottSubminuette,TradingView.LineToolElliott5Points),TradingView.LineToolElliottMinor=function(e,t){this._constructor="LineToolElliottMinor";var i=t?t:new $52("linetoolelliottminor");TradingView.LineToolElliott5Points.call(this,e,i)},inherit(TradingView.LineToolElliottMinor,TradingView.LineToolElliott5Points),TradingView.LineToolElliottCircle=function(e,t){this._constructor="LineToolElliottCircle";var i=t?t:new $52("linetoolelliottcircle");TradingView.LineToolElliott5Points.call(this,e,i)},inherit(TradingView.LineToolElliottCircle,TradingView.LineToolElliott5Points),TradingView.LineToolElliott3Points=function(e,t){var i=t?t:new $52("linetoolelliott");W47.call(this,e,new $68(this,e),i),this.version=TradingView.LineToolElliott3Points.version},inherit(TradingView.LineToolElliott3Points,TradingView.LineToolElliott),TradingView.LineToolElliott3Points.version=2,TradingView.LineToolElliott3Points.prototype.pointsCount=function(){return 4},TradingView.LineToolElliott3Points.prototype.labels=function(){return[["","a","b","c"],["","A","B","C"]]},TradingView.LineToolElliott3Points.prototype.migrateVersion=function(e,t,i){1==e&&(e=$.extend({},this._timePoint.item(0)),this._timePoint.insert(e,0),0<this._points.size()&&(e=$.extend({},this._points.item(0)),this._points.insert(e,0)))},TradingView.LineToolElliottMinorRetr=function(e,t){this._constructor="LineToolElliottMinorRetr";var i=t?t:new $52("linetoolelliottminorretr");TradingView.LineToolElliott3Points.call(this,e,i)},inherit(TradingView.LineToolElliottMinorRetr,TradingView.LineToolElliott3Points),TradingView.LineToolElliottMajorRetr=function(e,t){this._constructor="LineToolElliottMajorRetr";var i=t?t:new $52("linetoolelliottmajorretr");TradingView.LineToolElliott3Points.call(this,e,i)},inherit(TradingView.LineToolElliottMajorRetr,TradingView.LineToolElliott3Points),inherit($93,$90),$93.prototype.update=function(){if($90.prototype.update.call(this),!(2>this.W99.points().size())){var e=this.D0.timeScale();if(this.W99.priceScale()&&!this.W99.priceScale().isEmpty()&&!e.isEmpty()){var t=this.W99.points().item(0),i=this.W99.points().item(1),i=i?i.index-t.index:1;if(this._lines=[],0!==i){var n=e.visibleBars();if(i>0)for(t=t.index;t<=n.lastBar();t+=i)this._lines.push({x:e.indexToCoordinate(t)});else for(t=t.index;t>=n.firstBar();t+=i)this._lines.push({x:e.indexToCoordinate(t)})}}}},$93.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=this.W99.properties(),n={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};for(e.append(new TrendLineRenderer(n)),n=this.W99.properties(),t=0;t<this._lines.length;t++)i={points:(new List).append(new MathEx.Point(this._lines[t].x,0)),color:n.linecolor.value(),linewidth:n.linewidth.value(),linestyle:n.linestyle.value()},e.append(new VertLineRenderer(i));return this.isAnchorsRequired()&&(2===this.W99.points().size()?(n=this._points.clone(),e.append(this.createLineAnchor({points:n}))):(n=new List,n.append(new MathEx.Point(this._points.item(0).x,this.W99.priceScale().height()/2)),e.append(this.createLineAnchor({points:n,hittestResult:HitTestResult.MOVEPOINT})))),e},TradingView.LineToolCircleLines=function(e,t){this._constructor="LineToolCircleLines";var i=t?t:new $52("linetoolcirclelines");W47.call(this,e,new $93(this,e),i)},inherit(TradingView.LineToolCircleLines,W47),TradingView.LineToolCircleLines.prototype.pointsCount=function(){return 2},TradingView.LineToolCircleLines.prototype.title=function(){return"Cyclic Lines"},TradingView.LineToolVbPFixed=function(e,t,i){var n=TradingView.Study.lineToolNameForPointsBasedStudy("VbPFixed@tv-volumebyprice");i=i?i:StudyMetaInfo.findStudyMetaInfo(e.studiesMetaData(),"VbPFixed@tv-volumebyprice");var o=e.studyVersioning();t=t?t:TradingView.prepareStudyProperties(i,null,null,o);var o=new W31(this,e),r=new TradingView.Study.StudyPaneView_hhists(this,e),s=new TradingView.Study.StudyPaneView_horizlines(this,e),a=new TradingView.Study.StudyPaneView_polygons(this,e);A63.call(this,e,[o,r,s,a],t,n),this._turnaroundCounter=1,this._turnaround="vbpfixed_"+this._turnaroundCounter,this._metaInfo=i,this._graphics=new A62(i),this._formatter=new VolumeFormatter},inherit(TradingView.LineToolVbPFixed,A63),TradingView.LineToolVbPFixed.prototype.pointsCount=function(){return 2},TradingView.LineToolVbPFixed.prototype._requestStudy=function(){var e=this.points().item(0),t=this.points().item(1),i=Math.min(e.index,t.index),e=Math.max(e.index,t.index);if(i===e)this.clearData();else if(i=this.D0.mainSeries().bars().valueAt(i),e=this.D0.mainSeries().bars().valueAt(e),i&&e){i=1e3*i[TIME_PLOT],e=1e3*e[TIME_PLOT],t=[],t.push(this.properties().inputs.rows.value()),t.push(this.properties().inputs.volume.value()),t.push(i),t.push(e),t.push(this.properties().inputs.vaVolume.value());var n=this;this._studyId?(this._turnaround="vbpfixed_"+ ++this._turnaroundCounter,this.D0.chartApi().modifyStudy(this._studyId,this._turnaround,t,function(e){n.onData(e)})):(this._studyId=TradingView.Study.makeNextStudyId(),this.D0.chartApi().createStudy(this._studyId,this._turnaround,this.D0.mainSeries()._seriesId,this._metaInfo.id+"-1!",t,function(e){n.onData(e)}))}},TradingView.LineToolVbPFixed.prototype.onData=function(e){"data_update"===e.method&&e.params.customId==="pointset_"+this._currentPointsetId?(W47.prototype.onData.call(this,e),2==this._points.size()&&this._requestStudy()):"data_update"===e.method&&e.params.customId===this._studyId&&this._checkTurnaround(e.params.turnaround)&&(e.params.nonseries.d=""!==e.params.nonseries.d?JSON.parse(e.params.nonseries.d):"",""!==e.params.nonseries.d&&(this._graphics.process(e.params.nonseries),this._correctPoints(this._graphics.graphics())),0<e.params.nonseries.indexes.length&&(this._indexes=e.params.nonseries.indexes),this.updateAllViews(),this.D0.updateSource(this))},TradingView.LineToolVbPFixed.prototype._correctPoints=function(e){if(e&&(void 0==e.indexes||0!=e.indexes.length)){e=e.hhists[0].data;for(var t=null,i=null,n=0;n<e.length;++n){var o=e[n].priceLow,r=e[n].priceHigh;(!t||t>o)&&(t=o),(!i||r>i)&&(i=r)}this._points.item(0).price=i,this._points.item(1).price=t}},TradingView.LineToolVbPFixed.prototype.calcIsActualSymbol=function(){this._isActualSymbol=!0},TradingView.LineToolVbPFixed.prototype.formatter=function(){return this._formatter},W9=function(e,t){$90.call(this,e,t),this._rendererCache={}},inherit(W9,$90),W9.prototype._formatInTicks=function(e){var t=this.D0.mainSeries().base();return Math.round(e*t)},W9.INDEX_ENTRY=0,W9.INDEX_CLOSE=1,W9.INDEX_ACTUALENTRY=2,W9.INDEX_ACTUALCLOSE=3,W9.prototype.update=function(){$90.prototype.update.call(this),this._profitLevel=this._stopLevel=null;var e=this.D0.timeScale(),t=this.W99.priceScale();if(t&&!t.isEmpty()&&!e.isEmpty()&&0!=this.W99.points().size()&&0!=this._points.size()&&this.D0.mainSeries().bars().last()&&!(2>this.W99.points().size())&&0!=this.D0.mainSeries().bars().size()){if(this._isClosed=4==this.W99.points().size()){if(e=this.W99.points().item(W9.INDEX_ACTUALCLOSE).price,this.W99.points().item(W9.INDEX_ACTUALCLOSE).index<parseInt(this.W99.D0.mainSeries().bars().first()))return;var i=Math.min(parseInt(this.W99.D0.mainSeries().bars().last()),this.W99.points().item(W9.INDEX_ACTUALCLOSE).index)}else{if(this.W99.points().item(W9.INDEX_CLOSE).index<parseInt(this.W99.D0.mainSeries().bars().first()))return;i=Math.min(parseInt(this.W99.D0.mainSeries().bars().last()),this.W99.points().item(W9.INDEX_CLOSE).index),e=this.D0.mainSeries().bars().valueAt(i)[CLOSE_PLOT]}this._closeBar=this.W99.D0.timeScale().indexToCoordinate(i);var n=this.W99.priceScale(),o=this.W99.stopPrice(),r=this.W99.profitPrice();if(this._pl=1<this.W99.points().size()?this.W99.calculatePL(e):0,n.isPercent())var s=this.W99.ownerSource().firstValue(),o=n.priceRange().convertToPercent(o,s),r=n.priceRange().convertToPercent(r,s),e=n.priceRange().convertToPercent(e,s);this._entryLevel=this._points.item(W9.INDEX_ENTRY).y,this._stopLevel=t.priceToCoordinate(o),this._profitLevel=t.priceToCoordinate(r),this._closeLevel=t.priceToCoordinate(e),this._closeBar=this.W99.D0.timeScale().indexToCoordinate(i)}},W9.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size()||2>this.W99.points().size())return e;var t=this,i=this.W99.properties();this.D0.timeScale();var n=this._points.item(W9.INDEX_ENTRY).x,o=this._points.item(W9.INDEX_ACTUALENTRY)?this._points.item(W9.INDEX_ACTUALENTRY).x:this._points.item(W9.INDEX_CLOSE).x,r=this._points.item(W9.INDEX_ACTUALCLOSE)?this._points.item(W9.INDEX_ACTUALCLOSE).x:this._points.item(W9.INDEX_CLOSE).x,s=this._points.item(W9.INDEX_CLOSE).x,a=new MathEx.Point(n,this._entryLevel),l=new MathEx.Point(s,this._stopLevel),d={};if(d.points=(new List).append(a).append(l),d.color="white",d.linewidth=0,d.backcolor=i.stopBackground.value(),d.fillBackground=!0,d.transparency=i.stopBackgroundTransparency.value(),e.append(new RectangleRenderer(d)),0>this._pl){a=new MathEx.Point(o,this._entryLevel),l=new MathEx.Point(r,this._closeLevel),d={},d.points=(new List).append(a).append(l),d.color="white",d.linewidth=0,d.backcolor=i.stopBackground.value(),d.fillBackground=!0;var h=.01*i.stopBackgroundTransparency.value();d.transparency=100-100*(1-h*h*h),e.append(new RectangleRenderer(d))}a=new MathEx.Point(n,this._entryLevel),l=new MathEx.Point(s,this._profitLevel),d={},d.points=(new List).append(a).append(l),d.color="white",d.linewidth=0,d.backcolor=i.profitBackground.value(),d.fillBackground=!0,d.transparency=i.profitBackgroundTransparency.value(),e.append(new RectangleRenderer(d)),0<this._pl&&(a=new MathEx.Point(o,this._entryLevel),l=new MathEx.Point(r,this._closeLevel),d={},d.points=(new List).append(a).append(l),d.color="white",d.linewidth=0,d.backcolor=i.profitBackground.value(),d.fillBackground=!0,h=.01*i.profitBackgroundTransparency.value(),d.transparency=100-100*(1-h*h*h),e.append(new RectangleRenderer(d))),o=function(i,n,o){var r={};r.points=(new List).append(i).append(n),r.width=t.D0.timeScale().width(),r.height=t.W99.priceScale().height(),r.color=o?o:t.W99.properties().linecolor.value(),r.linewidth=t.W99.properties().linewidth.value(),r.linestyle=CanvasEx.LINESTYLE_SOLID,r.extendleft=!1,r.extendright=!1,r.leftend=W47.LINEEND_NORMAL,r.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(r))},this._points.item(W9.INDEX_ACTUALENTRY)&&(a=this._points.item(W9.INDEX_ACTUALENTRY),l=this._isClosed?this._points.item(W9.INDEX_ACTUALCLOSE):new MathEx.Point(this._closeBar,this._closeLevel),d={},d.points=(new List).append(a).append(l),d.width=t.D0.timeScale().width(),d.height=t.W99.priceScale().height(),d.color=t.W99.properties().linecolor.value(),d.linewidth=1,d.linestyle=CanvasEx.LINESTYLE_DASHED,d.extendleft=!1,d.extendright=!1,d.leftend=W47.LINEEND_NORMAL,d.rightend=W47.LINEEND_ARROW,e.append(new TrendLineRenderer(d)));var t=this,d=function(n,o,r,s,a,l){if(t.isAnchorsRequired()||TradingView.printing){var d={};d.points=(new List).append(n),d.text=o,d.color=i.textcolor.value(),d.font=i.font.value(),d.offsetX=3,d.offsetY=a,d.vertAlign=s,d.horzAlign="center",d.backgroundRoundRect=4,d.backgroundColor=r,d.fontsize=i.fontsize.value(),d.backgroundHorzInflate=4,d.backgroundVertInflate=2,l&&(d.borderColor=l),e.append(new TextRenderer(d,t._rendererCache))}},r=this.W99.entryPrice(),h=this.W99.stopPrice(),a=this.W99.profitPrice(),c=Math.abs(h-r),p=Math.round(1e4*c/r)/100,u=Math.abs(a-r),f=Math.round(1e4*u/r)/100,g=Math.abs(r-a)/Math.abs(r-h),a=new MathEx.Point(n,this._points.item(W9.INDEX_ENTRY).y),l=new MathEx.Point(s,this._points.item(W9.INDEX_ENTRY).y);return o(a,l),a=new MathEx.Point((n+s)/2,Math.round(this._points.item(0).y)+.5),l="",this._points.item(1)&&void 0!==this._pl&&(l=this._isClosed?" "+$.t("Closed",{context:"line_tool_position"}):$.t("Open",{context:"line_tool_position"}),l=$.t("{0} P&L: {1}").format(l,this.W99.priceScale().formatter().format(this._pl))+"\n"),l+=$.t("Risk/Reward Ratio: {0}").format(Math.round(100*g)/100)+" ",g=i.linecolor.value(),0>this._pl?g=i.stopBackground.value():0<this._pl&&(g=i.profitBackground.value()),d(a,l,g,"middle",0,"white"),a=new MathEx.Point(n,this._stopLevel),l=new MathEx.Point(s,this._stopLevel),o(a,l,i.stopBackground.value()),a=new MathEx.Point((n+s)/2,this._stopLevel),l=$.t("Stop: {0} ({1}%)").format(this.W99.priceScale().formatter().format(c),p),d(a,l,i.stopBackground.value(),h>r?"bottom":"top",h>r?-12:-1),a=new MathEx.Point(n,this._profitLevel),l=new MathEx.Point(s,this._profitLevel),o(a,l,i.profitBackground.value()),a=new MathEx.Point((n+s)/2,this._profitLevel),l=$.t("Target: {0} ({1}%)").format(this.W99.priceScale().formatter().format(u),f),d(a,l,i.profitBackground.value(),h>r?"top":"bottom",h>r?-1:-12),this.isAnchorsRequired()&&(o=new List,d=this._points.item(0).clone(),d.data=0,o.append(d),r=new MathEx.Point(n,this._stopLevel),r.data=1,o.append(r),n=new MathEx.Point(n,this._profitLevel),n.data=2,o.append(n),s=new MathEx.Point(s,d.y),s.data=3,o.append(s),e.append(this.createLineAnchor({points:o}))),e},inherit(LineToolRiskRewardPriceAxisView,PriceAxisView),LineToolRiskRewardPriceAxisView.prototype.update=function(){if(0!==this.W99.points().size()&&this.W99.priceScale()&&!this.W99.priceScale().isEmpty()){
var e=this.W99.properties()[this._pricePropName].value();this._background=this.W99.properties()[this._colorPropName].value(),this._coordinate=this.W99.priceScale().priceToCoordinate(e),this._textHeight=this.W99.priceScale().m_markBuilder.fontHeight(),this._text=this.W99.priceScale().formatter().format(e)}},LineToolRiskRewardPriceAxisView.prototype.renderer=function(){var e={text:this._text,coordinate:this._coordinate,color:this.color(),background:this._background,textHeight:this._textHeight,visible:!0};return new PriceAxisViewRenderer(e)},TradingView.LineToolRiskReward=function(e,t){var i=t?t:new $52("linetoolriskreward");if(W47.call(this,e,new W9(this,e),i),this.D2.addExclusion&&(this.D2.addExclusion("stopLevel"),this.D2.addExclusion("profitLevel")),!t.stopLevel&&!t.profitLevel){var n=e.timeScale().visibleBars(),o=n.firstBar(),n=n.lastBar(),r=e.mainSeries().priceRange(o,n),o=e.mainSeries().priceScale();if(o.isLog()&&(n=o.logicalToPrice(r.minValue()),r=o.logicalToPrice(r.maxValue()),r=new PriceRange(n,r)),o.isPercent())var s=e.mainSeries().firstValue(),n=o.priceRange().convertFromPercent(r.minValue(),s),r=o.priceRange().convertFromPercent(r.maxValue(),s),r=new PriceRange(n,r);r&&!r.isEmpty()&&(o=Math.round(.2*r.length()*e.mainSeries().base()),i.merge({stopLevel:o,profitLevel:o}))}var a=this;i.stopLevel.listeners().subscribe(this,TradingView.LineToolRiskReward.prototype.recalculate),i.stopLevel.listeners().subscribe(null,function(){a.properties().stopPrice._listeners.fire(a.properties().stopPrice)}),i.profitLevel.listeners().subscribe(this,TradingView.LineToolRiskReward.prototype.recalculate),i.profitLevel.listeners().subscribe(null,function(){a.properties().targetPrice._listeners.fire(a.properties().targetPrice)}),i.addProperty("entryPrice"),i.entryPrice=new TradingView.LineToolRiskReward.PriceProperty(this,0),i.addProperty("stopPrice"),i.stopPrice=new TradingView.LineToolRiskReward.StopPriceProperty(this),i.addProperty("targetPrice"),i.targetPrice=new TradingView.LineToolRiskReward.TargetPriceProperty(this),this._entryPriceAxisView=new LineToolRiskRewardPriceAxisView(this,e,"entryPrice","linecolor"),this._stopPriceAxisView=new LineToolRiskRewardPriceAxisView(this,e,"stopPrice","stopBackground"),this._profitPriceAxisView=new LineToolRiskRewardPriceAxisView(this,e,"targetPrice","profitBackground"),this.version=TradingView.LineToolRiskReward.version},inherit(TradingView.LineToolRiskReward,W47),TradingView.LineToolRiskReward.version=2,TradingView.LineToolRiskReward.prototype.migrateVersion=function(e,t,i){1==e&&1<=this._points.size()&&(e=new List,e.append(this._points.item(0)),t=this._points.item(0),t={price:t.price,index:t.index+50},e.append(t),this._points.item(1)&&e.append(this._points.item(1)),this._points.item(2)&&e.append(this._points.item(2)),this._points=e,1<=this._timePoint.size()&&(i=new List,t=this._timePoint.item(0),i.append(t),i.append({price:t.price,time_t:t.time_t,offset:t.offset+50}),this._timePoint.item(1)&&e.append(this._points.item(1)),this._timePoint.item(2)&&e.append(this._points.item(2)),this._timePoint=i))},TradingView.LineToolRiskReward.prototype.checkAlert=function(){this.recalculate()},TradingView.LineToolRiskReward.prototype.priceAxisViews=function(e,t){return this._isActualSymbol&&this.D0.paneForSource(this)===e&&t===this.priceScale()?(new List).append(this._entryPriceAxisView).append(this._stopPriceAxisView).append(this._profitPriceAxisView):null},TradingView.LineToolRiskReward.prototype.updateAllViews=function(){!this._isActualSymbol||!this.D2.visible.value()||TradingView.drawingState.hideAllDrawings().value()&&this.userEditEnabled()||(W47.prototype.updateAllViews.call(this),this._entryPriceAxisView.update(),this._stopPriceAxisView.update(),this._profitPriceAxisView.update())},TradingView.LineToolRiskReward.prototype.setPoint=function(e,t){var i=this.priceScale();if(i.isPercent()){var n=this.ownerSource().firstValue();t.price=i.priceRange().convertFromPercent(t.price,n)}switch(e){case 0:t.price=this._roundPrice(t.price),i.isPercent()&&(t.price=i.priceRange().convertToPercent(t.price,n)),W47.prototype.setPoint.call(this,e,t),this.recalculate();break;case 1:this.properties().stopPrice.setValue(this.preparseStopPrice(t.price));break;case 2:this.properties().targetPrice.setValue(this.preparseProfitPrice(t.price));break;case 3:t.price=this._roundPrice(t.price),i.isPercent()&&(t.price=i.priceRange().convertToPercent(t.price,n)),W47.prototype.setPoint.call(this,1,t),this.recalculate()}},TradingView.LineToolRiskReward.PriceProperty=function(e,t){W47.PointPriceProperty.call(this,e,t)},inherit(TradingView.LineToolRiskReward.PriceProperty,W47.PointPriceProperty),TradingView.LineToolRiskReward.PriceProperty.prototype.setValue=function(e){var t=this._lineSource.points().item(this._pointIndex);t.price=parseFloat(e),this._lineSource.setPoint(this._pointIndex,t),this._lineSource.recalculate(),this._lineSource.D0.updateSource(this._lineSource),this._listeners.fire(this),this._lineSource.endChanging()},TradingView.LineToolRiskReward.StopPriceProperty=function(e){TradingView.LineToolRiskReward.PriceProperty.call(this,e,1)},inherit(TradingView.LineToolRiskReward.StopPriceProperty,TradingView.LineToolRiskReward.PriceProperty),TradingView.LineToolRiskReward.StopPriceProperty.prototype.value=function(){var e=this._lineSource.stopPrice();return parseFloat(this._lineSource.priceScale().formatter().format(e))},TradingView.LineToolRiskReward.StopPriceProperty.prototype.setValue=function(e){e=Math.round(Math.abs(e-this._lineSource.entryPrice())*this._lineSource.D0.mainSeries().base()),this._lineSource.properties().stopLevel.setValue(e),this._lineSource.properties().stopLevel.listeners().fire(this._lineSource.properties().stopLevel)},TradingView.LineToolRiskReward.TargetPriceProperty=function(e){TradingView.LineToolRiskReward.PriceProperty.call(this,e,2)},inherit(TradingView.LineToolRiskReward.TargetPriceProperty,TradingView.LineToolRiskReward.PriceProperty),TradingView.LineToolRiskReward.TargetPriceProperty.prototype.value=function(){var e=this._lineSource.profitPrice();return parseFloat(this._lineSource.priceScale().formatter().format(e))},TradingView.LineToolRiskReward.TargetPriceProperty.prototype.setValue=function(e){e=Math.round(Math.abs(e-this._lineSource.entryPrice())*this._lineSource.D0.mainSeries().base()),this._lineSource.properties().profitLevel.setValue(e),this._lineSource.properties().profitLevel.listeners().fire(this._lineSource.properties().profitLevel)},TradingView.LineToolRiskReward.prototype.pointsCount=function(){return 1},TradingView.LineToolRiskReward.prototype.title=function(){return"Risk/Reward"},TradingView.LineToolRiskReward.prototype.addPoint=function(e){var t=this.priceScale();if(t.isPercent()){var i=this.ownerSource().firstValue();e.price=t.priceRange().convertFromPercent(e.price,i)}return e.price=this._roundPrice(e.price),this._points.append(e),t={price:e.price,index:e.index+50},this._points.append(t),(e=this.calculateActualEntry(e,t))&&(this._points.append(e),(t=this.findClosePoint(e,t))&&this._points.append(t)),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0},TradingView.LineToolRiskReward.prototype._roundPrice=function(e){var t=this.D0.mainSeries().base();return Math.round(e*t)/t},TradingView.LineToolRiskReward.prototype.recalculate=function(){if(this.properties().interval.value()==this.D0.mainSeries().interval()&&0!=this.points().size()){var e=this.properties().targetPrice.value(),t=this.properties().stopPrice.value(),i=new List;i.append(this._points.item(0)),i.append(this._points.item(1));var n=this.calculateActualEntry(this.points().item(0),this.points().item(1));n&&(i.append(n),(n=this.findClosePoint(n,this.points().item(1)))&&i.append(n)),this._points=i,e!==this.properties().targetPrice.value()&&this.properties().targetPrice._listeners.fire(this.properties().targetPrice),t!==this.properties().stopPrice.value()&&this.properties().stopPrice._listeners.fire(this.properties().stopPrice)}},TradingView.LineToolRiskReward.prototype.startMoving=function(e){e.price=this._roundPrice(e.price),W47.prototype.startMoving.call(this,e)},TradingView.LineToolRiskReward.prototype.move=function(e){e.price=this._roundPrice(e.price),W47.prototype.move.call(this,e),this.recalculate(),this._entryPriceAxisView.update()},TradingView.LineToolRiskReward.prototype.correctPoints=function(e){W47.prototype.correctPoints.call(this,(new List).append(e.item(0)).append(e.item(1)))},TradingView.LineToolRiskReward.prototype.entryPrice=function(){return this.points().item(0).price},TradingView.LineToolRiskReward.prototype.findClosePoint=function(e,t){for(var i=this.D0.mainSeries().bars(),n=parseInt(i.first(),10),o=Math.max(e.index,n),n=parseInt(i.last(),10);o<=Math.min(n,t.index);o++){var r=i.valueAt(o),r=this.checkStopPrice(r);if(null!=r)return{index:o,price:r}}return null},TradingView.LineToolRiskReward.prototype.calculateActualEntry=function(e,t){for(var i=this.D0.mainSeries().bars(),n=parseInt(i.first(),10),o=Math.max(e.index,n),n=e.price,r=parseInt(i.last(),10);o<=Math.min(r,t.index);o++){var s=i.valueAt(o);if(s[HIGH_PLOT]>=n&&s[LOW_PLOT]<=n)return{index:o,price:n}}return null},TradingView.LineToolRiskRewardShort=function(e,t){this._constructor="LineToolRiskRewardShort";var i=t?t:new $52("linetoolriskrewardshort");TradingView.LineToolRiskReward.call(this,e,i)},inherit(TradingView.LineToolRiskRewardShort,TradingView.LineToolRiskReward),TradingView.LineToolRiskRewardShort.prototype.title=function(){return"Risk/Reward short"},TradingView.LineToolRiskRewardShort.prototype.stopPrice=function(){return this.entryPrice()+this.properties().stopLevel.value()/this.D0.mainSeries().base()},TradingView.LineToolRiskRewardShort.prototype.profitPrice=function(){return this.entryPrice()-this.properties().profitLevel.value()/this.D0.mainSeries().base()},TradingView.LineToolRiskRewardShort.prototype.calculatePL=function(e){return this.entryPrice()-e},TradingView.LineToolRiskRewardShort.prototype.preparseStopPrice=function(e){e=this._roundPrice(e);var t=this.entryPrice()+1/this.D0.mainSeries().base();return Math.max(e,t)},TradingView.LineToolRiskRewardShort.prototype.preparseProfitPrice=function(e){e=this._roundPrice(e);var t=this.entryPrice()-1/this.D0.mainSeries().base();return Math.min(e,t)},TradingView.LineToolRiskRewardShort.prototype.checkStopPrice=function(e){var t=this.stopPrice(),i=this.profitPrice();return e[HIGH_PLOT]>=t?this.stopPrice():e[LOW_PLOT]<=i?this.profitPrice():null},TradingView.LineToolRiskRewardLong=function(e,t){this._constructor="LineToolRiskRewardLong";var i=t?t:new $52("linetoolriskrewardlong");TradingView.LineToolRiskReward.call(this,e,i)},inherit(TradingView.LineToolRiskRewardLong,TradingView.LineToolRiskReward),TradingView.LineToolRiskRewardLong.prototype.stopPrice=function(){return this.entryPrice()-this.properties().stopLevel.value()/this.D0.mainSeries().base()},TradingView.LineToolRiskRewardLong.prototype.profitPrice=function(){return this.entryPrice()+this.properties().profitLevel.value()/this.D0.mainSeries().base()},TradingView.LineToolRiskRewardLong.prototype.calculatePL=function(e){return e-this.entryPrice()},TradingView.LineToolRiskRewardLong.prototype.preparseStopPrice=function(e){e=this._roundPrice(e);var t=this.entryPrice()-1/this.D0.mainSeries().base();return Math.min(e,t)},TradingView.LineToolRiskRewardLong.prototype.preparseProfitPrice=function(e){e=this._roundPrice(e);var t=this.entryPrice()+1/this.D0.mainSeries().base();return Math.max(e,t)},TradingView.LineToolRiskRewardLong.prototype.checkStopPrice=function(e){var t=this.stopPrice(),i=this.profitPrice();return e[LOW_PLOT]<=t?this.stopPrice():e[HIGH_PLOT]>=i?this.profitPrice():null},TradingView.LineToolRiskRewardLong.prototype.title=function(){return"Risk/Reward long"},inherit($99,$90),$99.prototype.renderer=function(){if(2>this._points.size())return null;var e=this.W99.properties(),t=new CompositeRenderer,i=new List;i.append(this._points.item(0)),i.append(this._points.item(1)),i.append(3>this._points.size()?this._points.item(1):this._points.item(2));var n=this,o=function(t,i){return{points:(new List).append(t),text:i,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:n.W99.properties().color.value(),backgroundRoundRect:4}},r=function(e,t){return{points:(new List).append(e).append(t),width:n.D0.timeScale().width(),height:n.W99.priceScale().height(),color:n.W99.properties().color.value(),linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL}},s={};return s.points=i,s.color=e.color.value(),s.linewidth=e.linewidth.value(),s.backcolor=e.backgroundColor.value(),s.fillBackground=e.fillBackground.value(),s.transparency=e.transparency.value(),t.append(new TriangleRenderer(s)),3<this._points.size()&&(i=new List,i.append(this._points.item(2)),i.append(this._points.item(3)),i.append(5==this._points.size()?this._points.item(4):this._points.item(3)),s={},s.points=i,s.color=e.color.value(),s.linewidth=e.linewidth.value(),s.backcolor=e.backgroundColor.value(),s.fillBackground=e.fillBackground.value(),s.transparency=e.transparency.value(),t.append(new TriangleRenderer(s))),3<=this._points.size()&&(i=this._points.item(0).add(this._points.item(2)).scaled(.5),i=o(i,this._ABRetracement),t.append(new TextRenderer(i,this._rendererCache))),4<=this._points.size()&&(i=this._points.item(1).add(this._points.item(3)).scaled(.5),s=r(this._points.item(1),this._points.item(3)),t.append(new TrendLineRenderer(s)),i=o(i,this._BCRetracement),t.append(new TextRenderer(i,this._rendererCache))),5<=this._points.size()&&(i=this._points.item(2).add(this._points.item(4)).scaled(.5),i=o(i,this._CDRetracement),t.append(new TextRenderer(i,this._rendererCache)),s=r(this._points.item(0),this._points.item(4)),t.append(new TrendLineRenderer(s)),i=this._points.item(0).add(this._points.item(4)).scaled(.5),i=o(i,this._XDRetracement),t.append(new TextRenderer(i,this._rendererCache))),i=o(this._points.item(0),"X"),this._points.item(1).y>this._points.item(0).y?(i.vertAlign="bottom",i.offsetY=-10):(i.vertAlign="top",i.offsetY=5),t.append(new TextRenderer(i,this._rendererCache)),i=o(this._points.item(1),"A"),this._points.item(1).y<this._points.item(0).y?(i.vertAlign="bottom",i.offsetY=-10):(i.vertAlign="top",i.offsetY=5),t.append(new TextRenderer(i,this._rendererCache)),2<this._points.size()&&(i=o(this._points.item(2),"B"),this._points.item(2).y<this._points.item(1).y?(i.vertAlign="bottom",i.offsetY=-10):(i.vertAlign="top",i.offsetY=5),t.append(new TextRenderer(i,this._rendererCache))),3<this._points.size()&&(i=o(this._points.item(3),"C"),this._points.item(3).y<this._points.item(2).y?(i.vertAlign="bottom",i.offsetY=-10):(i.vertAlign="top",i.offsetY=5),t.append(new TextRenderer(i,this._rendererCache))),4<this._points.size()&&(i=o(this._points.item(4),"D"),this._points.item(4).y<this._points.item(3).y?(i.vertAlign="bottom",i.offsetY=-10):(i.vertAlign="top",i.offsetY=5),t.append(new TextRenderer(i,this._rendererCache))),this.isAnchorsRequired()&&(i=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&i.removeAt(i.size()-1),t.append(this.createLineAnchor({points:i}))),t},$99.prototype.update=function(){if($90.prototype.update.call(this),3<=this.W99.points().size()){var e=this.W99.points().item(0),t=this.W99.points().item(1),i=this.W99.points().item(2);this._ABRetracement=Math.round(1e3*Math.abs((i.price-t.price)/(t.price-e.price)))/1e3}if(4<=this.W99.points().size()){var n=this.W99.points().item(3);this._BCRetracement=Math.round(1e3*Math.abs((n.price-i.price)/(i.price-t.price)))/1e3}if(5<=this.W99.points().size()){var o=this.W99.points().item(4);this._CDRetracement=Math.round(1e3*Math.abs((o.price-n.price)/(n.price-i.price)))/1e3,this._XDRetracement=Math.round(1e3*Math.abs((o.price-t.price)/(t.price-e.price)))/1e3}},TradingView.LineTool5PointsPattern=function(e,t){this._constructor="LineTool5PointsPattern";var i=t?t:new $52("linetool5pointspattern");W47.call(this,e,new $99(this,e),i)},inherit(TradingView.LineTool5PointsPattern,W47),TradingView.LineTool5PointsPattern.prototype.pointsCount=function(){return 5},TradingView.LineTool5PointsPattern.prototype.title=function(){return"XABCD Pattern"},TradingView.LineTool5PointsPattern.prototype._tooltipFieldsHash={time0:{title:"Date 1",value:null},price0:{title:"Price 1",value:null},time1:{title:"Date 2",value:null},price1:{title:"Price 2",value:null},time2:{title:"Date 3",value:null},price2:{title:"Price 3",value:null},time3:{title:"Date 4",value:null},price3:{title:"Price 4",value:null},time4:{title:"Date 5",value:null},price4:{title:"Price 5",value:null}},TradingView.LineTool5PointsPattern.prototype._updateTooltip=function(){var e=this._tooltipFieldsHash,t=this.points().m_values;if(t[0]){var i=this.D0.timeScale().indexToUserTime(t[0].index);e.time0.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price0.value=this.D0.mainSeries()._formatter.format(t[0].price)}if(t[1]){var n=this.D0.timeScale().indexToUserTime(t[1].index);e.time1.value=n?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(n):0,e.price1.value=this.D0.mainSeries()._formatter.format(t[1].price)}t[2]&&(i=this.D0.timeScale().indexToUserTime(t[2].index),e.time2.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price2.value=this.D0.mainSeries()._formatter.format(t[2].price)),t[3]&&(i=this.D0.timeScale().indexToUserTime(t[3].index),e.time3.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price3.value=this.D0.mainSeries()._formatter.format(t[3].price)),t[4]&&(i=this.D0.timeScale().indexToUserTime(t[4].index),e.time4.value=n?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price4.value=this.D0.mainSeries()._formatter.format(t[4].price))},TradingView.LineTool5PointsPattern.prototype.tooltip=function(){return this._updateTooltip(),this._formatTooltip()},inherit($91,$90),$91.prototype.renderer=function(){if(2>this._points.size())return null;var e=this.W99.properties(),t=new CompositeRenderer,i=this._points,n=this,o=function(t,i){return{points:(new List).append(t),text:i,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:n.W99.properties().color.value(),backgroundRoundRect:4}},r=function(t,i,o,r){return{points:(new List).append(t).append(i),width:n.D0.timeScale().width(),height:n.W99.priceScale().height(),color:generateColor(n.W99.properties().color.value(),o),linewidth:r?r:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL}},s=r(i.item(0),i.item(1),0);return t.append(new TrendLineRenderer(s)),3<=i.size()&&(s=r(i.item(1),i.item(2),0),t.append(new TrendLineRenderer(s))),4==i.size()&&(s=r(i.item(2),i.item(3),0),t.append(new TrendLineRenderer(s))),s=o(this._points.item(0),"A"),this._points.item(1).y>this._points.item(0).y?(s.vertAlign="bottom",s.offsetY=-10):(s.vertAlign="top",s.offsetY=5),t.append(new TextRenderer(s,this._rendererCache)),s=o(this._points.item(1),"B"),this._points.item(1).y<this._points.item(0).y?(s.vertAlign="bottom",s.offsetY=-10):(s.vertAlign="top",s.offsetY=5),t.append(new TextRenderer(s,this._rendererCache)),2<this._points.size()&&(s=o(this._points.item(2),"C"),this._points.item(2).y<this._points.item(1).y?(s.vertAlign="bottom",s.offsetY=-10):(s.vertAlign="top",s.offsetY=5),t.append(new TextRenderer(s,this._rendererCache))),3<this._points.size()&&(s=o(this._points.item(3),"D"),this._points.item(3).y<this._points.item(2).y?(s.vertAlign="bottom",s.offsetY=-10):(s.vertAlign="top",s.offsetY=5),t.append(new TextRenderer(s,this._rendererCache))),3<=this._points.size()&&(i=this._points.item(0).add(this._points.item(2)).scaled(.5),s=r(this._points.item(0),this._points.item(2),70,1),t.append(new TrendLineRenderer(s)),s=o(i,this._ABRetracement),t.append(new TextRenderer(s,this._rendererCache))),4<=this._points.size()&&(i=this._points.item(1).add(this._points.item(3)).scaled(.5),s=r(this._points.item(1),this._points.item(3),70,1),t.append(new TrendLineRenderer(s)),s=o(i,this._CDRetracement),t.append(new TextRenderer(s,this._rendererCache))),this.isAnchorsRequired()&&(i=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&i.removeAt(i.size()-1),t.append(this.createLineAnchor({points:i}))),t},$91.prototype.update=function(){if($90.prototype.update.call(this),3<=this.W99.points().size()){var e=this.W99.points().item(0),t=this.W99.points().item(1),i=this.W99.points().item(2);this._ABRetracement=Math.round(1e3*Math.abs((i.price-t.price)/(t.price-e.price)))/1e3}4==this.W99.points().size()&&(e=this.W99.points().item(3),this._CDRetracement=Math.round(1e3*Math.abs((e.price-i.price)/(i.price-t.price)))/1e3)},TradingView.LineToolABCD=function(e,t){this._constructor="LineToolABCD";var i=t?t:new $52("linetoolabcd");W47.call(this,e,new $91(this,e),i)},inherit(TradingView.LineToolABCD,W47),TradingView.LineToolABCD.prototype.pointsCount=function(){return 4},TradingView.LineToolABCD.prototype.title=function(){return"ABCD Pattern"},TradingView.LineToolABCD.prototype._tooltipFieldsHash={time0:{title:"Date 1",value:null},price0:{title:"Price 1",value:null},time1:{title:"Date 2",value:null},price1:{title:"Price 2",value:null},time2:{title:"Date 3",value:null},price2:{title:"Price 3",value:null},time3:{title:"Date 4",value:null},price3:{title:"Price 4",value:null}},TradingView.LineToolABCD.prototype._updateTooltip=function(){var e=this._tooltipFieldsHash,t=this.points().m_values;if(t[0]){var i=this.D0.timeScale().indexToUserTime(t[0].index);e.time0.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price0.value=this.D0.mainSeries()._formatter.format(t[0].price)}t[1]&&(i=this.D0.timeScale().indexToUserTime(t[1].index),e.time1.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price1.value=this.D0.mainSeries()._formatter.format(t[1].price)),t[2]&&(i=this.D0.timeScale().indexToUserTime(t[2].index),e.time2.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price2.value=this.D0.mainSeries()._formatter.format(t[2].price)),t[3]&&(i=this.D0.timeScale().indexToUserTime(t[3].index),e.time3.value=i?new DateTimeFormatter(this.D0.mainSeries().isDWM()).format(i):0,e.price3.value=this.D0.mainSeries()._formatter.format(t[3].price))},TradingView.LineToolABCD.prototype.tooltip=function(){return this._updateTooltip(),this._formatTooltip()},inherit($96,$90),$96.prototype.renderer=function(){if(2>this._points.size())return null;var e=this.W99.properties(),t=new CompositeRenderer,i=this,n=function(t,n){return{points:(new List).append(t),text:n,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i.W99.properties().color.value(),backgroundRoundRect:4}},o=function(t,n){return{points:(new List).append(t).append(n),width:i.D0.timeScale().width(),height:i.W99.priceScale().height(),color:i.W99.properties().color.value(),linewidth:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL}},r=o(this._points.item(0),this._points.item(1));return t.append(new TrendLineRenderer(r)),3<=this._points.size()&&(r=o(this._points.item(1),this._points.item(2)),t.append(new TrendLineRenderer(r))),4==this._points.size()&&(r=o(this._points.item(2),this._points.item(3)),t.append(new TrendLineRenderer(r)),this._intersectPoint?(o=new List,o.append(this._startPoint1),o.append(this._startPoint2),o.append(this._intersectPoint),r={},r.points=o,r.color=e.color.value(),r.linewidth=e.linewidth.value(),r.backcolor=e.backgroundColor.value(),r.fillBackground=e.fillBackground.value(),r.transparency=e.transparency.value(),t.append(new TriangleRenderer(r))):this._intersectPoint1&&this._intersectPoint2&&(o=new List,o.append(this._startPoint1),o.append(this._startPoint2),o.append(this._intersectPoint2),o.append(this._intersectPoint1),r={filled:!0,fillBackground:!0},r.points=o,r.color=e.color.value(),r.linewidth=e.linewidth.value(),r.backcolor=e.backgroundColor.value(),r.transparency=e.transparency.value(),t.append(new PoligonRenderer(r)))),o=n(this._points.item(0),"A"),this._points.item(1).y>this._points.item(0).y?(o.vertAlign="bottom",o.offsetY=-10):(o.vertAlign="top",o.offsetY=5),t.append(new TextRenderer(o,this._rendererCache)),o=n(this._points.item(1),"B"),this._points.item(1).y<this._points.item(0).y?(o.vertAlign="bottom",o.offsetY=-10):(o.vertAlign="top",o.offsetY=5),t.append(new TextRenderer(o,this._rendererCache)),2<this._points.size()&&(o=n(this._points.item(2),"C"),this._points.item(2).y<this._points.item(1).y?(o.vertAlign="bottom",o.offsetY=-10):(o.vertAlign="top",o.offsetY=5),t.append(new TextRenderer(o,this._rendererCache))),3<this._points.size()&&(o=n(this._points.item(3),"D"),this._points.item(3).y<this._points.item(2).y?(o.vertAlign="bottom",o.offsetY=-10):(o.vertAlign="top",o.offsetY=5),t.append(new TextRenderer(o,this._rendererCache))),this.isAnchorsRequired()&&(o=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&o.removeAt(o.size()-1),t.append(this.createLineAnchor({points:o}))),t},$96.prototype.update=function(){if($90.prototype.update.call(this),this._valid=!1,4==this._points.size()){var e=this._points.item(0),t=this._points.item(1),i=this._points.item(2),n=this._points.item(3);if(!(1>Math.abs(i.x-e.x)||1>Math.abs(n.x-t.x))){var o=Math.min(e.x,t.x),o=Math.min(o,i.x),o=Math.min(o,n.x),r=(i.y-e.y)/(i.x-e.x),s=e.y+(o-e.x)*r,a=(n.y-t.y)/(n.x-t.x),l=t.y+(o-t.x)*a;if(!(1e-6>Math.abs(r-a))){this._startPoint1=new MathEx.Point(o,s),this._startPoint2=new MathEx.Point(o,l);var d=(t.y-e.y+(e.x*r-t.x*a))/(r-a);this._valid=!0,delete this._intersectPoint,delete this._intersectPoint1,delete this._intersectPoint2,o>d&&(o=Math.max(e.x,t.x),o=Math.max(o,i.x),o=Math.max(o,n.x),s=e.y+(o-e.x)*r,l=t.y+(o-t.x)*a,this._startPoint1=new MathEx.Point(o,s),this._startPoint2=new MathEx.Point(o,l)),this._intersectPoint=new MathEx.Point(d,e.y+(d-e.x)*r)}}}},TradingView.LineToolTrianglePattern=function(e,t){this._constructor="LineToolTrianglePattern";var i=t?t:new $52("linetooltrianglepattern");W47.call(this,e,new $96(this,e),i)},inherit(TradingView.LineToolTrianglePattern,W47),TradingView.LineToolTrianglePattern.prototype.pointsCount=function(){return 4},TradingView.LineToolTrianglePattern.prototype.title=function(){return"Triangle Pattern"},inherit($95,$90),$95.prototype.renderer=function(){if(2>this._points.size())return null;for(var e=this.W99.properties(),t=new CompositeRenderer,i=this,n=function(t,n){return{points:(new List).append(t),text:n,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i.W99.properties().color.value(),backgroundRoundRect:4}},o=function(t,n,o,r){return{points:(new List).append(t).append(n),width:i.D0.timeScale().width(),height:i.W99.priceScale().height(),color:generateColor(i.W99.properties().color.value(),o),linewidth:r?r:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL}},r=1;r<this._points.size();r++){var s=o(this._points.item(r-1),this._points.item(r),0);t.append(new TrendLineRenderer(s))}return this._retrace1&&(s=o(this._points.item(1),this._points.item(3),70,1),t.append(new TrendLineRenderer(s)),r=this._points.item(1).add(this._points.item(3)).scaled(.5),r=n(r,this._retrace1),t.append(new TextRenderer(r,this._rendererCache))),this._retrace2&&(s=o(this._points.item(3),this._points.item(5),70,1),t.append(new TrendLineRenderer(s)),r=this._points.item(5).add(this._points.item(3)).scaled(.5),r=n(r,this._retrace2),t.append(new TextRenderer(r,this._rendererCache))),this.isAnchorsRequired()&&(n=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&n.removeAt(n.size()-1),t.append(this.createLineAnchor({points:n}))),t},$95.prototype.update=function(){if($90.prototype.update.call(this),delete this._retrace1,delete this._retrace2,4<=this.W99.points().size()){var e=this.W99.points().item(1),t=this.W99.points().item(2),i=this.W99.points().item(3);this._retrace1=Math.round(100*Math.abs((i.price-t.price)/(t.price-e.price)))/100}6<=this.W99.points().size()&&(i=this.W99.points().item(3),e=this.W99.points().item(4),t=this.W99.points().item(5),this._retrace2=Math.round(100*Math.abs((t.price-e.price)/(e.price-i.price)))/100)},TradingView.LineToolThreeDrivers=function(e,t){this._constructor="LineToolThreeDrivers";var i=t?t:new $52("linetoolthreedrivers");W47.call(this,e,new $95(this,e),i)},inherit(TradingView.LineToolThreeDrivers,W47),TradingView.LineToolThreeDrivers.prototype.pointsCount=function(){return 7},TradingView.LineToolThreeDrivers.prototype.title=function(){return"Three Drivers Pattern"},inherit($94,$90),$94.prototype.renderer=function(){if(2>this._points.size())return null;for(var e=this.W99.properties(),t=new CompositeRenderer,i=this,n=function(t,n){return{points:(new List).append(t),text:$.t(n),color:e.textcolor.value(),horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i.W99.properties().color.value(),backgroundRoundRect:4}},o=function(t,n,o,r){return{points:(new List).append(t).append(n),width:i.D0.timeScale().width(),height:i.W99.priceScale().height(),color:generateColor(i.W99.properties().color.value(),o),linewidth:r?r:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL}},r=function(t,i,n){var o=new List;return o.append(t),o.append(i),o.append(n),t={},t.points=o,t.color=e.color.value(),t.linewidth=0,t.backcolor=e.backgroundColor.value(),t.fillBackground=e.fillBackground.value(),t.transparency=e.transparency.value(),t},s=1;s<this._points.size();s++){var a=o(this._points.item(s-1),this._points.item(s),0);t.append(new TrendLineRenderer(a))}if(5<=this._points.size()){var l,d=s=!1;this._intersect1?a=this._intersect1:(a=this._points.item(2),s=!0),this._intersect2?l=this._intersect2:(l=this._points.item(4),d=!0),a=o(a,l,0),a.extendleft=s,a.extendright=d,t.append(new TrendLineRenderer(a)),o=r(this._points.item(2),this._points.item(3),this._points.item(4)),t.append(new TriangleRenderer(o))}return this._intersect1&&(o=r(this._intersect1,this._points.item(1),this._points.item(2)),t.append(new TriangleRenderer(o))),this._intersect2&&(o=r(this._points.item(4),this._points.item(5),this._intersect2),t.append(new TriangleRenderer(o))),2<=this._points.size()&&(r=this._points.item(1),r=n(r,"Left Shoulder"),this._points.item(1).y<this._points.item(0).y?(r.vertAlign="bottom",r.offsetY=-10):(r.vertAlign="top",r.offsetY=5),t.append(new TextRenderer(r,this._rendererCache))),4<=this._points.size()&&(r=this._points.item(3),r=n(r,"Head"),this._points.item(3).y<this._points.item(2).y?(r.vertAlign="bottom",r.offsetY=-10):(r.vertAlign="top",r.offsetY=5),t.append(new TextRenderer(r,this._rendererCache))),6<=this._points.size()&&(r=this._points.item(5),r=n(r,"Right Shoulder"),this._points.item(5).y<this._points.item(4).y?(r.vertAlign="bottom",r.offsetY=-10):(r.vertAlign="top",r.offsetY=5),t.append(new TextRenderer(r,this._rendererCache))),this.isAnchorsRequired()&&(n=this._points.clone(),this.D0.lineBeingCreated()==this.W99&&n.removeAt(n.size()-1),t.append(this.createLineAnchor({points:n}))),t},$94.prototype.update=function(){if($90.prototype.update.call(this),delete this._intersect1,delete this._intersect2,
5<=this._points.size()){var e=this._points.item(0),t=this._points.item(1),i=this._points.item(2);this._points.item(3);var n=this._points.item(4),e=MathEx.intersectSegment(i,n,e,t);null!==e&&(t=n.substract(i),this._intersect1=i.add(t.scaled(e)))}7==this._points.size()&&(e=this._points.item(5),t=this._points.item(6),e=MathEx.intersectSegment(i,n,e,t),null!==e&&(t=n.substract(i),this._intersect2=i.add(t.scaled(e))))},TradingView.LineToolHeadAndShoulders=function(e,t){this._constructor="LineToolHeadAndShoulders";var i=t?t:new $52("linetoolheadandshoulders");W47.call(this,e,new $94(this,e),i)},inherit(TradingView.LineToolHeadAndShoulders,W47),TradingView.LineToolHeadAndShoulders.prototype.pointsCount=function(){return 7},TradingView.LineToolHeadAndShoulders.prototype.title=function(){return"Head & Shoulders"},inherit(W42,$90),W42.prototype.update=function(){if($90.prototype.update.call(this),!(3>this.W99.points().size()||!this.W99.priceScale()||this.W99.priceScale().isEmpty()||this.D0.timeScale().isEmpty())){var e=this.W99.points().item(0),t=this.W99.points().item(1),i=this.W99.points().item(2);if(this._levels=[],t.index!=e.index&&(e=t.index-e.index,t=this.W99.properties(),i=i.index,!this.D0.timeScale().visibleBars().isEmpty()))for(var n=1;11>=n;n++){var o=t["level"+n];if(o.visible.value()){var r=o.coeff.value(),s=o.color.value(),a=Math.round(i+r*e),o={x:this.D0.timeScale().indexToCoordinate(a),coeff:r,color:s,linewidth:o.linewidth.value(),linestyle:o.linestyle.value(),index:n};t.showCoeffs.value()&&(o.text=r,o.y=this.W99.priceScale().height()),this._levels.push(o)}}}},W42.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=this.W99.properties(),o={points:(new List).append(t).append(i),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};if(e.append(new TrendLineRenderer(o)),3>this._points.size())return this.addAnchors(e),e;o=this._points.item(2),o={points:(new List).append(i).append(o),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},e.append(new TrendLineRenderer(o));for(var o=n.fillBackground.value(),r=n.transparency.value(),s=0;s<this._levels.length;s++){if(s>0&&o){var t=new MathEx.Point(this._levels[s-1].x,0),i=new MathEx.Point(this._levels[s].x,this.W99.priceScale().height()),a={nohittest:!0};a.points=(new List).append(t).append(i),a.color=this._levels[s].color,a.linewidth=0,a.backcolor=this._levels[s].color,a.fillBackground=!0,a.transparency=r,e.append(new RectangleRenderer(a))}if(void 0!==this._levels[s].text){var l,d,h,i=n.horzLabelsAlign.value(),i="left"==i?"right":"right"==i?"left":"center";switch(i){case"left":d=3;break;case"center":d=0;break;case"right":d=-3}switch(n.vertLabelsAlign.value()){case"top":l=new MathEx.Point(this._levels[s].x,0),h=5;break;case"middle":l=new MathEx.Point(this._levels[s].x,.5*this._levels[s].y),h=0;break;case"bottom":l=new MathEx.Point(this._levels[s].x,this._levels[s].y),h=-10}i={points:(new List).append(l),text:""+this._levels[s].text,color:this._levels[s].color,vertAlign:"middle",horzAlign:i,font:n.font.value(),offsetX:d,offsetY:h,fontsize:12},e.append(new TextRenderer(i,this._rendererCache))}i={},i.points=(new List).append(new MathEx.Point(this._levels[s].x,0)),i.color=this._levels[s].color,i.linewidth=this._levels[s].linewidth,i.linestyle=this._levels[s].linestyle,t=new HitTestResult(HitTestResult.MOVEPOINT,null,this._levels[s].index),e.append(new VertLineRenderer(i,t))}return this.addAnchors(e),e},TradingView.LineToolTrendBasedFibTime=function(e,t){this._constructor="LineToolTrendBasedFibTime";var i=t?t:new $52("linetooltrendbasedfibtime");W47.call(this,e,new W42(this,e),i),this.version=TradingView.LineToolTrendBasedFibTime.version},inherit(TradingView.LineToolTrendBasedFibTime,W47),TradingView.LineToolTrendBasedFibTime.version=1,TradingView.LineToolTrendBasedFibTime.prototype.pointsCount=function(){return 3},TradingView.LineToolTrendBasedFibTime.prototype.title=function(){return"Trend-Based Fib Time"},TradingView.LineToolTrendBasedFibTime.prototype.migrateVersion=function(e,t,i){},TradingView.LineToolTrendBasedFibTime.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},GannArcRenderer.prototype.draw=function(e){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.translate(this._data.center.x,this._data.center.y);var t=this._data.edge.substract(this._data.center),t=t.y/t.x,i=this._data.point.substract(this._data.center);i.y/=t;var i=i.length(),n=this._data.prevPoint.substract(this._data.center);n.y/=t,n=n.length(),e.scale(1,t),this._data.fillBack&&(this._data.point.x<this._data.center.x&&(i=-i,n=-n),e.beginPath(),e.moveTo(n,0),e.lineTo(i,0),e.arcTo(i,i,0,i,Math.abs(i)),e.lineTo(0,n),e.arcTo(n,n,n,0,Math.abs(n)),e.fillStyle=generateColor(this._data.color,this._data.transparency),e.fill()),e.beginPath(),this._data.point.x>this._data.center.x?e.arc(0,0,Math.abs(i),0,Math.PI/2,!1):e.arc(0,0,Math.abs(i),-Math.PI/2,-Math.PI,!0),e.scale(1,1/t),e.stroke()},GannArcRenderer.prototype.hitTest=function(e){e=e.substract(this._data.center);var t=this._data.edge.substract(this._data.center),i=t.y/t.x;e.y/=i;var n=this._data.point.substract(this._data.center);n.y/=i;var n=n.length(),o=e.length(),r=this._data.prevPoint.substract(this._data.center);if(r.y/=i,i=r.length(),this._data.fillBack){if(o>=i&&n>=o&&0<=t.x*e.x&&0<=t.y*e.y)return new HitTestResult(HitTestResult.MOVEPOINT)}else if(5>Math.abs(o-n)&&0<=t.x*e.x&&0<=t.y*e.y)return new HitTestResult(HitTestResult.MOVEPOINT);return null},inherit($80,$90),$80.prototype.update=function(){$90.prototype.update.call(this),this.W99._cornerPoint&&this._points.append(this.W99.pointToScreenPoint(this.W99._cornerPoint)[0])},$80.prototype.renderer=function(){var e=this.W99.properties(),t=new CompositeRenderer;if(2>this._points.size())return this.addAnchors(t),t;for(var i=this._points.item(0),n=3==this._points.size()?this._points.item(2):this._points.item(1),o=this._points.item(1),r=0;6>r;r++){var s=e.levels[r];if(s.visible.value()){var a=r/5,l=i.x+a*(n.x-i.x),d=i.y,h=n.y,l={points:(new List).append(new MathEx.Point(l,d)).append(new MathEx.Point(l,h)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:s.color.value(),linewidth:s.width.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL};t.append(new TrendLineRenderer(l)),d=i.y+a*(n.y-i.y),l=i.x,a=n.x,l={points:(new List).append(new MathEx.Point(l,d)).append(new MathEx.Point(a,d)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:s.color.value(),linewidth:s.width.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t.append(new TrendLineRenderer(l))}}for(r in e.fanlines._childs)h=e.fanlines[r],h.visible.value()&&(s=h.x.value(),a=h.y.value(),s>a?(l=n.x,a/=s,d=i.y+a*(n.y-i.y)):(d=n.y,a=s/a,l=i.x+a*(n.x-i.x)),l={points:(new List).append(i).append(new MathEx.Point(l,d)),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:h.color.value(),linewidth:h.width.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t.append(new TrendLineRenderer(l)));h=i;for(r in e.arcs._childs){var c=e.arcs[r];c.visible.value()&&(s=c.x.value()/5,a=c.y.value()/5,l=i.x+s*(n.x-i.x),d=i.y+a*(n.y-i.y),new MathEx.Point(l,d).substract(i).length(),l={center:i,point:new MathEx.Point(l,d),edge:n,color:c.color.value(),linewidth:c.width.value(),fillBack:e.arcsBackground.fillBackground.value(),transparency:e.arcsBackground.transparency.value(),prevPoint:h},t.append(new GannArcRenderer(l)),h=l.point)}return this.isAnchorsRequired()&&(e=(new List).append(i).append(o),this.D0.lineBeingCreated()==this.W99&&e.removeAt(e.size()-1),t.append(this.createLineAnchor({points:e}))),t},TradingView.LineToolGannComplex=function(e,t){this._constructor="LineToolGannComplex";var i=t?t:new $52("linetoolganncomplex");W47.call(this,e,new $80(this,e),i)},inherit(TradingView.LineToolGannComplex,W47),TradingView.LineToolGannComplex.prototype._recalcSecondPoint=function(){var e=this.D0.mainSeries().properties().style.value(),t=this.D0.mainSeries().interval();(e!==this._currentStyle||t!==this._currentInterval)&&(e=this.pointToScreenPoint(this.points().item(0))[0],t=this.pointToScreenPoint(this.points().item(2))[0].substract(e),e=e.add(t.scaled(.2/Math.sqrt(2))),e=this.screenPointToPoint(e),this._points.setItem(1,e))},TradingView.LineToolGannComplex.prototype.pointsCount=function(){return 2},TradingView.LineToolGannComplex.prototype.title=function(){return"Gann Square"},TradingView.LineToolGannComplex.prototype._fixThirdPoint=function(e){if(!(2>this.points().size())){var t=this.pointToScreenPoint(this.points().item(0))[0],i=this.pointToScreenPoint(this.points().item(1))[0],n=i.substract(t);e?t=t.add(n.scaled(5*Math.sqrt(2))):(e=0>n.x?-1:1,n=0>n.y?-1:1,i=i.substract(t).length(),t=t.add(new MathEx.Point(5*i*e,5*i*n))),this._cornerPoint=this.screenPointToPoint(t)}},TradingView.LineToolGannComplex.prototype.setPoint=function(e,t,i){return e=W47.prototype.setPoint.call(this,e,t,i),this._fixThirdPoint(i&&i.shift),this._points.setItem(2,this._cornerPoint),delete this._cornerPoint,i=this.D0.mainSeries().properties().style.value(),t=this.D0.mainSeries().interval(),this._currentStyle=i,this._currentInterval=t,e},TradingView.LineToolGannComplex.prototype.setLastPoint=function(e,t){var i=W47.prototype.setLastPoint.call(this,e,t);return this._fixThirdPoint(t&&t.shift),i},TradingView.LineToolGannComplex.prototype.addPoint=function(e,t){var i=this.D0.mainSeries().properties().style.value(),n=this.D0.mainSeries().interval();return this._currentStyle=i,this._currentInterval=n,i=this.priceScale(),i.isPercent()&&(n=this.ownerSource().firstValue(),e.price=i.priceRange().convertFromPercent(e.price,n)),i=t&&t.shift,this._points.append(e),this._lastPoint=null,(n=this._points.size()==this.pointsCount())?(this._fixThirdPoint(i),this._points.append(this._cornerPoint),delete this._cornerPoint,this.normalizePoints(),this.createServerPoints()):this._lastPoint=e,n},TradingView.LineToolGannComplex.prototype.onData=function(e){W47.prototype.onData.call(this,e),this._recalcSecondPoint()},inherit($70,$90),$70.prototype.update=function(){if($90.prototype.update.call(this),!(3>this._points.size()||3>this.W99.points().size())){var e=this._points.item(0),t=this._points.item(1);this._points.item(2),this.norm=this._points.item(2).substract(this._points.item(0)),this._labels=[];for(var i=this.W99.properties(),e=this.W99.points().item(0),t=this.W99.points().item(1),e=e.price-t.price,t=t.price,n=function(e){return i.coeffsAsPercents.value()?""+Math.round(1e4*e)/100+"%":""+e},o=1;11>=o;o++){var r=i["level"+o].coeff.value(),s=t+r*e;if(this.W99.priceScale().isPercent())var a=this.W99.ownerSource().firstValue(),s=this.W99.priceScale().priceRange().convertToPercent(s,a);var l;i.showCoeffs.value()&&i.showPrices.value()?l=""+n(r)+"("+this.W99.priceScale().formatter().format(s)+")":i.showCoeffs.value()?l=""+n(r):i.showPrices.value()&&(l=""+this.W99.priceScale().formatter().format(s)),this._labels.push(l)}}},$70.prototype.renderer=function(){function e(e,n,o){var s,l,d=i.vertLabelsAlign.value();switch(i.horzLabelsAlign.value()){case"left":s=e,l="right";break;case"center":s=e.add(n).scaled(.5),l="center";break;case"right":s=n,l="left"}e={points:(new List).append(s),text:o,color:a.color,vertAlign:d,horzAlign:l,font:i.font.value(),offsetX:-5,offsetY:"top"==d?0:-5,fontsize:12},t.append(new TextRenderer(e,r._rendererCache))}var t=new CompositeRenderer;if(2>this._points.size())return this.addAnchors(t),t;var i=this.W99.properties(),n=this._points.item(0),o=this._points.item(1);if(3>this._points.size())return n={points:(new List).append(n).append(o),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:i.level1.color.value(),linewidth:i.level1.linewidth.value(),linestyle:i.level1.linestyle.value(),extendleft:i.extendLeft.value(),extendright:i.extendRight.value(),leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t.append(new TrendLineRenderer(n)),this.addAnchors(t),t;for(var r=this,s=1;11>s;s++){var a=i["level"+s];if(a.visible.value()){for(var l=s+1;11>=l;l++){var d=i["level"+l];if(d.visible.value())break}if(!d)break;var h=this.norm.scaled(a.coeff.value()),l=n.add(h),h=o.add(h),c=this.norm.scaled(d.coeff.value()),p=n.add(c),c=o.add(c),u={};u.points=new List,u.points.append(l),u.points.append(h),u.points.append(p),u.points.append(c),u.color=a.color.value(),u.width=this.D0.timeScale().width(),u.height=this.W99.priceScale().height(),u.linewidth=a.linewidth.value(),u.linestyle=a.linestyle.value(),u.extendleft=i.extendLeft.value(),u.extendright=i.extendRight.value(),u.backcolor=a.color.value(),u.transparency=i.transparency.value(),u.skipTopLine=!0,u.fillBackground=i.fillBackground.value(),u.hittestOnBackground=TradingView.isMobile.any(),t.append(new ParallelChannelRenderer(u)),(i.showCoeffs.value()||i.showPrices.value())&&e(l,h,this._labels[s-1])}}return a=i.level11,a.visible.value()&&(h=this.norm.scaled(a.coeff.value()),l=n.add(h),h=o.add(h),n={points:(new List).append(l).append(h),width:this.D0.timeScale().width(),height:this.W99.priceScale().height(),color:a.color.value(),linewidth:a.linewidth.value(),linestyle:a.linestyle.value(),extendleft:i.extendLeft.value(),extendright:i.extendRight.value(),leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},t.append(new TrendLineRenderer(n)),(i.showCoeffs.value()||i.showPrices.value())&&e(l,h,this._labels[10])),this.addAnchors(t),t},TradingView.LineToolFibChannel=function(e,t){this._constructor="LineToolFibChannel";var i=t?t:new $52("linetoolfibchannel");W47.call(this,e,new $70(this,e),i),this.version=TradingView.LineToolFibChannel.version},inherit(TradingView.LineToolFibChannel,W47),TradingView.LineToolFibChannel.version=1,TradingView.LineToolFibChannel.prototype.pointsCount=function(){return 3},TradingView.LineToolFibChannel.prototype.title=function(){return"Fib Channel"},TradingView.LineToolFibChannel.prototype.processErase=function(e,t){var i="level"+t,i=this.properties()[i].visible;e.setProperty(i,!1,"Erase level line")},FibSpiralRenderer.prototype._fibNumbers=function(){return[0,1,2,3,5,8,13,21,34,55,89]},FibSpiralRenderer.prototype._continiusFib=function(e){var t=this._fibNumbers(),i=Math.floor(e),n=Math.ceil(e);return n>=t.length?null:(e=Math.pow(e-i,1.15),t[i]+(t[n]-t[i])*e)},FibSpiralRenderer.prototype.hitTest=function(e){var t=this._data.points.item(0),i=this._data.points.item(1).substract(t),t=e.substract(t);e=i.normalized();var n=e.transponed(),o=t.normalized();for(e=Math.acos(e.dotProduct(o)),0>Math.asin(n.dotProduct(o))&&(e=2*Math.PI-e),t=t.length(),n=0;4>n;n++)if(o=this._continiusFib(e/(.5*Math.PI)+4*n),o=o*i.length()/5,null!==o&&5>Math.abs(o-t))return new HitTestResult(HitTestResult.MOVEPOINT);return null},FibSpiralRenderer.prototype.draw=function(e){e.lineCap="round",e.strokeStyle=this._data.color;var t=this._data.points.item(0),i=this._data.points.item(1);e.translate(t.x,t.y);var n=i.substract(t),t=n.length(),n=n.normalized(),i=Math.acos(n.x);0>Math.asin(n.y)&&(i=2*Math.PI-i),e.rotate(i),e.scale(t/5,t/5),e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),n=Math.PI/100,e.moveTo(0,0);for(var o=0;o<50*(this._fibNumbers().length-1);o++){var r=o*n,s=this._continiusFib(o/50),a=Math.cos(r)*s,r=Math.sin(r)*s;e.lineTo(a,r)}e.scale(5/t,5/t),e.rotate(-i),e.stroke()},inherit($75,$90),$75.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t={};return t.points=this._points,t.width=this.D0.timeScale().width(),t.height=this.W99.priceScale().height(),t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),t.extendleft=!1,t.extendright=!0,t.leftend=W47.LINEEND_NORMAL,t.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(t)),t={},t.points=this._points,t.floatPoints=this._floatPoints,t.width=this.D0.timeScale().width(),t.height=this.W99.priceScale().height(),t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),e.append(new FibSpiralRenderer(t)),this.isAnchorsRequired()&&(e.append(new TrendLineRenderer(t)),t=t.points.clone(),this.D0.lineBeingCreated()==this.W99&&t.removeAt(t.size()-1),e.append(this.createLineAnchor({points:t}))),e},TradingView.LineToolFibSpiral=function(e,t){this._constructor="LineToolFibSpiral";var i=t?t:new $52("linetoolfibspiral");W47.call(this,e,new $75(this,e),i)},inherit(TradingView.LineToolFibSpiral,W47),TradingView.LineToolFibSpiral.prototype.pointsCount=function(){return 2},TradingView.LineToolFibSpiral.prototype.title=function(){return"Fib Spiral"},inherit($67,$90),$67.prototype.update=function(){if($90.prototype.update.call(this),this._label=null,!(2>this.W99.points().size())&&this.W99.priceScale()){var e=this.W99.points().item(0),t=this.W99.points().item(1);if(this._price1=this.W99.priceScale().formatter().format(e.price),this._price2=this.W99.priceScale().formatter().format(t.price),3==this.W99.points().size()){var i=this.W99.points().item(2);this._price3=this.W99.priceScale().formatter().format(i.price),e=t.price-e.price,this._price4=this.W99.priceScale().formatter().format(i.price+e)}}},$67.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=this.W99.properties(),o=this.D0,r=this.W99,n=r.properties();if(3<=this._points.size()){var s=this._points.item(2);s.x=i.x;var a=i.y-t.y,l=t.clone();if(l.y=s.y+a,l.data=3,n.fillBackground.value()){var d={},a=o.timeScale().width();r.priceScale().height();var h=n.extendLeft.value(),c=n.extendRight.value();h||c?!h&&c?(d={},d.width=a,d.p1=t,d.p2=i,d.p3=l,d.p4=s,d.color=n.backgroundColor.value(),d.transparency=n.transparency.value(),d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d))):h&&!c?(d={},d.width=a,d.p1=i,d.p2=t,d.p3=s,d.p4=l,d.color=n.backgroundColor.value(),d.transparency=n.transparency.value(),d.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(d))):(d=t.add(i).scaled(.5),h=l.add(s).scaled(.5),c={},c.width=a,c.p1=d,c.p2=i,c.p3=h,c.p4=s,c.color=n.backgroundColor.value(),c.transparency=n.transparency.value(),c.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(c)),c={},c.width=a,c.p1=d,c.p2=t,c.p3=h,c.p4=l,c.color=n.backgroundColor.value(),c.transparency=n.transparency.value(),c.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(c))):(d.points=new List([t,i,s,l]),d.color="rgba(0,0,0,0)",d.linewidth=0,d.linestyle=CanvasEx.LINESTYLE_SOLID,d.filled=!0,d.backcolor=n.backgroundColor.value(),d.fillBackground=!0,d.transparency=n.transparency.value(),e.append(new PoligonRenderer(d)))}}a=function(e,t){return{points:(new List).append(e).append(t),width:o.timeScale().width(),height:r.priceScale().height(),color:n.linecolor.value(),linewidth:n.linewidth.value(),linestyle:n.linestyle.value(),extendleft:n.extendLeft.value(),extendright:n.extendRight.value(),leftend:n.leftEnd.value(),rightend:n.rightEnd.value()}},e.append(new TrendLineRenderer(a(t,i)));var p=this,d=function(t,i,n,o){p.W99.properties().showPrices.value()&&(n={points:(new List).append(t),text:n,color:p.W99.properties().textcolor.value(),horzAlign:t.x>i.x?"left":"right",vertAlign:"middle",font:p.W99.properties().font.value(),offsetX:t.x>i.x?-5:5,offsetY:-5,bold:p.W99.properties().bold.value(),italic:p.W99.properties().italic.value(),fontsize:p.W99.properties().fontsize.value()},e.append(new TextRenderer(n,p._rendererCache)),n={points:(new List).append(i),text:o,color:p.W99.properties().textcolor.value(),horzAlign:t.x<i.x?"left":"right",vertAlign:"middle",font:p.W99.properties().font.value(),offsetX:t.x>i.x?-5:5,offsetY:-5,bold:p.W99.properties().bold.value(),italic:p.W99.properties().italic.value(),fontsize:p.W99.properties().fontsize.value()},e.append(new TextRenderer(n,p._rendererCache)))};return e.append(new TrendLineRenderer(a(t,i))),d(t,i,this._price1,this._price2),2==this._points.size()?(this.addAnchors(e),e):(e.append(new TrendLineRenderer(a(l,s))),d(s,l,this._price3,this._price4),this.isAnchorsRequired()&&(s=(new List).append(t).append(i).append(s).append(l),this.D0.lineBeingCreated()==this.W99&&s.removeAt(s.size()-1),e.append(this.createLineAnchor({points:s}))),!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&t&&i&&this.W99.getAlertIsActive(function(o){e.append(new PaneRendererClockIcon({point1:t,point2:i,color:o?n.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))}),e)},TradingView.LineToolDisjointAngle=function(e,t){this._constructor="LineToolDisjointAngle";var i=t?t:new $52("linetooldisjointangle");W47.call(this,e,new $67(this,e),i),this.version=TradingView.LineToolDisjointAngle.version},inherit(TradingView.LineToolDisjointAngle,W47),TradingView.LineToolDisjointAngle.version=1,TradingView.LineToolDisjointAngle.prototype.pointsCount=function(){return 3},TradingView.LineToolDisjointAngle.prototype.title=function(){return"Disjoint Angle"},TradingView.LineToolDisjointAngle.prototype.addPoint=function(e,t){return t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2)),W47.prototype.addPoint.call(this,e)},TradingView.LineToolDisjointAngle.prototype.setLastPoint=function(e,t){return t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2)),W47.prototype.setLastPoint.call(this,e)},TradingView.LineToolDisjointAngle.prototype.setPoint=function(e,t,i){var n=.5*(this._points.item(1).price+this._points.item(2).price);i&&i.shift&&1==e&&this._snapPoint45Degree(t,this.points().item(0)),3>e&&W47.prototype.setPoint.call(this,e,t),0!=e&&2!=e&&(1==e?(e=this._points.item(1).price-n,this._points.item(2).price=this._points.item(1).price-2*e):3==e&&(e=this.priceScale(),i=t.price,e.isPercent()&&(n=this.ownerSource().firstValue(),i=e.priceRange().convertFromPercent(i,n)),e=i-this._points.item(2).price,this._points.item(0).price=this._points.item(1).price-e,this._points.item(0).index=t.index))},TradingView.LineToolDisjointAngle.prototype.canHasAlert=function(){return!0},TradingView.LineToolDisjointAngle.prototype._getAlertPlots=function(){var e=this._points.item(0),t=this._points.item(1),i=[];e.index<=t.index?(i.push(e),i.push(t)):(i.push(t),i.push(e));var n=this._points.item(2);n.time=t.time,n.index=t.index;var o={price:n.price+(t.price-e.price),time:e.time,index:e.index},r=[];return n.index<=o.index?(r.push(n),r.push(o)):(r.push(o),r.push(n)),i[0].price>r[0].price?(n=i,i=r):r[0].price>i[0].price?n=r:r[1].price>i[1].price?n=r:(n=i,i=r),r=this.properties().extendLeft.value(),o=this.properties().extendRight.value(),e.index<=t.index?(e=r,t=o):(e=o,t=r),[this._linePointsToAlertPlot(n,"Upper",e,t),this._linePointsToAlertPlot(i,"Lower",e,t)]},inherit($78,$90),$78.prototype.update=function(){if($90.prototype.update.call(this),this._label2=this._label1=null,!(2>this.W99.points().size())&&this.W99.priceScale()){var e=this.W99.points().item(0),t=this.W99.points().item(1);this._price1=this.W99.priceScale().formatter().format(e.price),this._price2=this.W99.priceScale().formatter().format(t.price),3==this.W99.points().size()&&(e=this.W99.points().item(2),this._price3=this.W99.priceScale().formatter().format(e.price))}},$78.prototype.renderer=function(){var e=new CompositeRenderer;if(2>this._points.size())return e;var t=this._points.item(0),i=this._points.item(1),n=this.W99.properties(),o=this.D0,r=this.W99;if(3==this._points.size()){var s=this._points.item(2);s.x=i.x;var a=t.clone();if(a.y=s.y,a.data=3,n.fillBackground.value()){var l={},d=o.timeScale().width();r.priceScale().height();var h=n.extendLeft.value(),c=n.extendRight.value();h||c?!h&&c?(l={},l.width=d,l.p1=t,l.p2=i,l.p3=a,l.p4=s,l.color=n.backgroundColor.value(),l.transparency=n.transparency.value(),l.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(l))):h&&!c?(l={},l.width=d,l.p1=i,l.p2=t,l.p3=s,l.p4=a,l.color=n.backgroundColor.value(),l.transparency=n.transparency.value(),l.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(l))):(l=t.add(i).scaled(.5),h=a.add(s).scaled(.5),c={},c.width=d,c.p1=l,c.p2=i,c.p3=h,c.p4=s,c.color=n.backgroundColor.value(),c.transparency=n.transparency.value(),c.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(c)),c={},c.width=d,c.p1=l,c.p2=t,c.p3=h,c.p4=a,c.color=n.backgroundColor.value(),c.transparency=n.transparency.value(),c.hittestOnBackground=TradingView.isMobile.any(),e.append(new ChannelRenderer(c))):(l.points=new List([t,i,s,a]),l.color="rgba(0,0,0,0)",l.linewidth=0,l.linestyle=CanvasEx.LINESTYLE_SOLID,l.filled=!0,l.backcolor=n.backgroundColor.value(),l.fillBackground=!0,l.transparency=n.transparency.value(),e.append(new PoligonRenderer(l)))}}if(d=function(e,t){return{points:(new List).append(e).append(t),width:o.timeScale().width(),height:r.priceScale().height(),color:n.linecolor.value(),linewidth:n.linewidth.value(),linestyle:n.linestyle.value(),extendleft:n.extendLeft.value(),extendright:n.extendRight.value(),leftend:n.leftEnd.value(),rightend:n.rightEnd.value()}},e.append(new TrendLineRenderer(d(t,i))),2==this._points.size())return this.addAnchors(e),e;var p=this,l=function(t,i,n,o){p.W99.properties().showPrices.value()&&(n={points:(new List).append(t),text:n,color:p.W99.properties().textcolor.value(),horzAlign:t.x>i.x?"left":"right",vertAlign:"middle",font:p.W99.properties().font.value(),offsetX:t.x>i.x?-5:5,offsetY:-5,bold:p.W99.properties().bold.value(),italic:p.W99.properties().italic.value(),fontsize:p.W99.properties().fontsize.value()},e.append(new TextRenderer(n,p._rendererCache)),n={points:(new List).append(i),text:o,color:p.W99.properties().textcolor.value(),horzAlign:t.x<i.x?"left":"right",vertAlign:"middle",font:p.W99.properties().font.value(),offsetX:t.x>i.x?-5:5,offsetY:-5,bold:p.W99.properties().bold.value(),italic:p.W99.properties().italic.value(),fontsize:p.W99.properties().fontsize.value()},e.append(new TextRenderer(n,p._rendererCache)))};return e.append(new TrendLineRenderer(d(t,i))),l(t,i,this._price1,this._price2),2==this._points.size()?e:(e.append(new TrendLineRenderer(d(a,s))),l(s,a,this._price3,this._price3),this.isAnchorsRequired()&&(s=(new List).append(t).append(i).append(s).append(a),this.D0.lineBeingCreated()==this.W99&&s.removeAt(s.size()-1),e.append(this.createLineAnchor({points:s}))),!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&t&&i&&this.W99.getAlertIsActive(function(o){e.append(new PaneRendererClockIcon({point1:t,point2:i,color:o?n.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))}),e)},TradingView.LineToolFlatBottom=function(e,t){this._constructor="LineToolFlatBottom";var i=t?t:new $52("linetoolflatbottom");W47.call(this,e,new $78(this,e),i),this.version=TradingView.LineToolFlatBottom.version},inherit(TradingView.LineToolFlatBottom,W47),TradingView.LineToolFlatBottom.version=1,TradingView.LineToolFlatBottom.prototype.pointsCount=function(){return 3},TradingView.LineToolFlatBottom.prototype.title=function(){return"Flat Bottom"},TradingView.LineToolFlatBottom.prototype.addPoint=function(e,t){return t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2)),W47.prototype.addPoint.call(this,e)},TradingView.LineToolFlatBottom.prototype.setLastPoint=function(e,t){return t&&t.shift&&2==this.points().size()&&this._snapPoint45Degree(e,this.points().item(this.points().size()-2)),W47.prototype.setLastPoint.call(this,e)},TradingView.LineToolFlatBottom.prototype.setPoint=function(e,t,i){this._points.item(1),this._points.item(2),i&&i.shift&&1==e&&this._snapPoint45Degree(t,this.points().item(0)),3>e?W47.prototype.setPoint.call(this,e,t):this._points.item(0).index=t.index},TradingView.LineToolFlatBottom.prototype.canHasAlert=function(){return!0},TradingView.LineToolFlatBottom.prototype._getAlertPlots=function(){var e=this._points.item(0),t=this._points.item(1),i=[];e.index<=t.index?(i.push(e),i.push(t)):(i.push(t),i.push(e));var n=this._points.item(2);n.time=t.time,n.index=t.index;var o={price:n.price,time:e.time,index:e.index},r=[];return n.index<=o.index?(r.push(n),r.push(o)):(r.push(o),r.push(n)),i[0].price>r[0].price?(n=i,i=r):r[0].price>i[0].price?n=r:r[1].price>i[1].price?n=r:(n=i,i=r),r=this.properties().extendLeft.value(),o=this.properties().extendRight.value(),e.index<=t.index?(e=r,t=o):(e=o,t=r),[this._linePointsToAlertPlot(n,"Upper",e,t),this._linePointsToAlertPlot(i,"Lower",r,t)]},IconRenderer.prototype.draw=function(e){var t=String.fromCharCode(this._data.icon);e.font=this._data.size+"px FontAwesome";var i=e.measureText(t).width;e.textBaseline="middle";var n=this._data.point;e.translate(n.x,n.y),e.rotate(this._data.angle-Math.PI/2),e.scale(this._data.scale,1),n=65536*this._data.icon+this._data.size,this._cache[n]=i,this._data.selected&&(e.fillStyle="rgba(80, 80, 80, 0.2)",e.fillRect(-this._cache[n]/2,-this._data.size/2,this._cache[n],this._data.size)),e.fillStyle=this._data.color,e.fillText(t,-this._cache[n]/2,0)},IconRenderer.prototype.hitTest=function(e){var t=this._cache[65536*this._data.icon+this._data.size]*this._data.scale,i=MathEx.Matrix.rotate(-this._data.angle);return e=e.substract(this._data.point),e=i.mult(e),Math.abs(e.y)<=t/2&&Math.abs(e.x)<=this._data.size/2?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit($87,$90),$87.anchorLimit=80,$87.prototype.renderer=function(){var e=new CompositeRenderer;if(1>this._points.size())return e;var t=this.W99.properties(),i={point:this._points.item(0),color:t.color.value(),size:t.size.value(),icon:t.icon.value(),angle:t.angle.value(),scale:t.scale.value(),selected:this.isAnchorsRequired()},n=this.D0,o=this.W99;if(e.append(new IconRenderer(i,this._cache)),this.isAnchorsRequired()){var r=this._cache[65536*i.icon+i.size],s=i.size,i=this._points.item(0),a=t.scale.value(),s=new MathEx.Point(Math.max($87.anchorLimit,s)/2,0),r=new MathEx.Point(0,Math.max($87.anchorLimit,a*r)/2),t=MathEx.Matrix.rotate(t.angle.value()),s=t.mult(s),r=t.mult(r),t=i.add(s);t.data=0,s=i.substract(s),s.data=1,a=i.add(r),a.data=2,a.square=!0,r=i.substract(r),r.data=3,r.square=!0,i={points:(new List).append(t).append(s),width:n.timeScale().width(),height:o.priceScale().height(),color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED,extendleft:!1,extendright:!1,leftend:W47.LINEEND_NORMAL,rightend:W47.LINEEND_NORMAL},n=new TrendLineRenderer(i),n._hittest=null,e.append(n),e.append(this.createLineAnchor({points:(new List).append(t).append(s).append(a).append(r)}))}return e},TradingView.LineToolIcon=function(e,t){this._constructor="LineToolIcon";var i=t?t:new $52("linetoolicon");i.addExclusion("angle"),i.addExclusion("scale"),W47.call(this,e,new $87(this,e),i),this.version=TradingView.LineToolIcon.version},TradingView.LineToolIcon._getAvailIcons=function(){for(var e=[],e=e.concat([61536,61537,61538,61539]),e=e.concat([61725,61726]),e=e.concat([61575,61576,61796,61797]),e=e.concat([61779,61780,61781,61782,61783,61784,61785,61786]),t=e.slice(0),i=61440;61846>=i;i++)-1!=$.inArray(i,e)||15==i%16&&61487!==i||i>=61620&&61630>=i||61718!=i&&61719!=i&&61472!=i&&61619!=i&&t.push(i);
return t},TradingView.LineToolIcon.availIcons=TradingView.LineToolIcon._getAvailIcons(),inherit(TradingView.LineToolIcon,W47),TradingView.LineToolIcon.version=1,TradingView.LineToolIcon.prototype.pointsCount=function(){return 1},TradingView.LineToolIcon.prototype.title=function(){return"Icon"},TradingView.LineToolIcon.prototype.startChanging=function(e,t){W47.prototype.startChanging.call(this,e,t);var i=this.properties(),n=65536*i.icon.value()+i.size.value();this._startChangeWidth=this._paneViews[0]._cache[n],i.size.value()<$87.anchorLimit?this._sizeScale=i.size.value()/$87.anchorLimit:this._sizeScale=1,this._origScale=i.scale.value(),this._resizeRatio=this._startChangeWidth*this._origScale<$87.anchorLimit?this._startChangeWidth/$87.anchorLimit:1},TradingView.LineToolIcon.prototype.endChanging=function(){W47.prototype.endChanging.call(this),delete this._startChangeWidth,delete this._sizeScale,delete this._resizeRatio},TradingView.LineToolIcon.prototype.setPoint=function(e,t,i){var n=this.priceScale();if(n.isPercent()){var o=this.ownerSource().firstValue();t.price=n.priceRange().convertFromPercent(t.price,o)}i&&i.shift&&this.D2.snapTo45Degrees&&this._snapPoint45Degree(t,this.points().item(0)),i=this.pointToScreenPoint(this.points().item(0))[1],n=this.pointToScreenPoint(t)[1],0==e||1==e?(t=n.substract(i).normalized(),i=2*n.substract(i).length(),i*=this._sizeScale,this.D2.size.setValue(i),i=Math.acos(-t.x),0<Math.asin(t.y)&&(i=2*Math.PI-i),0==e&&(i+=Math.PI),this.D2.angle.setValue(i)):(e=this._startChangeWidth,t=n.substract(i).length(),this._origScale*e<$87.anchorLimit?(e=$87.anchorLimit/2,this.D2.scale.setValue(this._origScale*t/e)):this.D2.scale.setValue(t/(e/2)))},inherit(W10,$90),W10.prototype.update=function(){$90.prototype.update.call(this),this._distance=0,3==this._points.size()&&(this._distance=MathEx.distanceToLine(this._points.item(0),this._points.item(1),this._points.item(2)).distance)},W10.prototype.renderer=function(){var e=new CompositeRenderer,t=this.W99.properties(),i=this._points.item(0);if(2<=this._points.size())var n=this._points.item(1);if(2==this._points.size()){var o={};o.points=this._points,o.floatPoints=this._floatPoints,o.width=this.D0.timeScale().width(),o.height=this.W99.priceScale().height(),o.color=t.color.value(),o.linewidth=1,o.linestyle=CanvasEx.LINESTYLE_SOLID,o.extendleft=!1,o.extendright=!1,o.leftend=W47.LINEEND_NORMAL,o.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(o))}else if(3==this._points.size()){this._points.item(2);var r=n.substract(i),s=new MathEx.Point(r.y,-r.x).normalized().scaled(this._distance),a=s.scaled(-1),r=i.add(s),s=n.add(s),l=i.add(a),a=n.add(a),o={};o.points=(new List).append(r).append(s).append(a).append(l),o.color=t.color.value(),o.linewidth=this.W99.properties().linewidth.value(),o.linestyle=CanvasEx.LINESTYLE_SOLID,o.filled=!0,o.backcolor=t.backgroundColor.value(),o.fillBackground=t.fillBackground.value(),o.transparency=t.transparency.value(),e.append(new PoligonRenderer(o))}return this.isAnchorsRequired()&&(t=new List,t.append(i),2<=this._points.size()&&t.append(n),3==this._points.size()&&(r.data=2,l.data=2,s.data=2,a.data=2,t.append(r),t.append(l),t.append(s),t.append(a)),e.append(this.createLineAnchor({points:t}))),e},TradingView.LineToolRotatedRectangle=function(e,t){this._constructor="LineToolRotatedRectangle";var i=t?t:new $52("linetoolrotatedrectangle");W47.call(this,e,new W10(this,e),i)},inherit(TradingView.LineToolRotatedRectangle,W47),TradingView.LineToolRotatedRectangle.prototype.startChanging=function(e,t){if(W47.prototype.startChanging.call(this,e,t),0==e||1==e){var i=this._paneViews[0],n=i._points.item(0),o=i._points.item(1),i=i._points.item(2);this._distance=MathEx.distanceToLine(n,o,i).distance}},TradingView.LineToolRotatedRectangle.prototype.setPoint=function(e,t,i){W47.prototype.setPoint.call(this,e,t,i),(0==e||1==e)&&(t=this._paneViews[0],t.update(),e=t._points.item(0),t=t._points.item(1).substract(e),t=new MathEx.Point(t.y,-t.x).normalized().scaled(this._distance),e=e.add(t),e=this.screenPointToPoint(e),this._points.setItem(2,e))},TradingView.LineToolRotatedRectangle.prototype.endChanging=function(){delete this._distance},TradingView.LineToolRotatedRectangle.prototype.pointsCount=function(){return 3},TradingView.LineToolRotatedRectangle.prototype.title=function(){return"Rotated Rectangle"},AngleRenderer.prototype.hitTest=function(){return null},AngleRenderer.prototype.draw=function(e){e.save(),e.translate(this._data.point.x,this._data.point.y),e.strokeStyle=this._data.color;var t=[1,2];"function"==typeof e.setLineDash?e.setLineDash(t):void 0!==e.mozDash?e.mozDash=t:void 0!==e.webkitLineDash&&(e.webkitLineDash=t),t=this._data.size,e.beginPath(),e.moveTo(0,0),e.lineTo(t,0),e.arc(0,0,t,0,-this._data.angle,0<this._data.angle),e.stroke(),e.restore()},inherit(W40,$90),W40.prototype.update=function(){if($90.prototype.update.call(this),0<this._points.size()&&void 0!==this.W99._angle){var e=this._points.item(0),t=Math.cos(this.W99._angle),i=-Math.sin(this.W99._angle),t=new MathEx.Point(t,i);this._secondPoint=e.addScaled(t,this.W99._distance),this._secondPoint.data=1}if(this._label=null,!(2>this.W99.points().size())){var n,o,e=this.W99.points().item(0),i=this.W99.points().item(1),t=[];if(this.W99.properties().showPriceRange.value()&&this.W99.priceScale()){var r=i.price-e.price;n=r/e.price,n=this.W99.priceScale().formatter().format(r)+" ("+(new PercentageFormatter).format(100*n)+")";var s=this.D0.mainSeries().base();s&&(r=Math.round(r*s),n+=", "+r),t.push("priceRange")}this.W99.properties().showBarsRange.value()&&(e=i.index-e.index,o=""+$.t("{0} bars").format(e),t.push("barsRange")),this._label=[n,o].filter(function(e){return e}).join("\n")||null,this._icons=t}},W40.prototype.renderer=function(){var e=new CompositeRenderer;if(this._secondPoint&&0<this._points.size()){var t={};if(t.points=(new List).append(this._points.item(0)).append(this._secondPoint),t.width=this.D0.timeScale().width(),t.height=this.W99.priceScale().height(),t.color=this.W99.properties().linecolor.value(),t.linewidth=this.W99.properties().linewidth.value(),t.linestyle=this.W99.properties().linestyle.value(),t.extendleft=this.W99.properties().extendLeft.value(),t.extendright=this.W99.properties().extendRight.value(),t.leftend=W47.LINEEND_NORMAL,t.rightend=W47.LINEEND_NORMAL,e.append(new TrendLineRenderer(t)),(this.isAnchorsRequired()||this.W99.properties().alwaysShowStats.value())&&this._label&&2==this._points.size()){var i={points:(new List).append(this._secondPoint),text:this._label,color:this.W99.properties().textcolor.value(),font:TradingView.LineToolTrendLine.LABEL_FONT,fontsize:TradingView.LineToolTrendLine.LABEL_FONTSIZE,lineSpacing:TradingView.LineToolTrendLine.LABEL_LINESPACING,backgroundColor:TradingView.LineToolTrendLine.LABEL_BGCOLOR,borderColor:TradingView.LineToolTrendLine.LABEL_BORDERCOLOR,borderWidth:1,padding:TradingView.LineToolTrendLine.LABEL_PADDING,paddingLeft:30,doNotAlignText:!0,icons:this._icons},n=TradingView.LineToolTrendLine.LABEL_OFFSET;this._points.item(1).y<this._points.item(0).y?(i.vertAlign="bottom",i.offsetY=-n):i.offsetY=n,this._points.item(1).x<this._points.item(0).x?(i.horzAlign="right",i.offsetX=-n):i.offsetX=n,e.append(new TrendLineStatsRenderer(i,this._rendererCache))}i={},i.point=this._points.item(0),i.angle=this.W99._angle,i.color=this.W99.properties().linecolor.value(),i.size=50,e.append(new AngleRenderer(i)),i=Math.round(180*i.angle/Math.PI)+"º",n=this._points.item(0).clone(),n.x+=50,i={points:(new List).append(n),text:i,color:this.W99.properties().textcolor.value(),horzAlign:"left",font:this.W99.properties().font.value(),offsetX:5,offsetY:0,bold:this.W99.properties().bold.value(),italic:this.W99.properties().italic.value(),fontsize:this.W99.properties().fontsize.value(),vertAlign:"middle"},e.append(new TextRenderer(i,this._rendererCache))}return!TradingView.printing&&this.W99.hasAlert.value()&&!this.D0.readOnly()&&t&&2<=t.points.size()&&this.W99.getAlertIsActive(function(i){e.append(new PaneRendererClockIcon({point1:t.points.clone().item(0),point2:t.points.clone().item(1),color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))}),this.isAnchorsRequired()&&this._secondPoint&&(i=t.points.clone(),this.D0.lineBeingCreated()==this.W99&&i.removeAt(i.size()-1),e.append(this.createLineAnchor({points:i}))),e},TradingView.LineToolTrendAngle=function(e,t){this._constructor="LineToolTrendAngleLine";var i=t?t:new $52("linetooltrendangle");W47.call(this,e,new W40(this,e),i),this.D2.addProperty("angle"),this.D2.angle=new TradingView.LineToolTrendAngle.AngleProperty(this)},inherit(TradingView.LineToolTrendAngle,W47),TradingView.LineToolTrendAngle.AngleProperty=function(e){Property.call(this),this._lineSource=e},inherit(TradingView.LineToolTrendAngle.AngleProperty,Property),TradingView.LineToolTrendAngle.AngleProperty.prototype.value=function(){return Math.round(180*this._lineSource._angle/Math.PI)},TradingView.LineToolTrendAngle.AngleProperty.prototype.setValue=function(e){this._lineSource._angle=e*Math.PI/180,e=this._lineSource.pointToScreenPoint(this._lineSource.points().item(0))[0];var t=Math.cos(this._lineSource._angle),i=-Math.sin(this._lineSource._angle),t=new MathEx.Point(t,i);e=e.addScaled(t,this._lineSource._distance),e=this._lineSource.screenPointToPoint(e),this._lineSource._points.setItem(1,e),this._lineSource.D0.updateSource(this._lineSource),this._lineSource.updateAllViews(),this._lineSource.D0.updateSource(this._lineSource)},TradingView.LineToolTrendAngle.prototype.pointsCount=function(){return 2},TradingView.LineToolTrendAngle.prototype.title=function(){return"Trend Angle"},TradingView.LineToolTrendAngle.prototype._calculateAngle=function(){var e=this.pointToScreenPoint(this.points().item(0))[0],t=this.pointToScreenPoint(this.points().item(1))[0],i=t.substract(e);0<i.length()?(i=i.normalized(),this._angle=Math.acos(i.x),0<i.y&&(this._angle=-this._angle),this._distance=t.substract(e).length()):delete this._angle,this.properties().hasOwnProperty("angle")&&this.properties().angle.listeners().fire(this.properties().angle)},TradingView.LineToolTrendAngle.prototype.addPoint=function(e,t){var i=W47.prototype.addPoint.call(this,e,t);return i&&this._calculateAngle(),i},TradingView.LineToolTrendAngle.prototype.setLastPoint=function(e,t){W47.prototype.setLastPoint.call(this,e,t),1<this.points().size()&&this._calculateAngle()},TradingView.LineToolTrendAngle.prototype.setPoint=function(e,t,i){W47.prototype.setPoint.call(this,e,t,i),1<this.points().size()&&this._calculateAngle()},TradingView.LineToolTrendAngle.prototype.restoreData=function(e){this._angle=e.angle,this._distance=e.distance},TradingView.LineToolTrendAngle.prototype.state=function(e){return e=W47.prototype.state.call(this,e),e.angle=this._angle,e.distance=this._distance,e},TradingView.LineToolTrendAngle.prototype.cloneData=function(e){this._angle=e._angle,this._distance=e._distance},TradingView.LineToolTrendAngle.prototype.canHasAlert=function(){return!0},TradingView.LineToolTrendAngle.prototype._getAlertPlots=function(){return[this._linePointsToAlertPlot(this._points.toArray(),null,this.properties().extendLeft.value(),this.properties().extendRight.value())]};var ChartTradingUtils={_fontHeightCache:{},_parseColor:function(e){var t=document.createElement("div");return t.style.color=e,e=t.style.color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i)||t.style.color.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\,\s*(\d*\.?\d+)\s*\)$/i),$(t).remove(),{r:e[1],g:e[2],b:e[3],a:e[4]||"1"}},getColorFromProperties:function(e,t){var i=1-t.value()/100,n=this._parseColor(e.value());return"rgba("+n.r+","+n.g+","+n.b+","+i+")"},setColorToProperties:function(e,t,i){e=this._parseColor(e),t.setValue("rgb("+e.r+","+e.g+","+e.b+")"),i.setValue(Math.max(0,Math.min(100*(1-e.a),100)))},_parseFont:function(e){var t=document.createElement("div");return t.style.font=e,e=t.style.fontSize.match(/(\d+)pt/),e={family:t.style.fontFamily,size:e&&e[0]==t.style.fontSize?e[1]:"",bold:"bold"==t.style.fontWeight,italic:"italic"==t.style.fontStyle},$(t).remove(),e},getFontFromProperties:function(e,t,i,n){return i=i.value()?"bold":"",n=n.value()?"italic":"",t=t.value()+"pt",e=e.value(),[i,n,t,e].join(" ")},setFontToProperties:function(e,t,i,n,o){e=this._parseFont(e),0<e.family.length&&t.setValue(e.family),0<e.size.length&&i.setValue(e.size),n.setValue(e.bold),o.setValue(e.italic)},fontHeight:function(e){if(!this._fontHeightCache[e]){var t=document.createElement("span");t.appendChild(document.createTextNode("height")),document.body.appendChild(t),t.style.cssText="font: "+e+"; white-space: nowrap; display: inline;";var i=t.offsetHeight;document.body.removeChild(t),this._fontHeightCache[e]=Math.ceil(i)}return this._fontHeightCache[e]},drawPolyHoverOrPress:function(e,t,i,n){n?(e.save(),e.fillStyle="rgba(0, 0, 0, 0.15)",CanvasEx.drawPoly(e,t,!0),e.restore()):i&&(e.save(),e.fillStyle="rgba(0, 0, 0, 0.1)",CanvasEx.drawPoly(e,t,!0),e.restore())},repaint:function(e){var t=new A22(A22.LIGHT_UPDATE);t.force=!0,e.D20(t)},roundToMinTick:function(e,t){var i=1/e.mainSource().base();return i*Math.round(t/i)}};TradingView.LineToolTrading=function(e,t,i){this.customization={forcePriceAxisLabel:!0,disableSelection:!0,disableErasing:!0},W47.call(this,e,t,i)},inherit(TradingView.LineToolTrading,W47),TradingView.LineToolTrading.POINTS_COUNT=1,TradingView.LineToolTrading.prototype.pointsCount=function(){return TradingView.LineToolTrading.POINTS_COUNT},TradingView.LineToolTrading.prototype.hasContextMenu=function(){return!1},TradingView.LineToolTrading.prototype.state=function(){return null},TradingView.LineToolTrading.prototype.startMoving=function(){W47.prototype.startMoving.apply(this,arguments),this._cursorMoved=!1},TradingView.LineToolTrading.prototype.endMoving=function(){W47.prototype.endMoving.apply(this,arguments),this._cursorMoved=!1},TradingView.LineToolTrading.prototype.correctPoints=function(e){this._currentMovingPoint&&this._startMovingPoint?this._currentMovingPoint.price-this._startMovingPoint.price&&(this._cursorMoved=!0):this._cursorMoved=!1;for(var t=1/this.priceScale().mainSource().base(),i=0;i<e.size();i++){var n=e.item(i);this._cursorMoved&&(n.price=this._currentMovingPoint.price),n.price=t*Math.round(n.price/t),e.setItem(i,n)}},TradingView.LineToolTrading.prototype.userEditEnabled=function(){return!0},TradingView.LineToolTrading.prototype.isUserDeletable=function(){return!1},TradingView.LineToolTrading.prototype.showInObjectTree=function(){return!1},OrderLineAdapter.prototype.getPrice=function(){return this._line.points().item(0).price},OrderLineAdapter.prototype.setPrice=function(e){var t=this._line.points().item(0);return t.price=e,this._line._points.setItem(0,t),this._line.normalizePoints(),this},OrderLineAdapter.prototype.getText=function(){return this._data.bodyText},OrderLineAdapter.prototype.setText=function(e){return this._data.bodyText=e||"",this},OrderLineAdapter.prototype.setTooltip=function(e){return e=null==e?"":e+"",this._line.properties().tooltip.setValue(e),this},OrderLineAdapter.prototype.getTooltip=function(){return this._line.properties().tooltip.value()},OrderLineAdapter.prototype.getQuantity=function(){return this._data.quantityText},OrderLineAdapter.prototype.setQuantity=function(e){return this._data.quantityText=e||"",this},OrderLineAdapter.prototype.getExtendLeft=function(){var e=this._line.properties().extendLeft.value();return"inherit"==e?this._line.D0.properties().tradingProperties.extendLeft.value():e},OrderLineAdapter.prototype.setExtendLeft=function(e){return this._line.properties().extendLeft.setValue(e),this},OrderLineAdapter.prototype.getLineLength=function(){var e=this._line.properties().lineLength.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineLength.value():e},OrderLineAdapter.prototype.setLineLength=function(e){return this._line.properties().lineLength.setValue(Math.max(0,Math.min(e,100))),this},OrderLineAdapter.prototype.getLineColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().lineColor,this._line.properties().lineTransparency)},OrderLineAdapter.prototype.setLineColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().lineColor,this._line.properties().lineTransparency),this},OrderLineAdapter.prototype.getLineStyle=function(){var e=this._line.properties().lineStyle.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineStyle.value():e},OrderLineAdapter.prototype.setLineStyle=function(e){return this._line.properties().lineStyle.setValue(e),this},OrderLineAdapter.prototype.getLineWidth=function(){var e=this._line.properties().lineWidth.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineWidth.value():e},OrderLineAdapter.prototype.setLineWidth=function(e){return this._line.properties().lineWidth.setValue(e),this},OrderLineAdapter.prototype.getBodyBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBorderColor,this._line.properties().bodyBorderTransparency)},OrderLineAdapter.prototype.setBodyBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyBorderColor,this._line.properties().bodyBorderTransparency),this},OrderLineAdapter.prototype.getBodyBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency)},OrderLineAdapter.prototype.setBodyBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency),this},OrderLineAdapter.prototype.getBodyTextColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyTextColor,this._line.properties().bodyTextTransparency)},OrderLineAdapter.prototype.setBodyTextColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyTextColor,this._line.properties().bodyTextTransparency),this},OrderLineAdapter.prototype.getBodyFont=function(){return ChartTradingUtils.getFontFromProperties(this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic)},OrderLineAdapter.prototype.setBodyFont=function(e){return ChartTradingUtils.setFontToProperties(e,this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic),this},OrderLineAdapter.prototype.getQuantityBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBorderColor,this._line.properties().quantityBorderTransparency)},OrderLineAdapter.prototype.setQuantityBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityBorderColor,this._line.properties().quantityBorderTransparency),this},OrderLineAdapter.prototype.getQuantityBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBackgroundColor,this._line.properties().quantityBackgroundTransparency)},OrderLineAdapter.prototype.setQuantityBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityBackgroundColor,this._line.properties().quantityBackgroundTransparency),this},OrderLineAdapter.prototype.getQuantityTextColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency)},OrderLineAdapter.prototype.setQuantityTextColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency),this},OrderLineAdapter.prototype.getQuantityFont=function(){return ChartTradingUtils.getFontFromProperties(this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic)},OrderLineAdapter.prototype.setQuantityFont=function(e){return ChartTradingUtils.setFontToProperties(e,this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic),this},OrderLineAdapter.prototype.getCancelButtonBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonBorderColor,this._line.properties().cancelButtonBorderTransparency)},OrderLineAdapter.prototype.setCancelButtonBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().cancelButtonBorderColor,this._line.properties().cancelButtonBorderTransparency),this},OrderLineAdapter.prototype.getCancelButtonBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonBackgroundColor,this._line.properties().cancelButtonBackgroundTransparency)},OrderLineAdapter.prototype.setCancelButtonBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().cancelButtonBackgroundColor,this._line.properties().cancelButtonBackgroundTransparency),this},OrderLineAdapter.prototype.getCancelButtonIconColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonIconColor,this._line.properties().cancelButtonIconTransparency)},OrderLineAdapter.prototype.setCancelButtonIconColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().cancelButtonIconColor,this._line.properties().cancelButtonIconTransparency),this},OrderLineAdapter.prototype.isFunction=function(e){return"function"==typeof e},OrderLineAdapter.prototype.onCancel=function(e,t){return t?this.isFunction(t)&&(this._onCancelData=e,this._onCancelCallback=t):this.isFunction(e)&&(this._onCancelCallback=e),this},OrderLineAdapter.prototype.callOnCancel=function(){this.isFunction(this._onCancelCallback)&&this._onCancelCallback.call(this,this._onCancelData)},OrderLineAdapter.prototype.isOnCancelCallbackPresent=function(){return this.isFunction(this._onCancelCallback)},OrderLineAdapter.prototype.onModify=function(e,t){return t?this.isFunction(t)&&(this._onModifyData=e,this._onModifyCallback=t):this.isFunction(e)&&(this._onModifyCallback=e),this},OrderLineAdapter.prototype.callOnModify=function(){this.isFunction(this._onModifyCallback)&&this._onModifyCallback.call(this,this._onModifyData)},OrderLineAdapter.prototype.onMove=function(e,t){return t?this.isFunction(t)&&(this._onMoveData=e,this._onMoveCallback=t):this.isFunction(e)&&(this._onMoveCallback=e),this},OrderLineAdapter.prototype.callOnMove=function(){this.isFunction(this._onMoveCallback)&&this._onMoveCallback.call(this,this._onMoveData)},OrderLineAdapter.prototype.onContextMenu=function(e,t){return t?this.isFunction(t)&&(this._onContextMenuData=e,this._onContextMenuCallback=t):this.isFunction(e)&&(this._onContextMenuCallback=e),this},OrderLineAdapter.prototype.callOnContextMenu=function(){return this.isFunction(this._onContextMenuCallback)?this._onContextMenuCallback.call(this,this._onContextMenuData):void 0},OrderLineAdapter.prototype.remove=function(){this._line.D0.removeSource(this._line),delete this._line},OrderRenderer.prototype._height=function(){return Math.max(20,1+Math.max(ChartTradingUtils.fontHeight(this._adapter.getBodyFont()),ChartTradingUtils.fontHeight(this._adapter.getQuantityFont())))},OrderRenderer.prototype._bodyWidth=function(e){if(0==this._adapter.getText().length)return 0;e.save(),e.font=this._adapter.getBodyFont();var t=e.measureText(this._adapter.getText()).width;return e.restore(),Math.round(20+t)},OrderRenderer.prototype._quantityWidth=function(e){if(0==this._adapter.getQuantity().length)return 0;e.save(),e.font=this._adapter.getQuantityFont();var t=e.measureText(this._adapter.getQuantity()).width;return e.restore(),Math.round(Math.max(this._height(),10+t))},OrderRenderer.prototype._cancelButtonWidth=function(){return this._adapter.isOnCancelCallbackPresent()?this._height():0},OrderRenderer.prototype._drawLines=function(e,t,i,n,o){e.save(),e.strokeStyle=this._adapter.getLineColor(),e.lineStyle=this._adapter.getLineStyle(),e.lineWidth=this._adapter.getLineWidth(),CanvasEx.drawLine(e,i,n,o,n),this._adapter.getExtendLeft()&&CanvasEx.drawLine(e,0,n,t,n),e.restore()},OrderRenderer.prototype._drawMovePoints=function(e,t,i){e.save(),e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBorderColor(),t+=4;for(var n=t+2,o=Math.floor((this._height()-10)/2)+1,r=0;o>r;++r){var s=i+5+2*r;CanvasEx.drawLine(e,t,s,n,s)}e.restore()},OrderRenderer.prototype._drawBody=function(e,t,i){e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBackgroundColor();var n=this._bodyWidth(e),o=this._height();e.fillRect(t+.5,i+.5,n-1,o-1),e.strokeRect(t,i,n,o)},OrderRenderer.prototype._drawBodyText=function(e,t,i){e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getBodyFont(),e.fillStyle=this._adapter.getBodyTextColor(),t+=this._bodyWidth(e)/2,i+=this._height()/2,e.fillText(this._adapter.getText(),5+t-2,i)},OrderRenderer.prototype._drawQuantity=function(e,t,i,n){e.save(),e.strokeStyle=this._adapter.getQuantityBorderColor(),e.fillStyle=this._adapter.getQuantityBackgroundColor();var o=this._quantityWidth(e),r=this._height();e.fillRect(t+.5,i+.5,o-1,r-1),n&&e.clip&&(e.beginPath(),e.rect(t+.5,i-.5,o+1,r+1),e.clip()),e.strokeRect(t,i,o,r),e.restore()},OrderRenderer.prototype._drawQuantityText=function(e,t,i){e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getQuantityFont(),e.fillStyle=this._adapter.getQuantityTextColor(),t+=this._quantityWidth(e)/2,i+=this._height()/2,e.fillText(this._adapter.getQuantity(),t,i),e.restore()},OrderRenderer.prototype._drawCancelButton=function(e,t,i,n){e.strokeStyle=this._adapter.getCancelButtonBorderColor(),e.fillStyle=this._adapter.getCancelButtonBackgroundColor();var o=this._cancelButtonWidth(),r=this._height();e.fillRect(t+.5,i+.5,o-1,r-1),e.save(),n&&e.clip&&(e.beginPath(),e.rect(t+.5,i-.5,o+1,r+1),e.clip()),e.strokeRect(t,i,o,r),e.restore(),n=t+o,r=i+r,e.strokeStyle=this._adapter.getCancelButtonIconColor();var o=(this._cancelButtonWidth()-8)/2,s=(this._height()-8)/2;CanvasEx.drawPoly(e,[{x:t+o,y:i+s},{x:n-o,y:r-s}],!0),CanvasEx.drawPoly(e,[{x:n-o,y:i+s},{x:t+o,y:r-s}],!0)},OrderRenderer.prototype.draw=function(e){if(this._data.points&&!(1>this._data.points.size())){var t=e.canvas.width,i=this._bodyWidth(e),n=this._quantityWidth(e),o=i+n+this._cancelButtonWidth(),r=t-o,s=Math.max(this._adapter.getLineLength()/100*t,1),r=Math.round(t-Math.min(r,s)),o=r-o,a=Math.round(this._data.points.item(0).y),s=Math.round(a-(this._height()+1)/2);this._cache.bodyRight=o+i,this._cache.quantityRight=o+i+n,this._cache.top=s,this._cache.bottom=s+this._height(),this._cache.left=o,this._cache.right=r,this._drawLines(e,o,r,a,t),t=!1,0!=i&&(this._drawBody(e,o,s),this._drawMovePoints(e,o,s),this._drawBodyText(e,o,s),t=!0),0!=n&&(this._drawQuantity(e,o+i,s,t),this._drawQuantityText(e,o+i,s),t=!0),0!=this._cancelButtonWidth()&&this._drawCancelButton(e,o+i+n,s,t)}},OrderRenderer.prototype.hitTest=function(e){return 0===this._data.points.size()||e.y<this._cache.top||e.y>this._cache.bottom?null:e.x>=this._cache.left&&e.x<this._cache.bodyRight?0==this._adapter.getTooltip().length?new HitTestResult(HitTestResult.MOVEPOINT):new HitTestResult(HitTestResult.MOVEPOINT,{tooltip:{text:this._adapter.getTooltip(),rect:new TradingView.Rect(this._cache.left,this._cache.top,this._cache.bodyRight-this._cache.left,this._cache.bottom-this._cache.top)}}):e.x>=this._cache.bodyRight&&e.x<this._cache.quantityRight?new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:this._adapter.callOnModify.bind(this._adapter),tooltip:{text:"Edit Order",rect:new TradingView.Rect(this._cache.bodyRight,this._cache.top,this._cache.quantityRight-this._cache.bodyRight,this._cache.bottom-this._cache.top)}}):e.x>=this._cache.quantityRight&&e.x<this._cache.right?new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:this._adapter.callOnCancel.bind(this._adapter),tooltip:{text:"Cancel Order",rect:new TradingView.Rect(this._cache.quantityRight,this._cache.top,this._cache.right-this._cache.quantityRight,this._cache.bottom-this._cache.top)}}):null},inherit(OrderPriceAxisView,W48),OrderPriceAxisView.prototype._updateImpl=function(){W48.prototype._updateImpl.call(this),this._background=this._linetool.properties().lineColor.value()},inherit(OrderPaneView,$90),OrderPaneView.prototype.renderer=function(){return new OrderRenderer({points:this._points},this._rendererCache,this.W99._adapter)},TradingView.LineToolOrder=function(e,t){this._adapter=new OrderLineAdapter(this),this._constructor="LineToolOrder";var i=t||new $52("linetoolorder");TradingView.LineToolTrading.call(this,e,new OrderPaneView(this,e),i)},inherit(TradingView.LineToolOrder,TradingView.LineToolTrading),TradingView.LineToolOrder.skipMagnetting=!0,TradingView.LineToolOrder.prototype.setPoint=function(e,t,i){this._points.setItem(e,t),this.normalizePoints()},TradingView.LineToolOrder.prototype.addPoint=function(e,t){return this._points.append(e),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0},TradingView.LineToolOrder.prototype.title=function(){return"Order"},TradingView.LineToolOrder.prototype.endMoving=function(e){var t=this._startMovingPoint&&this._currentMovingPoint&&this._startMovingPoint.price!=this._currentMovingPoint.price;TradingView.LineToolTrading.prototype.endMoving.call(this),!e&&t&&this._adapter.callOnMove()},TradingView.LineToolOrder.prototype.createPriceAxisView=function(e){return this._priceAxisView=new OrderPriceAxisView(this,e)},TradingView.LineToolOrder.prototype.paneViews=function(e){return TradingView.printing||!this.D0.properties().tradingProperties.showOrders.value()?null:W47.prototype.paneViews.call(this,e)},TradingView.LineToolOrder.prototype.priceAxisViews=function(e,t){return TradingView.printing||!this.D0.properties().tradingProperties.showOrders.value()?null:W47.prototype.priceAxisViews.call(this,e,t)},TradingView.LineToolOrder.prototype.hasContextMenu=function(){return!0},TradingView.LineToolOrder.prototype.contextMenuItems=function(){return this._adapter.callOnContextMenu()},PositionLineAdapter.prototype.getPrice=function(){return this._line.points().item(0).price},PositionLineAdapter.prototype.setPrice=function(e){var t=this._line.points().item(0);return t.price=e,this._line._points.setItem(0,t),this._line.normalizePoints(),this},PositionLineAdapter.prototype.getText=function(){return this._data.bodyText},PositionLineAdapter.prototype.setText=function(e){return this._data.bodyText=e||"",this},PositionLineAdapter.prototype.setTooltip=function(e){return e=null==e?"":e+"",this._line.properties().tooltip.setValue(e),this},PositionLineAdapter.prototype.getTooltip=function(){return this._line.properties().tooltip.value()},PositionLineAdapter.prototype.getQuantity=function(){return this._data.quantityText},PositionLineAdapter.prototype.setQuantity=function(e){return this._data.quantityText=e||"",this},PositionLineAdapter.prototype.getExtendLeft=function(){var e=this._line.properties().extendLeft.value();return"inherit"==e?this._line.D0.properties().tradingProperties.extendLeft.value():e},PositionLineAdapter.prototype.setExtendLeft=function(e){return this._line.properties().extendLeft.setValue(e),this},PositionLineAdapter.prototype.getLineLength=function(){var e=this._line.properties().lineLength.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineLength.value():e},PositionLineAdapter.prototype.setLineLength=function(e){return this._line.properties().lineLength.setValue(Math.max(0,Math.min(e,100))),this},PositionLineAdapter.prototype.getLineColor=function(){
return ChartTradingUtils.getColorFromProperties(this._line.properties().lineColor,this._line.properties().lineTransparency)},PositionLineAdapter.prototype.setLineColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().lineColor,this._line.properties().lineTransparency),this},PositionLineAdapter.prototype.getLineStyle=function(){var e=this._line.properties().lineStyle.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineStyle.value():e},PositionLineAdapter.prototype.setLineStyle=function(e){return this._line.properties().lineStyle.setValue(e),this},PositionLineAdapter.prototype.getLineWidth=function(){var e=this._line.properties().lineWidth.value();return"inherit"==e?this._line.D0.properties().tradingProperties.lineWidth.value():e},PositionLineAdapter.prototype.setLineWidth=function(e){return this._line.properties().lineWidth.setValue(e),this},PositionLineAdapter.prototype.getBodyBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBorderColor,this._line.properties().bodyBorderTransparency)},PositionLineAdapter.prototype.setBodyBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyBorderColor,this._line.properties().bodyBorderTransparency),this},PositionLineAdapter.prototype.getBodyBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency)},PositionLineAdapter.prototype.setBodyBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency),this},PositionLineAdapter.prototype.getBodyTextColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyTextColor,this._line.properties().bodyTextTransparency)},PositionLineAdapter.prototype.setBodyTextColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().bodyTextColor,this._line.properties().bodyTextTransparency),this},PositionLineAdapter.prototype.getBodyFont=function(){return ChartTradingUtils.getFontFromProperties(this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic)},PositionLineAdapter.prototype.setBodyFont=function(e){return ChartTradingUtils.setFontToProperties(e,this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic),this},PositionLineAdapter.prototype.getQuantityBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBorderColor,this._line.properties().quantityBorderTransparency)},PositionLineAdapter.prototype.setQuantityBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityBorderColor,this._line.properties().quantityBorderTransparency),this},PositionLineAdapter.prototype.getQuantityBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBackgroundColor,this._line.properties().quantityBackgroundTransparency)},PositionLineAdapter.prototype.setQuantityBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityBackgroundColor,this._line.properties().quantityBackgroundTransparency),this},PositionLineAdapter.prototype.getQuantityTextColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency)},PositionLineAdapter.prototype.setQuantityTextColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency),this},PositionLineAdapter.prototype.getQuantityFont=function(){return ChartTradingUtils.getFontFromProperties(this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic)},PositionLineAdapter.prototype.setQuantityFont=function(e){return ChartTradingUtils.setFontToProperties(e,this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic),this},PositionLineAdapter.prototype.getReverseButtonBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonBorderColor,this._line.properties().reverseButtonBorderTransparency)},PositionLineAdapter.prototype.setReverseButtonBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().reverseButtonBorderColor,this._line.properties().reverseButtonBorderTransparency),this},PositionLineAdapter.prototype.getReverseButtonBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency)},PositionLineAdapter.prototype.setReverseButtonBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency),this},PositionLineAdapter.prototype.getReverseButtonIconColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonIconColor,this._line.properties().reverseButtonIconTransparency)},PositionLineAdapter.prototype.setReverseButtonIconColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().reverseButtonIconColor,this._line.properties().reverseButtonIconTransparency),this},PositionLineAdapter.prototype.getCloseButtonBorderColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonBorderColor,this._line.properties().closeButtonBorderTransparency)},PositionLineAdapter.prototype.setCloseButtonBorderColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().closeButtonBorderColor,this._line.properties().closeButtonBorderTransparency),this},PositionLineAdapter.prototype.getCloseButtonBackgroundColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency)},PositionLineAdapter.prototype.setCloseButtonBackgroundColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency),this},PositionLineAdapter.prototype.getCloseButtonIconColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonIconColor,this._line.properties().closeButtonIconTransparency)},PositionLineAdapter.prototype.setCloseButtonIconColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().closeButtonIconColor,this._line.properties().closeButtonIconTransparency),this},PositionLineAdapter.prototype.isFunction=function(e){return"function"==typeof e},PositionLineAdapter.prototype.onReverse=function(e,t){return t?this.isFunction(t)&&(this._onReverseData=e,this._onReverseCallback=t):this.isFunction(e)&&(this._onReverseCallback=e),this},PositionLineAdapter.prototype.callOnReverse=function(){this.isFunction(this._onReverseCallback)&&this._onReverseCallback.call(this,this._onReverseData)},PositionLineAdapter.prototype.isOnReverseCallbackPresent=function(){return this.isFunction(this._onReverseCallback)},PositionLineAdapter.prototype.onClose=function(e,t){return t?this.isFunction(t)&&(this._onCloseData=e,this._onCloseCallback=t):this.isFunction(e)&&(this._onCloseCallback=e),this},PositionLineAdapter.prototype.callOnClose=function(){this.isFunction(this._onCloseCallback)&&this._onCloseCallback.call(this,this._onCloseData)},PositionLineAdapter.prototype.isOnCloseCallbackPresent=function(){return this.isFunction(this._onCloseCallback)},PositionLineAdapter.prototype.onModify=function(e,t){return t?this.isFunction(t)&&(this._onModifyData=e,this._onModifyCallback=t):this.isFunction(e)&&(this._onModifyCallback=e),this},PositionLineAdapter.prototype.callOnModify=function(){this.isFunction(this._onModifyCallback)&&this._onModifyCallback.call(this,this._onModifyData)},PositionLineAdapter.prototype.onContextMenu=function(e,t){return t?this.isFunction(t)&&(this._onContextMenuData=e,this._onContextMenuCallback=t):this.isFunction(e)&&(this._onContextMenuCallback=e),this},PositionLineAdapter.prototype.callOnContextMenu=function(){return this.isFunction(this._onContextMenuCallback)?this._onContextMenuCallback.call(this,this._onContextMenuData):void 0},PositionLineAdapter.prototype.remove=function(){this._line.D0.removeSource(this._line),delete this._line},PositionRenderer.prototype._height=function(){return Math.max(20,1+Math.max(ChartTradingUtils.fontHeight(this._adapter.getBodyFont()),ChartTradingUtils.fontHeight(this._adapter.getQuantityFont())))},PositionRenderer.prototype._bodyWidth=function(e){if(0==this._adapter.getText().length)return 0;e.save(),e.font=this._adapter.getBodyFont();var t=e.measureText(this._adapter.getText()).width;return e.restore(),Math.round(10+t)},PositionRenderer.prototype._quantityWidth=function(e){if(0==this._adapter.getQuantity().length)return 0;e.save(),e.font=this._adapter.getQuantityFont();var t=e.measureText(this._adapter.getQuantity()).width;return e.restore(),Math.round(Math.max(this._height(),10+t))},PositionRenderer.prototype._reverseButtonWidth=function(){return this._adapter.isOnReverseCallbackPresent()?this._height():0},PositionRenderer.prototype._closeButtonWidth=function(){return this._adapter.isOnCloseCallbackPresent()?this._height():0},PositionRenderer.prototype._drawLines=function(e,t,i,n,o){e.save(),e.strokeStyle=this._adapter.getLineColor(),e.lineStyle=this._adapter.getLineStyle(),e.lineWidth=this._adapter.getLineWidth(),CanvasEx.drawLine(e,i,n,o,n),this._adapter.getExtendLeft()&&CanvasEx.drawLine(e,0,n,t,n),e.restore()},PositionRenderer.prototype._drawBody=function(e,t,i){e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBackgroundColor();var n=this._bodyWidth(e),o=this._height();e.fillRect(t+.5,i+.5,n-1,o-1),e.strokeRect(t,i,n,o)},PositionRenderer.prototype._drawBodyText=function(e,t,i){e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getBodyFont(),e.fillStyle=this._adapter.getBodyTextColor(),t+=this._bodyWidth(e)/2,i+=this._height()/2,e.fillText(this._adapter.getText(),t,i),e.restore()},PositionRenderer.prototype._drawQuantity=function(e,t,i){e.strokeStyle=this._adapter.getQuantityBorderColor(),e.fillStyle=this._adapter.getQuantityBackgroundColor();var n=this._quantityWidth(e),o=this._height();e.fillRect(t+.5,i+.5,n-1,o-1),e.strokeRect(t,i,n,o)},PositionRenderer.prototype._drawQuantityText=function(e,t,i){e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getQuantityFont(),e.fillStyle=this._adapter.getQuantityTextColor(),t+=this._quantityWidth(e)/2,i+=this._height()/2,e.fillText(this._adapter.getQuantity(),t,i),e.restore()},PositionRenderer.prototype._drawReverseButton=function(e,t,i){e.save(),e.strokeStyle=this._adapter.getReverseButtonBorderColor(),e.fillStyle=this._adapter.getReverseButtonBackgroundColor();var n=this._reverseButtonWidth(),o=this._height();e.fillRect(t+.5,i+.5,n-1,o-1),e.strokeRect(t,i,n,o),e.strokeStyle=this._adapter.getReverseButtonIconColor(),n=function(e,t){CanvasEx.drawLine(e,0,0,0,t),CanvasEx.drawLine(e,-1,1,1,1),CanvasEx.drawLine(e,-2,2,2,2)},t+=Math.round((this._reverseButtonWidth()-6)/2),i+=5,e.save(),e.transform(1,0,0,1,t,i),n(e,10),e.transform(1,0,0,1,6,10),e.rotate(Math.PI),n(e,10),e.restore(),e.restore()},PositionRenderer.prototype._drawCloseButton=function(e,t,i){e.save(),e.strokeStyle=this._adapter.getCloseButtonBorderColor(),e.fillStyle=this._adapter.getCloseButtonBackgroundColor();var n=this._closeButtonWidth(),o=this._height();e.fillRect(t+.5,i+.5,n-1,o-1),e.strokeRect(t,i,n,o),n=t+n,o=i+o,e.strokeStyle=this._adapter.getCloseButtonIconColor();var r=(this._closeButtonWidth()-8)/2,s=(this._height()-8)/2;CanvasEx.drawPoly(e,[{x:t+r,y:i+s},{x:n-r,y:o-s}],!0),CanvasEx.drawPoly(e,[{x:n-r,y:i+s},{x:t+r,y:o-s}],!0),e.restore()},PositionRenderer.prototype.draw=function(e){if(this._data.points&&!(1>this._data.points.size())){var t=e.canvas.width,i=this._bodyWidth(e),n=this._quantityWidth(e),o=this._reverseButtonWidth(e),r=i+n+o+this._closeButtonWidth(),s=t-r,a=Math.max(this._adapter.getLineLength()/100*t,1),s=Math.round(t-Math.min(s,a)),r=s-r,a=Math.round(this._data.points.item(0).y),l=Math.round(a-(this._height()+1)/2);this._cache.bodyRight=r+i,this._cache.quantityRight=this._cache.bodyRight+n,this._cache.reverseButtonRight=this._cache.quantityRight+o,this._cache.top=l,this._cache.bottom=l+this._height(),this._cache.left=r,this._cache.right=s,this._drawLines(e,r,s,a,t),0!=i&&(this._drawBody(e,r,l),this._drawBodyText(e,r,l)),0!=n&&(this._drawQuantity(e,this._cache.bodyRight,l),this._drawQuantityText(e,this._cache.bodyRight,l)),0!=o&&this._drawReverseButton(e,this._cache.quantityRight,l),0!=this._closeButtonWidth()&&this._drawCloseButton(e,this._cache.reverseButtonRight,l)}},PositionRenderer.prototype.hitTest=function(e){return 0===this._data.points.size()||e.y<this._cache.top||e.y>this._cache.bottom?null:e.x>=this._cache.left&&e.x<this._cache.bodyRight&&0!=this._adapter.getTooltip().length?new HitTestResult(HitTestResult.CUSTOM,{tooltip:{text:this._adapter.getTooltip(),rect:new TradingView.Rect(this._cache.left,this._cache.top,this._cache.bodyRight-this._cache.left,this._cache.bottom-this._cache.top)}}):e.x>=this._cache.bodyRight&&e.x<this._cache.quantityRight?new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:this._adapter.callOnModify.bind(this._adapter),tooltip:{text:"Edit Position",rect:new TradingView.Rect(this._cache.bodyRight,this._cache.top,this._cache.quantityRight-this._cache.bodyRight,this._cache.bottom-this._cache.top)}}):e.x>=this._cache.quantityRight&&e.x<this._cache.reverseButtonRight?new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:this._adapter.callOnReverse.bind(this._adapter),tooltip:{text:"Reverse Position",rect:new TradingView.Rect(this._cache.quantityRight,this._cache.top,this._cache.reverseButtonRight-this._cache.quantityRight,this._cache.bottom-this._cache.top)}}):e.x>=this._cache.reverseButtonRight&&e.x<this._cache.right?new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:this._adapter.callOnClose.bind(this._adapter),tooltip:{text:"Close Position",rect:new TradingView.Rect(this._cache.reverseButtonRight,this._cache.top,this._cache.right-this._cache.reverseButtonRight,this._cache.bottom-this._cache.top)}}):null},inherit(PositionPriceAxisView,W48),PositionPriceAxisView.prototype._updateImpl=function(){W48.prototype._updateImpl.call(this),this._background=this._linetool.properties().lineColor.value()},inherit(PositionPaneView,$90),PositionPaneView.prototype.renderer=function(){return new PositionRenderer({points:this._points},this._rendererCache,this.W99._adapter)},TradingView.LineToolPosition=function(e,t){this._adapter=new PositionLineAdapter(this),this._constructor="LineToolPosition";var i=t||new $52("linetoolposition");TradingView.LineToolTrading.call(this,e,new PositionPaneView(this,e),i)},inherit(TradingView.LineToolPosition,TradingView.LineToolTrading),TradingView.LineToolPosition.prototype.setPoint=function(e,t,i){this._points.setItem(e,t),this.normalizePoints()},TradingView.LineToolPosition.prototype.addPoint=function(e,t){return this._points.append(e),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0},TradingView.LineToolPosition.skipMagnetting=!0,TradingView.LineToolPosition.prototype.title=function(){return"Position"},TradingView.LineToolPosition.prototype.createPriceAxisView=function(e){return this._priceAxisView=new PositionPriceAxisView(this,e)},TradingView.LineToolPosition.prototype.paneViews=function(e){return TradingView.printing||!this.D0.properties().tradingProperties.showPositions.value()?null:W47.prototype.paneViews.call(this,e)},TradingView.LineToolPosition.prototype.priceAxisViews=function(e,t){return TradingView.printing||!this.D0.properties().tradingProperties.showPositions.value()?null:W47.prototype.priceAxisViews.call(this,e,t)},TradingView.LineToolPosition.prototype.hasContextMenu=function(){return!0},TradingView.LineToolPosition.prototype.contextMenuItems=function(){return this._adapter.callOnContextMenu()},ExecutionsPositionController.prototype.getYCoordinate=function(e){var t=0,i=e.getDirection(),n=e._index,o=this._pane.mainDataSource();if(o.bars){var r="buy"==i?10:-10,s=o.bars().search(n,SEARCH_NEAREST_LEFT);s&&(n=s.index,t="buy"==i?s.value[LOW_PLOT]:s.value[HIGH_PLOT],s=o.priceScale(),s.isPercent()&&(o=o.firstValue(),t=s.priceRange().convertToPercent(t,o)),t=s.priceToCoordinate(t)+r)}for(r=this._pane.orderedSources(),o=r.length-1;o>=0;--o)if(s=r[o],s instanceof TradingView.LineToolExecution&&s._adapter.getDirection()==i&&s._adapter._index==n){if(s==e._line)break;t="buy"==i?t+s._adapter._height():t-s._adapter._height()}return t},ExecutionLineAdapter.prototype._height=function(){var e=this.getArrowHeight(),t=this.getArrowSpacing();return this.getText()&&ChartTradingUtils.fontHeight(this.getFont()),e+t+0+10},ExecutionLineAdapter.prototype.getIndex=function(){var e=this._line.D0.timeScale().m_points.lastTimePointIndex(),t=this._line.points().item(0).index;return e-t},ExecutionLineAdapter.prototype.setIndex=function(e){e=this._line.D0.timeScale().m_points.lastTimePointIndex()-Math.abs(e),this._line.startMoving(this._line.points().item(0));var t=TradingView.merge({},this._line.points().item(0));return t.index=e,this._line.move(t),this._line.endMoving(),this},ExecutionLineAdapter.prototype.getTime=function(){return this._unixtime},ExecutionLineAdapter.prototype.setTime=function(e){return this._unixtime=e,this._line.restorePoints([{offset:0,price:this.getPrice(),time_t:e}],[]),this._line.createServerPoints(),this},ExecutionLineAdapter.prototype.getPrice=function(){return 0<this._line.points().size()?this._line.points().item(0).price:0<this._line._timePoint.size()?this._line._timePoint.item(0).price:void 0},ExecutionLineAdapter.prototype.setPrice=function(e){return 0<this._line.points().size()&&(this._line.points().item(0).price=e),0<this._line._timePoint.size()&&(this._line._timePoint.item(0).price=e),this},ExecutionLineAdapter.prototype.getText=function(){return this._line.properties().text.value()},ExecutionLineAdapter.prototype.setText=function(e){return this._line.properties().text.setValue(e||""),this},ExecutionLineAdapter.prototype.getArrowHeight=function(){return this._line.properties().arrowHeight.value()},ExecutionLineAdapter.prototype.setArrowHeight=function(e){return this._line.properties().arrowHeight.setValue(e||5),this},ExecutionLineAdapter.prototype.getArrowSpacing=function(){return this._line.properties().arrowSpacing.value()},ExecutionLineAdapter.prototype.setArrowSpacing=function(e){return this._line.properties().arrowSpacing.setValue(e||1),this},ExecutionLineAdapter.prototype.getDirection=function(){return this._line.properties().direction.value()},ExecutionLineAdapter.prototype.setDirection=function(e){return this._line.properties().direction.setValue(e||"buy"),this},ExecutionLineAdapter.prototype.getArrowColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().arrowColor,this._line.properties().arrowTransparency)},ExecutionLineAdapter.prototype.setArrowColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().arrowColor,this._line.properties().arrowTransparency),this},ExecutionLineAdapter.prototype.getTextColor=function(){return ChartTradingUtils.getColorFromProperties(this._line.properties().textColor,this._line.properties().textTransparency)},ExecutionLineAdapter.prototype.setTextColor=function(e){return ChartTradingUtils.setColorToProperties(e,this._line.properties().textColor,this._line.properties().textTransparency),this},ExecutionLineAdapter.prototype.getFont=function(){return ChartTradingUtils.getFontFromProperties(this._line.properties().fontFamily,this._line.properties().fontSize,this._line.properties().fontBold,this._line.properties().fontItalic)},ExecutionLineAdapter.prototype.setFont=function(e){return ChartTradingUtils.setFontToProperties(e,this._line.properties().fontFamily,this._line.properties().fontSize,this._line.properties().fontBold,this._line.properties().fontItalic),this},ExecutionLineAdapter.prototype.setTooltip=function(e){return e=null==e?"":e+"",this._line.properties().tooltip.setValue(e),this},ExecutionLineAdapter.prototype.getTooltip=function(){return this._line.properties().tooltip.value()},ExecutionLineAdapter.prototype.remove=function(){this._line.D0.removeSource(this._line),delete this._line},ExecutionRenderer.prototype._textWidth=function(e){if(0==this._adapter.getText().length)return 0;e.save(),e.font=this._adapter.getFont();var t=e.measureText(this._adapter.getText()).width;return e.restore(),5+t},ExecutionRenderer.prototype._drawArrow=function(e,t,i){e.save(),e.strokeStyle=this._adapter.getArrowColor(),e.fillStyle=this._adapter.getArrowColor();var n=this._adapter.getArrowHeight(),o=this._adapter.getDirection();e.transform(1,0,0,1,t,i),"buy"!=o&&e.rotate(Math.PI),CanvasEx.drawLine(e,0,0,0,n),CanvasEx.drawLine(e,-1,1,1,1),CanvasEx.drawLine(e,-2,2,2,2),e.restore()},ExecutionRenderer.prototype._drawText=function(e,t,i){var n=this._adapter.getText();n&&(e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getFont(),e.fillStyle=this._adapter.getTextColor(),t+=this._textWidth(e)/2,i+=ChartTradingUtils.fontHeight(this._adapter.getFont())/2,e.fillText(n,t,i-1),e.restore())},ExecutionRenderer.prototype.draw=function(e){if(this._data.points&&!(this._data.points.size()<TradingView.LineToolExecution.POINTS_COUNT)){var t=Math.round(this._data.points.item(0).x+.5),i=Math.round(this._data.points.item(0).y);this._drawArrow(e,t,i);var n=this._textWidth(e);if(0!=n){var o=this._adapter.getArrowHeight(),r=this._adapter.getArrowSpacing(),s=ChartTradingUtils.fontHeight(this._adapter.getFont()),i="buy"==this._adapter.getDirection()?i+o+r:i-o-r-s;this._drawText(e,Math.round(t-n/2),i)}}},ExecutionRenderer.prototype.hitTest=function(e){if(this._data.points&&!(this._data.points.size()<TradingView.LineToolExecution.POINTS_COUNT)){var t,i=Math.round(this._data.points.item(0).x),n=Math.round(this._data.points.item(0).y),o=this._adapter.getArrowHeight();if("buy"==this._adapter.getDirection()?(t=n,n+=o):t=n-o,e.x>=i-2&&e.x<=i+2&&e.y>=t&&e.y<=n)return e=this._adapter.getTooltip(),new HitTestResult(HitTestResult.CUSTOM,{mouseDownHandler:function(){TradingView.TradingWidget.journalDialog()},tooltip:""!=e?{text:e,rect:new TradingView.Rect(i,t,2,n-t)}:null})}},inherit(ExecutionPaneView,$90),ExecutionPaneView.prototype._renderer=null,ExecutionPaneView.prototype._rendererCached=!1,ExecutionPaneView.prototype.update=function(){$90.prototype.update.call(this),this._renderer=null,this._rendererCached=!1},ExecutionPaneView.prototype.renderer=function(){if(this._rendererCached)return this._renderer;this._rendererCached=!0;var e=this.W99,t=e._adapter,i=e.D0.timeScale();if(0==e.points().size())return null;var n=e.points().item(0).index;return(e=e.D0.mainSeries().bars().search(n,SEARCH_NEAREST_LEFT))&&(n=e.index),t._index=n,isFinite(n)?(e=i.visibleBars(),!e||n>e.lastBar()||n<e.firstBar()?this._renderer=null:(e=this.W99.D0.paneForSource(this.W99).executionsPositionController(),i=i.indexToCoordinate(n),n=e.getYCoordinate(t),isFinite(n)?(e=new List,e.append({x:i,y:n}),this._renderer=new ExecutionRenderer({points:e},t)):this._renderer=null)):this._renderer=null},TradingView.LineToolExecution=function(e,t){this._adapter=new ExecutionLineAdapter(this),this._constructor="LineToolExecution";var i=t||new $52("linetoolexecution");this.customization={forcePriceAxisLabel:!1,disableSelection:!0,disableErasing:!0},W47.call(this,e,new ExecutionPaneView(this,e),i)},inherit(TradingView.LineToolExecution,W47),TradingView.LineToolExecution.POINTS_COUNT=1,TradingView.LineToolExecution.skipMagnetting=!0,TradingView.LineToolExecution.prototype.pointsCount=function(){return TradingView.LineToolExecution.POINTS_COUNT},TradingView.LineToolExecution.prototype.title=function(){return"Execution"},TradingView.LineToolExecution.prototype.hasContextMenu=function(){return!1},TradingView.LineToolExecution.prototype.state=function(){return null},TradingView.LineToolExecution.prototype.paneViews=function(e){return TradingView.printing||!this.D0.properties().tradingProperties.showExecutions.value()?null:W47.prototype.paneViews.call(this,e)},TradingView.LineToolExecution.prototype.userEditEnabled=function(){return!1},TradingView.LineToolExecution.prototype.showInObjectTree=function(){return!1},A24=function(e,t,i){var n=this._mtpStudyId()+"@mtp-mtpredictor";i=i||StudyMetaInfo.findStudyMetaInfo(e.studiesMetaData(),n),t=t||TradingView.prepareStudyProperties(i,null,null,e.studyVersioning()),n=TradingView.Study.lineToolNameForPointsBasedStudy(n),A63.call(this,e,this.createPaneViews(e),t,n),this._doNotNeedLine=!0,this._turnaroundCounter=0,this._nextTurnaround(),this._metaInfo=i,this._graphics=new A62(i),this._formatter=new VolumeFormatter},inherit(A24,A63),A24.prototype.series=function(){return isInherited(this._ownerSource.constructor,TradingView.Series)?this._ownerSource:this._ownerSource.series()},A24.prototype.calcIsActualSymbol=function(){return W47.prototype.calcIsActualSymbol.call(this)},A24.prototype._nextTurnaround=function(){this._turnaround=this._mtpStudyId()+"_"+ ++this._turnaroundCounter},A24.prototype.createPaneViews=function(e){return[new W31(this,e),new TradingView.Study.StudyPaneView_textmarks(this,e),new TradingView.Study.StudyPaneView_polygons(this,e),new TradingView.Study.StudyPaneView_lines(this,e)]},A24.prototype.onData=function(e){"data_update"===e.method&&e.params.customId==="pointset_"+this._currentPointsetId?(W47.prototype.onData.call(this,e),this._points.size()==this.pointsCount()&&this._requestStudy()):"data_update"===e.method&&e.params.customId===this._studyId&&this._checkTurnaround(e.params.turnaround)&&(e.params.nonseries.d=""!==e.params.nonseries.d?JSON.parse(e.params.nonseries.d):"",""!==e.params.nonseries.d&&this._graphics.process(e.params.nonseries),0<e.params.nonseries.indexes.length&&(this._indexes=e.params.nonseries.indexes),this.updateAllViews(),this.D0.updateSource(this))},A24.prototype._requestStudy=function(){var e=this,t=function(t){e.onData(t)},i=this._studyInputs();i&&(this._studyId?(this._nextTurnaround(),this.D0.chartApi().modifyStudy(this._studyId,this._turnaround,i,t)):(this._studyId=TradingView.Study.makeNextStudyId(),this.D0.chartApi().createStudy(this._studyId,this._turnaround,this.D0.mainSeries()._seriesId,this._metaInfo.id+"-1!",i,t)))},A37=function(e,t,i){A24.call(this,e,t,i)},inherit(A37,A24),A37.prototype._mtpStudyId=function(){return"mtp_riskreward"},A37.prototype.pointsCount=function(){return 3},A37.getTooltipText=function(e){return e&&0!=e._points.size()?1==e._points.size()?"Select Stop Bar":2==e._points.size()?"Select Target Point":null:"Select Entry Setup Bar"},A37.prototype._studyInputs=function(){var e=this.points().item(0).index,t=this.points().item(1).index,i=this.points().item(2).index,e=this.D0.mainSeries().bars().valueAt(e),t=this.D0.mainSeries().bars().valueAt(t),i=this.D0.mainSeries().bars().valueAt(i);return e&&t&&i?[1e3*e[TIME_PLOT],1e3*t[TIME_PLOT],1e3*i[TIME_PLOT],this.points().item(2).price,this.properties().inputs.account_size.value(),this.properties().inputs.percent_risk.value(),this.properties().inputs.tickEntryOffset.value(),this.properties().inputs.tickStopOffset.value()]:null},A26=function(e,t,i){A24.call(this,e,t,i),this._symbolIntervalChanged=!1,this.D0.mainSeries().onSymbolIntervalChanged().subscribe(this,this.onSymbolIntervalChanged)},inherit(A26,A24),A26.prototype._mtpStudyId=function(){return"mtp_decisionpoint"},A26.prototype.onSymbolIntervalChanged=function(){this._symbolIntervalChanged=!0},A26.prototype.pointsCount=function(){return 1},A26.prototype._studyInputs=function(){var e=this.points().item(0).index;return(e=this.D0.mainSeries().bars().valueAt(e))?[this.properties().inputs.displayZoneLabels.value(),this._symbolIntervalChanged,1e3*e[TIME_PLOT]]:null},A26.prototype.onData=function(e){A24.prototype.onData.call(this,e),this._symbolIntervalChanged=!1},A33=function(e,t,i){A24.call(this,e,t,i)},inherit(A33,A24),A33.prototype.pointsCount=function(){return 1},A33.prototype._studyInputs=function(){var e=this.points().item(0).index;return(e=this.D0.mainSeries().bars().valueAt(e))?[this.properties().inputs.displayZoneLabels.value(),1e3*e[TIME_PLOT]]:null},A34=function(e,t,i){A33.call(this,e,t,i)},inherit(A34,A33),A34.prototype._mtpStudyId=function(){return"mtp_ew_main"},A35=function(e,t,i){A33.call(this,e,t,i)},inherit(A35,A33),A35.prototype._mtpStudyId=function(){return"mtp_ew_major"},A36=function(e,t,i){A33.call(this,e,t,i)},inherit(A36,A33),A36.prototype._mtpStudyId=function(){return"mtp_ew_minor"},A25=function(e,t,i){A24.call(this,e,t,i)},inherit(A25,A24),A25.prototype._mtpStudyId=function(){return"mtp_tsanalysis"},A25.prototype.pointsCount=function(){return 1},A25.prototype._studyInputs=function(){var e=this.points().item(0).index;return(e=this.D0.mainSeries().bars().valueAt(e))?[this.properties().inputs.displayZoneLabels.value(),1e3*e[TIME_PLOT],this.properties().inputs.account_size.value(),this.properties().inputs.percent_risk.value(),this.properties().inputs.tickEntryOffset.value(),this.properties().inputs.tickStopOffset.value(),this.properties().inputs.minRRRatio.value(),this.properties().inputs.shouldFilterWPTZones.value(),this.properties().inputs.shouldFilterSTFTrends.value()]:null},A44=function(e,t,i,n,o){this._wptStudyId=n,this._pointsCount=o,A24.call(this,e,t,i)},inherit(A44,A24),A44.prototype._studyInputs=function(){for(var e=[this.properties().inputs.displayZoneLabels.value()],t=0;t<this.pointsCount();++t){var i=this.points().item(t).index,i=this.D0.mainSeries().bars().valueAt(i);if(!i)return null;e.push(1e3*i[TIME_PLOT])}return e},A44.prototype._mtpStudyId=function(){return this._wptStudyId},A44.prototype.pointsCount=function(){return this._pointsCount},A27=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_down1ora",2)},inherit(A27,A44),A27.getTooltipText=function(e){return"Down Wave 1 or A: Select Point "+((e?e._points.size():0)+1)},A28=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_down2orb",2)},inherit(A28,A44),A28.getTooltipText=function(e){return"Down Wave 2 or B: Select Point "+((e?e._points.size():0)+1)},A29=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_down3",3)},inherit(A29,A44),A29.getTooltipText=function(e){return"Down Wave 3: Select Point "+((e?e._points.size():0)+1)},A30=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_down4",2)},inherit(A30,A44),A30.getTooltipText=function(e){return"Down Wave 4: Select Point "+((e?e._points.size():0)+1)},A31=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_down5",5)},inherit(A31,A44),A31.getTooltipText=function(e){return"Down Wave 5: Select Point "+((e?e._points.size():0)+1)},A32=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_downc",3)},inherit(A32,A44),A32.getTooltipText=function(e){return"Down Wave C: Select Point "+((e?e._points.size():0)+1)},A38=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_up1ora",2)},inherit(A38,A44),A38.getTooltipText=function(e){return"Up Wave 1 or A: Select Point "+((e?e._points.size():0)+1)},A39=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_up2orb",2)},inherit(A39,A44),A39.getTooltipText=function(e){return"Up Wave 2 or B: Select Point "+((e?e._points.size():0)+1)},A40=function(e,t,i){
A44.call(this,e,t,i,"mtp_wpt_up3",3)},inherit(A40,A44),A40.getTooltipText=function(e){return"Up Wave 3: Select Point "+((e?e._points.size():0)+1)},A41=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_up4",2)},inherit(A41,A44),A41.getTooltipText=function(e){return"Up Wave 4: Select Point "+((e?e._points.size():0)+1)},A42=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_up5",5)},inherit(A42,A44),A42.getTooltipText=function(e){return"Up Wave 5: Select Point "+((e?e._points.size():0)+1)},A43=function(e,t,i){A44.call(this,e,t,i,"mtp_wpt_upc",3)},inherit(A43,A44),A43.getTooltipText=function(e){return"Up Wave C: Select Point "+((e?e._points.size():0)+1)},MarkRenderer.prototype.draw=function(e){if(0!==this._data.points.size()){var t=this._data.points.item(0).x+this._data.offsetX,i=this._data.points.item(0).y+this._data.offsetY;e.translate(-.5,-.5),e.drawImage(this._data.image,t,i,this._data.width,this._data.height)}},MarkRenderer.prototype.hitTest=function(e){if(0===this._data.points.size())return null;var t=this._data.points.item(0).clone();return this._data.offsetX&&(t.x+=this._data.offsetX),this._data.offsetY&&(t.y+=this._data.offsetY),MathEx.pointInRect(e,t,t.add(new MathEx.Point(this._data.width,this._data.height)))?new HitTestResult(HitTestResult.MOVEPOINT):null},inherit($97,$90),$97.prototype.setAnchors=function(e){this._anchorsOffset=e},$97.prototype.renderer=function(){var e={};if(e.points=this._points,e.color=this.W99.properties().color.value(),e.image=this._image,e.offsetX=this._offsetX,e.offsetY=this._offsetY,e.width=this._width,e.height=this._height,this.isAnchorsRequired()&&1==e.points.size()){var t=new CompositeRenderer;if(t.append(new MarkRenderer(e)),this._anchorsOffset){for(var i=new List,n=0;n<e.points.size();n++)i.append(e.points.item(n).clone().add(this._anchorsOffset));t.append(new SelectionRenderer({points:i}))}else t.append(new SelectionRenderer({points:e.points}));return t}return new MarkRenderer(e)},$97.prototype.update=function(){$90.prototype.update.call(this)},W79.version=2,W79.prototype.state=function(e){for(var t={panes:[]},i=0;i<this.panes().size();i++)t.panes.push(this.panes().item(i).state(!0,e));return t.timeScale=this.m_timeScale.state(e),i=this.publishedChartsTimelineSource(),t.chartProperties={paneProperties:this.properties().paneProperties.state(),scalesProperties:this.properties().scalesProperties.state(),publishedChartsTimelineProperties:i?i.state(e):void 0},t.version=W79.version,t.timezone=this.timezone(),t},W79.prototype.asyncState=function(e){return this.publishedChartsTimelineSource().asyncState(e).pipe(function(e){var t={};return t.chartProperties={publishedChartsTimelineProperties:e},t})},W79.prototype.restoreState=function(e,t){var i={};if(e.panes)if(isArray(e.panes))if(1>e.panes.length)TradingView.logDebug("W79.restoreState: invalid state");else{if(e.chartProperties&&!e.chartProperties.timezone&&(e.chartProperties.timezone=e.timezone),e.chartProperties){var n=e.chartProperties.scalesProperties;!("showLastValue"in n)||"showSeriesLastValue"in n||"showStudyLastValue"in n||(n.showSeriesLastValueProperty=n.showLastValue,n.showStudyLastValueProperty=n.showLastValue),"showSeriesLastValue"in n&&(i.showSeriesLastValueProperty=!0),"showStudyLastValue"in n&&(i.showStudyLastValueProperty=!0),this.D2.paneProperties.merge(e.chartProperties.paneProperties),this.D2.scalesProperties.merge(e.chartProperties.scalesProperties),e.chartProperties.timezone&&this.D2.timezone.setValue(e.chartProperties.timezone),e.chartProperties.publishedChartsTimelineProperties&&this.publishedChartsTimelineSource().restoreData(e.chartProperties.publishedChartsTimelineProperties,t),this.m_timeScale.restoreState(e.timeScale,t)}for(e.timeScale&&this.m_timeScale.restoreState(e.timeScale,t),n=e.panes,this.panes().item(0).restoreState(n[0],t,e.version,i),n=1;n<e.panes.length;n++)(this.panes().item(n)||this.createPane()).restoreState(e.panes[n],t,e.version,i);for(this._invalidateBarColorerCaches(),i=this.D19(),n=0;n<i.size();n++){var o=i.item(n);isInherited(o.constructor,W47)&&o.calcIsActualSymbol()}this._version=e.version,this.timeScale().recalcLockedScale(),this.recalculateAllPanes(),this.D20(new A22(A22.FULL_UPDATE)),window.saver&&is_authenticated&&this.isJustClonedChart()&&this.mainSeries().onSymbolResolved().subscribe(this,function(){saver.saveChartSilently()},!0)}else TradingView.logDebug("W79.restoreState: invalid state");else TradingView.logDebug("W79.restoreState: invalid state")},W79.prototype.restoreAxisState=function(e){if(e.panes)if(isArray(e.panes))if(1>e.panes.length)TradingView.logDebug("W79.restoreAxisState: invalid state");else{this.m_timeScale.restoreState(e.timeScale,!1,!0);for(var t=0;t<e.panes.length;t++){var i=this.panes().item(t);i.m_leftPriceScale.restoreState(e.panes[t].leftAxisState),i.m_rightPriceScale.restoreState(e.panes[t].rightAxisState)}this.recalculateAllPanes(),this.D20(new A22(A22.FULL_UPDATE))}else TradingView.logDebug("W79.restoreAxisState: invalid state");else TradingView.logDebug("W79.restoreAxisState: invalid state")},W75.prototype.state=function(e,t,i){function n(e){return i&&!e.isSavedInStudyTemplates()||e instanceof TradingView.AlertLabel||!e.state||!e.state()||!e.isSavedInChart(t)}var o={};if(e)for(o.sources=[],e=0;e<this.m_dataSources.size();e++)n(this.m_dataSources.item(e))||o.sources.push(this.m_dataSources.item(e).state(t));for(o.leftAxisState=this.m_leftPriceScale.state(),o.leftAxisSources=[],e=0;e<this.m_leftPriceScale.D19().size();e++)n(this.m_leftPriceScale.D19().item(e))||o.leftAxisSources.push(this.m_leftPriceScale.D19().item(e).id());for(o.rightAxisState=this.m_rightPriceScale.state(),o.rightAxisSources=[],e=0;e<this.m_rightPriceScale.D19().size();e++)n(this.m_rightPriceScale.D19().item(e))||o.rightAxisSources.push(this.m_rightPriceScale.D19().item(e).id());for(o.overlayPriceScales={},e=0;e<this.m_dataSources.size();e++){var r=this.m_dataSources.item(e);this.isOverlay(r)&&r.isSavedInChart(t)&&(o.overlayPriceScales[r.id()]=r.priceScale().state())}return o.stretchFactor=this._stretchFactor,this.m_mainDataSource&&(o.mainSourceId=this.m_mainDataSource.id()),o},W75.prototype.sourceById=function(e){for(var t=0;t<this.m_dataSources.size();t++)if(this.m_dataSources.item(t).id()===e)return this.m_dataSources.item(t);return null},W75.prototype.isESDStudy=function(e){return"Script$TV_EARNINGS@tv-scripting"==e.id||"Script$TV_DIVIDENDS@tv-scripting"==e.id||"Script$TV_SPLITS@tv-scripting"==e.id},W75.prototype.restoreState=function(e,t,i,n){if(n=n||{},!e.leftAxisState||!e.rightAxisState)throw Error("invalid state");if(!e.leftAxisSources||!e.rightAxisSources)throw Error("invalid state");e.stretchFactor&&(this._stretchFactor=e.stretchFactor);var o={};if(e.sources){var r=this.m_dataSources.contains(this.D0.mainSeries());this.clearSeries(),r&&this.m_dataSources.append(this.D0.mainSeries());for(var s=0;s<e.sources.length;s++){var a=e.sources[s],l=a.id;o[l]=a.ownerSource;var d=a.type;"MainSeries"===d?this._restoreMainSeries(a,t,r,n):d.toLowerCase().startsWith("study")?this._restoreStudy(a,t,n):this._restoreLineTool(a,t)}}for(this.m_leftPriceScale.D19().clear(),this.m_leftPriceScale._hasSeries=!1,r=defaults("chartproperties").paneProperties.leftAxisProperties,TradingView.merge(r,e.leftAxisState),this.m_leftPriceScale.restoreState(r),s=0;s<e.leftAxisSources.length;s++)(n=this.dataSourceForId(e.leftAxisSources[s]))&&(this.m_leftPriceScale.addDataSource(n),n.setPriceScale(this.m_leftPriceScale));for(this.m_rightPriceScale.D19().clear(),this.m_rightPriceScale._hasSeries=!1,r=defaults("chartproperties").paneProperties.rightAxisProperties,TradingView.merge(r,e.rightAxisState),this.m_rightPriceScale.restoreState(r),s=0;s<e.rightAxisSources.length;s++)(n=this.dataSourceForId(e.rightAxisSources[s]))&&(this.m_rightPriceScale.addDataSource(n),n.setPriceScale(this.m_rightPriceScale));for(t&&this.D2.legendProperties.merge(defaults("chartproperties.paneProperties.legendProperties")),s=0;s<this.m_dataSources.size();s++)n=this.m_dataSources.item(s),this.m_rightPriceScale.D19().contains(n)||this.m_leftPriceScale.D19().contains(n)?n._isOverlay=!1:(n._isOverlay=!0,t=new W76(this.D2.overlayPropreties),t.setHeight(this.m_height),t.setTopMargin(this.m_rightPriceScale.topMargin()),t.setBottomMargin(this.m_rightPriceScale.bottomMargin()),t.addDataSource(n),e.overlayPriceScales&&e.overlayPriceScales[n.id()]&&(r=e.overlayPriceScales[n.id()],r.m_isAutoScale=!0,r.m_isLog=!1,r.m_isPercentage=!1,t.restoreState(r)),n.setPriceScale(t));for(l in o)(s=o[l])&&(n=this.sourceById(l))&&this.sourceById(l).setOwnerSource(this.sourceById(s));if(e.mainSourceId&&(this.m_mainDataSource=this.dataSourceForId(e.mainSourceId)),!this.m_mainDataSource)for(s=0;s<this.m_dataSources.size();s++)if(n=this.m_dataSources.item(s),isInherited(n.constructor,PriceDataSource)){this.m_mainDataSource=n;break}for(s=0;s<this.m_dataSources.size();s++)n=this.m_dataSources.item(s),isInherited(n.constructor,W47)?(n.ownerSource()||n.setOwnerSource(this.mainDataSource()),n.isFixed()&&n.restoreFixedPoints(),1==i&&n.priceScale().isPercent()&&!n.isFixed()&&n.correctPricesToPercents(),n.fixAfterRestorePriceAxis&&n.fixAfterRestorePriceAxis()):isInherited(n.constructor,TradingView.Study)&&(e=n.properties(),e.linkedToSeries&&e.linkedToSeries.value()&&(n.ownerSource()||n.setOwnerSource(this.model().mainSeries())));this._updateMargins(),this._cachedHitTestSources=this._cachedOrderedSoruces=null},W75.prototype._restoreMainSeries=function(e,t,i,n){var o=e.id,r=e.state,s=e.zorder;i||(this.D0.paneForSource(this.D0.mainSeries()).removeDataSource(this.D0.mainSeries()),this.m_dataSources.append(this.D0.mainSeries())),i=r&&r.style?r.style:void 0;var a=i==TradingView.Series.STYLE_PNF&&r.pnfStyle.lockScale;r&&!r.lockScale&&(r.lockScale=a),i==TradingView.Series.STYLE_PNF&&"ATR"==this.D0.mainSeries().properties().pnfStyle.inputs.style.value()?this.D0.mainSeries().properties().pnfStyle.inputs.style._value="Traditional":i==TradingView.Series.STYLE_RENKO&&"ATR"==this.D0.mainSeries().properties().renkoStyle.inputs.style.value()&&(this.D0.mainSeries().properties().renkoStyle.inputs.style._value="Traditional"),r&&!r.hasOwnProperty("showSessions")&&(r.showSessions=!1),r&&!r.extendedHours&&(r.extendedHours=!1),r&&t&&(r.showCountdown=!1),r&&(t&&!("showSeriesLastValueProperty"in n)&&"showLastValue"in r&&this.D0.properties().scalesProperties.showSeriesLastValue.setValue(r.showLastValue),delete r.showLastValue),this.D0.mainSeries().properties().merge(r),this.D0.mainSeries()._prevChartStyle=this.D0.mainSeries().properties().style.value(),this.D0.mainSeries().$63(),this.D0.mainSeries().setId(o),t&&this.D0.mainSeries().restoreData(e.bars,e.nsBars,e.symbolInfo,e.rtPrice,e.boxSize),void 0!==s&&this.D0.mainSeries().setZorder(s),this.D0.mainSeries().properties().extendedHours.listeners().fire(this.D0.mainSeries().properties().extendedHours),this.D0.mainSeries().symbolInfo()&&this.D0.mainSeries().onSymbolResolved().fire(this.D0.mainSeries().symbolInfo())},W75.prototype._restoreStudy=function(e,t,i){var n=e.id,o=e.state,r=e.zorder,s=TradingView.clone(e.metaInfo);if($.extend(s,StudyMetaInfo.parseIdString(s.id)),!this.isESDStudy(s)||t){var a=o,l=this.D0.studyVersioning();i=l.patchPropsStateAndMetaInfo(a,s,{oldShowStudyLastValueProperty:t&&!i.showStudyLastValueProperty});var a=i.propsState,s=i.metaInfo,d=new TradingView.StudyStub(this.D0,e,s.shortDescription);d.setId(n),l.updateMetaInfoAsync(s,t).done(function(i){d.setStatus("");var o=i||s;if(o.isTVScript&&!t){var r=StudyMetaInfo.parseIdString(o.fullId||o.id).productId;pro.hasPackage(r)||(o=A57.createScriptStubNoSrc("Error: '"+o.shortDescription+"' is not authorized",o.scriptIdPart),$.extend(o,StudyMetaInfo.parseIdString(o.id)),i=s=o,a={})}i=TradingView.prepareStudyPropertiesForLoadChart(s,i,a,null,l),o=TradingView.createStudy(this.D0,i,this.D0.mainSeries(),o),o.setId(n),t&&(i=l.patchStudyData(s,e.data,e.nonSeriesData,e.indexes),o.restoreData(i.data,i.nsData,i.indexes)),this.D0.replaceStudyStub(d,o)||(d=o)}.bind(this)).fail(function(e){console.error(e),d.setStatus("error: "+e)}),this.m_dataSources.append(d),void 0!==r&&d.setZorder(r)}},W75.prototype._restoreLineTool=function(e,t){var i=e.type,n=e.id,o=e.state,r=e.zorder,s=TradingView[i];assert(isInherited(s,W47),"invalid data source type:"+i+" (expected to be a Line Tool)");for(var a=e.points,l=!1,d=0;d<a.length;d++)if(1e4<Math.abs(a[d].offset)){l=!0;break}l||(a=null,l=factoryDefaults("linetool"),isInherited(s,A63)?(a=this.D0.studyVersioning(),e=a.patchPointsBasedStudyState(e),o=e.state,TradingView.merge(l,o),o=e.metaInfo,$.extend(o,StudyMetaInfo.parseIdString(o.fullId)),metaInfo=a.updateMetaInfo(o)||o,l=TradingView.prepareStudyPropsStateForLoadChart(metaInfo,o,l,null,a),t?TradingView.merge(l,{fixedSize:!1}):TradingView.merge(l,{fixedSize:!0}),o=new $52("study_"+metaInfo.id,l,!0),i=new TradingView[i](this.D0,o,metaInfo)):(s=i.toLowerCase(),TradingView.merge(l,factoryDefaults(s)),TradingView.merge(l,o),t?TradingView.merge(l,{fixedSize:!1}):TradingView.merge(l,{fixedSize:!0}),o=new $52(i.toLowerCase(),l),i=new TradingView[i](this.D0,o)),i.setId(n),n=this.D0.isJustClonedChart(),s=e.alertId,l=TradingView.D18("alerts")&&TradingView.D18("drawing_alerts"),!n&&l&&s&&i.setAlert&&i.setAlert(s,null,null,!0),n=e.indexes?e.indexes:[],n=n.slice(0,e.points.length),i.isFixed()?i.restorePositionPercents(e.positionPercents):i.restorePoints(e.points,n,t),i instanceof TradingView.LineToolBarsPattern||i instanceof TradingView.LineToolCallout||i instanceof TradingView.LineToolTrendAngle||i instanceof TradingView.LineToolParallelChannel?i.restoreData(e):t&&i.restoreData&&(n=e,a&&(n.graphics=a.patchPointsBasedStudyData(n.metaInfo,n.graphics)),i.restoreData(n)),a=null==e.version?1:e.version,n=null==i.version?1:i.version,a!=n&&"function"==typeof i.migrateVersion&&i.migrateVersion(a,n,{pane:this,model:this.D0,properties:o}),this.m_dataSources.append(i),void 0!==r&&i.setZorder(r))},W79.prototype.studyTemplate=function(e){for(var t={panes:[]},i=0;i<this.panes().size();i++)t.panes.push(this.panes().item(i).state(!0,!1,!0));return e&&(t.interval=this.mainSeries().interval()),t.version=W79.version,t},W79.prototype.restoreStudyTemplate=function(e,t){this._undoModel.studyLoadTemplate(this._undoModel,this.studyTemplate(),e,t)},W79.prototype.theme=function(){var e={};return e.chartProperties={paneProperties:this.properties().paneProperties.state(),scalesProperties:this.properties().scalesProperties.state(),symbolWatermarkProperties:this.properties().symbolWatermarkProperties.state()},e.mainSourceProperties=this.mainSeries().state().state,delete e.mainSourceProperties.symbol,delete e.mainSourceProperties.interval,delete e.chartProperties.paneProperties.topMargin,delete e.chartProperties.paneProperties.bottomMargin,e.version=W79.version,e},W79.prototype.restoreTheme=function(e){var t,i={hollowCandle:{related:"candle"}};for(t in i)if(!e.mainSourceProperties[t+"Style"]){var n,o=e.mainSourceProperties[t+"Style"]=factoryDefaults("chartproperties.mainSeriesProperties."+t+"Style"),r=e.mainSourceProperties[i[t].related+"Style"];for(n in r)n in o&&(o[n]=r[n])}this._undoModel.chartLoadTheme(this,e)},TradingView.requestChartSnapshotBars=function(e,t){function i(i){e._currentRequest.requestFirstBarTime(i,r,function(o){o.p[1]>s?(e._currentRequest.disconnect(),delete e._currentRequest,e._haveNoMoreData=!0,t()):n(i)})}function n(i){var n=1;e._haveNoMoreData=!0;var l=!1;e._currentRequest.createSeries("series_id","turnaround",i,r,["bar_count",s-1,-d],function(i){switch(i.method){case"data_update":if(!i.params.plots.length)break;var r=i.params.plots[0].value[TIME_PLOT],c=i.params.plots;e._haveNoMoreData=c.length<d,l=0==c.length,h=r==s,o.mainSeries().fixLastBar(),o.mainSeries().bars().addTail(c,h),i=o.mainSeries().parseJapProjBars(i.params.nonseries),o.mainSeries().m_data.m_nsBars=i.nsBars,o.mainSeries().m_data.lastProjectionPrice=i.lastPrice,o.model().recalculateAllPanes(),o.model().updateSource(o.mainSeries()),o.model().updateLineTools(),o.timeScale().scrollToOffsetAnimated(a);break;case"series_completed":n--,0===n&&(e._currentRequest.disconnect(),delete e._currentRequest,t())}}),i=o.D19();for(var c={},p=0;p<i.size();p++){var u=i.item(p);if(isInherited(u.constructor,TradingView.Study)&&-1!==["Volume","Compare","Overlay","Sessions"].indexOf(u.metaInfo().shortId)){var f="study_"+p,g=u.metaInfo().id+"-1!";c[f]=u,n++,e._currentRequest.createStudy(f,"turnaround","series_id",g,u.inputs(),function(i){var r=i.method;"study_completed"===r||"study_error"===r?(n--,0===n&&(e._currentRequest.disconnect(),delete e._currentRequest,t())):"data_update"!==r||l||(c[i.params.customId].m_data.addTail(i.params.plots,h),o.model().recalculateAllPanes(),o.model().updateSource(o.mainSeries()))})}}}var o=e.model(),r=o.mainSeries().interval(),s=o.mainSeries().bars().last().value[TIME_PLOT];if("function"!=typeof t&&(t=new Function),null!=e._currentRequest)TradingView.logDebug("requestSnapshotBars: unexpected requestSnapshotBars");else{var a=o.timeScale().rightOffset();if(!(0>a||e._haveNoMoreData)){var l=o.mainSeries().getSymbolString(),d=Math.max(Math.ceil(a),100),h=!1,c=new TVChartApi;!window.user||"pro_realtime"!==user.pro_plan&&"pro_realtime_trial"!==user.pro_plan||c.authTokenRequired(!0),e._currentRequest=new ChartSession(c),e._currentRequest.connect(function(t){if("connected"===t.method){t=o.model().timezone(),t||(t=defaults("chartproperties").mainSeriesProperties.timezone),e._currentRequest.switchTimezone(t);var n="symbol_id",r=function(t){switch(t.method){case"symbol_error":if(t.params[1]==TradingView.Series.PERMISSION_DENIED){switch(t.params[2]){case TradingView.Series.PD_REASON_EXTENDED_HOURS:o.mainSeries().properties().extendedHours.setValue(!1),t=o.mainSeries().getSymbolString();break;case TradingView.Series.PD_REASON_SYMBOL:t=t.params[3];break;default:t=t.params[2]}t&&(n+="_re",e._currentRequest.resolveSymbol(n,t,r))}break;default:i(n)}};e._currentRequest.resolveSymbol(n,l,r)}else if("timescale_update"===t.method){var s=o.mainSeries().bars().last(),a=o.timeScale().indexToUserTime(s).valueOf()/1e3,s=o.timeScale().points(),d=s.lastTimePointIndex(),d=s.valueAt(d);if(0<t.params.changes.length){var h=t.params.changes[0]==d;h||(a+=1),o.timeScale().addTail(t,a,h),t=s.lastTimePointIndex(),t=s.valueAt(t),fixLineToolsPositions(o.model(),d,t)}}})}}},FutureBarsRenderer.prototype.hitTest=function(){return null},FutureBarsRenderer.prototype.draw=function(e){e.fillStyle="rgba(195,255,160, 0.3)",e.fillRect(Math.max(0,this._data.x),0,this._data.width,this._data.height),e.strokeStyle="#308020",e.beginPath(),e.lineWidth=1;var t=Math.round(this._data.x);e.moveTo(t,0),e.lineTo(t,this._data.height),e.stroke()},TradingView.$79=function(e,t){this._series=e,this._lastBar=t},TradingView.$79.prototype.update=function(){this._x=this._series.m_model.timeScale().indexToCoordinate(this._lastBar)-.5*this._series.m_model.timeScale().barSpacing()+1},TradingView.$79.prototype.renderer=function(){var e={x:this._x,height:this._series.priceScale().height(),width:this._series.m_model.timeScale().width()};return new FutureBarsRenderer(e)},TextWidthCache.prototype.measureText=function(e,t){if(this._cache[t])return this._cache[t].width;if(this._actualSize==this._maxSize){var i=this._tick2Labels[this._oldestTick];delete this._tick2Labels[this._oldestTick],delete this._cache[i],this._oldestTick++,this._actualSize--}return i=e.measureText(t).width,this._cache[t]={width:i,tick:this._usageTick},this._tick2Labels[this._usageTick]=t,this._actualSize++,this._usageTick++,i},inherit(W96,W47),W96.prototype._constructor="Child class must override this member",W96.prototype._initialize=function(e){throw"Child class must override this member"},W96.prototype.onClicked=function(){throw"Child class must override this member"},W96.prototype._getData=function(e){throw"Child class must override this member"},W96.prototype._createTooltip=function(){throw"Child class must override this member"},W96.prototype.updateDotData=function(e,t){return t},W96.prototype.updatePlateData=function(e,t){},W96.prototype._plateViewData=function(e){return{}},W96.prototype.pinTooltip=function(e,t){this.pinnedTooltips[e]=t},W96.prototype.timeScale=function(){return this.D0.timeScale()},W96.prototype.getIntervalInTicks=function(){function e(e){if(e=parseInt(e),e!=e)throw new TypeError("Unexpected interval");return 60*e}var t=e(1440),i=7*t,n=31*t,o=this.D0.mainSeries().properties().interval.value();switch(o){case"M":return n;case"W":return i;case"D":return t;default:return e(o)}},W96.prototype._maxDate=new Date(2037,0,1),W96.prototype.getVisibleTickmarksRange=function(){if(this.timeScale().isEmpty())return{start:0,end:0};var e=this.timeScale().visibleBars();return e.lastBar()>this.timeScale().points().firstTimePointIndex()&&e.firstBar()<this.timeScale().points().lastTimePointIndex()?(end=e.lastBar()<this.timeScale().points().lastTimePointIndex()?this.timeScale().indexToTimePoint(e.lastBar()):this._maxDate,e={start:this.timeScale().indexToTimePoint(Math.max(e.firstBar(),this.timeScale().points().firstTimePointIndex())),end:end},{start:e.start?e.start.getTime()/1e3:void 0,end:e.end?e.end.getTime()/1e3:void 0}):{start:0,end:0}},W96.prototype.getVisibleRangePlates=function(){var e=[],t=this.getVisibleTickmarksRange(),i=this.getIntervalInTicks(),n=this;return $.each(this._marks,function(o,r){var s=n.timeToExchangeTime(r.tickmark);s>=t.start&&s<=t.end+i&&e.push(r)}),e},W96.prototype.getPublishedPlates=function(){var e={},t=this;return is_authenticated?($.each(this.getVisibleRangePlates(),function(i,n){n.is_public&&(t.pinnedTooltips[n.id]||n.user__id==user.id)&&(e[n.id]=n)}),e):e},W96.prototype._maxPlatesPerBar=10,W96.prototype.filterDisplayedPlates=function(e){return e=e.reduce(function(e,t){var i=this._getIndex(t.tickmark);return e[i]||(e[i]=[]),e[i].push(t),e}.bind(this),{}),e=Object.keys(e).reduce(function(t,i){var n=e[i],n=n.sort(function(e,t){return t.views_count-e.views_count}),n=n.slice(0,this._maxPlatesPerBar);return t.concat(n)},[])},W96.prototype._layout=function(e){switch(e){default:case 0:return"up";case 1:return"down";case 2:return"up";case 3:case 4:case 5:case 6:return"up"}},W96.prototype._theme=function(e){switch(e){default:case 0:return"neutral";case 1:return"green";case 2:return"red";case 3:return"yellow";case 4:return"blue";case 5:return"green";case 6:return"red"}},W96.prototype._offset=function(e,t){var i;switch(e){default:case"up":i=t[HIGH_PLOT];break;case"down":i=t[LOW_PLOT]}return this.priceScale().isPercent()&&(i=this.priceScale().priceRange().convertToPercent(i,this.ownerSource().firstValue())),this.priceScale().priceToCoordinate(i)},W96.prototype.timeToExchangeTime=function(e){return W77.enabled("charting_library")?parseInt(PineJsCalendar.utc_to_cal(this.exchangeTimezone,1e3*e).valueOf()/1e3):e},W96.prototype._getIndex=function(e){return this.timeScale().points().closestIndexLeft(this.timeToExchangeTime(e))},W96.prototype.getViewData=function(){return{barWidth:this.barWidth(),plates:this.getPlatesViewData(),tooltip:this._tooltip}},W96.prototype.updateTimeZone=function(){if(W77.enabled("charting_library")){var e=this.D0.timezone();"exchange"==e&&(e=this.D0.mainSeries().symbolInfo().timezone),this.exchangeTimezone=PineJsCalendar.get_timezone(e)}},W96.prototype.barWidth=function(){return this.timeScale().barSpacing()},W96.prototype.getPlatesViewData=function(){if(this.D0.mainSeries().data().isEmpty())return[];for(var e=this.filterDisplayedPlates(this.getVisibleRangePlates()),t=this,i={},n=this.D0.lastHittestData(),e=(e.map(function(e){var o=this._getIndex(e.tickmark),r=this._getBar(o);if(!r)return!1;var s=this._layout(e.direction),a=this._theme(e.direction),l=n&&n.id==e.id,d=this.timeScale().indexToCoordinate(o),r=this._offset(s,r),h=0;return o in i||(i[o]={up:0,down:0}),h=i[o][s]++,TradingView.merge({id:e.id,x:d,y:r,order:h,direction:s,theme:a,hovered:l,pinned:!0===t.pinnedTooltips[e.id],user__id:e.user__id,label:e.label,labelFontColor:e.labelFontColor||"#444",minSize:e.minSize||0},this._plateViewData(e))}.bind(this))),e=e.filter(function(e){return!!e}),o=e.filter(function(e){return 1==e.hovered}),r=0;r<e.length;r++)null!=o[0]&&e[r].user__id==o[0].user__id&&(e[r].highlightByAuthor=!0);return e.sort(function(e,t){return e.hovered&&!t.hovered?1:0}),e},W96.prototype._getBar=function(e){return this.D0.mainSeries().data().valueAt(e)},W96.prototype.paneViews=function(e){var t=this;return this.D2.visible.value()?(new List).append(new $59(this,e,function(e){return new BarsMarksContainerRenderer(e.getViewData(),t)})):new List},W96.prototype.dataWindowView=function(){return null},W96.prototype.priceAxisViews=function(){return null},W96.prototype.statusView=function(){return null},W96.prototype.updateAllViews=function(){},W96.prototype.pointsCount=function(){return 0},W96.prototype.properties=function(){return this.D2},W96.prototype._rangeDifference=function(e){return e=$.extend({},e),this._loadedRange&&(e.start<this._loadedRange.start?e.end=this._loadedRange.start:e.end>this._loadedRange.end&&(e.start=this._loadedRange.end)),e},W96.prototype._rangeUnion=function(e,t){return e=$.extend({},e),t&&(e.start=Math.min(t.start,e.start),e.end=Math.max(t.end,e.end)),e},W96.prototype._pushGetDataStack=function(e){if(!e.end||!e.start)throw new TypeError("Wrong tickmark range");this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._collectedRange=this._rangeUnion(e,this._collectedRange),this._getDataTimeout=setTimeout(function(){this._getData(this._collectedRange),this._getDataTimeout=this._collectedRange=null}.bind(this),300)},W96.prototype.roundRange=function(e){return{start:Math.round(e.start),end:Math.round(e.end)}},W96.prototype.refreshData=function(){this.getData(this._lastRange)},W96.prototype.getData=function(e){if(!e.start||!e.end)throw new TypeError("Wrong range");this._lastRange=e,e=$.extend({},e),e.end=this._maxDate/1e3,this._pushGetDataStack(e)},W96.prototype._abortAllRequests=function(){this._requests.forEach(function(e){e.abort()}),this._requests=[],this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._getDataTimeout=this._collectedRange=null},W96.prototype.clearMarks=function(){this._abortAllRequests(),this._marks={},this._loadedRange=null},$59.prototype.update=function(){},$59.prototype.renderer=function(){return this._rendererFactory(this.source)},BarsMarksContainerRenderer.prototype.draw=function(e){e.save();for(var t=0;t<this._plates.length;t++)if(this._plates[t].highlightByAuthor){this._highlightByAuthor=!0;break}this._plates.forEach(this._drawItem.bind(this,e)),this._tooltip.draw(this._plates.map(function(e){return this._plateTransform(e)}.bind(this)),e),this._tooltip.endDraw(),e.restore()},BarsMarksContainerRenderer.prototype._drawItem=function(e,t){e.save(),this._highlightByAuthor&&!t.highlightByAuthor&&(e.globalAlpha=.4);var i=this._dotTransform(t);i.mine?this._drawTriangle(e,i):this._drawDot(e,i),e.restore()},BarsMarksContainerRenderer.prototype._commonTransform=function(e){var t=Math.max(1.4*e.minSize,this._barWidth+4),t=e.y+{up:-1,down:1}[e.direction]*(t*(e.order+.6)+.25*t);return{id:e.id,theme:this.themes[e.theme+(e.hovered||e.highlightByAuthor?"_hovered":"")],themeName:e.theme,x:Math.round(e.x+1),y:Math.round(t),pinned:e.pinned,hovered:e.hovered}},BarsMarksContainerRenderer.prototype._dotTransform=function(e){var t=this._commonTransform(e);return t.radius=Math.max(e.minSize/2,.4*this._barWidth),t.label=e.label,t.labelFontColor=e.labelFontColor,t.labelFontSize=Math.ceil(Math.max(10,Math.min(t.radius,20))),this.D0.updateDotData(e,t)},BarsMarksContainerRenderer.prototype._plateTransform=function(e){var t=this._commonTransform(e);return this.D0.updatePlateData(e,t)},BarsMarksContainerRenderer.THEMES=["green","red","neutral","yellow","blue"],BarsMarksContainerRenderer.prototype.themes={green:{border:"#78C143",background:"#8DDD54",dotBorderWidth:2},red:{border:"#CC4545",background:"#ED5A5A ",dotBorderWidth:2},neutral:{border:"#EAC300",background:"#FFD400",dotBorderWidth:2},yellow:{border:"#EAC300",background:"#FFD400",dotBorderWidth:2},blue:{border:"#047ACE",background:"#0496FF",dotBorderWidth:2}},BarsMarksContainerRenderer.THEMES.forEach(function(e){var t=BarsMarksContainerRenderer.prototype.themes;t[e+"_hovered"]=$.extend({},t[e],{dotBorderWidth:4})}),BarsMarksContainerRenderer.prototype._drawTriangle=function(e,t){e.strokeStyle=t.theme.border,e.fillStyle=t.theme.background,e.lineWidth=t.theme.dotBorderWidth;var i=t.radius,n=Math.cos(Math.PI/6)*i,o=Math.sin(Math.PI/6)*i;e.translate(t.x,t.y),"up"==t.direction&&e.rotate(Math.PI),t["public"]||(e.lineWidth/=2),e.beginPath(),e.moveTo(0,-i),e.lineTo(n,o),e.lineTo(-n,o),e.lineTo(0,-i),e.closePath(),e.stroke(),t["public"]&&e.fill()},BarsMarksContainerRenderer.prototype._drawDot=function(e,t){e.strokeStyle=t.theme.border,e.fillStyle=t.theme.background,e.lineWidth=t.theme.dotBorderWidth,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.fill(),t.label&&6<t.radius&&(e.textAlign="center",e.textBaseline="middle",e.font="bold "+t.labelFontSize+"px Arial",e.fillStyle=t.labelFontColor,e.fillText(t.label,t.x,t.y))},BarsMarksContainerRenderer.prototype.hitTest=function(e){for(var t,i=this._plates.length-1;i>=0;--i)if(t=this._hitTestDot(this._plates[i],e))return t;return null},BarsMarksContainerRenderer.prototype._hitTestDot=function(e,t){var i=this._dotTransform(e),n=new MathEx.Point(i.x,i.y);return MathEx.isInCircle(n,Math.max(i.radius,8),t)?new HitTestResult(HitTestResult.REGULAR,e):null},W97.prototype._createLayout=function(){throw"Child class must override this member"},W97.prototype._updatePlate=function(e){throw"Child class must override this member"},W97.prototype._getContainer=function(e){return this._container&&this._context===e||(this._context=e,this._container=$(e.canvas).parent()),this._container},W97.prototype._plateArrowSize=14,W97.prototype.showPlate=function(e,t){if(this._currentId!=e.id||!this._layout||0==this._layout.length||null==this._layout[0].parentNode){this._currentId=e.id,this._createLayout(),this._getContainer(t).append(this._layout);var i=this;this._layout.hover(function(){i.tooltipHovered=!0,$(this).stop(!0).fadeTo(0,1)},function(){i.tooltipHovered=!1})}var n=Math.round(e.barWidth/2);n>15&&(n=15),10>n&&(n=10),this._updatePlate(e);var o=e.x-this._layout.outerWidth()<this._plateArrowSize,r=t.canvas.width-e.x+Math.round(e.barWidth/2+n);o&&(r-=this._layout.outerWidth()+2*this._plateArrowSize);var s=t.canvas.height;this._layout.toggleClass("right",o),this._layout.css({top:Math.min(Math.max(e.y,20),s-this._layout.outerHeight()-10),right:r,fontSize:n+"px",display:"block"})},W97.prototype._removeLayout=function(){this.tooltipHovered||(this._layout.stop(!0),this._layout.remove())},W97.prototype._toggleLayout=function(e){this._layout.toggle(e)},W97.prototype.hide=function(e){this.tooltipHovered?this._layout.stop(!0).fadeTo(0,1):this._layout.fadeOut(400,function(){$(this).remove(),e()})},W97.prototype.setSource=function(e){this.source=e},TooltipRenderer=function(e,t){this.tooltips={},this.tooltipFactory=e,this.source=t},TooltipRenderer.prototype.findOrCreateTooltip=function(e){var t=this.tooltips[e.id];return null==t&&(e.hovered||e.pinned)&&(t=this._createTooltip(),this.tooltips[e.id]=t),t},TooltipRenderer.prototype.showPlate=function(e,t){var i=this.findOrCreateTooltip(e);null!=i&&(i._drawPlate(e,t),i.plateData=e)},TooltipRenderer.prototype.draw=function(e,t){this.hoveredId=null;for(var i=0;i<e.length;i++)e[i].hovered&&(this.hoveredId=e[i].id);e.forEach(function(e){this.showPlate(e,t)}.bind(this))},TooltipRenderer.prototype.endDraw=function(){for(var e in this.tooltips)if(this.tooltips.hasOwnProperty(e)){var t=this.tooltips[e];t.toggleVisibility(),this.hoveredId&&t.plateData.id!=this.hoveredId&&!t.plateData.pinned&&(t.remove(),delete this.tooltips[e])}},TooltipRenderer.prototype.removeAll=function(){for(var e in this.tooltips)this.tooltips.hasOwnProperty(e)&&this.tooltips[e].remove();this.tooltips={}},TooltipRenderer.prototype.removeTooltip=function(e){
delete this.tooltips[e]},TooltipRenderer.prototype._createTooltip=function(){return new TooltipWrap(this,this.tooltipFactory())},TooltipWrap=function(e,t){this.renderer=e,this._tooltip=t,this.visible=!1},TooltipWrap.prototype._drawPlate=function(e,t){var i=this;this.visible=!0,this._tooltip.setSource(this.renderer.source),this._tooltip.showPlate(e,t),e.hovered||e.pinned||this._tooltip.hide(function(){i.renderer.removeTooltip(e.id)})},TooltipWrap.prototype.remove=function(){this._tooltip._removeLayout()},TooltipWrap.prototype.toggleVisibility=function(){this._tooltip._toggleLayout(this.visible),this.visible=!1},inherit(UserDefinedBarsMarks,W96),UserDefinedBarsMarks.prototype._initialize=function(e){this.D2.visible.setValue(!0)},UserDefinedBarsMarks.prototype._constructor="UserDefinedBarsMarks",UserDefinedBarsMarks.prototype._plateViewData=function(e){return{text:e.text}},UserDefinedBarsMarks.prototype.onClicked=function(){var e=this.D0.lastHittestData().id;this._marks[e].onClicked()},UserDefinedBarsMarks.prototype.clearMarks=function(){W96.prototype.clearMarks.call(this),this.onNeedRepaint.fire()},UserDefinedBarsMarks.prototype._getData=function(e){var t=this.D0.mainSeries().symbolInfo();if(t){var i=this.roundRange(this._rangeDifference(e)),n=this,o=this.D0.mainSeries().properties().interval.value();D16.getMarks(t,i.start,i.end,function(t){t.forEach(function(e){n._marks[e.id]=e},n),n._loadedRange=n._rangeUnion(e,n._loadedRange),n.onNeedRepaint.fire()},o)}},UserDefinedBarsMarks.prototype._createTooltip=function(){return new UserDefinedBarsMarksTooltip},UserDefinedBarsMarks.prototype.updatePlateData=function(e,t){return t.barWidth=this.barWidth(),t.text=e.text,t.tooltipMargin=-1*Math.max(e.minSize/2,.4*this.barWidth()),t},UserDefinedBarsMarks.prototype.hasContextMenu=function(){return!1},inherit(UserDefinedBarsMarksTooltip,W97),UserDefinedBarsMarksTooltip.prototype._createLayout=function(){this._layout=$('<div class="bar-mark-tooltip"></div>'),this._layout_text=$('<div class="text"></div>').appendTo(this._layout)},UserDefinedBarsMarksTooltip.prototype._updatePlate=function(e){this._currentId=e.id,this._layout.css("border-color",e.theme.border),this._layout.css("margin-top",e.tooltipMargin+"px"),this._layout_text.html(e.text),this._layout.append(this._layout_text)},W32.prototype.update=function(){if(this._visible=!1,this.W99.properties().showPriceLine.value()){var e=this.W99.lastValueData("close",!0);e&&(this._visible=!0,this._points=(new List).append(new MathEx.Point(0,e.coordinate)),this._color=e.color)}},W32.prototype.renderer=function(){var e={};return e.points=this._points,e.color=this._color,e.linewidth=1,e.linestyle=CanvasEx.LINESTYLE_DOTTED,e.hitTestResult=HitTestResult.REGULAR,e.visible=this._visible,new HorzLineRenderer(e)},A50=function(e,t){this.W99=e,this.D0=t,this._invalidated=!0,this._text="",this._coordinate=0,this._background="black",this._color="white",this._textHeight=14},inherit(A50,PriceAxisView),A50.prototype.update=function(){this._invalidated=!0},A50.prototype.coordinate=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),PriceAxisView.prototype.coordinate.call(this)},A50.prototype._updateImpl=function(){this._visible=!1,this._text="";var e=this.W99.lastValueData("close",!1);e&&(this._text=e.text,this._floatCoordinate=e.floatCoordinate,this._coordinate=e.coordinate,this._textHeight=this.W99.priceScale().m_markBuilder.fontHeight(),this._background=e.color,this._visible=!0)},A50.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={text:this._text,coordinate:this._coordinate,color:this.color(),background:this._background,textHeight:this._textHeight,visible:this._visible};return new PriceAxisViewRenderer(e)},A49=function(e,t){DataWindowView.call(this),this.D1=e,this.D0=t,this._items.append(new DataWindowItem("Open","")),this._items.append(new DataWindowItem("High","")),this._items.append(new DataWindowItem("Low","")),this._items.append(new DataWindowItem("Close","")),this._invalidated=!0,this.update()},inherit(A49,DataWindowView),A49.prototype._updateImpl=function(){if(this._header=this.D1.title(),!this.D0.timeScale().isEmpty()&&0!==this.D1.data().size()){var e,t,i=!1;this.D1.properties().style.value()===TradingView.Series.STYLE_BARS?(e=this.D1.properties().barStyle.upColor.value(),t=this.D1.properties().barStyle.downColor.value(),i=this.D1.properties().barStyle.barColorsOnPrevClose.value()):this.D1.properties().style.value()===TradingView.Series.STYLE_CANDLES?(e=this.D1.properties().candleStyle.upColor.value(),t=this.D1.properties().candleStyle.downColor.value(),i=this.D1.properties().candleStyle.barColorsOnPrevClose.value()):this.D1.properties().style.value()===TradingView.Series.STYLE_HOLLOW_CANDLES?(e=this.D1.properties().hollowCandleStyle.upColor.value(),t=this.D1.properties().hollowCandleStyle.downColor.value(),i=!0):this.D1.properties().style.value()===TradingView.Series.STYLE_LINE?e=t=this.D1.properties().lineStyle.color.value():this.D1.properties().style.value()===TradingView.Series.STYLE_AREA&&(e=t=this.D1.properties().areaStyle.linecolor.value());var n=this.D1.series(),o=this.D0.crossHairSource().index,n=n.nearestIndex(o,SEARCH_NEAREST_LEFT);if(void 0!==n){if(o=this.D1.data().valueAt(n),!(o&&o[OPEN_PLOT]&&o[HIGH_PLOT]&&o[LOW_PLOT]&&o[CLOSE_PLOT]))return;var r=this.D1.formatter();for(this._items.item(0).setValue(r.format(o[OPEN_PLOT])),this._items.item(1).setValue(r.format(o[HIGH_PLOT])),this._items.item(2).setValue(r.format(o[LOW_PLOT])),this._items.item(3).setValue(r.format(o[CLOSE_PLOT])),e=i&&n>=1?this.D1.data().valueAt(n-1)[CLOSE_PLOT]<=o[CLOSE_PLOT]?e:t:o[OPEN_PLOT]<=o[CLOSE_PLOT]?e:t,t=0;4>t;t++)this._items.item(t).setColor(e)}this._additional=(e=TradingView.getDataVendorString(this.D1.symbolInfo()))?"(Data Provided by "+e+")":void 0}},A49.prototype.items=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items},A49.prototype.update=function(){this._invalidated=!0},A49.prototype.additional=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional},TradingView.study_Overlay=function(e,t,i,n){this._symbolLabelView=new TradingView.W38(e,this,"close"),TradingView.Study.call(this,e,t,i,n),this._paneView=this._formatter=null;var o=this;this.properties().minTick.listeners().subscribe(null,function(){o._createFormatter(),o.updateAllViews(),o.D0.D20(new A22(A22.FULL_UPDATE))})},inherit(TradingView.study_Overlay,TradingView.Study),TradingView.study_Overlay.prototype.symbol=function(){var e=this.properties().inputs.symbol.value(),t=this._resolvedSymbols?this._resolvedSymbols[e]:null;return(t?t.name:e).toUpperCase()},TradingView.study_Overlay.prototype.lastValueData=function(e,t){var i=TradingView.Study.prototype.lastValueData.call(this,"close",t);if(!i)return i;var n=this.properties(),o=i.item;switch(n.style.value()){case TradingView.Series.STYLE_BARS:i.color=o[OPEN_PLOT]<=o[CLOSE_PLOT]?n.barStyle.upColor.value():n.barStyle.downColor.value();break;case TradingView.Series.STYLE_CANDLES:i.color=o[OPEN_PLOT]<=o[CLOSE_PLOT]?n.candleStyle.upColor.value():n.candleStyle.downColor.value();break;case TradingView.Series.STYLE_HOLLOW_CANDLES:i.color=o[OPEN_PLOT]<=o[CLOSE_PLOT]?n.candleStyle.upColor.value():n.candleStyle.downColor.value();break;case TradingView.Series.STYLE_LINE:i.color=n.lineStyle.color.value();break;case TradingView.Series.STYLE_AREA:i.color=n.areaStyle.color1.value()}return i},TradingView.study_Overlay.prototype.createViews=function(){switch(this._priceAxisViews=new List,this._priceAxisViewsBase=new List,this._priceAxisViewsBase.append(new A50(this,this.D0)),this._paneViews=new List,paneView=null,this.D2.style.value()){case TradingView.Series.STYLE_BARS:paneView=new W15(this,this.D0);break;case TradingView.Series.STYLE_CANDLES:paneView=new W16(this,this.D0);break;case TradingView.Series.STYLE_HOLLOW_CANDLES:paneView=new W18(this,this.D0);break;case TradingView.Series.STYLE_LINE:paneView=new W20(this,this.D2.lineStyle.priceSource.value(),this.D0);break;case TradingView.Series.STYLE_AREA:paneView=new W13(this,this.D2.areaStyle.priceSource.value(),this.D0)}this._paneViews.append(paneView),this._paneViews.append(new W32(this,this.D0)),this._paneViews.append(this._symbolLabelView),this._dataWindowView||(this._dataWindowView=new A49(this,this.D0)),this._statusView||(this._statusView=new StudyStatusView(this)),this._priceAxisViews=(new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)},TradingView.study_Overlay.prototype.barColorer=function(){return new SeriesBarColorer(this)},TradingView.study_Overlay.prototype.start=function(){this._formatter=null,TradingView.Study.prototype.start.call(this),this.priceScale()&&this.priceScale().updateFormatter()},TradingView.study_Overlay.prototype._createFormatter=function(){if("default"==this.properties().minTick.value()){var e=this.properties().inputs.symbol.value(),e=this._resolvedSymbols[e];this._formatter=new PriceFormatter(e?e.pricescale:100,e?e.minmov:1,e?e.fractional:!1)}else{var e=this.properties().minTick.value(),e=isNumber(e)?["100","1","false"]:e.split(","),t=parseInt(e[0]),i=parseInt(e[1]);this._formatter=new PriceFormatter(t,i,"true"===e[2])}this.priceScale()&&this.priceScale().updateFormatter()},TradingView.study_Overlay.prototype.formatter=function(){return this._formatter||this._createFormatter(),this._formatter},TradingView.study_Overlay.prototype._changeInputs=function(){TradingView.Study.prototype._changeInputs.call(this,this.inputs()),this.m_formatter=null,this.priceScale().updateFormatter()},TradingView.study_Overlay.prototype.title=function(){var e=this.properties().inputs.symbol.value(),t=this._resolvedSymbols[e];return(t?t.name+", "+t.exchange:e).toUpperCase()},TradingView.study_Overlay.prototype.bars=function(){return this.m_data},TradingView.study_Overlay.prototype.open=function(e){return this.bars().valueAt(e)[OPEN_PLOT]},TradingView.study_Overlay.prototype.high=function(e){return this.bars().valueAt(e)[HIGH_PLOT]},TradingView.study_Overlay.prototype.low=function(e){return this.bars().valueAt(e)[LOW_PLOT]},TradingView.study_Overlay.prototype.close=function(e){return this.bars().valueAt(e)[CLOSE_PLOT]},TradingView.study_Overlay.prototype.hl2=function(e){return(this.high(e)+this.low(e))/2},TradingView.study_Overlay.prototype.hlc3=function(e){return(this.high(e)+this.low(e)+this.close(e))/3},TradingView.study_Overlay.prototype.ohlc4=function(e){return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4},TradingView.study_Overlay.prototype.symbolInfo=function(){if(!this._resolvedSymbols)return null;var e=this.D2.inputs.symbol.value();return e?this._resolvedSymbols[e]:null},TradingView.study_Overlay.prototype.lastPriceLabelFixedCoordinate=function(){return this._priceAxisViews.item(0)._fixedCoordinate},TradingView.Study.graphicsZOrderPriority=function(e){switch(e){case"polygons":return-100;case"trendchannels":return-90;default:return 0}},TradingView.Study.StudyPaneView_horizlines=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_horizlines.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_horizlines.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new TrendLineRenderer(this._data[t],new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_horizlines.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().horizlines;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.firstValue(),o=this.D1.graphics().indexes,r=this.D0.timeScale().visibleBars(),s=r.firstBar(),r=r.lastBar(),a=0;a<e.length;a++){var l=e[a];if(l.data){var d=this.D1.properties().graphics.horizlines[l.styleId];if(d.visible.value())for(var h=0;h<l.data.length;h++){var c=l.data[h],p=o[c.startIndex],u=o[c.endIndex];if(!(!c.extendRight&&Math.max(p,u)<s||!c.extendLeft&&Math.min(p,u)>r)){var f={},p=i.indexToCoordinate(p),u=i.indexToCoordinate(u),g=c.level;t.isPercent()&&(g=t.priceRange().convertToPercent(g,n)),g=t.priceToCoordinate(g),p=new MathEx.Point(p,g),u=new MathEx.Point(u,g),f.points=(new List).append(p).append(u),f.extendleft=c.extendLeft,f.extendright=c.extendRight,f.width=i.width(),f.height=t.height(),f.color=d.color.value(),f.linewidth=d.width.value(),f.linestyle=d.style.value(),this._data.push(f)}}}}}},TradingView.Study.StudyPaneView_vertlines=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_vertlines.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_vertlines.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new TrendLineRenderer(this._data[t],new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_vertlines.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().vertlines;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.firstValue(),o=this.D1.graphics().indexes,r=this.D0.timeScale().visibleBars(),s=r.firstBar(),r=r.lastBar(),a=0;a<e.length;a++){var l=e[a];if(l.data){var d=this.D1.properties().graphics.vertlines[l.styleId];if(d.visible.value())for(var h=0;h<l.data.length;h++){var c=l.data[h],p={};if(!(o[c.index]<s||o[c.index]>r)){var u=i.indexToCoordinate(o[c.index])+1,f=c.startPrice,g=c.endPrice,m=t.priceRange();c.extendBottom&&(f=m.minValue()),c.extendTop&&(g=m.maxValue()),t.isPercent()&&(f=t.priceRange().convertToPercent(f,n),g=t.priceRange().convertToPercent(g,n)),f=t.priceToCoordinate(f),g=t.priceToCoordinate(g),f=new MathEx.Point(u,f),u=new MathEx.Point(u,g),p.points=(new List).append(f).append(u),p.extendleft=c.extendBottom,p.extendright=c.extendTop,p.width=i.width(),p.height=t.height(),p.color=d.color.value(),p.linewidth=d.width.value(),p.linestyle=d.style.value(),this._data.push(p)}}}}}},TradingView.Study.StudyPaneView_lines=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_lines.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_lines.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new TrendLineRenderer(this._data[t],new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_lines.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().lines;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.firstValue(),o=this.D1.graphics().indexes,r=this.D0.timeScale().visibleBars(),s=r.firstBar(),r=r.lastBar(),a=0;a<e.length;a++){var l=e[a];if(l.data){var d=this.D1.properties().graphics.lines[l.styleId];if(d.visible.value())for(var h=0;h<l.data.length;h++){var c=l.data[h],p=o[c.startIndex]+(c.startOffset||0),u=o[c.endIndex]+(c.endOffset||0);if(!(!c.extendRight&&Math.max(p,u)<s||!c.extendLeft&&Math.min(p,u)>r)){var f={},p=i.indexToCoordinate(p),u=i.indexToCoordinate(u),g=c.startPrice,c=c.endPrice;t.isPercent()&&(g=t.priceRange().convertToPercent(g,n),c=t.priceRange().convertToPercent(c,n)),g=t.priceToCoordinate(g),c=t.priceToCoordinate(c),p=new MathEx.Point(p,g),u=new MathEx.Point(u,c),f.points=(new List).append(p).append(u),f.color=d.color.value(),f.linewidth=d.width.value(),f.linestyle=d.style.value(),this._data.push(f)}}}}}},TradingView.Study.StudyPaneView_hlines=function(e,t){this.D1=e,this.D0=t,this._data=[],this._textData=[],this._textRendererCache={}},TradingView.Study.StudyPaneView_hlines.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_hlines.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new HorzLineRenderer(this._data[t]));for(t=0;t<this._textData.length;t++)e.append(new TextRenderer(this._textData[t],this._textRendererCache,new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_hlines.prototype._updateViewInternal=function(){this._calcHorzLinesData(),this._calcTextData()},TradingView.Study.StudyPaneView_hlines.prototype._calcTextData=function(){this._textData=[];var e=this.D1.graphics().hlines;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.firstValue(),o=0;o<e.length;o++){var r=e[o];if(r.data){var s=this.D1.properties().graphics.hlines[r.styleId];if(s.enableText.value()&&s.showText.value())for(var a=0;a<r.data.length;a++){var l=r.data[a],d={};d.text=void 0===l.text?"":l.text,d.color=s.color.value(),d.font="arial",d.fontsize=s.fontSize.value(),l=l.level,t.isPercent()&&(l=t.priceRange().convertToPercent(l,n)),l=t.priceToCoordinate(l),tp=s.textPos.value();var h;tp==CanvasEx.TEXTPOS_TOPLEFT||tp==CanvasEx.TEXTPOS_MIDDLELEFT||tp==CanvasEx.TEXTPOS_BOTTOMLEFT?(h=4,d.horzAlign="left"):tp==CanvasEx.TEXTPOS_TOPCENTER||tp==CanvasEx.TEXTPOS_MIDDLECENTER||tp==CanvasEx.TEXTPOS_BOTTOMCENTER?(h=i.width()/2,d.horzAlign="center"):(tp==CanvasEx.TEXTPOS_TOPRIGHT||tp==CanvasEx.TEXTPOS_MIDDLERIGHT||tp==CanvasEx.TEXTPOS_BOTTOMRIGHT)&&(h=i.width(),d.horzAlign="right"),tp==CanvasEx.TEXTPOS_TOPLEFT||tp==CanvasEx.TEXTPOS_TOPCENTER||tp==CanvasEx.TEXTPOS_TOPRIGHT?(d.vertAlign="bottom",l-=4):tp==CanvasEx.TEXTPOS_MIDDLELEFT||tp==CanvasEx.TEXTPOS_MIDDLECENTER||tp==CanvasEx.TEXTPOS_MIDDLERIGHT?(d.vertAlign="middle",l-=2):(tp==CanvasEx.TEXTPOS_BOTTOMLEFT||tp==CanvasEx.TEXTPOS_BOTTOMCENTER||tp==CanvasEx.TEXTPOS_BOTTOMRIGHT)&&(d.vertAlign="top"),p1=new MathEx.Point(h,l),d.points=(new List).append(p1),d.offsetX=0,d.offsetY=0,this._textData.push(d)}}}}},TradingView.Study.StudyPaneView_hlines.prototype._calcHorzLinesData=function(){this._data=[];var e=this.D1.graphics().hlines;if(e){var t=this.D1.priceScale();if(t&&!t.isEmpty())for(var i=this.D1.firstValue(),n=0;n<e.length;n++){var o=e[n];if(o.data){var r=this.D1.properties().graphics.hlines[o.styleId];if(r.visible.value())for(var s=0;s<o.data.length;s++){var a={},l=o.data[s].level;t.isPercent()&&(l=t.priceRange().convertToPercent(l,i)),l=t.priceToCoordinate(l),a.points=(new List).append(new MathEx.Point(0,l)),a.color=r.color.value(),a.linewidth=r.width.value(),a.linestyle=r.style.value(),a.hitTestResult=HitTestResult.REGULAR,this._data.push(a)}}}}},TradingView.Study.StudyPriceAxisView_hlines=function(e,t,i,n,o){this.D1=e,this.D0=t,this._line=i,this._styleId=n,this._data={},this._lineType=o,this._invalidated=!0},inherit(TradingView.Study.StudyPriceAxisView_hlines,PriceAxisView),TradingView.Study.StudyPriceAxisView_hlines.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPriceAxisView_hlines.prototype.updateImpl=function(){this._data={},this._data.visible=!1;var e=this.D1.priceScale();if(e&&!e.isEmpty()&&this.D1.properties().visible.value()){var t=this.D1.properties().graphics[this._lineType][this._styleId];if(t.visible&&t.visible.value()&&t.showPrice&&t.showPrice.value()){var i=this.D1.firstValue();if(this._data.visible=!0,this._data.color="white",this._data.background=t.color.value(),t=this._line.level,e.isPercent()){if(!isNumber(i))return;t=e.priceRange().convertToPercent(t,i)}this._data.coordinate=e.priceToCoordinate(t),this._data.textHeight=e.m_markBuilder.fontHeight(),this._data.text=e.formatter().format(t)}}},TradingView.Study.StudyPriceAxisView_hlines.prototype.renderer=function(){return this._invalidated&&(this.updateImpl(),this._invalidated=!1),new PriceAxisViewRenderer(this._data)},TriangleTextMarkRenderer.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},TriangleTextMarkRenderer.prototype.draw=function(e){if(this._data){var t="up"==this._data.direction?1:-1,i=this._data.point.x;"left"==this._data.halign?i-=this._data.size:"right"==this._data.halign&&(i+=this._data.size);var n=this._data.point.y;e.font=this.fontStyle();var o=e.measureText(this._data.text).width;this._textCache.textWidth=o;var r=this._data.fontSize,s=.65*r,a=1*r;switch(e.save(),e.translate(i+.5,n+.5),e.beginPath(),e.moveTo(0,0),this._data.direction){case"up":case"down":e.lineTo(s,a*t),e.lineTo(.5*o+s,a*t),e.lineTo(.5*o+s,(a+1.75*r)*t),e.lineTo(.5*-o-s,(a+1.75*r)*t),e.lineTo(.5*-o-s,a*t),e.lineTo(-s,a*t),e.lineTo(0,0),e.strokeStyle=this._data.borderColor,e.stroke(),e.fillStyle=this._data.color,e.fill(),e.fillStyle=this._data.fontColor,e.fillText(this._data.text,.5*-o,0>t?t*a-.5*r:a+1.25*r);break;default:throw this._data.direction+" doesn't supported by TriangleTextMarkRenderer"}e.restore()}},TriangleTextMarkRenderer.prototype.hitTest=function(e){var t=this._textCache.textWidth,i=this._data.fontSize;switch(this._data.direction){case"up":case"down":var n="up"==this._data.direction?1:-1,o=.65*i,r=1*i,s=this._data.point.x;"left"==this._data.halign?s-=this._data.size:"right"==this._data.halign&&(s+=this._data.size);var a=this._data.point.y,l=s+.5*t+o,d=a+r*n,r=a+(r+1.75*i)*n;if(d>r&&(a=d,d=r,r=a),MathEx.pointInRect(e,new MathEx.Point(s-.5*t-o,d),new MathEx.Point(l,r)))return new HitTestResult(HitTestResult.REGULAR);if(t=[{}],t[0].x=this._data.point.x,t[0].y=this._data.point.y,t[1]={},t[1].x=this._data.point.x+.65*i,t[1].y=this._data.point.y+i*n,t[2]={},t[2].x=this._data.point.x-.65*i,t[2].y=this._data.point.y+i*n,i=(e.x-t[0].x)*(t[1].y-t[0].y)-(e.y-t[0].y)*(t[1].x-t[0].x),0<((e.x-t[1].x)*(t[2].y-t[1].y)-(e.y-t[1].y)*(t[2].x-t[1].x))*i&&0<((e.x-t[2].x)*(t[0].y-t[2].y)-(e.y-t[2].y)*(t[0].x-t[2].x))*i)return new HitTestResult(HitTestResult.REGULAR);break;default:throw this._data.direction+" doesn't supported by TriangleTextMarkRenderer"}return null},RectangleTextMarkRenderer.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},RectangleTextMarkRenderer.prototype.draw=function(e){if(this._data){var t=this._data.point.x,i=this._data.point.y;e.font=this.fontStyle();var n=e.measureText(this._data.text).width;switch(this._textCache.textWidth=n,e.save(),e.translate(t+.5,i+.5),e.beginPath(),e.moveTo(0,0),t=this._data.valign,e.textAlign=this._data.halign,t){case"middle":e.textBaseline="middle";break;case"top":e.textBaseline="bottom";break;case"bottom":e.textBaseline="hanging"}e.fillStyle=this._data.fontColor,e.fillText(this._data.text,0,0),e.restore()}},RectangleTextMarkRenderer.prototype.hitTest=function(e){var t=this._data.point.x+.5,i=this._data.point.y+.5,n=this._textCache.textWidth,o=this._data.fontSize,r=this._data.halign;switch(this._data.valign){case"middle":i-=o/2;break;case"bottom":i-=o}switch(r){case"right":t-=n;break;case"center":t-=n/2}return r=new MathEx.Point(t,i),t=new MathEx.Point(t+n,i+o),MathEx.pointInRect(e,r,t)?new HitTestResult(HitTestResult.REGULAR):null},CircleShapeMarkRenderer.prototype.draw=function(e){if(this._data){var t="down"==this._data.direction?1:"up"==this._data.direction?-1:0,i=this._data.point.x,n=this._data.point.y;e.save(),e.fillStyle=this._data.color,e.beginPath(),e.arc(i+1,n+2*this._data.size*t+.5,this._data.size,0,2*Math.PI),e.closePath(),e.fill(),e.stroke()}},CircleShapeMarkRenderer.prototype.hitTest=function(e){var t="down"==this._data.direction?1:"up"==this._data.direction?-1:0;return Math.pow(this._data.point.x+.5-e.x,2)+Math.pow(this._data.point.y+.5+2*this._data.size*t-e.y,2)<=Math.pow(this._data.size,2)?new HitTestResult(HitTestResult.REGULAR):null},SquareShapeMarkRenderer.prototype.draw=function(e){if(this._data){var t="down"==this._data.direction?1:"up"==this._data.direction?-1:0,i=parseInt(this._data.size),n=new MathEx.Point(this._data.point.x-i/2,this._data.point.y-i/2+t*i),t=new MathEx.Point(this._data.point.x+i/2,this._data.point.y+i/2+t*i).substract(n);e.beginPath(),e.fillStyle=this._data.color,e.rect(n.x,n.y,t.x,t.y),e.stroke(),e.fill()}},SquareShapeMarkRenderer.prototype.hitTest=function(e){var t="down"==this._data.direction?1:"up"==this._data.direction?-1:0,i=parseInt(this._data.size),n=new MathEx.Point(this._data.point.x-i/2,this._data.point.y-i/2+t*i),i=new MathEx.Point(this._data.point.x+i/2,this._data.point.y+i/2+t*i),t=new MathEx.Point(Math.min(n.x,i.x),Math.min(n.y,i.y)),n=new MathEx.Point(Math.max(n.x,i.x),Math.max(n.y,i.y));return MathEx.pointInRect(e,t,n)?new HitTestResult(HitTestResult.REGULAR):null},ArrowShapeMarkRenderer.prototype.draw=function(e){if(this._data){var t=this._arrowDirection,i=1*this._data.size,n=this._data.color,o=this._data.point.x+1,r=this._data.point.y,s=1.1*i;switch(t){case"up":r-=s;break;case"down":r+=s}var s=i/6,a=i/4,l=i/3,d=i/2,h=.6666666*i;switch(e.save(),e.fillStyle=n,e.beginPath(),t){case"up":e.moveTo(o,r),e.lineTo(o-d,r+h),e.lineTo(o-a,r+h),e.lineTo(o,r+l),e.lineTo(o+a,r+h),e.lineTo(o+d,r+h),e.lineTo(o,r);break;case"down":e.moveTo(o,r+i),e.lineTo(o-d,r+l),e.lineTo(o-a,r+l),e.lineTo(o,r+h),e.lineTo(o+a,r+l),e.lineTo(o+d,r+l),e.lineTo(o,r+i);break;case"right":e.moveTo(o+s,r),e.lineTo(o-s,r-a),e.lineTo(o-s,r+a),e.lineTo(o+s,r);break;case"left":e.moveTo(o-s,r),e.lineTo(o+s,r-a),e.lineTo(o+s,r+a),e.lineTo(o-s,r)}e.closePath(),e.fill(),e.stroke()}},ArrowShapeMarkRenderer.prototype.hitTest=function(e){var t=this._data.point.x,i=this._data.point.y,n=this._arrowDirection,o=1*this._data.size,r=o/2,r=1.1*o;switch(n){case"up":i-=r;break;case"down":i+=r}var s=o/6,a=o/4,l=o/3,r=o/2,d=.6666666*o;switch(n){case"up":var h=new MathEx.Point(t,i),c=new MathEx.Point(t+r,i+d),p=new MathEx.Point(t-r,i+d);break;case"down":h=new MathEx.Point(t,i+o),c=new MathEx.Point(t+r,i+l),p=new MathEx.Point(t-r,i+l);break;case"right":h=new MathEx.Point(t+s,i),c=new MathEx.Point(t-s,i-a),p=new MathEx.Point(t-s,i+a);break;case"left":h=new MathEx.Point(t-s,i),c=new MathEx.Point(t+s,i-a),p=new MathEx.Point(t+s,i+a)}return MathEx.pointInTriangle(h,c,p,e)?new HitTestResult(HitTestResult.REGULAR):null},TradingView.Study.StudyPaneView_textmarks=function(e,t){this.D1=e,this.D0=t,this._data=[],this._textCache=[]},inherit(TradingView.Study.StudyPaneView_textmarks,LocationToYMixin),TradingView.Study.StudyPaneView_textmarks.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_textmarks.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)switch(this._data[t].shape){case"triangle":e.append(new TriangleTextMarkRenderer(this._data[t],this._textCache[t]));break;case"rectangle":e.append(new RectangleTextMarkRenderer(this._data[t],this._textCache[t]))}return e},TradingView.Study.StudyPaneView_textmarks.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().textmarks;if(e){var t=this.D1.priceScale(),i=this.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.graphics().indexes,o=this.D1.firstValue(),r=this.D0.timeScale().visibleBars(),s=r.firstBar(),r=r.lastBar(),a=0;a<e.length;a++){var l=e[a];if(l.data){var d=this.D1.properties().graphics.textmarks[l.styleId];if(d.visible.value())for(var l=l.data,h=0;h<l.length;h++){var c=l[h],p={},u=d.location.value(),f=d.shape.value(),g=n[c.time];if(!(s>g||g>r)&&this.D1.series().bars().valueAt(g)){g=n[c.time]+(c.offset||0),p.font=d.fontFamily.value(),p.color=generateColor(d.color.value(),d.transparency.value()),p.bold=d.fontBold.value(),p.fontColor=generateColor(d.fontColor.value(),d.transparency.value()),p.italic=d.fontItalic.value(),p.fontSize=d.fontSize.value(),p.text=c.text?c.text:"",p.halign=d.halign.value(),p.valign=void 0!=d.valign?d.valign.value():"middle",p.shape=d.shape.value(),p.size=.5*i.barSpacing(),p.borderColor="rgb(0, 0, 0)";var m,_;switch(f){case"triangle":_=this._calcCoordsForTriangleShape(u,g,50,c.price,o,t),p.direction=_.direction,m=Math.round(i.indexToCoordinate(g)),_=_.y;break;case"rectangle":_=this._calcCoordsForRectangleShape(u,g,c.price,o,t,i),m=_.x,_=_.y}p.point=new MathEx.Point(m,_),this._data.push(p),this._textCache.push({})}}}}}},TradingView.Study.StudyPaneView_textmarks.prototype._calcCoordsForTriangleShape=function(e,t,i,n,o,r){switch(e){case CanvasEx.MARKLOC_TOP:e=r.height()-i,t="down";break;case CanvasEx.MARKLOC_BOTTOM:e=i,t="up";break;case CanvasEx.MARKLOC_ABSOLUTEDOWN:r.isPercent()&&(n=r.priceRange().convertToPercent(n,o)),e=r.priceToCoordinate(n),t="down";break;case CanvasEx.MARKLOC_ABSOLUTEUP:r.isPercent()&&(n=r.priceRange().convertToPercent(n,o)),e=r.priceToCoordinate(n),t="up";break;case CanvasEx.MARKLOC_ABOVEBAR:e=this._locationToY(e,t),t="down";break;case CanvasEx.MARKLOC_BELOWBAR:e=this._locationToY(e,t),t="up";break;default:e=this._locationToY(e,t),t="up"}return{y:e,direction:t}},TradingView.Study.StudyPaneView_textmarks.prototype._calcCoordsForRectangleShape=function(e,t,i,n,o,r){var s=Math.round(r.indexToCoordinate(t));switch(e){case CanvasEx.MARKLOC_ABSOLUTEDOWN:case CanvasEx.MARKLOC_ABSOLUTEUP:case CanvasEx.MARKLOC_ABSOLUTE:o.isPercent()&&(i=o.priceRange().convertToPercent(i,n)),e=o.priceToCoordinate(i);break;case CanvasEx.MARKLOC_ABOVEBAR:e=this._locationToY(e,t);break;case CanvasEx.MARKLOC_BELOWBAR:e=this._locationToY(e,t);break;case CanvasEx.MARKLOC_RIGHT:s=r.width(),o.isPercent()&&(i=o.priceRange().convertToPercent(i,n)),e=o.priceToCoordinate(i);break;case CanvasEx.MARKLOC_LEFT:s=r.width(),o.isPercent()&&(i=o.priceRange().convertToPercent(i,n)),e=o.priceToCoordinate(i);break;default:e=this._locationToY(e,t)}return{x:s,y:e}},TradingView.Study.StudyPaneView_shapemarks=function(e,t){this.D1=e,this.D0=t,this._data=[],this._textCache=[]},inherit(TradingView.Study.StudyPaneView_shapemarks,LocationToYMixin),TradingView.Study.StudyPaneView_shapemarks.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_shapemarks.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)switch(this._data[t].shape){case"circle":e.append(new CircleShapeMarkRenderer(this._data[t],this._textCache[t]));break;case"square":e.append(new SquareShapeMarkRenderer(this._data[t],this._textCache[t]));break;case"arrowUp":e.append(new ArrowShapeMarkRenderer(this._data[t],this._textCache[t],"up"));break;case"arrowDown":e.append(new ArrowShapeMarkRenderer(this._data[t],this._textCache[t],"down"));break;case"arrowRight":e.append(new ArrowShapeMarkRenderer(this._data[t],this._textCache[t],"right"));break;case"arrowLeft":e.append(new ArrowShapeMarkRenderer(this._data[t],this._textCache[t],"left"))}return e},TradingView.Study.StudyPaneView_shapemarks.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().shapemarks;if(e){var t=this.D1.priceScale(),i=this.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.graphics().indexes,o=this.D0.timeScale().visibleBars(),r=o.firstBar(),o=o.lastBar(),s=0;s<e.length;s++){var a=e[s];if(a.data){var l=this.D1.properties().graphics.shapemarks[a.styleId];if(l.visible.value())for(var a=a.data,d=0;d<a.length;d++){var h=a[d],c=n[h.time];if(!(r>c||c>o)){var p={};if(null!=h.time&&this.D1.series().bars().valueAt(c)){p.color=generateColor(l.color.value(),l.transparency.value());var u=0;"left"==l.halign.value()?u-=i.barSpacing()/2+1:"right"==l.halign.value()&&(u+=i.barSpacing()/2+1),p.size=l.size.value(),p.shape=l.shape.value();var u=Math.round(i.indexToCoordinate(c))+u,f=this.D1.firstValue(),h=h.price;switch(t.isPercent()&&(h=t.priceRange().convertToPercent(h,f)),h=t.priceToCoordinate(h),f=l.location.value()){case CanvasEx.MARKLOC_ABSOLUTE:p.direction="";break;case CanvasEx.MARKLOC_ABSOLUTEDOWN:p.direction="down";break;case CanvasEx.MARKLOC_ABSOLUTEUP:p.direction="up";break;case CanvasEx.MARKLOC_ABOVEBAR:
h=this._locationToY(f,c,Math.floor(2*p.size/i.barSpacing())+1),p.direction="up";break;case CanvasEx.MARKLOC_BELOWBAR:h=this._locationToY(f,c,Math.floor(2*p.size/i.barSpacing())+1),p.direction="down";break;default:console.warn("Bad location value: "+f),h=this._locationToY(CanvasEx.MARKLOC_ABSOLUTEUP,c),p.direction="up"}p.point=new MathEx.Point(u,h),this._data.push(p),this._textCache.push({})}}}}}}},BackgroundRenderer.prototype.draw=function(e){},BackgroundRenderer.prototype.drawBackground=function(e){var t=this._data;clearRect(e,t.x1,t.y1,t.x2-t.x1,t.y2-t.y1,generateColor(this._data.color,this._data.transparency))},BackgroundRenderer.prototype.hitTest=function(e){return null},TradingView.Study.StudyPaneView_backgrounds=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_backgrounds.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_backgrounds.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new BackgroundRenderer(this._data[t]));return e},TradingView.Study.StudyPaneView_backgrounds.prototype._hideExtendedHours=function(e){return"inSession"===e||"outOfSession"===e?!this.D1._series.properties().extendedHours.value():!1},TradingView.Study.StudyPaneView_backgrounds.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().backgrounds;if(e){var t=this.D0.timeScale(),i=this.D1.priceScale();if(i&&!i.isEmpty()&&t&&!t.isEmpty())for(var n=this.D1.graphics().indexes,o=this.D0.timeScale().visibleBars(),r=o.firstBar(),o=o.lastBar(),s=0;s<e.length;s++){var a=e[s],l=a.styleId,a=a.data,d=this.D1.properties().graphics.backgrounds[l];if(!this._hideExtendedHours(l)&&d.visible.value())for(var h,c,l=0;l<a.length;l++){var p=a[l],u={},f=n[p.start],g=n[p.stop];if(!(r>g||f>o)&&null!=p.start&&null!=p.stop){var p=Math.ceil(t.indexToCoordinate(f,!0)-.5*t.barSpacing()),m=Math.ceil(t.indexToCoordinate(g,!0)+.5*t.barSpacing());c==f-1&&(p=h),h=m,c=g,0>p&&0>m||p>t.width()&&m>t.width()||(u.x1=p,u.x2=m,u.y1=0,u.y2=i.height(),u.color=d.color.value(),u.transparency=d.transparency.value(),this._data.push(u))}}}}},TradingView.Study.StudyPaneView_polygons=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_polygons.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_polygons.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new PoligonRenderer(this._data[t],new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_polygons.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().polygons;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=this.D1.firstValue(),o=this.D1.graphics().indexes,r=this.D0.timeScale().visibleBars(),s=r.firstBar(),r=r.lastBar(),a=0;a<e.length;a++){var l=e[a];if(l.data){var d=this.D1.properties().graphics.polygons[l.styleId];if(100!=d.transparency.value())for(var h=0;h<l.data.length;h++){for(var c=l.data[h],p=1/0,u=-(1/0),f=0;c.points&&f<c.points.length;f++)var g=o[c.points[f].index]+(c.points[f].offset||0),p=Math.min(p,g),u=Math.max(u,g);if(!(s>u||p>r)){for(p={},p.points=new List,f=0;c.points&&f<c.points.length;f++)objPoint=c.points[f],x=i.indexToCoordinate(o[objPoint.index]+(objPoint.offset||0)),u=objPoint.level,t.isPercent()&&(u=t.priceRange().convertToPercent(u,n)),y=t.priceToCoordinate(u),u=new MathEx.Point(x,y),u.data=f,p.points.append(u);p.color=d.color.value(),p.backcolor=d.color.value(),p.linewidth=void 0!=d.showBorder&&d.showBorder.value()?1:0,p.linestyle=CanvasEx.LINESTYLE_SOLID,p.filled=!0,p.fillBackground=!0,p.transparency=d.transparency.value(),p.mouseTouchable=d.mouseTouchable.value(),this._data.push(p)}}}}}},TradingView.Study.StudyPaneView_trendchannels=function(e,t){this.D1=e,this.D0=t,this._data=[]},TradingView.Study.StudyPaneView_trendchannels.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_trendchannels.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);for(var e=new CompositeRenderer,t=0;t<this._data.length;t++)e.append(new PoligonRenderer(this._data[t],new HitTestResult(HitTestResult.REGULAR)));return e},TradingView.Study.StudyPaneView_trendchannels.prototype._updateViewInternal=function(){this._data=[];var e=this.D1.graphics().trendchannels;if(e){var t=this.D1.priceScale(),i=this.D1.D0.timeScale();if(t&&!t.isEmpty()&&i&&!i.isEmpty())for(var n=function(e){return t.isPercent()&&(e=t.priceRange().convertToPercent(e,r)),t.priceToCoordinate(e)},o=function(e,t,i,n,o,r){var s=new MathEx.Point(0,0);return n=new MathEx.Point(i,n),o&&(o=e.substract(t),(o=MathEx.intersectRayWithRect(e,e.add(o),s,n))?e=o:t.x=i),r&&(o=t.substract(e),(o=MathEx.intersectRayWithRect(t,t.add(o),s,n))?t=o:t.x=i),[e,t]},r=this.D1.firstValue(),s=this.D1.graphics().indexes,a=this.D0.timeScale().visibleBars(),l=a.firstBar(),a=a.lastBar(),d=0;d<e.length;d++){var h=e[d];if(h.data)for(var c=this.D1.properties().graphics.trendchannels[h.styleId],p=0;p<h.data.length;p++){var u=h.data[p],f=s[u.startIndex],g=s[u.endIndex];if(!(Math.max(f,g)<l&&!u.extendRight||Math.min(f,g)>a&&!u.extendLeft)){var m=n(u.startHighPrice,t,r),_=n(u.startLowPrice,t,r),v=n(u.endHighPrice,t,r),y=v-(m-_),f=i.indexToCoordinate(f),g=i.indexToCoordinate(g),m=new MathEx.Point(f,m),_=new MathEx.Point(f,_),v=new MathEx.Point(g,v),y=new MathEx.Point(g,y),v=o(m,v,i.width(),t.height(),u.extendLeft,u.extendRight),y=o(_,y,i.width(),t.height(),u.extendLeft,u.extendRight),m=v[0],v=v[1],_=y[0],y=y[1],g={};g.points=new List,g.points.append(m),g.points.append(_),g.points.append(y),g.points.append(v),g.color=c.color.value(),g.backcolor=c.color.value(),g.linewidth=void 0!=c.borderWidth?c.borderWidth.value():0,g.linestyle=CanvasEx.LINESTYLE_SOLID,g.filled=!0,g.fillBackground=!0,u.transparency?(u=u.transparency+c.transparency.value(),g.transparency=Math.min(u,100)):g.transparency=c.transparency.value(),g.mouseTouchable=!0,this._data.push(g)}}}}},TradingView.Study.StudyPaneView_hhists=function(e,t){this.D1=e,this.D0=t,this._data=[],this._textData=[],this._textRendererCache={}},TradingView.Study.StudyPaneView_hhists.prototype.update=function(){this._invalidated=!0},TradingView.Study.StudyPaneView_hhists.prototype.renderer=function(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);var e,t=new CompositeRenderer;for(e in this._data)t.append(new HorizHistogramRenderer(this._data[e]));for(e=0;e<this._textData.length;e++)t.append(new TextRenderer(this._textData[e],this._textRendererCache,new HitTestResult(HitTestResult.REGULAR)));return t},TradingView.Study.StudyPaneView_hhists.prototype._updateViewInternal=function(){this._data=[],this._textData=[];var e=this.D1.priceScale(),t=this.D0.timeScale();if(e&&!e.isEmpty()&&t&&!t.isEmpty()){var i=this.D1.graphics().hhists;if(i)for(var n=this.D1.graphics().indexes,o=this.D0.timeScale().visibleBars(),r=o.firstBar(),o=o.lastBar(),s=0;s<i.length;s++){var a=i[s],l=this.D1.properties().graphics.hhists[a.styleId];if(l.visible.value()){var d,a=a.dataObj;for(d in a){for(var h=a[d],c=1/0,p=-(1/0),u=h.length;u--;)c=Math.min(c,n[h[u].firstBarTime]),p=Math.max(p,n[h[u].lastBarTime]);r>p||c>o||this._updateDataForRenderers(h,l,e,t,n)}}}}},TradingView.Study.StudyPaneView_hhists.prototype._updateDataForRenderers=function(e,t,i,n,o){for(var r=[],s=this._findMaxRate(e),a=this.D1.firstValue(),l=null,d=null,h=null,c={},p=0;p<e.length;p++){var u=e[p];null===d&&(d=this._findActualRateLength(u.rate)),null===l&&(l=Math.abs(n.indexToCoordinate(o[u.firstBarTime])-n.indexToCoordinate(o[u.lastBarTime])),l=t.percentWidth.value()*l/100,l-=d,l=Math.max(l,0));for(var f,g=!1,m=0;d>m;m++)if(0!=u.rate[m]){if(c[m]=void 0==c[m]?u.rate[m]:c[m]+u.rate[m],i.isPercent())var _=i.priceRange().convertToPercent(u.priceHigh,a),v=i.priceRange().convertToPercent(u.priceLow,a);else _=u.priceHigh,v=u.priceLow;var y={};if(y.y1=i.priceToCoordinate(_)+1,y.y2=i.priceToCoordinate(v)-1,0===p&&(f=y.y2,lastHistHeight=y.y2-y.y1),v=t.location.value(),_=t.direction.value(),v==CanvasEx.HHISTLOC_ABSOLUTE&&_==CanvasEx.HHISTDIR_LEFTTORIGHT)var w=n.indexToCoordinate(o[u.firstBarTime]),b=1,T="left";else if(v==CanvasEx.HHISTLOC_ABSOLUTE&&_==CanvasEx.HHISTDIR_RIGHTTOLEFT)w=n.indexToCoordinate(o[u.lastBarTime]),b=-1,T="right";else if(v==CanvasEx.HHISTLOC_RELATIVE&&_==CanvasEx.HHISTDIR_LEFTTORIGHT)w=0,b=1,T="left";else{if(v!=CanvasEx.HHISTLOC_RELATIVE||_!=CanvasEx.HHISTDIR_RIGHTTOLEFT)throw Error("Unknown location/direction values: "+v+"/"+_);w=n.width(),b=-1,T="right"}if(y.x1=0==m?w:w+b*(l*u.rate[m-1]/s+d),y.x2=y.x1+l*u.rate[m]/s*b,y.colorBg=t.colors[m].value(),y.transparency=t.transparencies[m].value(),y.blendedColor=generateColor(y.colorBg,y.transparency),y.x0=w,r.push(y),h||(h=.6*(y.y2-y.y1)),!g&&t.showValues.value()&&h>=7.5){var g=!0,S={},v=this.D1.formatter(),C=function(e,t,i){if(i==CanvasEx.HHISTDIR_LEFTTORIGHT)return e+t;if(i==CanvasEx.HHISTDIR_RIGHTTOLEFT)return t+e;throw Error("Unknown direction value: "+i)};S.text="";for(var x=0;d>x;x++)S.text=C(S.text,v.format(u.rate[x]),_),x!=d-1&&(S.text=C(S.text,"x",_));if(S.color=t.valuesColor.value(),S.font="arial",S.fontsize=h,S.horzAlign=T,S.vertAlign="middle",p1=new MathEx.Point(w+3*b,y.y2-.61*(y.y2-y.y1)),S.points=(new List).append(p1),S.offsetX=0,S.offsetY=0,this._textData.push(S),p===e.length-1){for(y=w+3*b,x=f+.39*lastHistHeight,y={text:"",color:TradingView.shiftColor(t.valuesColor.value(),1.5),font:"arial",fontsize:h,horzAlign:T,vertAlign:"middle",points:(new List).append(new MathEx.Point(y,x)),offsetX:0,offsetY:0},x=0;d>x;x++)y.text=C(y.text,v.format(c[x]),_),x!=d-1&&(y.text=C(y.text,"x",_));this._textData.push(y)}}}}0<r.length&&this._data.push(r)},TradingView.Study.StudyPaneView_hhists.prototype._findMaxRate=function(e){for(var t=0,i=0,n=0;n<e.length;n++){for(var o=i=0;o<e[n].rate.length;o++)i+=e[n].rate[o];t=Math.max(t,i)}return t},TradingView.Study.StudyPaneView_hhists.prototype._findActualRateLength=function(e){for(var t=0,i=0;i<e.length;++i){var n=e[i];if(null===n||void 0===n)break;t++}return t},HorizHistogramRenderer.prototype.hitTest=function(e){var t=searchCoord(this._data,e.y);if(0>t)return null;var i=Math.min(this._data[t].x0,this._data[t].x2),t=Math.max(this._data[t].x0,this._data[t].x2);return i<=e.x&&e.x<=t?new HitTestResult(HitTestResult.REGULAR):null},HorizHistogramRenderer.prototype.draw=function(e){e.save();for(var t={},i=[],n=0;n<this._data.length;n++){var o=this._data[n];t[o.blendedColor]?t[o.blendedColor].push(o):(i.push(o.blendedColor),t[o.blendedColor]=[o])}for(var r=0;r<i.length;r++){for(n=i[r],e.fillStyle=n,e.strokeStyle=n,e.beginPath(),rects=t[n],n=0;n<rects.length;n++)o=rects[n],e.rect(o.x1,o.y1,o.x2-o.x1,o.y2-o.y1);e.stroke(),e.fill()}e.restore()},TradingView.study_ScriptWithDataOffset=function(e,t,i,n){TradingView.Study.call(this,e,t,i,n)},inherit(TradingView.study_ScriptWithDataOffset,TradingView.Study),TradingView.study_ScriptWithDataOffset.prototype.clearData=function(){TradingView.Study.prototype.clearData.call(this),this._underlyingData=new PlotList(this._plotFields)},TradingView.study_ScriptWithDataOffset.prototype._mergeData=function(e){var t=0===this._underlyingData._length()?null:this._underlyingData._indexAt(0);this._underlyingData.merge(e),t!==this._underlyingData._indexAt(0)&&(this.m_data=new PlotList(this._underlyingData.columns())),this.m_data._start=this._underlyingData._start,this.m_data._end=this._underlyingData._end;var i=this.m_data._length();for(e=i;e<this._underlyingData._length();++e)t=TradingView.merge({},this._underlyingData._valueAt(e)),this.m_data.add(this._underlyingData._indexAt(e),t);this._plotsForStrategyProcessing().forEach(function(e){this._createStrategy(e.strategy,e.strategyIndex,e.targetIndex,i).rebuildData(this.m_data)},this)},TradingView.study_ScriptWithDataOffset.prototype._plotsForStrategyProcessing=function(){var e=["dataoffset"],t=[];return this._metaInfo.plots.forEach(function(i,n){if(-1<e.indexOf(i.type)){var o=null;this._metaInfo.plots.forEach(function(e,t){e.id==i.target&&(o=t)}),assert(o>=0,"target plot not found for strategy plot "+i.id),t.push({strategy:i.type,strategyIndex:n,targetIndex:o})}},this),t},TradingView.study_ScriptWithDataOffset.prototype._createStrategy=function(e,t,i,n){return new TradingView.study_ScriptWithDataOffset["Strategy_"+e](t,i,n)},TradingView.study_ScriptWithDataOffset.Strategy_dataoffset=function(e,t,i){this._strategyPlotIndex=e,this._targetPlotIndex=t,this._startIndex=i},TradingView.study_ScriptWithDataOffset.Strategy_dataoffset.prototype.rebuildData=function(e){for(var t=this._targetPlotIndex+1,i=this._strategyPlotIndex+1,n=null,o=null,r=this._startIndex;r<e._length();++r){var s=e._valueAt(r),a=s[t],l=s[i]?Math.round(s[i]):null;s[t]=null,s[i]=null,!l||l>0||(l=r+l,s={pointIndex:l,value:a},o?o.pointIndex!=s.pointIndex&&(l>=0&&(e._items[l].value[t]=a),l=!1,n&&(l=n.value<=o.value&&o.value<=a||n.value>=o.value&&o.value>=a),l?0<=o.pointIndex&&(e._items[o.pointIndex].value[t]=null):n=o,o=s):o=s)}},TradingView.getDataVendorString=function(e){return e&&"QUANDL"==e.exchange?"Quandl.com":void 0},A20=function(e,t,i){this._options=i||{},this._w=e,this._opener=t,this._addMetric=1,this._addOpened=!1},A20.prototype._interval=function(e){e=$(e.target),e.hasClass("disabled")||(this._w.setInterval(e.data("interval")),this.close())},A20.prototype._quickTitle=function(e){return e?$.t("Remove from favorites"):$.t("Add to favorites")},A20.prototype._onQuick=function(e){var t=$(e.target.parentNode),t=this._w.toggleQuick(t.data("interval"));return $(e.target.parentNode).toggleClass("quicked",t),$(e.target).attr("title",this._quickTitle(t)),!1},A20.prototype._onDelete=function(e){return e=$(e.target.parentNode),this._w.removeInterval(e.data("interval")),this._reopen(),!1},A20.prototype._showControlButtons=function(){return!0},A20.prototype._append=function(e,t){var i=$("<span>").addClass("item").toggleClass("active",t==this._w.getInterval()).toggleClass("quicked",this._w.inQuick(t)).toggleClass("disabled",!IntervalHelper.isAvailable(t)).text(this._w.fullLabel(t)).data("interval",t);this._showControlButtons()&&(this._w.isDefaultInterval(t)||i.prepend($("<span>").addClass("delete").attr("title","Remove custom interval").click(this._onDelete.bind(this))),this._w._options.notShowQuicks||i.prepend($("<span>").addClass("to-quick").attr("title",this._quickTitle(this._w.inQuick(t))).click(this._onQuick.bind(this)))),i.click(this._interval.bind(this)),e.append(i)},A20.prototype._appendAdd=function(e){function t(){var e=parseInt(o.val());1>e&&o.val(1);var t={1:1440,60:24,D:364,W:52,M:12}[this._addMetric];e>t&&o.val(t)}var i=$("<span>").addClass("item-add"),n=$('<span class="item-add-wrap">').appendTo(i),o=$('<input type="text">').addClass("tv-text-input inset minutes").val(1).appendTo(n).TVTicker(),r=$("<span>").addClass("tv-button mins").append($("<span>")).append($("<i>")).appendTo(n),n=$("<span>").addClass("tv-button add").text("add").appendTo(n),s={1:"minutes",60:"hours",D:"days",W:"weeks",M:"months"};r.find("span").text(s[this._addMetric||1]),o.change(t.bind(this));var a=this;TradingView.bindPopupMenu(r,null,{direction:"up",event:"button-popup",addClass:"thin small-font metrics",popupSpacing:~~this._w._options.popupSpacing,onRemove:function(){a._addOpened=!1}}),r.click(function(){a._addOpened=!0,r.trigger("button-popup",[$.map(s,function(e,i){return{title:e.toUpperCase(),active:i==a._addMetric,action:function(){return a._addMetric=i,r.find("span").text(e),t.call(a),!1}}})])}),n.click(function(){runOrGoPro(function(){var e=parseInt(o.val());if(e==e){var t=parseInt(a._addMetric);t==t?a._addInterval(""+e*a._addMetric):a._addInterval(""+e+a._addMetric)}},{feature:"customIntervals"})}),e.append($("<div>").addClass("separator")),e.append(i)},A20.prototype._addInterval=function(e){},A20.prototype._open=function(e,t){e.find(".item, .item-add, .separator").remove();var i=[],n=[],o=[],r=$("<span>").addClass("separator");$.each(t,function(e,t){/^\d*[DWM]$/.test(t)?o.push(t):IntervalHelper.isHour(t)?n.push(t):i.push(t)}.bind(this)),i.length&&i.forEach(function(t){this._append(e,t)}.bind(this)),n.length&&(e.append(r.clone()),n.forEach(function(t){this._append(e,t)}.bind(this))),o.length&&(e.append(r.clone()),o.forEach(function(t){this._append(e,t)}.bind(this))),this._options.onWidget||W77.enabled("charting_library")||this._appendAdd(e)},A20.prototype._reopen=function(){this._open(this._menu,this._w._sorted(this._w._intervals))},A20.prototype.open=function(e){var t=$("<div>").addClass("charts-popup-list intervals-list favored-list").toggleClass("touch",Modernizr.touch),i=this._w.mainButton().offset(),n=this._w.mainButton().outerHeight(),o=i.top+n+parseInt(this._options.popupSpacing||0);t.appendTo(document.body),t.css({top:o,left:i.left}).show(),this._menu=t,this._opener.addClass("active"),this._open(t,e),e=Math.min($("body").height(),$(window).height())-n-o-10,this._setMaxHeight(t,e),setTimeout(function(){t.on("mousedownoutside",function(e){this.close(e)&&t.unbind("mousedownoutside")}.bind(this))}.bind(this),0)},A20.prototype._setMaxHeight=function(e,t){e.height()>=t&&(e.css("max-height",t+"px"),e.width(e.width()+18))},A20.prototype.close=function(e){return e&&$(e.target).parents("span.item-add, .charts-popup-list.metrics").length||e&&$(e.target).hasClass("submenu")&&$(e.target).parents(".intervals-container").length?!1:(this._menu.remove(),$(document.body).off(".interval-menu"),delete this._menu,this._opener.removeClass("active"),!0)},A21=function(e){this._options=$.extend({interval:1},e||{}),this._e=$("<div>").addClass("intervals-container favored-list-container"),this._quick=$("<div>").addClass("quick").appendTo(this._e),this._quicked={},this._main=$("<span>").text(this.shortLabel(this._options.interval)).appendTo(this._quick),this._main.data("interval",this._options.interval),W77.enabled("header_interval_dialog_button")&&this._setIntervalDialogButton(),this._mainSub=$("<span>").addClass("submenu").attr("title",$.t("Time Interval")).append($("<i>")).appendTo(this._e),e&&"string"==typeof e.submenuBtnAddClass&&this._mainSub.addClass(e.submenuBtnAddClass),this._quick.on("click",this._selectInterval.bind(this)),this._mainSub.on("click",this._selectMenu.bind(this)),this._menu=new A20(this,this._mainSub,this._options),this.onResize=new Delegate,A45.intraday.subscribe(this._fullUpdate.bind(this)),A45.supportedResolutions.subscribe(this._fullUpdate.bind(this)),e.interval&&A45.interval.setValue(e.interval),A45.interval.subscribe(this.activateInterval.bind(this),{callWithLast:!0}),TVXWindowEvents.on("intervalwidget-change",this._onChangeInAnotherTab.bind(this)),this._fullUpdate()},A21.prototype.forceUpdate=function(){this._fullUpdate(!0)},A21.prototype._fullUpdate=function(e){this._setupIntervals(e),this._setupQuicks(e),this.reactivateInterval(),this._resize()},A21.prototype._onChangeInAnotherTab=function(){this._fullUpdate(!0)},A21.prototype.isDefaultInterval=function(e){return e in D16.defaultResolutions()},A21.prototype._setupIntervals=function(){this._intervals=$.extend({},D16.defaultResolutions())},A21.prototype._sorted=function(e){if(!Array.isArray(e)){var t=[];$.each(e,function(e){t.push(e)}),e=t}return e.sort(function(e,t){function i(e){var t=IntervalHelper.isDWM(e);return t?{D:1440,W:10080,M:43200}[t.unit]*t.qty:parseInt(e)}return i(e)-i(t)})},A21.prototype.setUpStarredItemsList=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=!0;this._setupQuicks(!1,t)},A21.prototype._setupQuicks=function(e,t){(!this._options.notShowQuicks||t)&&(t=t||{},W77.enabled("star_some_intervals_by_default")&&(t={1:!0,30:!0,60:!0}),this._quicked=TVSettings.getJSON("IntervalWidget.quicks",t,e),this._quicked=this._removeCustomIntervalQuicks(this._quicked)),this._addQuicked(this._quicked)},A21.prototype._removeCustomIntervalQuicks=function(e){var t={};return $.each(e,function(e,i){this.isDefaultInterval(e)&&(t[e]=i)}.bind(this)),t},A21.prototype.element=function(){return this._e},A21.prototype.mainButton=function(){return this._main},A21.prototype._quicks=function(){return this._quick.find("span").slice(0,-1)},A21.prototype.postfix=function(e,t){if(t){var i=" ";switch(e){case"D":i+=$.t("day",{count:t});break;case"W":i+=$.t("week",{count:t});break;case"M":i+=$.t("month",{count:t});break;case"m":i+=$.t("minute",{count:t});break;case"h":i+=$.t("hour",{count:t})}return i}switch(e){case"m":return $.t("minute",{context:"dates"});case"h":return $.t("hour",{context:"dates"});case"D":return $.t("day",{context:"dates"});default:return $.t(e.toUpperCase(),{count:0})}},A21.prototype.readable=function(e,t,i){var n="m",o=IntervalHelper.isDWM(e);if(o&&(e=o.qty,n=o.unit),e=parseInt(e),!e)throw new TypeError("Wrong interval value: "+e);return"m"===n&&IntervalHelper.isHour(e)&&(e=~~(e/60),n="h"),t=t?e:null,""+(i&&1===e&&"m"!=n?"":e)+this.postfix(n,t)},A21.prototype.shortLabel=function(e){return translatedIntervalString(this.readable(e,!1))},A21.prototype.fullLabel=function(e){return this.readable(e,!0)},A21.prototype._addQuicked=function(e){this._quicks().remove(),e=this._sorted(e),$.each(e,function(e,t){var i=$("<span>").data("interval",t).text(this.shortLabel(t)).toggleClass("selected",t==this.getInterval()).toggleClass("disabled",!IntervalHelper.isAvailable(t));this._main.before(i)}.bind(this)),this._resize()},A21.prototype._resize=function(){this.onResize.fire()},A21.prototype.addQuick=function(e){this._quicked[e]=!0,this._addQuicked(this._quicked),this.saveSettings(),this.reactivateInterval()},A21.prototype._quickWithInterval=function(e){var t=null;return this._quicks().each(function(i,n){return n=$(n),e==n.data("interval")?(t=n,!1):void 0}),t},A21.prototype.inQuick=function(e){return null!=this._quickWithInterval(e)},A21.prototype.removeQuick=function(e){this._quickWithInterval(e)&&(this._quickWithInterval(e).remove(),this._resize(),delete this._quicked[e],this.saveSettings(),this.reactivateInterval())},A21.prototype.toggleQuick=function(e){var t=this.inQuick(e);return t?this.removeQuick(e):this.addQuick(e),!t},A21.prototype.hasQuicks=function(){return!!this._quicks().length},A21.prototype.deactivate=function(e){this._quick.find("span").removeClass("selected")},A21.prototype.activateInterval=function(e){this.deactivate(),this.inQuick(e)?this._quickWithInterval(e).addClass("selected"):(this.hasQuicks()&&this._main.addClass("selected"),this._main.text(this.shortLabel(e)),this._main.data("interval",e))},A21.prototype.reactivateInterval=function(){this.activateInterval(this.getInterval())},A21.prototype.getInterval=function(){return A45.interval.value()},A21.prototype.setInterval=function(e){A45.interval.setValue(""+e)},A21.prototype._selectInterval=function(e){e=$(e.target);var t=e.data("interval");this.hasQuicks()||this.getInterval()!=t?e.hasClass("disabled")||this.setInterval(t):this._selectMenu()},A21.prototype._selectMenu=function(e){this._mainSub.hasClass("active")?this._menu.close():this._menu.open(this._sorted(this._intervals))},A21.prototype._setIntervalDialogButton=function(){this._intervalDialogButton=$("<span>").addClass("submenu interval-dialog-button apply-common-tooltip").attr("title",$.t("Open Interval Dialog")).append($("<i>")).appendTo(this._e).click(function(){var e=new ChangeIntervalDialog({callback:function(e){A45.interval.setValue(e)}}).show(),t=$(this);t.addClass("active"),e.on("destroy",function(){t.removeClass("active")})})},A21.prototype.addInterval=function(e){},A21.prototype.removeInterval=function(e){},A21.prototype.saveIntervals=function(){},A21.prototype.saveQuicked=function(){TVSettings.setJSON("IntervalWidget.quicks",this._quicked)},A21.prototype.saveSettings=function(){this.saveQuicked(),this.saveIntervals(),TVXWindowEvents.emit("intervalwidget-change")},A22=function(e){this._fullInvalidation=e?e:A22.UPDATE_CURSOR_ONLY,this._invalidatedPanes={}},A22.UPDATE_CURSOR_ONLY=1,A22.LIGHT_UPDATE=2,A22.FULL_UPDATE=3,A22.prototype.invalidatePane=function(e,t){this._invalidatedPanes[e]=this._invalidatedPanes[e]?Math.max(this._invalidatedPanes[e],t):t},A22.prototype.invalidateAll=function(e){this._fullInvalidation=Math.max(this._fullInvalidation,e)},A22.prototype.fullInvalidation=function(){return this._fullInvalidation},A22.prototype.invalidateForPane=function(e){return this._invalidatedPanes[e]?Math.max(this._invalidatedPanes[e],this._fullInvalidation):this._fullInvalidation},A22.prototype.merge=function(e){this.force=this.force||e.force,this._fullInvalidation=Math.max(this._fullInvalidation,e._fullInvalidation);for(var t in e._invalidatedPanes)this._invalidatedPanes[t]=this._invalidatedPanes[t]?Math.max(this._invalidatedPanes[t],e._invalidatedPanes[t]):e._invalidatedPanes[t]},A22.prototype.exclude=function(e){this._fullInvalidation<=e&&(this._fullInvalidation=0);for(var t in this._invalidatedPanes)this._invalidatedPanes[t]<=e&&(this._invalidatedPanes[t]=0)};var PropertyPagesFactory=function(){function e(e){return e instanceof W47?e instanceof TradingView.LineToolRiskReward?$25:e instanceof TradingView.LineToolRegressionTrend?$24:e instanceof TradingView.LineToolEllipse||e instanceof TradingView.LineToolRotatedRectangle||e instanceof TradingView.LineToolArc?null:e instanceof TradingView.LineToolTrendAngle?$28:e instanceof TradingView.LineToolParallelChannel||e instanceof TradingView.LineToolPolyline||e instanceof TradingView.LineToolText||e instanceof TradingView.LineToolFibWedge||e instanceof TradingView.LineToolBrush?null:e instanceof TradingView.LineToolHorzLine?$11:e instanceof TradingView.LineToolBarsPattern||e instanceof TradingView.LineToolDisjointAngle||e instanceof TradingView.LineToolFlatBottom?null:e instanceof TradingView.LineToolVertLine?$35:e instanceof A63?$43:e instanceof TradingView.LineToolIcon||e instanceof TradingView.LineToolTrading||e instanceof TradingView.LineToolExecution?null:$14:e instanceof TradingView.Study?e instanceof TradingView.study_ElliottWave?$40:e instanceof TradingView.study_Compare?$38:$41:null}function t(e,t){if(e instanceof TradingView.Series||e instanceof A7||e instanceof TradingView.ESDStudyBase)return A85;if(e instanceof TradingView.Study)return e instanceof TradingView.study_PivotPointsHighLow?$45:e instanceof TradingView.study_PivotPointsStandard?$46:e instanceof TradingView.study_ZigZag?$48:e instanceof TradingView.study_Overlay?$44:e instanceof TradingView.study_LinearRegression?$42:"Volume@tv-basicstudies"==e.metaInfo().id?$50:e instanceof TradingView.study_VbPVisible||e instanceof TradingView.study_VbPSessions?StudyVolumeProfilePropertyPage:$47;if(e instanceof W47){if(e instanceof TradingView.LineToolVbPFixed)return $51;if(e instanceof TradingView.LineToolRegressionTrend)return $42;if(e instanceof TradingView.LineToolTrendLine)return $32;if(e instanceof TradingView.LineToolTrendAngle)return $29;if(e instanceof TradingView.LineToolDateRange||e instanceof TradingView.LineToolPriceRange)return A95;if(e instanceof TradingView.LineToolHorzLine||e instanceof TradingView.LineToolHorzRay)return $12;if(e instanceof TradingView.LineToolVertLine)return $36;if(e instanceof TradingView.LineToolPitchfork)return $18;if(e instanceof TradingView.LineToolPitchfan)return $17;if(e instanceof TradingView.LineToolText)return $27;if(e instanceof TradingView.LineToolNote)return LineToolNotePropertyPage;if(e instanceof TradingView.LineToolCallout)return A93;if(e instanceof TradingView.LineToolRectangle||e instanceof TradingView.LineToolRotatedRectangle)return $23;if(e instanceof TradingView.LineToolEllipse)return A98;if(e instanceof TradingView.LineToolArc)return A87;if(e instanceof TradingView.LineToolTriangle)return $34;if(e instanceof TradingView.LineToolParallelChannel)return $16;if(e instanceof TradingView.LineToolDisjointAngle)return A96;if(e instanceof TradingView.LineToolFlatBottom)return $7;if(e instanceof TradingView.LineToolArrowMark)return A88;if(e instanceof TradingView.LineToolPriceLabel)return $21;if(e instanceof TradingView.LineToolIcon)return $13;if(e instanceof TradingView.LineToolBalloon)return A89;if(e instanceof TradingView.LineToolBrush)return A92;if(e instanceof TradingView.LineToolPrediction)return $20;if(e instanceof TradingView.LineToolPolyline)return $19;if(e instanceof TradingView.LineToolGannSquare)return $10;if(e instanceof TradingView.LineToolGannComplex)return $8;if(e instanceof TradingView.LineToolGannFan)return $9;if(e instanceof TradingView.LineToolFibRetracement)return $1;if(e instanceof TradingView.LineToolFibChannel)return A99;if(e instanceof TradingView.LineToolFibCircles)return A84;if(e instanceof TradingView.LineToolFibSpiral)return $4;if(e instanceof TradingView.LineToolFibSpeedResistanceArcs)return $2;if(e instanceof TradingView.LineToolTrendBasedFibExtension)return $30;if(e instanceof TradingView.LineToolTrendBasedFibTime)return $31;if(e instanceof TradingView.LineToolFibSpeedResistanceFan)return $3;if(e instanceof TradingView.LineToolFibTimeZone)return $5;if(e instanceof TradingView.LineToolProjection)return $22;if(e instanceof TradingView.LineToolFibWedge)return $6;if(e instanceof TradingView.LineToolCircleLines)return A94;if(e instanceof TradingView.LineToolElliott)return A97;if(e instanceof TradingView.LineToolBarsPattern)return A91;if(e instanceof TradingView.LineToolRiskReward)return $26;if(e instanceof TradingView.LineTool5PointsPattern)return $15;if(e instanceof TradingView.LineToolABCD)return A86;if(e instanceof TradingView.LineToolTrianglePattern)return $33;if(e instanceof TradingView.LineToolThreeDrivers)return A86;if(e instanceof TradingView.LineToolHeadAndShoulders)return $15;if(e instanceof A63)return $47}return null}function i(e){return e instanceof TradingView.ESDStudyBase?null:e instanceof TradingView.Study?$39:null}return{createInputsPropertyPage:function(t,i){var n=e(t);return n?new n(t.properties(),i,t):null},createStylesPropertyPage:function(e,i){var n=t(e);return n?new n(e.properties(),i,e):null},createDisplayPropertyPage:function(e,t){var n=i(e);return n?new n(e.properties(),t,e):null},hasInputsPropertyPage:function(t){return!!e(t)},hasStylesPropertyPage:function(e){return!!t(e)},hasDisplayPropertyPage:function(e){return!!i(e)}}}();PropertyGroup.prototype.property=function(){return this._property},PropertyGroup.prototype.name=function(){return this._name},PropertyGroup.prototype.children=function(){return this._children},PropertyGroup.prototype.propertyPage=function(){return this._propertyPage},D7.prototype.model=function(){return this.D0},D7.prototype.bindControl=function(e){this._bindings.append(e)},D7.prototype.loadData=function(){for(var e=0;e<this._bindings.size();e++){var t=this._bindings.item(e);t.property&&t.setValue(t.property().value())}},D7.prototype.saveData=function(){this.D0.beginUndoMacro();for(var e=0;e<this._bindings.size();e++){var t=this._bindings.item(e);this.D0.setProperty(t.property(),t.value())}this.D0.endUndoMacro()},D7.prototype.createColorPicker=function(){return $(document.createElement("input")).addClass("colorpicker-widget").bind("customcolorchange",function(e,t){TVSettings.setJSON("pickerCustomColors",t)}).tvcolorpicker({customColors:TVSettings.getJSON("pickerCustomColors",[])})},D7.prototype.createTextEditor=function(e,t){var i={};return e&&(i.width=e),t&&(i.height=t),$(document.createElement("textarea")).css(i)},D7.prototype.createCombo=function(e){var t=$(document.createElement("select"));return e=e.reduce(function(e,t){return e.add($(document.createElement("option")).prop({value:t,text:t}))},$()),t.append(e)},D7.prototype.createKeyCombo=function(e){var t=$(document.createElement("select"));return $.each(e||[],function(e,i){$(document.createElement("option")).prop({value:e,text:i}).appendTo(t)}),t},D7.prototype.createFontEditor=function(e){return e=e||factoryDefaults("chartproperties.editorFontsList"),this.createCombo(e);
},D7.prototype.createFontSizeEditor=function(e){return this.createCombo(e||[10,11,12,14,16,20,24,28,32,40]).addClass("tv-select-container-fontsize")},D7.prototype.createSeriesMinTickEditor=function(){var e,t="<select><option value='default'>"+$.t("Default")+"</option>",i=[{priceScale:1,minMove:1,frac:!1},{priceScale:10,minMove:1,frac:!1},{priceScale:100,minMove:1,frac:!1},{priceScale:1e3,minMove:1,frac:!1},{priceScale:1e4,minMove:1,frac:!1},{priceScale:1e5,minMove:1,frac:!1},{priceScale:1e6,minMove:1,frac:!1},{priceScale:2,minMove:1,frac:!0},{priceScale:4,minMove:1,frac:!0},{priceScale:8,minMove:1,frac:!0},{priceScale:16,minMove:1,frac:!0},{priceScale:32,minMove:1,frac:!0},{priceScale:64,minMove:1,frac:!0},{priceScale:128,minMove:1,frac:!0},{priceScale:320,minMove:1,frac:!0}];for(e in i)var n=i[e],t=t+("<option value='"+(n.priceScale+","+n.minMove+","+n.frac)+"'>"+(n.minMove+"/"+n.priceScale)+"</option>");return $(t+"</select>")},D7.prototype.createPrecisionEditor=function(){for(var e="<select><option value='default'>"+$.t("Default")+"</option>",t=0;6>=t;t++)e+="<option value='"+t+"'>"+t+"</option>";return $(e+"</select>")},D7.prototype.createLabeledCell=function(e,t,i){var n=null;"number"==typeof e.valueOf()&&(n=e,e=t,t=i),e+="",i=this._labelToId(e);var o=$("<td>");return $("<label>").html(0<e.length?$.t(e):"").attr("for",i).appendTo(o),n&&o.attr("colspan",n),t&&t.attr("id",i),o},D7.prototype.createTableInTable=function(e){return e=$("<tr>").appendTo(e),e=$("<td>").appendTo(e),$('<table cellpadding="0" cellspacing="0">').appendTo(e)},D7.prototype._labelToId=function(e){return"control"+e.replace(/(^| )\w/g,function(e){return"-"+e.trim().toLowerCase()})+Math.floor(1e3*Math.random())},D7.prototype.addRow=function(e){return $(document.createElement("tr")).appendTo(e)},D7.prototype.addLabeledRow=function(e,t,i,n){var o=t&&0<t.length?$.t(t):"",r=$(document.createElement("tr")),s=$(document.createElement("td")).html(o);return n&&s.attr("colspan",2),i&&(t=this._labelToId(t),i.attr("id",t),s.html('<label for="'+t+'">'+o+"</label>")),r.append(s).appendTo(e)},D7.prototype.addEditorRow=function(e,t,i,n){var o=$(document.createElement("td"));return i.row=this.addLabeledRow(e,t,i,n),i.appendTo(o.appendTo(i.row)),i},D7.prototype.addColorPickerRow=function(e,t){return this.addEditorRow(e,t,this.createColorPicker())},D7.prototype.addOffsetEditorRow=function(e,t){var i=$("<input/>");return i.attr("type","text"),i.css("width","100px"),i.addClass("ticker"),this.addEditorRow(e,t,i)},D7.prototype.addFontEditorRow=function(e,t){return this.addEditorRow(e,t,this.createFontEditor())},D7.prototype.refreshStateControls=function(e,t,i){for(var n=0;n<t.length;n++){var o=t[n],r=e[o.id];r.toggle(this.parseRule(o.visible,t,i)),r.attr("disabled",!this.parseRule(o.visible,t,i))}},D7.prototype.parseRule=function(e,t,i){return e?(e=e.split("=="),2>e.length?!1:i[e[0]].value()==e[1]):!0},D7.prototype.destroy=function(){for(var e=this._bindings.size();e--;)this._bindings.item(e).destroy();this._bindings.clear()},Binding.prototype._attachToControl=function(e,t){var i=this;t?e.on("keyup change input",function(e){e=i.value(),i.setValueToProperty(e),i.setValue(e)}):(e.keypress(function(e){13==e.which&&(e=i.value(),i.setValueToProperty(e),i.setValue(e))}),e.focusout(function(e){e=i.value(),i.setValueToProperty(e),i.setValue(e)}),e.change(function(e){e=i.value(),i.setValueToProperty(e),i.setValue(e)}))},Binding.prototype.control=function(){return this._control},Binding.prototype.setValueToProperty=function(e){this._undoModel.setProperty(this._property,e,this._undoText)},Binding.prototype.property=function(){return this._property},Binding.prototype.propertyChanged=function(e){this.setValue(e.value())},Binding.prototype.destroy=function(){this._property&&this._property.listeners().unsubscribe(this,Binding.prototype.propertyChanged)},inherit(SimpleStringBinder,Binding),SimpleStringBinder.prototype.value=function(){var e=this._control.val();if(this._transformFunction)if(isArray(this._transformFunction))for(var t=0;t<this._transformFunction.length;t++)e=this._transformFunction[t](e);else e=this._transformFunction(e);return e},SimpleStringBinder.prototype.setValue=function(e){this._control.val()!==e&&this._control.val(e)},inherit(D8,Binding),D8.prototype._forEachSubControl=function(e){this._subControlIds.forEach(function(t){t="#"+t,t=this.control().find(t),e.call(this,t)},this)},D8.prototype._parseSessions=function(e){var t=e.split("-",2);return 2!=t.length&&(t=["0","0"]),e=parseInt(t[0]),t=parseInt(t[1]),[Math.floor(e/100),e%100,Math.floor(t/100),t%100]},D8.prototype.value=function(){var e=[];this._forEachSubControl(function(t){e.push(t.val())});var t=function(e,t){return t.forEach(function(t){e=t(e)}),("0"+e).slice(-2)},i=[ToIntTransformer(0),GreateTransformer(0),LessTransformer(23)],n=[ToIntTransformer(0),GreateTransformer(0),LessTransformer(59)];return t(e[0],i)+t(e[1],n)+"-"+t(e[2],i)+t(e[3],n)},D8.prototype.setValue=function(e){var t=this._parseSessions(e);this._forEachSubControl(function(e){var i=e.val(),n=("0"+t[0]).slice(-2);t.shift(),i!==n&&e.val(n)})},inherit(D9,Binding),D9.prototype.value=function(){if(this._disabled)return this._control.attr("disabled",!0),null;var e=this._control.val(),e=this._toIntTransformer(e);0>e&&(e=0);var t=this._mainSeries.bars().size();return e>=t&&(e=t-1),1e3*this._mainSeries.bars()._valueAt(this._mainSeries.bars().lastIndex()-e)[TIME_PLOT]},D9.prototype.setValue=function(e){this._disabled||null==e?this._control.attr("disabled",!0):0>e?(this._control.val(-e),this._property.setValue(this.value())):(e=this._mainSeries.data().timeToBarIndex(e/1e3,SEARCH_FROM_RIGHT),null===e?this._disabled=!0:(e=this._mainSeries.bars().lastIndex()-e,this._control.val()!==e.toString()&&this._control.val(e)))},inherit(D10,Binding),D10.prototype.value=function(){return this._control.val()},D10.prototype.setValue=function(e){var t=this.value();e&&t!==e&&this._control.val(e)},inherit(D11,Binding),D11.prototype.value=function(){var e=this._control.val();return this._transformFunction&&(e=this._transformFunction(e)),e},D11.prototype.setValue=function(e){if(this._control.val(e),this._control.selectbox)try{var t=this._control.find("[value='"+e+"']");if(0<t.length){var i=t[0];this._control.selectbox("change",i.value,i.text)}}catch(n){}},inherit(StaticContentBinder,Binding),StaticContentBinder.prototype.value=function(){return this._property.value()},StaticContentBinder.prototype.setValue=function(e){return this._control.html(e)},inherit(D12,Binding),D12.prototype.value=function(){return this.control().is(":checked")},D12.prototype.setValue=function(e){if(this.control().is(".visibility-switch")){var t={opacity:e?1:.5},i=e?"enable":"disable",n=this.control().data("hides");if(n)n.closest("td").css(t);else{var o=this.control();o.parent().parent().data("visible",e).find("td").filter(function(){var e=$(this);return!e.find("label").length&&e.find(":checkbox").attr("id")!==o.attr("id")}).each(function(){var n=$(this);n.children().each(function(){var o=$(this);o.is(".ui-slider")?o.slider(i):(o.is("select")?o.selectbox(i):o.is(".custom-select")?o.data(i)():o.prop("disabled",!e),n.css(t))})})}}return this.control().attr("checked",!!e)},inherit(DisabledBinder,Binding),DisabledBinder.prototype.value=function(){return this.control().is(":disabled")},DisabledBinder.prototype.setValue=function(e){return this.control().attr("disabled",!!e)},D12.PushButtonBinder=function(e,t,i,n,o){Binding.call(this,e,t,i,n,o);var r=this;i&&e.click(function(){var e=$(this).toggleClass("active").hasClass("active");r.setValueToProperty(e)})},inherit(D12.PushButtonBinder,Binding),D12.PushButtonBinder.prototype.value=function(){return this.control().hasClass("active")},D12.PushButtonBinder.prototype.setValue=function(e){return this.control().toggleClass("active",!!e)},inherit(D14,Binding),D14.prototype.onActionCallback=function(e){this._undoModel.setProperty(this._property,this.value(),this._undoText)},D14.prototype.value=function(){return this.control().checked},D14.prototype.setValue=function(e){return this.control().checked=!!e},inherit(ColorBinding,Binding),ColorBinding.prototype.value=function(){return this._control.val()},ColorBinding.prototype.setValue=function(e){this._control.val(e),this._control.change(),this._control.color&&this._control.color.fromString(e)},TradingView.ToggleButtonBinding=function(e,t){t.toggle(e.checked),t.content().click(function(){e.setChecked(t.toggled()),e.callbacks().fire(e)})},inherit(SliderBinder,Binding),SliderBinder.prototype.value=function(){return this._control.slider("option","value")},SliderBinder.prototype.setValue=function(e){this._control.slider("option","value",e)},inherit(D15,D12),D15.prototype.onIntervalChanged=function(){1440>+this._intervalProperty.value()?this._control.attr({disabled:!1,checked:!!this._property.value()}):this._control.attr({disabled:!0,checked:!1})},D15.prototype.value=function(){return this._control.is(":disabled")?this._property.value():D12.prototype.value.call(this)},D15.prototype.setValue=function(e){return this._control.is(":disabled")?void 0:D12.prototype.setValue.call(this,e)},D15.prototype.destroy=function(){this._intervalProperty.listeners().unsubscribe(this,this.onIntervalChanged),delete this._intervalProperty,D12.prototype.destroy.call(this,arguments)},WVBinding.prototype._attachToControl=function(e){var t=this;this._wv.subscribe(this.setValue.bind(this),{callWithLast:!0}),$(this._control).on("change",function(){t.setValueToProperty(t.value())})},WVBinding.prototype.control=function(){return this._control},WVBinding.prototype.value=function(){var e=$(this._control).val();return this._transformFunction&&(e=this._transformFunction(e)),e},WVBinding.prototype.setValue=function(e){$(this._control).val(e)},WVBinding.prototype.setValueToProperty=function(e){A77.setWatchedValue(this._wv,e,this._undoText)},WVBinding.prototype.watchedValue=function(){return this._wv},WVBinding.prototype.destroy=function(){this._wv.destroy()},inherit(CheckboxWVBinding,WVBinding),CheckboxWVBinding.prototype._attachToControl=function(e){var t=this;this._wv.subscribe(this.setValue.bind(this),{callWithLast:!0}),$(this._control).on("click",function(){t.setValueToProperty(t.value())})},CheckboxWVBinding.prototype.value=function(){var e=$(this._control).attr("checked");return this._not&&(e=!e),this._transformFunction&&(e=this._transformFunction(e)),e},CheckboxWVBinding.prototype.setValue=function(e){this._not&&(e=!e),$(this._control).attr("checked",!!e)},inherit(SeriesStylePropertyPageMixin,D7),SeriesStylePropertyPageMixin.prototype.getInputTitle=function(e,t){return t.inputInfo?t.inputInfo[e].name.value():e.toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})},SeriesStylePropertyPageMixin.prototype.prepareLayoutImpl=function(e,t,i,n){n=n||{};for(var o={},r=this,s=0;s<e.inputs.length;s++){var a=e.inputs[s],l=a.id,d=this.getInputTitle(l,i),h=$("<tr/>");h.appendTo(t);var c=$("<td/>");c.appendTo(h),c.addClass("propertypage-name-label"),c.text(d);var p=$("<td"+(n.valueColspan?' colspan = "'+n.valueColspan+'"':"")+"/>");if(p.appendTo(h),c=null,a.options)for(var c=$("<select/>"),u=0;u<a.options.length;u++){var f=a.options[u];$("<option value='"+f+"'>"+f+"</option>").appendTo(c)}else c=$("<input/>"),"bool"===a.type?c.attr("type","checkbox"):c.attr("type","text");c.appendTo(p),c.css("width","100px"),d="Change "+d,a.options?this.bindControl(new D11(c,i.inputs[l],null,!0,this.model(),d)):"integer"===a.type?(transformers=[ToIntTransformer(a.defval)],a.min&&transformers.push(GreateTransformer(a.min)),a.max&&transformers.push(LessTransformer(a.max)),this.bindControl(new SimpleStringBinder(c,i.inputs[l],transformers,!1,this.model(),d)),c.addClass("ticker")):"float"===a.type?(transformers=[ToFloatTransformer(a.defval)],a.min&&(p=void 0,(("BarSetRenko@tv-prostudies"==e.id||"BarSetPnF@tv-prostudies"==e.id)&&"boxSize"==a.id||"BarSetKagi@tv-prostudies"==e.id&&"reversalAmount"==a.id)&&(p=this.D0.model().mainSeries().symbolInfo(),p=p.minmov/p.pricescale),transformers.push(GreateTransformer(p?p:a.min))),a.max&&transformers.push(LessTransformer(a.max)),this.bindControl(new SimpleStringBinder(c,i.inputs[l],transformers,!1,this.model(),d)),c.addClass("ticker")):"text"===a.type&&this.bindControl(new SimpleStringBinder(c,this._property.inputs[l],null,!1,this.model(),d)),c.change(function(t){r.refreshStateControls(o,e.inputs,i.inputs)}),o[a.id]=h}this.refreshStateControls(o,e.inputs,i.inputs)},SeriesStylePropertyPageMixin.prototype.getMetaInfo=function(e){for(var t=this.D0.m_model._studiesMetaData,i=0;i<t.size();i++)if(t.item(i).id===e)return t.item(i);return null},SeriesStylePropertyPageMixin.prototype._prepareSeriesStyleLayout=function(e,t,i,n){var o=$("<tbody>").appendTo(e),r=this._candlesColorerTbody=$("<tbody>").appendTo(t),s=this._barsColorerTbody=$("<tbody>").appendTo(t),a=this._haColorerTbody=$("<tbody>").appendTo(t),l=this._candlesTbody=$("<tbody>").appendTo(i),d=this._hollowCandlesTbody=$("<tbody>").appendTo(i),h=this._haTbody=$("<tbody>").appendTo(i),c=this._barsTbody=$("<tbody>").appendTo(i),p=this._lineTbody=$("<tbody>").appendTo(i);t=this._areaTbody=$("<tbody>").appendTo(i);var u=this._renkoTbody=$("<tbody>").appendTo(i),f=this._pbTbody=$("<tbody>").appendTo(i);e=this._kagiTbody=$("<tbody>").appendTo(i),i=this._pnfTbody=$("<tbody>").appendTo(i);var o=this.addLabeledRow(o,"Style"),g=$(document.createElement("td")).appendTo(o);g.addClass("property-wide-select"),o=$(document.createElement("select")),$("<option value="+TradingView.Series.STYLE_BARS+">"+$.t("Bars")+"</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_CANDLES+">"+$.t("Candles")+"</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_HOLLOW_CANDLES+">"+$.t("Hollow Candles")+"</option>").appendTo(o),this instanceof $44||$("<option value="+TradingView.Series.STYLE_HEIKEN_ASHI+">"+$.t("Heiken Ashi")+"</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_LINE+">"+$.t("Line")+"</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_AREA+">"+$.t("Area")+"</option>").appendTo(o),o.css("width","100px").appendTo(g),this.switchStyle(),this.bindControl(new D11(o,n.style,parseInt,!0,this.model(),"Change Series Style",function(e){this._undoModel.setChartStyleProperty(this._property,e,this._undoText)})),n.style.listeners().subscribe(this,this.switchStyle);var g=this.createColorPicker(),m=this.createColorPicker(),_=this.createColorPicker(),v=this.createColorPicker(),y=this.createColorPicker(),w=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(v).add(y)),b=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(_)),T=$("<input type='checkbox'/>"),r=this.addLabeledRow(r,"Color bars based on previous close",T);$("<td>").append(T).prependTo(r),r=this.addLabeledRow(l,"Candles"),$("<td>").prependTo(r),$("<td>").append(g).appendTo(r),$("<td>").append(m).appendTo(r),r=this.addLabeledRow(l,"Borders",w),$("<td>").append(w).prependTo(r),$("<td>").append(v).appendTo(r),$("<td>").append(y).appendTo(r),r=this.addLabeledRow(l,"Wick",b),$("<td>").append(b).prependTo(r),$("<td>").append(_).appendTo(r),this.bindControl(new ColorBinding(g,n.candleStyle.upColor,!0,this.model(),"Change Candle Up Color")),this.bindControl(new ColorBinding(m,n.candleStyle.downColor,!0,this.model(),"Change Candle Down Color")),this.bindControl(new D12(b,n.candleStyle.drawWick,!0,this.model(),"Change Candle Wick Visibility")),this.bindControl(new ColorBinding(_,n.candleStyle.wickColor,!0,this.model(),"Change Candle Wick Color")),this.bindControl(new D12(w,n.candleStyle.drawBorder,!0,this.model(),"Change Candle Border Visibility")),this.bindControl(new ColorBinding(v,n.candleStyle.borderUpColor,!0,this.model(),"Change Candle Up Border Color")),this.bindControl(new ColorBinding(y,n.candleStyle.borderDownColor,!0,this.model(),"Change Candle Down Border Color")),this.bindControl(new D12(T,n.candleStyle.barColorsOnPrevClose,!0,this.model(),"Change Color Bars Based On Previous Close")),l=this.createColorPicker(),g=this.createColorPicker(),m=this.createColorPicker(),_=this.createColorPicker(),v=this.createColorPicker(),y=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(_).add(v)),w=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(m)),r=this.addLabeledRow(d,"Candles"),$("<td>").prependTo(r),$("<td>").append(l).appendTo(r),$("<td>").append(g).appendTo(r),r=this.addLabeledRow(d,"Borders",y),$("<td>").append(y).prependTo(r),$("<td>").append(_).appendTo(r),$("<td>").append(v).appendTo(r),r=this.addLabeledRow(d,"Wick",w),$("<td>").append(w).prependTo(r),$("<td>").append(m).appendTo(r),this.bindControl(new ColorBinding(l,n.hollowCandleStyle.upColor,!0,this.model(),"Change Hollow Candle Up Color")),this.bindControl(new ColorBinding(g,n.hollowCandleStyle.downColor,!0,this.model(),"Change Hollow Candle Down Color")),this.bindControl(new D12(w,n.hollowCandleStyle.drawWick,!0,this.model(),"Change Hollow Candle Wick Visibility")),this.bindControl(new ColorBinding(m,n.hollowCandleStyle.wickColor,!0,this.model(),"Change Hollow Candle Wick Color")),this.bindControl(new D12(y,n.hollowCandleStyle.drawBorder,!0,this.model(),"Change Hollow Candle Border Visibility")),this.bindControl(new ColorBinding(_,n.hollowCandleStyle.borderUpColor,!0,this.model(),"Change Hollow Candle Up Border Color")),this.bindControl(new ColorBinding(v,n.hollowCandleStyle.borderDownColor,!0,this.model(),"Change Hollow Candle Down Border Color")),d=$("<input type='checkbox'/>"),r=this.addLabeledRow(s,"Color bars based on previous close",d),$("<td>").append(d).prependTo(r),l=$("<input type='checkbox'/>"),r=this.addLabeledRow(s,"HLC Bars",l),$("<td>").append(l).prependTo(r),r=this.addColorPickerRow(c,"Up Color"),s=this.addColorPickerRow(c,"Down Color"),this.bindControl(new ColorBinding(r,n.barStyle.upColor,!0,this.model(),"Change Bar Up Color")),this.bindControl(new ColorBinding(s,n.barStyle.downColor,!0,this.model(),"Change Bar Down Color")),this.bindControl(new D12(d,n.barStyle.barColorsOnPrevClose,!0,this.model(),"Change Color Bars Based On Previous Close")),this.bindControl(new D12(l,n.barStyle.dontDrawOpen,!0,this.model(),"Change HLC Bars")),s=TradingView.createPriceSourceEditor(),r=this.addLabeledRow(p,"Price Source"),$('<td colspan="3">').append(s).appendTo(r),r=this.addLabeledRow(p,"Type"),r=$('<td colspan="3">').appendTo(r),r.addClass("property-wide-select"),c=$(document.createElement("select")),$("<option value="+TradingView.Series.STYLE_LINE_TYPE_SIMPLE+">"+$.t("Simple")+"</option>").appendTo(c),$("<option value="+TradingView.Series.STYLE_LINE_TYPE_MARKERS+">"+$.t("With Markers")+"</option>").appendTo(c),$("<option value="+TradingView.Series.STYLE_LINE_TYPE_STEP+">"+$.t("Step")+"</option>").appendTo(c),c.appendTo(r),r=this.addLabeledRow(p,"Line"),p=this.createColorPicker(),d=TradingView.createLineWidthEditor(),$("<td>").append(p).appendTo(r),$("<td>").append(d).appendTo(r),this.bindControl(new D11(s,n.lineStyle.priceSource,null,!0,this.model(),"Change Price Source")),this.bindControl(new D11(c,n.lineStyle.styleType,parseInt,!0,this.model(),"Change Line Type")),this.bindControl(new ColorBinding(p,n.lineStyle.color,!0,this.model(),"Change Line Color")),this.bindControl(new SliderBinder(d,n.lineStyle.linewidth,!0,this.model(),"Change Line Width")),n.haStyle&&(p=this.createColorPicker(),s=this.createColorPicker(),c=this.createColorPicker(),d=this.createColorPicker(),l=this.createColorPicker(),g=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(d).add(l)),m=$("<input type='checkbox' class='visibility-switch'/>").data("hides",$(c)),_=$("<input type='checkbox'/>"),r=this.addLabeledRow(a,"Color bars based on previous close",_),$("<td>").append(_).prependTo(r),r=this.addLabeledRow(h,"Candles"),$("<td>").prependTo(r),$("<td>").append(p).appendTo(r),$("<td>").append(s).appendTo(r),r=this.addLabeledRow(h,"Borders",g),$("<td>").append(g).prependTo(r),$("<td>").append(d).appendTo(r),$("<td>").append(l).appendTo(r),r=this.addLabeledRow(h,"Wick",m),$("<td>").append(m).prependTo(r),$("<td>").append(c).appendTo(r),this.bindControl(new ColorBinding(p,n.haStyle.upColor,!0,this.model(),"Change Heiken Ashi Up Color")),this.bindControl(new ColorBinding(s,n.haStyle.downColor,!0,this.model(),"Change Heiken Ashi Down Color")),this.bindControl(new D12(m,n.haStyle.drawWick,!0,this.model(),"Change Heiken Ashi Wick Visibility")),this.bindControl(new ColorBinding(c,n.haStyle.wickColor,!0,this.model(),"Change Heiken Ashi Wick Color")),this.bindControl(new D12(g,n.haStyle.drawBorder,!0,this.model(),"Change Heiken Ashi Border Visibility")),this.bindControl(new ColorBinding(d,n.haStyle.borderUpColor,!0,this.model(),"Change Heiken Ashi Up Border Color")),this.bindControl(new ColorBinding(l,n.haStyle.borderDownColor,!0,this.model(),"Change Heiken Ashi Down Border Color")),this.bindControl(new D12(_,n.haStyle.barColorsOnPrevClose,!0,this.model(),"Change Color Bars Based On Previous Close"))),this instanceof $44||W77.enabled("charting_library")||($("<option value="+TradingView.Series.STYLE_RENKO+">Renko</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_PB+">Line break</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_KAGI+">Kagi</option>").appendTo(o),$("<option value="+TradingView.Series.STYLE_PNF+">Point & Figure</option>").appendTo(o),a=this.createColorPicker(),h=this.createColorPicker(),r=this.addLabeledRow(u,"Up bars"),$('<td class="some-colorpicker">').append(a).append(h).appendTo(r),o=this.createColorPicker(),p=this.createColorPicker(),r=this.addLabeledRow(u,"Down bars"),$('<td class="some-colorpicker">').append(o).append(p).appendTo(r),s=this.createColorPicker(),c=this.createColorPicker(),r=this.addLabeledRow(u,"Projection up bars"),$('<td class="some-colorpicker">').append(s).append(c).appendTo(r),d=this.createColorPicker(),l=this.createColorPicker(),r=this.addLabeledRow(u,"Projection down bars"),$('<td class="some-colorpicker">').append(d).append(l).appendTo(r),this.prepareLayoutImpl(this.getMetaInfo("BarSetRenko@tv-prostudies"),u,n.renkoStyle),this.bindControl(new ColorBinding(a,n.renkoStyle.upColor,!0,this.model(),"Change Bar Up Color")),this.bindControl(new ColorBinding(o,n.renkoStyle.downColor,!0,this.model(),"Change Bar Down Color")),this.bindControl(new ColorBinding(s,n.renkoStyle.upColorProjection,!0,this.model(),"Change Projection Bar Up Color")),this.bindControl(new ColorBinding(d,n.renkoStyle.downColorProjection,!0,this.model(),"Change Projection Bar Down Color")),this.bindControl(new ColorBinding(h,n.renkoStyle.borderUpColor,!0,this.model(),"Change Border Bar Up Color")),this.bindControl(new ColorBinding(p,n.renkoStyle.borderDownColor,!0,this.model(),"Change Border Bar Down Color")),this.bindControl(new ColorBinding(c,n.renkoStyle.borderUpColorProjection,!0,this.model(),"Change Projection Border Bar Up Color")),this.bindControl(new ColorBinding(l,n.renkoStyle.borderDownColorProjection,!0,this.model(),"Change Projection Border Bar Down Color")),u=this.createColorPicker(),a=this.createColorPicker(),r=this.addLabeledRow(f,"Up bars"),$('<td class="some-colorpicker">').append(u).append(a).appendTo(r),h=this.createColorPicker(),o=this.createColorPicker(),r=this.addLabeledRow(f,"Down bars"),$('<td class="some-colorpicker">').append(h).append(o).appendTo(r),p=this.createColorPicker(),s=this.createColorPicker(),r=this.addLabeledRow(f,"Projection up bars"),$('<td class="some-colorpicker">').append(p).append(s).appendTo(r),c=this.createColorPicker(),d=this.createColorPicker(),r=this.addLabeledRow(f,"Projection down bars"),$('<td class="some-colorpicker">').append(c).append(d).appendTo(r),this.prepareLayoutImpl(this.getMetaInfo("BarSetPriceBreak@tv-prostudies"),f,n.pbStyle,{valueColspan:2}),this.bindControl(new ColorBinding(u,n.pbStyle.upColor,!0,this.model(),"Change Bar Up Color")),this.bindControl(new ColorBinding(h,n.pbStyle.downColor,!0,this.model(),"Change Bar Down Color")),this.bindControl(new ColorBinding(p,n.pbStyle.upColorProjection,!0,this.model(),"Change Projection Bar Up Color")),this.bindControl(new ColorBinding(c,n.pbStyle.downColorProjection,!0,this.model(),"Change Projection Bar Down Color")),this.bindControl(new ColorBinding(a,n.pbStyle.borderUpColor,!0,this.model(),"Change Border Bar Up Color")),this.bindControl(new ColorBinding(o,n.pbStyle.borderDownColor,!0,this.model(),"Change Border Bar Down Color")),this.bindControl(new ColorBinding(s,n.pbStyle.borderUpColorProjection,!0,this.model(),"Change Projection Border Bar Up Color")),this.bindControl(new ColorBinding(d,n.pbStyle.borderDownColorProjection,!0,this.model(),"Change Projection Border Bar Down Color")),f=this.addColorPickerRow(e,"Up bars"),r=this.addColorPickerRow(e,"Down bars"),u=this.addColorPickerRow(e,"Projection up bars"),a=this.addColorPickerRow(e,"Projection down bars"),this.prepareLayoutImpl(this.getMetaInfo("BarSetKagi@tv-prostudies"),e,n.kagiStyle),this.bindControl(new ColorBinding(f,n.kagiStyle.upColor,!0,this.model(),"Change Bar Up Color")),this.bindControl(new ColorBinding(r,n.kagiStyle.downColor,!0,this.model(),"Change Bar Down Color")),this.bindControl(new ColorBinding(u,n.kagiStyle.upColorProjection,!0,this.model(),"Change Projection Bar Up Color")),this.bindControl(new ColorBinding(a,n.kagiStyle.downColorProjection,!0,this.model(),"Change Projection Bar Down Color")),e=this.addColorPickerRow(i,"Up bars"),f=this.addColorPickerRow(i,"Down bars"),r=this.addColorPickerRow(i,"Projection up bars"),u=this.addColorPickerRow(i,"Projection down bars"),this.prepareLayoutImpl(this.getMetaInfo("BarSetPnF@tv-prostudies"),i,n.pnfStyle),this.bindControl(new ColorBinding(e,n.pnfStyle.upColor,!0,this.model(),"Change Bar Up Color")),this.bindControl(new ColorBinding(f,n.pnfStyle.downColor,!0,this.model(),"Change Bar Down Color")),this.bindControl(new ColorBinding(r,n.pnfStyle.upColorProjection,!0,this.model(),"Change Projection Bar Up Color")),this.bindControl(new ColorBinding(u,n.pnfStyle.downColorProjection,!0,this.model(),"Change Projection Bar Down Color"))),i=TradingView.createPriceSourceEditor(),r=this.addLabeledRow(t,"Price Source"),$('<td colspan="3">').appendTo(r).append(i),e=this.createColorPicker(),f=TradingView.createLineWidthEditor(),r=this.addLabeledRow(t,"Line"),$("<td>").appendTo(r).append(e),$('<td colspan="2">').appendTo(r).append(f),u=this.createColorPicker(),a=this.createColorPicker(),h=TradingView.createTransparencyEditor(a),r=this.addLabeledRow(t,"Fill"),$("<td>").appendTo(r).append(u),$("<td>").appendTo(r).append(a),$("<td>").appendTo(r).append(h),this.bindControl(new D11(i,n.areaStyle.priceSource,null,!0,this.model(),"Change Price Source")),this.bindControl(new ColorBinding(e,n.areaStyle.linecolor,!0,this.model(),"Change Line Color")),this.bindControl(new SliderBinder(f,n.areaStyle.linewidth,!0,this.model(),"Change Line Width")),this.bindControl(new ColorBinding(u,n.areaStyle.color1,!0,this.model(),"Change Line Color")),this.bindControl(new ColorBinding(a,n.areaStyle.color2,!0,this.model(),"Change Line Color")),this.bindControl(new SliderBinder(h,n.areaStyle.transparency,!0,this.model(),"Change Area Transparency"))},TradingView.LinetoolTemplatesList=function(e,t,i){this._toolName=e,this._applyTemplate=t,this._options=$.extend({saveAsText:"Save As...",applyDefaultText:"Apply Defaults"},i||{}),this._list=[],W77.enabled("charting_library")||(this.templatesDeferred=this.loadData())},TradingView.LinetoolTemplatesList._cache={},TradingView.LinetoolTemplatesList.prototype.getData=function(){return this._list},TradingView.LinetoolTemplatesList.prototype.loadData=function(){var e=this;return this._toolName in TradingView.LinetoolTemplatesList._cache?(this._list=TradingView.LinetoolTemplatesList._cache[this._toolName],$.Deferred().resolve()):$.get("/drawing-templates/"+this._toolName+"/",function(t){e._list=t,TradingView.LinetoolTemplatesList._cache[e._toolName]=t}).error(function(e){console.warn("Failed to load drawing template: "+e.responseText)})},TradingView.LinetoolTemplatesList.prototype.templatesLoaded=function(){return this.templatesDeferred},TradingView.LinetoolTemplatesList.prototype.invalidateToolCache=function(){delete TradingView.LinetoolTemplatesList._cache[this._toolName]},TradingView.LinetoolTemplatesList.prototype.createButton=function(e){var t=this;e=$.extend({},e,t._options);var i=$("<a></span></a>").addClass(e.buttonClass?e.buttonClass:"tv-button").html(e.buttonInner?e.buttonInner:'Template<span class="icon-dropdown">');return TradingView.bindPopupMenu(i,null,{event:"button-popup"}),i.bind("click",function(i){if(i.stopPropagation(),!$(this).is("active")){i=[],"function"==typeof e.getDataForSaveAs&&i.push({title:e.saveAsText,action:function(){runOrSignIn(function(){var i=function(i){var n=JSON.stringify(e.getDataForSaveAs());t.saveTemplate(i,n)}.bind(t);TradingView.showChartNameDialog(i,"Save template as...","Template name",64)})},addClass:"special"}),"function"==typeof e.defaultsCallback&&i.push({title:e.applyDefaultText,action:e.defaultsCallback,addClass:"special"});var n=[];$.each(t._list,function(e,i){n.push({title:i,action:function(){t.loadTemplate.call(t,i)},deleteAction:function(){runOrSignIn(function(){A83.showConfirm("Template","Do you realy want to delete "+(i?'"'+i+'"':"")+" template?",function(){t.removeTemplate.call(t,i)})})}})}),n.length&&(n.sort(function(e,t){return e=e.title.toUpperCase(),t=t.title.toUpperCase(),e==t?0:e>t?1:-1}),i.push({separator:!0}),i=i.concat(n)),$(this).trigger("button-popup",[i])}}),i},TradingView.LinetoolTemplatesList.prototype.loadTemplate=function(e){var t=this;return $.get("/drawing-template/"+this._toolName+"/?templateName="+encodeURIComponent(e),function(e){t._applyTemplate(JSON.parse(e.content))}).error(function(e){console.warn(e.responseText)})},TradingView.LinetoolTemplatesList.prototype.removeTemplate=function(e){e&&($.post("/remove-drawing-template/",{name:e,tool:this._toolName}).error(function(e){console.warn(e.responseText)}),this.invalidateToolCache(),this._list=$.grep(this._list,function(t){return t!=e}))},TradingView.LinetoolTemplatesList.prototype.saveTemplate=function(e,t){var i=this;if(e&&t){e=clean(e);var n=-1!=$.inArray(e,i._list),o=function(){$.post("/save-drawing-template/",{name:e,tool:i._toolName,content:t},function(){n||i._list.push(e)}).error(function(e){console.warn(e.responseText)}),i.invalidateToolCache()};n?A83.showConfirm("Confirm replacing",'Do you realy want to replace "'+e+'"?',o):o()}},TradingView.LinetoolTemplatesList.prototype.deleteAction=function(e){var t=this;runOrSignIn(function(){A83.showConfirm("Template","Do you realy want to delete "+(e?'"'+e+'"':"")+" template?",function(){t.removeTemplate.call(t,e)})})},TradingView.LinetoolTemplatesList.prototype.showSaveDialog=function(e){var t=this;runOrSignIn(function(){TradingView.showChartNameDialog(function(i){var n=JSON.stringify(e.template());t.saveTemplate(i,n)},"Save template as...","Template name",64)})},inherit($49,D7),$49.prototype.applyTemplate=function(e){this._linetool.restoreTemplate(e),this.D0.model().updateSource(this._linetool),this.loadData()},$49.prototype.createTemplateButton=function(e){var t=this;return e=$.extend({},e,{getDataForSaveAs:function(){return t._linetool.template()}.bind(t)}),this._templateList.createButton(e)},$49.prototype.appendTemplateRow=function(e){if(is_authenticated){var t=$(document.createElement("tr"));t.appendTo(e);var i=$(document.createElement("td"));i.attr("colspan",2),i.appendTo(t),t=$('<div class="dialog-theme-buttons"></div>').appendTo(i),this.templateButton=$(this.createTemplateButton()),this.templateButton.appendTo(t),$('<tr><td class="property-page-separator-cell" colspan="6"><div class="property-page-separator"></div></td></tr>').appendTo(e)}},"undefined"!=typeof FlashCanvas&&FlashCanvas.setOptions({disableContextMenu:!0}),TradingView.setCanvasSize=function(e,t){e.width=t.w,e.height=t.h,"undefined"==typeof FlashCanvas&&e.getContext("2d").translate(.5,.5);
},TradingView.addCanvasTo=function(e,t){var i=document.createElement("canvas");return e.append(i),"undefined"!=typeof FlashCanvas&&FlashCanvas.initElement(i),TradingView.setCanvasSize(i,t),i},TradingView.Rect=function(e,t,i,n){this.x=e,this.y=t,this.w=i,this.h=n},A61=function(e,t){this.w=e,this.h=t},A61.prototype.equals=function(e){return this.w===e.w&&this.h===e.h},TradingView.Point=function(e,t){this.x=e,this.y=t},TradingView.setAbsoluteRect=function(e,t){e.css("position","absolute"),e.css("left",t.x+"px"),e.css("top",t.y+"px"),e.width(t.w),e.height(t.h)},TradingView.setAbsolutePos=function(e,t){e.css("position","absolute"),e.css("left",t.x+"px"),e.css("top",t.y+"px")},TradingView.addLocalCoordsToMouseEvent=function(e,t){var i=e.offset();t.localX=t.pageX-i.left,t.localY=t.pageY-i.top},TradingView.processEvent=function(e,t,i,n,o){n&&(o||TradingView.addLocalCoordsToMouseEvent(t,e),n.call(i,e,t))},TradingView.MOUSE_RIGHT_BUTTON=2,TradingView.setMouseEventHandler=function(e,t,i){var n=function(n){e.off("mousemove.chartgui");var o=function(n){(!TradingView.mousePressed||Modernizr.touch)&&(TradingView.processEvent(n,e,t,t.mouseMoveEvent),i&&n.preventDefault())};e.on("mousemove.chartgui",o),Modernizr.touch&&o(n),TradingView.processEvent(n,e,t,t.mouseEnterEvent),i&&n.preventDefault()};e.mouseenter(n);var o=0,r=null,s=function(){window.clearTimeout(r),o=0,r=null},a=0,l=0,d=null,h=function(h){void 0===h.button&&(h.button=0),(Modernizr.touch||h.originalEvent.touches)&&(h.pageX=h.originalEvent.touches[0].pageX,h.pageY=h.originalEvent.touches[0].pageY,h.localX=h.originalEvent.touches[0].pageX,h.localY=h.originalEvent.touches[0].pageY,n(h));var c=function(n){void 0===n.button&&(n.button=0),(Modernizr.touch||n.originalEvent.touches)&&(n.pageX=n.originalEvent.touches[0].pageX,n.pageY=n.originalEvent.touches[0].pageY,n.localX=n.originalEvent.touches[0].pageX,n.localY=n.originalEvent.touches[0].pageY,n.clientX=n.originalEvent.touches[0].pageX,n.clientY=n.originalEvent.touches[0].pageY,a=n.pageX,l=n.pageY,clearTimeout(d)),n.button!==TradingView.MOUSE_RIGHT_BUTTON&&TradingView.processEvent(n,e,t,t.pressedMouseMoveEvent),i&&n.preventDefault()},p=function(n){void 0===n.button&&(n.button=0),(Modernizr.touch||n.originalEvent.touches)&&(n.pageX=a,n.pageY=l,n.localX=a,n.localY=l,clearTimeout(d)),TradingView.mousePressed=!1,$(document.body).off("mousemove.chartgui"),$(document.body).off("mouseup.chartgui"),Modernizr.touch||n.originalEvent.touches?($(document.body).off("touchmove.chartgui"),$(document.body).off("touchend.chartgui"),f(n)):($(document.body).off("mousemove.chartgui touchmove.chartgui"),$(document.body).off("mouseup.chartgui touchend.chartgui")),n.button!==TradingView.MOUSE_RIGHT_BUTTON&&(TradingView.processEvent(n,e,t,t.mouseUpEvent),++o,r&&o>1?(TradingView.processEvent(n,e,t,t.mouseDoubleClickEvent),s()):TradingView.processEvent(n,e,t,t.mouseClickEvent)),i&&n.preventDefault(),Modernizr.touch&&f(n)};if(Modernizr.touch?($(document.body).off("touchmove.chartgui"),$(document.body).off("touchend.chartgui"),$(document.body).on("touchmove.chartgui",c),$(document.body).on("touchend.chartgui",p),d=setTimeout(function(){g(h)},500)):($(document.body).off("mousemove.chartgui touchmove.chartgui"),$(document.body).off("mouseup.chartgui touchend.chartgui"),$(document.body).on("mousemove.chartgui touchmove.chartgui",c),$(document.body).on("mouseup.chartgui touchend.chartgui",p)),TradingView.mousePressed=!0,h.button!==TradingView.MOUSE_RIGHT_BUTTON&&(TradingView.processEvent(h,e,t,t.mouseDownEvent),r||(o=0,r=window.setTimeout(s,500))),i){h.preventDefault();try{window.focus()}catch(u){}}};if(e.on("touchcancel",function(){clearTimeout(d)}),Modernizr.touch)e.on("touchstart.chartgui",h),e.on("touchstartoutside mousedownoutside",function(i){TradingView.processEvent(i,e,t,t.mouseDownOutsideEvent,!0)}),e.on("gesturestart",function(i){TradingView.processEvent(i,e,t,t.gestureStartEvent),clearTimeout(d)}),e.on("gesturechange",function(i){i.scale=i.originalEvent.scale,TradingView.processEvent(i,e,t,t.gestureChangeEvent)}),e.on("gestureend",function(i){TradingView.processEvent(i,e,t,t.gestureEndEvent)});else if(e.on("mousedown.chartgui touchstart.chartgui",h),e.on("touchstartoutside  mousedownoutside",function(i){TradingView.processEvent(i,e,t,t.mouseDownOutsideEvent,!0)}),navigator.msPointerEnabled&&window.MSGesture){var h=new MSGesture,c=!1,p=1,u=e.get(0);h.target=u,u.gesture=h,u.gesture.pointerType=null,u.pointers=[],h.pointerType=null,e.on("pointerdown",function(e){if(e.target===this)if(null===this.gesture.pointerType)this.gesture.target=u,this.gesture.addPointer(e.originalEvent.pointerId),this.gesture.pointerType=e.originalEvent.pointerType;else if(e.originalEvent.pointerType===this.gesture.pointerType)this.gesture.addPointer(e.originalEvent.pointerId);else{var t=new MSGesture;t.target=e.originalEvent.target,e.originalEvent.target.gesture=t,e.originalEvent.target.gesture.pointerType=e.originalEvent.pointerType,e.originalEvent.target.gesture.addPointer(e.originalEvent.pointerId)}}),e.on("MSGestureChange",function(i){i.scale=p*=1*(i.originalEvent.scale-1)+1,c||1===i.originalEvent.scale||(c=!0,TradingView.processEvent(i,e,t,t.gestureStartEvent)),c&&TradingView.processEvent(i,e,t,t.gestureChangeEvent)}),e.on("MSGestureEnd",function(i){c=!1,p=1,TradingView.processEvent(i,e,t,t.gestureEndEvent)})}var f=function(n){e.off("mousemove.chartgui touchmove.chartgui"),TradingView.processEvent(n,e,t,t.mouseLeaveEvent),i&&n.preventDefault()};e.mouseleave(f);var g=function(n){TradingView.processEvent(n,e,t,t.contextMenuEvent),i&&n.preventDefault()};e.contextMenu&&e.contextMenu(g)},TradingView.clientRect=function(e){var t=e.offset(),i=e.width();return e=e.height(),new TradingView.Rect(t.left,t.top,i,e)},TradingView.offsetPosition=function(e){var t=0,i=0;do t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;while(e);return{left:t,top:i}},TradingView.addColorPicker=function(e){var t=$("<input>");return t.appendTo(e),t.tvcolorpicker(),TVSettings&&(t.tvcolorpicker.setCustomColors=TVSettings.setJSON("pickerCustomColors",[]),t.bind("customcolorchange",function(e,t){TVSettings.setJSON("pickerCustomColors",t)})),t},TradingView.createLineStyleEditor=function(){return new HTMLHelper.Combobox([{value:CanvasEx.LINESTYLE_SOLID,html:'<div class="linestyle solidline"/>'},{value:CanvasEx.LINESTYLE_DOTTED,html:'<div class="linestyle dottedline"/>'},{value:CanvasEx.LINESTYLE_DASHED,html:'<div class="linestyle dashedline"/>'}])},TradingView.createShapeLocationEditor=function(){return $('<select><option value="'+CanvasEx.MARKLOC_ABOVEBAR+'">Above Bar</option><option value="'+CanvasEx.MARKLOC_BELOWBAR+'">Below Bar</option><option value="'+CanvasEx.MARKLOC_TOP+'">Top</option><option value="'+CanvasEx.MARKLOC_BOTTOM+'">Bottom</option><option value="'+CanvasEx.MARKLOC_ABSOLUTE+'">Absolute</option></select>')},TradingView.createShapeStyleEditor=function(){for(var e="<select>",t=Object.keys(TradingView.StudyPlotShapes.Data),i=0;i<t.length;++i)var n=TradingView.StudyPlotShapes.Data[t[i]],e=e+('<option value="'+n.id+'">'+n.guiName+"</option>");return $(e+"</select>")},TradingView.createLineWidthEditor=function(){return $('<div class="linewidth-slider">').slider({min:1,max:4,step:1})},TradingView.createVisibilityEditor=function(){return $("<input type='checkbox' class='visibility-switch'/>")},TradingView.createTextEditor=function(){var e=$("<input/>");return e.attr("type","text"),e},TradingView.createTextPosEditor=function(){return new HTMLHelper.Combobox([{value:CanvasEx.TEXTPOS_TOPLEFT,html:"Top Left"},{value:CanvasEx.TEXTPOS_TOPCENTER,html:"Top Center"},{value:CanvasEx.TEXTPOS_TOPRIGHT,html:"Top Right"},{value:CanvasEx.TEXTPOS_MIDDLELEFT,html:"Middle Left"},{value:CanvasEx.TEXTPOS_MIDDLECENTER,html:"Middle Center"},{value:CanvasEx.TEXTPOS_MIDDLERIGHT,html:"Middle Right"},{value:CanvasEx.TEXTPOS_BOTTOMLEFT,html:"Bottom Left"},{value:CanvasEx.TEXTPOS_BOTTOMCENTER,html:"Bottom Center"},{value:CanvasEx.TEXTPOS_BOTTOMRIGHT,html:"Bottom Right"}])},TradingView.createHHistDirectionEditor=function(){var e=$("<select />");return $("<option value='"+CanvasEx.HHISTDIR_LEFTTORIGHT+"'>Left</option>").appendTo(e),$("<option value='"+CanvasEx.HHISTDIR_RIGHTTOLEFT+"'>Right</option>").appendTo(e),e},TradingView.createTransparencyEditor=function(e){var t=$('<div class="transparency-slider"><div class="gradient"></div></div>').slider({min:0,max:100,step:1}),i=["-moz-linear-gradient(left, %COLOR 0%, transparent 100%)","-webkit-gradient(linear, left top, right top, color-stop(0%,%COLOR), color-stop(100%,transparent))","-webkit-linear-gradient(left, %COLOR 0%,transparent 100%)","-o-linear-gradient(left, %COLOR 0%,transparent 100%)","linear-gradient(to right, %COLOR 0%,transparent 100%)"];return t.setColor=function(e){var n=t.find(".gradient");$.browser.msie?n.css("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr='"+e+"', EndColor=0, GradientType=1)"):i.forEach(function(t){n.css("background-image",t.replace(/%COLOR/,e))})},e?(t.setColor(e.val()||"black"),e.on("change",function(e){t.setColor(e.target.value)})):t.setColor("black"),t},TradingView.createPlotEditor=function(){var e=$("<select />");return $("<option value='"+TradingView.StudyConsts.PLOT_LINE+"'>"+$.t("Line")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_LINE_WITH_BREAKS+"'>"+$.t("Line With Breaks")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_HISTOGRAM+"'>"+$.t("Histogram")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_CROSS+"'>"+$.t("Cross",{context:"chart_type"})+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_AREA+"'>"+$.t("Area")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_AREA_WITH_BREAKS+"'>"+$.t("Area With Breaks")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_COLUMNS+"'>"+$.t("Columns")+"</option>").appendTo(e),$("<option value='"+TradingView.StudyConsts.PLOT_CIRCLES+"'>"+$.t("Circles")+"</option>").appendTo(e),e},TradingView.createPriceSourceEditor=function(){var e=$("<select>");return $("<option value='open'>"+$.t("Open")+"</option>").appendTo(e),$("<option value='high'>"+$.t("High")+"</option>").appendTo(e),$("<option value='low'>"+$.t("Low")+"</option>").appendTo(e),$("<option value='close'>"+$.t("Close")+"</option>").appendTo(e),$("<option value='hl2'>"+$.t("(H + L)/2")+"</option>").appendTo(e),$("<option value='hlc3'>"+$.t("(H + L + C)/3")+"</option>").appendTo(e),$("<option value='ohlc4'>"+$.t("(O + H + L + C)/4")+"</option>").appendTo(e),e},TradingView.cacheUrl=function(e){$("<img>").attr("src",e)},TradingView.themeImageHTML=function(e){return"<img src='"+TradingView.themeResourceFullPath(e)+"' style='display:block'/>"},TradingView.animate=function(e,t,i,n,o){var r=n||250,s=$.easing[o]||$.easing.easeOutCubic,a=0,l=Date.now(),d=function(n){n=(n?1e12>n?Date.now():n:Date.now())-l;var o=Math.min(e,s(null,n,0,e,r)),h=o-a;a=o,t(h),n>=r?"function"==typeof i&&i():requestAnimationFrame(d)};requestAnimationFrame(d)},A14=function(e,t,i){return this._options=i=i||{},this._name=e,this._container=$('<div class="favored-list-container" />'),i.addClass&&this._container.addClass(i.addClass),this._quick_container=$('<div class="quick" />').appendTo(this._container),this._submenu=$('<span class="submenu">'+(this._options.submenuHtml||"")+"<i></i></span>").appendTo(this._container),i.tooltip&&(this._submenu.attr("title",i.tooltip),i.addTooltipClass&&this._submenu.addClass(i.addTooltipClass)),this._activeButton=null,this._onChange=new Delegate,this._onSelect=new Delegate,this._onResize=new Delegate,this._onOpen=new Delegate,this._load(t),TradingView.bindPopupMenu(this._container,null,{direction:"down",reverse:!0,addClass:"narrow favored-list"+(i.popupAddClass?" "+i.popupAddClass:""),event:"popup-menu",popupSpacing:i.popupSpacing}),this._submenu.on("click",this._openMenu.bind(this)),$.browser.msie||TVXWindowEvents.on(e+"-change",$.proxy(this,"_onChangeInAnotherTab")),this},A14.prototype._openMenu=function(){this._onOpen.fire(),this._submenu.trigger("popup-menu",[this._data])},A14.prototype._onChangeInAnotherTab=function(){this.reload(this._data)},A14.prototype.reload=function(e){this._quick_container.empty(),this._load(e)},A14.prototype._convertQuicksToData=function(e){return this._quicks.forEach(function(t){var i=!1;e.forEach(function(e){return e.id==t?(i=!0,!1):void 0}),i||e.push({id:t,title:t,favoriteButton:{icon:{},title:t,addClass:"apply-common-tooltip"}})}),e},A14.prototype._load=function(e){var t=this;this._quicks=this._options.showJustDefaultQuicks?this._options.defaultFavorites||[]:this._options.notShowQuicks?[]:TVSettings.getJSON(this._name+".quicks",this._options.defaultFavorites||[],!0),this._list=[],e=this._convertQuicksToData(e),$.grep(e,function(e,t){return!e.separator}).forEach(function(e,i){var n={index:i,data:e,toQuickButton:$('<span class="to-quick" title=""></span>'),toggleFavorite:function(e,i){var o=void 0!==e?e:!this.isFavorite();o?this.markFavorite():this.unmarkFavorite(),t._toggleFavorite(n,o,i)},markFavorite:function(){this.toQuickButton&&this.toQuickButton.attr("title",$.t("Remove from favorites")).addClass("quicked")},unmarkFavorite:function(){this.toQuickButton&&this.toQuickButton.attr("title",$.t("Add to favorites")).removeClass("quicked")},isFavorite:function(){return-1<t._quicks.indexOf(e.id)},active:function(){return this.data.active()},drop:function(){return this.data.drop()}};t._options.notShowQuicks&&$.extend(n,{toQuickButton:null}),n.data.toQuickButtonStyle&&n.toQuickButton&&n.toQuickButton.css(n.data.toQuickButtonStyle),t._list.push(n);var o={action:function(){t._change(n)},buttons:[],active:t._options.notShowActive?function(){return!1}:function(){return t._active&&n===t._active}};t._options.notShowQuicks||o.buttons.push({el:n.toQuickButton,handler:function(e){n.toggleFavorite(),e.preventDefault(),e.stopPropagation()}}),"function"==typeof n.data.drop&&o.buttons.push({el:$('<span class="delete" title="Delete"></span>'),handler:function(e){n.drop(),e.stopPropagation()}}),$.extend(e,o),n.toggleFavorite(n.isFavorite(),!0)}),this._data=e,this._options.notShowActive||this._addActive(this._list[0]),this._onResize.fire()},A14.prototype._toggleFavorite=function(e,t,i){if(!this._options.notShowQuicks||this._options.showJustDefaultQuicks){if(t){e.favorite_button=this._createButton(e,this._quick_container);var n=this._lastFavoriteButton(e);n?e.favorite_button.insertAfter(n.favorite_button):e.favorite_button.prependTo(this._quick_container)}else i||this._removeButton(e);i||(t?-1==this._quicks.indexOf(e.data.id)&&this._quicks.push(e.data.id):-1<this._quicks.indexOf(e.data.id)&&this._quicks.splice(this._quicks.indexOf(e.data.id),1),this._saveFavorite(),this._markActive(),this._onResize.fire())}},A14.prototype._lastFavoriteButton=function(e){for(e=e.index-1;e>=0;e--)if(this._list[e]&&this._list[e].favorite_button)return this._list[e]},A14.prototype._saveFavorite=function(){this._options.notShowQuicks||(TVSettings.setJSON(this._name+".quicks",this._quicks),TVXWindowEvents.emit(this._name+"-change"))},A14.prototype._createButton=function(e){var t=this,i=e.data.favoriteButton,n=$("<span></span>").data("item",e);if(i.addClass&&n.addClass(i.addClass),i.text&&n.text(e.text),i.title&&n.prop("title",i.title),i.icon){var o=$("<i></i>").appendTo(n);i.icon.image&&o.css("background-image",i.icon.image||""),i.icon.offset&&o.css("background-position","string"==typeof i.icon.quickOffset?i.icon.quickOffset:i.icon.quickOffset.x+"px "+i.icon.quickOffset.y+"px")}return n.on("click",function(i){t._change(e),0===t._quicks.length&&t._openMenu(),i.preventDefault()}),n},A14.prototype._removeButton=function(e){e.favorite_button&&(e.favorite_button.remove(),e.favorite_button=null)},A14.prototype._markActive=function(e){if(!this._options.notShowActive){var t,i=this;if(this._active)if(e=this._active,e.isFavorite()){var n=i._quick_container.find(".just_active");this._btnToggleActiveView(n,!1)}else t=this._addActive(e),0!==this._quicks.length&&this._btnToggleActiveView(t,!0);$.map(this._list,function(t){e!==t||0===i._quicks.length?i._btnToggleActiveView(t.favorite_button,!1):t.favorite_button&&i._btnToggleActiveView(e.favorite_button,!0)}),t&&t.hasClass("selected")?this._container.addClass("not-favored-active"):this._container.removeClass("not-favored-active")}},A14.prototype._btnToggleActiveView=function(e,t){if(e){var i,n=e.data("item");n&&n.data&&n.data.icon&&(i=n.data.icon),t?(e.addClass("selected"),i=i.offsetActive?i.offsetActive:null):(e.removeClass("selected"),i=i.offset?i.offset:null),i&&e.children("i").css("background-position","string"==typeof i?i:i.x+"px "+i.y+"px")}},A14.prototype._addActive=function(e){return this._quick_container.find(".just_active").remove(),this._createButton(e).appendTo(this._quick_container).addClass("just_active")},A14.prototype._clearActive=function(){this._quick_container.find(".just_active").remove()},A14.prototype._clearActive=function(){},A14.prototype._setActive=function(e){return this._active===e?!1:(this._active=e,this._markActive(),!0)},A14.prototype._change=function(e){return this._onSelect.fire(e.data.id),this._setActive(e)?void this._onChange.fire(e.data.id):!1},A14.prototype.element=function(){return this._container},A14.prototype._getItemByValue=function(e){for(var t in this._list)if(this._list[t].data.id==e)return this._list[t];throw Error("undefined value "+e+" in FavoredList")},A14.prototype.onChange=function(){return this._onChange},A14.prototype.onSelect=function(){return this._onSelect},A14.prototype.onResize=function(){return this._onResize},A14.prototype.onOpen=function(){return this._onOpen},A14.prototype.setValue=function(e){e=this._getItemByValue(e),this._setActive(e)},A14.prototype.value=function(e){return this._active?this._active.data.value:void 0},A14.prototype.removeById=function(e,t){var i=$.grep(this._data,function(t){return t.id!=e});this._list.forEach(function(t){t.data.id==e&&this._toggleFavorite(t,!1)},this),this.reload(i),"function"==typeof t&&t()},TradingView.bindPopupMenu=function(e,t,i){var n,o;e=$(e),i=i||{},n=(i.event||"click")+".popup-menu",i.hideEvent&&(o=i.hideEvent+".popup-menu");var r=new Function,s=r,a={},l=function(n,o,l){function d(t){t=$(t.target).parents().andSelf(),t.is(p)||t.is(e)||t.is(".charts-popup-tab-headers, .charts-popup-itemheader")||s()}function h(e){e=$(e.target).parents().andSelf(),e.is(".charts-popup-tab-headers, .charts-popup-itemheader")||i.notCloseOnButtons&&e.is(".icon-save, .icon-delete")||s()}function c(t,n,o){if(t instanceof TradingView.bindPopupMenu.TabGroup){if(t.tabs&&t.tabs.length)if(1!==t.tabs.length||t.tabs[0].title){var r=$('<div class="charts-popup-tab-group"></div>').appendTo(o),s=$('<div class="charts-popup-tab-headers"></div>').appendTo(r),a=null;$.each(t.tabs||[],function(e,i){if(i.items&&i.items.length){var n=$('<div class="charts-popup-tab"></div>').hide().appendTo(r);$.each(i.items,function(){c(this,void 0,n)});var o=$('<span class="charts-popup-tab-header">').append($('<a href="javascript://" class="charts-popup-tab-header-label">').text(i.name)).appendTo(s);o.on("click",function(e){o.is(".active")||(s.find(".charts-popup-tab-header.active").removeClass("active"),o.addClass("active"),r.find(".charts-popup-tab").hide(),n.show(),e&&e.preventDefault(),"function"==typeof t.onChange&&t.onChange.call(t,i.name))}),(!a||i.active)&&(a=o,s.find(".charts-popup-tab-header.active").removeClass("active"),o.addClass("active"),r.find(".charts-popup-tab").hide(),n.show())}})}else $.each(t.tabs[0].items,function(){c(this,void 0,o)})}else if(t instanceof TradingView.bindPopupMenu.Group){var l=$('<div class="charts-popup-group"></div>').appendTo(o);t.title&&(n=$('<div class="charts-popup-itemheader"></div>').text(t.title).prepend($('<span class="charts-popup-itemheader-icon"></span>')),t.collapsible&&(l.addClass("charts-popup-group-collapsible"),l.toggleClass("collapsed",t.collapsed),n.on("click",function(){l.toggleClass("collapsed"),"function"==typeof t.onChange&&t.onChange(l.hasClass("collapsed"))})),l.append(n)),$.each(t.items,function(e){c(this,1,l)})}else if(t instanceof TradingView.bindPopupMenu.Header)o.append($('<div class="charts-popup-itemheader"></div>').text(t.title));else if(t.separator){var d=$('<span class="separator"></span>');o.append(d)}else{if(d=$('<a class="item" href="#">'),"function"==typeof t.deleteAction&&"function"==typeof t.saveAction&&d.addClass("item-twobuttons"),t.url&&d.attr("href",t.url),t.target&&d.attr("target",t.target),n||d.addClass("first"),"function"==typeof t.active?t.active(t)&&d.addClass("active"):t.active&&d.addClass("active"),t.addClass&&d.addClass(t.addClass),t.addData&&d.data(t.addData),t.disabled&&d.addClass("disabled"),"function"==typeof t.action){var h=t.action;n=function(e){var i=$(e.target).parents().andSelf();i.is(u)||i.is(g)||(h.apply(d,arguments),!t.url&&e&&"function"==typeof e.preventDefault&&e.preventDefault())},i.upAction?d.bind("mouseup",n):d.bind("click",n)}if(t.date?(n=$('<span class="title"></span>').appendTo(d),$('<span class="date"></span>').text(t.date||"").appendTo(d)):t.icon?(n=$('<span class="icon"></span>').appendTo(d),n.css("background-image",t.icon.image||""),t.icon.offset&&n.css("background-position","string"==typeof t.icon.offset?t.icon.offset:t.icon.offset.x+"px "+t.icon.offset.y+"px"),n=$('<span class="title"></span>').appendTo(d)):n=$('<span class="title-expanded"></span>').appendTo(d),t.html?n.html(t.html):n.text(t.title||""),"function"==typeof t.deleteAction){var p=t.deleteAction;n=t.deleteAction.title||"Delete";var u=$('<span class="icon-delete">');u.attr("title",n),u.on("click",function(e){p.apply(d,arguments),e.preventDefault()}),d.append(u)}if("function"==typeof t.saveAction){var f=t.saveAction;n=t.saveAction.title||"Save";var g=$('<span class="icon-save">');g.attr("title",n),g.on("click",function(e){f.apply(d,arguments),e.preventDefault()}),d.append(g)}t.buttons instanceof Array&&t.buttons.length&&t.buttons.forEach(function(e){e.el instanceof $||(e.el=$(e.el)),e.el.appendTo(d),e.handler&&e.el.on("click",function(t){e.handler.apply(d,arguments)})}),"undefined"!=typeof t.counter&&(n=t.counterBlue?"blue":"",$('<span class="counter"></span>').text(t.counter+"").addClass(n).appendTo(d)),o.append(d),e.data("popup-menu",o)}}if(o=o||t,"function"==typeof o&&(o=o()),$(this).hasClass("open")){if(!l)return;s(),l=a.scrollTop}s=function(){a.scrollTop=p.scrollTop(),p.remove(),e.removeClass("active open"),e.data("popup-menu",null),$(document).off("click",h),$(document).off("mousedown",d),Modernizr.touch&&$(document).off("touchstart.chartgui",d),$(document).off("selectstart.popup-menu"),s=r,i.onRemove&&i.onRemove()},e.addClass("active open");var p=$('<div class="charts-popup-list">');i.addClass&&p.addClass(i.addClass),$.each(o,function(e){c(this,e,p)}),setTimeout(function(){$(document).on("click",h),$(document).on("mousedown",d),Modernizr.touch&&$(document).on("touchstart.chartgui",d)},0),i.upAction&&$(document).on("selectstart.popup-menu",function(){return!1}),p.appendTo(document.body);var u=$(window).width();o=Math.min($(window).height(),$("body").height());var f=e.outerWidth(),g=e.outerHeight(),m=e.offset();l=$(window).scrollTop()||0,m.top-=l;var _=p.outerWidth(),v=p.outerHeight(),y=void 0!=i.viewportSpacing?i.viewportSpacing:10,w=i.popupSpacing?~~i.popupSpacing:1,b=i.popupDrift?~~i.popupDrift:0,T=v-p.height(),S=i.direction?i.direction:"down",C=!!i.reverse;if("down"==S){var x=o-m.top-g-w-y-T,P=m.top-w-y-T;x<Math.max(v||0,100)&&P>x&&(S="up")}switch(S){case"down":case"up":"down"==S?p.css("top",m.top+g+w+"px"):p.css("bottom",o-m.top+w+"px").css("top","auto"),C?(Math.max(m.left+b+f-_,y),p.css("left",Math.max(m.left+b+f-_,y)+"px").css("right","auto")):p.css("left",m.left+b+"px").css("right","auto");break;case"right":case"left":w=Math.max(w,4),"right"==S?p.css("left",Math.floor(m.left+f+w)+"px").css("right","auto"):p.css("left",Math.floor(Math.max(m.left-_-w,y))+"px").css("right","auto"),C?p.css("top",Math.floor(Math.max(m.top+b+g-v,y))+"px"):p.css("top",Math.floor(m.top+b)+"px")}p.show(),"up"==S||{left:1,right:1}[S]&&C?"up"==S?p.css("max-height",m.top-w-y-T+"px"):p.css("max-height",m.top+g-w-y-T+"px"):p.css("max-height",o-m.top-g-w-y-T+"px"),i.careRightBorder&&(u+=$(window).scrollLeft(),parseInt(p.css("left"))+p.width()+y>u&&p.css("left",u-p.width()-y+"px").css("right","auto")),i.careBottomBorder&&parseInt(p.css("top"))+p.height()+y>o+l&&p.css("top",o-p.height()-y+l+"px");var A;for(l=e.parents().andSelf(),o=l.size();o--;)if("fixed"===l.eq(o).css("position")){A=l.eq(o);break}A&&(A=p.offset(),p.css({position:"fixed",left:A.left-$(document).scrollLeft(),right:"auto"})),p[0].scrollHeight>p.height()&&p.addClass("popup-with-scroll"),n&&n.preventDefault()};n&&e.bind(n,l),o&&e.bind(o,function(){s()}),i.runOpened&&l()},TradingView.bindPopupMenu.TabGroup=function e(t){return this instanceof e?(t=t||{},this.tabs=[],void("function"==typeof t.onChange&&(this.onChange=t.onChange))):new e(t)},TradingView.bindPopupMenu.TabGroup.prototype.appendTab=function(e,t,i){if(e=null==e?"":e+"",t||(t=[]),i||(i={}),!Array.isArray(t))throw new TypeError("items must be an array");return this.tabs.push({name:e,items:t,active:!!i.active}),t},TradingView.bindPopupMenu.Header=function t(e){return this instanceof t?void(this.title=e):new t(e)},TradingView.bindPopupMenu.Group=function n(e){return this instanceof n?(e=e||{},this.items=[],this.title=null==e.title?"":e.title+"",this.collapsible=!!e.collapsible,this.collapsed=!!e.collapsed,void("function"==typeof e.onChange&&(this.onChange=e.onChange))):new n(e)},TradingView.bindPopupMenu.Group.prototype.push=function(){this.items.push.apply(this.items,arguments)},TradingView.unbindPopupMenu=function(e){e=$(e),e.unbind(".popup-menu"),e.removeData("popup-menu")},TradingView.showChartNameDialog=function(e,t,i,n,o,r){var s=t?t:$.t("Save New Chart Layout"),a=A83.createDialog(s);if(t=function(){var t=a.find('input[name="name"]'),i=t.val(),n=[];if(o)for(var r=0;r<o.length;r++)if("bool"===o[r].type){var l=a.find('input[name="'+o[r].name+'"]');n.push(l[0].checked)}return i?(e(i,n),A83.destroy(s)):(A83.showError($.t("Please enter chart name"),A83.get(s)),t.focus()),!1},n=n||"",a.css("width","400px"),a.find(".tv-dialog-content").html('<div class="main"><form><p>'+$.t(i?i:"Chart name")+':</p><p class="tv-dialogs-name"><input type="text" name="name" maxlength="'+n+'"/></p><p class="tv-dialog-right"></p></form></div>'),o)for(i=a.find(".tv-dialog-right"),n=0;n<o.length;n++)if("bool"===o[n].type){var l=$('<p class="tv-dialogs-name"></p>'),d=o[n].hint?$('<div class="tv-dialogs-label-hint"></div>').blueTooltip($.t(o[n].hint),"bottom"):null,h=$('<label><input type="checkbox" style="vertical-align:top;margin-top:2px" name="'+o[n].name+'"/> '+$.t(o[n].title)+"</label>");l.append(h,d).insertBefore(i)}a.find("form").submit(t),$('<a class="tv-button wide ok">'+$.t("OK")+"</a>").click(t).css({"margin-right":"5px"}).appendTo(a.find(".tv-dialog-right")),$('<a class="tv-button wide cancel">'+$.t("Cancel")+"</a>").click(function(){A83.destroy(s)}).appendTo(a.find(".tv-dialog-right")),"function"==typeof r&&r(a),A83.positionDialog(a,{left:$(window).width()/2-a.width()/2,top:$(window).height()/2-a.height()/2}),A83.applyHandlers(a),a.find('input[name="name"]').focus()},A1=function(e,t,i){var n=this;this.HIGHLIGHT_STUDY_NUM_FLICKS=2,this._BASIC_STUDIES_PACKAGE_NAME="tv-basicstudies",this._CUSTOM_STUDIES_PACKAGE_NAME="Script$USER",this._PUBLISHED_STUDIES_PACKAGE_NAME="Script$PUB",this._SCRIPTING_PACKAGE_NAME="tv-scripting",this._BASIC_STUDIES_PAGE_NAME=W77.enabled("plain_studymarket")?"Technical Analysis":"Built-ins",this.D5=e,this._chart=e.activeChartWidget.value(),this._options=$.extend({},this.DEFAULT_OPTIONS,i||{}),this.concretizeOptions(),this._studies=this._market=null,this._packagesWithTabNames={},this._user=t,this._favs=[],this._pages={},this._tabs={},this._headers={},this.favsChanged=new Delegate,this.layoutChanged=new Delegate,this.visibilityChanged=new Delegate,this.studiesReady=new $.Deferred,this.marketPagesReady=new $.Deferred,this._pubSearchPage=-1,this._pubSearchEntries=[],this._pubSearchDfd=null,TVXWindowEvents.on("StudyFavoritesChanged",function(e){n._onExternalFavoritesChanged(JSON.parse(e))})},A1.prototype.init=function(){this._initialized||(this.setupMarketInfo(),this.getStudyInfo(),this.setUser(this._user),this.prepareLayout(),this.attachHandlers(),this._initialized=!0)},A1.prototype.DEFAULT_OPTIONS={onWidget:!1,hideMarketPages:!1,selectBasicPage:!0,minimized:!1,searchKeywords:{earning:/EPS/,earnings:/EPS/,"trailing twelve months":/TTM/},popularFundamentals:[{name:"Income Statement",studies:"Script$EDGR_TOTAL_REVENUE@tv-scripting Script$EDGR_DILUTED_EPS_NET_INCOME@tv-scripting Script$EDGR_NET_INCOME@tv-scripting Script$EDGR_EBITDA@tv-scripting Script$EDGR_EBIT@tv-scripting Script$EDGR_EQUITY_EARNINGS@tv-scripting".split(" ")},{name:"Profitability",studies:["Script$EDGR_GROSS_MARGIN@tv-scripting","Script$EDGR_AFTER_TAX_MARGIN@tv-scripting","Script$EDGR_GROSS_PROFIT@tv-scripting"]},{name:"Dividend",studies:["Script$EDGR_DIVIDEND_YIELD@tv-scripting","Script$EDGR_DIVIDENDS_PAID@tv-scripting"]},{name:"Current Valuation",studies:["Script$EDGR_MARKET_CAP@tv-scripting","Script$EDGR_PRICE_EARNINGS_TTM@tv-scripting","Script$EDGR_PRICE_EARNINGS_TO_GROWTH_TTM@tv-scripting","Script$EDGR_PRICE_BOOK_VALUE_PER_SHARE@tv-scripting"]},{name:"Other",studies:["Script$EDGR_DEBT_TO_EQUITY@tv-scripting","Script$EDGR_FREE_CASH_FLOW@tv-scripting","Script$EDGR_RETURN_ON_EQUITY@tv-scripting","Script$EDGR_ACCOUNTING_CHANGE@tv-scripting","Script$EDGR_ACCOUNTS_PAYABLE@tv-scripting"]}]},A1.prototype._FAV_KEY="studyMarket.favorites",A1.prototype._PAGE_KEY="studyMarket.page",A1.prototype._MARKET_TAB_IS_OPEN_KEY="studyMarket.marketTabIsOpen",A1.prototype._TECHNICAL_TAB_IS_OPEN_KEY="studyMarket.technicalTabIsOpen",A1.prototype._ECONOMY_TAB="Economy & Symbols",A1.prototype._FILTER_KEY="studyMarket.filter",A1.prototype.onCustomScriptModified=function(){this._initialized&&(this.getStudyInfo(),this.resetCustomScriptPage(),this.loadFavorites(),this.updateSearchPage())},A1.prototype.onPublishedScriptModified=function(){this._initialized&&(this.getStudyInfo(),this.resetPublishedScriptPage(),this.loadFavorites(),this.updateSearchPage())},A1.prototype.concretizeOptions=function(){(this._options.onWidget||W77.enabled("study_market_minimized"))&&(this._options.hideMarketPages=!0,this._options.selectBasicPage=!0,this._options.minimized=!0)},A1.prototype.setupMarketInfo=function(){this._market={products:pro.getStudies(),order:pro.getStudiesOrder()},this._market.order=$.grep(this._market.order,function(e){return"Script$EOTPRO"!=e}),this.setupSubproductsInfo()},A1.prototype.setupSubproductsInfo=function(){this._subProductIds={};for(var e=Object.keys(this._market.products),t=0;t<e.length;++t){var i=this._market.products[e[t]];if(void 0!=i.subproduct_ids)for(var n=0;n<i.subproduct_ids.length;++n)this._subProductIds[i.subproduct_ids[n]]=i.id}},A1.prototype.getStudyInfo=function(){this._chart.withModel(this,function(){this.setupStudyInfo()})},A1.prototype.setupStudyInfo=function(){var e=this._chart.model().studiesMetaData().toArray();this._studies={},e=e.filter(function(e){return!this.isHidedStudy(e)},this),e.forEach(function(e){var t=this.getStudyPackageName(e);if("Script$EOTPRO"!=t&&(!this._options.minimized||t==this._BASIC_STUDIES_PACKAGE_NAME)){var i=this.resolvePackageName(t);assert(void 0!=i,"Cannot resolve packageName "+t),this._studies[i]||(this._studies[i]=[]),this._studies[i].push(e)}}.bind(this),this),this.studiesReady.resolve()},A1.prototype.resolvePackageName=function(e){return e in this._subProductIds?this._subProductIds[e]:e},A1.prototype.setUser=function(e){is_authenticated?this.setupUserData(e):this.setAnonymous()},A1.prototype.setupUserData=function(e){this._user=e,this.loadFavorites(),this.updateMarketPages()},A1.prototype.setAnonymous=function(){
this.setupUserData(null,[]),this.favsChanged.fire()},A1.prototype.isHidedStudy=function(e){return!!e.is_hidden_study},A1.prototype.loadFavorites=function(){for(var e=TVSettings.getJSON(this._FAV_KEY,[]),t=[],i=0;i<e.length;i++){var n=StudyMetaInfo.cutFullId(e[i]);-1===t.indexOf(n)&&t.push(n)}this._favs=t,this.favsChanged.fire()},A1.prototype.saveFavorites=function(){TVSettings.setJSON(this._FAV_KEY,this._favs)},A1.prototype.prepareLayout=function(){var e=this;this._widget=$('<div class="insert-study-dialog"><div class="insert-study-row insert-study-title tv-dialog-title"><a class="tv-dialog-title-close"></a>'+$.t("Indicators")+'</div><div class="insert-study-row insert-study-body"><div class="insert-study-tabs"><div class="insert-study-tabs-list-container"><ul class="insert-study-tabs-list"></ul></div></div><div class="insert-study-main"><div class="insert-study-headers"></div><div class="insert-study-pages insert-study-row"></div></div></div></div>'),this._w_title=this._widget.find(".insert-study-title"),this._w_tabs_container=this._widget.find(".insert-study-tabs-list-container"),this._w_tabs=this._widget.find(".insert-study-tabs-list"),this._w_pages=this._widget.find(".insert-study-pages"),this._w_pages.onScrollToEnd=new Delegate,this._w_headers=this._widget.find(".insert-study-headers"),this._widget.draggable(A83._constrainDraggableOptionsIfNeeded({handle:".insert-study-title"})).css({position:"absolute",zIndex:17}),this.preparePages(),this._options.minimized&&this._widget.addClass("minimized"),this._w_pages.scroll(function(){var t=$.map(e._w_pages.children(":visible"),function(e){return $(e).outerHeight(!0)}).reduce(function(e,t){return e+t},0),i=e._w_headers.outerHeight(!0),n=e._widget.find(".insert-study-main").height();t>n-i&&t-e._w_pages.scrollTop()===n-i&&e._w_pages.onScrollToEnd.fire()}),this._widget.appendTo("body"),this.hide()},A1.prototype.currentPage=function(){return this._pages[this._currentPageTitle]},A1.prototype.preparePages=function(){this.addSearchPage(),W77.enabled("items_favoriting")&&this.addFavoritesPage(),this.prepareBasicPage(),this._options.minimized||W77.enabled("charting_library")||(this.preparePublishedScriptPage(),this.prepareCustomScriptPage()),this.prepareMarketPages(),this._options.minimized||W77.enabled("charting_library")||(this.prepareFundamentalsPage(),this.studiesReady.done(function(){}.bind(this))),this.addEconomyPage(),this._scroll=new A59(this._w_tabs_container,this._w_tabs,{showBottomShadow:!1})},A1.prototype.addEconomyPage=function(){var e=this.addPage(this._ECONOMY_TAB,{showTitle:!0}),e=$('<div class="economy-page">').appendTo(e);this.addSymbolWidget=new AddSymbolWidget(this.D5),this.addSymbolWidget.show(),e.append(this.addSymbolWidget._widget)},A1.prototype.addFavoritesPage=function(){this.addPage("Favorites",{showTitle:!0}).addClass("page-padded")},A1.prototype.prepareBasicPage=function(){var e=this,t=e.addPage(this._BASIC_STUDIES_PAGE_NAME,{packageName:this._BASIC_STUDIES_PACKAGE_NAME,technical:!W77.enabled("plain_studymarket"),showTitle:!0});this._basicPage=t,t.addClass("page-padded"),e.studiesReady.done(function(){e.resetBasicPage()}),e._options.selectBasicPage&&e.selectPage(this._BASIC_STUDIES_PAGE_NAME)},A1.prototype.prepareCustomScriptPage=function(){var e=this;e.addPage("My Scripts",{packageName:this._CUSTOM_STUDIES_PACKAGE_NAME,technical:!0,showTitle:!0}).addClass("page-padded"),e.studiesReady.done(function(){e.resetCustomScriptPage()})},A1.prototype.preparePublishedScriptPage=function(){var e=this,t=e.addPage("Public Library",{packageName:this._CUSTOM_STUDIES_PACKAGE_NAME,technical:!0,showTitle:!0,titleHref:"/p/",wikiHref:"https://www.tradingview.com/stock-charts-support/index.php/Public_Library"});t.addClass("page-padded"),e.studiesReady.done(function(){e.resetPublishedScriptPage()}),t.on("show-page",function(){e._onPublishedScriptPageShown(t)})},A1.prototype._onPublishedScriptPageShown=function(){0>this._pubSearchPage&&this._pubslishedScriptsLoadMore()},A1.prototype._pubslishedScriptsLoadMore=function(){var e=this;if(!this._pubslishedScriptsLoading){var t=this.getPage("Public Library");$('<div class="loading-indicator-small"></div>').appendTo(t),this._pubslishedScriptsLoading=!0,this._loadNextPubSearchPage().done(function(){e.resetPublishedScriptPage(),e._pubslishedScriptsLoading=!1})}},A1.prototype.resetBasicPage=function(){var e=this.getPage(this._BASIC_STUDIES_PAGE_NAME);this._studies&&studyMarket.preparePageStudies(e,this._studies[this._BASIC_STUDIES_PACKAGE_NAME]||[])},A1.prototype.resetCustomScriptPage=function(){if(!this._options.minimized&&window.scriptLib&&this._studies){var e=this.getPage("My Scripts"),t=this._studies.Script$USER||[],i=$.Deferred();window.scriptLib&&t.length?scriptLib.requestUserScripts(function(e){for(var n=t.length;n--;){var o=t[n].scriptIdPart;if(o){delete t[n].scriptName;for(var r=null,s=e.length;s--;)if(e[s].scriptIdPart===o){r=e[s];break}r?t[n].scriptName=e[s].scriptName:t.splice(n,1)}else t.splice(n,1)}i.resolve(t)}):i.resolve(t),i.done(function(t){t.length?studyMarket.preparePageStudies(e,t):studyMarket.appendTVScriptBtn(e)})}},A1.prototype._createPublishedScriptMetaInfo=function(e){var t=this.D5.activeChartWidget.value(),t=StudyMetaInfo.createMetaInfoStub(e,t.studyScriptingPkgVers),t=new StudyMetaInfo(t);return t.author=e.author,t.scriptName=e.scriptName,t.scriptDescription=e.description,t.agreeCount=e.agreeCount,t.imageUrl=e.imageUrl,t},A1.prototype.resetPublishedScriptPage=function(){if(!this._options.minimized){var e=this,t=this.getPage("Public Library"),i=this._pubSearchEntries.map(function(t){return e._createPublishedScriptMetaInfo(t)});e.preparePageStudies(t,i,null,!0),t=e._pubslishedScriptsLoadMore.bind(e),e._w_pages.onScrollToEnd.unsubscribe(e,t),(void 0===e._pubSearchPageMax||null===e._pubSearchPageMax||0<=e._pubSearchPage&&e._pubSearchPage!==e._pubSearchPageMax)&&e._w_pages.onScrollToEnd.subscribe(e,t)}},A1.prototype.prepareFundamentalsPage=function(e,t){var i=this;e=this.addPage("Fundamentals",{packageName:"Script$EDGR",showTitle:!0}),this.studiesReady.done(function(){function t(){for(var e=[],t=$.map(n,function(e){return e.id}),o=0;o<i._options.popularFundamentals.length;o++){var r=i._options.popularFundamentals[o];r.studies=r.studies.filter(function(e){return-1!=t.indexOf(e)}).map(function(e){return n.filter(function(t){return e===t.id})[0]}),r.studies.length&&e.push(r)}return e}var n=this._studies.Script$EDGR;if("undefined"!==n){var o=e,r=t();if(e.addClass("page-with-popular"),r.length){var o=$("<div></div>"),s=$("<div></div>"),a=$('<div><div class="column column-left"></div><div class="column column-right"></div></div>'),l=a.find(".column-left").css("width","50%"),d=a.find(".column-right").css("width","50%"),h=function(){for(var e=0,t=0;t<r.length;t++)e+=r[t].studies.length;return e}(),c=function(e){var t=$('<div class="insert-study-items"></div>');return i.fillStudies(t,e.studies,null),t.prepend('<div class="subgroup-header">'+e.name+"</div>"),t};for(e.append(s),s.append('<div class="header-container with-divider"><div class="group-header">All Metrics</div></div>'),s.append(o),e.prepend(a),e.append(s),a=s=0;s<r.length;s++){var p=r[s],u=c(p);h/2>a?l.append(u):d.append(u),a+=p.studies.length}}this.preparePageStudies(o,n)}}.bind(this))},A1.prototype.appendTVScriptBtn=function(e){var t=this;if(e){var i=$('<br><a class="add-custom-script-btn"> Create your first script now!</a>').on("click",function(e){t.hide(),scriptEditor.show(),e.stopPropagation()});e.empty(),e.append("<p>Welcome to the TradingView custom scripting engine. It allows you to create your own custom studies or modify existing. You do not have any scripts created.</p>"),e.find("p").append(i)}},A1.prototype.appendPubScriptBtn=function(e){e&&e.html("<p>No public library scripts were found.</p>")},A1.prototype.prepareMarketPages=function(){this._options.hideMarketPages||this.studiesReady.done(function(){var e=this,t=this._market.order.map(function(t){return e._market.products[t]});t.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),t.forEach(function(e){e.$page=this.addPage(e.name,{market:"tv-volumebyprice"!=e.id,packageName:e.id,subProductIds:e.subproduct_ids||[]}),e.$page.addClass("offer-page")},this),this.selectPage(TVSettings.getValue(this._PAGE_KEY,this._basicPage)),this.marketPagesReady.resolve()}.bind(this))},A1.prototype.addSearchPage=function(){var e=this;e._tabs.search=$('<div class="search"><div class="left-border"></div><div class="right-border"></div><input type="text" name="q" value="" autocomplete="off" placeholder="'+$.t("Search")+'"><div></div><a class="input-reset"></a></div>').data("title","search"),e._pages.search=$('<div class="page-search"></div>').data("title","search");var t=e._tabs.search.find("input"),i=e._tabs.search.find(".input-reset");e._search_value=null,e._search_input=t,this._widget.find(".insert-study-tabs").prepend(e._tabs.search),e._w_pages.prepend(e._pages.search),i.on("click",function(){t.val("").trigger("input").focus()}),t.focus(function(){e.search(t.val())});var n;t.on("input",function(){i.toggle(""!==this.value);var t=$(this);n&&clearTimeout(n),n=setTimeout(function(){n=void 0,e.search(t.val())},200)})},A1.prototype.search=function(e,t,i){var n=this;if(this._search_value!==e||t){var o=this._pages.search,r=[];""!==e&&(r.push({re:new RegExp("("+e.split("").map(function(e){return RegExpEscape(e)}).join(")(.*?)(")+")","i"),fuzzyHighlight:!0}),e.toLowerCase()in this.DEFAULT_OPTIONS.searchKeywords&&r.push({re:this.DEFAULT_OPTIONS.searchKeywords[e.toLowerCase()],fuzzyHighlight:!1})),this._search_value=e,o.html("");var s=$.Deferred();n._currentAsyncSearchDfd=s,W77.enabled("plain_studymarket")?s.resolve([]):A56.suggest(e).done(function(e){var t=[];e=e&&e.results||[];for(var i=0;i<e.length;i++)t.push(n._createPublishedScriptMetaInfo(e[i]));s.resolve(t)}).fail(function(){s.resolve([])}),s.done(function(e){if(n._currentAsyncSearchDfd===s){for(var t=Object.keys(n._studies).concat(n._PUBLISHED_STUDIES_PACKAGE_NAME).sort(),i=[n._BASIC_STUDIES_PACKAGE_NAME,n._PUBLISHED_STUDIES_PACKAGE_NAME,n._CUSTOM_STUDIES_PACKAGE_NAME],a=i.length;a--;){var l=i[a],d=t.indexOf(l);-1!==d&&(t.splice(d,1),t.unshift(l))}for(i=0;i<t.length;i++){if(l=t[i],d=[],l===n._PUBLISHED_STUDIES_PACKAGE_NAME)d=e;else for(var h=n._studies[l],a=0;a<h.length;a++){var c=h[a];if(r.length)for(var p=0;p<r.length;p++){var u=r[p].re;u.lastIndex=0,u.test(c.description_localized)&&d.push(c)}else d.push(c)}if(d.length){switch(a=$('<div class="insert-study-items"><div>'),h=l,l){case n._BASIC_STUDIES_PACKAGE_NAME:h=n._BASIC_STUDIES_PAGE_NAME;break;case"Script$USER":h="My Scripts";break;case"Script$PUB":h="Public Library";break;default:l in n._packagesWithTabNames&&(h=n._packagesWithTabNames[h])}o.append('<div class="search-header">'+$.t(h)+"</div>"),o.append(a),n.fillStudies(a,d,r)}}o.is(":has(li)")||o.is(":has(.not-found)")||o.append('<p class="not-found">'+$.t("No indicators matched your criteria.")+"</p>"),n.layoutChanged.fire()}})}i||this.selectPage("search")},A1.prototype.updateSearchPage=function(){var e=this._tabs.search.find("input").val();this.search(e,!0,!0)},A1.prototype.updateMarketPages=function(){$.when(this.marketPagesReady).done(function(){var e;this._market.order.forEach(function(t){e=this._market.products[t],pro.hasPackage(e.id)?(t=this._studies[e.id])?this.preparePageStudies(e.$page,t,e):console.warn("Subscripted study package "+e.id+" absent in metaInfo."):this.preparePageOffer(e.$page,e)},this)}.bind(this))},A1.prototype.preparePageStudies=function(e,t,i,n){var o=$('<div class="insert-study-items"/>');e.empty(),e.append(o),i&&e.find(".insert-study-items").css({width:199,"float":"left"}).end().append('<div class="insert-study-offer-container">'+pro.prepareProductPage(i)+"</div>"),n||(t=this.sortStudies(t)),this.fillStudies(o,t,null)},A1.prototype.preparePageOffer=function(e,t){e.data("html",pro.prepareProductOfferPage(t)),e.data("offer",t)},A1.prototype.addPage=function(e,t){t=$.extend({},t);var i=$.t(e),n=e.toLowerCase(),o=$("<div></div>").data("title",n),r=$('<li title="'+i+'"></li>').text(i).data("title",n),i=$(Mustache.render('<div class="insert-study-header">{{#showTitle}}<div class="header-text">{{#technical}}'+$.t("Technical Analysis")+': {{/technical}}{{#titleHref}}<a href="{{titleHref}}" target="_blank"><u>{{title}}</u></a>{{/titleHref}}{{^titleHref}}{{title}}{{/titleHref}}{{#wikiHref}}<a href="{{wikiHref}}" target="_blank" class="tv-dialogs-label-hint apply-common-tooltip" title="Wiki"></a>{{/wikiHref}}</div>{{/showTitle}}</div>',{showTitle:t.showTitle,title:i,technical:t.technical,titleHref:t.titleHref,wikiHref:t.wikiHref})).data("title",n).appendTo(this._w_headers).hide();return t.beta&&r.append('<span class="beta-sign">Beta</span>'),t.packageName&&(this._packagesWithTabNames[t.packageName]=e),this._pages[n]=o,this._tabs[n]=r,this._headers[n]=i,t.technical?(i=this._getOrCreateTechincalTab().find("ul"),i.append(r)):t.market?(i=this._getOrCreateMarketTab().find("ul"),i.append(r)):this._w_market_tabs?r.insertBefore(this._w_market_tabs):this._w_tabs.append(r),this._w_pages.append(o),o.toggle(n===this._currentPageTitle),o},A1.prototype._getOrCreateMarketTab=function(){if(this._w_market_tabs)return this._w_market_tabs;var e=TVSettings.getBool(this._MARKET_TAB_IS_OPEN_KEY,!0);return this._w_market_tabs=$('<li class="tabs market-tabs"><div class="text open">Marketplace Add-ons</div><ul></ul></li>'),this._w_tabs.append(this._w_market_tabs),this.toggleMarketTabs(e),this._w_market_tabs},A1.prototype._getOrCreateTechincalTab=function(){if(this._w_technical_tabs)return this._w_technical_tabs;var e=TVSettings.getBool(this._TECHNICAL_TAB_IS_OPEN_KEY,!0);return this._w_technical_tabs=$('<li class="tabs technical-tabs"><div class="text open">'+$.t("Technical Analysis")+"</div><ul></ul></li>"),this._w_tabs.append(this._w_technical_tabs),this.toggleTechnicalTabs(e),this._w_technical_tabs},A1.prototype.hide=function(){this._widget.hide(),this.visibilityChanged.fire(!1),TradingView.keyboardBinder.removeListener("StudyMarket");var e=A83.dialogs.indexOf(this._widget);-1!==e&&A83.dialogs.splice(e,1)},A1.prototype.show=function(){this.init(),this._widget.show(),this._widget.css("z-index",A83.dialogs.length+110),this._widget.on("mousedownoutside",function(e){$(e.target).parents().andSelf().is(".colorpicker, .charts-popup-list, .tvcolorpicker-popup, .symbol-edit-popup, .tv-dialog-shadowbox, .fancybox-overlay")||(this._widget.unbind("mousedownoutside"),this.hide())}.bind(this)),this._widget.on("keyup.hideDialogStudy",function(e){"27"==e.which&&(this._widget.unbind("keyup.hideDialogStudy"),this.hide())}.bind(this)),this._clearInput(),this.loadFavorites(),this._scroll.scrollTo(0),this.updateLayout(!0),this.visibilityChanged.fire(!0),this.focusAddSymbolInput(this._currentPageTitle),TradingView.keyboardBinder.registerListener("StudyMarket",function(e){return e.ctrlKey||"47"==e.which?!1:e.which&&13===e.which?(e.target===this._search_input.get(0)&&this._insertStudyByShortDescription(),!0):!e.charCode||!e.which||32>=e.which||/^(input|textarea)$/i.test(e.target.tagName)?!1:(e.preventDefault(),this._search_input.focus(),this._search_input[0].value=String.fromCharCode(e.charCode),!0)}.bind(this)),A83.dialogs.push(this._widget)},A1.prototype.isVisible=function(){return!!this._initialized&&this._widget.is(":visible")},A1.prototype.updateLayout=function(e){var t=this._widget.find(".insert-study-body");t.css("height",""),this._widget.css("width","");var i=A83.calcHeight(this._widget.height(),t.height());t.height(i),A83.resizeContentWidth(this._widget.width(),this._widget),t=this._w_headers.outerHeight(!0),i=this._widget.find(".insert-study-main").height(),this._w_pages.height(i-t);var t=Math.min($(window).height(),$("body").height()),i=$(window).width(),n=this._widget.outerWidth(),o=$("body").hasClass("on-cme-widget")?10:20,r=this._widget.height();e&&this._widget.css({left:Math.max(0,i-n)/2,top:Math.max(o,t-r)/2})},A1.prototype.getPage=function(e){return e=e.toLowerCase(),this._pages[e]},A1.prototype.focusAddSymbolInput=function(e){e==this._ECONOMY_TAB.toLowerCase()&&this.addSymbolWidget.focus()},A1.prototype.selectPage=function(e){this.focusAddSymbolInput(e);var t="";if("string"==typeof e?t=e.toLowerCase():e instanceof $&&(t=e.data("title")),this._currentPageTitle!==t)if(t in this._pages&&t in this._tabs&&("favorites"!=t||this.hasVisibleFavorites())){for(_title in this._pages){e=t===_title;var i=this._pages[_title];this._headers[_title]&&this._headers[_title].toggle(e),i.toggle(e),this._tabs[_title].toggleClass("active",e),e&&(i.data("html")&&(i.html(i.data("html")),i.data("html",null)),i.trigger("show-page"),e=this._tabs[_title].parents(".tabs"),e.is(".technical-tabs")?this.toggleTechnicalTabs(!0):e.is(".market-tabs")&&this.toggleMarketTabs(!0))}this._currentPageTitle=t,this._w_pages.scrollTop(0),this.layoutChanged.fire(),TVSettings.setValue(this._PAGE_KEY,t)}else this.selectPage(this._basicPage)},A1.prototype.attachHandlers=function(){var e=Modernizr.touch?"touchend":"click";this._w_tabs.on(e,"li",this.selectThisPage.bind(this)),this._w_tabs.on(e,"li.market-tabs",this.marketTabsClickHandler.bind(this)),this._w_tabs.on(e,"li.technical-tabs",this.technicalTabsClickHandler.bind(this)),W77.enabled("items_favoriting")&&(this._w_pages.on(e,".insert-study-items .fav",this.toggleItem.bind(this)),this.favsChanged.subscribe(this,this.updateFavorites)),this._w_pages.on(e,".insert-study-items .source",this.viewSourceCode.bind(this)),this._w_pages.on(e,".insert-study-items .open-chart-popup",this.openChartPopup.bind(this)),this._w_pages.on(e,".insert-study-items .delete",this.deleteScript.bind(this)),this._w_pages.on(e,".insert-study-items li a",function(e){e.stopPropagation()}),this._w_pages.on(e,".insert-study-items li",this.insertThisStudy.bind(this)),this._widget.on(e,function(e){e.stopPropagation()}),this._widget.on(e,".insert-study-subscribe-button",this.subscribePackage.bind(this)),this.layoutChanged.subscribe(this,this.updateLayout),loginStateChange.subscribe(this,this.onLoginStateChange),this._w_title.on(e,"a",this.hide.bind(this)),this._widget.on("click",".insert-study-offer-info-screenshots",function(e){e.currentTarget.getAttribute("data-fancybox-inited")||(e.currentTarget.setAttribute("data-fancybox-inited",!0),$(this).find("a").fancybox({type:"image",live:!1,afterShow:function(){$(".fancybox-overlay").on("click",function(e){e.stopPropagation()})}}),setTimeout(function(){$(e.target).click()},0)),e.preventDefault()})},A1.prototype.selectThisPage=function(e){var t=$(e.currentTarget).data("title");t&&"search"!=t&&this.selectPage(t),e.stopPropagation()},A1.prototype.marketTabsClickHandler=function(e){e.stopPropagation(),this.toggleMarketTabs()},A1.prototype.toggleMarketTabs=function(e){var t=this,i=this._w_market_tabs.find("ul"),n=this._w_market_tabs.find(".text"),o=function(){TVSettings.setValue(t._MARKET_TAB_IS_OPEN_KEY,n.hasClass("open")),t.layoutChanged.fire()};"boolean"==typeof e?e?(i.is(":visible")?i.slideDown(50,o):(i.css("display","block"),o()),n.addClass("open")):(i.is(":visible")?i.slideUp(50,o):(i.css("display","none"),o()),n.removeClass("open")):(n.toggleClass("open"),i.slideToggle(50,o))},A1.prototype.technicalTabsClickHandler=function(e){e.stopPropagation(),this.toggleTechnicalTabs()},A1.prototype.toggleTechnicalTabs=function(e){var t=this,i=this._w_technical_tabs.find("ul"),n=this._w_technical_tabs.find(".text"),o=function(){TVSettings.setValue(t._TECHNICAL_TAB_IS_OPEN_KEY,n.hasClass("open")),t.layoutChanged.fire()};"boolean"==typeof e?e?(i.is(":visible")?i.slideDown(50,o):(i.css("display","block"),o()),n.addClass("open")):(i.is(":visible")?i.slideUp(50,o):(i.css("display","none"),o()),n.removeClass("open")):(n.toggleClass("open"),i.slideToggle(50,o))},A1.prototype.toggleItem=function(e){return e=$(e.target).parent().data("study"),this.toggleFavorite(e.id),this.toggleEverywhere(e.id),!1},A1.prototype.toggleEverywhere=function(e){var t=this.isFavorite(e);this._widget.find(".insert-study-items li").filter(function(t,i){var n=$(i).data("study");return n?StudyMetaInfo.cutFullId(n.id)==e:!1}).find(".fav").toggleClass("in-fav",t).attr("title",this.favTitle(t))},A1.prototype.toggleFavorite=function(e){this.isFavorite(e)?this.removeFavorite(e):this.addFavorite(e)},A1.prototype.isFavorite=function(e){return e=StudyMetaInfo.cutFullId(e),-1!=this._favs.indexOf(e)},A1.prototype.addFavorite=function(e){return e=StudyMetaInfo.cutFullId(e),this.isFavorite(e)?!1:(this._favs.push(e),this.saveFavorites(),TVXWindowEvents.emit("StudyFavoritesChanged",JSON.stringify(this._favs)),this.favsChanged.fire(),window.is_authenticated&&(e=(/^Script\$(PUB;\d+)@tv-scripting/.exec(e)||0)[1])&&A56.info([e]).done(function(e){e&&e[0]&&e[0].imageUrl&&$.ajax({url:"/vote-for-chart/",type:"POST",dataType:"json",data:{image_url:e[0].imageUrl,vote:1}})}),!0)},A1.prototype.removeFavorite=function(e){return e=StudyMetaInfo.cutFullId(e),this.isFavorite(e)?(this._favs.splice(this._favs.indexOf(e),1),this.saveFavorites(),TVXWindowEvents.emit("StudyFavoritesChanged",JSON.stringify(this._favs)),this.favsChanged.fire(),!0):!1},A1.prototype.updateFavorites=function(){var e=this.getVisibleFavorites();if(0===e.length)"favorites"===this._currentPageTitle&&this.selectPage(this._basicPage),this._widget.find(".insert-study-items li .fav").removeClass("in-fav"),this._tabs.favorites.hide();else{for(var t=this,i=$.Deferred(),n=[],o=[],r=0;r<e.length;r++){var s=e[r],a=t.getStudyPackageName({id:s});if(a===t._PUBLISHED_STUDIES_PACKAGE_NAME)(s=(/^Script\$([^@]+)/.exec(s)||0)[1])&&o.push(s);else for(var a=t._studies[a]||[],l=0;l<a.length;l++)if(StudyMetaInfo.cutFullId(a[l].id)==s){n.push(a[l]);break}}!o.length||this._options.minimized?i.resolve(n):A56.info(o).done(function(e){for(var i=0;i<e.length;i++)n.push(t._createPublishedScriptMetaInfo(e[i]))}).always(function(){i.resolve(n)}),i.done(function(i){t.preparePageStudies(t._pages.favorites,i),t._widget.find(".insert-study-items li").find(".fav").removeClass("in-fav"),e.forEach(t.toggleEverywhere,t)}),this._tabs.favorites.show()}},A1.prototype.hasFavorites=function(){return!!this._favs.length},A1.prototype.hasVisibleFavorites=function(){return!!this.getVisibleFavorites().length},A1.prototype.getVisibleFavorites=function(){return this.checkExcludePackageStudies(this._favs)},A1.prototype.viewSourceCode=function(e){e.stopPropagation(),this.hide();var t=$(e.target).parent().data("study");this.studyIsPublishedScript(t)?window.scriptEditor.show({scriptIdPart:t.scriptIdPart,scriptSource:t.TVScriptSourceCode}):scriptLib.requestBuiltinAndUserScripts(function(e){for(var i=e.length;i--;)if(e[i].scriptIdPart===t.scriptIdPart){window.scriptEditor.show(e[i]);break}})},A1.prototype.openChartPopup=function(e){e.stopPropagation(),e.preventDefault(),e=$(e.target).parent().data("study"),TradingView.historyManager.push(new TradingView.HistoryManager.ChartPage(e.imageUrl,e.scriptName||e.description))},A1.prototype.deleteScript=function(e){e.stopPropagation(),e.preventDefault();var t=$(e.target).closest("li"),i=t.data("study");A83.showConfirm("Confirmation","Do you really want to delete script '"+(i.scriptName||i.description)+"'?",function(){scriptLib.requestDeleteScript(i.scriptIdPart,function(){console.log("deleted"),t.remove()})})},A1.prototype.checkExcludePackageStudies=function(e){var t=this;return e.filter(function(e){var i=this.getStudyPackageName({id:e});return i===this._PUBLISHED_STUDIES_PACKAGE_NAME?!0:t._studies[i]&&0<$.grep(t._studies[i],function(t){return e===t.id}).length?i===this._BASIC_STUDIES_PACKAGE_NAME||i===this._CUSTOM_STUDIES_PACKAGE_NAME||i===this._SCRIPTING_PACKAGE_NAME||"Script$EDGR"===i||pro.hasPackage(i)&&i in this._studies:!1},this)},A1.prototype.sortStudies=function(e){return e.sort(function(e,t){return e=e.scriptName||e.description_localized||e.description,t=t.scriptName||t.description_localized||t.description,e>t?1:t>e?-1:0})},A1.prototype.fillStudies=function(e,t,i){e.empty(),t.forEach(function(t){t?li=this.createStudyListItem(t,i):(li=document.createElement("li"),li.className="placeholder"),e.append(li)},this)},A1.prototype.createStudyListItem=function(e,t){var i=document.createElement("li");$.data(i,"study",e);var n=e.description_localized||$.t(e.scriptName||e.description||" ",{context:"study"}),o=this.isFavorite(e.id),r=[];if(t&&n){var s=[];t instanceof RegExp?s.push({re:t,fuzzyHighlight:!1}):$.isArray(t)&&(s=t);for(var a=0;a<s.length;a++){var l=s[a].re;if(l.lastIndex=0,l=l.exec(n))if(s[a].fuzzyHighlight)for(var d=l.index,h=1;h<l.length;h++){var c=l[h].length;h%2&&(r[d]=!0),d+=c}else for(d=0;d<l[0].length;d++)r[l.index+d]=!0}}return n=n.replace(/./g,function(e,t){return"<"===e?e="&lt;":"&"===e?e="&amp;":'"'===e&&(e="&quot;"),r[t]&&(e='<span class="match">'+e+"</span>"),e}),n='<span class="text" title="'+strip_tags(n)+'"">'+n+"</span>",W77.enabled("items_favoriting")&&(n='<span class="fav'+(o?" in-fav":"")+' apply-common-tooltip" title="'+this.favTitle(o)+'"></span>'+n),e.author&&e.author.username&&(n+='<span class="author"><a href="/u/'+e.author.username+'" target="_blank">'+e.author.username+"</a></span>"),e.agreeCount&&(n+='<span class="agrees apply-common-tooltip" title="Total agrees">'+e.agreeCount+" like"+(1<e.agreeCount?"s":"")+"</span>"),o=e.TVScriptSourceCode&&(0===e.id.indexOf(this._PUBLISHED_STUDIES_PACKAGE_NAME)||0===e.id.indexOf(this._CUSTOM_STUDIES_PACKAGE_NAME)),!TradingView.isMobileView&&o&&(i.className="custom-script",n+='<span class="source apply-common-tooltip" title="Source code">{}</span>'),W77.enabled("graying_disabled_tools_enabled")&&D16.studiesAccessController.isToolGrayed(e.description)&&(i.className+=" grayed"),e.imageUrl?n+='<div class="open-chart-popup apply-common-tooltip" title="Read more...">...</div>':o&&window.scriptLib&&(n+='<div class="delete apply-common-tooltip" title="Delete script"><i></i></div>'),i.innerHTML=n,i},A1.prototype.favTitle=function(e){return e?$.t("Remove from favorites"):$.t("Add to favorites")},A1.prototype.insertThisStudy=function(e){if(e=$(e.target).closest("li"),!e.hasClass("placeholder")){var t=e.data("study");if(!W77.enabled("graying_disabled_tools_enabled")||!D16.studiesAccessController.isToolGrayed(t.description))return e.highlight(this.HIGHLIGHT_STUDY_NUM_FLICKS),this.insertStudy(t),!1;D17.emit("onGrayedObjectClicked",{type:"study",name:t.description})}},A1.prototype.insertStudy=function(e){var t=this.D5.activeChartWidget.value();if(t){var i=t.insertStudyStub(e.description);e=StudyMetaInfo.replaceWithFullStudyMetaInfoAsync(t.model().studiesMetaData(),e),e.done(function(e){t.removeStudyStub(i.id())&&(t.insertStudyOrShowDialog(e),this._is_on_chart=!0)}.bind(this)),e.fail(function(e){console.error("Error: "+e),i.setStatus(e)})}},A1.prototype.subscribePackage=function(e){(e=$(e.target).closest(".insert-study-pages > div").data("offer"))&&TradingView.visitPaymentPage(e.id)},A1.prototype.onLoginStateChange=function(e){e||this.setUser(window.user)},A1.prototype.getStudyList=function(e){if(!this.studiesReady.isResolved())return[];var t,i=[];for(t in this._studies)(t==this._BASIC_STUDIES_PACKAGE_NAME||pro.hasPackage(t))&&(this._studies[t].forEach(function(e){i.push(e)}),e&&i.push({separator:!0}));return e&&i.splice(i.length-1,1),i},A1.prototype.getStudyPackageName=function(e){if(e&&e.id){var t=StudyMetaInfo.getPackageName(e.id);return t!==this._SCRIPTING_PACKAGE_NAME?t:(e=e.id.split("@")[0],0!==e.indexOf("Script$")?t:(t=e.indexOf("_"),-1!==t?e.substring(0,t):/^Script\$USER;/.test(e)?"Script$USER":/^Script\$PUB;/.test(e)?"Script$PUB":/^Script\$STD;/.test(e)?this._BASIC_STUDIES_PACKAGE_NAME:e))}},A1.prototype.studyIsUserTVScript=function(e){return e&&e.id?"Script$USER"===this.getStudyPackageName(e):void 0},A1.prototype.studyIsPublishedScript=function(e){return e&&e.id?"Script$PUB"===this.getStudyPackageName(e):void 0},A1.prototype.selectSearchPage=function(){this.selectPage("search"),this._clearInput()},A1.prototype._insertStudyByShortDescription=function(){for(var e=this._search_value,e=e.trim(),t=this._studies[this._BASIC_STUDIES_PACKAGE_NAME],i=0;i<t.length;i++){var n=t[i];if(n.shortDescription&&n.shortDescription.toUpperCase()===e.toUpperCase()){this.insertStudy(n);break}}},A1.prototype._clearInput=function(){this._search_input.val(""),"search"===this._currentPageTitle&&this._search_input.val("").trigger("input").focus()},A1.prototype._loadNextPubSearchPage=function(){var e=this;if(e._pubSearchDfd)return e._pubSearchDfd;var t=e._pubSearchPage+1;return e._pubSearchDfd=A56.suggest(void 0,t),e._pubSearchDfd.done(function(i){e._pubSearchPageMax=i.max_offset,e._pubSearchPage=t,e._pubSearchEntries=e._pubSearchEntries.concat(i.results||[])}),e._pubSearchDfd.always(function(){delete e._pubSearchDfd}),e._pubSearchDfd},A1.prototype._onExternalFavoritesChanged=function(e){for(var t=[],i=0;i<e.length;i++){var n=StudyMetaInfo.cutFullId(e[i]);-1===t.indexOf(n)&&t.push(n)}this._favs=t,this.saveFavorites(),this.favsChanged.fire()},TradingView.deleteStudyTemplate=function(e,t){TradingView.getStudyTemplatesList.D20(),W77.enabled("charting_library")?ChartingLibraryBackend.removeStudyTemplate(e,t):$.post("/remove-study-template/",{name:e},t)},A65=function(e){this._options=e||{},this.D5=this._options.D6,this._SAVE_AS_TITLE="Save Study Template As...",this._list=[],this._favoredList=this._$wrapper=null,this._loaded=!1,this._onFirstLoad=new Delegate,this.onFavoriteListResize=new Delegate},A65.prototype.appendMenuButtonTo=function(e){e&&(this._$wrapper=e,this._generateFavoriteList())},A65.prototype.refreshStudyTemplateList=function(e){var t=this;TradingView.getStudyTemplatesList(function(i){t._list=i||[],"function"==typeof e&&e()})},A65.prototype._generateFavoriteList=function(){var e=this;this._favoredList=new A14("StudyTemplates",e._listPreparedForFavorite(),{addClass:"study-template-widget",popupAddClass:"study-template-popup",notShowActive:!0,popupSpacing:this._options.popupSpacing,notShowQuicks:this._options.notShowQuicks,tooltip:"Study Templates",addTooltipClass:"apply-common-tooltip"}),this._favoredList.element().appendTo(this._$wrapper),this._favoredList.onSelect().subscribe(e,function(e){e!=this._SAVE_AS_TITLE&&this.applyStudyTemplate(e)}),this._favoredList.onSelect().subscribe(e,function(e){e===this._SAVE_AS_TITLE&&this.showSaveAsDiaolg()}),this._favoredList.onResize().subscribe(e.D5,e.D5.updateLayout),this._favoredList.onResize().subscribe(this.onFavoriteListResize,this.onFavoriteListResize.fire),this._favoredList.onOpen().subscribe(e,function(){e.refreshFavoriteDropdownMenu()})},A65.prototype._listPreparedForFavorite=function(e){var t=this;e=this.plainList("default");var i=this.plainList("custom"),n=[{id:t._SAVE_AS_TITLE,title:t._SAVE_AS_TITLE,addClass:"special",toQuickButtonStyle:{display:"none"}},{separator:!0}],o=function(e,i){return $.map(e,function(e){var n={id:e,title:e,favoriteButton:{icon:{},title:e,addClass:"apply-common-tooltip"}};return i&&(n.drop=function(){this.deleteStudyTemplate(e)}.bind(t)),n})};return i.length&&(n=n.concat(o(i,!0)).concat([{separator:!0}])),n=n.concat(o(e))},A65.prototype.applyStudyTemplate=function(e){function t(t){TradingView.trackEvent("GUI","Load Study Template"),i.model().model().restoreStudyTemplate(JSON.parse(t.content),e)}var i=this.D5.activeChartWidget.value();TVSettings.setValue("defaultStudyTemplate",e),W77.enabled("charting_library")?ChartingLibraryBackend.getStudyTemplateContent(e,t):$.get("/study-template/?templateName="+encodeURIComponent(e),t)},A65.prototype.showSaveAsDiaolg=function(){var e=this,t=this.D5.activeChartWidget.value(),i=function(i,n){i=clean(i);var o=n[0],o=JSON.stringify(t.model().model().studyTemplate(o)),r={name:i,content:o},o=function(){var t=function(t){t.error||(TVSettings.setValue("defaultStudyTemplate",i),TradingView.getStudyTemplatesList.D20(),e.refreshFavoriteDropdownMenu())};W77.enabled("charting_library")?ChartingLibraryBackend.saveStudyTemplate(r,t):$.post("/save-study-template/",r,t).error(function(e){
console.error(e.responseText)})};-1!=$.inArray(i,e.plainList())?A83.showConfirm("Confirm replace",'Do you realy want to replace "'+i+"\"?<br><small>Note: default study templates won't be removed permanently</small>",o):o()},n=function(t){e.refreshStudyTemplateList(function(){t.find('[name="name"]').inputselectable({list:e.plainList().sort(),closeHandle:t})})};runOrSignIn(function(){TradingView.showChartNameDialog(i,"Save new study template","Template name",255,[{title:"Save Interval",name:"save_interval",type:"bool",hint:'When selecting this checkbox the study template will set "'+t.model().model().mainSeries().interval()+'" interval on a chart'}],n)},!0)},A65.prototype.refreshFavoriteDropdownMenu=function(){var e=this,t=this._favoredList;t&&e.refreshStudyTemplateList(function(){t.reload(e._listPreparedForFavorite()),t._container.hasClass("active")&&(t._container.trigger("click"),t._openMenu.call(t))})},A65.prototype.deleteStudyTemplate=function(e){var t=this,i="Do you realy want to delete "+(e?'"'+e+'"':"")+" study template?";runOrSignIn(function(){A83.showConfirm("Study Template",i,function(){t._favoredList.removeById(e),TradingView.deleteStudyTemplate(e,function(){setTimeout(function(){t.refreshFavoriteDropdownMenu()},0)})})})},A65.prototype.container=function(){return this._favoredList?this._favoredList._container:null},A65.prototype.list=function(){return this._list},A65.prototype.plainList=function(e){return"default"===e?$.map(jQuery.grep(this._list,function(e){return!!e.is_default}),function(e){return e.name}):"custom"===e?$.map(jQuery.grep(this._list,function(e){return!e.is_default}),function(e){return e.name}):$.map(this._list,function(e){return e.name})};var Action=function(e){e||(e={}),this.checkable=e.checkable||!1,this.checked=e.checked||null,this.enabled=void 0==e.enabled?!0:e.enabled,this.visible=e.visible||!0,this.font=e.font||"Arial",this.icon=e.icon||null,this.iconText=e.iconText||null,this.iconVisibleInMenu=e.iconVisibleMenu||!0,this.deleteButton=e.deleteButton||null,this.shortcut=null,this.setShortCut(e.shortcut),this.statusTip=e.statusTip||null,this.text=e.text||null,this.toolTip=e.toolTip||null,this.htmlclass=e.htmlclass||null,this._callbackContext=e.callbackContext||this,this._callbacks=new Delegate,this.subActions=e.subActions||[]};Action.prototype.callbacks=function(){return this._callbacks},Action.prototype.callbackContext=function(){return this._callbackContext},Action.prototype.setCallbackContext=function(e){this._callbackContext=e},Action.prototype.hasSubActions=function(){return this.subActions&&this.subActions.length},Action.prototype.setChecked=function(e){this.checked=e},Action.prototype._toggleChecked=function(){this.checked=!this.checked},Action.prototype.setVisible=function(e){this.visible=e},Action.prototype.setEnabled=function(e){this.enabled=e},Action.prototype.disable=function(){this.setEnabled(!1)},Action.prototype.enable=function(){this.setEnabled(!0)},Action.prototype.setShortCut=function(e){e&&(this.shortcut=e,this._bindShortCut())},Action.prototype._bindShortCut=function(){var e=this,t="."+this.shortcut;$(document).unbind(t),$(document).bind("keydown"+t,this.shortcut,function(t){return t.preventDefault(),e.enabled?(e.executeCallback(),!1):void 0})},Action.prototype.setIconVisible=function(e){this.iconVisibleInMenu=e},Action.prototype.executeCallback=function(e){this._lastEvent=e,this._toggleChecked(),this._callbacks.fire(this)},ActionSeparator=function(){Action.call(this),this.subActions=this.font=null,this.htmlclass="action-separator"},inherit(ActionSeparator,Action),ActionPlaceholder=function(e){Action.call(this),this.deferred=e},inherit(ActionPlaceholder,Action);var ContextMenu={INSERT_AT_END:0,INSERT_AT_START:1,INSERT_AT_POS:2,WRAPPER_TAG:"div",WRAPPER_ATTRIBUTES:{"class":"context-menu-wrapper"},MENU_TAG:"table",ITEM_ROW_TAG:"tr",ICON_CELL_TAG:"td",TEXT_CELL_TAG:"td",RIGHT_CELL_TAG:"td",SUBMENU_CELL_TAG:"td",instances:[],createMenu:function(e,t,i){return e=new ContextMenu.Menu(e,t,i),this.instances.push(e),e},createMenuFromActions:function(e,t){var i=new ContextMenu.Items(e,t);return this.instances.push(i),i},hideAll:function(){for(instance in this.instances)this.instances[instance].hide()}};!function(e){function t(e){return null==e._parentMenu?null:(e=e._parentMenu,e=null==e._parentMenuItem?e:t(e._parentMenuItem))}ContextMenu.Item=function(e,t){this.action=e,this._parentMenu=t},ContextMenu.Item.prototype._createIconTag=function(){var e=this._iconTagAttributes();return this.jqIcon=HTMLHelper.Element.create(ContextMenu.ICON_CELL_TAG,e),this.jqIcon.addClass("context-menu"),this.jqIcon},ContextMenu.Item.prototype._createDeleteButton=function(){if(!this.action.deleteButton)return null;var e=this,t=this.action.deleteButton.action,i=HTMLHelper.Element.create("span",{"class":"context-menu-delete-button"});t&&i.click(function(){return t.call(e),!1}),this.jqSubmenu.addClass("delete-spacer"),this.jqSubmenu.append(i)},ContextMenu.Item.prototype._createTextTag=function(){var e=this._textTagAttributes();return this.jqText=HTMLHelper.Element.create(ContextMenu.TEXT_CELL_TAG,e),this.jqIcon.addClass("context-menu"),this.jqText},ContextMenu.Item.prototype._createRightTag=function(){var e=this._rightTagAttributes();return this.jqRight=HTMLHelper.Element.create(ContextMenu.RIGHT_CELL_TAG,e),this.jqIcon.addClass("context-menu"),this.jqRight},ContextMenu.Item.prototype._createSubmenuTag=function(){var e=this._submenuTagAttributes();return this.jqSubmenu=HTMLHelper.Element.create(ContextMenu.SUBMENU_CELL_TAG,e),this.jqIcon.addClass("context-menu"),this.jqSubmenu},ContextMenu.Item.prototype._iconTagAttributes=function(){var e={},t=[];return this.action&&(this.action.icon?(t.push("icon"),t.push(this.action.icon.replace(/\./,"_"))):this.action.checkable?(t.push("icon"),this.action.checked?t.push("checked-icon"):t.push("unchecked-icon")):t.push("spacer")),e["class"]=t.join(" "),e},ContextMenu.Item.prototype._textTagAttributes=function(){return{"class":"text",html:this.action?this.action.text:""}},ContextMenu.Item.prototype.highlight=function(e){e?(this.jqRow.addClass("context-menu-hover"),this.jqIcon.addClass("context-menu-hover")):(this.jqRow.removeClass("context-menu-hover"),this.jqIcon.removeClass("context-menu-hover")),this.action&&this.action.hasSubActions()&&(e?this.jqSubmenu.addClass("expanded"):this.jqSubmenu.removeClass("expanded"))},ContextMenu.Item.prototype._rightTagAttributes=function(){var e={},t=["right"];return this.action&&this.action.shortcut&&(t.push("shortcut"),e["class"]=t.join(" "),e.html=this.action.shortcut),e},ContextMenu.Item.prototype._submenuTagAttributes=function(){var e={};return this.action&&this.action.hasSubActions()?e["class"]="submenu-arrow":e["class"]="context-menu spacer",e},ContextMenu.Item.prototype.render=function(){this._createRow(),this.jqRow.append(this._createIconTag()),this.jqRow.append(this._createTextTag()),this.jqRow.append(this._createRightTag()),this.jqRow.append(this._createSubmenuTag()),this._createDeleteButton(),this.appendCallback();var e=this;return this.jqRow.mouseenter(function(t){e.showSubmenu(t),e.highlight(!0),e._parentMenu&&e._parentMenu._parentMenuItem&&e._parentMenu._parentMenuItem.highlight(!0)}),this.jqRow.mouseleave(function(){e.highlight(!1)}),this.jqRow},ContextMenu.Item.prototype._createRow=function(){var e=this._rowTagAttributes();this.jqRow=HTMLHelper.Element.create(ContextMenu.ITEM_ROW_TAG,e),this.jqRow.addClass("context-menu");var t=this;if(this.action&&!this.action.hasSubActions()){var i=function(e){e.destroy(),e._parentMenuItem&&i(e._parentMenuItem._parentMenu)};this.jqRow.click(function(e){i(t._parentMenu)})}},ContextMenu.Item.prototype.showSubmenu=function(e){this._parentMenu.closeOtherSubmenus(this),(!this.action||this.action.hasSubActions())&&(this._menu||(this._menu=ContextMenu.createMenu(this.action.subActions,null,this)),this.jqRow.position(),this.jqRow.height(),this.jqRow.width(),this.jqRow.offset(),e.pageX=this._parentMenu.jqMenu.width()-2,e.pageY=this.jqSubmenu.offset().top-this._parentMenu.jqMenu.offset().top-1,this._menu.show(e,this._parentMenu.jqMenu))},ContextMenu.Item.prototype._rowTagAttributes=function(){var e=[];return this.action&&(!1===this.action.enabled&&e.push("disabled"),!1===this.action.visible&&e.push("hidden"),this.action.font&&e.push("font_"+this.action.font),this.action.hasSubActions()&&e.push("has_submenu"),this.action.htmlclass&&e.push(this.action.htmlclass)),{"class":e.join(" ")}},ContextMenu.Item.prototype.appendCallback=function(){var e=this;this.jqRow.click(function(t){e.action.enabled&&e.action.executeCallback(t)})},ContextMenu.Item.prototype.getTopLevelMenu=function(){return t(this)},ContextMenu.ItemPlaceholder=function(e,t){this.action=e,this._parentMenu=t},ContextMenu.ItemPlaceholder.prototype.render=function(e){this._createRow();var t=this;return this.action.deferred.then(function(i){for(var n in i){var o=t._parentMenu.addItem(i[n]);ContextMenu.Menu.renderItem(e,o)}}).always(function(){t.jqRow.hide()}),this.jqRow},ContextMenu.ItemPlaceholder.prototype._createIconTag=function(){var e=this._iconTagAttributes();return this.jqIcon=HTMLHelper.Element.create(ContextMenu.ICON_CELL_TAG,e),this.jqIcon.addClass("context-menu"),this.jqIcon},ContextMenu.ItemPlaceholder.prototype._createRow=function(){var e=this._rowTagAttributes();this.jqRow=HTMLHelper.Element.create(ContextMenu.ITEM_ROW_TAG,e),this.jqRow.append(this._createIconTag()),this.jqRow.addClass("context-menu")},ContextMenu.ItemPlaceholder.prototype._rowTagAttributes=function(){var e=[];return this.action&&e.push("spinner"),{"class":e.join(" ")}},ContextMenu.ItemPlaceholder.prototype.highlight=function(e){},ContextMenu.ItemPlaceholder.prototype._iconTagAttributes=function(){var e={},t=[];return t.push("spacer"),e["class"]=t.join(" "),e.colspan="10",e}}(jQuery),function(e){function t(e){var i=[];e=e.m_items;for(var n=0;n<e.length;n++)e[n]._menu&&(i.push(e[n]._menu),i=i.concat(t(e[n]._menu)));return i}ContextMenu.Menu=function(t,i,n){this.options={},this._parentMenuItem=n,e.extend(this.options,i),this.options["class"]&&(this.options.attributes["class"]=this.options["class"]),this.m_wrapper=this.jqMenu=null,this.m_items=[];for(var o in t)this.addItem(t[o])},ContextMenu.Menu.prototype.addItem=function(e){return e=e instanceof ActionPlaceholder?new ContextMenu.ItemPlaceholder(e,this):new ContextMenu.Item(e,this),this.m_items.push(e),e},ContextMenu.Menu.renderItem=function(e,t){e.append(t.render(e))},ContextMenu.Menu.prototype.closeOtherSubmenus=function(e){for(e=0;e<this.m_items.length;++e)this.m_items[e].highlight(!1),this.m_items[e]._menu&&(this.m_items[e]._menu.destroy(),this.m_items[e]._menu=null)},ContextMenu.Menu.prototype.isShown=function(){return null!==this.jqMenu},ContextMenu.Menu.prototype.render=function(){var t=this.getAttributes();if(this._parentMenuItem){this.jqMenu=t=e("<table>"),t.attr("cellspacing","0"),t.attr("cellpadding","0"),t.addClass("context-menu"),t.addClass("submenu");for(var i in this.m_items){var n=this.m_items[i];ContextMenu.Menu.renderItem(t,n)}}else for(i in this.jqMenu=t=HTMLHelper.Element.create(ContextMenu.MENU_TAG,t),this.m_items)n=this.m_items[i],ContextMenu.Menu.renderItem(t,n);return this.jqMenu},ContextMenu.Menu.prototype.getAttributes=function(){var e={},t=["context-menu"];return this.options.attributes&&this.options.attributes["class"]&&t.push(this.options.attributes["class"]),e.cellspacing=0,e.cellpadding=0,e["class"]=t.join(),e},ContextMenu.Menu.prototype.deploy=function(t,i){return this.jqMenu=this.wrapper().append(this.render()),i?(e(i).data("submenu",this.jqMenu),e(document.body).append(this.jqMenu),this.jqMenu.data("parent-menu",i),this.jqMenu.data("parent-item",t.currentTarget)):e(document.body).append(this.jqMenu),HTMLHelper.unbindContextMenu(this.jqMenu),this._setCoords(t),this.jqMenu},ContextMenu.Menu.prototype.show=function(e,t){this.deploy(e,t).show()},ContextMenu.Menu.prototype.hide=function(){this.isShown()&&this.destroy()},ContextMenu.Menu.prototype.destroy=function(){e.each(this.m_items,function(e,t){t._menu&&t._menu.destroy()}),this.jqMenu&&(this.jqMenu.remove(),this.jqMenu=null),this.m_wrapper.empty()},ContextMenu.Menu.prototype._setCoords=function(t){var i=this.jqMenu;e(this.jqMenu.data("parent-menu"));var n=e(this.jqMenu.data("parent-item")),o=e(window).width(),r=Math.min(e(window).height(),e("body").height()),s=e(document).scrollTop(),a=e(document).scrollLeft();this.jqMenu.css({maxWidth:o-10,maxHeight:r-10});var l,d=i.outerWidth(),i=i.outerHeight();for(n.size()?(l=n.offset(),l={top:l.top-1,left:l.left+n.outerWidth()}):l={top:t.pageY,left:t.pageX},this.jqMenu.offset(l),n={},n.top=Math.min(l.top,r+s-i-5),n.left=Math.min(l.left,o+a-d-5),t=t.target;t&&t!==document;t=t.parentNode)if("fixed"===e(t).css("position")){this.jqMenu.css("position","fixed");break}this.jqMenu.offset(n)},ContextMenu.Menu.prototype._wrapper=function(){var i=this,n=ContextMenu.WRAPPER_ATTRIBUTES;return this._parentMenuItem?this.m_wrapper=HTMLHelper.Element.create(ContextMenu.WRAPPER_TAG,n):(this.m_wrapper=HTMLHelper.createPopup(n,void 0,{mouseDownOutsideEvent:function(n){var o=e();e.each(t(i),function(){o=o.add(this.m_wrapper)}),e(n.target).parents().andSelf().is(o)||i.hide()}}),this.m_wrapper.addClass("topmenu")),this.m_wrapper},ContextMenu.Menu.prototype.wrapper=function(e){return this.m_wrapper||this._wrapper()}}(jQuery),TradingView._defaultChartSymbol="FX:SPX500",A7=function(e){var t=this;this._startSpinner(e.jqParent),TradingView.drawingState.init();var i=this;TradingView.drawingState.tool.subscribe(function(e){if(i.D0){if(i.D0.model().setCurrentTool(e),TradingView.isMobile.any()){var t=i._paneWidgets[0];if(W47.isLineTool(e)&&"LineToolBrush"!==e){e=.5*i.D0.model().timeScale().width();var n=.5*t._state.defaultPriceScale().height();i.D0.model().setCurrentPosition(e,n,t._state),t._updateTooltip(e,n)}else t._hideTooltip()}i.D0&&TradingView.isMobile.any()&&i.D0.model().crossHairSource().updateAllViews()}}),this._options=e=e||{};var n=e.jqParent,o=e.sizeFunc,r=e.content,s=e.readOnly,a=e.containsData,l=e.onWidget,d=e.onCmeWidget,h=e.timezone,c=e.withDateRanges,p=e.hideSymbolSearch,u=e.defSymbol,f=e.defInterval,g=-1!==$.inArray(e.defStyle,$.map($.grep(Object.keys(TradingView.Series),function(e){return/^STYLE_\w+/.test(e)}),function(e){return TradingView.Series[e]}))?e.defStyle:void 0;this.D5=e.D6||null,this._withDateRanges=("undefined"==typeof c?!s:!!c)&&W77.enabled("timeframes_toolbar"),this._jqParent=void 0!==n?n:$(document.body),this._setContent(r),this._readOnly=s,this._containsData=a,this._defSymbol=u,this._defInterval=f,this._defStyle=g,this._onCmeWidget=(this._onWidget=!!l)?!!d:!1,this._sizeFunc=o||function(){var e=t._jqParent.width(),i=t._jqParent.height(),n=t._jqParent[0];return window.self!==window.top&&n.offsetWidth<n.clientWidth&&100>n.getBoundingClientRect().width&&(e=Math.round(100*n.getBoundingClientRect().width),i=Math.round(100*n.getBoundingClientRect().height)),new TradingView.Rect(0,0,e,i-(t._withDateRanges?22:0))},this._hideSymbolSearch=p,this._jqMainDiv=null,this._rect=this._sizeFunc(),this._jqMainTable=null,this._paneWidgets=[],this._paneSeparators=[],this._timeAxisWidget=null,this._frameTime=30,this.D0=null,this._metaInfo={},(e=this._contentSeriesProperties())&&(u=e.symbol,f=e.interval),!IntervalHelper||IntervalHelper.isMinute(f)||IntervalHelper.isDWM(f)||(f=void 0),this.D2=new $52("chartproperties"),this.D2.mainSeriesProperties.merge(defaults("chartproperties.mainSeriesProperties")),this.D2.mainSeriesProperties.merge({visible:!0,symbol:u?u:TradingView._defaultChartSymbol,shortName:"",timeframe:"",onWidget:this._onWidget,interval:f||"D",style:g,lineStyle:{styleType:factoryDefaults("chartproperties.mainSeriesProperties.lineStyle.styleType")}}),this._containsData&&this.D2.mainSeriesProperties.merge({showCountdown:!1}),h&&TradingView.timezoneIsAvailable(h)&&this.D2.timezone.setValue(h),this.onCmeWidget()&&this.D2.timezone.setValue("exchange"),this._tagsChanged=new Delegate,this._modelCreated=new Delegate,this._disconnected=new Delegate,this._reconnectBailout=new Delegate,this._connected=new Delegate,this._redrawPanes=new Delegate,this.chartWidgetInitialized=new Delegate,this._studiesMetaData=new List,this._studiesMigrations=new List,this._chartSession=new ChartSession(D16),this.lhsPriceAxisWidthChanged=new Delegate,this.rhsPriceAxisWidthChanged=new Delegate,this.createLogo=null},A7.prototype.refreshMarks=function(){this.model().barsMarksSources().map(function(e){e.refreshData()})},A7.prototype.clearMarks=function(){this.model().barsMarksSources().map(function(e){e.clearMarks()})},A7._nextMetadataId=1,A7.FREE_STUDY_LIMIT=10,A7.prototype._onStudiesMetadata=function(e){var t=this;if("studies_metadata"===e.method){this._studiesMigrations=new List;for(var i=e.params[1].migrations,n=0;i&&n<i.length;n++)this._studiesMigrations.append(i[n]);for(var o=e.params[1].metainfo,n=0;n<o.length;n++)A0._fixInputsMaxValue(null,o[n]);for(n=0;n<o.length;n++)_applyLocalizationToMetadata(o[n]);o=o.concat(this.privateMetaInfo(TradingView.FundamentalsGenerator)),o=o.concat(this.privateMetaInfo(TradingView.EotProGenerator)),TradingView.D18("alerts")&&!t.onWidget()&&this._setAlertsStudiesList(o),void 0!=PineAddons?(e=A7._filterAuthorizedMetaInfo(PineAddons.TimWestStudiesMetaInfo),o=o.concat(e),e=A7._filterAuthorizedMetaInfo(PineAddons.SpyderCrusherStudiesMetaInfo),o=o.concat(e),e=A7._filterAuthorizedMetaInfo(PineAddons.AlphaLabStudiesMetaInfo),o=o.concat(e),e=A7._filterAuthorizedMetaInfo(PineAddons.SRLevelsStudiesMetaInfo),o=o.concat(e),e=A7._filterAuthorizedMetaInfo(PineAddons.MTFPanesStudiesMetaInfo),o=o.concat(e),e=PineAddons.ESDMetaInfo,o=o.concat(e)):console.error("PineAddons is undefined. All Pine Script products will be unavailable"),(e=this._tvScriptsRequestDfd)||(e=$.Deferred().resolve([])),e.done(function(e){t._onScriptSources(e,o)})}},A7.prototype._setAlertsStudiesList=function(e){this._alertsStudiesList=$.map($.grep(e,function(e){e=e.plots||[];for(var t=0;t<e.length;t++)if("line"===e[t].type)return!0;return!1}),function(e){return e.id})},A7.prototype.canCreateAlertForDataSource=function(e){function t(e){if(e instanceof A58&&(e=e.bars()),e instanceof PlotList&&(e=e.state().data),!$.isArray(e))return!0;for(var t=e.length-1;t>=0;t--){var i=e[t];if(!$.isArray(i.value))return!0;for(var n=i.value.length-1;n>0;n--){var o=i.value[n];if(null!==o&&void 0!==o&&!isNaN(o))return!0}}return!1}if(this.onWidget()||!W77.enabled("alerts")||!TradingView.D18("alerts"))return!1;var i=e.uniqueId&&e.uniqueId(),n=e===this.D0.mainSeries(),o=e instanceof TradingView.Study,r=!(e instanceof TradingView.study_Script$TV_DIVIDENDS||e instanceof TradingView.study_Script$TV_SPLITS||e instanceof TradingView.study_Script$TV_EARNINGS),s=e.metaInfo?e.metaInfo():null,a=s?s.isTVScript:!1,s=s?-1!=$.inArray(s.fullId,this._alertsStudiesList):!1;return i&&(n||o&&r&&e.data()&&!e.data().isEmpty()&&t(e.data())&&(a||s))},A7._filterAuthorizedMetaInfo=function(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],o=StudyMetaInfo.parseIdString(n.id).productId;pro.hasPackage(o)&&t.push(n)}return t},A7.prototype.privateMetaInfo=function(e){return e?new e(StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION).generateMetaInfo():[]},A7.prototype._onScriptSources=function(e,t){if(!this.onWidget()){for(var i=null,n=0;n<t.length;++n){var o=t[n];if(o.id.startsWith("Script@tv-scripting-")){i=StudyMetaInfo.parseIdString(o.id).version;break}}if(null!=i)for(this.studyScriptingPkgVers=i,n=0;n<e.length;++n)try{var r=e[n].scriptName;TradingView.logDebug("Loading script: '"+r+"'.");var s=StudyMetaInfo.createMetaInfoStub(e[n],i);t.push(s)}catch(a){console.error("Could not process script (skipped): "+r+" ("+a.message+")")}else console.error("Could not find tv-scripting package in metadata response")}for(n=0;n<t.length;n++)StudyMetaInfo.addStudyMetaInfo(this._studiesMetaData,t[n]);StudyMetaInfo.sortStudiesMetainfo(this._studiesMetaData),this._init(),this.chartWidgetInitialized.fire()},A7.prototype._init=function(){var e=this;!this._containsData&&this._content&&this._content.timeScale&&!this._content.timeScale.m_lastVisibleBar&&(this._content.timeScale.m_rightOffset=this.D2.timeScale.rightOffset.value()),this.initColors(),this._makeDefaultGui(),this._makeDefaultModel(),this._chartSession&&this._chartSession.connected()&&this.D0.restart(),this._content&&(this.initColors(),this._updateGui(),this.update()),e.D0.mainSeries().marketStatus.subscribe(function(t){e.indicatorImage&&e._updateDataAndMarketStatus(t,e.D0.mainSeries().status())},{callWithLast:!0}),this._resizeHandler=function(){this._rect=this._sizeFunc(),TradingView.setAbsoluteRect(this._jqMainDiv,this._rect),this._adjustSize(),this.D0&&this.D0.mainSeries().requestMoreData(),this.paint()}.bind(this),this._resizeHandler(),this._jqMainDiv.appendTo(this._jqParent),this._spinner&&(this._spinner.stop(),delete this._spinner),$(window).keydown(function(e){27==e.which&&e.preventDefault()}),this._containsData||this._jqMainDiv.mousewheel(function(e,t,i,n){if(!(!TradingView.onWidget()&&parent&&parent!==window&&parent.IS_DEMO_PAGE||!this.model()||this.noScroll||this.model().timeScale().isEmpty())){e=e.pageX-5,t=this._paneWidgets[0].lhsPriceAxisWidget.size.w;var o=this._timeAxisWidget.size.w;return t&&(e=Math.max(0,e-t)),e=Math.min(e,o),e=W77.enabled("right_bar_stays_on_scroll")?1:2*(e/o-.5),t=Math.min(1,Math.abs(n)),n>0?this.model().zoomIn(e,t):0>n&&this.model().zoomOut(e,t),i&&this.model().scrollChart(-80*i),!1}}.bind(this)),this._initBarsMarksSources(),TradingView.D18("esdindicatorfeature")&&this.initESDTimelineWidget(),this.setAutoScaleOnSymbolChange(),this.readOnly()||this._hideSymbolSearch||A69.registerDialogKeypressHandler(this),this.adaptOnChartLogo(this.D2.paneProperties.background.value())},A7.prototype._initBarsMarksSources=function(){var e=this;this.withModel(this,function(){this.model().barsMarksSources().map(function(t){t.onNeedRepaint.subscribe(e,e.paint)})})},A7.prototype.initESDTimelineWidget=function(){new TradingView.ESDTimelineWidget(this)},A7.prototype.setAutoScaleOnSymbolChange=function(){this.withModel(this,function(){this.model().mainSeries().onStartLoading().subscribe(this,function(){(!this.model().mainSeries()instanceof TradingView.Series||!this.model().mainSeries().properties().lockScale.value())&&0==this.model().mainSeries().data().size()&&this.model().mainSeries().priceScale().setAutoScale(!0)})})},A7.prototype.initColors=function(){this.D2.paneProperties.background.listeners().subscribe(this,A7.prototype.setBackgroundColor),this.D2.paneProperties.gridProperties.color.listeners().subscribe(this,A7.prototype.redrawPanes),this.D2.scalesProperties.lineColor.listeners().subscribe(this,A7.prototype.setScaleLineColor),this.D2.scalesProperties.textColor.listeners().subscribe(this,A7.prototype.setScaleTextColor)},A7.prototype.paneWidgets=function(){return new List(this._paneWidgets)},A7.prototype.paneByCanvas=function(e){for(var t=0;t<this._paneWidgets.length;t++)if(this._paneWidgets[t].canvas===e||this._paneWidgets[t].top_canvas===e)return this._paneWidgets[t];return null},A7.prototype.paneByState=function(e){for(var t=0;t<this._paneWidgets.length;t++)if(this._paneWidgets[t]._state===e)return this._paneWidgets[t];return null},A7.prototype.priceAxisByCanvas=function(e){for(var t=0;t<this._paneWidgets.length;t++){var i=this._paneWidgets[t].priceAxisByCanvas(e);if(i)return i}return null},A7.prototype.timeAxisByCanvas=function(e){return e===this._timeAxisWidget.canvas||e===this._timeAxisWidget.top_canvas?this._timeAxisWidget:null},A7.prototype.properties=function(){return this.D2},A7.prototype.emulateCriticalError=function(){this._chartSession.removeSeries(-1,null)},A7.prototype.readOnly=function(){return this._readOnly},A7.prototype.onDisconnected=function(){return this._disconnected},A7.prototype.onReconnectBailout=function(){return this._reconnectBailout},A7.prototype.onConnected=function(){return this._connected},A7.prototype.onRedrawPanes=function(){return this._redrawPanes},A7.prototype.modelCreated=function(){return this._modelCreated},A7.prototype.setResolution=function(e){if(this.D0){var t=this.D0.mainSeries().properties().interval;this.D0.setScreenChartProperty(t,e,this,$.t("Change Resolution"))}else this.D2.mainSeriesProperties.merge({interval:e})},A7.prototype.getResolution=function(){return this.D0?this.D0.mainSeries().properties().interval.value():this.D2.mainSeriesProperties.interval.value()},A7.prototype.addSymbol=function(e,t){var i=this.model(),n=i.studiesMetaData(),o=i.mainSeries().properties().style.value()==TradingView.Series.STYLE_CANDLES?TradingView.Series.STYLE_BARS:TradingView.Series.STYLE_CANDLES;props={inputs:{symbol:e},style:o},study=n.find(function(e){return"Overlay@tv-basicstudies"==e.id}),i.insertStudy(study,props,t)},A7.prototype.addSymbolDialog=function(){A83.showAddSymbolDialog(this,{overlayOption:!0,callback:this.addSymbol.bind(this)})},A7.prototype.updateActions=function(){function e(e){function t(){TradingView.showChartNameDialog(function(e){if(e){var t={name:e,content:JSON.stringify(i.D0.model().theme())};$.post("/save-theme/",t).error(function(e){console.error(e.responseText)}),TradingView.getThemesList.D20(),i.D0._lastLoadedTheme=e}},"Save theme as...","Theme name",128)}n.applyColorTheme.subActions||(n.applyColorTheme.subActions=[]);var o=n.applyColorTheme.subActions;if(o.splice(0,o.length),is_authenticated){var r=new Action({text:$.t("Save As...")});r.callbacks().subscribe(null,t),o.push(r),o.push(new ActionSeparator)}e&&e.length?$.each(e,function(e,t){function n(e){return function(){return A83.showConfirm("Theme","Do you realy want to delete "+(e?'"'+e+'"':"")+" theme?",function(){$.post("/remove-theme/",{name:e}).error(function(e){console.error(e.responseText)}),TradingView.getThemesList.D20()}),this._parentMenu._parentMenuItem._parentMenu.destroy(),!1}}var r=new Action({text:t});r.callbacks().subscribe(null,function(){$.getJSON("/theme/?themeName="+encodeURIComponent(t),function(e){i.model().model().restoreTheme(JSON.parse(e.content))})}),is_authenticated&&(r.deleteButton={action:n(r.text)}),o.push(r)}):o.push(new Action({text:"No color themes saved",enabled:!1}))}function t(){var e=studyTemplates.plainList("custom"),t=studyTemplates.plainList("default");n.applyStudyTemplate.subActions||(n.applyStudyTemplate.subActions=[]);var i=n.applyStudyTemplate.subActions;i.splice(0,i.length);var o=new Action({text:studyTemplates._SAVE_AS_TITLE});o.callbacks().subscribe(studyTemplates,studyTemplates.showSaveAsDiaolg),i.push(o),i.push(new ActionSeparator),e.length||t.length?(e.length&&($.each(e,function(e,t){var n=new Action({text:t});n.callbacks().subscribe(studyTemplates,function(){this.applyStudyTemplate(t)}),n.deleteButton={action:function(e){return function(){return studyTemplates.deleteStudyTemplate(e),this._parentMenu._parentMenuItem._parentMenu.destroy(),!1}}(n.text)},i.push(n)}),i.push(new ActionSeparator)),$.each(t,function(e,t){var n=new Action({text:t});n.callbacks().subscribe(studyTemplates,function(){this.applyStudyTemplate(t)}),i.push(n)})):i.push(new Action({text:"No study templates saved",enabled:!1}))}for(var i=this,n=this.actions(),o=this.D0.D19(),r=!1,s=!1,a=0,l=o.size();l>a;a++){var d=o.item(a);isInherited(d.constructor,W47)&&d.isUserDeletable()&&(r=!0),isInherited(d.constructor,TradingView.Study)&&d.removeByRemoveAllStudies()&&(s=!0)}this._readOnly||(n.paneRemoveAllStudies&&n.paneRemoveAllStudies.setEnabled(s),n.paneRemoveAllDrawingTools&&n.paneRemoveAllDrawingTools.setEnabled(r)),e(TradingView.getThemesList(e)),window.studyTemplates&&(t(),studyTemplates.refreshStudyTemplateList(t));var h=[];TradingView.availableTimezones.forEach(function(e){var t=this,i=function(){return e.id===t.model().model().properties().timezone.value()};if(e.separator)indicatorSubActions.push(new ActionSeparator);else{var n=new Action({text:e.title,checkable:!0,checked:i()});n.callbacks().subscribe(this,function(){var i;i||(i=setTimeout(function(){t.model().setProperty(t.model().model().properties().timezone,e.id,"Changed Time Zone"),i=!1},300))}),t.model().model().properties().timezone.subscribe(null,function(){n.setChecked(i())}),h.push(n)}},this),n.applyTimeZone.subActions=h,n.addToWatchlist.text=$.t("Add {0} To Watchlist").format(this.getSymbol(!0)),this.updateActionForIntradayOnly(n.sessionBreaks)},A7.prototype.actions=function(){return this._actions||this._setActions(),this._actions},A7.prototype._setActions=function(){var e=this;if(!this._readOnly)for(var t=[new Action({text:$.t("Eraser"),callbackContext:"eraser"}),new ActionSeparator,new Action({text:$.t("Trend Line"),callbackContext:"LineToolTrendLine"}),new Action({text:$.t("Horizontal Line"),callbackContext:"LineToolHorzLine"}),new Action({text:$.t("Vertical Line"),callbackContext:"LineToolVertLine"}),new Action({text:$.t("Arrow"),callbackContext:"LineToolArrow"}),new Action({text:$.t("Ray"),callbackContext:"LineToolRay"}),new Action({text:$.t("Extended"),callbackContext:"LineToolExtended"}),new Action({text:$.t("Parallel Channel"),callbackContext:"LineToolParallelChannel"}),new ActionSeparator,new Action({text:$.t("Pitchfork"),callbackContext:"LineToolPitchfork"}),new Action({text:$.t("Schiff Pitchfork"),callbackContext:"LineToolSchiffPitchfork"}),new Action({text:$.t("Pitchfan"),callbackContext:"LineToolPitchfan"}),new Action({text:$.t("Gann Square"),callbackContext:"LineToolGannSquare"}),new Action({text:$.t("Gann Fan"),callbackContext:"LineToolGannFan"}),new Action({text:$.t("Fib Retracement"),callbackContext:"LineToolFibRetracement"}),new Action({text:$.t("Trend-Based Fib Extension"),callbackContext:"LineToolTrendBasedFibExtension"}),new Action({text:$.t("Fib Speed Resistance Fan"),callbackContext:"LineToolFibSpeedResistanceFan"}),new Action({text:$.t("Fib Time Zone"),callbackContext:"LineToolFibTimeZone"}),new Action({text:$.t("Circle Lines"),callbackContext:"LineToolCircleLines"}),new Action({text:$.t("Fib Circles"),callbackContext:"LineToolFibCircles"}),new Action({text:$.t("Fib Speed Resistance Arcs"),callbackContext:"LineToolFibSpeedResistanceArcs"}),new ActionSeparator,new Action({text:$.t("Rectangle"),callbackContext:"LineToolRectangle"}),new Action({text:$.t("Ellipse"),callbackContext:"LineToolEllipse"}),new Action({text:$.t("Triangle"),callbackContext:"LineToolTriangle"}),new Action({text:$.t("Polyline"),callbackContext:"LineToolPolyline"}),new Action({text:$.t("Arc"),callbackContext:"LineToolArc"}),new ActionSeparator,new Action({text:$.t("Text"),callbackContext:"LineToolText"}),new Action({text:$.t("Anchored Text"),callbackContext:"LineToolTextAbsolute"}),new Action({text:$.t("Balloon"),callbackContext:"LineToolBalloon"}),new Action({text:$.t("Price Label"),callbackContext:"LineToolPriceLabel"}),new ActionSeparator,new Action({text:$.t("Elliott Wave Subminuette"),callbackContext:"LineToolElliottSubminuette"}),new Action({text:$.t("Elliott Wave Minor"),callbackContext:"LineToolElliottMinor"}),new Action({text:$.t("Elliott Wave Circle"),callbackContext:"LineToolElliottCircle"}),new Action({text:$.t("Elliott Minor Retracement"),callbackContext:"LineToolElliottMinorRetr"}),new Action({text:$.t("Elliott Major Retracement"),callbackContext:"LineToolElliottMajorRetr"}),new ActionSeparator,new Action({text:$.t("Brush"),callbackContext:"LineToolBrush"}),new ActionSeparator,new Action({text:$.t("Forecast"),callbackContext:"LineToolPrediction"})],e=this,i=0;i<t.length;i++)t[i].callbacks().subscribe(null,function(e){TradingView.drawingState.tool.setValue(e.callbackContext())});i=new Action({text:$.t("Reset Chart")}),i.callbacks().subscribe(this,this.GUIResetScales);var n=new Action({text:$.t("Undo"),shortcut:"ctrl+z"});n.callbacks().subscribe(null,function(){TradingView.trackEvent("GUI","Undo"),A77.undo()}),n.disable();var o=new Action({text:$.t("Redo"),shortcut:"ctrl+y"});o.callbacks().subscribe(null,function(){TradingView.trackEvent("GUI","Redo"),A77.redo()}),o.disable(),A77.undoStack().onChange().subscribe(this,this.updateUndoRedo),
A77.redoStack().onChange().subscribe(this,this.updateUndoRedo);var r=new Action({text:$.t("Color Theme")}),s=new Action({text:$.t("TimeZone")}),a=new Action({text:$.t("Change Symbol...")});TVSettings.setValue("symboledit.dialog_last_entry",""),a.callbacks().subscribe(this,function(){A69.showDialog({callback:this.setSymbol.bind(this)})});var l=new Action({text:$.t("Change Interval...")});l.callbacks().subscribe(this,function(){new ChangeIntervalDialog({callback:function(e){A45.interval.setValue(e)}}).show()});var d=new Action({text:$.t("Add To Watchlist")});d.callbacks().subscribe(this,function(){for(var e,t=widgetbar.setPage("Watchlist, details and news"),i=0;i<t.widgets.length;i++)if("watchlist"==t.widgets[i].type){e=t.widgets[i].widgetObject;break}e&&e.addHighlight(this.getSymbol())});var h=new Action({text:$.t("Study Template")}),c=new Action({shortcut:"ctrl+alt+q",text:$.t("Reset Scale")});c.callbacks().subscribe(null,function(t){e.model().resetTimeScale()});var t=new Action({text:$.t("Insert Drawing Tool"),subActions:t}),p=new Action({text:$.t("Remove All Indicators")}),u=new Action({text:$.t("Remove All Drawing Tools")}),f=new Action({text:$.t("Insert Indicator...")}),g=new Action({text:$.t("Script Editor...")}),m=new Action({text:$.t("Compare or Add Symbol...")}),_=new Action({text:$.t("Compare...")}),v=new Action({text:$.t("Objects Tree...")}),y=new Action({text:$.t("Properties..."),callback:function(t,i){e.showChartProperties()}}),w=new Action({text:$.t("Scales Properties...")}),b=new Action({text:$.t("Timezone/Sessions Properties...")}),T=new Action({text:$.t("Lock/Unlock")});T.callbacks().subscribe(this,A7.prototype.toggleLockSelectedObject);var S=new Action({text:$.t("Hide")});S.callbacks().subscribe(this,A7.prototype.hideSelectedObject);var C=new Action({text:$.t("Format...")});C.callbacks().subscribe(this,A7.prototype.editSelectedObject);var x=new Action({text:$.t("Source Code...")});x.callbacks().subscribe(this,this.openSelectedObjectSource);var P=new Action({text:$.t("Show Left Axis"),checkable:!0});P.binder=new D14(P,this.D2.scalesProperties.showLeftScale,this.model(),"Show Left Scale");var A=new Action({text:$.t("Show Right Axis"),checkable:!0});A.binder=new D14(A,this.D2.scalesProperties.showRightScale,this.model(),"Show Right Scale"),this.D2.scalesProperties.showLeftScale.listeners().subscribe(this,A7.prototype._updateScalesActions),this.D2.scalesProperties.showRightScale.listeners().subscribe(this,A7.prototype._updateScalesActions);var L=new Action({text:$.t("Scale Price Chart Only"),checkable:!0});L.binder=new D14(L,this.D2.scalesProperties.scaleSeriesOnly,this.model(),$.t("Scale Price Chart Only"));var D=this.model().model();this.D2.scalesProperties.scaleSeriesOnly.listeners().subscribe(null,function(){D.recalculateAllPanes(),D.D20(new A22(A22.FULL_UPDATE))});var k=new Action({text:$.t("Drawings Toolbar"),checkable:!0});window.sideToolbar&&(k.binder=new D14(k,window.sideToolbar.visible,this.model(),"Drawings Toolbar"));var E=new Action({text:$.t("Favorite Drawings Toolbar"),checkable:!0});window.sideToolbar&&window.sideToolbar.favoriteDrawingToolbar&&(E.binder=new D14(E,window.sideToolbar.favoriteDrawingToolbar.visibleProperty,this.model(),"Drawings Toolbar"));var V=new Action({text:$.t("Magnet Mode"),checkable:!0});V.binder=new D14(V,TradingView.drawingState.properties().magnet,this.model(),"Magnet");var I=new Action({text:$.t("Stay In Drawing Mode"),checkable:!0});I.binder=new D14(I,TradingView.drawingState.properties().stayInDrawingMode,this.model(),"Stay In Drawing Mode");var M=new Action({text:$.t("Lock All Drawing Tools"),checkable:!0});M.binder=new D14(M,TradingView.drawingState.lockDrawings(),this.model(),"Lock drawings",function(e){e||this.binder.setValue(!this.binder.value()),TradingView.drawingState.lockDrawings().setValue(this.binder.value())}.bind(M));var W=new Action({text:$.t("Hide All Drawing Tools"),checkable:!0});W.binder=new D14(W,TradingView.drawingState.hideAllDrawings(),this.model(),"Hide All Drawing Tools",function(e){e||this.binder.setValue(!this.binder.value()),TradingView.drawingState.hideAllDrawings().setValue(this.binder.value())}.bind(W));var R=new Action({text:$.t("Hide Marks On Bars"),checkable:!0});R.binder=new D14(R,TradingView.drawingState.hideMarksOnBars(),this.model(),"Hide Marks On Bars",function(e){e||this.binder.setValue(!this.binder.value()),TradingView.drawingState.hideMarksOnBars().setValue(this.binder.value())}.bind(R));var B=new Action({text:$.t("Extended Hours"),checkable:!0});B.binder=new D14(B,this.model().mainSeries().properties().extendedHours,this.model(),"Change Extended Hours");var O=new Action({text:$.t("Show Symbol Last Value"),checkable:!0,checked:!1});O.binder=new D14(O,this.properties().scalesProperties.showSeriesLastValue,this.model(),"Show Symbol Last Value");var N=new Action({text:$.t("Show Indicator Last Value"),checkable:!0,checked:!1});N.binder=new D14(N,this.properties().scalesProperties.showStudyLastValue,this.model(),"Show Indicator Last Value"),N.callbacks().subscribe(this,function(){this._update()});var F=new Action({text:$.t("Show Countdown"),checkable:!0,checked:!1});F.binder=new D14(F,this.model().mainSeries().properties().showCountdown,this.model(),"Show Countdown"),this._actions={chartProperties:y,timeScaleReset:c,chartReset:i,compareOrAdd:m,compare:_,scalesProperties:w,tmzProperties:b,paneObjectTree:v,insertIndicator:f,insertDrawingTool:t,applyColorTheme:r,applyStudyTemplate:h,symbolSearch:a,changeInterval:l,addToWatchlist:d,seriesHide:S,studyHide:S,lineToggleLock:T,lineHide:S,showLeftAxis:P,showRightAxis:A,scaleSeriesOnly:L,drawingToolbarAction:k,favoriteDrawingToolbar:E,magnetAction:V,stayInDrawingModeAction:I,lockDrawingsAction:M,hideAllDrawingsAction:W,hideAllMarks:R,applyTimeZone:s,extendedHours:B,showCountdown:F,showSeriesLastValue:O,showStudyLastValue:N,undo:n,redo:o,viewSourceCode:x},W77.enabled("charting_library")||(this._actions.scriptEditor=g),this.createSessionBreaksActions(),this.readOnly()?(this._actions.paneResetAction=new Action({text:$.t("Reset")}),this._actions.paneLoadNewBarsAction=new Action({text:$.t("Load New Bars")}),this._actions.paneMakeItMineAction=new Action({text:this._containsData?$.t("Make It Mine"):$.t("Copy")}),this._actions.paneFullScreenAction=new Action({text:$.t("Full Screen")}),this._actions.paneResetAction.callbacks().subscribe(this,function(){resetScales()}),this._actions.paneLoadNewBarsAction.callbacks().subscribe(this,function(){requestData()}),this._actions.paneMakeItMineAction.callbacks().subscribe(this,function(e){return e._containsData?function(){submitChartGoToRealTimeForm()}:function(){open("/e/?clone="+e.metaInfo().uid,"_blank")}}(this)),this._actions.paneFullScreenAction.callbacks().subscribe(this,function(e){if(e._containsData)return function(){toggleFullscreen()};var t=new TradingView.FullscreenWidget;return function(){t.startFullscreen()}}(this))):(i=new Action({text:$.t("Remove"),shortcut:"del"}),i.callbacks().subscribe(this,function(){var e;this.D5&&(e=this.D5.activeChartWidget.value()),e||(e=this),e.removeSelectedSource()}),this._actions.insertDrawingTool=t,this._actions.paneRemoveAllStudies=p,this._actions.paneRemoveAllDrawingTools=u,this._actions.seriesRemove=i,this._actions.studyRemove=i,this._actions.lineRemove=i,this._actions.format=C,this._actions.lockDrawingsAction=M,this._actions.hideAllDrawingsAction=W,this._actions.hideAllMarks=R,this._actions.paneRemoveAllStudies.callbacks().subscribe(this,A7.prototype.removeAllStudies),this._actions.paneRemoveAllDrawingTools.callbacks().subscribe(this,A7.prototype.removeAllDrawingTools)),this._actions.paneObjectTree.callbacks().subscribe(this,A7.prototype.showSourceProperties),this._actions.chartProperties.callbacks().subscribe(this,A7.prototype.showChartProperties),this._actions.insertIndicator.callbacks().subscribe(this,A7.prototype.showIndicators),this._actions.scriptEditor&&this._actions.scriptEditor.callbacks().subscribe(this,A7.prototype.showScriptEditor),this._actions.compareOrAdd.callbacks().subscribe(this,A7.prototype.showCompareOrAdd),this._actions.compare.callbacks().subscribe(this,A7.prototype.showCompareOrAdd),this._actions.scalesProperties.callbacks().subscribe(this,A7.prototype.showScalesProperties),this._actions.tmzProperties.callbacks().subscribe(this,A7.prototype.showTimezoneProperties),this._updateScalesActions()},A7.prototype.executeActionByName=function(e){var t;e:{for(t in this._actions){var i=this._actions[t];if(i.text.toLowerCase()===e.toLowerCase()){t=i;break e}}t=null}t?t.callbacks().fire():console.warn("Unknown action: "+e)},A7.prototype._updateScalesActions=function(){if(this._actions){for(var e=0;e<this._paneWidgets.length;e++)this._paneWidgets[e].updateScalesVisibility();this._timeAxisWidget.updatePriceScalesVisibility(),this._update(new A22(A22.FULL_UPDATE))}},A7.prototype.removeAllStudies=function(){this.D0.removeAllStudies()},A7.prototype.removeAllDrawingTools=function(){this.D0.removeAllDrawingTools()},A7.prototype.model=function(){return this.D0},A7.prototype.connect=function(){this._handler=function(e){this._onData(e)}.bind(this),this._chartSession.connect(this._handler)},A7.prototype.finishInitWithoutConnect=function(){this._chartSession.disable(),this._init(),this.chartWidgetInitialized.fire()},A7.prototype.update=function(){if(this.D0){for(var e=0;e<this._paneWidgets.length;e++)this._paneWidgets[e].update();this._timeAxisWidget.update()}},A7.prototype.paint=function(e){e||(e=new A22(A22.FULL_UPDATE));for(var t=0;t<this._paneWidgets.length;t++)this._paneWidgets[t].paint(e.invalidateForPane(t),!1);this._timeAxisWidget&&this._timeAxisWidget.paint(e.fullInvalidation()),this._redrawPanes.fire()},A7.prototype._makeDefaultGui=function(){this._makeChartWidget(),this._makeLoadingScreen(),this._makeMasterTable(),this._makeTimeAxisWidget(),this._adjustSize(),this._updateScalesActions(),$("*",this._jqMainTable).selectable(!1),this.update(),this.paint()},A7.prototype.widget=function(){return this._jqMainDiv},A7.prototype.restoreState=function(e,t){this._adjustSize(),this.D0.restoreState(this._content,t),this._setActions()},A7.prototype.redrawPanes=function(e){$.each(this._paneWidgets,function(e){this.paint()}),this._redrawPanes.fire()},A7.prototype.adaptOnChartLogo=function(e){W77.enabled("adapt_onchart_logo_background")&&($(".onchart-custom-logo .wrapper .inner").css("background-color",generateColor(e,50)),$(".onchart-tv-logo .wrapper .inner").css("background-color",generateColor(e,20)))},A7.prototype.setBackgroundColor=function(e){this.adaptOnChartLogo(e.value()),this.scaleBackgroundColor=e.value(),$.each(this._paneWidgets,function(e){this.paint(),this.setCursorForTool()}),this.update(),this.paint()},A7.prototype.setScaleLineColor=function(e){this.scaleLineColor=e.value(),$.each(this._paneSeparators,function(){this.update()}),this.update(),this.paint()},A7.prototype.setScaleTextColor=function(e){this.scaleTextColor=e.value(),this.update(),this.paint()},A7.prototype._update=function(e){if(e&&e.fullInvalidation()!==A22.FULL_UPDATE){if(e.fullInvalidation()===A22.LIGHT_UPDATE){for(this._timeAxisWidget.update(),this.paint(new A22(A22.UPDATE_CURSOR_ONLY)),t=0;t<this._paneWidgets.length;t++)this._paneWidgets[t].statusWidget().update();this._dataWindowWidget&&this._dataWindowWidget.update()}else if(e.fullInvalidation()===A22.UPDATE_CURSOR_ONLY){for(t=0;t<this._paneWidgets.length;t++)this._paneWidgets[t].statusWidget().update();this._dataWindowWidget&&this._dataWindowWidget.update()}}else{this.D0&&this._updateGui(),this._adjustSize(),this._timeAxisWidget.update();for(var t=0;t<this._paneWidgets.length;t++)this._paneWidgets[t]._state=this.D0.panes().item(t),this._paneWidgets[t].statusWidget().updateLayout();this._dataWindowWidget&&this._dataWindowWidget.updateAll()}this.paint(e)},A7.prototype._createVolumeIfNeeded=function(){W77.enabled("create_volume_indicator_by_default")&&this._options.addVolume&&!this._content&&(W77.enabled("charting_library")?this.D0.mainSeries().onCompleted():this.D0.mainSeries().onSymbolResolved()).subscribe(this,function(){var e=this.D0.model().mainSeries().symbolInfo();e&&(e=!e.has_no_volume,!this.containsVolume()&&e?(e=factoryDefaults("chartproperties.volumePaneSize"),this.insertStudy("Volume@tv-basicstudies",!1,W77.enabled("volume_force_overlay"),void 0,{paneSize:e})):!e&&this.containsVolume()&&(e=this.model().D19().find(function(e){return e instanceof TradingView.Study&&"Volume"==e.metaInfo().shortId}),this.D0.model().removeSource(e)))},!W77.enabled("charting_library"))},A7.prototype._makeDefaultModel=function(){function e(){return makeDefaultChartModel(i._chartSession,function(e){if(!(e instanceof A22))throw Error("Invalid mask");i._invalidateMask?i._invalidateMask.merge(e):i._invalidateMask=e,i._draw_planned||(i._draw_planned=!0,requestAnimationFrame(t))},i.D2,i.readOnly(),n,i._studiesMetaData,i._studiesMigrations,i)}function t(){i._draw_planned=!1,!i._inLoadingState&&i._invalidateMask&&(i._invalidateMask=i._update(i._invalidateMask))}var i=this;if(this._content&&this._content.timeScale.points)var n={startDate:this._content.timeScale.points.items[0]};if(!this._studiesMetaData)throw Error("Cannot create chart model: studies metainfo is absent");W77.enabled("lean_chart_load")?this.D0=this.D0||e():this.D0=e(),this._createVolumeIfNeeded(),this._content?(this.restoreState(this._content,this._containsData),W77.enabled("chart_content_overrides_by_deafults")&&(this._defSymbol&&this.setSymbol(this._defSymbol),this._defInterval&&this.setResolution(this._defInterval),this._defStyle&&this.setSeriesStyle(this.D0.mainSeries(),this._defStyle))):this._setActions(),this.D0.onTagsChanged().subscribe(this,A7.prototype.onModelTagsChanged),this._updateGui(),this._modelCreated.fire(this.D0),this._tagsChanged.fire();var i=this,o=this.D0.mainSeries();this.D0.lineCancelled().subscribe(this,this.onLineCancelled),o.onSymbolNotPermitted().subscribe(null,function(e){o.properties().symbol.setValue(e)}),this._options.handleSessionErrors&&(o.chartTypeNotPermitted.subscribe(null,function(){o.properties().interval.setValue("D"),i._options.muteSessionErrors||A83.showGoProDialog({feature:"kagiRenko"})}),o.intradaySpreadNotPermitted.subscribe(null,function(){o.properties().interval.setValue("D"),i._options.muteSessionErrors||A83.showGoProDialog({feature:"intradaySpread"})}),o.customIntervalNotPermitted.subscribe(null,function(){o.properties().interval.setValue("D"),i._options.muteSessionErrors||A83.showGoProDialog({feature:"customIntervals"})}),o.intradayExchangeNotPermitted.subscribe(null,function(){if(o.properties().interval.setValue("D"),!i._options.muteSessionErrors){var e=o.symbolInfo().listed_exchange;TVChartApi.prototype.supportedExchangesList().forEach(function(t){t.value==e&&(e=t.name)}),A83.showGoProDialog({feature:"intradayExchange",exchangesButton:window.user.is_pro&&"pro_realtime_trial"!=window.user.pro_plan,exchange:e})}}),o.requestingIntradayWhenNotSupported.subscribe(null,function(){o.properties().interval.setValue("D"),i._options.muteSessionErrors||A83.showIntervalMismatchDialog()}),o.requestingResolutionWhenNotSupported.subscribe(null,function(e){o.properties().interval.setValue(e)}),i._options.muteSessionErrors||o.onExtendedHoursNotPermitted().subscribe(null,function(){A83.showGoProDialog({feature:"extendedHours"})})),this._readOnly||!TradingView.D18("paper_trading")||this._onWidget||TradingView.Trading.model().registerChartWidget(this)},A7.prototype._updateGui=function(){this.D0&&(this._makePaneWidgetsAndSeparators(),this._makeTimeAxisWidget(),$("*",this._jqMainTable).selectable(!1),this._adjustSize())},A7.prototype.setVisibleTimeRange=function(e,t,i){this._chartSession.setVisibleTimeRange(e,t,i)},A7.prototype._dateRangeResolutions=function(){return D16.availableTimeFrames(this.D0.mainSeries().symbolInfo(),this.D0.mainSeries().status())||[]},A7.prototype._makeChartWidget=function(){this._jqMainDiv=$(document.createElement("div")),this._jqMainDiv.addClass("chart-widget"),TradingView.setAbsoluteRect(this._jqMainDiv,this._rect),this._withDateRanges&&(W77.enabled("lean_chart_load")?!this._chartControlsBar:1)&&(this._chartControlsBar=$(document.createElement("div")).attr("class","chart-controls-bar").appendTo(this._jqParent),this._seriesControlWidget=new TradingView.SeriesControlWidget({parent:this._chartControlsBar,D3:this})),(this._options.controlBar||W77.enabled("control_bar"))&&(this._controlBarNavigation=new A9(this,this._jqMainDiv,!0)),this._containsData||this.createIndicatorImage()},A7.prototype._makeLoadingScreen=function(){W77.enabled("lean_chart_load")?this.screen||(this.screen=new A7.LoadingScreen(this,this._jqParent)):this.screen=new A7.LoadingScreen(this,this._jqMainDiv)},A7.prototype.setSymbol=function(e,t){if(this.D0){var i=this.D0.mainSeries();(t||!i.symbolSameAsCurrent(e)||W77.enabled("same_data_requery"))&&(this.D0.setSelectedSource(null),this.D0.setScreenChartProperty(i.properties().symbol,e,this,"Change Symbol",W77.enabled("same_data_requery")))}else this.D2.mainSeriesProperties.merge({symbol:e})},A7.prototype.getSymbol=function(e){var t;return(t=this.D0?this.D0.mainSeries().properties():this.D2.mainSeriesProperties)?e&&t.shortName&&t.shortName.value()?t.shortName.value():t.symbol.value():""},A7.LoadingScreen=function(e,t){this._cw=e,this.$element=$('<div class="chart-loading-screen">'),this.$shield=$('<div class="chart-loading-screen-shield">').appendTo(this.$element),this.$element.appendTo(t),this._showed=!1,this._cw.withModel(this,this._connectToModel)},A7.LoadingScreen.prototype._connectToModel=function(){this._cw.model().mainSeries().onDataLoaded().subscribe(this,function(e){switch(e.method){case"symbol_error":"permission denied"!==e.params[1]&&this.hide();break;case"series_completed":this.hide()}})},A7.LoadingScreen.prototype.show=function(){return this._cw._inLoadingState=!0,this._showed||this._cw.isDetached||(this._showed=!0,this._show()),$.Deferred().resolve()},A7.LoadingScreen.prototype._show=function(){var e=this._cw.properties().paneProperties.background.value();this.$shield.css("background",e),this.$element.addClass("fade")},A7.LoadingScreen.prototype.hide=function(){delete this._cw._inLoadingState,this._showed&&this._hide()},A7.LoadingScreen.prototype._hide=function(){this._showed=!1,this.$element.removeClass("fade")},A7.LoadingScreen.prototype.$canvas=null,A7.LoadingScreen.prototype.context=null,A7.prototype._makeMasterTable=function(){this._jqMainTable=$(document.createElement("table")),this._jqMainTable.appendTo(this._jqMainDiv),this._jqMainTable.addClass("chart-markup-table"),this._jqMainTable.attr("cellpading","0"),this._jqMainTable.attr("cellspacing","0")},A7.prototype._makePaneWidgetsAndSeparators=function(){for(var e=this.D0.panes().toArray(),t=e.length,i=this._paneWidgets.length,n=t;i>n;n++){var o=this._paneWidgets.pop();o.jqRow.remove(),o.jqRow.find("*").remove(),o.destroy();var r=this._paneSeparators.pop();r&&r.jqRow.remove()}for(n=i;t>n;n++)o=new A53(this,e[n],this._onWidget),this._paneWidgets.push(o),n>0&&(r=new A52(this,n-1,n),this._paneSeparators.push(r),this._timeAxisWidget?r.jqRow.insertBefore(this._timeAxisWidget.jqRow):r.jqRow.appendTo(this._jqMainTable)),this._timeAxisWidget?o.jqRow.insertBefore(this._timeAxisWidget.jqRow):o.jqRow.appendTo(this._jqMainTable);for(n=0;t>n;n++)i=e[n],o=this._paneWidgets[n],o.state()!==i&&o.setState(i);for(n=t;n--;)this._paneWidgets[n].updateControls()},A7.prototype._makeTimeAxisWidget=function(){this._timeAxisWidget||(this._timeAxisWidget=new A73(this,this._onWidget),this._timeAxisWidget.jqRow.appendTo(this._jqMainTable))},A7.prototype.insertStudyOrShowDialog=function(e){if(this.isSymbolicStudy(e)){var t=defaults("study_"+e.id).description;A83.showAddSymbolDialog(this,{title:t,okButtonTitle:$.t("Apply"),callback:function(t,i){var n={inputs:{symbol:t}};TradingView.trackEvent("GUI","Add Study"),this.model().insertStudy(e,n,i)}.bind(this)})}else this.hasConfirmInputs(e)?(t=defaults("study_"+e.id).description,A83.showConfirmInputsDialog(this,e,{title:t,okButtonTitle:$.t("Apply"),callback:function(t){TradingView.trackEvent("GUI","Add Study"),this.model().insertStudy(e,t,!1)}.bind(this)})):TradingView.Study.isPointsBasedStudy(e.id)?(t=TradingView.Study.lineToolNameForPointsBasedStudy(e.id),TradingView.drawingState.tool.setValue(t)):(TradingView.trackEvent("GUI","Add Study"),this.insertStudy(e.id,!0))},A7.prototype.hasConfirmInputs=function(e){if(e=e.inputs,void 0==e)return!1;for(var t=0;t<e.length;++t){var i=e[t];if(void 0!=i.confirm&&i.confirm)return!0}return!1},A7.prototype.isSymbolicStudy=function(e){switch(e.id){case"Overlay@tv-basicstudies":case"CorrelationCoefficient@tv-basicstudies":return!0;default:return!1}},A7.prototype.isPointsBasedStudy=function(e){return TradingView.Study.isPointsBasedStudy(e.id)},A7.prototype.insertStudy=function(e,t,i,n,o){e=StudyMetaInfo.findStudyMetaInfo(this._studiesMetaData,e),assert(!e.isTVScriptStubToCompile,"MetaInfo stub is unexpected here!"),n=n?{inputs:n}:{},o&&(n=$.extend(n,o)),t?this.D0.insertStudy(e,n,i):this.D0.model().insertStudy(e,n,i)},A7.prototype.insertStudyStub=function(e){return this.model().insertStudyStub(e)},A7.prototype.removeStudyStub=function(e){return this.model().removeStudyStub(e)},A7.prototype._adjustSize=function(){var e=0,t=0,i=0;$.each(this._paneWidgets,function(){e=Math.max(this.lhsPriceAxisWidget.optimalWidth(),e),t=Math.max(this.rhsPriceAxisWidget.optimalWidth(),t),i+=this.stretchFactor()});var n=this._rect,o=n.w-e-t,r=this._paneSeparators.length,s=A52.HEIGHT,a=this._timeAxisWidget.optimalHeight(),l=(n.h-s*r-a)/i;this._jqMainTable.width(n.w),this._jqMainTable.height(n.h);var d=this;$.each(this._paneWidgets,function(i){d.D0&&(this._state=d.D0.panes().item(i)),i=Math.max(Math.round(this.stretchFactor()*l),2),this.setPriceAxisSize(A54.LHS,new A61(e,i)),this.setPriceAxisSize(A54.RHS,new A61(t,i)),this.setSize(new A61(o,i)),d.D0&&this.state()&&d.D0.setPaneHeight(this.state(),i)}),this._timeAxisWidget.setSize(new A61(o,a),new A61(e,a),new A61(t,a)),this.D0&&this.D0.setWidth(o),this.maxLhsPriceAxisWidth!==e&&(this.maxLhsPriceAxisWidth=e,this.lhsPriceAxisWidthChanged.fire(e)),this.maxRhsPriceAxisWidth!==t&&(this.maxRhsPriceAxisWidth=t,this.rhsPriceAxisWidthChanged.fire(t))},A7.prototype._onData=function(e){switch(e.method){case"connected":this._onConnection();break;case"disconnected":this._onDisconnect();break;case"reconnect_bailout":this._reconnectBailout.fire();break;case"connection_error":this._onConnectionError(e.params[0]);break;case"critical_error":this._disconnected.fire(!0);break;default:this.D0.onData(e)}},A7.prototype._nextMetadataId=1,A7.prototype._onConnection=function(){this._online=!0,this.D0?(this.D0.restart(),this._updateGui(),this.update(),this.paint(),this._connected.fire()):(W77.enabled("charting_library")?this._chartSession.requestMetadata("metadata_"+A7._nextMetadataId,function(e){e=e.params[1];for(var t=0;t<e.length;++t)StudyMetaInfo.addStudyMetaInfo(this._studiesMetaData,_applyLocalizationToMetadata(e[t]));this._init(),this.chartWidgetInitialized.fire()}.bind(this)):(this._chartSession.requestMetadata("metadata_"+A7._nextMetadataId,function(e){this._onStudiesMetadata(e)}.bind(this)),"undefined"!=typeof scriptLib&&(this._tvScriptsRequestDfd=scriptLib.requestBuiltinAndUserScripts())),A7._nextMetadataId++)},A7.prototype._onDisconnect=function(){this.D0&&this.D0.disconnect(),this._online=!1,this.update(),this.paint(),this._disconnected.fire()},A7.prototype.studiesMetaData=function(){return this.D0.studiesMetaData()},A7.prototype._onConnectionError=function(e){this._disconnected.fire()},A7.prototype.getTimeScale=function(){return this._timeAxisWidget},A7.prototype.setSeriesStyle=function(e,t){this.D0.setProperty(e.properties().style,t)},A7.prototype.showSourceProperties=function(e){new ObjectTreeDialog({D3:this},this.D0).show()},A7.prototype.showChartProperties=function(e){return new EditObjectDialog(this.D0.mainSeries(),this.D0).show()},A7.prototype.showScriptEditor=function(){window.scriptEditor.show()},A7.prototype.showCompareOrAdd=function(){new CompareDialog(this.D5).show()},A7.prototype.showIndicators=function(){studyMarket.isVisible()?studyMarket.hide():studyMarket.show()},A7.prototype.showScalesProperties=function(e){return new EditObjectDialog(this.D0.mainSeries(),this.D0).show({selectScales:!0})},A7.prototype.showTimezoneProperties=function(){return new EditObjectDialog(this.D0.mainSeries(),this.D0).show({selectTmz:!0})},A7.prototype.removeSelectedSource=function(){var e=this.D0.selectedSource();!e||e===this.D0.mainSeries()||e===this.D0.lineBeingCreated()||e instanceof W96||e instanceof TradingView.ESDStudyBase||this.D0.removeSelectedSource()},A7.prototype.hideSelectedObject=function(){var e=this.D0.selectedSource();e&&this.D0.setProperty(e.properties().visible,!1,"Hide "+e.title())},A7.prototype.toggleLockSelectedObject=function(){var e=this.D0.selectedSource();if(e){var t=e.properties().frozen.value();this.D0.setProperty(e.properties().frozen,!t,(t?"Unlock":"Lock")+" "+e.title())}},A7.prototype.editSelectedObject=function(e){return(e=this.D0.selectedSource())?new EditObjectDialog(e,this.D0).show():void 0},A7.prototype.openSelectedObjectSource=function(e){(e=this.D0.selectedSource())&&e.metaInfo&&(e=e.metaInfo())&&e.TVScriptSourceCode&&e.scriptIdPart&&"undefined"!=typeof scriptEditor&&scriptEditor.show({scriptSource:e.TVScriptSourceCode,scriptIdPart:e.scriptIdPart})},A7.prototype.resetPriceAxisOptimalWidth=function(e){$.each(this._paneWidgets,function(){this.resetPriceAxisOptimalWidth(e)}),this._redrawPanes.fire()},A7.prototype.adjustPriceAxisWidth=function(e){this.resetPriceAxisOptimalWidth(e),this._adjustSize()},A7.prototype.setPriceAxisVisible=function(e,t){$.each(this._paneWidgets,function(){this.setPriceAxisVisible(e,t)}),this._timeAxisWidget.setStubVisible(e,t),this._adjustSize(),this._redrawPanes.fire()},A7.prototype.setTimeAxisVisible=function(e){this._timeAxisWidget.setVisible(e),this._adjustSize()},A7.prototype.isTextTool=function(e){switch(e){case"LineToolBalloon":case"LineToolText":case"LineToolTextAbsolute":case"LineToolCallout":case"LineToolNote":case"LineToolNoteAbsolute":return!0}return!1},A7.prototype.tags=function(){return this.D0?this.D0.calculateDefaultTags():[]},A7.prototype.state=function(e){return this.D0.state(e)},A7.prototype.asyncState=function(e){return this.D0.asyncState(e)},A7.prototype.metaInfo=function(){var e=this._metaInfo;return this.D0&&(e.systemTags=this.D0.calculateDefaultTags()),e},A7.prototype.image=function(){for(var e,t=document.createElement("canvas"),i=t.getContext("2d"),n=0,o=this._timeAxisWidget.size.h,r=this.properties().scalesProperties.lineColor.value(),s=0;s<this._paneWidgets.length;s++)(e=this._paneWidgets[s])&&e.state()&&(e.state().recalculate(!0),0===s&&(n=e.lhsPriceAxisWidget.size.w+e.size.w+e.rhsPriceAxisWidget.size.w),o+=e.size.h);o+=this._paneWidgets.length-1,this._update(),t.width=n+10,t.height=o+25+10,i.fillStyle="#F2F5F8",i.fillRect(0,0,t.width,t.height);var a=30,s=this.mainSeriesQuotesAndMetainfo();for(s.ohlc&&(s="{0} O:{1} H:{2} L:{3} C:{4}".format(s.meta.symbol,s.ohlc[0],s.ohlc[1],s.ohlc[2],s.ohlc[3]),i.fillStyle="#000",i.font="12px Verdana, Arial",i.fillText(s,5,20)),s=0;s<this._paneWidgets.length;s++)e=this._paneWidgets[s],i.drawImage(e.lhsPriceAxisWidget.canvas,5,a),i.drawImage(e.canvas,5+e.lhsPriceAxisWidget.size.w,a),e.statusWidget().renderTo(i,10,a+5),i.drawImage(e.rhsPriceAxisWidget.canvas,5+e.lhsPriceAxisWidget.size.w+e.size.w,a),a+=e.size.h,s<this._paneWidgets.length-1&&(i.fillStyle=r,i.fillRect(5,a,n,1),a++);return i.drawImage(this._timeAxisWidget.lhsCanvas,5,a),i.drawImage(this._timeAxisWidget.canvas,5+e.lhsPriceAxisWidget.size.w,a),i.drawImage(this._timeAxisWidget.rhsCanvas,5+e.lhsPriceAxisWidget.size.w+e.size.w,a),i.lineWidth=1,i.strokeStyle="#000",i.strokeRect(5.5,30.5,n-1,o-1),t},A7.prototype.images=function(){TradingView.printing=!0;var e=this.D0.selectedSource();this.D0.setSelectedSource(null);for(var t=[],i=0;i<this._paneWidgets.length;i++){var n=this._paneWidgets[i];n.paint(A22.LIGHT_UPDATE,this._onWidget);var o=n.image(this._onWidget);o.containsMainSeries=this._paneWidgets[i].containsMainSeries(),o.studies=[];for(var n=n.state().D19(),r=0;r<n.size();r++){var s=n.item(r);s instanceof TradingView.Study?s.properties().visible.value()&&s.statusView()&&this.properties().paneProperties.legendProperties.showStudyTitles.value()&&o.studies.push(s.statusView().text()):s instanceof TradingView.Series&&this.properties().paneProperties.legendProperties.showSeriesTitle.value()&&(o.mainSeriesText=s.statusView().text())}t.push(o),i<this._paneWidgets.length-1&&t.push(this._paneSeparators[i].image())}return this._timeAxisWidget.paint(A22.LIGHT_UPDATE),i=this._timeAxisWidget.image(),TradingView.printing=!1,this.D0.setSelectedSource(e),this.D0.D20(new A22(A22.LIGHT_UPDATE)),e=this.mainSeriesQuotesAndMetainfo(),{panes:t,timeAxis:i,colors:{text:this.properties().scalesProperties.textColor.value(),bg:this.properties().paneProperties.background.value(),scales:this.properties().scalesProperties.lineColor.value()},meta:e.meta,ohlc:e.ohlc,quotes:e.quotes}},A7.prototype.mainSeriesQuotesAndMetainfo=function(){var e,t,i,n=this.D0.mainSeries();if(n){var o=function(e){return null==e?"":n.formatter().format(e)+""},r=function(e){return null==e?"":e+""};e={resoluton:n.interval(),symbol:n.symbol()};var s=n.symbolInfo();s&&(e.symbol=s.full_name,e.description=s.description,e.exchange=s.exchange),(s=n.bars().last())&&(t=s.value.slice(1,5).map(o)),n.quoteData&&(i={change:o(n.quoteData.change),changePercent:r(n.quoteData.change_percent),last:o(n.quoteData.last_price)})}return{meta:e,ohlc:t,quotes:i}},A7.prototype.onTagsChanged=function(){return this._tagsChanged},A7.prototype.onModelTagsChanged=function(){this._tagsChanged.fire()},A7.prototype.destroy=function(){$(window).unbind("resize",this._resizeHandler),this.D0.model().destroy()},A7.prototype.title=function(){return $.t("Chart Properties")},A7.prototype.symbolProperty=function(){return this.D0.mainSeries().properties().shortName?this.D0.mainSeries().properties().shortName:this.D0.mainSeries().properties().symbol},A7.prototype.loadContent=function(e,t){this.screen.show();for(var i=this.D0.model().D19(),n=0;n<i.size();n++){var o=i.item(n);o!=this.D0.mainSeries()&&this.D0.model().removeSource(o,!0)}this._jqMainDiv&&(this._jqMainDiv.remove(),this._jqMainDiv=null),this._timeAxisWidget=null,this._paneWidgets=[],D16.purgeCache(),this.D0.mainSeries().purgeSymbolInfo(),this._setContent(e),t&&(D6.metaInfo.id.setValue(t.uid),D6.metaInfo.uid.setValue(t.uid),D6.metaInfo.name.setValue(t.name));for(var r,n=0;n<e.panes.length;++n)for(i=0;i<e.panes[n].sources.length;++i)if(e.panes[n].sources[i].state.symbol){r=e.panes[n].sources[i].state;break}if(!r)throw"An error occured while determining main series ion the chart";this.D2.mainSeriesProperties.merge({visible:!0,symbol:r.symbol,timeframe:"",onWidget:this._onWidget,interval:r.interval||"D",style:r.style}),this._init(),A45.interval.setValue(r.interval),A77.clearStack(),this._seriesControlWidget&&this._seriesControlWidget.updateUI(),this.createLogo&&!W77.enabled("move_logo_to_main_pane")&&this.createLogo(void 0,this._jqMainDiv)},A7.prototype._setContent=function(e){e&&e.panes.forEach(function(e){e.sources=e.sources.filter(function(e){return e?"MainSeries"==e.type?!0:e.points&&e.points.some(function(e){return null===e.time_t||!isFinite(e.time_t)})?(TradingView.logNormal("Dropped invalid "+e.type+". Reason: non-numeric point time"),!1):!0:!1});var t=function(t){return e.sources&&e.sources.some(function(e){return e.id==t})};e.leftAxisSources&&(e.leftAxisSources=e.leftAxisSources.filter(t)),e.rightAxisSources&&(e.rightAxisSources=e.rightAxisSources.filter(t))}),this._content=e},A7.prototype._contentSeriesProperties=function(){if(this._content)for(var e=this._content.panes.length;0<e--;)for(var t=this._content.panes[e].sources,i=t.length;0<i--;)if("MainSeries"===t[i].type)return t[i].state;
},A7.prototype.updateUndoRedo=function(){A77.undoStack().isEmpty()?this.actions().undo.setEnabled(!1):this.actions().undo.setEnabled(!0),A77.redoStack().isEmpty()?this.actions().redo.setEnabled(!1):this.actions().redo.setEnabled(!0)},A7.prototype.createSessionBreaksActions=function(e){var t,i=this,n=function(){t=new Action({text:$.t("Session Breaks"),checkable:!0}),t.binder=new D14(t,i.model().mainSeries().sessionsStudy().properties().graphics.vertlines.sessBreaks.visible,i.model(),"Session Breaks"),i._actions.sessionBreaks=t};i.model().mainSeries().sessionsStudy()?n():i.model().mainSeries().onSessionsStudyCreated().subscribe(i,function(){n()})},A7.prototype.updateActionForIntradayOnly=function(e){!e||!e instanceof Action||e.setEnabled(!!this.model().mainSeries().isIntradayInterval())},A7.prototype.withModel=function(e,t){this.model()?t.call(e):this.modelCreated().subscribe(e,t,!0)},A7.prototype.containsVolume=function(){return!!this.model().D19().find(function(e){return e instanceof TradingView.Study&&"Volume"==e.metaInfo().shortId})},A7.prototype.containsStudy=function(e){return this.D0?!!this.D0.D19().find(function(t){return t instanceof TradingView.Study?(t=t.metaInfo(),t.id===e||t.fullId===e):!1}):!1},A7.prototype.containsSessions=function(){return!!this.model().D19().find(function(e){return e instanceof TradingView.Study&&"Sessions"==e.metaInfo().shortId})},A7.prototype.isSmall=function(e){return this.constructor.isSmall(this._jqParent)},A7.isSmall=function(e){return 550>e.width()||300>e.height()},A7.prototype.onWidget=function(){return this._onWidget},A7.prototype.onCmeWidget=function(){return this._onCmeWidget},A7.prototype.resize=function(){this._resizeHandler&&this._jqMainDiv&&this._resizeHandler()},A7.prototype.chartSession=function(){return this._chartSession},A7.prototype.maxLhsPriceAxisWidth=0,A7.prototype.maxRhsPriceAxisWidth=0,A7.prototype.GUIResetScales=function(){TradingView.trackEvent("GUI","Reset Scales"),this.model()&&(this._containsData?this.model().chartModel().restoreAxisState(this._content):this._controlBarNavigation&&this._controlBarNavigation.resetButtons(),this.model().resetScales())},A7.prototype.onLineCancelled=function(){TradingView.drawingState.resetToCursor()},A7.prototype.createIndicatorImage=function(){var e=this;this.indicatorImage=$('<span class="chart-status-picture"></span>').appendTo(this._jqMainDiv),e.onWidget()||$('<span class="bats-warning"></span>').appendTo(this.indicatorImage).on("click",function(){TradingView.isProRealtime()||(location.href="/gopro/")}).blueTooltip("<p><b>Warning:</b> This symbol is provided by BATS electronic exchange.</p><p>BATS real-time data is different from the &ldquo;official&rdquo; data and offers approximate volumes with fewer price updates.</p><p>If those differences are important to your analysis then you'll want to use our PRO service which allows you to subscribe to real-time data from the exchanges.</p>","bottom","double-width"),this.indicatorText=$('<span class="series-status-text"><span class="dot"></span>&nbsp;<span class="text"></span>&nbsp;<span class="market-status"></span></span>').appendTo(this.indicatorImage),e.withModel(null,function(){var t=e.D0.mainSeries();t.onStatusChanged().subscribe(null,e.updateIndicatorImage.bind(e)),t.marketStatus.subscribe(e.updateIndicatorImage.bind(e)),e.updateIndicatorImage()}),e.rhsPriceAxisWidthChanged.subscribe(e,e.updateIndicatorImagePosition),e.updateIndicatorImagePosition()},A7.prototype.updateIndicatorImage=function(){function e(e,t){return r.hasOwnProperty(e)?r[e]:t}var t=this.indicatorImage;if(this.indicatorImage){var i=this.D0;if(i){var i=i.mainSeries(),n=i.status(),o=this._statusDetails(),r=null,r=o.hasOwnProperty(n)?o[n]:o.defaults,n=e("showBatsWarn",!0),o=(o=i.symbolInfo())&&o.full_name,n=!!(n&&o&&A68.hasBatsSymbols(o));t.find(".bats-warning").toggleClass("warn-bats",n),t.attr("title",e("title","")),this._updateDataAndMarketStatus(i.marketStatus.value(),i.status())}}},A7.prototype._statusDetails=function(){return this.__statusDetails||(this.__statusDetails={},this.__statusDetails[TradingView.Series.STATUS_SNAPSHOT]={className:"snapshot",text:$.t(""),showBatsWarn:!1,priority:1},this.__statusDetails[TradingView.Series.STATUS_LOADING]=this.__statusDetails[TradingView.Series.STATUS_RESOLVING]={className:"loading",text:$.t("loading data"),priority:1},this.__statusDetails[TradingView.Series.STATUS_INVALID_SYMBOL]={className:"invalid",text:$.t("invalid symbol"),showBatsWarn:!1,priority:1},this.__statusDetails[TradingView.Series.STATUS_OFFLINE]={className:"connecting",text:$.t("retrying"),priority:1},this.__statusDetails[TradingView.Series.STATUS_EOD]=this.__statusDetails[TradingView.Series.STATUS_PULSE]={className:"eod",text:$.t("eod data"),priority:1},this.__statusDetails[TradingView.Series.STATUS_DELAYED]={className:"delayed",title:$.t("Quotes are delayed by 10 min and updated every 30 seconds"),text:$.t("eod delayed"),priority:1},this.__statusDetails[TradingView.Series.STATUS_DELAYED_STREAMING]={className:"delayed-streaming",text:$.t("delayed"),priority:1},this.__statusDetails[TradingView.Series.STATUS_READY]=this.__statusDetails.defaults={className:"realtime",text:$.t("realtime"),priority:-1},this.__statusDetails.pre_market={text:$.t("pre-market"),className:"pre-market",priority:0},this.__statusDetails.post_market={text:$.t("post-market"),className:"post-market",priority:0},this.__statusDetails.out_of_session={text:$.t("closed"),className:"out-of-session",priority:0},this.__statusDetails.market=this.__statusDetails.defaults),this.__statusDetails},A7.prototype._updateDataAndMarketStatus=function(e,t){var i=this._resultingStatusRecord(e,t);this.indicatorText.removeClass().addClass("series-status-text "+i.className),this.indicatorText.find(".text").html(i.text)},A7.prototype._resultingStatusRecord=function(e,t){if(e){var i=this._statusDetails()[e],n=this._statusDetails()[t];return n||(n=this._statusDetails().defaults),n.priority>i.priority?n:i}return this._statusDetails()[t]},A7.prototype.updateIndicatorImagePosition=function(){var e=this.indicatorImage;this.indicatorImage&&e.css("marginRight",this.maxRhsPriceAxisWidth)},A7.prototype._startSpinner=function(e){"function"==typeof Spinner&&!this._spinner&&(e=$(e).get(0))&&(this._spinner=new Spinner({lines:15,length:0,width:6,radius:20,corners:1,rotate:0,direction:1,color:"#333",speed:.75,trail:74,shadow:!1,hwaccel:!1,className:"spinner",top:"50%",left:"50%"}).spin(e))},A7.prototype.isJustClonedChart=function(){return!!(this._options||{}).justCloned},A8=function(e){function t(){M&&M(I);var e=y||{};y={width:I.width(),height:I.height()};var t=I[0];if(window.self!==window.top&&t.offsetWidth<t.clientWidth&&100>t.getBoundingClientRect().width){var n=Math.round(100*t.getBoundingClientRect().width),t=Math.round(100*t.getBoundingClientRect().height);y={width:n,height:t}}if(n=!1,e.height===y.height&&e.width===y.width&&w||(n=!0),n)if(L)i(v);else for(e=0;e<w.count;e++)i(e)}function i(e){var t=_[e];if(t){var i=L?A8.LayoutTemplates.s.sizer(0,y,u,f):w.sizer(e,y,u,f);_[e].wrap.css({width:i.width||0,height:i.height||0,top:i.top||0,left:i.left||0}),t.metrics&&t.metrics.width===i.width&&t.metrics.height===i.height||(t.metrics=i,t.D3&&t.D3.resize())}}function n(e){e=$.extend({D6:p},e||{});var t,n=$(document.createElement("div")).addClass("chart-container").appendTo(I).css("position","absolute");n.on("mousedown touchstart",function(){g.setValue(t)});var o=_.length,a={wrap:n};return _.push(a),i(o),e.jqParent=n,a.D3=t=new A7(e),p.firstWidgetInitialized||t.chartWidgetInitialized.subscribe(null,function(){try{JsBridge.sendEvent("chart_widget_initialized")}catch(e){}p.firstWidgetInitialized=!0},!0),e.containsData?t.finishInitWithoutConnect():t.connect(),r(),s(),t}function o(e,t){b=e,L=t,D.setValue(L),w=A8.LayoutTemplates[e];var o=w.count;y={width:I.width(),height:I.height()};for(var s=0;o>s||s<_.length;s++)(t?v===s:o>s)?(_[s]?(I.append(_[s].wrap),_[s].D3.isDetached=!1):n($.extend({},k,T.shift()||(g.value()?{content:g.value().state()}:null)||{})),_[s].wrap.toggleClass("multiple",o>1),i(s)):_[s]&&(_[s].D3.isDetached=!0,_[s].wrap.detach());r()}function r(){var e=Math.min(w.count,_.length)-1;if(0>e)g.deleteValue();else{var t=v;0>t&&(t=0),t>e&&(t=e),g.setValue(_[t].D3)}}function s(){for(var e=_.length;e--;){var t=e===v;_[e].wrap.toggleClass("active",t).toggleClass("inactive",!t)}}function a(e){var t=e.mainSeries().properties();t.style.subscribe(null,l),l(t.style),e.model().onSelectedSourceChanged().subscribe(null,d),d(e.selectedSource())}function l(e){W.setValue(e.value())}function d(e){R.setValue(e)}function h(e){for(var t=!1,i=0;i<_.length;i++){var n=_[i].D3;(n.model().mainSeries().properties().symbol.value()!==e||W77.enabled("same_data_requery"))&&(t||(A77.beginUndoMacro("Change Symbol"),t=!0),n.setSymbol(e))}t&&A77.endUndoMacro()}function c(e){return"s"===e||window.user&&user.is_pro||k.containsData||m?e:(A83.showGoProDialog({feature:"multipleCharts"}),"s")}var p=this,u=2,f=0,g=new WatchedValue,m=!1,_=[],v=0,y=null,w=null,b="s",T=[],S=new WatchedValue(!1),C=new WatchedValue(!1),x=new WatchedValue(TVSettings.getBool("chart.syncCrosshair",!0)),P=x.value();x.subscribe(function(e){P=e=!!e,TVSettings.setValue("chart.syncCrosshair",e)});var A=new WatchedValue(b),L=!1,D=new WatchedValue(L);e=e||{},"padding"in e&&(u=e.padding),"edge"in e&&(f=e.edge);var k=e.widgetOptions||{};k.readOnly&&(m=!0);var E=e.metaInfo||{},V={id:new WatchedValue(E.id),name:new WatchedValue(E.name),description:new WatchedValue(E.description),username:new WatchedValue(E.username),uid:new WatchedValue(E.uid)},I=$(e.jqParent).eq(0),M=e.onResize;this.updateLayout=t;var W=new WatchedValue,R=new WatchedValue;W.subscribe(function(e){var t=g.value();if(t&&(t=t.model())){var i=t.mainSeries().properties().style;i.value()!==e&&t.setChartStyleProperty(i,e,"Change Series Style")}});var B=null;if(g.subscribe(function(e){if(e){for(var t,i=_.length;i--;)if(_[i].D3===e){t=i;break}if(!isFinite(t))throw Error("Cannot make detached ChartWidget active");v!==t&&(v=t,s()),B!==e&&(B&&(B.modelCreated().unsubscribe(null,a),t=B.model())&&(t.mainSeries().properties().style.unsubscribe(null,l),t.model().onSelectedSourceChanged().unsubscribe(null,d),B=null),e&&((t=e.model())?a(t):e.modelCreated().subscribe(null,a),B=e))}},{callWithLast:!0}),$.extend(this,{createChartWidget:n,getAll:function(){return _.map(function(e){return e.D3})},destroy:function(){return _.forEach(function(e){e.D3.destroy()})},layout:A,maximizeCurrentChart:D,activeChartWidget:g,activeChartStyle:W,selectedSource:R.readonly(),metaInfo:V,state:function(e){for(var t=[],i=A8.LayoutTemplates[b].count,n=0;i>n;n++)t.push(_[n].D3.state(e));return e={layout:b,charts:t},S.value()&&(e.symbolLock=1),C.value()&&(e.intervalLock=1),e},asyncState:function(e){for(var t=$.Deferred(),i=[],n=A8.LayoutTemplates[b].count,o=0;n>o;o++)i.push(_[o].D3.asyncState(e));return $.when.apply($,i).then(function(){for(var e={charts:[]},i=0;i<arguments.length;i++)e.charts.push(arguments[i]);t.resolve(e)}),t},readOnly:function(){return m},lock:{symbol:S,setSymbolLockWithUndo:function(e){if(e!==S.value()){if(A77.beginUndoMacro("Symbol Lock"),e)for(var t=g.value(),i=t.getSymbol(),n=0;n<_.length;n++){var o=_[n].D3;o!==t&&o.getSymbol()!==i&&o.setSymbol(i)}A77.setWatchedValue(S,e,"Symbol Lock"),A77.endUndoMacro()}},interval:C,setIntervalLockWithUndo:function(e){if(e!==C.value()){if(A77.beginUndoMacro("Interval Lock"),e)for(var t=g.value(),i=t.getResolution(),n=0;n<_.length;n++){var o=_[n].D3;o!==t&&o.getResolution()!==i&&o.setResolution(i)}A77.setWatchedValue(C,e,"Resolution Lock"),A77.endUndoMacro()}},crosshair:x},setSymbol:function(e){S.value()?h(e):g.value().setSymbol(e)},setResolution:function(e){if(C.value()){for(var t=!1,i=0;i<_.length;i++){var n=_[i].D3;n.model().mainSeries().properties().interval.value()!==e&&(t||(A77.beginUndoMacro("Change Resolution"),t=!0),n.setResolution(e))}t&&A77.endUndoMacro()}else g.value().setResolution(e)},updateLayout:t,images:function(e){if(e&&e.onlyActiveChart||L)return{layout:"s",hidpiRatio:window.hidpiCanvasRatio||1,charts:[g.value().images()]};e=[];for(var t=w.count,i=0;i<_.length&&t>i;i++)e.push(_[i].D3.images());return{layout:b,hidpiRatio:window.hidpiCanvasRatio||1,charts:e}},syncCrosshair:function(e,t){if(P&&!L)for(var i=w.count,n=0;n<_.length&&i>n;n++){var o=_[n].D3;o!==t&&(o=o.model())&&o.model().setExternalPosition(e)}},setSymbolAll:h,clearChartMetaInfo:function(){V.id.setValue(void 0),V.uid.setValue(void 0),V.name.setValue(void 0)}}),e=e.content){for(e.charts||(e={layout:"s",charts:[e]}),b=c(e.layout||"s"),x=0;x<e.charts.length;x++)T.push({content:e.charts[x]});e.symbolLock&&S.setValue(!0),e.intervalLock&&C.setValue(!0),e=null}A.setValue(b),o(b,L),T.splice(0,T.length),A.subscribe(function(e){o(e,!1)}),A.hook=function(e){return e===this.value()?e:c(e)},m&&(A.writeLock=!0),D.subscribe(function(e){e!==L&&o(b,e)}),$(window).on("resize",t)},A8.LayoutTemplates={s:{title:"1 chart",count:1,sizer:function(e,t,i,n){return{width:t.width-n-n,height:t.height-n-n,top:n,left:n}}},"2h":{title:"2-up Horizontal",count:2,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=o-i>>1;switch(e){case 0:return{width:r,height:t,top:n,left:n};case 1:return e=i+r,{width:o-e,height:t,top:n,left:n+e}}}},"2v":{title:"2-up Vertical",count:2,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=t-i>>1;switch(e){case 0:return{width:o,height:r,top:n,left:n};case 1:return e=i+r,{width:o,height:t-e,top:e+n,left:n}}}},"3h":{title:"3-up Horizontal",count:3,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=(o-i-i)/3|0;switch(e){case 0:return{width:r,height:t,top:n,left:n};case 1:return{width:r,height:t,top:n,left:i+r+n};case 2:return e=2*(i+r),{width:o-e,height:t,top:n,left:e+n}}}},"3v":{title:"3-up Vertical",count:3,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=(t-i-i)/3|0;switch(e){case 0:return{width:o,height:r,top:n,left:n};case 1:return{width:o,height:r,top:i+r+n,left:n};case 2:return e=2*(i+r),{width:o,height:t-e,top:e+n,left:n}}}},"3s":{title:"3-up Stacked",count:3,sizer:function(e,t,i,n){var o=t.height-n-n,r=o-i>>1;switch(t=t.width-n-n-i>>1,e){case 0:return{width:t,height:o,left:n,top:n};case 1:return{width:t,height:r,left:t+i+n,top:n};case 2:return e=i+r,{width:t,height:o-e,left:t+i+n,top:e+n}}}},4:{title:"4-up",count:4,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=t-i>>1,s=o-i>>1;switch(e){case 0:return{width:s,height:r,left:n,top:n};case 1:return e=r+i,{width:s,height:t-e,left:n,top:e+n};case 2:return i=s+i,{width:o-i,height:r,left:i+n,top:n};case 3:return e=r+i,i=s+i,{width:o-i,height:t-e,left:i+n,top:e+n}}}},6:{title:"6-up",count:6,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=t-i>>1,s=(o-i-i)/3|0;switch(e){case 0:return{width:s,height:r,left:n,top:n};case 1:return e=r+i,{width:s,height:t-e,left:n,top:e+n};case 2:return{width:s,height:r,left:s+i+n,top:n};case 3:return e=r+i,{width:s,height:t-e,left:s+i+n,top:e+n};case 4:return s=s+i+s+i,{width:o-s,height:r,left:s+n,top:n};case 5:return s=s+i+s+i,e=r+i,{width:o-s,height:t-e,left:s+n,top:e+n}}}},8:{title:"8-up",count:8,sizer:function(e,t,i,n){var o=t.width-n-n;t=t.height-n-n;var r=t-i>>1,s=o-3*i>>2;switch(e){case 0:return{width:s,height:r,left:n,top:n};case 1:return e=r+i,{width:s,height:t-e,left:n,top:e+n};case 2:return{width:s,height:r,left:s+i+n,top:n};case 3:return e=r+i,{width:s,height:t-e,left:s+i+n,top:e+n};case 4:return{width:s,height:r,left:s+i+s+i+n,top:n};case 5:return e=r+i,{width:s,height:t-e,left:s+i+s+i+n,top:e+n};case 6:return s=3*(s+i),{width:o-s,height:r,left:s+n,top:n};case 7:return s=3*(s+i),e=r+i,{width:o-s,height:t-e,left:s+n,top:e+n}}}}},CompareWidget.prototype.addCompareSymbol=function(e,t,i){if((t=this.D5.activeChartWidget.value())&&(t=t.model())){for(var n,o=t.mainSeries().interval(),r=t.studiesMetaData(),s=0;s<r.size();s++)"Compare@tv-basicstudies"===r.item(s).id&&(n=r.item(s));return e={exchange:i,inputs:{symbol:e,resolution:o}},TradingView.trackEvent("GUI","Add Compare"),t.insertStudy(n,e)}},CompareWidget.prototype.removeCompareSymbol=function(e){var t=this.D5.activeChartWidget.value();if(t&&(t=t.model()))for(var i=t.D19(),n=0;n<i.size();n++){var o=i.item(n);if(o._metaInfo&&"Compare@tv-basicstudies"===o._metaInfo.id){var r=o.properties().inputs.symbol.value();(r===e||this.symbolAlias[r]&&this.symbolAlias[r]===e)&&t.removeSource(o)}}},CompareWidget.prototype._createPredefinesList_normal=function(){var e,t,i=this;for(t in this.predefines){predefine=$('<div class="predefine-section">').appendTo(this._widget);for(var n in this.predefines[t])line=$('<div class="predefine-line"></div>').appendTo(predefine),checkbox=$('<input type="checkbox" id="predefine-checkbox-'+this.symbolToId(this.predefines[t][n])+'"/>').appendTo(line),checkbox.change({symbol:this.predefines[t][n]},function(t){$(this).is(":checked")?(e=i.addCompareSymbol(t.data.symbol))||$(this).attr("checked",!1):i.removeCompareSymbol(t.data.symbol)}),$('<label for="predefine-checkbox-'+this.symbolToId(this.predefines[t][n])+'">'+n+"</label>").appendTo(line)}$('<div class="clear"></div>').appendTo(this._widget)},CompareWidget.prototype.init=function(){var e=this;this._widget=$('<div class="compare-widget"></div>');var t=$('<div class="symbol-edit-widget">');this.input=$('<input type="text" class="symbol-edit with-plus single" placeholder="'+$.t("Company Comparison")+'" autocomplete="off">').appendTo(t);var i=$('<a class="symbol-edit-plus" title="'+$.t("Company Comparison")+'"><span></span></a>').appendTo(t),n=A69.bindToInput(this.input,{callback:function(t){e.addCompareSymbol(t)},keepFocus:!0,clearAfterAccept:!0});i.click(function(){n.acceptTypeIn()}),t.appendTo(this._widget),W77.enabled("charting_library")||this._createPredefinesList_normal()},CompareWidget.prototype.show=function(){var e=this.D5.activeChartWidget.value();if(e&&(e=e.model()))for(p in e=e.D19(),this.init(),this._widget.find('input[id^="predefine-checkbox"]').attr("checked",!1),this.predefines)for(i in this.predefines[p])for(var t=this._widget.find("#predefine-checkbox-"+this.symbolToId(this.predefines[p][i])),n=0;n<e.size();n++){var o=e.item(n);if(o._metaInfo&&"Compare@tv-basicstudies"===o._metaInfo.id){var r=this.predefines[p][i],o=o.properties().inputs.symbol.value();(o===r||this.symbolAlias[o]&&this.symbolAlias[o]===r)&&t.attr("checked",!0)}}},CompareWidget.prototype.symbolToId=function(e){return e.replace(/[^a-z0-9]/gi,"_")},CompareWidget.prototype.focus=function(){Modernizr.touch||this.input.focus()},CompareDialog.prototype.tabChanged=function(e){0===e?this.compareTab.focus():this.addSymbolTab.focus()},CompareDialog.prototype.show=function(){TradingView.trackEvent("GUI","Compare Add");var e=A83.createDialog("Compare Add",{hideTitle:!0,dragHandle:".properties-tabs"}),t=e.find(".tv-dialog-content");e.css("min-width",0),t.css("min-width",0);var i=$('<div class="properties-tabs"></div>').appendTo(t);$('<a href="#" class="properties-tabs-label"></a>').text($.t("Compare")).appendTo(i),$('<a href="#" class="properties-tabs-label"></a>').text($.t("Add Symbol")).appendTo(i);var t=$("<div>").appendTo(t),n=$('<div class="main-tree-page compare active">').appendTo(t),o=$('<div class="main-tree-page compare">').appendTo(t);return this.compareTab=new CompareWidget(this.D6),this.addSymbolTab=new AddSymbolWidget(this.D6),this.compareTab.show(),n.append(this.compareTab._widget),this.addSymbolTab.show(),o.append(this.addSymbolTab._widget),this.tabs=new A71(i,t,{saveTab:"CompareAddDialog.tab"}),this.tabs.tabChanged.subscribe(this,this.tabChanged),A83.applyHandlers(e),A83.positionDialog(e,this.position),e},AddSymbolWidget.prototype.init=function(){var e=this;this._widget=$('<div class="addsymbol-widget"></div>');var t=$('<div class="symbol-edit-widget">'),i=$('<input type="text" class="symbol-edit with-plus single" placeholder="'+$.t("Symbol")+'" autocomplete="off">').appendTo(t);this._input=i;var n=$('<a class="symbol-edit-plus"><span></span></a>').appendTo(t),o=A69.bindToInput(i,{callback:function(t){var i=e.D5.activeChartWidget.value();i&&i.addSymbol(t,e._checkbox.is(":checked"))},keepFocus:!0,clearAfterAccept:!0});n.on("click",function(){o.acceptTypeIn()}),t.appendTo(this._widget),t=$('<div class="opts-line">').appendTo(this._widget),i="addsymbol-widget-overlay-"+TradingView.guid(),this._checkbox=$('<input type="checkbox" id="'+i+'">').appendTo(t),this._checkbox.on("click",function(){TVSettings.setValue("showAddSymbolDialog.checkboxState",$(this).is(":checked"))}),$('<label for="'+i+'">'+$.t("Overlay the main chart")+"</label>").appendTo(t)},AddSymbolWidget.prototype.show=function(){this.focus(),this._checkbox.attr("checked",TVSettings.getBool("showAddSymbolDialog.checkboxState",!0))},AddSymbolWidget.prototype.focus=function(){Modernizr.touch||this._input.focus()},TradingView.SYMBOL_SEARCH_MAX_LENGTH=100,A4=function(){},A4.prototype._createBackButton=function(e){var t=e.createGroup().appendTo(e._$left);e._backButton=$('<div class="mobile-back-button"><i></i></div>').click(function(){1<window.history.length&&window.history.back(),window.location.pathname="/"}).appendTo(t)},A4.prototype._createBarsGroup=function(e){var t=this.createGroup({single:!0});return e._style_list.element().appendTo(t),t},A4.prototype._createPropertiesGroup=function(e,t){var i=this.createGroup({single:!0});if(!this._onWidget){var n=$("<span>").addClass("button iconed properties apply-common-tooltip").append($("<i>")).appendTo(i);n.on(e,function(e){e.pageX=n.offset().left,e.pageY=n.offset().top+n.height()+15,e=t.activeChartWidget.value().showChartProperties({_lastEvent:e}),n.addClass("active"),e.on("destroy",function(){n.removeClass("active")})}),n.attr("title",$.t("Chart Properties"))}return i},A4.prototype._createCompareGroup=function(e,t,i){e=this.createGroup({single:!0});var n=$('<a class="button iconed toggle-caption compare apply-common-tooltip">').append($("<i>")).append($('<span class="caption">Compare</span>')).appendTo(e);return this._compareButton=n,this._compareButton.on(i,function(e){e.preventDefault(),e=new CompareDialog(t).show(),n.addClass("active"),e.on("destroy",function(){n.removeClass("active")})}),this._compareButton.attr("title",$.t("Compare or Add Symbol")),e},A4.prototype._createIndicatorsGroup=function(e,t){var i=this.createGroup({single:!0});return this._indicatorsButton=$('<a class="button iconed toggle-caption indicators'+(this._onWidget?" no-last":"")+' apply-common-tooltip">').append($("<i>")).append($('<span class="caption">Indicators</span>')).appendTo(i),this._indicatorsButton.attr("title",$.t("Indicators, Fundamentals, Economy and Add-ons")),this._indicatorsButton.on(e,function(e){e.stopPropagation(),e.preventDefault(),studyMarket.isVisible()?studyMarket.hide():studyMarket.show()}),TradingView.keyboardBinder.registerListener("IndicatorsHotkey",function(e){return"47"==e.which&&$(e.target).is("body")&&!studyMarket.isVisible()?(studyMarket.show(),studyMarket.selectSearchPage(),e.preventDefault(),e.stopPropagation(),!0):void 0}),studyMarket.visibilityChanged.subscribe(this,function(e){this._indicatorsButton.toggleClass("active",e)}),TradingView.onWidget()||W77.enabled("charting_library")||studyTemplates.appendMenuButtonTo(i),i},A4.prototype.createGroup=function(e){e||(e={});var t=$("<div>").addClass("group");return e.right&&t.addClass("right"),e.single?t.addClass("space-single"):null,t},A4.prototype.bindToModel=function(){var e=this.D4.model();e.mainSeries().properties(),this.D0=e},A4.prototype.backButton=function(){return this._backButton},A4.prototype.saveLoadWidget=function(){return this._saveLoad||console.warn("No save-load widget created in footer")},A4.prototype.styleIconPosition=function(e){return"-%1px 0".replace("%1",19*~~e)},A4.styleIconPosition=A4.prototype.styleIconPosition,A5=function(e){e=e||{};var t=this.D5=e.D6,i=this.D4=t.activeChartWidget.value(),n=this._onWidget=i.onWidget(),o=this,r=Modernizr.touch?"touchstart":"click",s=$(".header-chart-panel").eq(0);if(this._$right=s.find(".right"),this._$left=s.find(".left"),this._itemsVisibility=e.itemsVisibility,TradingView.isMobileView&&!TradingView.winMobileMode&&this._createBackButton(this),!t.readOnly()){if(W77.enabled("header_symbol_search")){var s=this.createGroup().appendTo(this._$left),s=$('<div class="symbol-edit-widget no-last"></div>').appendTo(s),a=$('<div class="symbol-edit-wrap">').appendTo(s),s=null;W77.enabled("charting_library")||(s=$('<div class="symbol-edit-buttonswrap">').appendTo(a),s=$('<div class="spread-actions">').appendTo(s).on("mousedown",function(e){e.preventDefault()}));var l=$('<div class="symbol-edit-inputspacer">').appendTo(a),d=$('<input type="text" class="symbol-edit" maxlenght="'+TradingView.SYMBOL_SEARCH_MAX_LENGTH+'">').appendTo(l);A69.bindToInput(d,{syncWithChartWidget:!0,spreadActions:s}),function(){var e=!1;d.on("focus",function(){e=!0,a.addClass("expanded")}),d.on("blur",function(){e=!1,setTimeout(function(){e||a.removeClass("expanded")},40)})}()}W77.enabled("header_resolutions")&&(s=this.createGroup({single:!0}).appendTo(this._$left),l={onWidget:n,submenuBtnAddClass:"apply-common-tooltip"},e.interval_options&&$.extend(l,e.interval_options),!TradingView.isMobileView&&W77.enabled("items_favoriting")||$.extend(l,{notShowQuicks:!0,popupSpacing:1}),TradingView.isOnFeaturePage&&$.extend(l,{notShowQuicks:!0}),this._interval=new A21(l),W77.enabled("charting_library")&&D16.on("configuration_received",function(){o._interval.forceUpdate()}),this._interval.element().addClass("no-first").appendTo(s),this._interval.onResize.subscribe(t,t.updateLayout),e.favoriteIntervals&&this._interval.setUpStarredItemsList(e.favoriteIntervals)),W77.enabled("header_chart_type")&&(s=W77.enabled("charting_library")?[{id:TradingView.Series.STYLE_BARS,title:$.t("Bars")},{id:TradingView.Series.STYLE_CANDLES,title:$.t("Candles")},{id:TradingView.Series.STYLE_HOLLOW_CANDLES,title:$.t("Hollow Candles")},{id:TradingView.Series.STYLE_LINE,title:$.t("Line")},{id:TradingView.Series.STYLE_AREA,title:$.t("Area")},{id:TradingView.Series.STYLE_HEIKEN_ASHI,title:$.t("Heiken Ashi")}]:[{id:TradingView.Series.STYLE_BARS,title:$.t("Bars")},{id:TradingView.Series.STYLE_CANDLES,title:$.t("Candles")},{id:TradingView.Series.STYLE_HOLLOW_CANDLES,title:$.t("Hollow Candles")},{id:TradingView.Series.STYLE_HEIKEN_ASHI,title:$.t("Heiken Ashi")},{id:TradingView.Series.STYLE_LINE,title:$.t("Line")},{id:TradingView.Series.STYLE_AREA,title:$.t("Area")},{id:TradingView.Series.STYLE_RENKO,title:$.t("Renko")},{id:TradingView.Series.STYLE_PB,title:$.t("Line Break")},{id:TradingView.Series.STYLE_KAGI,title:$.t("Kagi")},{id:TradingView.Series.STYLE_PNF,title:$.t("Point & Figure")}],l=function(){if(!e.favoriteChartTypes)return[];var t={Bars:TradingView.Series.STYLE_BARS,Candles:TradingView.Series.STYLE_CANDLES,Line:TradingView.Series.STYLE_LINE,Area:TradingView.Series.STYLE_AREA,"Heiken Ashi":TradingView.Series.STYLE_HEIKEN_ASHI,"Hollow Candles":TradingView.Series.STYLE_HOLLOW_CANDLES};return e.favoriteChartTypes.map(function(e){return t[e]})}()||[1,4,5,6],!TradingView.isMobileView&&!TradingView.isOnFeaturePage||W77.enabled("charting_library")||(l=[]),n?l=[1,3]:W77.enabled("collapsible_header")&&this._createMinimizeButton(e.headerChartPanel),this._style_list=new A14("StyleWidget",$.map(s,function(e){var t=e.id,i={image:TradingView.wrapUrl("url('/static/chart-client/css/images/bartype-icons.png')"),offset:o.styleIconPosition(t),quickOffset:TradingView.isMobileView?"-%1px -38px".replace("%1",19*~~t):o.styleIconPosition(t),offsetActive:"-%1px -19px".replace("%1",19*~~t)};return{id:t,title:e.title,icon:i,favoriteButton:{icon:i,title:e.title,addClass:"apply-common-tooltip"}}}),{defaultFavorites:l,addClass:"chart-style-widget",popupAddClass:"chart-style-popup",notShowQuicks:!!TradingView.isMobileView||!W77.enabled("items_favoriting"),showJustDefaultQuicks:W77.enabled("predefined_items_only_may_be_starred"),tooltip:$.t("Bar's Style"),addTooltipClass:"apply-common-tooltip"}),t.activeChartStyle.subscribe(function(e){o._style_list.setValue(e)},{callWithLast:!0}),o._style_list.onChange().subscribe(this,function(e){t.activeChartStyle.setValue(e)}),o._style_list.onResize().subscribe(t,t.updateLayout)),studyMarket=new A1(t,window.user,{onWidget:n}),this._createLayout(e,o,r)}if(W77.enabled("header_saveload")&&(n=W77.enabled("header_saveload_to_the_right")?this._$right:this._$left,s=this.createGroup({single:!0}).appendTo(n),n=$("<div>").addClass("save-load-buttons in-header").appendTo(s),this._saveLoad=new TradingView.SaveLoadWidget(n,t,{popupDirection:"down",popupReverse:!0}),this._saveLoad.onTitleSizeChanged.subscribe(t,t.updateLayout)),this.D4.readOnly()||TradingView.isMobileView||!W77.enabled("header_undo_redo")||(this._undoRedo=new A78(this._$left,this.D4),this._undoRedo.undoElement().addClass("apply-common-tooltip"),this._undoRedo.redoElement().addClass("apply-common-tooltip")),W77.enabled("header_screenshot")){var h=$('<div class="group space-single"><span class="button screenshot iconed"><i></i></span></div>');h.click(function(i){var n={snapshotUrl:e.snapshotUrl};W77.enabled("show_dialog_on_snapshot_ready")?getImage(t,n,o._onScreenshotReady):h.hasClass("process")||(h.addClass("process"),getImageSilently(t,n,function(e){h.removeClass("process"),o._onScreenshotReady(e)})),i.preventDefault()}).appendTo(this._$right)}!TradingView.isMobileView&&W77.enabled("header_fullscreen_button")&&(this._fullscreen=new TradingView.FullscreenWidget,this._fullscreen.element().addClass("apply-common-tooltip").appendTo(this._$left)),W77.enabled("header_widget_dom_node")||$(".header-chart-panel").css("display","none"),i.withModel(this,A4.prototype.bindToModel)},inherit(A5,A4),A5.prototype.onScreenshotReady=function(e){this._onScreenshotReady=e},A5.prototype._createLayout=function(e,t,i){var n=[];W77.enabled("header_chart_type")&&n.push(this._createBarsGroup(t)),W77.enabled("header_settings")&&n.push(this._createPropertiesGroup(i,e.D6)),W77.enabled("header_indicators")&&n.push(this._createIndicatorsGroup(i)),W77.enabled("header_compare")&&n.push(this._createCompareGroup(t,e.D6,i)),n.forEach(function(e){e.appendTo(this._$left)},this)},A5.prototype._createMinimizeButton=function(e){e&&e.size()&&$(document.createElement("span")).addClass("tv-close-panel top").appendTo(e).on("click",function(t){t.isDefaultPrevented()||(t.preventDefault(),e.toggleClass("hidden"),$(window).trigger("resize"))})},TradingView.LineToolPropertiesWidget=function(e){this.D5=e,this._bindings=new List,this.init(),this.attachHandlers()},TradingView.LineToolPropertiesWidget.prototype._POSITION_KEY="properties_toolbar.position",TradingView.LineToolPropertiesWidget.prototype.activeChartWidget=function(){return this.D5.activeChartWidget.value()},TradingView.LineToolPropertiesWidget.prototype.selectedSource=function(){return this.D5.selectedSource.value()},TradingView.LineToolPropertiesWidget.prototype.init=function(){var e=this,t=$('<div class="properties-toolbar"><div class="drag-handler"><i></i></div></div>').css("position","absolute").hide().draggable({handle:".drag-handler",stop:function(){TVSettings.setJSON(e._POSITION_KEY,t.offset())}});$(window).resize(function(){e._visible&&e._updatePositoin()}),this._$widget=t,this._$templates=$('<div class="tools-group">').css("display","inline-block").appendTo(t).hide(),this._$properties=$('<div class="tools-group properties-tools-group">').css("display","inline-block").appendTo(t).hide(),this._$sourceActions=$('<div class="tools-group">').css("display","inline-block").appendTo(t).hide(),this.createSourceActions(),this._$widget.appendTo(document.body)},TradingView.LineToolPropertiesWidget.prototype.attachHandlers=function(){TradingView.drawingState.tool.subscribe(function(e){this.onToolChanged(e)}.bind(this),{callWithLast:!0}),this.D5.selectedSource.subscribe(function(e){this.onSourceChanged(e)}.bind(this))},TradingView.LineToolPropertiesWidget.prototype.onToolChanged=function(e,t){
e&&-1!=e.toLowerCase().indexOf("linetool")?(t=t instanceof $52?t:new $52(e.toLowerCase()),this.hideSourceActions(),this.showPropertiesOf(e,t),this.showTemplatesOf({tool:e,properties:t}),this._updateVisibility()):this.selectedSource()?this.onSourceChanged(this.selectedSource()):this.hide()},TradingView.LineToolPropertiesWidget.prototype.findSourceOnWidget=function(e){for(var t=0;t<this.activeChartWidget().model().panes().size();t++)for(var i=this.activeChartWidget().model().panes().item(t).orderedSources(),n=0;n<i.length;n++)if(i[n]===e)return i[n]},TradingView.LineToolPropertiesWidget.prototype.onSourceChanged=function(e){e?(e instanceof W47&&!(e instanceof W96)&&this.findSourceOnWidget(e)?(!e.userEditEnabled()||"LineToolBrush"!==e.toolname&&this.activeChartWidget().model().lineBeingCreated()?this.hideSourceActions():this.showSourceActions(e),this.showPropertiesOf(e.getConstructor(),e.properties()),this.showTemplatesOf({source:e}),this._updateVisibility()):this.hide(),this._setupToggleLockButton(e)):this.hide()},TradingView.LineToolPropertiesWidget.prototype.showTemplatesOf=function(e){var t,i,n=e.source;n?(t=n.getConstructor(),i=n.properties()):(t=e.tool,i=e.properties),this._$templates.hide().empty();var o=this;e=new TradingView.LinetoolTemplatesList(t,function(e){n?(n.restoreTemplate(e),o.activeChartWidget().model().model().updateSource(this._linetool),o.onSourceChanged(n)):(i.merge(e),i.listeners().fire(this),i.saveDefaults(),o.onToolChanged(t,i))},{buttonInner:" ",buttonClass:"button icon-list with-arrow apply-common-tooltip",defaultsCallback:function(){i.restoreFactoryDefaults(),o.showPropertiesOf(t,i)},saveAsText:"Save Drawing Template As...",applyDefaultText:"Apply Default Drawing Template",getDataForSaveAs:n?function(){return n.template()}:null});var r=e.createButton().attr("title","Templates");this.templatesList=e,this._$templates.append(r),W77.enabled("charting_library")||this._$templates.show(),this._templatesVisible=!0},TradingView.LineToolPropertiesWidget.prototype.createSourceActions=function(){function e(e,t,i,n){return e=$("<div>").addClass("button apply-common-tooltip").addClass("icon-"+e.toLowerCase()).attr("title",t).on("click",function(e){e.stopPropagation(),i(e)}),n&&e.append('<svg><use xlink:href="#'+n+'" /></svg>'),e}var t=this,i=e("Settings",$.t("Settings"),function(){new EditObjectDialog(t.selectedSource(),t.activeChartWidget().model()).show()});this.$zOrder=e("ZOrder",$.t("Visual Order"),function(){t.zOrderButtonHandler()}),this.$zOrder.addClass("with-arrow"),TradingView.bindPopupMenu(this.$zOrder,null,{direction:"down",event:"button-popup",reverse:!1,notCloseOnButtons:!0}),this.$clone=e("Clone",$.t("Clone"),function(){t.activeChartWidget().paneWidgets().item(0).cloneLineTool(t.selectedSource())}),this.$lock=e("Lock",$.t("Lock"),function(){t.activeChartWidget().toggleLockSelectedObject()}),this._lockChangeListener=function(e){t.$lock.toggleClass("active",e.value())};var n=e("Hide",$.t("Hide"),function(){t.activeChartWidget().hideSelectedObject()}),o=e("Remove",$.t("Remove"),function(){t.activeChartWidget().model().removeSelectedSource()});TradingView.D18("alerts")&&TradingView.D18("drawing_alerts")?(this.$editAlert=e("alert",$.t("Edit Alert"),function(){runOrSignIn(function(){t.selectedSource().getAlert(function(e){editAlert(e,t.activeChartWidget())})})},"svg-alarm-clock"),this.$addAlert=e("add-alert",$.t("Add Alert"),function(){runOrSignIn(function(){new TradingView.MakeAlertDialog(t.activeChartWidget(),{drawing:t.selectedSource()})})},"svg-alarm-clock-plus"),this._$sourceActions.append(i,this.$editAlert,this.$addAlert,this.$zOrder,this.$clone,this.$lock,n,o)):this._$sourceActions.append(i,this.$zOrder,this.$clone,this.$lock,n,o)},TradingView.LineToolPropertiesWidget.prototype.zOrderButtonHandler=function(){this.$zOrder.hasClass("active")||this.$zOrder.trigger("button-popup",[this._getZOrderActions()])},TradingView.LineToolPropertiesWidget.prototype._getZOrderActions=function(){var e=[],t=this.selectedSource(),i=this.activeChartWidget().model(),n={title:$.t("Bring to Front"),action:function(){i.bringToFront(t)}},o={title:$.t("Send to Back"),action:function(){i.sendToBack(t)}},r={title:$.t("Bring Forward"),action:function(){i.changeZOrder(t,1)}},s={title:$.t("Send Backward"),action:function(){i.changeZOrder(t,-1)}},a=i.paneForSource(this.selectedSource()).getZOrderMinMax();return t.zorder()===a.minZOrder&&(o.disabled=!0,s.disabled=!0),t.zorder()===a.maxZOrder&&(r.disabled=!0,n.disabled=!0),e.push(n,o,r,s),e},TradingView.LineToolPropertiesWidget.prototype._getPossibleProperty=function(e){for(var t=[],i=this._defaultToolProperties(),n=!0,o=!1,r=0;r<i.length;r++){var s=i[r];s.name in e?(n=!1,t.push(s)):s.divider&&(t.push(s),o=!0)}return 2===t.length&&o&&(t=$.grep(t,function(e){return!e.divider})),n?[]:t},TradingView.LineToolPropertiesWidget.prototype.showPropertiesOf=function(e,t){this._toolExceptionCases||(this._toolExceptionCases=this._createToolExceptionCases());var i=this._toolExceptionCases[e]||this._getPossibleProperty(t);if(this._$properties.empty(),this._propertiesVisible=!1,i.length){for(var n=0;n<i.length;n++){var o=i[n];if(o.divider)this._$properties.append('<div class="divider"></div>');else{var r=t[o.name];("function"!=typeof o.showIf||o.showIf(r,t))&&(o=new this.propertyControl(this,r,o,t),this._$properties.append(o.el),this._propertiesVisible=!0)}}this._$properties.toggle(this._propertiesVisible)}else this._$properties.hide()},TradingView.LineToolPropertiesWidget.prototype.showSourceActions=function(e){function t(i){n.$editAlert.hide(),n.$addAlert.hide(),e.canHasAlert()&&(i?n.$editAlert.show():n.$addAlert.show()),e.hasAlert.subscribe(t,!0)}var i=TradingView.className((e||this.selectedSource()).constructor),n=this;this.activeChartWidget().model().model().isSingleInstanceLineTool(i)?this.$clone.hide():this.$clone.show(),n.$editAlert&&n.$addAlert&&t(e.hasAlert.value()),this._$sourceActions.show(),this._sourceActionsVisible=!0},TradingView.LineToolPropertiesWidget.prototype.hideSourceActions=function(){this._$sourceActions.hide(),this._sourceActionsVisible=!1},TradingView.LineToolPropertiesWidget.prototype._updateVisibility=function(){this._propertiesVisible||this._sourceActionsVisible||this._templatesVisible?this._show():this.hide()},TradingView.LineToolPropertiesWidget.prototype.hide=function(){this._$widget.hide(),this._setupToggleLockButton(),this._visible=!1},TradingView.LineToolPropertiesWidget.prototype._show=function(){this._$widget.show(),this._updatePositoin(),this._visible=!0},TradingView.LineToolPropertiesWidget.prototype.refresh=function(){this.onSourceChanged(this.selectedSource())},TradingView.LineToolPropertiesWidget.prototype._setupToggleLockButton=function(e){e!=this._selectedSourceBk&&(this._selectedSourceBk&&this._selectedSourceBk.properties().frozen&&this._selectedSourceBk.properties().frozen.unsubscribe(this,this._lockChangeListener),e&&e.properties().frozen&&(e.properties().frozen.subscribe(this,this._lockChangeListener),this.$lock.toggleClass("active",e.properties().frozen.value())),this._selectedSourceBk=e)},TradingView.LineToolPropertiesWidget.prototype._updatePositoin=function(){var e=this._$widget,t=$(window),i=t.height()-e.outerHeight(),t=t.width()-e.outerWidth(),n=TVSettings.getJSON(this._POSITION_KEY,{left:t/2,top:headerChartPanel.outerHeight()+15}),n={top:Math.min(i,Math.max(n.top,0)),left:Math.min(t,Math.max(n.left,0))};e.css(n),e.draggable("option","containment",[0,0,t,i])},TradingView.LineToolPropertiesWidget.prototype.bindControl=function(e){this._bindings.append(e)},TradingView.LineToolPropertiesWidget.prototype.clearBindings=function(e){for(e=this._bindings.size();e--;)this._bindings.item(e).destroy();this._bindings.clear()},TradingView.LineToolPropertiesWidget.prototype.propertyControl=function(e,t,i,n){if(t&&i&&e&&i.inputType){"combobox"!==i.inputType||i.comboboxOptions||console.warn('inputType combobox, needs "comboboxOptions" option'),this._toolbarWidget=e;var o,r=i.inputType;if("colorPicker"===r)o=D7.prototype.createColorPicker(),i.icon&&o.addClass("icon-"+i.icon),e.bindControl(new ColorBinding(o,t,!0,e.activeChartWidget().model()));else if("combobox"===r){r=!0,!0===i.simple?(o=$.map(i.comboboxOptions,function(e){return{value:e,html:'<div class="combobox-simple">'+e+"</div>"}}),r=!1):o=$.map(i.comboboxOptions,function(e){return{value:e.value,html:'<div class="combobox-icon icon-'+e.icon+'"></div>'}});var s=new HTMLHelper.Combobox(o,{horizontal:r});o=s.render(),r&&o.find(".items").width(32*i.comboboxOptions.length+14),i.propertyProxy&&(t=i.propertyProxy(n,e.activeChartWidget().model())),e.bindControl(new D11(s,t,null,!0,e.activeChartWidget().model()))}i.title&&o.attr("title",i.title),"string"==typeof i.addClass&&o.addClass(i.addClass),o.addClass("apply-common-tooltip"),this.el=o}},TradingView.LineToolPropertiesWidget.prototype.createLineEndPropertyProxy=function(e,t){return function(i,n){var o;return o=i[t].value()?TradingView.LineToolPropertiesWidget.LINE_EXTEND:i[e].value(),o=new Property(o),o.subscribe(this,function(o){o=o.value(),2>o?(n.beginUndoMacro(""),i[e].setValue(o),i[t].setValue(!1)):(n.beginUndoMacro(""),i[e].setValue(W47.LINEEND_NORMAL),i[t].setValue(!0)),n.endUndoMacro()}),o}},TradingView.LineToolPropertiesWidget.LINE_EXTEND=42,TradingView.LineToolPropertiesWidget.prototype._defaultToolProperties=function(){return[{name:"color",inputType:"colorPicker",icon:"pencil",title:$.t("Color")},{name:"linecolor",inputType:"colorPicker",icon:"pencil",title:$.t("Color")},{name:"backgroundColor",inputType:"colorPicker",icon:"bucket",title:$.t("Background Color")},{divider:!0},{name:"linewidth",inputType:"combobox",comboboxOptions:[{value:1,icon:"line-width-1"},{value:2,icon:"line-width-2"},{value:3,icon:"line-width-3"},{value:4,icon:"line-width-4"}],title:$.t("Width")},{name:"linestyle",title:$.t("Style"),inputType:"combobox",comboboxOptions:[{value:0,icon:"line"},{value:1,icon:"line-dotted"},{value:2,icon:"line-dashed"}]},{name:"leftEnd",title:$.t("Left End"),inputType:"combobox",comboboxOptions:[{value:W47.LINEEND_NORMAL,icon:"line-left-normal"},{value:W47.LINEEND_ARROW,icon:"line-left-arrow"},{value:TradingView.LineToolPropertiesWidget.LINE_EXTEND,icon:"line-left-extend"}],propertyProxy:this.createLineEndPropertyProxy("leftEnd","extendLeft")},{name:"rightEnd",title:$.t("Right End"),inputType:"combobox",comboboxOptions:[{value:W47.LINEEND_NORMAL,icon:"line-right-normal"},{value:W47.LINEEND_ARROW,icon:"line-right-arrow"},{value:TradingView.LineToolPropertiesWidget.LINE_EXTEND,icon:"line-right-extend"}],propertyProxy:this.createLineEndPropertyProxy("rightEnd","extendRight")}]},TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases=function(){return[{name:"textcolor",title:$.t("Text color"),inputType:"colorPicker",icon:"font"},{name:"profitBackground",title:$.t("Profit Background Color"),inputType:"colorPicker",icon:"bucket"},{name:"stopBackground",title:$.t("Stop Background Color"),inputType:"colorPicker",icon:"bucket"},{name:"linecolor",title:$.t("Border color"),inputType:"colorPicker",icon:"pencil"}]},TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases=function(){return[{name:"color",inputType:"colorPicker",icon:"pencil"}]},TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases=function(){return[{name:"color",title:$.t("Text color"),inputType:"colorPicker",icon:"font"},{name:"backgroundColor",title:$.t("Background Color"),inputType:"colorPicker",icon:"bucket",showIf:function(e,t){return t&&t.fillBackground?!!t.fillBackground.value():!0}},{name:"borderColor",title:$.t("Border Color"),inputType:"colorPicker",icon:"pencil"},{name:"bordercolor",title:$.t("Border Color"),inputType:"colorPicker",icon:"pencil"},{divider:!0},{name:"fontsize",title:$.t("Font Size"),inputType:"combobox",simple:!0,addClass:"simple",comboboxOptions:[10,11,12,14,16,20,24,28,32,40]}]},TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases=function(){return[{name:"markerColor",title:$.t("Marker Color"),inputType:"colorPicker",icon:"pencil"},{name:"textColor",title:$.t("Text color"),inputType:"colorPicker",icon:"font"},{divider:!0},{name:"fontSize",title:$.t("Font Size"),inputType:"combobox",simple:!0,addClass:"simple",comboboxOptions:[10,11,12,14,16,20,24,28,32,40]}]},TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases=function(){return[{name:"linecolor",inputType:"colorPicker",icon:"pencil",title:$.t("Color")},{name:"backgroundColor",inputType:"colorPicker",icon:"bucket",showIf:function(e,t){return t.fillBackground.value()},title:$.t("Background Color")},{divider:!0},{name:"linewidth",inputType:"combobox",comboboxOptions:[{value:1,icon:"line-width-1"},{value:2,icon:"line-width-2"},{value:3,icon:"line-width-3"},{value:4,icon:"line-width-4"}],title:$.t("Line Width")}]},TradingView.LineToolPropertiesWidget.prototype._createToolExceptionCases=function(){return{LineToolRegressionTrend:[],LineToolGannSquare:[],LineToolFibTimeZone:[],LineToolBrush:TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases(),LineToolPolyline:TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases(),LineToolText:TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(),LineToolTextAbsolute:TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(),LineToolBalloon:TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(),LineToolCallout:TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(),LineToolPriceLabel:TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(),LineToolArrowMarkLeft:[],LineToolArrowMarkRight:[],LineToolArrowMarkUp:[],LineToolArrowMarkDown:[],LineToolFlagMark:[],LineToolThumbUp:[],LineToolThumbDown:[],LineToolElliottCircle:TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(),LineToolElliottSubminuette:TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(),LineToolElliottMinor:TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(),LineToolElliottMinorRetr:TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(),LineToolElliottMajorRetr:TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(),LineToolIcon:[{name:"color",title:$.t("Color"),inputType:"colorPicker",icon:"bucket"}],LineToolNote:TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases(),LineToolNoteAbsolute:TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases(),LineToolThreeDrivers:[{name:"color",title:$.t("Text color"),inputType:"colorPicker",icon:"pencil"}],LineToolRiskRewardLong:TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases(),LineToolRiskRewardShort:TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases(),LineToolBarsPattern:[{name:"color",title:$.t("Color"),inputType:"colorPicker",icon:"bucket"}],LineToolProjection:[{name:"color1",title:$.t("Background color 1"),inputType:"colorPicker",icon:"bucket"},{name:"color2",title:$.t("Background color 2"),inputType:"colorPicker",icon:"bucket"},{divider:!0},{name:"linewidth",inputType:"combobox",comboboxOptions:[{value:1,icon:"line-width-1"},{value:2,icon:"line-width-2"},{value:3,icon:"line-width-3"},{value:4,icon:"line-width-4"}]}]}},TradingView.FavoriteDrawingToolBar=function(e){this.drawingToolbar=e,this.tools=this.drawingToolbar.favorites,this._active=TradingView.drawingState.tool.value(),this.visibleProperty=new Property(TVSettings.getBool("ChartFavoriteDrawingToolbarWidget.visible",!0)),this.visibleProperty.subscribe(this,function(e){this.toggle(e.value()),TVSettings.setValue("ChartFavoriteDrawingToolbarWidget.visible",e.value())}),this.init(),this._attach(),this.visibleProperty.value()&&0<this.tools.length&&(this.render(),this.showWidget())},TradingView.FavoriteDrawingToolBar.prototype._POSITION_KEY="chart.favoriteDrawingsPosition",TradingView.FavoriteDrawingToolBar.prototype._attach=function(){this.drawingToolbar._favoritesEvent.subscribe(this,this._onEvent),TradingView.drawingState.tool.subscribe(function(){this._active=TradingView.drawingState.tool.value(),this.render()}.bind(this))},TradingView.FavoriteDrawingToolBar.prototype._onEvent=function(e,t){this.tools=this.drawingToolbar.favorites,this._visible||this.visibleProperty.value()?0<this.tools.length?(this.render(),this._visible||this.showWidget(),this._updatePosition()):this.hideWidget():"add"==e&&0<this.tools.length&&this.setVisible(!0)},TradingView.FavoriteDrawingToolBar.prototype.render=function(){this._$toolsContainer.empty(),this.tools.forEach(function(e){if(e.drawing){var t=e.drawing.tool==this._active,i=$("<i/>").css({backgroundPosition:A6.prototype.Button.prototype._getIconBackgroundPosition(e.drawing.tool,t)}),t=$('<span class="button apply-common-tooltip" />').attr("title",e.drawing.localizedName).append(i).toggleClass("active",t).on("click",function(){TradingView.drawingState.tool.value()==e.drawing.tool?TradingView.drawingState.resetToCursor():e.drawing.action.call(this.drawingToolbar,e.drawing)});this._$toolsContainer.append(t)}}.bind(this))},TradingView.FavoriteDrawingToolBar.prototype.init=function(){var e=this,t=$('<div class="drawing-favorites-toolbar"><div class="drag-handler"><i></i></div></div>').css("position","absolute").hide().draggable({handle:".drag-handler",stop:function(){TVSettings.setJSON(e._POSITION_KEY,t.offset())}});$(window).resize(function(){e._visible&&e._updatePosition()}),t.on("contextmenu",function(t){t.preventDefault();var i=new Action({text:$.t("Hide Favorite Drawings Toolbar")});i.callbacks().subscribe(null,function(){var t=e.drawingToolbar.activeChartWidget().model();if(t){var i=!e.visibleProperty.value();t.setProperty(e.visibleProperty,i,$.t("Hide Favorite Drawings Toolbar"))}}),ContextMenu.createMenu([i]).show(t)}),this._$widget=t,this._$toolsContainer=$('<div class="tools-group"/>').appendTo(t),this._$widget.appendTo(document.body),this._$toolsContainer.sortable({tolerance:"pointer",start:function(e,t){TradingView.Tooltip.hide(),startIndex=t.item.index()},stop:function(e,t){var i=t.item.index();startIndex!=i&&(this.tools.splice(i,0,this.tools.splice(startIndex,1)[0]),this.drawingToolbar._favoritesEvent.fire("reorder"))}.bind(this)})},TradingView.FavoriteDrawingToolBar.prototype._updatePosition=function(){var e=this._$widget,t=$(window),i=t.height()-e.outerHeight(),t=t.width()-e.outerWidth(),n=TVSettings.getJSON(this._POSITION_KEY,{left:t/2,top:headerChartPanel.outerHeight()+61}),n={top:Math.min(i,Math.max(n.top,0)),left:Math.min(t,Math.max(n.left,0))};e.css(n),e.draggable("option","containment",[0,0,t,i])},TradingView.FavoriteDrawingToolBar.prototype.showWidget=function(){this._visible=!0,this.render(),this._$widget.show(),this._updatePosition()},TradingView.FavoriteDrawingToolBar.prototype.hideWidget=function(){this._$widget.hide(),this._visible=!1},TradingView.FavoriteDrawingToolBar.prototype.setVisible=function(e){this.visibleProperty.setValue(e)},TradingView.FavoriteDrawingToolBar.prototype.toggle=function(e){e?this.show():this.hide()},TradingView.FavoriteDrawingToolBar.prototype.show=function(){!this._visible&&0<this.tools.length&&this.showWidget()},TradingView.FavoriteDrawingToolBar.prototype.hide=function(){this._visible&&this.hideWidget()},A6=function(e){var t=this;this.options=e=e||{},TradingView.drawingState.init();var i=this._container=e.container;if(this.D5=e.D6,this._container.on("contextmenu",function(e){e.preventDefault()}),!e.onWidget&&!TradingView.isMobileView){var n=$("<span>").addClass("main-menu apply-common-tooltip common-tooltip-vertical");i.append($("<div>").addClass("tools-group").append(n)),this._mainMenuWidget=new TradingView.MainMenuWidget(n)}if(this._allToolGroups=[],this._toolsFilter=e.drawingsAccess?new A6.ModernToolsFilter(e.drawingsAccess):new A6.ObsoleteToolsFilter(e.enabledDrawings,e.disabledDrawings),this.favorites=TVSettings.getJSON("chart.favoriteDrawings",[]),!e.readOnly){if(this._main=n=$("<div>").addClass("tools-group no-delimiter").appendTo(i),this.appendToolsGroup([{tool:"cursor",name:"Cross"},{tool:"dot",name:"Dot"},{tool:"arrow",name:"Arrow"},{tool:"eraser",name:"Eraser"}]),this.appendToolsGroup([{tool:"LineToolTrendLine",name:"Trend Line"},{tool:"LineToolTrendAngle",name:"Trend Angle"},{tool:"LineToolHorzLine",name:"Horizontal Line"},{tool:"LineToolHorzRay",name:"Horizontal Ray"},{tool:"LineToolVertLine",name:"Vertical Line"},{tool:"LineToolArrow",name:"Arrow"},{tool:"LineToolRay",name:"Ray"},{tool:"LineToolExtended",name:"Extended"},{tool:"LineToolParallelChannel",name:"Parallel Channel"},{tool:"LineToolDisjointAngle",name:"Disjoint Angle"},{tool:"LineToolFlatBottom",name:"Flat Top/Bottom"},{tool:"LineToolRegressionTrend",name:"Regression Trend"}]),this.appendToolsGroup([{tool:"LineToolPitchfork",name:"Pitchfork"},{tool:"LineToolSchiffPitchfork2",name:"Schiff Pitchfork"},{tool:"LineToolSchiffPitchfork",name:"Modified Schiff Pitchfork"},{tool:"LineToolInsidePitchfork",name:"Inside Pitchfork"},{tool:"LineToolPitchfan",name:"Pitchfan"},{tool:"LineToolGannSquare",name:"Gann Box"},{tool:"LineToolGannComplex",name:"Gann Square"},{tool:"LineToolGannFan",name:"Gann Fan"},{tool:"LineToolFibRetracement",name:"Fib Retracement"},{tool:"LineToolTrendBasedFibExtension",name:"Trend-Based Fib Extension"},{tool:"LineToolFibSpeedResistanceFan",name:"Fib Speed Resistance Fan"},{tool:"LineToolFibTimeZone",name:"Fib Time Zone"},{tool:"LineToolTrendBasedFibTime",name:"Trend-Based Fib Time"},{tool:"LineToolCircleLines",name:"Cyclic Lines"},{tool:"LineToolFibCircles",name:"Fib Circles"},{tool:"LineToolFibSpiral",name:"Fib Spiral"},{tool:"LineToolFibSpeedResistanceArcs",name:"Fib Speed Resistance Arcs"},{tool:"LineToolFibWedge",name:"Fib Wedge"},{tool:"LineToolFibChannel",name:"Fib Channel"}]),this.appendToolsGroup([{tool:"LineToolBrush",name:"Brush"},{tool:"LineToolRectangle",name:"Rectangle"},{tool:"LineToolRotatedRectangle",name:"Rotated Rectangle"},{tool:"LineToolEllipse",name:"Ellipse"},{tool:"LineToolTriangle",name:"Triangle"},{tool:"LineToolPolyline",name:"Polyline"},{tool:"LineToolArc",name:"Arc"}]),this.appendToolsGroup([{tool:"LineToolText",name:"Text"},{tool:"LineToolTextAbsolute",name:"Anchored Text"},{tool:"LineToolNote",name:"Note"},{tool:"LineToolNoteAbsolute",name:"Anchored Note"},{tool:"LineToolCallout",name:"Callout"},{tool:"LineToolBalloon",name:"Balloon"},{tool:"LineToolPriceLabel",name:"Price Label"},{tool:"LineToolArrowMarkLeft",name:"Arrow Mark Left"},{tool:"LineToolArrowMarkRight",name:"Arrow Mark Right"},{tool:"LineToolArrowMarkUp",name:"Arrow Mark Up"},{tool:"LineToolArrowMarkDown",name:"Arrow Mark Down"},{tool:"LineToolFlagMark",name:"Flag Mark"}]),this.appendToolsGroup([{tool:"LineTool5PointsPattern",name:"XABCD Pattern"},{tool:"LineToolABCD",name:"ABCD Pattern"},{tool:"LineToolTrianglePattern",name:"Triangle Pattern"},{tool:"LineToolThreeDrivers",name:"Three Drivers Pattern"},{tool:"LineToolHeadAndShoulders",name:"Head & Shoulders"},{tool:"LineToolElliottSubminuette",name:"Elliott Wave Subminuette"},{tool:"LineToolElliottMinor",name:"Elliott Wave Minor"},{tool:"LineToolElliottCircle",name:"Elliott Wave Cycle"},{tool:"LineToolElliottMinorRetr",name:"Elliott Minor Retracement"},{tool:"LineToolElliottMajorRetr",name:"Elliott Major Retracement"}]),this.appendToolsGroup([{tool:"LineToolRiskRewardLong",name:"Long Position"},{tool:"LineToolRiskRewardShort",name:"Short Position"},{tool:"LineToolPrediction",name:"Forecast"},{tool:"LineToolDateRange",name:"Date Range"},{tool:"LineToolPriceRange",name:"Price Range"},{tool:"LineToolBarsPattern",name:"Bars Pattern"},{tool:"LineToolProjection",name:"Projection"}]),this._toolsFilter.isToolEnabled("Font Icons")){var o=new this.Button(this.createIconActions(),{addClass:"font-awesome line-tool-icons-popup",buttonClass:"font-awesome"},!0);this._icons=o,n.append(o.element()),this._allToolGroups.push(o)}if(!TradingView.isMobileView){if(n=$("<div>").addClass("tools-group").appendTo(i),o=new this.Button({tool:"zoom",name:"Zoom In",action:function(){TradingView.drawingState.tool.setValue("zoom")}}),n.append(o.element()),this._allToolGroups.push(o),t.D5){var r=new this.Button({tool:"zoom-out",name:"Zoom Out",action:function(){var e=t.D5;e&&(e=e.activeChartWidget.value().model())&&e.zoomFromViewport()}});n.append(r.element()),r.element().addClass("hidden"),function(){function e(){var n=t.D5.activeChartWidget.value(),o=n.model(),s=!1;o?(i!==o&&(i&&i.zoomStack().onChange().unsubscribe(null,e),o.zoomStack().onChange().subscribe(null,e),i=o),s=!o.zoomStack().isEmpty()):n.withModel(null,e),r.element().toggleClass("hidden",!s)}var i=null;t.D5.activeChartWidget.subscribe(e,{callWithLast:!0})}()}o=new this.Button({tool:"measure",name:"Measure (Shift + Click on the chart)",action:function(){TradingView.drawingState.tool.setValue("measure")}}),n.append(o.element()),this._allToolGroups.push(o)}var n=$("<div>").addClass("tools-group").appendTo(i),o=!!TradingView.drawingState.properties().magnet.value(),s=new this.Button({tool:"magnet",name:"Magnet Mode",action:function(){s.activate(!s.activated),TradingView.saveDefaultProperties(!0),TradingView.drawingState.properties().magnet.setValue(s.activated),TradingView.saveDefaultProperties(!1)}.bind(this)});if(n.append(s.element()),s.activate(o),TradingView.drawingState.properties().magnet.subscribe(this,function(e){s.activate(e.value())}),!e.onWidget&&!TradingView.isMobileView||W77.enabled("charting_library")){o=!!TradingView.drawingState.properties().stayInDrawingMode.value(),drawingmode=new this.Button({tool:"drawginmode",name:"Stay in Drawing Mode",action:function(){drawingmode.activate(!drawingmode.activated),TradingView.saveDefaultProperties(!0),TradingView.drawingState.properties().stayInDrawingMode.setValue(drawingmode.activated),TradingView.saveDefaultProperties(!1)}.bind(this)}),n.append(drawingmode.element()),drawingmode.activate(o),TradingView.drawingState.properties().stayInDrawingMode.subscribe(this,function(e){drawingmode.activate(e.value())});var o=!!TradingView.drawingState.lockDrawings().value(),a=new this.Button({tool:"lockAllDrawings",name:"Lock All Drawing Tools",action:function(){a.activate(!a.activated),TradingView.drawingState.lockDrawings().setValue(a.activated)}.bind(this)});n.append(a.element()),a.activate(o),TradingView.drawingState.lockDrawings().subscribe(this,function(e){a.activate(e.value())});var o=!!TradingView.drawingState.hideAllDrawings().value(),l=new this.Button({tool:"hideAllDrawings",name:"Hide All Drawing Tools",action:function(){l.activate(!l.activated),TradingView.drawingState.hideAllDrawings().setValue(l.activated)}.bind(this)});n.append(l.element()),l.activate(o),TradingView.drawingState.hideAllDrawings().subscribe(this,function(e){l.activate(e.value())}),n=$("<div>").addClass("tools-group").appendTo(i),o=$("<span>").addClass("button objects-tree apply-common-tooltip common-tooltip-vertical").attr("title",$.t("Show Objects Tree")).append($("<i>")),o.on("click",function(e){this.activeChartWidget().showSourceProperties(),e.preventDefault()}.bind(this)),n.append(o),o=new this.Button({tool:"removeAllDrawingTools",name:"Remove All Drawing Tools",action:function(){this.D5.activeChartWidget.value().model().removeAllDrawingTools()}.bind(this)}),n.append(o.element())}TVSettings.getValue("chart.cursorPreference","cursor"),this._favoritesEvent=new Delegate,this._favoritesEvent.subscribe(this,function(e){~["add","remove","reorder"].indexOf(e)&&TVSettings.setJSON("chart.favoriteDrawings",this.favorites.map(function(e){return{tool:e.drawing.tool}}))}),e.onWidget||(this.favoriteDrawingToolbar=new TradingView.FavoriteDrawingToolBar(this))}if(e.onWidget||TradingView.isMobileView||$(window).load(function(){this.createHelpButton(e),loginStateChange.subscribe(this,function(t){!t&&window.is_authenticated&&this.createHelpButton(e)})}.bind(this)),e.readOnly||TradingView.drawingState.tool.subscribe(function(e){this._syncView(e)}.bind(this),{callWithLast:!0}),$(document).bind("keydown","esc",function(){TradingView.drawingState.resetToCursor(!0)}),this._twoColumnLayout=!1,!e.onWidget&&!TradingView.isMobileView||W77.enabled("charting_library")){var d,h=i.find(".tools-group");$(function(){var e=h.last();d=e.offset().top+e.outerHeight(),$(window).resize()}),$(window).resize(function(){var e=$(window).height()<d+10;e!=t._twoColumnLayout&&(i.toggleClass("two-column",e),t._twoColumnLayout=e,$(window).resize())})}this.visible=new Property,this.visible.subscribe(this,function(e){this._fold(!e.value()),TVSettings.setValue("ChartSideToolbarWidget.visible",e.value())}),this.visible.setValue("boolean"==typeof e.forceVisible?e.forceVisible:TVSettings.getBool("ChartSideToolbarWidget.visible",!0)),$('<a href="#" class="tv-close-panel left" title="Hide Drawings Toolbar"></a>').on("click",function(e){var t=this.activeChartWidget().model();t&&(t.setProperty(this.visible,!this.visible.value(),$.t("Hide Drawings Toolbar")),e.preventDefault())}.bind(this)).appendTo(i),e.onResize&&(this.onResize=e.onResize),$(window).on("resize",this.updateLayout.bind(this))},A6.prototype.updateLayout=function(){this.onResize&&this.onResize(this._container)},A6.prototype.appendToolsGroup=function(e){e=this.filterEnabledTools(this.extendTools(e)),0<e.length&&(e=new this.Button(e),this._main.append(e.element()),this._allToolGroups.push(e))},A6.prototype.filterEnabledTools=function(e){return e.filter(function(e){return this._toolsFilter.isToolEnabled(e.name)},this)},A6.prototype.element=function(){return this._container},A6.prototype._syncView=function(e){if(this._allToolGroups)for(var t=this._allToolGroups.length;t--;){var i=this._allToolGroups[t];if(i.textAsIcon)i.activate("LineToolIcon"==e);else{for(var n=!1,o=i.tools.length;o--;)i.tools[o].tool===e&&(i.setCurrent(o),n=!0);i.activate(n)}}},A6.prototype.activeChartWidget=function(){return this.D5.activeChartWidget.value()},A6.prototype.extendTools=function(e){var t=this,i=this._addToFavorite.bind(this),n=t._removeFromFavorite.bind(this),o=this.favorites.reduce(function(e,t){return e.push(t.tool),e},[]);return $.map(e,function(e){var r={tool:e.tool,name:e.name,localizedName:$.t(e.name),addClass:t._toolsFilter.isToolGrayed(e.name)&&" grayed",action:function(){TradingView.drawingState.tool.value()!==e.tool&&(TradingView.supportTouch()&&t.D5.selectedSource.value()&&t.activeChartWidget().model().lineBeingCreated()&&t.activeChartWidget().model().cancelCreatingLine(),TradingView.drawingState.tool.setValue(e.tool))},favOptions:{allowMakeFavorite:!t.options.onWidget,addToFavorite:i,removeFromFavorite:n}},s=!!~o.indexOf(e.tool);if(s)for(var a=0;a<t.favorites.length;a++)t.favorites[a].tool==e.tool&&(t.favorites[a].drawing=r);return r.favOptions.isFavorite=s,r})},A6.prototype._addToFavorite=function(e){e.favOptions.isFavorite=!0,e={drawing:e,tool:e.tool},this.favorites.push(e),this._favoritesEvent.fire("add",e)},A6.prototype._removeFromFavorite=function(e){e.favOptions.isFavorite=!1;for(var t=0;t<this.favorites.length;t++)this.favorites[t].drawing.tool===e.tool&&(this.favorites.splice(t,1),this._favoritesEvent.fire("remove",e))},A6.prototype.createIconActions=function(e){var t=this;e=TradingView.LineToolIcon.availIcons;var i=TVSettings.getJSON("linetoolicon.recenticons");return i&&(e=i.concat(["separator"]).concat(e)),$.map(e,function(e){return"separator"===e?{separator:!0}:{tool:"LineToolIcon",name:String.fromCharCode(e),addClass:t._toolsFilter.isToolGrayed("Font Icons")&&" grayed",action:function(){var i=defaults("linetoolicon");i.icon=e,saveDefaults("linetoolicon",i),TradingView.drawingState.tool.setValue("LineToolIcon"),t._icons.setTools(t.createIconActions()),i=TVSettings.getJSON("linetoolicon.recenticons")||[],i=$.grep(i,function(t){return t!=e}),i.unshift(e),10<i.length&&(i=i.slice(0,10)),TVSettings.setJSON("linetoolicon.recenticons",i);
}}})},A6.prototype.changeTool=function(e){e?this.D4.setCurrentTool(e):this.D4.setCurrentTool(this.D4.currentCursorTool())},A6.prototype._fold=function(e){this._container.toggleClass("hidden",!!e),$(window).resize()},A6.prototype.createHelpButton=function(e){if(window.widgetbar){var t,i=widgetbar.layout.setHelpButton();e.withWizard&&e.D6&&(t=e.D6.activeChartWidget.value()),new TradingView.ChartHelpMenu(i,!!e.withWizard,t)}},A6.prototype.Button=function(e,t,i){e=isArray(e)?e:[e],this.isGroup=1<e.length,this.textAsIcon=i,this.setTools(e),this._e=$("<span>").addClass("button").addClass("apply-common-tooltip common-tooltip-vertical"),this.isGroup?(this._main=$("<span>").addClass("main"),i?this._main.text(this._firstNonGrayedTool().localizedName).addClass("text-as-icon"):this._main.append("<i>"),this._side=$("<span>").addClass("side"),this._e.append(this._main).append(this._side),this._e.addClass("subgroup")):this._e.append($("<i>")).attr("title",this.tools[0].localizedName),i||this._e.hover($.proxy(this,"_hover"),$.proxy(this,"_unhover")),t=$.extend({direction:TradingView.isMobileView?"up":"right",event:"button-popup",addClass:"drawings-popup-list favored-list",reverse:!1,popupSpacing:TradingView.isMobileView?15:4},t||{}),i||(t.addClass+=" iconed"),this.isGroup&&TradingView.bindPopupMenu(this._e,null,t),this.activated=e.activated||!1,this.setCurrent(this.tools.indexOf(this._firstNonGrayedTool())),this.isGroup?(Modernizr.touch?(this._main.bind("touchstart",$.proxy(this,"_startclick")),this._main.bind("touchend",$.proxy(this,"_stopclick"))):(this._main.mousedown($.proxy(this,"_startclick")),this._main.mouseup($.proxy(this,"_stopclick"))),this._side.click($.proxy(this,"_submenu")),this._e.click(function(){return!1})):this._e.click($.proxy(this,"action"))},A6.prototype.Button.prototype._isToolGrayed=function(e){return e.addClass&&-1<e.addClass.indexOf("grayed")},A6.prototype.Button.prototype._firstNonGrayedTool=function(){for(var e=0;e<this.tools.length;++e){var t=this.tools[e];if(!this._isToolGrayed(t)&&!t.separator)return t}return this.tools[0]},A6.prototype.Button.prototype.element=function(){return this._e},A6.prototype.Button.prototype.setTools=function(e){if(isArray(e)){var t=this;this.tools=$.map(e,$.proxy(function(e,i){return e.separator?{separator:!0}:{icon:t.textAsIcon?e.name:e.tool,name:e.name,localizedName:e.localizedName||$.t(e.name),tool:e.tool,addClass:e.addClass,action:"function"==typeof e.action?e.action:t._defaultAction,favOptions:e.favOptions}},this))}},A6.prototype.Button.iconIndices={LineToolTextAbsolute:0,LineToolArc:1,LineToolArrowMarkDown:2,LineToolArrowMarkUp:3,LineToolCircleLines:4,LineToolArrowMarkLeft:5,LineToolArrowMarkRight:6,LineToolFibSpeedResistanceArcs:7,arrow:8,LineToolBalloon:9,LineToolBrush:10,LineToolFibSpeedResistanceFan:11,LineToolArrow:12,cursor:13,LineToolHorzLine:14,LineToolFibRetracement:15,LineToolPitchfork:16,LineToolText:17,LineToolTrendLine:18,LineToolTrendAngle:82,LineToolFibTimeZone:19,LineToolVertLine:20,dot:21,LineToolEllipse:22,LineToolFlagMark:23,eraser:24,LineToolExtended:25,LineToolFibCircles:26,LineToolFibSpiral:74,LineToolGannFan:27,LineToolGannSquare:28,LineToolGannComplex:67,LineToolParallelChannel:29,LineToolDisjointAngle:75,LineToolFlatBottom:76,LineToolPolyline:30,LineToolRectangle:31,LineToolRotatedRectangle:81,LineToolCallout:32,LineToolPriceLabel:77,LineToolRay:33,LineToolSchiffPitchfork:72,LineToolSchiffPitchfork2:34,LineToolTrendBasedFibExtension:37,LineToolTrendBasedFibTime:66,LineToolTriangle:38,modes:39,LineToolElliottSubminuette:40,LineToolElliottMinor:41,LineToolElliottCircle:42,LineToolElliottMajorRetr:43,LineToolElliottMinorRetr:44,LineToolRegressionTrend:45,LineToolFibWedge:46,zoom:47,LineToolPitchfan:48,LineToolHorzRay:49,LineToolPrediction:50,"zoom-out":51,LineToolPriceRange:52,LineToolDateRange:53,LineToolRiskRewardLong:54,LineToolRiskRewardShort:55,"":56,removeAllDrawingTools:57,"":58,LineToolBarsPattern:59,LineToolProjection:60,LineTool5PointsPattern:61,LineToolABCD:62,LineToolTrianglePattern:63,LineToolThreeDrivers:64,LineToolHeadAndShoulders:65,LineToolInsidePitchfork:68,measure:69,magnet:70,drawginmode:71,LineToolFibChannel:73,lockAllDrawings:78,hideAllDrawings:79,LineToolNote:83,LineToolNoteAbsolute:84},A6.prototype.Button.prototype._getBackgroundByTile=function(e,t){return[t?33:1,32*e+2]},A6.prototype.Button.prototype._getBackgroundPosition=function(e){return"-"+e[0]+"px -"+e[1]+"px"},A6.prototype.Button.prototype._getIconBackgroundPosition=function(e,t){return this._getBackgroundPosition(this._getIconOffset(e,t))},A6.prototype.Button.prototype._getIconOffset=function(e,t){return this._getBackgroundByTile(A6.prototype.Button.iconIndices[e],t)},A6.prototype.Button.prototype._setIcon=function(e,t,i){i||this._e.find("i").css("background-position",this._getIconBackgroundPosition(e,t))},A6.prototype.Button.prototype._setTextAsIcon=function(e){this._e.find(".main").text(e)},A6.prototype.Button.prototype.setIcon=function(e){this.icon=e,this.textAsIcon?this._setTextAsIcon(e):this._setIcon(e,this.activated)},A6.prototype.Button.prototype._hover=function(){this._setIcon(this.icon,!0,!0)},A6.prototype.Button.prototype._unhover=function(){this._setIcon(this.icon,this.activated||!1)},A6.prototype.Button.prototype._getPopupIcon=function(e){return e=A6.prototype.Button.iconIndices[e],offset={image:TradingView.wrapUrl("url('/static/images/sidetoolbar/instruments.png')"),offset:{x:-64,y:32*-e}}},A6.prototype.Button.prototype._getPopupMenuItems=function(){function e(e){return e?$.t("Remove from favorites"):$.t("Add to favorites")}var t=this;return $.map(this.tools,function(i,n){if(i.separator)return i;if(!t.textAsIcon&&i.favOptions.allowMakeFavorite)var o=$('<span class="to-quick" title="'+e(i.favOptions.isFavorite)+'"></span>').toggleClass("quicked",!!i.favOptions.isFavorite);return{title:""+i.localizedName,action:function(){t._isToolGrayed(i)?D17.emit("onGrayedObjectClicked",{type:"drawing",name:i.name}):(t.setCurrent(n),i.action.call(t,i),$(document).trigger("click"),$(document).trigger("touch"))},active:n==t.current,icon:t.textAsIcon?null:t._getPopupIcon(i.icon),addClass:i.addClass,buttons:t.textAsIcon||!i.favOptions.allowMakeFavorite?void 0:[{el:o,handler:function(t){i.favOptions.isFavorite?(i.favOptions.removeFromFavorite(i),o.removeClass("quicked").attr("title",e(!1))):(i.favOptions.addToFavorite(i),o.addClass("quicked").attr("title",e(!0))),t.stopPropagation(),t.preventDefault()}}]}})},A6.prototype.Button.prototype._defaultAction=function(){this.activate()},A6.prototype.Button.prototype._startclick=function(){this._e.hasClass("active")?($(document).trigger("click"),this.action()):this._delay=setTimeout($.proxy(function(){this._delay=null,this.openSubmenu()},this),200)},A6.prototype.Button.prototype._stopclick=function(){this._delay&&(clearTimeout(this._delay),this._delay=null,this.action())},A6.prototype.Button.prototype._submenu=function(){this._e.hasClass("active")?$(document).trigger("click"):this.openSubmenu()},A6.prototype.Button.prototype.activate=function(e){(this.activated=e=void 0!==e?!!e:!0)?this._e.addClass("selected"):this._e.removeClass("selected"),this._setIcon(this.icon,e)},A6.prototype.Button.prototype.action=function(){var e=this.getCurrent();this._isToolGrayed(e)?D17.emit("onGrayedObjectClicked",{type:"drawing",name:e.name}):e.action.call(this,e)},A6.prototype.Button.prototype.openSubmenu=function(){this._e.trigger("button-popup",[this._getPopupMenuItems()])},A6.prototype.Button.prototype.setCurrent=function(e){if(e>=0&&e<this.tools.length){var t=this.tools[e];this.setIcon(t.icon),this._isToolGrayed(t)?this._e.find(".main").addClass(" grayed"):this._e.find(".main").removeClass(" grayed"),this.isGroup&&!this.textAsIcon&&this._e.attr("title",t.localizedName),this.current=e}},A6.prototype.Button.prototype.getCurrent=function(){return this.tools[this.current]},A6.prototype.Button.prototype.setCurrentTool=function(e,t){var i=this;if("LineToolIcon"===e){var n=String.fromCharCode(defaults("linetoolicon").icon);$.each(this.tools,function(e,t){return t.icon==n?(i.setCurrent(e),i.activate(),!1):void 0})}else $.each(this.tools,function(t,n){return n.tool==e?(i.setCurrent(t),i.activate(),!1):void 0})},A6.ObsoleteToolsFilter=function(e,t){this._enabledTools=e,this._disabledTools=t},A6.ObsoleteToolsFilter.prototype.isToolEnabled=function(e){var t=!!this._enabledTools&&0<this._enabledTools.length,i=!!this._disabledTools&&0<this._disabledTools.length;if(t&&i)throw"Unable to use enabled drawings list and disabled drawings one together. Please use just one of them.";return!i&&!t||t&&0<=this._enabledTools.indexOf(e)||i&&0>this._disabledTools.indexOf(e)},A6.ObsoleteToolsFilter.prototype.isToolGrayed=function(){return!1},A6.ModernToolsFilter=function(e){this._toolsAccess=e},A6.ModernToolsFilter.prototype._findTool=function(e){for(var t=null,i=0;i<this._toolsAccess.tools.length;++i){var n=this._toolsAccess.tools[i];if(n.name==e){t=n;break}}return t},A6.ModernToolsFilter.prototype.isToolEnabled=function(e){return(e=this._findTool(e))&&e.grayed?!0:"black"==this._toolsAccess.type?!e:!!e},A6.ModernToolsFilter.prototype.isToolGrayed=function(e){return(e=this._findTool(e))&&e.grayed},A78=function(e,t){var i=$(document.createElement("div")).addClass("group space-single");this.D4=t,this._undo=$('<span class="button undo disabled"><svg><use xlink:href="#svg-undo" /></svg></span>').attr("title","").appendTo(i),this._redo=$('<span class="button redo disabled"><svg><use xlink:href="#svg-redo" /></svg></span>').attr("title","").appendTo(i);var n=this;this._undo.click(function(){n.undo()}),this._redo.click(function(){n.redo()}),A77.undoStack().onChange().subscribe(this,this.update),A77.redoStack().onChange().subscribe(this,this.update),i.appendTo(e)},A78.prototype.update=function(){var e=A77.undoStack(),t=A77.redoStack();e.isEmpty()?(this._undo.addClass("disabled"),this._undo.attr("title",null)):(this._undo.removeClass("disabled"),this._undo.attr("title",$.t("Undo {0}").format(e.head().text()||""))),t.isEmpty()?(this._redo.addClass("disabled"),this._redo.attr("title",null)):(this._redo.removeClass("disabled"),this._redo.attr("title",$.t("Redo {0}").format(t.head().text()||"")))},A78.prototype.undo=function(){this._undo.hasClass("disabled")||(TradingView.trackEvent("GUI","Undo"),A77.undo())},A78.prototype.redo=function(){this._redo.hasClass("disabled")||(TradingView.trackEvent("GUI","Redo"),A77.redo())},A78.prototype.undoElement=function(){return this._undo},A78.prototype.redoElement=function(){return this._redo},TradingView.FullscreenWidget=function(){var e=this;this.isFullscreen=!1,this._e=$(document.createElement("div")).addClass("group space-single");var t=$("<span>").addClass("button fullscreen iconed").attr("title",$.t("Fullscreen mode")).append("<i>");t.click(function(){e.startFullscreen()}),t.appendTo(this._e),$(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){var t;["fullscreenElement","webkitFullscreenElement","mozFullscreenElement","mozFullScreenElement","msFullscreenElement"].some(function(e){return e in document?void(t=!!document[e]):!1}),null!=t&&(t?e._onStartFullscreen():e._onExitFullscreen())})},TradingView.FullscreenWidget.prototype.element=function(){return this._e},TradingView.FullscreenWidget.prototype.startFullscreen=function(){["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen"].some(function(e){return"function"==typeof document.documentElement[e]?(document.documentElement[e](),!0):void 0}),this._onStartFullscreen()},TradingView.FullscreenWidget.prototype._onStartFullscreen=function(){var e=this;W77.enabled("side_toolbar_in_fullscreen_mode")?$(".header-chart-panel").hide():$("#chart-area").addClass("fullscreen"),this._$exitButton||(this._$exitButton=$('<div class="exit-fullscreen">Exit Full Screen (ESC)</div>').on("click",this.exitFullscreen.bind(this)).appendTo(document.body)),$(window).resize(),$(document).off("keyup.toggleFullscreen").on("keyup.toggleFullscreen",function(t){27==t.keyCode&&e.exitFullscreen()})},TradingView.FullscreenWidget.prototype.exitFullscreen=function(){["exitFullscreen","mozCancelFullScreen","mozExitFullscreen","webkitExitFullscreen","msExitFullscreen"].some(function(e){return"function"==typeof document[e]?(document[e](),!0):void 0}),this._onExitFullscreen()},TradingView.FullscreenWidget.prototype._onExitFullscreen=function(){this._$exitButton&&($(".exit-fullscreen").remove(),delete this._$exitButton),W77.enabled("side_toolbar_in_fullscreen_mode")?$(".header-chart-panel").show():$("#chart-area").removeClass("fullscreen"),$(window).resize(),$(document).off("keyup.toggleFullscreen")},A53=function(e,t,i){this._chart=e,this.dialog=e.dialog,this._state=t,this._disableContextMenu=!!i,this.lhsPriceAxisWidget=new A54(this,A54.LHS),this.rhsPriceAxisWidget=new A54(this,A54.RHS),this.jqPane=$(document.createElement("td")),this.jqPane.addClass("chart-markup-table"),this.jqPane.addClass("pane"),this._dv=$("<div>"),this._dv.css("width","100%"),this._dv.css("height","100%"),this._dv.css("position","relative"),this._dv.css("overflow","hidden"),this._dv.appendTo(this.jqPane),this.canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.canvas).css("position","absolute"),$(this.canvas).css("z-order","2"),$(this.canvas).css("left",0),$(this.canvas).css("top",0),this.ctx=this.canvas.getContext("2d"),this.top_canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.top_canvas).css("position","absolute"),$(this.top_canvas).css("z-order","1"),$(this.top_canvas).css("left",0),$(this.top_canvas).css("top",0),this.top_ctx=this.top_canvas.getContext("2d"),this._zoomSelector=$("<div>"),this._zoomSelector.addClass("zoom-selector"),this._zoomSelector.css("display","none"),this._zoomSelector.appendTo(this._dv),this._tooltipSelector=$("<div>"),this._tooltipSelector.addClass("tooltip tooltip-selector tooltip-selector-hidden"),this._tooltipSelector.appendTo(this._dv),this.legendWidget=new A23(this,this._chart.model(),this._chart._jqMainDiv),this.jqRow=$(document.createElement("tr")),this.lhsPriceAxisWidget.jqCell.appendTo(this.jqRow),this.jqPane.appendTo(this.jqRow),this.legendWidget.jqTable.appendTo(this._dv),this.rhsPriceAxisWidget.jqCell.appendTo(this.jqRow),this.setCursorForTool(),TradingView.setMouseEventHandler($(this.top_canvas),this,!0),t&&t!==this._chart.model().panes().item(0)&&!this._chart.readOnly()&&(this.paneControls=new A51(this,this._chart.model(),this._dv)),this.updateScalesVisibility(),this.actions=[],this.readonlyActions=[],this._onKeyUpListener=this._onKeyUpListener.bind(this),this._lineCancelledCallback=this._lineCancelledCallback.bind(this),$(window).on("keyup.panewidget",this._onKeyUpListener),this._chart.withModel(this,this._lineCancelledCallback),this._overlays={},this._contextMenuY=this._contextMenuX=0,this._lockDrawingsProperty=TradingView.drawingState.lockDrawings(),t&&W77.enabled("move_logo_to_main_pane")&&t._isMainPane&&e.createLogo&&e.createLogo(null,this._dv,!0)},A53.prototype.destroy=function(){$(window).off("keyup.panewidget",this._onKeyUpListener),this.legendWidget&&(this.legendWidget.jqTable.remove(),delete this.legendWidget),this.paneControls&&(this.paneControls.jqDiv.remove(),delete this.paneControls),this._chart.withModel({chart:this._chart,instance:this,callback:this._hideTooltip},function(){this.chart.model().lineCancelled().unsubscribe(this.instance,this.callback)});for(var e in this)delete this[e]},A53.prototype._onKeyUpListener=function(e){27==e.keyCode&&(this._chart.model().lineBeingCreated()&&this._chart.model().cancelCreatingLine(),this._chart.model().model().crossHairSource().clearMeasure(),this.setCursorForTool(),this._hideTooltip())},A53.prototype._lineCancelledCallback=function(){try{this._chart.model().lineCancelled().subscribe(this,this._hideTooltip)}catch(e){}},A53.prototype.backgroundColor=function(){return this._chart.properties().paneProperties.background.value()},A53.prototype.priceAxisByCanvas=function(e){return e===this.lhsPriceAxisWidget.canvas||e===this.lhsPriceAxisWidget.top_canvas?this.lhsPriceAxisWidget:e===this.rhsPriceAxisWidget.canvas||e===this.rhsPriceAxisWidget.canvas?this.rhsPriceAxisWidget:null},A53.prototype.updateScalesVisibility=function(){this.lhsPriceAxisWidget.setVisible(this._chart.properties().scalesProperties.showLeftScale.value()),this.rhsPriceAxisWidget.setVisible(this._chart.properties().scalesProperties.showRightScale.value())},A53.prototype.chart=function(){return this._chart},A53.prototype.state=function(){return this._state},A53.prototype.setState=function(e){this._state=e},A53.prototype.stretchFactor=function(){return this._state?this._state._stretchFactor:W75.DEFAULT_STRETCH_FACTOR},A53.prototype.setStretchFactor=function(e){this._state&&(this._state._stretchFactor=e)},A53.prototype.mouseEnterEvent=function(e){(e=this._chart.model())&&(e.crossHairSource().visible=!0)},A53.prototype.isLineTool=function(e){return e=TradingView[e],"function"==typeof e&&e.prototype instanceof W47},A53.prototype.hideInplaceEditor=function(){return this._inplaceEditor?(this._inplaceEditor.remove(),this._inplaceEditor=void 0,!0):!1},A53.prototype._processMouseMoveWhileZoom=function(e){this._state.defaultPriceScale().coordinateToPrice(e.localY);var t=Math.floor(this._chart.model().timeScale().coordinateToIndex(e.localX)),t=this._chart.model().timeScale().indexToCoordinate(t)-.5*this._chart.model().timeScale().barSpacing(),i=e.localY,n=Math.abs(t-this._firstZoomPoint.x),i=Math.abs(i-this._firstZoomPoint.y);t<this._firstZoomPoint.x?this._zoomSelector.css("left",t):this._zoomSelector.css("left",this._firstZoomPoint.x),e.localY<this._firstZoomPoint.y?this._zoomSelector.css("top",e.localY):this._zoomSelector.css("top",this._firstZoomPoint.y),this._zoomSelector.width(n),this._zoomSelector.height(i)},A53.prototype._finishZoom=function(e){var t=this._state.defaultPriceScale().coordinateToPrice(e.localY);e=Math.round(this._chart.model().timeScale().coordinateToIndex(e.localX)),e!==this._firstZoomPoint.index&&this._chart.model().zoomToViewport(this._firstZoomPoint.index,e,this._firstZoomPoint.price,t,this.state()),this._zoomSelector.css("display","none"),this._firstZoomPoint=null,TradingView.drawingState.resetToCursor()},A53.EvironmentState=function(e){e.shiftKey&&(this.shift=!0),e.ctrlKey&&(this.control=!0)},A53.prototype.mouseDownEvent=function(e){$("input").blur(),$(window).focus(),this._updateCommonTooltip(null);var t=this._chart.model(),i=new A53.EvironmentState(e);this.hideInplaceEditor(),TradingView.supportTouch()&&(this._skipFirstMove=!0);var n=this._state.defaultPriceScale();if(!n.isEmpty()&&!t.timeScale().isEmpty()){var o=t.crossHairSource();TradingView.supportTouch()&&"LineToolBrush"!=TradingView.drawingState.tool.value()||t.setCurrentPosition(e.localX,e.localY,this._state);var n=o.price,r=o.index;if(o.startMeasurePoint()&&o.endMeasurePoint()&&o.clearMeasure(),i.shift&&TradingView.drawingState.toolIsCursor(TradingView.drawingState.tool.value())&&TradingView.drawingState.tool.setValue("measure"),"measure"!==TradingView.drawingState.tool.value()||o.startMeasurePoint())if(o.startMeasurePoint()&&!o.endMeasurePoint())o.finishMeasure({price:n,index:r,x:e.localX,y:e.localY}),TradingView.drawingState.resetToCursor();else if(this._firstZoomPoint)this._finishZoom(e);else if("zoom"===TradingView.drawingState.tool.value())t=t.timeScale().indexToCoordinate(r)-.5*t.timeScale().barSpacing(),this._firstZoomPoint={price:n,index:r,x:t,y:e.localY},this._zoomSelector.css("display","block"),this._zoomSelector.css("left",t),this._zoomSelector.css("top",e.localY),this._zoomSelector.width(0),this._zoomSelector.height(0);else if(t.createUndoCheckpoint(),this.isLineTool(TradingView.drawingState.tool.value())||t.lineBeingCreated())this._mouseDownEventForLineTool(e,i,r,n);else{if(n=(o=this.dataSourceAtPoint(e.localX,e.localY))&&o.source&&o.source.customization?o.source.customization:{},o.hittest&&o.hittest.result()==HitTestResult.CUSTOM){var s=o.hittest.data().mouseDownHandler;s&&s()}if(!this._chart.readOnly()){if(o&&!n.disableSelection&&t.setSelectedSource(o.source,o.hittest&&o.hittest.data()),o.source&&"eraser"===TradingView.drawingState.tool.value()&&!n.disableErasing&&(isInherited(o.source.constructor,W47)||isInherited(o.source.constructor,TradingView.Study)))return r=o.hittest.eraseMarker(),void(e.ctrlKey&&void 0!==r&&o.source.processErase?o.source.processErase(t,r):t.removeSource(o.source));if(n=o.source&&isInherited(o.source.constructor,W47)&&o.source.isLocked(),!this._lockDrawingsProperty.value()&&!n){if(o.source&&o.source.userEditEnabled&&!o.source.userEditEnabled())return;if(o.hittest&&o.hittest.result()===HitTestResult.CHANGEPOINT)return n=o.source.priceScale(),n=n.coordinateToPrice(e.localY),t.startChangingLinetool(o.source,{index:r,price:n},o.hittest.data(),i),void this._updateTooltip(e.localX,e.localY);if(o.hittest&&o.hittest.result()==HitTestResult.MOVEPOINT)return void(o.source.isFixed&&o.source.isFixed()?t.startMovingSource(o.source,new MathEx.Point(e.localX,e.localY),o.hittest.data()):(n=o.source.priceScale(),n=n.coordinateToPrice(e.localY),t.startMovingSource(o.source,{index:r,price:n},o.hittest.data())))}if(o.source&&isInherited(o.source.constructor,PriceDataSource))return void(this._chart.draggingSource=o.source)}o.hittest&&o.hittest.result()==HitTestResult.REGULAR||(this._processing=!0)}else o.startMeasuring({price:n,index:r,x:e.localX,y:e.localY},this._state)}},A53.prototype._finishTool=function(e){var t=this._chart.model(),i=TradingView.drawingState.tool.value();TradingView.drawingState.resetToCursor(),this._hideTooltip(),t.setSelectedSource(e),this._chart.isTextTool(i)&&(i=t.createUndoCheckpoint(),e=new EditObjectDialog(e,t,i),e.show(),e.focusOnText())},A53.prototype._mouseDownEventForLineTool=function(e,t,i,n){var o=this._chart.model(),r=!1,s=null,a=e.localX,l=e.localY,d=this._chart.model().model().crossHairSource(),h=TradingView.drawingState.tool.value();if(TradingView.drawingState.hideAllDrawings().setValue(!1),TradingView.drawingState.lockDrawings().setValue(!1),TradingView.supportTouch()&&this.isLineTool(h)&&"LineToolBrush"!==h&&!o.lineBeingCreated()&&(this._startTouchPoint=new MathEx.Point(a,l),this._initCrossHairPosition=d.currentPoint(),this._skipFirstMove=!0),!o.lineBeingCreated()||o.lineBeingCreated()instanceof TradingView.LineToolBrush)TradingView.supportTouch()&&"LineToolBrush"!=h||(s=o.createLineTool(this._state,{index:i,price:n},h),o.lineBeingCreated()||(r=!0));else if(TradingView.supportTouch()){if(this._skipFirstMove=!0,!this._startTouchPoint)return this._startTouchPoint=new MathEx.Point(a,l),n=o.lineBeingCreated().points(),n=n.item(n.size()-1),e=o.timeScale().indexToCoordinate(n.index),n=n.price,t=o.lineBeingCreated().priceScale(),t.isPercent()&&(o=o.lineBeingCreated().ownerSource().firstValue(),n=t.priceRange().convertToPercent(n,o)),o=t.priceToCoordinate(n),void(this._lastDrawingPoint=new MathEx.Point(e,o))}else s=o.lineBeingCreated(),r=o.paneForSource(s),r!==this._state&&(n=this._dv.offset(),a=e.localX+n.left,l=e.localY+n.top,n=this._chart.paneByState(r)._dv.offset(),a-=n.left,l-=n.top,n=s.priceScale().coordinateToPrice(l),i=Math.round(o.timeScale().coordinateToIndex(a))),r=o.coninueCreatingLine({index:i,price:n},t);o.setSelectedSource(s),r?this._finishTool(s):TradingView.supportTouch()&&"LineToolBrush"!=h||this._updateTooltip(e.localX,e.localY)},A53.prototype._equalsCursorCache=function(e,t){return TradingView.drawingState.toolIsCursor(e.tool)?e.tool===t.tool&&e.theme===t.theme&&e.crosshair===t.crosshair:e.tool===t.tool&&e.theme===t.theme},A53.prototype._setCursor=function(e){this._cursorCache&&this._equalsCursorCache(this._cursorCache,e)||(this._cursorCache=e,TradingView.drawingState.toolIsCursor(e.tool)?this.jqPane.css("cursor",e.crosshair):this.jqPane.css("cursor",cursorCss(e.state.name,e.state.hotspot,e.theme)))},A53.prototype.setCursorForTool=function(e,t){var i={_default:{name:"cursor_cross",hotspot:"11 11"},zoom:{name:"zoom",hotspot:"5 5"},pointer:{name:"cursor_pointinghand",hotspot:"13 7"},dragger:{name:"cursor_closed_hand",hotspot:"8 8"}},n=TradingView.drawingState.tool.value();TradingView.drawingState.toolIsCursor(n)&&(this._chart.draggingSource||this._isScrolling||this._chart.model()&&this._chart.model().sourceBeingMoved()?n="dragger":e&&(n="pointer")),this._chart.model()&&this._chart.model().lineBeingEdited()?n=this._chart.model().lineBeingEdited()._constructor:t==HitTestResult.CHANGEPOINT&&(n=e._constructor);var o=i._default;n in i&&(o=i[n]),this._setCursor({tool:n,theme:"light",state:o,crosshair:this.defaultPaneCursor("light")})},A53.prototype.setDragToAnotherPaneCursor=function(){this._setCursor({tool:"dragger",theme:"light",state:{name:"cursor_closed_hand_move",hotspot:"8 8"},crosshair:this.defaultPaneCursor("light")})},A53.prototype.defaultPaneCursor=function(e){var t={cursor:{name:"cursor_cross",hotspot:"11 11"},dot:{name:"cursor_dot",hotspot:"11 11"},crosshair:{name:"cursor_cross",hotspot:"11 11"},eraser:{name:"cursor_eraser",hotspot:"5 5"}},i=t[TradingView.drawingState.tool.value()];return i||(i=t[TradingView.drawingState.cursorTool.value()]),i?cursorCss(i.name,i.hotspot,e):"default"},A53.prototype.gestureStartEvent=function(e){this._prev_pinch_scale=1,this._pinching=!0},A53.prototype.gestureChangeEvent=function(e){var t=(e.originalEvent.pageX||e.originalEvent.offsetX)-5,i=this._chart._paneWidgets[0].lhsPriceAxisWidget.size.w,n=this._chart.model().timeScale().width();i&&(t=Math.max(0,t-i)),t=Math.min(t,n),t=2*(t/n-.5),i=5*(e.scale-this._prev_pinch_scale),i>0?this._chart.model().zoomIn(t,i):this._chart.model().zoomOut(t,-i),this._prev_pinch_scale=e.scale},A53.prototype.gestureEndEvent=function(e){this._pinching=!1},A53.prototype._updateCommonTooltip=function(e){var t=this._lastCommonTooltipData,i=null;e&&e.hittest&&(e=e.hittest.data())&&(i=e.tooltip||null),(null!=t||null!=i)&&(null==i?(this._lastCommonTooltipData=null,TradingView.Tooltip.hide()):t&&i.text===t.text&&i.rect.x===t.rect.x&&i.rect.y===t.rect.y&&i.rect.w===t.rect.w&&i.rect.h===t.rect.h||(this._lastCommonTooltipData=i,t=TradingView.clone(i),i=this.jqPane.offset(),t.rect.x+=i.left,t.rect.y+=i.top,TradingView.Tooltip.show(t)))},A53.prototype.mouseMoveEvent=function(e){var t=this._chart.model();if(t){var i=e.localX,n=e.localY,o=new A53.EvironmentState(e);if(this._firstZoomPoint)this._processMouseMoveWhileZoom(e);else{if(!(this._chart.readOnly()||this._editDialog&&this._editDialog.isVisible())){this.setCursorForTool();var r=TradingView.drawingState.tool.value(),s=null;this._processing||!TradingView.drawingState.toolIsCursor(r)&&"eraser"!==r||(s=this.dataSourceAtPoint(e.localX,e.localY),this.setCursorForTool(s.source,s.hittest?s.hittest.result():null),s?!s.source||"eraser"===r&&s.source.constructor===TradingView.Series?t.setHoveredSource(null):t.setHoveredSource(s.source,s.hittest.data()):t.setHoveredSource(null)),this._updateCommonTooltip(s)}if(this._chart.readOnly()&&(s=this.dataSourceAtPoint(e.localX,e.localY),t.hoveredSource(),null!==s.source?t.setHoveredSource(s.source,s.hittest.data()):t.setHoveredSource(null,null)),this._chart.model().lineBeingCreated()&&(e=this._chart.model().lineBeingCreated(),e=this._chart.model().paneForSource(e),e!==this._state))return o=this._dv.offset(),i+=o.left,n+=o.top,o=this._chart.paneByState(e)._dv.offset(),i-=o.left,n-=o.top,void t.setCurrentPosition(i,n,e);r=TradingView.drawingState.tool.value(),TradingView.supportTouch()&&this.isLineTool(r)||(t.setCurrentPosition(i,n,this._state,o),this._updateTooltip(i,n))}}},A53.prototype.pressedMouseMoveEvent=function(e){if(!this._pinching){this._skipFirstMove?(delete this._skipFirstMove,delete this._touchMove):this._touchMove=!0;var t=new A53.EvironmentState(e),i=this._chart.model(),n=e.localX,o=e.localY;if(this._firstZoomPoint)this._processMouseMoveWhileZoom(e),this._firstZoomPoint.draggingMode=!0;else{var r=TradingView.drawingState.tool.value();if(TradingView.supportTouch()&&this._startTouchPoint&&this.isLineTool(r)&&"LineToolBrush"!==r&&!i.lineBeingCreated())this._chart.model().model().crossHairSource(),i=this._initCrossHairPosition,e=new MathEx.Point(n,o).substract(this._startTouchPoint),i=i.add(e),this._chart.model().setCurrentPosition(i.x,i.y,this._state),this._updateTooltip(i.x,i.y);else if(!TradingView.supportTouch()||!i.lineBeingCreated()||i.lineBeingCreated()instanceof TradingView.LineToolBrush){if(i.setCurrentPosition(n,o,this._state,t),this._updateTooltip(n,o),currentTool=TradingView.drawingState.tool.value(),(!this.isLineTool(currentTool)||"LineToolBrush"===r)&&(0===e.button||Modernizr.touch))if("LineToolBrush"===currentTool){var s=this._state.defaultPriceScale();s.isEmpty()||(s=s.coordinateToPrice(e.localY),r=Math.round(this._chart.model().timeScale().coordinateToIndex(e.localX)),this._chart.model().coninueCreatingLine({index:r,price:s}))}else this._chart.draggingSource&&(r=e.target,(s=this._chart.paneByCanvas(r))&&(s!==this?s.setDragToAnotherPaneCursor():s.setCursorForTool()),(s=this._chart.priceAxisByCanvas(r))&&s.jqCell.css("cursor",cursorCss("cursor_closed_hand","8 8")),(r=this._chart.timeAxisByCanvas(r))&&r.jqCell.css("cursor",cursorCss("cursor_closed_hand_move","8 8"))),i.timeScale().isEmpty()||(i.lineBeingEdited()?(i.changeLinePoint({x:n,y:o},t),this._updateTooltip(n,o),this.setCursorForTool()):i.sourceBeingMoved()?(s=i.sourceBeingMoved().priceScale(),s.isEmpty()||(r=this._chart.model().timeScale().coordinateToIndex(e.localX),s=s.coordinateToPrice(e.localY),e=i.sourceBeingMoved(),this.setCursorForTool(),isInherited(e.constructor,W47)&&e.isFixed()?i.moveSource(new MathEx.Point(n,o)):i.moveSource({index:r,price:s},t))):(s=this._state.defaultPriceScale(),this._startScrollingPos||(this._startScrollingPos={x:e.clientX,y:e.clientY}),!this._startScrollingPos||this._startScrollingPos.x===e.clientX&&this._startScrollingPos.y===e.clientY||this._isScrolling||(i.beginUndoMacro("scroll"),s.isEmpty()||i.startScrollPrice(this._state,s,e.localY),i.startScrollTime(e.localX),this._isScrolling=!0,this.setCursorForTool(),TradingView.trackEvent("GUI","Scrolling by pane content dragging")),this._isScrolling&&(s.isEmpty()||i.scrollPriceTo(this._state,s,e.localY),i.scrollTimeTo(e.localX))))}else this._startTouchPoint&&(o=i.lineBeingCreated(),n=this._lastDrawingPoint.x+(e.localX-this._startTouchPoint.x),e=this._lastDrawingPoint.y+(e.localY-this._startTouchPoint.y),o=this._chart.model().paneForSource(o),i.setCurrentPosition(n,e,o),this._updateTooltip(n,e))}}},A53.prototype._processMouseUpForCustomHandler=function(e){e=this.dataSourceAtPoint(e.localX,e.localY),e.hittest&&e.hittest.result()==HitTestResult.CUSTOM&&(e=e.hittest.data().mouseUpHandler)&&e()},A53.prototype.mouseUpEvent=function(e){this._processMouseUpForCustomHandler(e);var t=this._chart.model(),i=this._touchMove;delete this._touchMove;var n=TradingView.drawingState.tool.value();if(TradingView.supportTouch()&&!i&&"LineToolBrush"!==n&&this.isLineTool(n)&&!t.lineBeingCreated()){var o=t.crossHairSource().currentPoint(),i=this._state.defaultPriceScale(),i=i.coordinateToPrice(o.y),r=Math.round(t.timeScale().coordinateToIndex(o.x)),r=t.createLineTool(this._state,{index:r,price:i},n);t.setSelectedSource(r),t.lineBeingCreated()||this._finishTool(r),this._updateTooltip(o.x,o.y),delete this._startTouchPoint}else if(!t.lineBeingCreated()||t.lineBeingCreated()instanceof TradingView.LineToolBrush||!this._startTouchPoint)if(this._firstZoomPoint&&this._firstZoomPoint.draggingMode)this._finishZoom(e);else{if(0===e.button||TradingView.supportTouch()){if(this._processing=!1,t=this._chart.model(),t.lineBeingEdited())return t.endChangingLinetool(),void this._hideTooltip();if("LineToolBrush"===n){if(t.lineBeingCreated().finish(),i=this._state.defaultPriceScale(),i.isEmpty())return;return i=i.coordinateToPrice(e.localY),r=Math.round(this._chart.model().timeScale().coordinateToIndex(e.localX)),void this._chart.model().coninueCreatingLine({index:r,price:i
})}if(r=t.sourceBeingMoved())return t.endMovingSource(),this._hideTooltip(),this.setCursorForTool(r),void t.D20(new A22(A22.UPDATE_CURSOR_ONLY));if(r=this._isScrolling&&A77.undoStack().head()instanceof UndoMacroCommand,this._isScrolling){i=this._state.defaultPriceScale(),t.endScrollPrice(this._state,i);var s=this,a=function(){t.endScrollTime(),t.endUndoMacro(),s._startScrollingPos=void 0,s._isScrolling=!1,s.setCursorForTool()};if(TradingView.supportTouch()){var i=t.timeScale().m_scrollStartPoint,l=.05*(e.localX-i),d=null,h=function(i){null===d&&(d=i),i=.01*Math.min(100,3*(i-d)),i=Math.sqrt(i),t.scrollTimeTo(e.localX+l*i),i>=1?a():requestAnimationFrame(h)};requestAnimationFrame(h)}else a()}this._chart.draggingSource&&(n=e.target,(o=this._chart.paneByCanvas(n))&&o!=this&&(i=o._state.findSuitableScale(this._chart.draggingSource),r&&(r=!1,A77.undo()),this._chart.model().move(this._chart.draggingSource,o._state,i)),(i=this._chart.priceAxisByCanvas(n))&&(o=i.pane,i=i._isLeft?o._state.leftPriceScale():o._state.rightPriceScale(),r&&(r=!1,A77.undo()),this._chart.model().move(this._chart.draggingSource,o._state,i)),(i=this._chart.timeAxisByCanvas(n))&&(r&&(r=!1,A77.undo()),this._chart.model().move(this._chart.draggingSource,null,null),i.jqCell.css("cursor","")),this._chart.draggingSource=null,r=this.dataSourceAtPoint(e.localX,e.localY),this.setCursorForTool(r.source,r.hittest||null))}delete this._touchMove}else{if(n=!1,delete this._startTouchPoint,!i){if(r=t.lineBeingCreated(),n=r.points().last(),i=n.price,o=r.priceScale(),o.isPercent())var c=t.lineBeingCreated().ownerSource().firstValue(),i=o.priceRange().convertToPercent(i,c);n=t.coninueCreatingLine({index:n.index,price:i},{}),delete this._lastDrawingPoint}n&&this._finishTool(r)}},A53.prototype.mouseLeaveEvent=function(e){(e=this._chart.model())&&(TradingView.isMobile.any()||e.model().clearCurrentPosition(),e.setHoveredSource(null),this._updateCommonTooltip(null))},A53.prototype.mouseClickEvent=function(e){this._chart.model().hoveredSource()instanceof W96&&this._chart.model().hoveredSource().onClicked()},A53.prototype.showEditDialogForSource=function(e){this.chart().onWidget()||e.userEditEnabled&&!e.userEditEnabled()||(this._editDialog=new EditObjectDialog(e,this._chart.model()),this._editDialog.show())},A53.prototype.mouseDoubleClickEvent=function(e){if(e=this.dataSourceAtPoint(e.localX,e.localY),!(this._chart.readOnly()||!e||!e.source||e.source instanceof W96||this.isLineTool(TradingView.drawingState.tool.value()))){var t=e.source;t&&t.customization&&t.customization.disableSelection||(t._metaInfo&&"Sessions@tv-basicstudies"==t._metaInfo.id&&(t=this._chart.model().mainSeries()),e.source instanceof TradingView.AlertLabel?editAlert(e.source.alert(),this._chart):this.showEditDialogForSource(t))}},A53.prototype.showContextMenuForSource=function(e,t){e.hasContextMenu()&&(this._chart.model().setSelectedSource(e),e.constructor===TradingView.Series?this._seriesContextMenu(e).show(t):isInherited(e.constructor,TradingView.ESDStudyBase)?this._studyEsdContextMenu(e).show(t):isInherited(e.constructor,TradingView.Study)?this._studyContextMenu(e).show(t):isInherited(e.constructor,PublishedChartsTimeline)?this._publishedChartsContextMenu(e).show(t):isInherited(e.constructor,TradingView.LineToolOrder)||isInherited(e.constructor,TradingView.LineToolPosition)?this._tradingDrawingsContextMenu(e).show(t):isInherited(e.constructor,W47)?this._lineContextMenu(e).show(t):isInherited(e.constructor,TradingView.AlertLabel)&&!e.fake&&this._alertLabelContextMenu(e).show(t))},A53.prototype.contextMenuEvent=function(e,t){if(W77.enabled("pane_context_menu"))if(this._chart.model().crossHairSource().startMeasurePoint())this._chart.model().crossHairSource().clearMeasure();else if(!(this._pinching||this._disableContextMenu||this.chart().readOnly()||(this._firstZoomPoint&&(this._zoomSelector.css("display","none"),delete this._firstZoomPoint),this._chart.model().mainSeries().createSessStudy(),this._chart.updateActions(),this.hideInplaceEditor())))if(TradingView.drawingState.toolIsCursor(TradingView.drawingState.tool.value())){this._contextMenuX=e.localX,this._contextMenuY=e.localY;var i=this.dataSourceAtPoint(e.localX,e.localY),i=i?i.source:null;null===i?(this._contextMenu(e).show(e),this._chart.model().setSelectedSource(null)):this.showContextMenuForSource(i,e),this.paint()}else TradingView.isMobile.any()||(TradingView.drawingState.resetToCursor(!0),this.setCursorForTool(),this._hideTooltip(),this._chart.model().lineBeingCreated()&&this._chart.model().cancelCreatingLine())},A53.prototype._contextMenu=function(e){var t=this._initActions(e);e=this._customActions(),e.remove.forEach(function(e){for(var i=0;i<t.length;i++)if(t[i].text===e){t.splice(i,1);break}}),e=e.top.concat(t).concat(e.bottom);for(var i=e.length-1;i>0;i--)null===e[i].text&&null===e[i-1].text&&e.splice(i,1);return e.length&&null===e[0].text&&e.splice(0,1),e.length&&null===e[e.length-1].text&&e.splice(e.length-1,1),ContextMenu.createMenu(e)},A53.prototype.createIndicatorsMenu=function(){var e=this._chart.actions(),t=new Action({text:$.t("Indicators")});t.subActions||(t.subActions=[]);var i=t.subActions;return i.push(e.insertIndicator),TradingView.isMobile.any()||W77.enabled("charting_library")||i.push(e.scriptEditor),i.push(new ActionSeparator),i.push(e.paneRemoveAllStudies),t},A53.prototype.createDrawingMenu=function(){var e=this._chart.actions(),t=new Action({text:$.t("Drawing Tools")});t.subActions||(t.subActions=[]);var i=t.subActions;return i.push(e.drawingToolbarAction),W77.enabled("charting_library")||i.push(e.favoriteDrawingToolbar),i.push(new ActionSeparator),i.push(e.magnetAction),i.push(e.stayInDrawingModeAction),i.push(new ActionSeparator),i.push(e.lockDrawingsAction),i.push(e.hideAllDrawingsAction),i.push(e.paneRemoveAllDrawingTools),t},A53.prototype._initActions=function(e){var t=this._chart.actions(),i=[];return TradingView.D18("alerts")&&!this.chart().onWidget()&&i.unshift(this._createActionAddAlert({e:e})),this.chart().onWidget()||(e=this.createActionTrade(e))&&i.push(e),i.length&&i.push(new ActionSeparator),i.push(t.chartReset),i.push(t.symbolSearch),W77.enabled("charting_library")||i.push(t.addToWatchlist),i.push(new ActionSeparator),i.push(t.paneObjectTree),i.push(this.createIndicatorsMenu()),W77.enabled("charting_library")||i.push(t.applyStudyTemplate),i.push(this.createDrawingMenu()),W77.enabled("charting_library")&&i.push(t.hideAllMarks),i.push(t.compareOrAdd),(e=this._priceAxisMenu())&&i.push(e),(e=this._timeAxisMenu())&&i.push(e),i.push(new ActionSeparator),W77.enabled("charting_library")||i.push(t.applyColorTheme),i.push(t.chartProperties),pro.hasPackage("mtp-mtpredictor")&&this.state().containsMainSeries()&&(i.push(new ActionSeparator),i.push(this._createMTPredictorActions())),i},A53.prototype._customActions=function(){var e={top:[],bottom:[],remove:[]},t=this._chart.model().timeScale(),i=this._state.defaultPriceScale();return W77.enabled("custom_items_in_context_menu")?(t=t.isEmpty()?void 0:t.indexToUserTime(t.coordinateToIndex(this._contextMenuX)),D17.emit("onContextMenu",{unixtime:t?t/1e3:void 0,price:i.isEmpty()?void 0:i.coordinateToPrice(this._contextMenuY),callback:function(t){[].concat(t).forEach(function(t){if(t.text)if(1<t.text.length&&"-"===t.text[0])e.remove.push(t.text.slice(1));else{var i;"-"===t.text?i=new ActionSeparator:(i=new Action({text:t.text}),i.callbacks().subscribe(null,t.click)),t.position&&"top"==t.position?e.top.push(i):e.bottom.push(i)}})}}),e):e},A53.prototype._timeAxisMenu=function(){if(this._chart.model().timeScale().isEmpty())return null;var e=this._chart.getTimeScale();return new Action({text:"Time Scale",subActions:e.getContextMenuActions()})},A53.prototype._priceAxisMenu=function(){var e=this._state.defaultPriceScale();return e.isEmpty()?null:(e=e===this._state.leftPriceScale?this.leftPriceAxisWidget():this.rightPriceAxisWidget(),new Action({text:"Price Scale",subActions:e.getContextMenuActions()}))},A53.prototype._seriesContextMenu=function(e){var t=this._chart.actions(),i=e.properties().visible.value(),n=null;if(this._chart.readOnly())e=[i?t.seriesHide:this.createActionShow(e),new ActionSeparator,this.createActionShowCountdown(e),new ActionSeparator,this.createActionScaleLeft(e),this.createActionScaleRight(e),this.createActionNoScale(e)],W77.enabled("countdown")||e.splice(3,1),n=ContextMenu.createMenu(e);else{if(n=this._mergeContentMenuItems(e),i=[t.compare,i?t.seriesHide:this.createActionShow(e),this.createVisualOrderAction(e),new ActionSeparator,this.createActionShowCountdown(e),new ActionSeparator],W77.enabled("countdown")||i.splice(5,1),this.chart().onWidget()||i.unshift(t.format),this.chart().canCreateAlertForDataSource(e)&&i.unshift(this._createActionAddAlert({series:e})),(t=this.createActionLockScale(e))&&(i.push(t),i.push(new ActionSeparator)),0<n.length){for(t=0;t<n.length;t++)i.push(n[t]);i.push(new ActionSeparator)}i.push(this.createActionScaleLeft(e)),i.push(this.createActionScaleRight(e)),i.push(this.createActionNoScale(e)),pro.hasPackage("mtp-mtpredictor")&&(i.push(new ActionSeparator),i.push(this._createMTPredictorActions())),n=ContextMenu.createMenu(i)}return n},A53.prototype._createMTPredictorActions=function(){var e=this,t=function(t,i,n){return t=new Action({text:t}),t.callbacks().subscribe(e,function(){var e=this._chart.model(),t=e.timeScale(),o=this._state.defaultPriceScale();t.isEmpty()||o.isEmpty()||(n?(o=o.coordinateToPrice(this._contextMenuY),t=Math.round(t.coordinateToIndex(this._contextMenuX)),e.createLineTool(this._state,{index:t,price:o},i)):TradingView.drawingState.tool.setValue(i))}),t};return new Action({text:"MTPredictor",subActions:[t("Apply Manual Risk/Reward","LineStudyMtpRiskReward",!1),t("Apply Manual Decision Point","LineStudyMtpDecisionPoint",!0),t("Analyze Trade Setup","LineStudyMtpAnalysis",!0),new Action({text:"Apply Elliot Wave",subActions:[t("Apply Elliot Wave Intermediate","LineStudyMtpElliotWaveMain",!0),t("Apply Elliot Wave Major","LineStudyMtpElliotWaveMajor",!0),t("Apply Elliot Wave Minor","LineStudyMtpElliotWaveMinor",!0)]}),new Action({text:"Apply WPT Up Wave",subActions:[t("Up Wave 1 or A","LineStudyMtpUpWave1OrA",!1),t("Up Wave 2 or B","LineStudyMtpUpWave2OrB",!1),t("Up Wave C","LineStudyMtpUpWaveC",!1),t("Up Wave 3","LineStudyMtpUpWave3",!1),t("Up Wave 4","LineStudyMtpUpWave4",!1),t("Up Wave 5","LineStudyMtpUpWave5",!1)]}),new Action({text:"Apply WPT Down Wave",subActions:[t("Down Wave 1 or A","LineStudyMtpDownWave1OrA",!1),t("Down Wave 2 or B","LineStudyMtpDownWave2OrB",!1),t("Down Wave C","LineStudyMtpDownWaveC",!1),t("Down Wave 3","LineStudyMtpDownWave3",!1),t("Down Wave 4","LineStudyMtpDownWave4",!1),t("Down Wave 5","LineStudyMtpDownWave5",!1)]})]})},A53.prototype.createEarningsShow=function(e){var t=this._chart.model().mainSeries().properties().esdShowEarnings;return e=new Action({checkable:!0,text:"Show Earnings",enabled:!0,checked:t.value()}),e.callbacks().subscribe(this,function(e){this._chart.model().setProperty(t,e.checked,"Show Earnings")}),e},A53.prototype.createDividendsShow=function(e){var t=this._chart.model().mainSeries().properties().esdShowDividends;return e=new Action({checkable:!0,text:"Show Dividends",enabled:!0,checked:t.value()}),e.callbacks().subscribe(this,function(e){this._chart.model().setProperty(t,e.checked,"Show Dividends")}),e},A53.prototype.createSplitsShow=function(e){var t=this._chart.model().mainSeries().properties().esdShowSplits;return e=new Action({checkable:!0,text:"Show Splits",enabled:!0,checked:t.value()}),e.callbacks().subscribe(this,function(e){this._chart.model().setProperty(t,e.checked,"Show Splits")}),e},A53.prototype._studyEsdContextMenu=function(e){var t=[];return this._chart.readOnly()||(t.push(this.createDividendsShow(e)),t.push(this.createSplitsShow(e)),t.push(this.createEarningsShow(e))),ContextMenu.createMenu(t)},A53.prototype._studyContextMenu=function(e){var t=this._chart.actions(),i=e.properties().visible.value(),n=[],o=null;return e.userEditEnabled()?(e.properties().linkedToSeries&&e.properties().linkedToSeries.value()?this._chart.readOnly()?n.push(i?t.studyHide:this.createActionShow(e)):(this._chart.canCreateAlertForDataSource(e)&&n.push(this._createActionAddAlert({series:e})),n.push(t.format),n.push(i?t.studyHide:this.createActionShow(e)),n.push(this.createVisualOrderAction(e)),n.push(new ActionSeparator),n.push(t.studyRemove)):this._chart.readOnly()?n=[i?t.studyHide:this.createActionShow(e),new ActionSeparator,this.createActionScaleLeft(e),this.createActionScaleRight(e),this.createActionNoScale(e)]:(o=[],n=e.metaInfo(),n.TVScriptSourceCode&&n.scriptIdPart&&(o=[t.viewSourceCode]),n=[],n=n.concat([t.format]),n=n.concat(o),n=n.concat([i?t.studyHide:this.createActionShow(e),this.createVisualOrderAction(e),new ActionSeparator]),i=this._mergeContentMenuItems(e),i.length&&i.push(new ActionSeparator),n=n.concat(i),n.push(this.createActionScaleLeft(e)),n.push(this.createActionScaleRight(e)),n.push(this.createActionNoScale(e)),n.push(new ActionSeparator),n.push(t.studyRemove),this._chart.canCreateAlertForDataSource(e)&&n.unshift(this._createActionAddAlert({series:e}))),o=ContextMenu.createMenu(n)):o=ContextMenu.createMenu(n)},A53.prototype.createLineToolTemplateAction=function(e){var t=e.properties(),i=window.lineToolPropertiesToolbar.templatesList,n=new Action({text:$.t("Templates")});n.subActions||(n.subActions=[]);var o=n.subActions,r=new Action({text:$.t("Save As...")});r.callbacks().subscribe(this,function(){i.showSaveDialog(e)}),o.push(r),r=new Action({text:$.t("Apply Default")}),r.callbacks().subscribe(this,function(){t.restoreFactoryDefaults(),window.lineToolPropertiesToolbar.onSourceChanged(e)}),o.push(r);var s=$.Deferred();return i.templatesLoaded().then(function(){var e=i.getData(),t=[];0!=e.length&&t.push(new ActionSeparator),$.each(e,function(e,n){var o=new Action({text:n});o.callbacks().subscribe(this,function(){i.loadTemplate(n)}),o.deleteButton={action:function(e){return function(){var t=this.getTopLevelMenu();return t&&t.hide(),i.deleteAction(e),!0}}(o.text)},t.push(o)}),s.resolve(t)}),r=new ActionPlaceholder(s),o.push(r),n},A53.prototype._publishedChartsContextMenu=function(e){var t=this._chart.actions(),i=[];if(i.push(t.lineHide),is_authenticated){var t=new Action({checked:e.properties().filter.value()==PublishedChartsTimeline.FILTER_NONE,checkable:!0,text:$.t("Suggested ideas & my ideas"),callbackContext:{target:e,value:PublishedChartsTimeline.FILTER_NONE}}),n=new Action({checked:e.properties().filter.value()==PublishedChartsTimeline.FILTER_FOLLOWING,checkable:!0,text:$.t("Ideas of the people I follow & my ideas"),callbackContext:{target:e,value:PublishedChartsTimeline.FILTER_FOLLOWING}});e=new Action({checked:e.properties().filter.value()==PublishedChartsTimeline.FILTER_PRIVATE,checkable:!0,text:$.t("My ideas only"),callbackContext:{target:e,value:PublishedChartsTimeline.FILTER_PRIVATE}});var o=function(e){var t=e.callbackContext();e=t.target,t=t.value,console.log(t),e.properties().filter.setValue(t),e.updateAllViews(),e.D0.updateSource(e)};t.callbacks().subscribe(null,o),n.callbacks().subscribe(null,o),e.callbacks().subscribe(null,o),i.push(new ActionSeparator),i.push(t),i.push(n),i.push(e)}return ContextMenu.createMenu(i)},A53.prototype._lineContextMenu=function(e){var t=this._chart.actions(),i=[];if(this._chart.readOnly())i.push(t.lineHide);else if(e.userEditEnabled()){if(TradingView.D18("alerts")&&TradingView.D18("drawing_alerts")&&!this.chart().onWidget()&&(e.hasAlert.value()?i.push(this._createEditAlertDrawingAction(e)):e.canHasAlert()&&i.push(this._createActionAddAlert({drawing:e}))),PropertyPagesFactory.hasStylesPropertyPage(e,this._chart.model())&&i.push(t.format),i.push(t.paneObjectTree),W77.enabled("charting_library")||i.push(this.createLineToolTemplateAction(e)),i.push(this.createVisualOrderAction(e)),i.push(new ActionSeparator),i.push(t.lineHide),i.push(t.lineToggleLock),e.properties().clonable){var n=new Action({text:$.t("Clone"),callbackContext:{target:e}});n.callbacks().subscribe(this,A53.prototype.cloneLineTool.bind(this,e)),i.push(n)}if(i.push(t.lineRemove),e.additionalActions)for(i.push(new ActionSeparator),t=e.additionalActions(this._chart.model()),n=0;n<t.length;n++)i.push(t[n])}if(this._state.D19(),t=new List,1<t.size()){for(var o=[],n=0;n<t.size();n++){var r=t.item(n),r=new Action({checked:r===e.ownerSource(),checkable:!0,text:r.title(),callbackContext:{target:e,owner:r}});r.callbacks().subscribe(null,this._lineContextMenu._actionCallback),o.push(r)}e=new Action({subActions:o,text:$.t("Link To")}),i.push(new ActionSeparator),i.push(e)}return ContextMenu.createMenu(i)},A53.prototype._alertLabelContextMenu=function(e){return e=[this._createEditAlertLabelAction(e),this._createStopAlertLabelAction(e),this._createDeleteAlertLabelAction(e),new ActionSeparator,this._createAlertToggleHorzLineLabelAction(e),new ActionSeparator,this._createShowGlobalAlertPropertiesLabelAction(e)],ContextMenu.createMenu(e)},A53.prototype._tradingDrawingsContextMenu=function(e){return ContextMenu.createMenu(e.contextMenuItems())},A53.prototype._createAlertToggleHorzLineLabelAction=function(e){var t=e.properties().line.visible,i=new Action({checkable:!0,text:"Extend Alert Line",enabled:!0,checked:t.value()});return i.callbacks().subscribe(this,function(e){e=e.checked;var i=(e?"Show":"Hide")+" alert label line";this._chart.model().setProperty(t,e,i)}),i.setEnabled(e.globalProperties().line.visible.value()),i},A53.prototype._createShowGlobalAlertPropertiesLabelAction=function(e){var t=this.chart();return e=new Action({text:"Visual settings..."}),e.callbacks().subscribe(this,function(e){e=t.showChartProperties().find(".properties-tabs-label").filter(function(){return"Events"===$(this).text()}),e.length&&e.trigger("click")}),e},A53.prototype._createEditAlertDrawingAction=function(e){if(e.hasAlert.value()){var t=this.chart(),i=new Action({text:"Edit "+e.title()+" Alert..."});return i.callbacks().subscribe(null,function(){runOrSignIn(function(){e.getAlert(function(i){i?editAlert(i,t):console.warn("[Alerts] No alert for "+e.title())})})}),i}},A53.prototype._createEditAlertLabelAction=function(e){var t=this.chart(),i=new Action({text:"Edit Alert..."});return i.callbacks().subscribe(this,function(){editAlert(e.alert(),t)}),i},A53.prototype._createDeleteAlertLabelAction=function(e){var t=new Action({text:"Delete Alert"});return t.callbacks().subscribe(this,function(){deleteAlert(e.alert())}),t},A53.prototype._createStopAlertLabelAction=function(e){var t=new Action({text:"Stop Alert"});return t.callbacks().subscribe(this,function(){stopAlert(e.alert())}),t},A53.prototype._lineContextMenu._actionCallback=function(e){e=e.callbackContext();var t=[],i=e.target.priceScale();if(i.isPercent())var n=e.target.ownerSource().firstValue();for(var o=e.target.points().toArray(),r=this._chart,s=0;s<o.length;s++){var a=o[s].price;i.isPercent()&&(a=i.priceRange().convertToPercent(a,n)),a=i.priceToCoordinate(a),t.push(a)}for(e.target.setOwnerSource(e.owner),i=e.owner.priceScale(),r.model().move(e.target,that._state,i),s=0;s<t.length;s++)a=i.coordinateToPrice(t[s]),n=o[s],n.price=a,e.target.setPoint(s,n);r.model().model().recalculateAllPanes()},A53.prototype.cloneLineTool=function(e){this._chart.model().cloneLineTool(e)},A53.prototype.setPriceAxisSize=function(e,t){this._priceAxisWidget(e).setSize(t)},A53.prototype.setPriceAxisVisible=function(e,t){this._priceAxisWidget(e).setVisible(t),this._cachedStatus=null},A53.prototype.resetPriceAxisOptimalWidth=function(e){this._priceAxisWidget(e).resetOptimalWidth(),this._cachedStatus=null},A53.prototype.setSize=function(e){this.size&&this.size.equals(e)||(this.size=e,TradingView.setCanvasSize(this.canvas,e),TradingView.setCanvasSize(this.top_canvas,e),this.ctx=this.canvas.getContext("2d"),this.jqPane.width(e.w),this.jqPane.height(e.h),this._cachedStatus=null)},A53.prototype.dataSourceAtPoint=function(e,t){var i=null,n=null;if(!this._state)return null;for(var o=new List(this._state.hitTestSources()),r=o.size();0<r--;){var s=o.item(r),a=s.paneViews(this._state);if(a){for(var l=a.size();0<l--;){var d=a.item(l).renderer();if(d&&d.hitTest&&(d=d.hitTest(new MathEx.Point(e,t)))){n=d,i=s;break}}if(i)break}}if(this.containsMainSeries())for(o=this._chart.model().barsMarksSources(),r=0;r<o.length;++r)for(s=o[r],a=s.paneViews(),r=0;r<a.size();r++)if(d=a.item(r).renderer(),l=d.hitTest(new MathEx.Point(e,t))){n=l,i=s;break}return null===i&&(i=this.legendWidget.dataSourceAtPoint(e,t)),{source:i,hittest:n}},A53.prototype.update=function(){this.lhsPriceAxisWidget.update(),this.rhsPriceAxisWidget.update(),this.legendWidget.update(),this.paneControls&&this.paneControls.update()},A53.prototype.updateControls=function(){this.paneControls&&this.paneControls.update()},A53.prototype.drawBackground=function(e,t){clearRect(e,0,0,this.size.w,this.size.h,t)},A53.prototype.drawGrid=function(e){for(var t=this._chart.model().gridSource().paneViews(this._state),i=0;i<t.size();i++){e.save();var n=t.item(i).renderer();n&&n.draw(e),e.restore()}},A53.prototype.drawWatermark=function(e){for(var t=this._chart.model().watermarkSource().paneViews(this._state),i=0;i<t.size();i++){e.save();var n=t.item(i).renderer();n&&n.draw(e),e.restore()}},A53.prototype.drawCrossHair=function(e){var t=this._chart.model().crossHairSource();this._drawSource(t,e)},A53.prototype._drawSource=function(e,t){var i=e.paneViews(this._state);if(i)for(var n=0;n<i.size();n++){var o=i.item(n).renderer();o&&(t.save(),o.draw(t),t.restore())}},A53.prototype._drawSourceBackground=function(e,t){var i=e.paneViews(this._state);if(i)for(var n=0;n<i.size();n++){var o=i.item(n).renderer();o&&o.drawBackground&&(t.save(),o.drawBackground(t),t.restore())}},A53.prototype.drawActiveLineTool=function(e){for(var t=[this._chart.model().lineBeingCreated(),this._chart.model().sourceBeingMoved(),this._chart.model().lineBeingEdited()],i=0;i<t.length;i++){var n=t[i];n&&this._chart.model().paneForSource(n)===this._state&&this._drawSource(n,e)}},A53.prototype.disableDrawOnTop=function(e){return e&&e.hasOwnProperty("_metaInfo")&&"Volume@tv-basicstudies"===e._metaInfo.id},A53.prototype.drawSources=function(e){var t=this._state.orderedSources(),i=this._state.model(),n=this._chart.model().hoveredSource(),i=i.crossHairSource(),o=[this._chart.model().lineBeingCreated(),this._chart.model().sourceBeingMoved(),this._chart.model().lineBeingEdited()];this.disableDrawOnTop(n)&&(n=void 0);for(var r=0;r<t.length;r++)this._drawSourceBackground(t[r],e);for(r=0;r<t.length;r++){var s=t[r];s!==i&&s!==n&&-1===o.indexOf(s)&&this._drawSource(s,e)}n&&-1===o.indexOf(n)&&-1!==t.indexOf(n)&&this._drawSource(n,e)},A53.prototype.recalculatePriceScale=function(){var e=this._state;e.recalculatePriceScale(e.m_rightPriceScale),e.recalculatePriceScale(e.m_leftPriceScale);for(var t=0;t<e.D19().size();++t){var i=e.D19().item(t);e.isOverlay(i)&&(e.recalculatePriceScale(i.priceScale()),i.updateAllViews())}},A53.prototype.containsMainSeries=function(){return this._state.containsMainSeries()},A53.prototype.drawBarsMarks=function(e,t){if(this.containsMainSeries()&&!t){var i=this;this._chart.model().barsMarksSources().map(function(t){i._drawSource(t,e)})}},A53.prototype._syncOverlays=function(){var e=this._state.orderedSources(),t={},i=this;$.each(e,function(){var e=this.paneViews(i._state);if(e)for(var n=0;n<e.size();n++){var o=e.item(n);o.uid&&(t[o.uid()]=o)}});for(var n in this._overlays)t[n]||(this._dv.remove(this._overlays[n]),this._overlays[n]=void 0);for(n in t)this._overlays[n]||(e=t[n].overlay(),this._dv.append(e),this._overlays[n]=e)},A53.prototype.paint=function(e,t){if(e&&this._chart.model())if(this.lhsPriceAxisWidget.paint(e),this.rhsPriceAxisWidget.paint(e),e===A22.FULL_UPDATE&&(this._cachedStatus=null),e===A22.UPDATE_CURSOR_ONLY)this.top_ctx.clearRect(0,0,this.size.w,this.size.h),this.drawCrossHair(this.top_ctx),this.drawActiveLineTool(this.top_ctx);else{var i=this.ctx;this.top_ctx.clearRect(0,0,this.size.w,this.size.h),this.drawBackground(i,this.backgroundColor()),this._state&&(this.recalculatePriceScale(),this.drawGrid(i),this.drawWatermark(i),this.drawSources(i),this.drawBarsMarks(i,t),this.drawCrossHair(this.top_ctx),this.drawActiveLineTool(this.top_ctx))}},A53.prototype.leftPriceAxisWidget=function(){return this.lhsPriceAxisWidget},A53.prototype.rightPriceAxisWidget=function(){return this.rhsPriceAxisWidget},A53.prototype._priceAxisWidget=function(e){return A54.isLeft(e)?this.lhsPriceAxisWidget:this.rhsPriceAxisWidget},A53.prototype.statusWidget=function(){return this.legendWidget},A53.prototype.onScaleLeft=function(e){e=e.callbackContext(),this._state.leftPriceScale().D19().contains(e)||this.chart().model().move(e,this._state,this._state.leftPriceScale())},A53.prototype.onScaleRight=function(e){e=e.callbackContext(),this._state.rightPriceScale().D19().contains(e)||this.chart().model().move(e,this._state,this._state.rightPriceScale())},A53.prototype.onNoScale=function(e){e=e.callbackContext(),this._state.isOverlay(e)||this.chart().model().move(e,this._state,null)},A53.prototype.onRiskReward=function(e){e.callbackContext()},A53.prototype.createActionTrade=function(e){if(!TradingView.Trading||!TradingView.D18("paper_trading"))return null;var t=this._state.D19().find(function(e){return e instanceof TradingView.Series}),i=NaN,n=NaN,o=1,r="",s="",a="",l=!1;return t&&(s=t.actualSymbol(),a=(t.symbolInfo()||{}).name||s,l=t.priceScale(),e&&(i=l.coordinateToPrice(e.localY),l.isPercentage()&&(e=this._state.mainDataSource().firstValue(),i="undefined"!=typeof e?l.priceRange().convertFromPercent(i,e):null),r=t.formatter().format(i)),(l=t.bars().last())&&(n=l.value[CLOSE_PLOT]),l=!!(t.symbolInfo()||{}).is_tradable,l=!0,e=t.symbolInfo(),o=TradingView.Trading.suggestedQty.value(s,{symbolType:e&&e.type})),e=[],n>i?(n=new Action({text:"Buy "+a+" Limit "+abbreviatedNumber(o)+" @ "+r,enabled:l}),l&&n.callbacks().subscribe(null,function(){runOrSignIn(function(){TradingView.OrderDialog.get().open({symbol:s,price:+r||i,side:"buy",type:"limit",qty:o,noConfirm:!0})})}),e.push(n),n=new Action({text:"Sell "+a+" Stop "+abbreviatedNumber(o)+" @ "+r,enabled:l}),l&&n.callbacks().subscribe(null,function(){runOrSignIn(function(){TradingView.OrderDialog.get().open({symbol:s,price:+r||i,side:"sell",type:"stop",qty:o,noConfirm:!0})})}),e.push(n)):i>n&&(n=new Action({text:"Sell "+a+" Limit "+abbreviatedNumber(o)+" @ "+r,enabled:l}),l&&n.callbacks().subscribe(null,function(){runOrSignIn(function(){TradingView.OrderDialog.get().open({symbol:s,price:+r||i,side:"sell",type:"limit",qty:o,noConfirm:!0})})}),e.push(n),n=new Action({text:"Buy "+a+" Stop "+abbreviatedNumber(o)+" @ "+r,enabled:l}),l&&n.callbacks().subscribe(null,function(){runOrSignIn(function(){TradingView.OrderDialog.get().open({symbol:s,price:+r||i,side:"buy",type:"stop",qty:o,noConfirm:!0})})}),e.push(n)),n=new Action({text:"Create New Order...",enabled:l}),l&&n.callbacks().subscribe(null,function(){runOrSignIn(function(){TradingView.OrderDialog.get().open({qty:o,symbol:t.actualSymbol(),price:+r||i})})}),e.push(n),e.push(new ActionSeparator),n=new Action({text:"Trading Properties..."}),n.callbacks().subscribe(null,function(){TradingView.bottomWidgetBar.showTradingProperties()}),e.push(n),new Action({text:"Trading",subActions:e})},A53.prototype.createActionRiskReward=function(e){var t=new Action({checkable:!1,text:"Risk/Reward",enabled:!0});return t.setCallbackContext(e),t.callbacks().subscribe(this,A53.prototype.onRiskReward),t},A53.prototype.createActionScaleLeft=function(e){var t=new Action({checkable:!0,text:$.t("Scale Left"),enabled:!0});return t.setCallbackContext(e),t.setChecked(this._state.leftPriceScale().D19().contains(e)),t.callbacks().subscribe(this,A53.prototype.onScaleLeft),t},A53.prototype.createActionScaleRight=function(e){var t=new Action({checkable:!0,text:$.t("Scale Right"),enabled:!0});return t.setCallbackContext(e),t.setChecked(this._state.rightPriceScale().D19().contains(e)),t.callbacks().subscribe(this,A53.prototype.onScaleRight),t},A53.prototype.createActionNoScale=function(e){var t=this._chart.model().paneForSource(e).actionNoScaleIsEnabled(e),t=new Action({checkable:!0,text:$.t("Screen (No Scale)"),enabled:t});return t.setCallbackContext(e),t.setChecked(this._state.isOverlay(e)),t.callbacks().subscribe(this,A53.prototype.onNoScale),t},A53.prototype.createActionShowCountdown=function(e){e=new Action({checkable:!0,text:"Show Countdown",enabled:!0});var t=this._chart.model().mainSeries().properties();return e._binding=new D14(e,t.showCountdown,this._chart.model(),e.text),e._binding.setValue(t.showCountdown.value()),e},A53.prototype.createActionLockScale=function(e){if(!(e instanceof TradingView.Series))return null;var t=new Action({checkable:e.properties().lockScale.value(),text:$.t("Lock Scale"),enabled:!0});return t._binding=new D14(t,e.properties().lockScale,this._chart.model(),t.text,function(t){this._undoModel.setLockScaleProperty(this._property,t.checked,e,this._undoText)}),t},A53.prototype.createActionMergeUp=function(e){if(this._chart.model().paneForSource(e)===this._chart.model().panes().item(0))return null;var t=new Action({checkable:!1,text:$.t("Merge Up"),enabled:!0});return t.setCallbackContext(e),t.callbacks().subscribe(this,A53.prototype.onMergeUp),t},A53.prototype.onMergeUp=function(e){e=e.callbackContext();var t=this._chart.model().paneForSource(e),t=this._chart.model().panes().indexOf(t),t=this._chart.model().panes().item(t-1),i=t.findSuitableScale(e);this._chart.model().move(e,t,i)},A53.prototype.createActionUnmergeUp=function(e){if(!(1<this._chart.model().paneForSource(e).D19().count(function(e){return isInherited(e.constructor,PriceDataSource)&&e.showInObjectTree()})))return null;var t=new Action({checkable:!1,text:$.t("Unmerge Up"),enabled:!0});return t.setCallbackContext(e),t.callbacks().subscribe(this,A53.prototype.onUnmergeUp),t},A53.prototype.onUnmergeUp=function(e){e=e.callbackContext();var t=this._chart.model().paneForSource(e),t=this._chart.model().panes().indexOf(t),t=this._chart.model().createPane(t),i=t.findSuitableScale(e);this._chart.model().move(e,t,i)},A53.prototype.createActionMergeDown=function(e){var t=this._chart.model().paneForSource(e),i=this._chart.model().panes();return t===i.item(i.size()-1)?null:(t=new Action({checkable:!1,text:$.t("Merge Down"),enabled:!0}),t.setCallbackContext(e),t.callbacks().subscribe(this,A53.prototype.onMergeDown),t)},A53.prototype.onMergeDown=function(e){e=e.callbackContext();var t=this._chart.model().paneForSource(e),t=this._chart.model().panes().indexOf(t),t=this._chart.model().panes().item(t+1),i=t.findSuitableScale(e);this._chart.model().move(e,t,i)},A53.prototype.createActionUnmergeDown=function(e){if(!(1<this._chart.model().paneForSource(e).D19().count(function(e){return isInherited(e.constructor,PriceDataSource)&&e.showInObjectTree()})))return null;var t=new Action({checkable:!1,text:$.t("Unmerge Down"),enabled:!0});return t.setCallbackContext(e),t.callbacks().subscribe(this,A53.prototype.onUnmergeDown),t},A53.prototype.onUnmergeDown=function(e){e=e.callbackContext();var t=this._chart.model().paneForSource(e),t=this._chart.model().panes().indexOf(t),t=this._chart.model().createPane(t+1),i=t.findSuitableScale(e);this._chart.model().move(e,t,i)},A53.prototype._mergeContentMenuItems=function(e){var t=[],i=this.createActionMergeUp(e);return i&&t.push(i),(i=this.createActionUnmergeUp(e))&&t.push(i),(i=this.createActionMergeDown(e))&&t.push(i),(i=this.createActionUnmergeDown(e))&&t.push(i),t},A53.prototype.createActionShow=function(e){var t=new Action({checkable:!0,text:$.t("Show"),enabled:!0});return t._binding=new D14(t,e.properties().visible,this._chart.model(),t.text),t._binding.setValue(e.properties().visible.value()),t},A53.prototype.bringObjectForward=function(e){(e=this._chart.model().selectedSource())&&this._chart.model().changeZOrder(e,1)},A53.prototype.sendObjectToBack=function(e){(e=this._chart.model().selectedSource())&&this._chart.model().sendToBack(e);
},A53.prototype.bringObjectToFront=function(e){(e=this._chart.model().selectedSource())&&this._chart.model().bringToFront(e)},A53.prototype.sendObjectBackward=function(e){(e=this._chart.model().selectedSource())&&this._chart.model().changeZOrder(e,-1)},A53.prototype.createVisualOrderAction=function(e){var t=new Action({text:$.t("Visual Order")});t.subActions||(t.subActions=[]);var i=new Action({text:$.t("Bring to Front")});i.callbacks().subscribe(this,A53.prototype.bringObjectToFront),t.subActions.push(i);var n=new Action({text:$.t("Send to Back")});n.callbacks().subscribe(this,A53.prototype.sendObjectToBack),t.subActions.push(n);var o=new Action({text:$.t("Bring Forward")});o.callbacks().subscribe(this,A53.prototype.bringObjectForward),t.subActions.push(o);var r=new Action({text:$.t("Send Backward")});r.callbacks().subscribe(this,A53.prototype.sendObjectBackward),t.subActions.push(r);var s=this._chart.model().paneForSource(e).getZOrderMinMax();return n.setEnabled(!0),o.setEnabled(!0),r.setEnabled(!0),i.setEnabled(!0),e.zorder()===s.minZOrder&&(n.setEnabled(!1),r.setEnabled(!1)),e.zorder()===s.maxZOrder&&(o.setEnabled(!1),i.setEnabled(!1)),t},A53.prototype._createActionAddAlert=function(e){function t(e){void 0===e||null===e||isNaN(e)||(o+=" ("+e+") ",n.value=e)}var i=this._chart,n={},o="Add Alert",r=this._state;if(e.series){var s,a;e.series instanceof TradingView.Series?a=e.series.lastValueData(null,!0,!0):e.series instanceof TradingView.Study&&(r=e.series.metaInfo().plots[0].id,a=e.series.lastValueData(r,!0,!0)),a&&(s=a.price),s&&(r=(e.series.priceScale()||this._state.mainDataSource().priceScale()||i.model().mainSeries().priceScale()).formatter(),r.formatAsDecimal&&(s=r.formatAsDecimal(s)),t(s)),n.series=e.series}else e.e?(s=r.defaultPriceScale(),e=s.coordinateToPrice(e.e.localY),s.isPercentage()&&(a=this._state.mainDataSource().firstValue(),e="undefined"!=typeof a?s.priceRange().convertFromPercent(e,a):null),t(this._state.mainDataSource().formatter().formatAsDecimal(e)),e=r.mainDataSource(),n.series=e):e.drawing&&(o+=" on "+e.drawing.title(),n={drawing:e.drawing});return o+="...",e=new Action({text:o}),e.callbacks().subscribe(null,function(){runOrSignIn(function(){new TradingView.MakeAlertDialog(i,n)})}),e},A53.prototype.image=function(){var e={};return e.leftAxis=this.leftPriceAxisWidget().image(),e.rightAxis=this.rightPriceAxisWidget().image(),e.content=this.canvas.toDataURL(),e.contentWidth=this.size.w,e.contentHeight=this.size.h,e},A53.prototype._updateTooltip=function(e,t){if(!this._rafSet){var i=this;requestAnimationFrame(function(){i._updateTooltipImpl(e,t),i._rafSet=!1}),this._rafSet=!0}},A53.prototype._updateTooltipImpl=function(e,t){function i(i){TradingView[r].getTooltipText&&(i=TradingView[r].getTooltipText(s)||i),n._tooltipSelector.html(i).removeClass("tooltip-selector-hidden").css(TradingView.isMobile.any()?{left:e-n._tooltipSelector.outerWidth()-16,top:t-n._tooltipSelector.outerHeight()-16}:{left:e+16,top:t+16})}if(this._chart){for(var n=this,o=this._chart._paneWidgets,r=TradingView.drawingState.tool.value(),s=this._state.model().lineBeingCreated(),a=o.length-1;a>=0;a--)o[a]._hideTooltip();TradingView.Study.isStudyLineTool(r)&&!TradingView.isMobile.any()?i($.t("Click to set a point")):TradingView.isMobile.any()&&"LineToolBrush"!=r&&n.isLineTool(r)&&!n._chart.model().lineBeingCreated()?i($.t("1. Slide your finger to select location for first anchor<br>2. Tap anywhere to place the first anchor")):TradingView.isMobile.any()&&"LineToolBrush"!=r&&n.isLineTool(r)&&i($.t("1. Slide your finger to select location for next anchor<br>2. Tap anywhere to place the next anchor"))}},A53.prototype._hideTooltip=function(){this._tooltipSelector.addClass("tooltip-selector-hidden")},$.extend(EditObjectDialog,{TAB_PRIORITY_COORDINATES:100,TAB_PRIORITY_DISPLAY:100,TAB_PRIORITY_STYLE:200,TAB_PRIORITY_INPUTS:300,TAB_NAME_COORDINATES:"Coordinates",TAB_NAME_DISPLAY:"Properties",TAB_NAME_STYLE:"Style",TAB_NAME_INPUTS:"Inputs",TAB_NAME_GRAPHICS:"Graphics",TAB_OPEN_DEFAULT:100,TAB_OPEN_USERSAVE:200,TAB_OPEN_OVERRIDE:300}),EditObjectDialog.prototype.hide=function(e){A83.destroy(this._dialogTitle,{undoChanges:!!e})},EditObjectDialog.prototype._onDestroy=function(e,t){var i=(t||{}).undoChanges;$(window).unbind("keyup.hidePropertyDialog"),i?(i=this._undoCheckpoint?this._undoCheckpoint:this._undoCheckpointOnShow)&&this.D0.undoToCheckpoint(i):this.W99.hasAlert.value()&&this.W99.needSynchronizeAlertWithServer&&this.W99.synchronizeAlert(!0),this._undoCheckpointOnShow&&delete this._undoCheckpointOnShow,window.lineToolPropertiesToolbar&&lineToolPropertiesToolbar.refresh()},EditObjectDialog.prototype.isVisible=function(){return this._dialog&&this._dialog.is(":visible")},EditObjectDialog.prototype.focusOnText=function(){this._dialog.find('input[type="text"]').focus().select()},EditObjectDialog.prototype.switchTab=function(e,t){if(this._tabs){var i=null;if(e?e=e.valueOf():null===e&&(e=void 0),"string"==typeof e&&$.each(this._tabs,function(t,n){return n.name==e?(i=n,!1):void 0}),"object"==typeof e&&$.each(this._tabs,function(t,n){return e==n||$(n.labelObject).is(e)||$(n.wrapperObject).is(e)?(i=n,!1):void 0}),i||(i=this._tabs[~~e]),!i)return!1;if($.each(this._tabs,function(e,t){var n=t==i;$(t.wrapperObject)[n?"show":"hide"](),$(t.labelObject)[n?"addClass":"removeClass"]("active")}),t){var n=this.activeTabSettingsName();n&&TVSettings.setValue(n,i.name)}return!0}},EditObjectDialog.prototype.appendToTab=function(e,t,i,n,o,r){if(!$(e).is("table")||$(e).find("tr").size()){var s;this._tabs||(this._tabs=[]),$.each(this._tabs,function(e,i){return i.name==t?(s=e,!1):void 0}),void 0===s&&(this._tabs.push({name:t,localizedName:$.t(t),objects:$(),displayPriority:0,defaultOpen:0,isButton:!!o,callback:o?r||function(){}:null}),s=this._tabs.length-1),o=this._tabs[s],o.objects=o.objects.add(e),o.displayPriority=Math.max(o.displayPriority||0,i||0),o.defaultOpen=Math.max(o.defaultOpen||0,n||0)}},EditObjectDialog.prototype.insertTabs=function(){function e(e){o&&o===e.name&&(e.defaultOpen=Math.max(~~e.defaultOpen,EditObjectDialog.TAB_OPEN_USERSAVE)),(!i||~~i.defaultOpen<~~e.defaultOpen)&&(i=e),e.labelObject=$('<a href="#" class="properties-tabs-label"></a>').text(e.localizedName).appendTo(t._tabContainer),e.labelObject.bind("click",function(e){e.preventDefault(),t.switchTab(this,!0)});var n=$('<div class="main-properties"></div>');e.wrapperObject=$().add(n),e.objects.each(function(t,i){var o=$(i);o.is("table")?(o.data("layout-separated")&&(e.wrapperObject=e.wrapperObject.add('<div class="properties-separator"></div>').add(n=$('<div class="main-properties"></div>')),o.removeData("layout-separated")),n.append(o),o.children("tbody").each(function(t,o){if(0!==t&&$(o).data("layout-separated")){e.wrapperObject=e.wrapperObject.add('<div class="properties-separator"></div>').add(n=$('<div class="main-properties"></div>'));var r=$(i).clone(!0,!1).appendTo(n);r.children().remove(),r.append(o),$(o).removeData("layout-separated")}})):n.append(o)}),e.wrapperObject.appendTo(t._container)}if(this._tabs){this._tabs.sort(function(e,t){return(t.displayPriority||0)-(e.displayPriority||0)});var t=this,i=null,n=this.activeTabSettingsName();if(n)var o=TVSettings.getValue(n);$.each(this._tabs,function(i,n){n.isButton?(n.labelObject=$('<a href="#" class="properties-tabs-label"></a>').text(n.localizedName).appendTo(t._tabContainer),n.labelObject.bind("click",n.callback)):e(n)}),this.switchTab(i)}},EditObjectDialog.prototype.activeTabSettingsName=function(){var e=this.W99;if(e){if(e instanceof TradingView.Series||e instanceof A7)return"properties_dialog.active_tab.chart";if(e instanceof W47)return"properties_dialog.active_tab.drawing";if(e instanceof TradingView.Study)return"properties_dialog.active_tab.study"}},EditObjectDialog.prototype.show=function(e){function t(){r.hide(!0)}e=e||{},isInherited(this.W99.constructor,A7)&&TradingView.trackEvent("GUI","Chart Properties"),isInherited(this.W99.constructor,TradingView.Study)&&TradingView.trackEvent("GUI","Study Properties"),isInherited(this.W99.constructor,DataSource)&&this.D0.setSelectedSource(this.W99);var i=PropertyPagesFactory.createInputsPropertyPage(this.W99,this.D0),n=PropertyPagesFactory.createStylesPropertyPage(this.W99,this.D0),o=PropertyPagesFactory.createDisplayPropertyPage(this.W99,this.D0);if(i||n){var r=this,s=null!==i,a=this.W99.title(),l=A83.createDialog(a,{hideTitle:!0,dragHandle:".properties-tabs"}),d=l.find(".tv-dialog-content"),h=$('<div class="properties-tabs"></div>').appendTo(d);if(this._tabs=[],this._dialog=l,this._dialogTitle=a,this._dialog=l,this._container=d,this._tabContainer=h,this._undoCheckpointOnShow=this.D0.createUndoCheckpoint(),l.on("destroy",function(e,t){r._onDestroy(e,t),i&&i.destroy(),n&&n.destroy(),o&&o.destroy()}),e.selectScales&&n.setScalesOpenTab&&n.setScalesOpenTab(),e.selectTmz&&n.setTmzOpenTab&&n.setTmzOpenTab(),this.D0.readOnly()||!s||i.widget().is(":empty")||i.widget().each(function(e,t){var n=i instanceof $14,o=+$(t).data("layout-tab-priority");isNaN(o)&&(o=n?EditObjectDialog.TAB_PRIORITY_COORDINATES:EditObjectDialog.TAB_PRIORITY_INPUTS);var s=~~$(t).data("layout-tab-open"),a=$(t).data("layout-tab");void 0===a&&(a=n?EditObjectDialog.TAB_NAME_COORDINATES:EditObjectDialog.TAB_NAME_INPUTS),r.appendToTab(t,a,o,s)}),n&&n.widget().each(function(e,t){var i=+$(t).data("layout-tab-priority");isNaN(i)&&(i=EditObjectDialog.TAB_PRIORITY_STYLE);var o=~~$(t).data("layout-tab-open");!o&&n instanceof $49&&(o=EditObjectDialog.TAB_OPEN_DEFAULT);var s=$(t).data("layout-tab");void 0===s&&(s=EditObjectDialog.TAB_NAME_STYLE),r.appendToTab(t,s,i,o)}),o&&o.widget().each(function(e,t){var i=+$(t).data("layout-tab-priority");isNaN(i)&&(i=EditObjectDialog.TAB_PRIORITY_DISPLAY);var n=~~$(t).data("layout-tab-open"),o=$(t).data("layout-tab");void 0===o&&(o=EditObjectDialog.TAB_NAME_DISPLAY),r.appendToTab(t,o,i,n)}),this.W99 instanceof TradingView.Study&&this.W99.metaInfo().isTVScript&&this.W99.metaInfo().TVScriptSourceCode&&!TradingView.isMobileView&&r.appendToTab(null,"Source Code",null,null,!0,function(){this.hide();var e=this.W99.metaInfo();window.scriptEditor.show({scriptSource:e.TVScriptSourceCode,scriptIdPart:e.scriptIdPart})}.bind(this)),TradingView.D18("alerts")&&TradingView.D18("drawing_alerts")&&this.W99.canHasAlert()&&!TradingView.isMobileView){var c=function(e){return e&&e.D0&&e.D0._undoModel&&e.D0._undoModel.D4||null};r.appendToTab(null,"Alert",null,null,!0,function(){runOrSignIn(function(){r.hide(),r.W99.hasAlert.value()?r.W99.getAlert(function(e){editAlert(e,c(r.W99))}):new TradingView.MakeAlertDialog(c(r.W99),{drawing:r.W99})})})}if(this.insertTabs(),this._helpItemRequired()&&this._createHelp(),e=$('<div class="main-properties main-properties-aftertabs"></div>').appendTo(d),e=$('<div class="dialog-buttons">').appendTo(e),s=function(){var e=[];if(n&&"function"==typeof n.defaultProperties&&(e=e.concat(n.defaultProperties())),i&&"function"==typeof i.defaultProperties&&(e=e.concat(i.defaultProperties())),0===e.length&&r.W99.properties?e=[r.W99.properties()]:r.W99._sessionsStudy&&(e=e.concat(r.W99._sessionsStudy.properties())),e.length){var t=function(e){e._childs&&e._childs.length&&$.each(e._childs,function(i,n){"percentage"==n?e.percentage.listeners().fire(e.percentage):t(e[n])})};$.each(e,function(e,i){r.D0.restoreFactoryDefaults(i),t(i)}),r.W99.properties().minTick&&r.W99.properties().minTick.listeners().fire(r.W99.properties().minTick),r.W99.properties().precision&&r.W99.properties().precision.listeners().fire(r.W99.properties().precision),i&&i.loadData(),n.onResoreDefaults&&n.onResoreDefaults(),n&&n.loadData()}},n&&"function"==typeof n.createTemplateButton&&!W77.enabled("charting_library"))n.createTemplateButton({defaultsCallback:s}).addClass("tv-left").appendTo(e);else if(isInherited(this.W99.constructor,TradingView.Study)){var p=[{title:$.t("Reset Settings"),action:s},{title:$.t("Save As Default"),action:function(){r.W99.properties().saveDefaults()}}],s=$('<a href="#" class="tv-button tv-left">'+$.t("Defaults")+'<span class="icon-dropdown"></span></a>');s.on("click",function(e){e.preventDefault(),e=$(this),e.is(".active")||e.trigger("button-popup",[p,!0])}).appendTo(e),TradingView.bindPopupMenu(s,null,{direction:"down",event:"button-popup",notCloseOnButtons:!0})}else $('<a class="tv-button tv-left">'+$.t("Defaults")+"</a>").appendTo(e).click(s);return $('<a class="tv-button ok">'+$.t("OK")+"</a>").appendTo(e).click(function(){r.hide()}),$('<a class="tv-button cancel">'+$.t("Cancel")+"</a>").appendTo(e).on("click",t),l.find(".tv-dialog-title a").on("click",t),$(window).bind("keyup.hidePropertyDialog",function(e){"13"==e.keyCode&&"textarea"!==e.target.tagName.toLowerCase()&&r.hide()}),$("select",d).each(function(){var e=$(this),t="tv-select-container dialog";e.hasClass("tv-select-container-fontsize")&&(t+=" tv-select-container-fontsize"),e.selectbox({speed:100,classHolder:t})}),$('input[type="text"]',d).addClass("tv-text-input inset dialog"),$("input.ticker",d).TVTicker(),l.css("min-width","400px"),A83.applyHandlers(l),d={top:($(window).height()-l.height())/2,left:($(window).width()-l.width())/2},n&&"function"==typeof n.dialogPosition&&(d=n.dialogPosition(d,l)||d),A83.positionDialog(l,d),window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.hide(),l}},EditObjectDialog.prototype._helpItemRequired=function(){return this.W99._metaInfo&&!!this.W99._metaInfo.helpURL},EditObjectDialog.prototype._createHelp=function(){var e=$('<a class="help" href="#" target="_blank" title="'+$.t("Help")+'"></a>');e.attr("href",this.W99._metaInfo.helpURL),this._tabContainer.prepend(e)},ObjectTreeDialog.prototype.getSourceProperties=function(){for(var e={groups:[],model:this.D0,drawings:[]},t=0;t<this.D0.panes().size();t++){for(var i=this.D0.panes().item(t),n=[],o=i.orderedSources(),r=0;r<o.length;r++){var s=o[r];s.showInObjectTree()&&n.push({datasource:s,name:s.title()})}for(i=i.D19(),r=0;r<i.size();r++)s=i.item(r),s instanceof W47&&s.showInObjectTree()&&e.drawings.push({datasource:s,name:s.title(),symbol:A68.shortName(s.symbol())});n.length&&e.groups.push({children:n})}return e},ObjectTreeDialog.prototype.calcHeight=function(e,t){for(var i=0,n=0;n<e.length;n++){if(e[n]>t){i=0===n?e[0]:e[n-1];break}i=e[n]}return i<this.options.minHeight&&(i=this.options.minHeight),i},ObjectTreeDialog.prototype.tabChanged=function(e){0===e?this.objectsTreeTab.tabChanged():this.manageDrawingsTab.tabChanged()},ObjectTreeDialog.prototype.onDestroy=function(){this.objectsTreeTab.unsubscribeListeners(),this.manageDrawingsTab&&this.manageDrawingsTab.unsubscribeListeners()},ObjectTreeDialog.prototype.show=function(){this.title=$.t("Objects Tree"),TradingView.trackEvent("GUI","Objects Tree");var e=window.user&&!0===user.is_staff&&!0!==user.is_moderator,t={};e&&$.extend(t,{hideTitle:!0,dragHandle:".properties-tabs"});var i=A83.createDialog(this.title,t),n=i.find(".tv-dialog-content"),t=i.find(".tv-dialog-title");if(e){var o=$('<div class="properties-tabs"></div>').appendTo(n),r=$('<a href="#" class="properties-tabs-label with-filter"></a>').text($.t("Objects Tree")).appendTo(o);$('<a href="#" class="properties-tabs-label"></a>').text($.t("Manage Drawings")).appendTo(o)}n=$("<div>").appendTo(n),e&&n.addClass("with-drawings");var s=$(window).height(),s=s>this.options.maxHeight?this.options.maxHeight:s;e&&(s-=o.height());var s=s-this.options.padding,a=$('<div class="main-tree-page active">').appendTo(n);if(e){a.addClass("no-top-border");var l=$('<div class="main-tree-page active">').appendTo(n)}this.objectsTreeTab=new ObjectsTreeTab(this,this.options,this.D0),e&&(this.manageDrawingsTab=new ManageDrawingsTab(this,this.options,this.D0)),this.objectsTreeTab.createView(a,e?r:t,s),e&&this.manageDrawingsTab.createView(l,s),e&&(this.tabs=new A71(o,n,{saveTab:"ObjectsTreeDialog.tab"})),e&&this.tabs.tabChanged.subscribe(this,this.tabChanged),A83.applyHandlers(i),A83.positionDialog(i);var d=this;i.on("destroy",this.onDestroy.bind(this)),setTimeout(function(){i.unbind("mousedownoutside"),i.on("mousedownoutside",function(e){$(e.target).parents().andSelf().is(".tv-dialog, .properties-toolbar, .colorpicker, .charts-popup-list, .tv-dialog, .tvcolorpicker-popup, .symbol-edit-popup, .context-menu")||(A83.destroy(d.title),i.unbind("mousedownoutside"))})})},ObjectTreeDialog._getBackgroundByTile=function(e){return e=A6.prototype.Button.iconIndices[e],void 0!==e?[1,32*e+1]:null},ObjectTreeDialog._getBackgroundPosition=function(e){return"-"+e[0]+"px -"+e[1]+"px"},ObjectTreeDialog.List=function(e,t,i,n){this.model=e,this.datasources={},this.contentHeights=[],this.content=t,this.dialog=i,this.options=n},ObjectTreeDialog.List.prototype.setDefaultItemClass=function(e){this.defaultItemClass=e},ObjectTreeDialog.List.prototype.setActiveListener=function(e){this.activeListener=e},ObjectTreeDialog.List.prototype.setActive=function(e){this.content.find(".tv-dialog-tree-item").removeClass("active"),e.addClass("active"),this.activeListener&&this.activeListener(e),e=this.datasources[e.attr("id")],this.model.setSelectedSource(e.datasource),this.model.D20(new A22(A22.LIGHT_UPDATE))},ObjectTreeDialog.List.prototype.createItem=function(e,t,i){var n=this,o=$('<a class="tv-dialog-tree-item"></a>').appendTo(t);t=$('<span class="tree-icon-container">').appendTo(o),e.skipped&&o.addClass("skipped"),o.attr("id",e.datasource.id()),this.defaultItemClass&&o.addClass(this.defaultItemClass),this.datasources[e.datasource.id()]=e,this.contentHeights.push(this.content.height());var r=$('<div class="name-column"></div>').appendTo(o);if($('<span class="name">'+$.t(e.name)+"</span>").appendTo(r),this.setIcon(o,e),this.setVisible(o,e),o.mousedown(function(e){n.setActive(o)}),e.datasource.userEditEnabled()){if(isInherited(e.datasource.constructor,W47)){var s=$('<a class="button icon-lock" title="'+$.t("Lock/Unlock")+'">');s.click(function(t){t=e.datasource.properties().frozen.value(),n.model.setProperty(e.datasource.properties().frozen,!t,"Lock/Unlock "+e.datasource.title())}),s.appendTo(t),$('<span class="icon">').appendTo(s),e.datasource.properties().frozen.value()&&(o.addClass("locked"),s.addClass("active")),e.datasource.properties().frozen.subscribe(this,function(e){e=e.value(),o.toggleClass("locked",e),s.toggleClass("active",e)})}else i&&$('<div class="button hidden">&nbsp;</div>').appendTo(t);var a=$('<a class="button icon-hide" title="'+$.t("Show/Hide")+'">');a.click(function(t){t=e.datasource.properties().visible.value(),o.toggleClass("hidden",t),a.toggleClass("active",t),n.model.setProperty(e.datasource.properties().visible,!t,"Show/Hide "+e.datasource.title())}),a.appendTo(t),$('<span class="icon">').appendTo(a),e.datasource.properties().visible.value()||(o.addClass("hidden"),a.addClass("active")),e.datasource.properties().visible.subscribe(this,function(e){e=e.value(),o.toggleClass("hidden",!e),a.toggleClass("active",!e)}),this.createPropertyIcon(e,t,o)}return o},ObjectTreeDialog.List.prototype.contextMenuEvent=function(e,t){this.options.D3.paneByState(this.model.paneForSource(t)).showContextMenuForSource(t,e)},ObjectTreeDialog.List.prototype.createPropertyIcon=function(e,t,i){var n=this;e.datasource instanceof W47&&!e.datasource.isActualSymbol()?$('<div class="button hidden">&nbsp;</div>').appendTo(t):e.datasource===this.model.mainSeries()&&this.options.D3&&this.options.D3.onWidget()?$('<div class="button hidden">&nbsp;</div>').appendTo(t):(PropertyPagesFactory.hasStylesPropertyPage(e.datasource)||PropertyPagesFactory.hasInputsPropertyPage(e.datasource))&&(t=$('<a class="button format" title="'+$.t("Format")+'">').click(function(t){new EditObjectDialog(e.datasource,n.model).show()}).appendTo(t),$('<span class="icon">').appendTo(t),i.dblclick(function(t){new EditObjectDialog(e.datasource,n.model).show()}),i.on("contextmenu",function(t){n.contextMenuEvent(t,e.datasource),t.preventDefault(),t.stopPropagation()}))},ObjectTreeDialog.List.prototype.updateItem=function(e){var t=this.content.find("#"+e.datasource.id());t.find(".name").text($.t(e.name)),this.setIcon(t,e),this.setVisible(t,e)},ObjectTreeDialog.List.prototype.findItem=function(e){return this.content.find("#"+e.id())},ObjectTreeDialog.List.prototype.removeItem=function(e){this.findItem(e).remove()},ObjectTreeDialog.List.prototype.setIcon=function(e,t){var i=e.find(".name-column");if(i.find(".instrument").remove(),t.datasource.getType){var n=ObjectTreeDialog._getBackgroundByTile(t.datasource.getType());if(n){var o=$('<span class="instrument linetool">').appendTo(i);o.css("background-position",ObjectTreeDialog._getBackgroundPosition(n))}}t.datasource instanceof TradingView.LineToolIcon&&(o=t.datasource.properties().icon.value(),o=String.fromCharCode(o),$('<span class="instrument lineicon">'+o+"</span>").appendTo(i)),t.datasource===this.model.mainSeries()&&(o=$('<span class="instrument series">').appendTo(i),i=this.model.mainSeries().properties().style.value(),n=A4.styleIconPosition(i),o.css("background-position",n))},ObjectTreeDialog.List.prototype.setVisible=function(e,t){t.datasource.properties().visible.value()?e.removeClass("hidden"):e.addClass("hidden")},ManageDrawingsTab.prototype.toolCompare=function(e,t){var i=$(e).find(".name").text(),n=$(t).find(".name").text();return i.localeCompare(n)},ManageDrawingsTab.prototype.symbolCompare=function(e,t){var i=$(e).find(".symbol").text(),n=$(t).find(".symbol").text();return i.localeCompare(n)},ManageDrawingsTab.prototype.activeListener=function(e){this.selectedId=e.attr("id")},ManageDrawingsTab.prototype.addItemControls=function(e,t){var i=this,n=t.find(".tree-icon-container");$('<span class="symbol">'+e.symbol+"</span>").appendTo(t),e.datasource.userEditEnabled()&&(n=$('<a class="button delete" title="'+$.t("Delete")+'">').click(function(n){n.stopPropagation(),n=i.itemList.find(".tv-dialog-tree-item");var o=n.index(t),r=n.length;r>0&&(o!==r-1?i.selectedId=$(n[o+1]).attr("id"):0!==o&&(i.selectedId=$(n[o-1]).attr("id"))),i.items.model.removeSource(e.datasource)}).appendTo(n),$('<span class="icon">').appendTo(n))},ManageDrawingsTab.prototype.setActiveHeader=function(e){this.itemHeader.find(".item .label").removeClass("active"),$.each(this.itemHeader.find(".item .label"),function(){$(this).data("sort")===e&&$(this).addClass("active")})},ManageDrawingsTab.prototype.sortList=function(){var e,t=TVSettings.getValue("manageDrawingsDialog.sort.field")||"symbol",i=TVSettings.getBool("manageDrawingsDialog.sort.asc")||!1;e="tool"===t?this.toolSort:this.symbolSort,e.setIsAscending(i),this.itemList.find(".tv-dialog-tree-item").sort(e.getPredicate()).appendTo(this.itemList),this.setActiveHeader(t)},ManageDrawingsTab.prototype.sortClick=function(e){e=$(e.target).data("sort");var t;t="tool"===e?this.toolSort:this.symbolSort,t.inverse(),TVSettings.setValue("manageDrawingsDialog.sort.field",e),TVSettings.setValue("manageDrawingsDialog.sort.asc",t.isAscending),this.sortList()},ManageDrawingsTab.prototype.createView=function(e,t){this.items=this.dialog.getSourceProperties(),this.maxHeight=t;var i=$("<div>").appendTo(e);this.itemHeader=$('<div class="tv-dialog-tree-item-list-header">').appendTo(i),this.contentContainer=$('<div class="main-tree-container">').appendTo(i),this.noDrawings=$('<div class="no-drawings">'+$.t("No drawings yet")+"</div>").appendTo(i),this.contentWrap=$('<div class="main-tree-wrap"></div>').appendTo(this.contentContainer),this.content=$('<div class="main-tree"></div>').appendTo(this.contentWrap);var i=$('<div class="item tool">').appendTo(this.itemHeader),n=$('<div class="item symbol">').appendTo(this.itemHeader);this.itemList=$('<div class="tv-dialog-tree-item-list">').appendTo(this.content),this.symbolSort=new LoadChartDialog.SortObject(this.symbolCompare),this.toolSort=new LoadChartDialog.SortObject(this.toolCompare),this.list=new ObjectTreeDialog.List(this.items.model,this.content,this.dialog,this.options),this.list.setActiveListener(this.activeListener.bind(this)),this.items.model.selectedSource()&&(this.selectedId=this.items.model.selectedSource().id()),$('<span class="label">'+$.t("TOOL")+"</span>").data("sort","tool").appendTo(i).click($.proxy(this,"sortClick")),$('<span class="label">'+$.t("SYMBOL")+"</span>").data("sort","symbol").appendTo(n).click($.proxy(this,"sortClick")),this.fillList(),i=this.dialog.calcHeight(this.list.contentHeights,this.maxHeight-this.itemHeader.height()),this.contentContainer.height(i),this.noDrawings.height(i),this.addScroll();var o=this;return this.updateListListener=function(){o.updateList()},this.fillListListener=function(){o.fillList()},this.removeSourceListener=function(e){o.list.removeItem(e),o.updateList()},this.model.on("setProperty",this.updateListListener),this.model.on("removeSource",this.removeSourceListener),this.model.on("cloneLineTool",this.fillListListener),this.contentContainer},ManageDrawingsTab.prototype.unsubscribeListeners=function(){this.model.removeListener("setProperty",this.updateListListener),this.model.removeListener("removeSource",this.removeSourceListener),this.model.removeListener("cloneLineTool",this.fillListListener)},ManageDrawingsTab.prototype.updateList=function(){for(var e=this.dialog.getSourceProperties(),t=0;t<e.drawings.length;t++)this.list.updateItem(e.drawings[t])},ManageDrawingsTab.prototype.updateList=function(){0===this.itemList.children().length?(this.noDrawings.show(),this.contentContainer.hide(),this.itemHeader.hide()):(this.noDrawings.hide(),this.contentContainer.show(),this.itemHeader.show())},ManageDrawingsTab.prototype.fillList=function(){this.itemList.empty();for(var e=this.dialog.getSourceProperties(),t=0;t<e.drawings.length;t++){var i=e.drawings[t],n=this.list.createItem(i,this.itemList);n.unbind("contextmenu"),n.unbind("dblclick"),i.datasource.id()===this.selectedId&&this.list.setActive(n),this.addItemControls(i,n)}this.sortList(),this.updateList()},ManageDrawingsTab.prototype.addScroll=function(){this._scroll=new A59(this.contentContainer,this.contentWrap,{showBottomShadow:!1})},ManageDrawingsTab.prototype.tabChanged=function(){},ObjectsTreeTab.prototype.activeListener=function(e){this.selectedId=e.attr("id")},ObjectsTreeTab.prototype.changeZOrder=function(e){this.model.removeListener("changeZOrder",this.changeZorderListener),e(),this.model.on("changeZOrder",this.changeZorderListener)},ObjectsTreeTab.prototype.addSortable=function(e){var t=0,i=this;e.sortable({scroll:!0,scrollSensitivity:100,scrollSpeed:100,axis:"y",helper:"clone",start:function(e,i){t=i.item.index()},stop:function(e,n){var o=n.item.index();if(0!==t-o){var r=i.list.datasources[n.item.attr("id")],s=t-o>0?1:-1;i.changeZOrder(function(){i.items.model.beginUndoMacro("Change "+r.datasource.title()+" Z order");for(var e=0;e<Math.abs(t-o);e++)i.items.model.changeZOrder(r.datasource,s);i.items.model.endUndoMacro()})}i.setFirstLastItems(n.item.parent())}})},ObjectsTreeTab.prototype.addItemControls=function(e,t,i,n,o){var r=this;i=t.find(".tree-icon-container"),n=$('<div class="button up" title="'+$.t("Move Up")+'">').click(function(i){if(i.stopPropagation(),i.preventDefault(),i=t.prev(":visible"),i.length){var n=t.prev(":hidden").length;t.insertBefore(i.last()),r.changeZOrder(function(){for(var t=0;1+n>t;t++)r.items.model.changeZOrder(e.datasource,1)}),r.setFirstLastItems(t.parent()),r._scroll.scrollTo(t)}}).prependTo(i),$('<span class="icon">').appendTo(n),n=$('<a class="button down" title="'+$.t("Move Down")+'">').click(function(i){if(i.stopPropagation(),i.preventDefault(),i=t.next(":visible"),i.length){var n=t.next(":hidden").length;t.insertAfter(i.first()),r.changeZOrder(function(){for(var t=0;1+n>t;t++)r.items.model.changeZOrder(e.datasource,-1)}),r.setFirstLastItems(t.parent()),r._scroll.scrollTo(t)}}).prependTo(i),$('<span class="icon">').appendTo(n),e.datasource!==r.items.model.mainSeries()&&e.datasource.isUserDeletable()?(i=$('<a class="button delete" title="'+$.t("Delete")+'">').click(function(i){i.stopPropagation(),i=r.content.find(".tv-dialog-tree-item");var n=i.index(t),o=i.length;o>0&&(n!==o-1?r.selectedId=$(i[n+1]).attr("id"):0!==n&&(r.selectedId=$(i[n-1]).attr("id"))),r.items.model.removeSource(e.datasource)}).appendTo(i),$('<span class="icon">').appendTo(i)):$('<div class="button hidden">&nbsp;</div>').appendTo(i)},ObjectsTreeTab.prototype.createView=function(e,t,i){return this.items=this.dialog.getSourceProperties(),this.maxHeight=i,this.contentContainer=$('<div class="main-tree-container">').appendTo(e),this.contentWrap=$('<div class="main-tree-wrap"></div>').appendTo(this.contentContainer),this.content=$('<div class="main-tree"></div>').appendTo(this.contentWrap),this.list=new ObjectTreeDialog.List(this.items.model,this.content,this.dialog,this.options),this.list.setDefaultItemClass("objects"),this.list.setActiveListener(this.activeListener.bind(this)),this.items.model.selectedSource()&&(this.selectedId=this.items.model.selectedSource().id()),this.updateListListener=this.updateList.bind(this),this.fillListListener=this.fillList.bind(this),this.changeZorderListener=function(e){this.fillList(),this._scroll.scrollTo(this.list.findItem(e))}.bind(this),this.model.on("setProperty",this.updateListListener),this.model.on("removeSource",this.fillListListener),this.model.on("cloneLineTool",this.fillListListener),this.model.on("setChartStyleProperty",this.updateListListener),this.model.on("changeZOrder",this.changeZorderListener),this.model.on("moveSource",this.fillListListener),this.filter=new ObjectsTreeTabFilter(t),this.filter.onChange.subscribe(this,this.fillListListener),this.filter.setValue("all"),e=this.dialog.calcHeight(this.list.contentHeights,this.maxHeight),this.contentContainer.height(e),this.addScroll(),this.contentContainer},ObjectsTreeTab.prototype.unsubscribeListeners=function(){this.model.removeListener("setProperty",this.updateListListener),this.model.removeListener("removeSource",this.fillListListener),this.model.removeListener("cloneLineTool",this.fillListListener),this.model.removeListener("setChartStyleProperty",this.updateListListener),this.model.removeListener("changeZOrder",this.changeZorderListener),this.model.removeListener("moveSource",this.fillListListener)},ObjectsTreeTab.prototype.updateList=function(){this.items=this.dialog.getSourceProperties();for(var e=0;e<this.items.groups.length;e++){var t=this.items.groups[e];if(t.children.length)for(var i=t.children.length-1;i>=0;i--)this.list.updateItem(t.children[i])}},ObjectsTreeTab.prototype.setFirstLastItems=function(e){e=e.find(".tv-dialog-tree-item:visible"),e.length&&(e.removeClass("first last"),e.first().addClass("first"),e.last().addClass("last"))},ObjectsTreeTab.prototype.fillList=function(){this.content.empty(),this.items=this.dialog.getSourceProperties();for(var e="studies"!=this.filter.value()&&this.items.drawings.length,t=0;t<this.items.groups.length;t++){var i=this.filter.applyToGroup(this.items.groups[t]);if(i.children.length){var n=$('<div class="tv-dialog-tree-group">').appendTo(this.content);t>0&&n.append('<div class="tv-dialog-tree-head">');var o=$('<div class="tv-dialog-tree-item-list">').appendTo(n);Modernizr.touch||this.addSortable(o);for(var r=!0,s=i.children.length-1;s>=0;s--){var a=i.children[s],l=this.list.createItem(a,o,e);r&&!a.skipped&&(r=!1),a.datasource.id()===this.selectedId&&this.list.setActive(l),this.addItemControls(a,l,n,s,i)}r&&n.addClass("empty"),this.setFirstLastItems(o)}}},ObjectsTreeTab.prototype.addScroll=function(){this._scroll=new A59(this.contentContainer,this.contentWrap,{showBottomShadow:!1})},ObjectsTreeTab.prototype.tabChanged=function(){},ObjectsTreeTabFilter.prototype._getActions=function(){return[{name:"all",title:$.t("Show All")},{name:"drawings",title:$.t("Show Only Drawings")},{name:"studies",title:$.t("Show Only Studies")}].map(function(e){return e.name==this._value?e.active=!0:e.action=this.setValue.bind(this,e.name),e}.bind(this))},ObjectsTreeTabFilter.prototype.value=function(){return this._value},ObjectsTreeTabFilter.prototype.setValue=function(e){e!=this._value&&(this._value=e,
this.onChange.fire(e))},ObjectsTreeTabFilter.prototype.applyToGroup=function(e){if("all"==this._value)return e;for(var t,i=0;i<e.children.length;i++)t=e.children[i],t.skipped=!isInherited(t.datasource.constructor,TradingView.Series)&&!isInherited(t.datasource.constructor,"drawings"==this._value?W47:TradingView.Study);return e},A23=function(e,t,i){this.D0=t,this._paneWidget=e,this._chart=e._chart,this._mainDiv=i,this.jqTable=$(document.createElement("table")),this.jqTable.addClass("pane-legend"),this._itemsBinding=new List,this._chart.properties().paneProperties.legendProperties.showStudyTitles.listeners().subscribe(this,this.updateLayout),this._chart.properties().paneProperties.legendProperties.showSeriesTitle.listeners().subscribe(this,this.updateLayout),this._chart.properties().paneProperties.legendProperties.showSeriesOHLC.listeners().subscribe(this,this.updateLayout),this._chart.properties().paneProperties.legendProperties.showStudyValues.listeners().subscribe(this,this.updateLayout),this.updateLayout()},A23.prototype.contextMenuEvent=function(e,t){!this.D0.chartModel().readOnly()&&W77.enabled("legend_context_menu")&&this._paneWidget.showContextMenuForSource(t.source,e)},A23.prototype.updateLayout=function(){this._itemsBinding.clear(),this.jqTable.find(".apply-common-tooltip").trigger("mouseleave"),this.jqTable.empty();var e=this._paneWidget.state();if(e&&this.D0){var t={showStudyTitles:this.D0.model().properties().paneProperties.legendProperties.showStudyTitles.value(),showSeriesTitle:this._chart.properties().paneProperties.legendProperties.showSeriesTitle.value(),showSeriesOHLC:this._chart.properties().paneProperties.legendProperties.showSeriesOHLC.value(),showStudyValues:this._chart.properties().paneProperties.legendProperties.showStudyValues.value()},i=new List,n=e.orderedSources().slice(),e=n.indexOf(this.D0.mainSeries());for(e>-1&&(n.splice(e,1),n.push(this.D0.mainSeries())),e=n.length-1;e>=0;e--){var o=n[e],r=o.statusView();r&&i.append({view:r,source:o})}for(e=0;e<i.size();++e)if(o=i.item(e).source,n=o==this.D0.mainSeries(),(!n||t.showSeriesTitle||t.showSeriesOHLC)&&(n||t.showStudyTitles||t.showStudyValues)){var r=i.item(e).view,s=$("<tr>"),a=$("<td>");s.appendTo(this.jqTable),a.addClass("pane-legend-line"),n?a.addClass("main"):a.addClass("study"),o.properties().visible.value()||a.addClass("disabled"),a.appendTo(s),a.source=o,this._generateItemsForRow(a,r,t),TradingView.setMouseEventHandler(a,this,!0)}this.update()}},A23.prototype._updateFollowSymbol=function(e,t){if(!this._chart.onWidget()&&!W77.enabled("charting_library")){var i=$(document.createElement("span")).data("alive",!0).appendTo(e);A16.makeButton(t.properties().symbol.value(),"iconed").done(function(e){if(i.data("alive")){e.removeAttr("title");var t=A68.ticker(e.data("symbol")||"");e.blueTooltip("<strong>Follow "+t+".</strong> If you follow a symbol you will receive notifications when new ideas about that symbol are published.","bottom"),i.replaceWith(e)}})}},A23.prototype._generateItemsForRow=function(e,t,i){var n=e.source,o=this,r=n==this.D0.mainSeries();if(r&&i.showSeriesTitle||!r&&i.showStudyTitles){var s=$("<span>");if(s.addClass("pane-legend-line"),W77.enabled("legend_context_menu")||s.addClass("no-context-menu"),r&&s.addClass("main"),n.properties().visible.value()||s.addClass("disabled"),s.css({"font-weight":t.bold()?"bold":"normal","font-size":t.size()}),s.click(function(t){o.contextMenuEvent(t,e)}),s.appendTo(e),this._itemsBinding.append({value:t,cell:s,source:e.source}),!this._chart.readOnly()&&n.userEditEnabled()&&W77.enabled("edit_buttons_in_legend")){if(t=$('<span class="pane-legend-icon-container">').appendTo(e),$('<a class="pane-legend-icon apply-common-tooltip icon-hide" title="'+$.t("Show/Hide")+'">').appendTo(t).on("click touchend",this._generateItemsForRow._onShowhideClick.bind(this,n)),$('<a class="pane-legend-icon apply-common-tooltip format" title="'+$.t("Format")+'">').appendTo(t).on("click touchend",this._generateItemsForRow._onFormatClick.bind(this,n)),n instanceof TradingView.Study&&n.metaInfo().isTVScript&&n.metaInfo().TVScriptSourceCode&&!TradingView.isMobileView&&(s=$('<a class="pane-legend-icon apply-common-tooltip source" title="Show Source Code">').appendTo(t).on("click touchend",this._generateItemsForRow._onViewSorceClick.bind(this,n)),window.scriptEditor)){var a=window.scriptEditor.loadedScriptIdPart();a&&n.metaInfo().scriptIdPart===a&&s.addClass("active")}r||$('<a class="pane-legend-icon apply-common-tooltip delete" title="'+$.t("Delete")+'">').appendTo(t).on("click touchend",this._generateItemsForRow._onDeleteClick.bind(this,n))}else $("<span>&nbsp;</span>").appendTo(e)}if(t=n.dataWindowView(),t=n.dataWindowView(),this.isDataWindowValuesVisible(t)&&(r&&i.showSeriesOHLC||!r&&i.showStudyValues)){i=[],s=[],a=$("<div>"),a.addClass("pane-legend-item-value-container");for(var l=0;l<t.items().size();l++){t.items().item(l);var d=r?$("<span class='pane-legend-item-value-title pane-legend-line'>").appendTo(a):null,h=$("<span class='pane-legend-item-value pane-legend-line'>").appendTo(a);r&&h.addClass("main"),n.properties().visible.value()||(h.addClass("disabled"),d&&d.addClass("disabled")),i.push(h),d&&s.push(d)}l=$("<span class='pane-legend-item-additional pane-legend-line'>").appendTo(a),a.appendTo(e),this._itemsBinding.append({value:t,cell:i,titleCells:s.length?s:null,source:n,additional:l})}TradingView.D18("alerts")&&!this._chart.onWidget()&&TradingView.alertsDispatcher&&r&&(n=$('<span class="pane-legend-icon-container">').appendTo(e),this.alertWidget&&this.alertWidget.destroy(),this.D0.chartModel().readOnly()||(this.alertWidget=new TradingView.AlertsLegendWidget(n,this.D0)))},A23.prototype.isDataWindowValuesVisible=function(e){return this._chart.onWidget()?!!e&&!this._chart.isSmall():!!e},A23.prototype._generateItemsForRow._onShowhideClick=function(e){this.D0.setProperty(e.properties().visible,!e.properties().visible.value(),"Show/Hide "+e.title())},A23.prototype._generateItemsForRow._onFormatClick=function(e,t){e.userEditEnabled()&&new EditObjectDialog(e,this.D0).show()},A23.prototype._generateItemsForRow._onDeleteClick=function(e){e.isUserDeletable()&&this.D0.removeSource(e)},A23.prototype._generateItemsForRow._onViewSorceClick=function(e){var t=e.metaInfo();e={scriptSource:e.metaInfo().TVScriptSourceCode,scriptIdPart:t.scriptIdPart},window.scriptEditor&&window.scriptEditor.show(e)},A23.prototype.setItemEnabled=function(e,t){var i=!e.hasClass("disabled"),n=e.closest("td.pane-legend-line");t&&!i?(e.removeClass("disabled"),n.removeClass("disabled")):!t&&i&&(e.addClass("disabled"),n.addClass("disabled"))},A23.prototype.updateTitle=function(){var e=this._chart.properties().scalesProperties.textColor.value();this.jqTable.css("color",e);for(var t,i,e=this._itemsBinding.size();e--;){i=this._itemsBinding.item(e);var n=i.source;isArray(i.cell)||(t=n.properties().visible.value(),this.setItemEnabled(i.cell,t),t=i.value.color(),n=n!=this.D0.mainSeries()&&n===this.D0.selectedSource()?"bold":"normal",i.cell.text(clean(i.value.text(),!0)).css({color:t,"border-color":t,"font-weight":n}))}},A23.prototype.update=function(){this.updateTitle();for(var e,t,i,n,o,r,s,a=this._itemsBinding.size();a--;)if(n=this._itemsBinding.item(a),e=n.cell,t=n.titleCells,i=n.source.properties().visible.value(),isArray(e)){for(o=n.value.items(),r=0;r<e.length;r++)s=o.item(r),this.setItemEnabled(e[r],i),e[r][0].textContent=s.text(),s.color()&&e[r].css("color",s.color()),t&&(this.setItemEnabled(t[r],i),t[r][0].textContent=s.title());n.additional&&n.value.additional&&n.additional.text(n.value.additional()||"")}},A23.prototype.dataSourceAtPoint=function(e,t){return null},A23.prototype.renderTo=function(e,t,i){e.save(),e.fillStyle=this._chart.properties().scalesProperties.textColor.value(),e.textBaseline="middle";for(var n=0,o=0;o<this._itemsBinding.size();++o){var r=this._itemsBinding.item(o),s=r.value,a=r.source==this.D0.mainSeries(),l=a?12:8,a=a?25:17;isArray(r.cell)||(e.font=s.size()+" Verdana, Arial",e.fillText(s.text(),t,i+n+l),n+=a)}e.restore()},A52=function(e,t,i){this.chart=e,this.paneA=e._paneWidgets[t],this.paneB=e._paneWidgets[i],this.jqRow=$(document.createElement("tr")),this.jqRow.height(A52.HEIGHT),this.jqCell=$(document.createElement("td")),this.jqCell.appendTo(this.jqRow),this.jqCell.addClass("pane-separator"),this.jqCell.attr("colspan","3"),this.jqCell.css("background",this.chart.properties().scalesProperties.lineColor.value()),this.jqCell.click(function(){}),this.handle=$('<div class="handle">').appendTo(this.jqCell),$(this.handle).css("cursor",cursorCss("cursor_size_vertical","16 15")),TradingView.setMouseEventHandler(this.handle,this)},A52.HEIGHT=1,A52.prototype.mouseDownEvent=function(e){(0===e.button||Modernizr.touch)&&(this.startY=e.pageY,this.deltaY=0,this.totalHeight=this.paneA.size.h+this.paneB.size.h,this.totalStretch=this.paneA.stretchFactor()+this.paneB.stretchFactor(),this.prevStretchA=this.paneA.stretchFactor(),this.minPaneHeight=30,this.maxPaneHeight=this.totalHeight-this.minPaneHeight,this.pixelStretchFactor=this.totalStretch/this.totalHeight)},A52.prototype.pressedMouseMoveEvent=function(e){if(0===e.button||Modernizr.touch){e.preventDefault(),this.deltaY=e.pageY-this.startY;var t=this.paneA.size.h,i=MathEx.clamp(t+this.deltaY,this.minPaneHeight,this.maxPaneHeight)*this.pixelStretchFactor,n=this.totalStretch-i;this.paneA.setStretchFactor(i),this.paneB.setStretchFactor(n),this.chart._adjustSize(),this.paneA.size.h!==t&&(this.startY=e.pageY),this.chart.paint()}},A52.prototype.mouseUpEvent=function(e){(0===e.button||Modernizr.touch)&&(this.chart.D0.addPaneStretchFactorUndoCommand(this.paneA._state,this.paneB._state,this.prevStretchA,this.paneA.stretchFactor()),this.pixelStretchFactor=this.maxPaneHeight=this.minPaneHeight=this.totalStretch=this.totalHeight=this.deltaY=this.startY=0)},A52.prototype.update=function(){this.jqCell.css("background",this.chart.properties().scalesProperties.lineColor.value())},A52.prototype.paint=function(){},A52.prototype.image=function(){var e,t,i={},n=A52.HEIGHT,o=this.paneA.lhsPriceAxisWidget.size.w,r=this.paneA.size.w,s=this.paneA.rhsPriceAxisWidget.size.w;return e=$('<canvas width="'+o+'" height="'+n+'">')[0],t=e.getContext("2d"),t.fillStyle=this.chart.properties().scalesProperties.lineColor.value(),t.fillRect(0,0,o,n),i.leftAxis={content:e.toDataURL(),contentWidth:o,contentHeight:n},e=$('<canvas width="'+r+'" height="'+n+'">')[0],t=e.getContext("2d"),t.fillStyle=this.chart.properties().scalesProperties.lineColor.value(),t.fillRect(0,0,r,n),i.content=e.toDataURL(),i.contentWidth=r,i.contentHeight=n,e=$('<canvas width="'+s+'" height="'+n+'">')[0],t=e.getContext("2d"),t.fillStyle=this.chart.properties().scalesProperties.lineColor.value(),t.fillRect(0,0,s,n),i.rightAxis={content:e.toDataURL(),contentWidth:s,contentHeight:n},i},A51=function(e,t,i){this.D0=t,this._paneWidget=e,this._chart=e._chart,this._mainDiv=i,this.jqDiv=$('<div class="pane-controls">').appendTo(i),this.update()},A51.prototype.update=function(){var e=this,t=e.D0,i=e._paneWidget.state(),t=t.panes().indexOf(i),n=!1;if(!i.containsMainSeries()){for(var o=0,i=i.D19(),r=i.size();r--;)if(i.item(r)instanceof TradingView.Study&&(o++,o>1)){n=!0;break}i=null}t>0?(this._$upButton||(this._$upButton=$(document.createElement("a")).addClass("pane-legend-icon up").attr("title",$.t("Move Up")).on("click",function(){e.D0.rearrangePanes(e._chart,e.D0.panes().indexOf(e._paneWidget.state()),"up")})),this._$upButton.appendTo(this.jqDiv)):this._$upButton&&this._$upButton.detach(),t<this.D0.panes().size()-1?(this._$downButton||(this._$downButton=$(document.createElement("a")).addClass("pane-legend-icon down").attr("title",$.t("Move Down")).on("click",function(){e.D0.rearrangePanes(e._chart,e.D0.panes().indexOf(e._paneWidget.state()),"down")})),this._$downButton.appendTo(this.jqDiv)):this._$downButton&&this._$downButton.detach(),n?(this._$closeButton||(this._$closeButton=$(document.createElement("a")).addClass("pane-legend-icon delete").attr("title",$.t("Delete")).on("click",function(){e.D0.removePane(e._chart,e.D0.panes().indexOf(e._paneWidget.state()))})),this._$closeButton.appendTo(this.jqDiv)):this._$closeButton&&this._$closeButton.detach()},A54=function(e,t,i){this.pane=e,this._isLeft=A54.isLeft(t),this._disableContextMenu=!!i,this.jqCell=$(document.createElement("td")),this.jqCell.addClass("chart-markup-table"),this.jqCell.addClass("price-axis"),this.jqCell.width(25),this._dv=$("<div>"),this._dv.css("width","100%"),this._dv.css("height","100%"),this._dv.css("position","relative"),this._dv.css("overflow","hidden"),this._dv.appendTo(this.jqCell),this.canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.canvas).css("position","absolute"),$(this.canvas).css("z-order","2"),$(this.canvas).css("left",0),$(this.canvas).css("top",0),this.ctx=this.canvas.getContext("2d"),this.top_canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.top_canvas).css("position","absolute"),$(this.top_canvas).css("z-order","1"),$(this.top_canvas).css("left",0),$(this.top_canvas).css("top",0),this.top_ctx=this.top_canvas.getContext("2d"),this._optimalWidth=40,this.setFont(11,"Arial",""),this.ctx.setFont(this.baseFont),this.top_ctx.setFont(this.baseFont),this._tickmarksCache=new TradingView.LabelsImageCache(this.baseFont,this.textColor(),11,100);var n=this;this.pane.chart().model().model().properties().scalesProperties.textColor.listeners().subscribe(null,function(e){n._tickmarksCache.reset(e.value())}),this.restoreDefaultCursor(),this.update(),TradingView.setMouseEventHandler(this.jqCell,this,!0),this.dialog=this.pane.chart().dialog,this.contextMenu=null,this.actions={},this._isVisible=!0},A54.prototype._BORDER_SIZE=1,A54.prototype._MAJOR_TICK_LENGTH=4,A54.prototype._MINOR_TICK_LENGTH=2,A54.LHS=1,A54.RHS=2,A54.isLeft=function(e){return e===A54.LHS?!0:(e!==A54.RHS&&TradingView.logDebug("PriceAxisWidget.isLeft: wrong side"),!1)},A54.prototype.backgroundColor=function(){return this.pane.chart().model().model().properties().paneProperties.background.value()},A54.prototype.lineColor=function(){return this.pane.chart().model().model().properties().scalesProperties.lineColor.value()},A54.prototype.textColor=function(){return this.pane.chart().model().model().properties().scalesProperties.textColor.value()},A54.prototype.mouseDownEvent=function(e){if(!this.priceScale().isEmpty()){var t=this.pane.chart().model(),i=this.pane.state();this._mousedown=!0,this.jqCell.css("cursor",cursorCss("cursor_size_vertical","15 15")),t.startScalePrice(i,this.priceScale(),e.localY),TradingView.trackEvent("GUI","Scaling price scale")}},A54.prototype.pressedMouseMoveEvent=function(e){var t=this.pane.chart().model(),i=this.pane.state(),n=this.priceScale();t.scalePriceTo(i,n,e.localY)},A54.prototype.mouseDownOutsideEvent=function(e){e=this.pane.chart().model();var t=this.pane.state(),i=this.priceScale();this._mousedown&&(this._mousedown=!1,e.endScalePrice(t,i),this.restoreDefaultCursor())},A54.prototype.mouseUpEvent=function(e){e=this.pane.chart().model();var t=this.pane.state(),i=this.priceScale();this._mousedown=!1,e.endScalePrice(t,i),this.restoreDefaultCursor()},A54.prototype._initActions=function(e){if(this.pane.state()){var t=this;this.actions.reset=new Action({text:$.t("Reset Scale")}),this.actions.reset.callbacks().subscribe(this,A54.prototype.reset),e=function(e){this._undoModel.setLockScaleProperty(this._property,e.checked,t.priceScale().mainSource(),this._undoText)},delete this.actions.setLockScale,this.priceScale().mainSource()instanceof TradingView.Series&&(this.actions.setLockScale=new Action({text:$.t("Lock Scale"),checkable:!0,checked:this.priceScale().mainSource().properties().lockScale.value()}),this._lockScaleBinding=new D14(this.actions.setLockScale,this.priceScale().mainSource().properties().lockScale,this.pane.chart().model(),"Undo LockScale",e),this._lockScaleBinding.setValue(this.priceScale().mainSource().properties().lockScale.value())),this.actions.setAutoScale=new Action({text:$.t("Auto Scale"),checkable:!0,checked:!0}),this._autoScaleBinding=new D14(this.actions.setAutoScale,this.priceScale().properties().autoScale,this.pane.chart().model(),"Undo AutoScale",function(){this._undoModel.setAutoScaleProperty(this._property,this.value(),t.priceScale(),this._undoText)}),this._autoScaleBinding.setValue(this._autoScaleBinding.property().value()),this.actions.setPercentage=new Action({text:$.t("Percentage",{context:"scale_menu"}),checkable:!0,checked:!1}),this.actions.setPercentage.binding=new D14(this.actions.setPercentage,this.priceScale().properties().percentage,this.pane.chart().model(),"Undo Percentage",function(){this._undoModel.setPercentProperty(this._property,this.value(),t.priceScale(),this._undoText),this._undoModel.m_model.fullUpdate();var e=this;setTimeout(function(){e._undoModel.m_model.fullUpdate()},500)}),this.actions.setLog=new Action({text:$.t("Log Scale",{context:"scale_menu"}),checkable:!0,checked:!1}),this.actions.setLog.binding=new D14(this.actions.setLog,this.priceScale().properties().log,this.pane.chart().model(),"Undo Log Scale"),this.actions.showSymbolNames=new Action({text:$.t("Show Symbol Labels",{context:"scale_menu"}),checkable:!0,checked:!1}),this.actions.showSymbolNames.binding=new D14(this.actions.showSymbolNames,this.priceScale().properties().showSymbolLabels,this.pane.chart().model(),"Undo Show Symbol Labels"),this.actions.alignLabels=new Action({text:$.t("Precise Labels",{context:"scale_menu"}),checkable:!0,checked:!1}),this.actions.alignLabels.binding=new D14(this.actions.alignLabels,this.priceScale().properties().alignLabels,this.pane.chart().model(),"Precise Labels"),this._updateScalesActions()}},A54.prototype._updateScalesActions=function(){var e=this.priceScale(),t=e.mainSource()instanceof TradingView.Series,i=e.mainSource().properties();this.actions.setPercentage.setEnabled(!(e.isLog()||t&&i.lockScale.value()||t&&i.style.value()===TradingView.Series.STYLE_PNF)),this.actions.setLog.setEnabled(!(e.isPercent()||t&&i.lockScale.value()||t&&i.style.value()===TradingView.Series.STYLE_PNF)),this.actions.setAutoScale.setChecked(e.D2.autoScale.value()),this.actions.setAutoScale.setEnabled(!e.properties().autoScaleDisabled.value())},A54.prototype.mouseClickEvent=function(e){},A54.prototype.mouseDoubleClickEvent=function(e){this.reset(),TradingView.trackEvent("GUI","Double click price scale")},A54.prototype.contextMenuEvent=function(e,t){!this._disableContextMenu&&W77.enabled("scales_context_menu")&&this._createContextMenu().show(e)},A54.prototype._createContextMenu=function(){return ContextMenu.createMenu(this.getContextMenuActions())},A54.prototype.getContextMenuActions=function(){this._initActions();var e=this.pane.chart().actions(),t=[this.actions.reset,new ActionSeparator,e.showLeftAxis,e.showRightAxis,new ActionSeparator,this.actions.setAutoScale,e.scaleSeriesOnly,new ActionSeparator,this.actions.setPercentage,this.actions.setLog,new ActionSeparator,this.actions.showSymbolNames];return t.push(e.showSeriesLastValue),t.push(e.showStudyLastValue),W77.enabled("countdown")&&t.push(e.showCountdown),t.push(this.actions.alignLabels),TradingView.onWidget()||(t.push(new ActionSeparator),t.push(e.scalesProperties)),this.actions.setLockScale&&t.splice(6,0,this.actions.setLockScale),t},A54.prototype.backLabels=function(e){var t=new List,i=this.priceScale().orderedSources().clone().toArray(),n=this.pane,o=n.chart().model(),n=n.state(),r=[],s=o.sourceBeingMoved()||o.lineBeingEdited()||o.lineBeingCreated();if(s&&r.push(s),o.selectedSource()&&r.push(o.selectedSource()),o.hoveredSource()&&r.push(o.hoveredSource()),this.priceScale()===n.defaultPriceScale())for(s=this.pane.state().D19(),o=0;o<s.size();o++)n.isOverlay(s.item(o))&&i.push(s.item(o));for(o=0;o<i.length;++o)s=i[o],(e||-1===r.indexOf(s))&&(s=s.priceAxisViews(n,s.priceScale()))&&t.appendAll(s);return t},A54.prototype.optimalWidth=function(){if(!this.isVisible())return 0;var e=0;if(this.pane.state()){var t=this.ctx,i=this.priceScale().marks();t.textBaseline="middle",t.textAlign=this._isLeft?"right":"left",t.setFont(this.baseFont),$.each(i,function(){var i=Math.round(t.measureText(this.label).width+10);i>e&&(e=i)}),t.setFont(this.labelFont);for(var i=this.backLabels(!0),n=0;n<i.size();n++){if(i.item(n).font){var o=t.font;t.setFont(i.item(n).font())}var r=Math.round(t.measureText(i.item(n).text()).width+10);r>e&&(e=r),i.item(n).font&&t.setFont(o)}}return this._optimalWidth=this._BORDER_SIZE+this._MAJOR_TICK_LENGTH+e+-1},A54.prototype.resetOptimalWidth=function(){this._optimalWidth=0},A54.prototype.setFont=function(e,t,i){this.labelFont=this.baseFont=makeFont(e,t,i),this.fontSize=e},A54.prototype.setSize=function(e){this.size&&this.size.equals(e)||(this.size=e,TradingView.setCanvasSize(this.canvas,e),TradingView.setCanvasSize(this.top_canvas,e),this.ctx=this.canvas.getContext("2d"),this.top_ctx=this.top_canvas.getContext("2d"),this.ctx.setFont(this.baseFont),this.top_ctx.setFont(this.baseFont),this.jqCell.css({width:e.w,"min-width":e.w,height:e.h}))},A54.prototype.update=function(){},A54.prototype._hightlightBackground=function(e,t,i){for(var n=t.item(0).price,o=t.item(0).price,r=1;r<t.size();r++)n=Math.min(n,t.item(r).price),o=Math.max(o,t.item(r).price);t=this.priceScale(),t.isPercent()&&i&&(i=i.firstValue(),n=t.priceRange().convertToPercent(n,i),o=t.priceRange().convertToPercent(o,i)),n=this.priceScale().priceToCoordinate(n),o=this.priceScale().priceToCoordinate(o),clearRect(e,1,n,this.size.w-1,o-n,"rgba(109, 158, 235, 0.3)")},A54.prototype.drawBackground=function(e){clearRect(e,0,0,this.size.w,this.size.h,this.backgroundColor());var t=this.pane.chart().model(),i=t.model().selectedSource();if(i&&i.priceScale()==this.priceScale()&&i instanceof W47){var n=i.points();if(0==n.size())return;this._hightlightBackground(e,n,i.ownerSource())}t=t.model().crossHairSource(),t.startMeasurePoint()&&this._hightlightBackground(e,t.measurePoints(),this.pane.state().mainDataSource())},A54.prototype.drawBorder=function(e){e.save(),e.fillStyle=this.lineColor();var t=this.size.h;if(this._isLeft){e.translate(-.5,-.5);var i=this.size.w-this._BORDER_SIZE-1,n=this.size.w-1}else e.translate(.5,-.5),i=0,n=i+this._BORDER_SIZE;e.fillRect(i,0,n-i,t),e.restore()},A54.prototype.drawTickMarks=function(e){e.save(),e.strokeStyle=this.lineColor();var t=this.priceScale().marks();e.textBaseline="middle",e.textAlign=this._isLeft?"right":"left",e.fillStyle=this.textColor(),e.setFont(this.baseFont);var i=this.size.w-1;e.translate(-.5,-.5);var n,o=t.length;if(TradingView.D18("tv4603_tv4590"))if(this._isLeft){for(n=i-this._BORDER_SIZE,e.fillStyle=this.lineColor(),e.beginPath();o--;)i=t[o].major?this._MAJOR_TICK_LENGTH:this._MINOR_TICK_LENGTH,e.rect(n-i,t[o].coord,i,1);for(e.fill(),e.fillStyle=this.textColor(),o=t.length;o--;)this._tickmarksCache.paintTo(e,t[o].label,n-this._MAJOR_TICK_LENGTH,t[o].coord,"rght")}else{for(n=this._BORDER_SIZE+1,e.fillStyle=this.lineColor(),e.beginPath();o--;)i=t[o].major?this._MAJOR_TICK_LENGTH:this._MINOR_TICK_LENGTH,e.rect(n,t[o].coord,i+1,1);for(e.fill(),e.fillStyle=this.textColor(),o=t.length;o--;)this._tickmarksCache.paintTo(e,t[o].label,n+this._MAJOR_TICK_LENGTH+1,t[o].coord,"left")}else if(this._isLeft){for(n=i-this._BORDER_SIZE,e.fillStyle=this.lineColor();o--;)i=t[o].major?this._MAJOR_TICK_LENGTH:this._MINOR_TICK_LENGTH,e.fillRect(n-i,t[o].coord,i,1);for(e.fillStyle=this.textColor(),o=t.length;o--;)e.fillText(t[o].label,n-this._MAJOR_TICK_LENGTH,t[o].coord)}else{for(n=this._BORDER_SIZE+1,e.fillStyle=this.lineColor();o--;)i=t[o].major?this._MAJOR_TICK_LENGTH:this._MINOR_TICK_LENGTH,e.fillRect(n,t[o].coord,i+1,1);for(e.fillStyle=this.textColor(),o=t.length;o--;)e.fillText(t[o].label,n+this._MAJOR_TICK_LENGTH+1,t[o].coord)}e.restore()},A54.prototype._alignLabels=function(){var e=this.size.h/2,t=new List,i=this.priceScale().orderedSources().clone().toArray(),n=this.pane;n.chart().model();var o=n.state();if(this.priceScale()===o.defaultPriceScale())for(var r=this.pane.state().D19(),n=0;n<r.size();n++)o.isOverlay(r.item(n))&&i.push(r.item(n));for(var s=this.priceScale().mainSource(),n=0;n<i.length;++n){var a=i[n];(r=a.priceAxisViews(o,a.priceScale()))&&(t.appendAll(r),s==a&&0<r.size()&&(e=r.item(0)._floatCoordinate))}if(r=t.toArray(),i=r.filter(function(t){return t._floatCoordinate<=e}),t=r.filter(function(t){return t._floatCoordinate>e}),i.sort(function(e,t){return(t._floatCoordinate||t.coordinate())-(e._floatCoordinate||e.coordinate())}),i.length&&t.length&&t.push(i[0]),t.sort(function(e,t){return(e._floatCoordinate||e.coordinate())-(t._floatCoordinate||t.coordinate())}),r.forEach(function(e){e._fixedCoordinate=e.coordinate()}),n=this.priceScale().properties(),n.alignLabels&&n.alignLabels.value()){for(n=1;n<i.length;n++)r=i[n],o=i[n-1],s=o.renderer().height(!1),r.coordinate()>o._fixedCoordinate-s&&(o=o._fixedCoordinate-s,r._fixedCoordinate=o);for(n=1;n<t.length;n++)r=t[n],o=t[n-1],s=o.renderer().height(!0),r.coordinate()<o._fixedCoordinate+s&&(o=o._fixedCoordinate+s,r._fixedCoordinate=o)}},A54.prototype.drawBackLabels=function(e){e.save(),e.setFont(this.labelFont);for(var t=this.backLabels(),i=0;i<t.size();i++){var n=t.item(i),o=n.renderer();n._fixedCoordinate&&(o._data.coordinate=n._fixedCoordinate),o.draw(e,this._isLeft,this.size.w,this.size.h)}e.restore()},A54.prototype.drawCrossHairLabel=function(e){var t=this.pane.chart().model().model(),i=[],n=t.sourceBeingMoved()||t.lineBeingEdited()||t.lineBeingCreated();n&&i.push({source:n,scale:n.priceScale()}),t.selectedSource()&&i.push({source:t.selectedSource(),scale:t.selectedSource().priceScale()}),t.hoveredSource()&&i.push({source:t.hoveredSource(),scale:t.hoveredSource().priceScale()});var o=this.pane.state(),i=i.reduce(function(e,t){var i=t.source.priceAxisViews(o,t.scale);return i?e.concat(i.toArray()):e},[]);(t=t.crossHairSource().priceAxisViews(o,this.priceScale()))&&(i=i.concat(t.toArray()));var r=this;i.filter(function(e){return null!=e}).forEach(function(t){e.save(),e.setFont(r.labelFont);var i=t.renderer();t._fixedCoordinate&&(i._data.coordinate=t._fixedCoordinate),i.draw(e,r._isLeft,r.size.w,r.size.h),e.restore()})},A54.prototype.priceScale=function(){var e=this.pane.state(),t=[],t=this._isLeft?[e.leftPriceScale(),e.rightPriceScale()]:[e.rightPriceScale(),e.leftPriceScale()];return null===t[0].mainSource()?null===t[1].mainSource()?t[0]:t[1]:t[0]},A54.prototype.isVisible=function(){return this._isVisible},A54.prototype.setVisible=function(e){(this._visible=e)?this.jqCell.show():this.jqCell.hide(),this._isVisible=!!e},A54.prototype.setAutoScale=function(e){var t=this.pane.state,i=this.priceScale();this.pane.chart().model().setPriceAutoScale(t,i,e)},A54.prototype.reset=function(){var e=this.pane.state(),t=this.priceScale();this.pane.chart().model().resetPriceScale(e,t)},A54.prototype.paint=function(e){this._isVisible&&e&&(this._alignLabels(),e===A22.UPDATE_CURSOR_ONLY?(this.top_ctx.clearRect(0,0,this.size.w,this.size.h),this.drawCrossHairLabel(this.top_ctx)):(this.drawBackground(this.ctx),this.drawBorder(this.ctx),this.pane.state()&&(this.drawTickMarks(this.ctx),this.drawBackLabels(this.ctx),this.top_ctx.clearRect(0,0,this.size.w,this.size.h),this.drawCrossHairLabel(this.top_ctx))))},A54.prototype.restoreDefaultCursor=function(){this.jqCell.css("cursor","default")},A54.prototype.image=function(){var e={};return e.content=this.canvas.toDataURL(),e.contentWidth=this.size.w,e.contentHeight=this.size.h,e},A73=function(e,t){this.chart=e,this.contextMenu=null,this._disableContextMenu=!!t,this.jqRow=$(document.createElement("tr")),this.jqLhsTimeAxisStub=$(document.createElement("td")),this.jqLhsTimeAxisStub.addClass("chart-markup-table"),this.jqLhsTimeAxisStub.appendTo(this.jqRow),this.jqLhsStub=$("<div>"),this.jqLhsStub.css("width","100%"),this.jqLhsStub.css("height","100%"),this.jqLhsStub.css("position","relative"),this.jqLhsStub.css("overflow","hidden"),this.jqLhsStub.appendTo(this.jqLhsTimeAxisStub),this.lhsCanvas=TradingView.addCanvasTo(this.jqLhsStub,new A61(16,16)),$(this.lhsCanvas).css("position","absolute"),$(this.lhsCanvas).css("z-order","2"),$(this.lhsCanvas).css("left",0),$(this.lhsCanvas).css("top",0),this.lhsCtx=this.lhsCanvas.getContext("2d"),this.jqCell=$(document.createElement("td")),this.jqCell.appendTo(this.jqRow),this.jqCell.addClass("chart-markup-table"),this.jqCell.addClass("time-axis"),this.jqCell.height(25),this._dv=$("<div>"),this._dv.css("width","100%"),this._dv.css("height","100%"),this._dv.css("position","relative"),this._dv.css("overflow","hidden"),this._dv.appendTo(this.jqCell),this.canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.canvas).css("position","absolute"),$(this.canvas).css("z-order","2"),$(this.canvas).css("left",0),$(this.canvas).css("top",0),this.ctx=this.canvas.getContext("2d"),this.top_canvas=TradingView.addCanvasTo(this._dv,new A61(16,16)),$(this.top_canvas).css("position","absolute"),$(this.top_canvas).css("z-order","1"),$(this.top_canvas).css("left",0),$(this.top_canvas).css("top",0),this.top_ctx=this.top_canvas.getContext("2d"),this.jqRhsTimeAxisStub=$(document.createElement("td")),this.jqRhsTimeAxisStub.addClass("chart-markup-table"),this.jqRhsTimeAxisStub.appendTo(this.jqRow),this.jqRhsStub=$("<div>"),this.jqRhsStub.css("width","100%"),this.jqRhsStub.css("height","100%"),this.jqRhsStub.css("position","relative"),this.jqRhsStub.css("overflow","hidden"),this.jqRhsStub.appendTo(this.jqRhsTimeAxisStub),this.rhsCanvas=TradingView.addCanvasTo(this.jqRhsStub,new A61(16,16)),$(this.rhsCanvas).css("position","absolute"),$(this.rhsCanvas).css("z-order","2"),$(this.rhsCanvas).css("left",0),$(this.rhsCanvas).css("top",0),this.rhsCtx=this.rhsCanvas.getContext("2d"),this.setFont(11,"Arial",""),this.ctx.setFont(this.baseFont),this.top_ctx.setFont(this.baseFont),this.restoreDefaultCursor(),this.update(),this._minVisibleSpan=MINUTE_SPAN,TradingView.setMouseEventHandler(this.jqCell,this,!0),this.updatePriceScalesVisibility()},A73.prototype.BORDER_SIZE=1,A73.prototype.MAJOR_TICK_LENGTH=4,A73.prototype.MINOR_TICK_LENGTH=2,A73.prototype.backgroundColor=function(){var e=this.chart.model();return e?e.model().properties().paneProperties.background.value():"#ffffff"},A73.prototype.lineColor=function(){var e=this.chart.model();return e?e.model().properties().scalesProperties.lineColor.value():"#ffffff"},A73.prototype.textColor=function(){var e=this.chart.model();return e?e.model().properties().scalesProperties.textColor.value():"#ffffff"},A73.prototype.updatePriceScalesVisibility=function(){this.chart.properties().scalesProperties.showLeftScale.value()?this.jqLhsTimeAxisStub.show():this.jqLhsTimeAxisStub.hide(),this.chart.properties().scalesProperties.showRightScale.value()?this.jqRhsTimeAxisStub.show():this.jqRhsTimeAxisStub.hide()},A73.prototype.mouseDownEvent=function(e){if(this._mousedown)return!0;this._mousedown=!0;var t=this.chart.model();t.timeScale().isEmpty()||($(this.jqCell).css("cursor",cursorCss("cursor_size_horizontal","15 15")),t.startScaleTime(e.localX))},A73.prototype.mouseDownOutsideEvent=function(e){e=this.chart.model(),!e.timeScale().isEmpty()&&this._mousedown&&(this._mousedown=!1,e.endScaleTime(),this.restoreDefaultCursor())},A73.prototype.pressedMouseMoveEvent=function(e){var t=this.chart.model();if(!t.timeScale().isEmpty()){var i=!1,n=(new Date).valueOf();this._lastScrollScaleTime&&100>n-this._lastScrollScaleTime&&(i=!0),i||(TradingView.trackEvent("GUI","Scaling time scale"),t.scaleTimeTo(e.localX),this._lastScrollScaleTime=n)}},A73.prototype.mouseUpEvent=function(e){this._mousedown=!1,e=this.chart.model(),e.timeScale().isEmpty()||(e.endScaleTime(),this.restoreDefaultCursor())},A73.prototype.contextMenuEvent=function(e,t){!this._disableContextMenu&&W77.enabled("scales_context_menu")&&this._createContextMenu().show(e)},A73.prototype._createContextMenu=function(){return ContextMenu.createMenu(this.getContextMenuActions())},A73.prototype.getContextMenuActions=function(){
var e=this.chart;e.model().mainSeries().createSessStudy(),e.updateActions();var e=e.actions(),t=W77.enabled("charting_library")?[e.timeScaleReset,new ActionSeparator,e.applyTimeZone]:[e.timeScaleReset,new ActionSeparator,e.applyTimeZone,e.sessionBreaks,e.extendedHours];return t.push(new ActionSeparator,e.tmzProperties),t},A73.prototype.mouseClickEvent=function(e){},A73.prototype.mouseDoubleClickEvent=function(e){TradingView.trackEvent("GUI","Double click time scale"),this.chart.model().resetTimeScale()},A73.prototype.optimalHeight=function(){return this.BORDER_SIZE+this.MAJOR_TICK_LENGTH+this.maxFontSize+6},A73.prototype.setFont=function(e,t,i){this.baseFont=makeFont(e,t,i),this.baseBoldFont=makeFont(e,t,i+" bold"),this.labelFont=this.baseFont,this.maxFontSize=e},A73.prototype.setSize=function(e,t,i){this.size&&this.size.equals(e)||(this.lhsStubSize=t,TradingView.setCanvasSize(this.lhsCanvas,t),this.lhsCtx=this.lhsCanvas.getContext("2d"),this.jqLhsTimeAxisStub.width(t.w),this.jqLhsTimeAxisStub.height(t.h),this.rhsStubSize=i,TradingView.setCanvasSize(this.rhsCanvas,i),this.rhsCtx=this.rhsCanvas.getContext("2d"),this.jqRhsTimeAxisStub.width(i.w),this.jqRhsTimeAxisStub.height(i.h),this.size=e,TradingView.setCanvasSize(this.canvas,e),TradingView.setCanvasSize(this.top_canvas,e),this.ctx=this.canvas.getContext("2d"),this.top_ctx=this.top_canvas.getContext("2d"),this.ctx.setFont(this.baseFont),this.top_ctx.setFont(this.baseFont),this.jqCell.width(e.w),this.jqCell.height(e.h))},A73.prototype._spanIndex=function(e){for(var t=[MINUTE_SPAN,HOUR_SPAN,DAY_SPAN,MONTH_SPAN,YEAR_SPAN],i=t.length-1;i>0&&!(t[i]<=e);)i--;return i},A73.prototype._spanOffset=function(e,t){if(e>t)throw new Exception("actual span cuold not be less then base");return this._spanIndex(t)-this._spanIndex(e)},A73.prototype.update=function(){if(this.chart.model()){var e=this.chart.model().timeScale().marks();if(e){var t=this;this._minVisibleSpan=YEAR_SPAN,$.each(e,function(){t._minVisibleSpan=Math.min(this.span,t._minVisibleSpan)})}}},A73.prototype._hightlightBackground=function(e,t){for(var i=this.chart.model().timeScale(),n=t.item(0).index,o=t.item(0).index,r=1;r<t.size();r++)n=Math.min(n,t.item(r).index),o=Math.max(o,t.item(r).index);n=i.indexToCoordinate(n),i=i.indexToCoordinate(o),clearRect(e,n,1,i-n,this.size.h-1,"rgba(109, 158, 235, 0.3)")},A73.prototype.drawBackground=function(e){clearRect(e,0,0,this.size.w,this.size.h,this.backgroundColor());var t=this.chart.model();if(t){var i=t.timeScale(),n=t.model().selectedSource();if(n&&n instanceof W47&&!i.isEmpty()){if(i=n.points(),0==i.size())return;this._hightlightBackground(e,i)}t=t.model().crossHairSource(),t.startMeasurePoint()&&this._hightlightBackground(e,t.measurePoints())}},A73.prototype.drawBorder=function(e){e.save(),e.fillStyle=this.lineColor(),e.fillRect(-.5,.5,this.size.w+.5,this.BORDER_SIZE),e.restore()},A73.prototype.drawStubs=function(){var e=this.BORDER_SIZE,t=2*this.BORDER_SIZE,i=this.lhsCtx;clearRect(i,0,0,this.lhsStubSize.w,this.lhsStubSize.h,this.backgroundColor()),i.fillStyle=this.lineColor(),i.fillRect(this.lhsStubSize.w-t-.5,.5,t,e),i.fillRect(this.lhsStubSize.w-t-.5,-.5,e,e),i=this.rhsCtx,clearRect(i,0,0,this.rhsStubSize.w,this.rhsStubSize.h,this.backgroundColor()),i.fillStyle=this.lineColor(),i.fillRect(-.5,.5,t,e),i.fillRect(.5,-.5,e,e)},A73.prototype.drawTickMarks=function(e){var t=this.chart.model().timeScale().marks();if(t&&0!=t.length){var i=t.reduce(function(e,t){return e.span>t.span?e:t}).span;i>30&&40>i&&(i=30),e.save(),e.strokeStyle=this.lineColor(),e.textBaseline="top",e.textAlign="center",e.translate(.5,.5),e.fillStyle=this.lineColor();for(var n=t.length;n--;)e.fillRect(t[n].coord,this.BORDER_SIZE,1,t[n].major?this.MAJOR_TICK_LENGTH:this.MINOR_TICK_LENGTH);e.fillStyle=this.textColor();for(var o={},n=0;n<t.length;n++){var r=t[n].span>=i?this.baseBoldFont:this.baseFont,s=o[r]||[];s.push(t[n]),o[r]=s}for(f in o)for(e.setFont(f),t=o[f],n=0;n<t.length;n++)e.fillText(t[n].label,t[n].coord,this.BORDER_SIZE+this.MAJOR_TICK_LENGTH-1);e.restore()}},A73.prototype.drawBackLabels=function(e){e.save(),e.setFont(this.labelFont);for(var t=this.chart.model().D19(),i=this.chart.model(),i=i.sourceBeingMoved()||i.lineBeingEdited()||i.lineBeingCreated(),n=0;n<t.size();n++){var o=t.item(n);if(o!==this.chart.model().crossHairSource()&&o!==i&&o.timeAxisViews&&(o=o.timeAxisViews()))for(var r=0;r<o.size();r++)o.item(r).renderer().draw(e,this.size.w,this.size.h)}e.restore()},A73.prototype.drawCrossHairLabel=function(e){var t=this.chart.model();if(t=t.sourceBeingMoved()||t.lineBeingEdited()||t.lineBeingCreated()){if(e.save(),t.timeAxisViews&&(t=t.timeAxisViews()))for(var i=0;i<t.size();i++)t.item(i).renderer().draw(e,this.size.w,this.size.h)}else if(e.save(),e.setFont(this.labelFont),t=this.chart.model().crossHairSource().timeAxisView())for(i=0;i<t.size();i++)t.item(i).renderer().draw(e,this.size.w,this.size.h);e.restore()},A73.prototype.paint=function(e){this.top_ctx.setFont(this.labelFont),0!==e&&(e===A22.UPDATE_CURSOR_ONLY?(this.top_ctx.clearRect(-.5,-.5,this.size.w,this.size.h),this.drawCrossHairLabel(this.top_ctx)):(e=this.ctx,this.drawBackground(e),this.drawBorder(e),this.drawStubs(),this.chart.model()&&(this.drawTickMarks(e),this.drawBackLabels(e),this.drawCrossHairLabel(this.top_ctx))))},A73.prototype.setStubVisible=function(e,t){var i=A54.isLeft(e)?this.jqLhsTimeAxisStub:this.jqRhsTimeAxisStub;t?i.show():i.hide()},A73.prototype.restoreDefaultCursor=function(){this.jqCell.css("cursor","default")},A73.prototype.image=function(){var e={};return e.content=this.canvas.toDataURL(),e.contentWidth=this.size.w,e.contentHeight=this.size.h,e.lhsStub={},e.lhsStub.content=this.lhsCanvas.toDataURL(),e.lhsStub.contentWidth=this.lhsStubSize.w,e.lhsStub.contentHeight=this.lhsStubSize.h,e.rhsStub={},e.rhsStub.content=this.rhsCanvas.toDataURL(),e.rhsStub.contentWidth=this.rhsStubSize.w,e.rhsStub.contentHeight=this.rhsStubSize.h,e},inherit($41,D7),$41.prototype._addSessionEditor=function(e,t,i,n){if("session"!==i.type)TradingView.logError("Session editor adding FAILED: wrong input type.");else{i=function(e,t){var i=$("<td/>");i.appendTo(e),i.css("padding-left","0px"),i.css("padding-right","0px");var n=$("<input>");n.attr("type","text"),n.addClass("ticker"),n.css("width","40px"),n.attr("id",t),n.appendTo(i)};var o=function(e,t,i){var n=$("<td/>");n.css("padding-left",i),n.css("padding-right",i),n.appendTo(e),e=$("<div/>"),e.appendTo(n),e.append(t),e.css("font-size","150%")},r=$("<table/>");r.appendTo(e),e=$("<tr/>"),e.appendTo(r),editorIds=["start_hours","start_minutes","end_hours","end_minutes"],i.call(this,e,editorIds[0]),o.call(this,e,":",0),i.call(this,e,editorIds[1]),o.call(this,e,"-",4),i.call(this,e,editorIds[2]),o.call(this,e,":",0),i.call(this,e,editorIds[3]),this.bindControl(new D8(e,editorIds,t,!1,this.model(),n))}},$41.prototype.prepareLayoutImpl=function(e,t){for(var i=0;i<e.inputs.length;i++){var n=e.inputs[i],o=n.id;if("first_visible_bar_time"!=o&&"last_visible_bar_time"!=o&&"time"!=n.type&&!n.isHidden&&(!this._showOnlyConfirmInputs||n.confirm)){var r=n.name||o.toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()}),s="Change "+r,a=$("<tr/>");a.appendTo(t);var l=$("<td/>");if(l.appendTo(a),l.addClass($.t("propertypage-name-label",{context:"css_class"})),l.text($.t(r,{context:"input"})),r=$("<td/>"),r.appendTo(a),a=null,"resolution"===n.type)a=$('<select><option value="1">1</option><option value="3">3</option><option value="5">5</option><option value="15">15</option><option value="30">30</option><option value="45">45</option><option value="60">1h</option><option value="120">2h</option><option value="180">3h</option><option value="D">1d</option><option value="W">1w</option></select>');else if("symbol"===n.type)a=$('<input class="symbol-edit single">'),A69.bindToInput(a);else if("session"===n.type)this._addSessionEditor(r,this._property.inputs[o],n,s);else if(n.options)for(a=$("<select/>"),l=0;l<n.options.length;l++){var d=n.options[l];$("<option value='"+d+"'>"+d+"</option>").appendTo(a)}else a=$("<input/>"),"bool"===n.type?a.attr("type","checkbox"):a.attr("type","text");a&&(a.appendTo(r),a.is(":checkbox")||a.css("width","100px")),n.options?this.bindControl(new D11(a,this._property.inputs[o],null,!0,this.model(),s)):"bar_time"===n.type?(this.bindControl(new D9(a,this._property.inputs[o],!0,this.model(),s,this.model().mainSeries(),10)),a.addClass("ticker")):"integer"===n.type?(l=[ToIntTransformer(n.defval)],(0===n.min||n.min)&&l.push(GreateTransformer(n.min)),(0===n.max||n.max)&&l.push(LessTransformer(n.max)),this.bindControl(new SimpleStringBinder(a,this._property.inputs[o],l,!1,this.model(),s)),a.addClass("ticker")):"float"===n.type?(l=[ToFloatTransformer(n.defval)],(0===n.min||n.min)&&l.push(GreateTransformer(n.min)),(0===n.max||n.max)&&l.push(LessTransformer(n.max)),this.bindControl(new SimpleStringBinder(a,this._property.inputs[o],l,!1,this.model(),s)),a.addClass("ticker")):"text"===n.type?this.bindControl(new SimpleStringBinder(a,this._property.inputs[o],null,!1,this.model(),s)):"bool"===n.type?this.bindControl(new D12(a,this._property.inputs[o],!0,this.model(),s)):"resolution"===n.type?this.bindControl(new D11(a,this._property.inputs[o],UppercaseTransformer,!0,this.model(),"Change Interval")):"symbol"===n.type&&this.bindControl(new D10(a,this._property.inputs[o],!0,this.model(),"Change Symbol"))}}this._property.offset&&(r=this._property.offset.title?this._property.offset.title.value():"Offset",a=this.addOffsetEditorRow(t,r),l=[ToIntTransformer(this._property.offset.val)],l.push(GreateTransformer(this._property.offset.min)),l.push(LessTransformer(this._property.offset.max)),this.bindControl(new SimpleStringBinder(a,this._property.offset.val,l,!1,this.model(),"Undo "+r))),this._property.offsets&&$.each(e.plots,function(e,i){if(this._property.offsets[i.id]){var n=this._property.offsets[i.id];if(void 0==n.isHidden||!n.isHidden.value()){var o=n.title.value(),r=this.addOffsetEditorRow(t,o),s=[ToIntTransformer(n.val)];s.push(GreateTransformer(n.min)),s.push(LessTransformer(n.max)),this.bindControl(new SimpleStringBinder(r,n.val,s,!1,this.model(),"Undo "+o))}}}.bind(this))},$41.prototype.prepareLayout=function(){this._table=$("<table/>"),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=this.D1.metaInfo();this.prepareLayoutImpl(e,this._table),this.loadData()},$41.prototype.widget=function(){return this._table},inherit($47,D7),$47.prototype.prepareLayout=function(){this._table=$("<table/>"),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");for(var e=0;e<this.D1.metaInfo().plots.length;++e)if(!this.D1.isSelfColorerPlot(e)&&!this.D1.isDataOffsetPlot(e)){var t=this.D1.metaInfo().plots[e];this.D1.isLinePlot(e)||this.D1.isBarColorerPlot(e)||this.D1.isBgColorerPlot(e)?this._prepareLayoutForPlot(e,t):this.D1.isPlotArrowsPlot(e)?this._prepareLayoutForArrowsPlot(e,t):this.D1.isPlotCharsPlot(e)?this._prepareLayoutForCharsPlot(e,t):this.D1.isPlotShapesPlot(e)?this._prepareLayoutForShapesPlot(e,t):console.error("Unknown plot type: "+t.type)}if(e=this.D1.properties().transparency){var i=$('<tr class="line"/>');i.appendTo(this._table),$("<td/>").appendTo(i),t=$("<td/>"),t.appendTo(i),t.addClass("propertypage-name-label"),t.html($.t("Transparency")),t=$("<td/>"),t.attr("colspan","3"),t.appendTo(i),i=TradingView.createTransparencyEditor().width(270),i.appendTo(t),this.bindControl(new SliderBinder(i,e,!0,this.model(),"Change Study Transparency"))}var n=this.D1.properties().bands;if(n&&0<n.childCount())for(e=0;e<n.childCount();e++){t=n[e],i=$('<tr class="line"/>'),i.appendTo(this._table);var o=$("<td/>");o.appendTo(i);var r=$("<input type='checkbox' class='visibility-switch'/>");r.appendTo(o),o=t.name.value(),this.createLabeledCell(o,r).appendTo(i).addClass($.t("propertypage-name-label",{context:"css_class"})),o=$("<td/>"),o.appendTo(i),o.addClass("colorpicker-cell");var o=TradingView.addColorPicker(o),s=$("<td/>");s.appendTo(i);var a=TradingView.createLineWidthEditor();a.appendTo(s);var l=$('<td colspan="4">').css({whiteSpace:"nowrap"});l.appendTo(i),s=TradingView.createLineStyleEditor(),s.render().appendTo(l);var d=$("<input class='property-page-bandwidth' type='text'/>");d.appendTo(l),l=[ToFloatTransformer(t.value.value())],i="Change band",this.bindControl(new SimpleStringBinder(d,t.value,l,!1,this.model(),i)),this.bindControl(new D12(r,t.visible,!0,this.model(),i)),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),i)),this.bindControl(new D11(s,t.linestyle,parseInt,!0,this.model(),i)),this.bindControl(new SliderBinder(a,t.linewidth,!0,this.model(),i))}if(this.D1.properties().bandsBackground&&(t=this.D1.properties().bandsBackground,r=$.t("Background"),i=this._prepareFilledAreaBackground(t.fillBackground,t.backgroundColor,t.transparency,r,"Change band background"),i.appendTo(this._table)),this.D1.properties().areaBackground&&(t=this.D1.properties().areaBackground,r=$.t("Background"),i=this._prepareFilledAreaBackground(t.fillBackground,t.backgroundColor,t.transparency,r,"Change area background"),i.appendTo(this._table)),n=this.D1.metaInfo().filledAreas,void 0!=n)for(e=0;e<n.length;++e)i=n[e],t=this.D1.properties().filledAreasStyle[i.id],r=i.title||$.t("Background"),i="Change "+r,i=this._prepareFilledAreaBackground(t.visible,t.color,t.transparency,r,i),i.appendTo(this._table);for(var h in this.D1.metaInfo().graphics){var c,e=this.D1.metaInfo().graphics[h];for(c in e)t=this._property.graphics[h][c],$47["_createRow_"+h].call(this,this._table,t)}1==this._table.find("tr").length&&(o=this._table.find(".visibility-cell"),o.css("display","none"),t=this._table.find(".propertypage-name-label"),t.css("padding-left",0)),h=this._prepareStudyPropertiesLayout(),this._table=this._table.add(h),this.loadData()},$47.prototype._prepareLayoutForPlot=function(e,t){var i=t.id,n=this.D1.properties().styles[i],o=this._findPlotPalette(e,t),r=o.palette,s=o.paletteProps,o="Change "+i;if(r)this._prepareLayoutForPalette(e,t,r,s,o);else{r=$('<tr class="line"/>'),r.appendTo(this._table);var a=$("<td/>");a.appendTo(r),a.addClass("visibility-cell"),s=$("<input type='checkbox' class='visibility-switch'/>"),s.appendTo(a),i=this.D1.properties().styles[i].title.value(),this.createLabeledCell(i,s).appendTo(r).addClass($.t("propertypage-name-label",{context:"css_class"})),i=$("<td/>"),i.appendTo(r),i.addClass("colorpicker-cell");var i=TradingView.addColorPicker(i),l=$("<td/>");l.appendTo(r),a=TradingView.createLineWidthEditor(),a.appendTo(l);var d=$("<td>");d.appendTo(r),l=TradingView.createPlotEditor(),l.appendTo(d);var h=$("<td>");h.appendTo(r);var c=TradingView.createTransparencyEditor(i);c.appendTo(h),d=n.plottype.value(),h.css("display",this._isStyleNeedsTransparency(d)?"block":"none"),d=$("<td>"),d.appendTo(r);var p=$("<input type='checkbox'>");p.appendTo(d),this.createLabeledCell("Price Line",p).appendTo(r),this.bindControl(new D12(s,n.visible,!0,this.model(),o)),this.bindControl(new ColorBinding(i,n.color,!0,this.model(),o)),this.bindControl(new SliderBinder(a,n.linewidth,!0,this.model(),o)),this.bindControl(new D11(l,n.plottype,parseInt,!0,this.model(),o)),this.bindControl(new SliderBinder(c,n.transparency,!0,this.model(),o)),this.bindControl(new D12(p,n.trackPrice,!0,this.model(),"Change Price Line")),o=function(){var e=n.plottype.value();h.css("display",this._isStyleNeedsTransparency(e)?"table-cell":"none"),c.css("display",this._isStyleNeedsTransparency(e)?"inline-block":"none")}.bind(this),o(),n.plottype.listeners().subscribe(null,o)}},$47.prototype._prepareLayoutForShapesPlot=function(e,t){var i=t.id,n=this.D1.properties().styles[i],o=this._findPlotPalette(e,t),r=o.palette,s=o.paletteProps,o="Change "+i,a=$('<tr class="line"/>');a.appendTo(this._table);var l=$("<td/>");l.appendTo(a),l.addClass("visibility-cell");var d=$("<input type='checkbox' class='visibility-switch'/>");d.appendTo(l),this.bindControl(new D12(d,n.visible,!0,this.model(),o)),i=this.D1.properties().styles[i].title.value(),this.createLabeledCell(i,d).appendTo(a).addClass($.t("propertypage-name-label",{context:"css_class"})),i=$("<td/>"),i.appendTo(a),d=TradingView.createShapeStyleEditor(),d.appendTo(i),this.bindControl(new D11(d,n.plottype,null,!0,this.model(),o)),i=$("<td/>"),i.appendTo(a),a=TradingView.createShapeLocationEditor(),a.appendTo(i),this.bindControl(new D11(a,n.location,null,!0,this.model(),o)),r?this._prepareLayoutForPalette(e,t,r,s,o):(a=$('<tr class="line"/>'),a.appendTo(this._table),$("<td/>").appendTo(a),$("<td/>").appendTo(a),r=$("<td/>"),r.appendTo(a),r.addClass("colorpicker-cell"),s=TradingView.addColorPicker(r),this.bindControl(new ColorBinding(s,n.color,!0,this.model(),o)),r=$("<td>"),r.appendTo(a),a=TradingView.createTransparencyEditor(s),a.appendTo(r),this.bindControl(new SliderBinder(a,n.transparency,!0,this.model(),o)))},$47.prototype._prepareLayoutForCharsPlot=function(e,t){var i=t.id,n=this.D1.properties().styles[i],o=this._findPlotPalette(e,t),r=o.palette,s=o.paletteProps,o="Change "+i,a=$('<tr class="line"/>');a.appendTo(this._table);var l=$("<td/>");l.appendTo(a),l.addClass("visibility-cell");var d=$("<input type='checkbox' class='visibility-switch'/>");d.appendTo(l),this.bindControl(new D12(d,n.visible,!0,this.model(),o)),i=this.D1.properties().styles[i].title.value(),this.createLabeledCell(i,d).appendTo(a).addClass($.t("propertypage-name-label",{context:"css_class"})),i=$("<td/>"),i.appendTo(a),d=TradingView.createTextEditor(),d.appendTo(i),d.keyup(function(){var e=$(this),t=e.val();t&&(e.val(t.split("")[t.length-1]),e.change())}),this.bindControl(new SimpleStringBinder(d,n["char"],null,!1,this.model(),o)),i=$("<td/>"),i.appendTo(a),a=TradingView.createShapeLocationEditor(),a.appendTo(i),this.bindControl(new D11(a,n.location,null,!0,this.model(),o)),r?this._prepareLayoutForPalette(e,t,r,s,o):(a=$('<tr class="line"/>'),a.appendTo(this._table),$("<td/>").appendTo(a),$("<td/>").appendTo(a),r=$("<td/>"),r.appendTo(a),r.addClass("colorpicker-cell"),s=TradingView.addColorPicker(r),this.bindControl(new ColorBinding(s,n.color,!0,this.model(),o)),r=$("<td>"),r.appendTo(a),a=TradingView.createTransparencyEditor(s),a.appendTo(r),this.bindControl(new SliderBinder(a,n.transparency,!0,this.model(),o)))},$47.prototype._isStyleNeedsTransparency=function(e){return 0<=[TradingView.StudyConsts.PLOT_AREA,TradingView.StudyConsts.PLOT_AREA_WITH_BREAKS,TradingView.StudyConsts.PLOT_COLUMNS].indexOf(e)},$47.prototype._isStyleNeedsConnectPoints=function(e){return 0<=[TradingView.StudyConsts.PLOT_CROSS,TradingView.StudyConsts.PLOT_CIRCLES].indexOf(e)},$47.prototype._prepareLayoutForPalette=function(e,t,i,n,o){t=t.id;var r=this.D1.properties().styles[t];t=0;for(var s in i.colors){var a=n.colors[s];i=$('<tr class="line"/>'),i.appendTo(this._table),$("<td/>").appendTo(i);var l=$("<td/>");if(l.appendTo(i),l.addClass($.t("propertypage-name-label",{context:"css_class"})),l.html($.t(a.name.value())),l=$("<td/>"),l.appendTo(i),l.addClass("colorpicker-cell"),l=TradingView.addColorPicker(l),this.bindControl(new ColorBinding(l,a.color,!0,this.model(),o)),0===t&&(this.D1.isBgColorerPlot(e)||this.D1.isPlotCharsPlot(e)||this.D1.isPlotShapesPlot(e))){var d=$("<td>");d.appendTo(i);var h=TradingView.createTransparencyEditor(l);h.appendTo(d),this.bindControl(new SliderBinder(h,r.transparency,!0,this.model(),o))}if(this.D1.isLinePlot(e)){d=$("<td/>"),d.appendTo(i);var c=TradingView.createLineWidthEditor();c.appendTo(d),this.bindControl(new SliderBinder(c,a.width,!0,this.model(),o)),a=$("<td>"),a.appendTo(i),0===t&&(d=TradingView.createPlotEditor(),d.appendTo(a),this.bindControl(new D11(d,r.plottype,parseInt,!0,this.model(),o)),d=$("<td>"),d.appendTo(i),h=TradingView.createTransparencyEditor(l),h.appendTo(d),this.bindControl(new SliderBinder(h,r.transparency,!0,this.model(),o)),a=function(){var e=r.plottype.value();h.css("display",this._isStyleNeedsTransparency(e)?"block":"none")}.bind(this),a(),r.plottype.listeners().subscribe(null,a),a=$("<input type='checkbox'>"),l=$('<td colspan="4">').css({whiteSpace:"nowrap"}),d=$("<span>").html($.t("Price Line")),c=$("<span>"),c.append(a),l.append(c).append(d).appendTo(i),this.bindControl(new D12(a,r.trackPrice,!0,this.model(),"Change Price Line")))}t++}},$47.prototype._prepareLayoutForArrowsPlot=function(e,t){var i=t.id,n=this.D1.properties().styles[i],o="Change "+i,r=$('<tr class="line"/>');r.appendTo(this._table);var s=$("<td/>");s.appendTo(r),s.addClass("visibility-cell");var a=$("<input type='checkbox' class='visibility-switch'/>");a.appendTo(s),i=this.D1.properties().styles[i].title.value(),this.createLabeledCell(i,a).appendTo(r).addClass($.t("propertypage-name-label",{context:"css_class"})),i=$("<td/>"),i.appendTo(r),i.addClass("colorpicker-cell"),i=TradingView.addColorPicker(i),s=$("<td/>"),s.appendTo(r),s.addClass("colorpicker-cell");var s=TradingView.addColorPicker(s),l=$("<td>");l.appendTo(r),r=TradingView.createTransparencyEditor(),r.appendTo(l),this.bindControl(new D12(a,n.visible,!0,this.model(),o)),this.bindControl(new ColorBinding(i,n.colorup,!0,this.model(),o)),this.bindControl(new ColorBinding(s,n.colordown,!0,this.model(),o)),this.bindControl(new SliderBinder(r,n.transparency,!0,this.model(),o))},$47.prototype._findPlotPalette=function(e,t){var i=t.id,n=null,o=null,r=this.D1.metaInfo().plots;if(this.D1.isBarColorerPlot(e)||this.D1.isBgColorerPlot(e))n=this.D1.metaInfo().palettes[t.palette],o=this.D1.properties().palettes[t.palette];else for(var s=0;s<r.length;s++)if(this.D1.isSelfColorerPlot(s)&&r[s].target===i){n=this.D1.metaInfo().palettes[r[s].palette],o=this.D1.properties().palettes[r[s].palette];break}return{palette:n,paletteProps:o}},$47.prototype._prepareStudyPropertiesLayout=function(){var e=$('<table class="property-page study-properties" cellspacing="0" cellpadding="2">');if(!this.D1.metaInfo().is_price_study){var t=this.createPrecisionEditor(),i=$("<tr>");i.appendTo(e),$("<td>"+$.t("Precision")+"</td>").appendTo(i),$("<td>").append(t).appendTo(i),this.bindControl(new D11(t,this.D1.properties().precision,null,!0,this.model(),"Change Precision"))}return"Compare@tv-basicstudies"==this.D1.metaInfo().id&&(t=this.createSeriesMinTickEditor(),i=$("<tr>"),i.appendTo(e),$("<td>"+$.t("Override Min Tick")+"</td>").appendTo(i),$("<td>").append(t).appendTo(i),this.bindControl(new D11(t,this.D1.properties().minTick,null,!0,this.model(),"Change MinTick"))),this._putStudyDefaultStyles(e),e},$47.prototype._putStudyDefaultStyles=function(e,t){var i=null,n=this.D1;if(n.properties().linkedToSeries&&n.properties().linkedToSeries.value())return!1;$.each(this.D0.m_model.panes().toArray(),function(e,t){$.each(t.D19().toArray(),function(e,o){return o==n?(i=t,!1):void 0})}),this._pane=i;var o;if(this._pane&&(this._pane.leftPriceScale().D19().contains(this.D1)?o="left":this._pane.rightPriceScale().D19().contains(this.D1)?o="right":this._pane.isOverlay(this.D1)&&(o="none")),o){var r=this;o=this.createKeyCombo({left:$.t("Scale Left"),right:$.t("Scale Right"),none:$.t("Screen (No Scale)")}).val(o).change(function(){switch(this.value){case"left":r.D0.move(r.D1,r._pane,r._pane.leftPriceScale());break;case"right":r.D0.move(r.D1,r._pane,r._pane.rightPriceScale());break;case"none":r.D0.move(r.D1,r._pane,null)}});var s=this.addRow(e);$("<td>"+$.t("Scale")+"</td>").appendTo(s),o=$("<td>").appendTo(s).append(o),t&&t>2&&o.attr("colspan",t-1)}return e},$47.prototype.widget=function(){return this._table},$47.prototype._prepareFilledAreaBackground=function(e,t,i,n,o){var r=$('<tr class="line"/>'),s=$("<td/>");s.appendTo(r);var a=$("<input type='checkbox' class='visibility-switch'/>");a.appendTo(s),this.createLabeledCell(n,a).appendTo(r).addClass($.t("propertypage-name-label",{context:"css_class"})),n=$("<td/>"),n.appendTo(r),n.addClass("colorpicker-cell"),n=TradingView.addColorPicker(n),s=$("<td/>"),s.attr("colspan","3"),s.appendTo(r);var l=TradingView.createTransparencyEditor(n).width(230);return l.appendTo(s),this.bindControl(new D12(a,e,!0,this.model(),o+" visibility")),this.bindControl(new ColorBinding(n,t,!0,this.model(),o+" color")),this.bindControl(new SliderBinder(l,i,!0,this.model(),o+" transparency")),r},inherit($39,D7),$39.prototype.prepareLayout=function(){this.D1.properties().linkedToSeries&&this.D1.properties().linkedToSeries.value(),this._table=$()},$39.prototype.widget=function(){return this._table},$47._createRow_horizlines=function(e,t){var i=this.addRow(e),n=t.name.value(),o=$("<input type='checkbox' class='visibility-switch'/>"),r=this.createColorPicker(),s=TradingView.createLineWidthEditor(),a=TradingView.createLineStyleEditor();$("<td>").append(o).appendTo(i),this.createLabeledCell(n,o).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(a.render()).appendTo(i),this.bindControl(new D12(o,t.visible,!0,this.model(),"Change "+n+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new D11(a,t.style,parseInt,!0,this.model(),"Change "+n+" style")),this.bindControl(new SliderBinder(s,t.width,!0,this.model(),"Change "+n+" width"))},$47._createRow_vertlines=function(e,t){var i=this.addRow(e),n=t.name.value(),o=$("<input type='checkbox' class='visibility-switch'/>"),r=this.createColorPicker(),s=TradingView.createLineWidthEditor(),a=TradingView.createLineStyleEditor();$("<td>").append(o).appendTo(i),this.createLabeledCell(n,o).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(a.render()).appendTo(i),this.bindControl(new D12(o,t.visible,!0,this.model(),"Change "+n+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new D11(a,t.style,parseInt,!0,this.model(),"Change "+n+" style")),this.bindControl(new SliderBinder(s,t.width,!0,this.model(),"Change "+n+" width"))},$47._createRow_lines=function(e,t){var i=this.addRow(e),n=t.title.value(),o=$("<input type='checkbox' class='visibility-switch'/>"),r=this.createColorPicker(),s=TradingView.createLineWidthEditor(),a=TradingView.createLineStyleEditor();$("<td>").append(o).appendTo(i),this.createLabeledCell(n,o).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(a.render()).appendTo(i),this.bindControl(new D12(o,t.visible,!0,this.model(),"Change "+n+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new D11(a,t.style,parseInt,!0,this.model(),"Change "+n+" style")),this.bindControl(new SliderBinder(s,t.width,!0,this.model(),"Change "+n+" width"))},$47._createRow_hlines=function(e,t){var i=this.addRow(e),n=t.name.value(),o=$("<input type='checkbox' class='visibility-switch'/>"),r=this.createColorPicker(),s=TradingView.createLineWidthEditor(),a=TradingView.createLineStyleEditor(),l=$("<input type='checkbox'>");$("<td>").append(o).appendTo(i),this.createLabeledCell(n,o).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(a.render()).appendTo(i),$("<td>").appendTo(i),$("<td>").append(l).appendTo(i),this.createLabeledCell("Show Price",l).appendTo(i),this.bindControl(new D12(o,t.visible,!0,this.model(),"Change "+n+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new D11(a,t.style,parseInt,!0,this.model(),"Change "+n+" style")),this.bindControl(new SliderBinder(s,t.width,!0,this.model(),"Change "+n+" width")),this.bindControl(new D12(l,t.showPrice,!0,this.model(),"Change "+n+" show price")),t.enableText.value()&&(i=this.addRow(e),$('<td colspan="2">').appendTo(i),o=$("<input type='checkbox'>"),$('<td class="text-center">').append(o).appendTo(i),this.createLabeledCell("Show Text",o).appendTo(i),this.bindControl(new D12(o,t.showText,!0,this.model(),"Change "+n+" show text")),o=TradingView.createTextPosEditor(),$("<td>").append(o.render()).appendTo(i),this.bindControl(new D11(o,t.textPos,parseInt,!0,this.model(),"Change "+n+" text position")),o=this.createFontSizeEditor(),$('<td colspan="2">').append(o).appendTo(i),this.bindControl(new D11(o,t.fontSize,parseInt,!0,this.model(),"Change "+n+" font size")))},$47._createRow_hhists=function(e,t){var i=t.title.value(),n=[],o=[],r=[],s=this.addRow(e),a=TradingView.createVisibilityEditor();$("<td>").append(a).appendTo(s),this.createLabeledCell(i,a).appendTo(s),this.bindControl(new D12(a,t.visible,!0,this.model(),"Change "+i+" Visibility")),s=this.addRow(e),a=$("<input/>"),a.attr("type","text"),a.addClass("ticker"),this.createLabeledCell("Width (% of the Box)",a).appendTo(s),$("<td>").append(a).appendTo(s),s=[ToIntTransformer(40)],s.push(GreateTransformer(0)),s.push(LessTransformer(100)),this.bindControl(new SimpleStringBinder(a,t.percentWidth,s,!1,this.model(),"Change Percent Width")),s=this.addLabeledRow(e,"Placement"),a=TradingView.createHHistDirectionEditor(),$("<td>").append(a).appendTo(s),this.bindControl(new D11(a,t.direction,null,!0,this.model(),"Change "+i+" Placement")),s=this.addRow(e),a=$("<input type='checkbox'>"),$("<td>").append(a).appendTo(s),this.createLabeledCell("Show Values",a).appendTo(s),this.bindControl(new D12(a,t.showValues,!0,this.model(),"Change "+i+" Show Values")),s=this.addRow(e),a=this.createColorPicker(),this.createLabeledCell("Text Color",a).appendTo(s),$("<td>").append(a).appendTo(s),this.bindControl(new ColorBinding(a,t.valuesColor,!0,this.model(),"Change "+i+" Text Color"));for(var l in t.colors)isNumber(parseInt(l,10))&&(s=this.addRow(e),n[l]=t.titles[l].value(),o[l]=this.createColorPicker(),r[l]=TradingView.createTransparencyEditor(o[l]),$("<td>").append(n[l]).appendTo(s),$("<td>").append(o[l]).appendTo(s),$("<td>").append(r[l]).appendTo(s),this.bindControl(new ColorBinding(o[l],t.colors[l],!0,this.model(),"Change "+n[l]+" color")),this.bindControl(new SliderBinder(r[l],t.transparencies[l],!0,this.model(),"Change "+n[l]+" transparency")))},$47._createRow_backgrounds=function(e,t){var i=this.addRow(e),n=$("<input type='checkbox' class='visibility-switch'/>"),o=t.name.value(),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r);$("<td>").append(n).appendTo(i),this.createLabeledCell(o,n).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),this.bindControl(new D12(n,t.visible,!0,this.model(),"Change "+o+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+o+" color")),this.bindControl(new SliderBinder(s,t.transparency,!0,this.model(),"Change "+o+" transparency"))},$47._createRow_polygons=function(e,t){var i=this.addRow(e),n=t.name.value(),o=this.createColorPicker(),r=TradingView.createTransparencyEditor(o);$("<td>").append(n).appendTo(i),$("<td>").append(o).appendTo(i),$("<td>").append(r).appendTo(i),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new SliderBinder(r,t.transparency,!0,this.model(),"Change "+n+" transparency"))},$47._createRow_trendchannels=function(e,t){var i=this.addRow(e),n=t.name.value(),o=this.createColorPicker(),r=TradingView.createTransparencyEditor(o);$("<td>").append(n).appendTo(i),$("<td>").append(o).appendTo(i),$("<td>").append(r).appendTo(i),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new SliderBinder(r,t.transparency,!0,this.model(),"Change "+n+" transparency"))},$47._createRow_textmarks=function(e,t){var i=this.addLabeledRow(e),n=t.name.value(),o=this.createColorPicker(),r=this.createColorPicker(),s=this.createFontEditor(),a=this.createFontSizeEditor(),l=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),d=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>'),h=TradingView.createTransparencyEditor(o);$("<td>").append(n).appendTo(i),"rectangle"!==t.shape.value()&&$("<td>").append(o).appendTo(i),
$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(a).appendTo(i),$("<td>").append(l).appendTo(i),$("<td>").append(d).appendTo(i),$("<td>").append(h).appendTo(i),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new ColorBinding(r,t.fontColor,!0,this.model(),"Change "+n+" text color")),this.bindControl(new D11(a,t.fontSize,parseInt,!0,this.model(),"Change "+n+" font size")),this.bindControl(new D11(s,t.fontFamily,null,!0,this.model(),"Change "+n+" font")),this.bindControl(new D12(l,t.fontBold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(d,t.fontItalic,!0,this.model(),"Change Text Font Italic")),this.bindControl(new SliderBinder(h,t.transparency,!0,this.model(),"Change "+n+" transparency"))},$47._createRow_shapemarks=function(e,t){var i=this.addRow(e),n=$("<input type='checkbox' class='visibility-switch'/>"),o=t.name.value(),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),a=$("<input/>");a.attr("type","text"),a.addClass("ticker"),$("<td>").append(n).appendTo(i),this.createLabeledCell(o,n).appendTo(i),$("<td>").append(r).appendTo(i),$("<td>").append(s).appendTo(i),this.createLabeledCell("Size",a).appendTo(i),$("<td>").append(a).appendTo(i),this.bindControl(new D12(n,t.visible,!0,this.model(),"Change "+o+" visibility")),this.bindControl(new ColorBinding(r,t.color,!0,this.model(),"Change "+o+" back color")),this.bindControl(new SliderBinder(s,t.transparency,!0,this.model(),"Change "+o+" transparency")),this.bindControl(new SimpleStringBinder(a,t.size,null,!1,this.model(),"Change size"))},inherit(A85,D7),inherit(A85,SeriesStylePropertyPageMixin),A85.prototype.setScalesOpenTab=function(){this.scalesColumnLeft.data("layout-tab-open",EditObjectDialog.TAB_OPEN_OVERRIDE)},A85.prototype.setTmzOpenTab=function(){this.tmzSessTable.data("layout-tab-open",EditObjectDialog.TAB_OPEN_OVERRIDE)},A85.prototype.prepareLayout=function(){var e=this,t=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Style")),i=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Style")),n=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Style")),o=$('<table class="property-page" cellspacing="0" cellpadding="2">'),r=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}).data("layout-separated",!0),s=$('<div class="property-page-column-2">').data("layout-tab",$.t("Scales"));this.scalesColumnLeft=s;var a=$('<div class="property-page-column-2">').data("layout-tab",$.t("Scales")),l=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Timezone/Sessions"));this.tmzSessTable=l;var d=e._alertSettingsIsVisible()?"Events & Alerts":$.t("Events"),d=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",d);this.W99 instanceof TradingView.ESDStudyBase&&d.data("layout-tab-open",EditObjectDialog.TAB_OPEN_OVERRIDE);var h=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Scales")),c=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Scales")),p=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Scales")),u=$('<div class="property-page-column-2" style="min-width: 250px">').data("layout-tab",$.t("Background")),f=$('<div class="property-page-column-2" style="width: 170px">').data("layout-tab",$.t("Background")),g=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Drawings")),m=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Style")),_=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Style")),v=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Scales"));this._prepareSeriesStyleLayout(t,i,n,this._seriesProperty);var y=$('<input type="checkbox">'),w=this.addLabeledRow(m,"Price Line",y);$("<td>").append(y).prependTo(w);var b=TradingView.createLineWidthEditor();$("<td>").append(b).appendTo(w);var T=this.createSeriesMinTickEditor(),S=$("<tr>");S.appendTo(_),$("<td>"+$.t("Override Min Tick")+"</td>").appendTo(S),$("<td>").append(T).appendTo(S),this.bindControl(new D11(T,this._seriesProperty.minTick,null,!0,this.model(),"Change MinTick")),!this._alertSettingsIsVisible()&&!TradingView.D18("esdindicatorfeature")||W77.enabled("charting_library")||this.createEventsTable(d),this.bindControl(new D12(y,this._seriesProperty.showPriceLine,!0,this.model(),"Change Price Price Line")),this.bindControl(new SliderBinder(b,this._seriesProperty.priceLineWidth,!0,this.model(),"Change Price Line Width"));var y=$('<table class="property-page" cellspacing="0" cellpadding="2">'),C=this.createColorPicker(),b=this.createColorPicker(),T=TradingView.createLineStyleEditor(),S=TradingView.createTransparencyEditor(b),x=TradingView.createLineWidthEditor(),P=this.createColorPicker(),A=TradingView.createLineStyleEditor(),L=this.createColorPicker(),D=this.createColorPicker(),k=this.createColorPicker(),E=TradingView.createTransparencyEditor(k),w=this.addLabeledRow(y,"Background");$('<td colspan="4">').append(C).appendTo(w),this.bindControl(new ColorBinding(C,this._property.paneProperties.background,!0,this.model(),"Change Chart Background Color")),C=this.addLabeledRow(y,"Grid Lines"),$("<td>").append(P).appendTo(C),$('<td colspan="3">').append(A.render()).appendTo(C),this.bindControl(new ColorBinding(P,this._property.paneProperties.gridProperties.color,!0,this.model(),"Change Grid Lines Color")),this.bindControl(new D11(A,this._property.paneProperties.gridProperties.style,parseInt,!0,this.model(),"Change Grid Lines Style")),P=this.addLabeledRow(y,"Scales Text"),$('<td colspan="4">').append(L).appendTo(P),this.bindControl(new ColorBinding(L,this._property.scalesProperties.textColor,!0,this.model(),"Change Scales Text Color")),L=this.addLabeledRow(y,"Scales Lines"),$('<td colspan="4">').append(D).appendTo(L),this.bindControl(new ColorBinding(D,this._property.scalesProperties.lineColor,!0,this.model(),"Change Scales Lines Color")),D=this.addLabeledRow(y,"Watermark"),$("<td>").append(k).appendTo(D),$('<td colspan="3">').append(E).appendTo(D),this.bindControl(new ColorBinding(k,this._property.symbolWatermarkProperties.color,!0,this.model(),"Change Symbol Watermark Color")),this.bindControl(new SliderBinder(E,this._property.symbolWatermarkProperties.transparency,!0,this.model(),"Change Symbol Watermark Transparency")),k=this.addLabeledRow(y,"Crosshair"),$("<td>").append(b).appendTo(k),$("<td>").append(T.render()).appendTo(k),$("<td>").append(x).appendTo(this.addRow(y).prepend("<td/><td/>")),$("<td>").append(S).appendTo(this.addRow(y).prepend("<td/><td/>")),this.bindControl(new ColorBinding(b,this._property.paneProperties.crossHairProperties.color,!0,this.model(),"Change Crosshair Color")),this.bindControl(new D11(T,this._property.paneProperties.crossHairProperties.style,parseInt,!0,this.model(),"Change Crosshair Style")),this.bindControl(new SliderBinder(x,this._property.paneProperties.crossHairProperties.width,!0,this.model(),"Change Crosshair Width")),this.bindControl(new SliderBinder(S,this._property.paneProperties.crossHairProperties.transparency,!0,this.model(),"Change Crosshair Transparency")),b=$('<table class="property-page" cellspacing="0" cellpadding="2">'),T=$('<input type="checkbox">'),w=this.addLabeledRow(b,"Symbol Description",T),$("<td>").append(T).prependTo(w),this.bindControl(new D12(T,this._property.paneProperties.legendProperties.showSeriesTitle,!0,this.model(),"Change Symbol Description Visibility")),T=$('<input type="checkbox">'),w=this.addLabeledRow(b,"OHLC Values",T),$("<td>").append(T).prependTo(w),this.bindControl(new D12(T,this._property.paneProperties.legendProperties.showSeriesOHLC,!0,this.model(),"Change OHLC Values Visibility")),T=$('<input type="checkbox">'),w=this.addLabeledRow(b,"Indicator Titles",T),$("<td>").append(T).prependTo(w),this.bindControl(new D12(T,this._property.paneProperties.legendProperties.showStudyTitles,!0,this.model(),"Change Indicator Titles Visibility"));var V=$('<input type="checkbox">'),w=this.addLabeledRow(b,"Indicator Arguments",V);$("<td>").append(V).prependTo(w),this.bindControl(new D12(V,this._property.paneProperties.legendProperties.showStudyArguments,!0,this.model(),"Change Indicator Arguments Visibility")),T=$('<input type="checkbox">'),w=this.addLabeledRow(b,"Indicator Values",T),$("<td>").append(T).prependTo(w),this.bindControl(new D12(T,this._property.paneProperties.legendProperties.showStudyValues,!0,this.model(),"Change Indicator Values Visibility")),T=function(e){V.prop("disabled",!e.value())},this._property.paneProperties.legendProperties.showStudyTitles.listeners().subscribe(this,T),T(this._property.paneProperties.legendProperties.showStudyTitles),T=$('<input type="checkbox">'),S=$('<input type="checkbox">'),x=$('<input type="checkbox">'),x.change(function(){this.checked&&setTimeout(function(){e.D0.m_model.D20(new A22(A22.LIGHT_UPDATE))},0)}),k=$('<input type="checkbox">'),k.change(function(){this.checked&&setTimeout(function(){e.D0.m_model.D20(new A22(A22.LIGHT_UPDATE))},0)});var I,M=$("<input type='checkbox'>"),E=$("<input type='checkbox' />"),D=$("<input type='checkbox' />"),L=$('<input type="checkbox">'),P=$('<input type="checkbox">'),A=$("<input type='checkbox' />"),C=$("<input type='checkbox' />");this._pane&&(this._pane.leftPriceScale().D19().contains(this._series)?I="left":this._pane.rightPriceScale().D19().contains(this._series)?I="right":this._pane.isOverlay(this._series)&&(I="none")),I&&(w={left:$.t("Scale Left"),right:$.t("Scale Right")},e._pane.actionNoScaleIsEnabled(e._series)&&(w.none=$.t("Screen (No Scale)")),I=this.createKeyCombo(w).val(I).change(function(){switch(this.value){case"left":e.D0.move(e._series,e._pane,e._pane.leftPriceScale());break;case"right":e.D0.move(e._series,e._pane,e._pane.rightPriceScale());break;case"none":e.D0.move(e._series,e._pane,null)}}),w=this.addRow(p),$("<td>").appendTo(w).append(I)),this.bindControl(new D12(M,this._seriesProperty.showCountdown,!0,this.model(),"Change Show Countdown")),w=this.addLabeledRow(c,"Auto Scale",x),$("<td>").append(x).prependTo(w),w=this.addLabeledRow(c,"Percentage",T),$("<td>").append(T).prependTo(w),w=this.addLabeledRow(c,"Log Scale",S),$("<td>").append(S).prependTo(w),w=this.addLabeledRow(c,"Scale Series Only",k),$("<td>").append(k).prependTo(w),w=this.addLabeledRow(h,"Show Left Axis",E),$("<td>").append(E).prependTo(w),w=this.addLabeledRow(h,"Show Right Axis",D),$("<td>").append(D).prependTo(w),W77.enabled("countdown")&&(w=this.addLabeledRow(h,"Show Countdown",M),$("<td>").append(M).prependTo(w)),w=this.addLabeledRow(h,"Symbol Last Value",L),$("<td>").append(L).prependTo(w),w=this.addLabeledRow(h,"Indicator Last Value",P),$("<td>").append(P).prependTo(w),w=this.addLabeledRow(h,"Show Symbol Labels",A),$("<td>").append(A).prependTo(w),w=this.addLabeledRow(h,"Precise Labels",C),$("<td>").append(C).prependTo(w),w=$("<tr>").appendTo(l),I=$("<td>").appendTo(w),I=$('<table cellspacing="0" cellpadding="0">').appendTo(I),w=$(document.createElement("tr")),w.appendTo(I),I=$(document.createElement("td")),I.appendTo(w),I.text($.t("Time Zone")),I=$(document.createElement("td")).attr("colspan",2),I.appendTo(w);for(var W,w="",M=0;M<TradingView.availableTimezones.length;M++)w+='<option value="'+TradingView.availableTimezones[M].id+'">'+TradingView.availableTimezones[M].title+"</option>";w=$("<select>"+w+"</select>").change(function(){var t=$(this).val();W||(W=setTimeout(function(){e._chart._chartApi.switchTimezone(t),W=!1},300))}),w.appendTo(I),this.bindControl(new D11(w,this._property.timezone,null,!0,this.model(),"Change Timezone")),W77.enabled("charting_library")||(this._series.createSessStudy(),this.createSessTable(l)),I=null,W77.enabled("trading_options")&&TradingView.D18("paper_trading")&&(I=this.createTradingTable());var M=$("<input type='checkbox'/>"),R=this.addLabeledRow(c,"Lock scale",M);$("<td>").append(M).prependTo(R),this._seriesProperty.style.listeners().subscribe(this,function(e){R.toggle(e.value()==TradingView.Series.STYLE_PNF)});var B=$('<input type="text" class="ticker">'),w=this.addLabeledRow(v,"Top Margin",B);$("<td>").appendTo(w).append(B),$("<td>%</td>").appendTo(w),w=[ToIntTransformer(this._property.paneProperties.topMargin.value())],w.push(LessTransformer(25)),w.push(GreateTransformer(0)),this.bindControl(new SimpleStringBinder(B,this._property.paneProperties.topMargin,w,!0,this.model(),"Top Margin")),B=$('<input type="text" class="ticker">'),w=this.addLabeledRow(v,"Bottom Margin",B),$("<td>").appendTo(w).append(B),$("<td>%</td>").appendTo(w),w=[ToIntTransformer(this._property.paneProperties.bottomMargin.value())],w.push(LessTransformer(25)),w.push(GreateTransformer(0)),this.bindControl(new SimpleStringBinder(B,this._property.paneProperties.bottomMargin,w,!0,this.model(),"Bottom Margin")),B=$('<input type="text" class="ticker">'),w=this.addLabeledRow(v,"Right Margin",B),$("<td>").appendTo(w).append(B),$("<td>"+$.t("bars",{context:"margin"})+"</td>").appendTo(w),w=[ToIntTransformer(this._property.timeScale.rightOffset.value())],w.push(LessTransformer(~~this._chart.m_timeScale.maxOffset())),w.push(GreateTransformer(-200)),this.bindControl(new SimpleStringBinder(B,this._property.timeScale.rightOffset,w,!0,this.model(),"Right Margin")),this.bindControl(new D12(E,this._property.scalesProperties.showLeftScale,!0,this.model(),"Show Left Axis")),this.bindControl(new D12(D,this._property.scalesProperties.showRightScale,!0,this.model(),"Show Right Axis")),this.bindControl(new D12(A,this._scaleProperty.showSymbolLabels,!0,this.model(),"Show Symbol Labels")),this.bindControl(new D12(C,this._scaleProperty.alignLabels,!0,this.model(),"Precise Labels")),this.bindControl(new D12(x,this._scaleProperty.autoScale,!0,this.model(),"Auto Scale",function(t){this._undoModel.setAutoScaleProperty(this._property,t,e._series.priceScale(),this._undoText)})),this.bindControl(new DisabledBinder(x,this._scaleProperty.autoScaleDisabled,!0,this.model(),"Auto Scale")),this.bindControl(new D12(k,this._property.scalesProperties.scaleSeriesOnly,!0,this.model(),"Scale Series Only")),this.bindControl(new D12(T,this._mainAxisProperty.percentage,!0,this.model(),"Scale Percentage",function(t){this._undoModel.setPercentProperty(this._property,t,e._series.priceScale(),this._undoText)})),this.bindControl(new DisabledBinder(T,this._mainAxisProperty.percentageDisabled,!0,this.model(),"Scale Percentage")),this.bindControl(new D12(S,this._mainAxisProperty.log,!0,this.model(),"Log Scale",function(t){this._undoModel.setLogProperty(this._property,t,e._series.priceScale(),this._undoText)})),this.bindControl(new DisabledBinder(S,this._mainAxisProperty.logDisabled,!0,this.model(),"Log Scale")),this.bindControl(new D12(L,this._property.scalesProperties.showSeriesLastValue,!0,this.model(),"Change Symbol Last Value Visibility")),this.bindControl(new D12(P,this._property.scalesProperties.showStudyLastValue,!0,this.model(),"Change Indicator Last Value Visibility")),this.bindControl(new D12(M,this._seriesProperty.lockScale,!0,this.model(),"Change lock scale",function(t){this._undoModel.setLockScaleProperty(this._property,t,e._series,this._undoText)})),this._table=this._table=t.add(i).add(n).add(o).add(r).add(m).add(_).add(s).add(a).add(u).add(f).add(g).add(l).add(I).add(d),a.append(p),a.append(h),s.append(c),s.append(v),u.append(y),f.append(b),this.loadData()},A85.prototype.widget=function(){return this._table},A85.prototype.loadData=function(){this.superclass.prototype.loadData.call(this),this.switchStyle()},A85.prototype.loadTheme=function(e){var t=this;$.get("/theme/?themeName="+encodeURIComponent(e),function(i){t.D0._lastLoadedTheme=e,t.applyTheme(JSON.parse(i.content))})},A85.prototype.applyTheme=function(e){var t=this._seriesProperty.extendedHours.value();this.D0.model().restoreTheme(e),this._seriesProperty.extendedHours.value()!==t&&this._seriesProperty.extendedHours.listeners().fire(this._seriesProperty.extendedHours),this.loadData()},A85.prototype.createTemplateButton=function(e){if(W77.enabled("charting_library"))return $("<span />");var t=this;e||(e={});var i=function(){var i=[];i.push({title:"Save As...",action:function(){runOrSignIn(function(){TradingView.showChartNameDialog(function(e){if(e){var i={name:e,content:JSON.stringify(t.D0.model().theme())};$.post("/save-theme/",i).error(function(e){document.write(e.responseText)}),t._themes.push(e),t.D0._lastLoadedTheme=e}},"Save theme as...","Theme name")},!0)},addClass:"special"}),"function"==typeof e.defaultsCallback&&i.push({title:"Apply Defaults",action:e.defaultsCallback,addClass:"special"});var n=[];return $.each(t._themes,function(e,i){n.push({title:i,action:function(){t.loadTheme(i)},deleteAction:is_authenticated?function(){var e=this;A83.showConfirm("Theme","Do you realy want to delete "+(i?'"'+i+'"':"")+" theme?",function(){e instanceof $&&e.remove(),$.post("/remove-theme/",{name:i}).error(function(e){console.error(e.responseText)}),TradingView.getThemesList.D20();for(var n=t._themes.length;n--;)t._themes[n]==i&&t._themes.splice(n,1)})}:void 0})}),n.length&&(n.sort(function(e,t){return e=e.title.toUpperCase(),t=t.title.toUpperCase(),e==t?0:e>t?1:-1}),i.push({separator:!0}),i=i.concat(n)),i},n=$('<a href="#" class="tv-button">'+$.t("Themes")+'<span class="icon-dropdown"></span></a>');return TradingView.bindPopupMenu(n,null,{direction:"up",event:"button-popup",notCloseOnButtons:!0}),n.bind("click",function(){var e=$(this);e.is(".active")||TradingView.getThemesList(function(n){t._themes=n,e.trigger("button-popup",[i(),!0])})}),n},A85.prototype.switchStyle=function(){switch(toggledTbodies=$(this._barsTbody).add(this._barsColorerTbody).add(this._renkoTbody).add(this._pbTbody).add(this._kagiTbody).add(this._pnfTbody).add(this._candlesTbody).add(this._candlesColorerTbody).add(this._hollowCandlesTbody).add(this._lineTbody).add(this._areaTbody).add(this._haTbody).add(this._haColorerTbody).css("display","none"),this._seriesProperty.style.value()){case TradingView.Series.STYLE_BARS:this._barsTbody.css("display","table-row-group"),this._barsColorerTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_CANDLES:this._candlesTbody.css("display","table-row-group"),this._candlesColorerTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_HOLLOW_CANDLES:this._hollowCandlesTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_LINE:this._lineTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_AREA:this._areaTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_RENKO:this._renkoTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_PB:this._pbTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_KAGI:this._kagiTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_PNF:this._pnfTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_HEIKEN_ASHI:this._haTbody.css("display","table-row-group"),this._haColorerTbody.css("display","table-row-group")}},A85.prototype.onResoreDefaults=function(){var e=this.D0.model().properties().paneProperties.topMargin,t=this.D0.model().properties().paneProperties.bottomMargin;e.listeners().fire(e),t.listeners().fire(t),TradingView.bottomWidgetBar&&(A77.setWatchedValue(TradingView.bottomWidgetBar.hideFloatingPanel,!1,"Restore Defaults"),A77.setWatchedValue(TradingView.bottomWidgetBar.hideCompletedOrders,!1,"Restore Defaults"),A77.setWatchedValue(TradingView.bottomWidgetBar.noConfirmEnabled,!1,"Restore Defaults"))},A85.prototype.defaultProperties=function(){var e=this,t=[e._seriesProperty.extendedHours,e._property.scalesProperties.showLeftScale,e._property.scalesProperties.showRightScale,e._property.timeScale.rightOffset].map(function(e){return{property:e,previousValue:e.value()}});return setTimeout(function(){t.forEach(function(e){e.property.value()!==e.previousValue&&e.property.listeners().fire(e.property)});var i=new $52("chartproperties.paneProperties.rightAxisProperties");$.each(["autoScale","percentage","log"],function(t,n){var o=e._scaleProperty[n],r=i[n].value();r!==o.value()&&o.setValue(r)})},0),[this._property,this._seriesProperty]},A85.prototype._alertSettingsIsVisible=function(){return TradingView.D18("alerts")&&!TradingView.onWidget()&&!W77.enabled("charting_library")},A85.prototype.createEventsTable=function(e){if(TradingView.D18("esdindicatorfeature")){var t=$("<tr>").appendTo(e),i=$('<input type="checkbox" />'),n=this.addLabeledRow(t,"Show Dividends on Chart",i);$("<td>").append(i).prependTo(n),n.append("<td>"),this.bindControl(new D12(i,this._seriesProperty.esdShowDividends,!0,this.model(),"Change Show or Hide Dividends")),i=$('<input type="checkbox" />'),n=this.addLabeledRow(t,"Show Splits on Chart",i),$("<td>").append(i).prependTo(n),n.append("<td>"),this.bindControl(new D12(i,this._seriesProperty.esdShowSplits,!0,this.model(),"Change Show or Hide Splits")),i=$('<input type="checkbox" />'),n=this.addLabeledRow(t,"Show Earnings on Chart",i),$("<td>").append(i).prependTo(n),n.append("<td>"),this.bindControl(new D12(i,this._seriesProperty.esdShowEarnings,!0,this.model(),"Change Show or Hide Earnings"));var n=this.createTableInTable(e),o=$('<input type="checkbox" />'),t=TradingView.createLineStyleEditor(),i=TradingView.addColorPicker(),r=TradingView.createLineWidthEditor(),n=this.addLabeledRow(n,"Earnings breaks",o);$("<td>").append(o).prependTo(n),$("<td>").append(i).appendTo(n),$("<td>").append(t.render()).appendTo(n),$("<td>").append(r).appendTo(n),n.addClass("offset-row"),n.append("<td>"),this.bindControl(new D12(o,this._seriesProperty.esdShowBreaks,!0,this.model(),"Change Show or Hide Earnings")),this.bindControl(new ColorBinding(i,this._seriesProperty.esdBreaksStyle.color,!0,this.model(),"Change earnings color")),this.bindControl(new D11(t,this._seriesProperty.esdBreaksStyle.style,parseInt,!0,this.model(),"Change style")),this.bindControl(new SliderBinder(r,this._seriesProperty.esdBreaksStyle.width,!0,this.model(),"Change width")),this._seriesProperty.esdShowEarnings.listeners().subscribe(this,function(e){o.prop("disabled",!e.value())})}if(this._alertSettingsIsVisible()){n=$("<tr>").appendTo(e),t=$('<input type="checkbox" />'),n=this.addLabeledRow(n,"Show Alert Labels",t),$("<td>").append(t).prependTo(n),n.append("<td>");var s=this._property.alertsProperties.labels.visible;this.bindControl(new D12(t,s,!0,this.model(),"Change Show or Hide Alert Labels",function(e){this.D0.beginUndoMacro("Show Alert Labels"),this.D0.setProperty(s,e,"Show  Alert Labels"),this.D0.endUndoMacro()}.bind(this)));var n=this.createTableInTable(e),a=$('<input type="checkbox">');e=TradingView.addColorPicker();var l=TradingView.createLineWidthEditor(),t=TradingView.createLineStyleEditor(),d=t.render(),n=this.addLabeledRow(n,"Extended Alert Line",a);$("<td>").append(a).prependTo(n),$("<td>").append(e).appendTo(n),$("<td>").append(d).appendTo(n),$("<td>").append(l).appendTo(n),n.addClass("offset-row"),n.append("<td>"),this.bindControl(new D12(a,this._property.alertsProperties.labels.line.visible,!0,this.model(),"Change Show or Hide Alert Labels Lines")),this.bindControl(new ColorBinding(e,this._property.alertsProperties.labels.color,!0,this.model(),"Change Alerts Labels color")),this.bindControl(new D11(t,this._property.alertsProperties.labels.line.style,parseInt,!0,this.model(),"Change style")),this.bindControl(new SliderBinder(l,this._property.alertsProperties.labels.line.width,!0,this.model(),"Change width")),s.listeners().subscribe(this,function(e){a.prop("disabled",!e.value()),d.prop("disabled",!e.value()),l.prop("disabled",!e.value())})}},A85.prototype.createSessTable=function(e){var t=this._series.sessionsStudy().properties(),i=this.createTableInTable(e),n=t.name.value(),o=$("<input type='checkbox' />"),i=this.addLabeledRow(i,"Session Breaks",o),r=TradingView.createLineStyleEditor(),s=TradingView.addColorPicker(),a=TradingView.createLineWidthEditor();$("<td>").append(o).prependTo(i),$("<td>").append(s).appendTo(i),$("<td>").append(r.render()).appendTo(i),$("<td>").append(a).appendTo(i),this.bindControl(new D12(o,t.graphics.vertlines.sessBreaks.visible,!0,this.model(),"Change "+n+" visibility")),this.bindControl(new ColorBinding(s,t.graphics.vertlines.sessBreaks.color,!0,this.model(),"Change "+n+" color")),this.bindControl(new D11(r,t.graphics.vertlines.sessBreaks.style,parseInt,!0,this.model(),"Change "+n+" style")),this.bindControl(new SliderBinder(a,t.graphics.vertlines.sessBreaks.width,!0,this.model(),"Change "+n+" width")),i=this.createTableInTable(e),n=this._extendedHoursEditor=$('<input type="checkbox" />'),i=this.addLabeledRow(i,"Extended Hours (Intraday Only)",n),$("<td>").append(n).prependTo(i),this.bindControl(new D12(n,this._seriesProperty.extendedHours,!0,this.model(),"Change Extended Hours")),this._seriesProperty.sessVis=t.graphics.vertlines.sessBreaks.visible;var i=this.createTableInTable(e),l=this._createStudySessRow(i,"Extended Hours",t.graphics.backgrounds.outOfSession),d=this._createStudySessRow(i,"In Session",t.graphics.backgrounds.inSession);return e=function(e){l.prop("disabled",!e.value()),d.prop("disabled",!e.value())},this._seriesProperty.extendedHours.listeners().subscribe(this,e),e(this._seriesProperty.extendedHours),e=this._series.isIntradayInterval(),o.prop("disabled",!e),i},A85.prototype._createStudySessRow=function(e,t,i){var n=$("<input type='checkbox' />");e=this.addLabeledRow(e,t,n);var o=TradingView.addColorPicker($("<td>").appendTo(e)),r=TradingView.createTransparencyEditor(o);return this.bindControl(new D12(n,i.visible,!0,this.model(),"Change "+t+" visibility")),this.bindControl(new ColorBinding(o,i.color,!0,this.model(),t+" color")),this.bindControl(new SliderBinder(r,i.transparency,!0,this.model(),t+" transparency")),$("<td>").append(n).prependTo(e),e.addClass("offset-row"),$("<td>").append(r).appendTo(e),n},A85.prototype.createTradingTable=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab",$.t("Trading")),t=$("<tr>").appendTo(e),i=$("<td>").appendTo(t),i=$('<table cellspacing="0" cellpadding="0">').appendTo(i),n=$('<input type="checkbox">'),t=this.addLabeledRow(i,$.t("Show Positions"),n);$("<td>").append(n).prependTo(t),this.bindControl(new D12(n,this._property.tradingProperties.showPositions,!0,this.model(),"Change Positions Visibility")),n=$('<input type="checkbox">'),t=this.addLabeledRow(i,$.t("Show Orders"),n),$("<td>").append(n).prependTo(t),this.bindControl(new D12(n,this._property.tradingProperties.showOrders,!0,this.model(),"Change Orders Visibility")),t=$('<input type="checkbox">'),n=this.addLabeledRow(i,$.t("Extend Lines Left"),t),$("<td>").append(t).prependTo(n),this.bindControl(new D12(t,this._property.tradingProperties.extendLeft,!0,this.model(),"Extend Lines Left")),t=TradingView.createLineWidthEditor(),this.bindControl(new SliderBinder(t,this._property.tradingProperties.lineWidth,!0,this.model(),"Change Connecting Line Width")),n=TradingView.createLineStyleEditor(),this.bindControl(new D11(n,this._property.tradingProperties.lineStyle,parseInt,!0,this.model(),"Change Connecting Line Style"));var o=$('<input type="text" class="ticker">'),r=[ToIntTransformer(this._property.tradingProperties.lineLength.value()),LessTransformer(100),GreateTransformer(0)];return this.bindControl(new SimpleStringBinder(o,this._property.tradingProperties.lineLength,r,!0,this.model(),"Change Connecting Line Length")),r=$("<tbody>"),r=this.addLabeledRow(i,$.t("Connecting Line"),r),$("<td>").prependTo(r),$("<td>").append(t).appendTo(r),$('<td colspan="3">').append(n.render()).appendTo(r),$('<td colspan="3">').append(o).appendTo(r),$("<td>%</td>").appendTo(r),t=$('<input type="checkbox">'),n=this.addLabeledRow(i,$.t("Show Executions"),t),$("<td>").append(t).prependTo(n),this.bindControl(new D12(t,this._property.tradingProperties.showExecutions,!0,this.model(),"Change Executions Visibility")),TradingView.bottomWidgetBar&&(t=$('<input type="checkbox">'),n=this.addLabeledRow(i,$.t("Show Buy/Sell Panel"),t),$("<td>").append(t).prependTo(n),this.bindControl(new CheckboxWVBinding(t,TradingView.bottomWidgetBar.hideFloatingPanel,null,"Change buy/sell panel visibility",!0)),t=$('<input type="checkbox">'),n=this.addLabeledRow(i,$.t("Show Active Orders Only"),t),$("<td>").append(t).prependTo(n),this.bindControl(new CheckboxWVBinding(t,TradingView.bottomWidgetBar.hideCompletedOrders,null,"Change completed orders visibility")),t=$('<input type="checkbox">'),i=this.addLabeledRow(i,$.t("Require Order Confirmation"),t),$("<td>").append(t).prependTo(i),this.bindControl(new CheckboxWVBinding(t,TradingView.bottomWidgetBar.noConfirmEnabled,null,"Change order confirmation state",!0))),e},inherit($38,D7),$38.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=this.createKeyCombo({open:$.t("Open"),high:$.t("High"),low:$.t("Low"),close:$.t("Close")}),t=this.addLabeledRow(this._table,$.t("Source",{context:"compare"}));$("<td>").appendTo(t).append(e),this.bindControl(new D11(e,this._property.inputs.source,null,!0,this.model(),"Change Price Source")),this.loadData()},$38.prototype.widget=function(){return this._table},TradingView.SoundSelector=function(e){e.container||console.error("[SoundSelector] options.container is required"),e=$.extend(this.defaultOptions(),e),this.fileName=new WatchedValue(e.fileName),this.duration=new WatchedValue(e.duration),this._$container=e.container,this._$durationContainer=e.durationContainer,this._onChange=e.onChange||function(){console.warn("[SoundSelector] 'onChange' callback is not defined")},this._options=e,this._nowPlaying=null,this._attachHandlers(),this._render()},TradingView.SoundSelector.prototype.soundList=function(){return this._soundListArray||(this._soundListArray=$.map(TradingView.Sound.alertSounds(),function(e){return{fileName:e.path,title:e.title}})),this._soundListArray},TradingView.SoundSelector.prototype.defaultOptions=function(){return{fileName:this.soundList()[0].fileName,duration:""}},TradingView.SoundSelector.prototype._attachHandlers=function(){var e=this;e.fileName.subscribe(function(t){e._onChange(t,e.duration.value()),e._$button.find(".title").text(e._fileName2title(t))}),e.duration.subscribe(function(t){e._onChange(e.fileName.value(),t)})},TradingView.SoundSelector.prototype._render=function(){var e=this;if(e._$container.empty(),e._$button=$('<a class="tv-button with-arrow"><span class="title">'+e._fileName2title(e.fileName.value())+'</span><span class="icon-dropdown"></span></a>'),e._$button.appendTo(e._$container),TradingView.bindPopupMenu(e._$button,function(){return $.map(e.soundList(),function(t){var i=$('<span class="manage-sound-button"></span>'),n=function(){var n=!!TradingView.Sound.isPlaying(t.fileName);i.toggleClass("stop",n),i.toggleClass("play",!n),e._nowPlaying=n?t.fileName:null};return n(),TradingView.Sound.isPlaying(t.fileName)&&TradingView.Sound.onStopped(t.fileName,n),{title:t.title,action:function(){e.fileName.setValue(t.fileName)},active:t.fileName===e.fileName.value(),buttons:[{el:i,handler:function(o){o.stopPropagation(),i.hasClass("play")?(TradingView.Sound.stop(),TradingView.Sound.play(t.fileName,!1,e.duration.value()),TradingView.Sound.onStopped(t.fileName,n)):i.hasClass("stop")&&TradingView.Sound.stop(t.fileName),n()}}]}})},{direction:"down",addClass:"sound-selector"}),e._$durationContainer){e._$durationContainer.empty();var t=$('<select><option value="0">Once</option><option value="5">5 seconds</option><option value="10">10 seconds</option><option value="30">30 seconds</option><option value="60">1 minute</option></select>');
t.change(function(){var i=parseInt(t.val());e.duration.setValue(i)}),t.appendTo(e._$durationContainer),t.val(e.duration.value()||0)}},TradingView.SoundSelector.prototype._fileName2title=function(e){for(var t=this.soundList(),i=0;i<t.length;i++)if(t[i].fileName===e)return t[i].title},TradingView.SoundSelector.prototype.destroy=function(){var e=this;e.fileName.unsubscribe(function(t){e._onChange({fileName:t})}),e.duration.unsubscribe(function(t){e._onChange({duration:t})}),TradingView.unbindPopupMenu(e._$button),e._nowPlaying&&TradingView.Sound.stop(e._nowPlaying)},TradingView.LabelsImageCache=function(e,t,i,n){this._cacheSize=50,this._labelsWidth=n,this._fontSize=i,this._canvas=$("<canvas>").attr("width",n).attr("height",(i+2)*this._cacheSize),this._ctx=this._canvas.get(0).getContext("2d"),this._ctx.font=e,this._ctx.textBaseline="bottom",this._ctx.fillStyle=t,this._labelsMap={},this._actualSize=this._usageCounter=0,this._indexTolabelCache={}},TradingView.LabelsImageCache.prototype.reset=function(e){this._ctx.clearRect(0,0,this._labelsWidth,(this._fontSize+2)*this._cacheSize),this._ctx.fillStyle=e,this._indexTolabelCache={},this._labelsMap={}},TradingView.LabelsImageCache.prototype.paintTo=function(e,t,i,n,o){t=this.getLabelImage(t),"left"==o?e.drawImage(this._canvas.get(0),0,t.y,this._labelsWidth,this._fontSize+2,i,Math.ceil(n-(this._fontSize+2)/2),this._labelsWidth,this._fontSize+2):e.drawImage(this._canvas.get(0),0,t.y,this._labelsWidth,this._fontSize+2,i-t.width,Math.ceil(n-(this._fontSize+2)/2),this._labelsWidth,this._fontSize+2)},TradingView.LabelsImageCache.prototype.getLabelImage=function(e){if(this._labelsMap[e])this._labelsMap[e].accessTimestamp=this._usageCounter;else{if(this._actualSize<this._cacheSize){for(var t=0;t<this._cacheSize;t++)if(!this._indexTolabelCache[t]){this._indexTolabelCache[t]=e,this._actualSize++;var i=t*(this._fontSize+2);this._ctx.clearRect(0,i,this._labelsWidth,this._fontSize+2),this._ctx.fillText(e,0,i+(this._fontSize+2));var n=this._ctx.measureText(e).width;return this._labelsMap[e]={y:i,accessTimestamp:this._usageCounter,index:t,width:n},this._usageCounter++,this._labelsMap[e]}throw"internal LabelsImageCache failure"}t=1e6,n="";for(i in this._labelsMap){var o=this._labelsMap[i].accessTimestamp;t>o&&(t=o,n=i)}t=this._labelsMap[n],delete this._labelsMap[n],this._indexTolabelCache[t.index]=e,this._ctx.clearRect(0,t.y,this._labelsWidth,this._fontSize+2),this._ctx.fillText(e,0,t.y+(this._fontSize+2)),n=this._ctx.measureText(e).width,this._labelsMap[e]={y:t.y,accessTimestamp:this._usageCounter,index:t.index,width:n}}return this._usageCounter++,this._labelsMap[e]},inherit($14,D7),$14.prototype._createPointRow=function(e,t,i){e=$("<tr>");var n=$("<td>");n.html($.t("Price")+i),n.appendTo(e),n=$("<td>"),n.appendTo(e),i=$("<input type='text'>"),i.appendTo(n),n=$("<td>"),n.html($.t("Bar #")),n.appendTo(e),barEditCell=$("<td>"),barEditCell.appendTo(e),n=$("<input type='text'>"),n.appendTo(barEditCell),n.addClass("ticker");var o=[ToFloatTransformer(t.price.value())];return this.bindControl(new SimpleStringBinder(i,t.price,o,!1,this.model(),"Change "+this._linetool+" point price")),o=[ToIntTransformer(t.bar.value()),GreateTransformer(-5e4),LessTransformer(15e3)],this.bindControl(new SimpleStringBinder(n,t.bar,o,!1,this.model(),"Change "+this._linetool+" point bar index")),e},$14.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");for(var e=this._linetool.points(),t=e.size(),i=0;i<e.size();i++){var n=e.item(i),o=this._linetool.properties().points[i];o&&this._createPointRow(n,o,(i||t>1?" "+(i+1):"")+"").appendTo(this._table)}this.loadData()},$14.prototype.widget=function(){return this._table},inherit(A91,$49),A91.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=$("<tbody>").appendTo(this._table),t=this.createColorPicker(),i=this.addLabeledRow(e,"Color");$("<td>").append(t).appendTo(i);var n=$('<select><option value="0">'+$.t("Bars")+'</option><option value="1">'+$.t("Line")+"</option></select>"),i=this.addLabeledRow(e,"Mode");$("<td>").append(n).appendTo(i),i=$("<tr>").appendTo(e),$("<td>"+$.t("Mirrored")+"</td>").appendTo(i);var o=$("<input type='checkbox'>");$("<td>").append(o).appendTo(i),i=$("<tr>").appendTo(e),$("<td>"+$.t("Flipped")+"</td>").appendTo(i),e=$("<input type='checkbox'>"),$("<td>").append(e).appendTo(i),this.bindControl(new D12(o,this._linetool.properties().mirrored,!0,this.model(),"Change Bars Pattern Mirroring")),this.bindControl(new D12(e,this._linetool.properties().flipped,!0,this.model(),"Change Bars Pattern Flipping")),this.bindControl(new ColorBinding(t,this._linetool.properties().color,!0,this.model(),"Change Bars Pattern Color")),this.bindControl(new D11(n,this._linetool.properties().mode,null,!0,this.model(),"Change Bars Pattern Mode")),this.loadData()},A91.prototype.widget=function(){return this._table},inherit(A90,$14),A90.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this._linetool.points().item(0);var e=$("<tr>");e.appendTo(this._table);var t=$("<td>");t.html($.t("Price")),t.appendTo(e);var i=$("<td>");i.appendTo(e),t=$("<input type='text'>"),t.appendTo(i),i=$("<td>"),i.html($.t("Bar #")),i.appendTo(e),barEditCell=$("<td>"),barEditCell.appendTo(e),e=$("<input type='text'>"),e.appendTo(barEditCell),e.addClass("ticker");var i=this._linetool.properties().points[0],n=[ToFloatTransformer(i.price.value())];this.bindControl(new SimpleStringBinder(t,i.price,n,!1,this.model(),"Change "+this._linetool+" point price")),n=[ToIntTransformer(i.bar.value()),GreateTransformer(-5e3),LessTransformer(15e3)],this.bindControl(new SimpleStringBinder(e,i.bar,n,!1,this.model(),"Change "+this._linetool+" point bar index")),this.loadData()},inherit(A93,$49),A93.prototype.prepareLayout=function(){var e=this.createColorPicker(),t=this.createFontSizeEditor(),i=this.createFontEditor(),n=this.createTextEditor(350,200),o=this.createColorPicker(),r=TradingView.createTransparencyEditor(o),s=TradingView.createLineWidthEditor(),a=this.createColorPicker(),l=$('<input type="checkbox">'),d=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),h=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');this.bindControl(new ColorBinding(e,this._linetool.properties().color,!0,this.model(),"Change Text Color")),this.bindControl(new D11(t,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(i,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new SimpleStringBinder(n,this._linetool.properties().text,null,!0,this.model(),"Change Text")),this.bindControl(new ColorBinding(o,this._linetool.properties().backgroundColor,!0,this.model(),"Change Text Background")),this.bindControl(new SliderBinder(r,this._linetool.properties().transparency,!0,this.model(),"Change Text Background Transparency")),this.bindControl(new ColorBinding(a,this._linetool.properties().bordercolor,!0,this.model(),"Change Text Color")),this.bindControl(new SliderBinder(s,this._linetool.properties().linewidth,!0,this.model(),"Change Border Width")),this.bindControl(new D12(l,this._linetool.properties().wordWrap,!0,this.model(),"Change Text Wrap")),this.bindControl(new D12(d,this._linetool.properties().bold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(h,this._linetool.properties().italic,!0,this.model(),"Change Text Font Italic"));var c=$('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab-open",EditObjectDialog.TAB_OPEN_OVERRIDE),p=$('<table class="property-page" cellspacing="0" cellpadding="2">'),u=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._table=c.add(u).add(p),$(document.createElement("tr")).append($(document.createElement("td")).attr({width:1}).append(e)).append($(document.createElement("td")).attr({width:1}).append(i)).append($(document.createElement("td")).attr({width:1}).append(t)).append($(document.createElement("td")).attr({width:1}).append(d)).append($(document.createElement("td")).append(h)).appendTo(c),$(document.createElement("tr")).append($(document.createElement("td")).attr({colspan:5}).append(n)).appendTo(c),e=this.addLabeledRow(p,"Text Wrap",l),$("<td>").append(l).prependTo(e),e=this.addLabeledRow(u,"Background"),$("<td>").append(o).appendTo(e),$("<td>").append(r).appendTo(e),e=this.addLabeledRow(u,"Border"),$("<td>").append(a).appendTo(e),$("<td>").append(s).appendTo(e),this.loadData(),setTimeout(function(){n.select(),n.focus()},20)},A93.prototype.widget=function(){return this._table},inherit($32,$49),$32.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),e=this.addLabeledRow(e,$.t("Line"));$("<td>").append(n).appendTo(e),$("<td>").append(t).appendTo(e),$('<td colspan="3">').append(i.render()).appendTo(e);var o=$("<tbody>").appendTo(this._table),r=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),s=$('<input type="checkbox">').appendTo(r),a=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),l=$('<input type="checkbox">').appendTo(a),d=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),h=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),e=this.addLabeledRow(o,$.t("Left End"));$('<td colspan="3">').appendTo(e).append(d).append(r),e=this.addLabeledRow(o,$.t("Right End")),$('<td colspan="3">').appendTo(e).append(h).append(a),e=this.addLabeledRow(o,$.t("Stats Text Color")),r=this.createColorPicker(),$("<td>").append(r).appendTo(e),this.bindControl(new ColorBinding(r,this._linetool.properties().textcolor,!0,this.model(),$.t("Change Text Color"))),r=$('<input type="checkbox">'),$('<input type="checkbox">');var a=$('<input type="checkbox">'),c=$('<input type="checkbox">'),p=$('<input type="checkbox">'),u=$('<input type="checkbox">'),f=$('<input type="checkbox">'),e=this.addLabeledRow(o,$.t("Show Price Range"));$('<td colspan="3">').appendTo(e).append(r),e=this.addLabeledRow(o,$.t("Show Bars Range")),$('<td colspan="3">').appendTo(e).append(a),e=this.addLabeledRow(o,$.t("Show Date/Time Range")),$('<td colspan="3">').appendTo(e).append(c),e=this.addLabeledRow(o,$.t("Show Distance")),$('<td colspan="3">').appendTo(e).append(p),e=this.addLabeledRow(o,$.t("Show Angle")),$('<td colspan="3">').appendTo(e).append(u),e=this.addLabeledRow(o,$.t("Always Show Stats")),$('<td colspan="3">').appendTo(e).append(f),this.bindControl(new D12(s,this._linetool.properties().extendLeft,!0,this.model(),$.t("Change Trend Line Extending Left"))),this.bindControl(new D12(l,this._linetool.properties().extendRight,!0,this.model(),$.t("Change Trend Line Extending Right"))),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),$.t("Change Trend Line Color"))),this.bindControl(new D11(i,this._linetool.properties().linestyle,parseInt,!0,this.model(),$.t("Change Trend Line Style"))),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),$.t("Change Trend Line Width"))),this.bindControl(new D11(d,this._linetool.properties().leftEnd,parseInt,!0,this.model(),$.t("Change Trend Line Left End"))),this.bindControl(new D11(h,this._linetool.properties().rightEnd,parseInt,!0,this.model(),$.t("Change Trend Line Right End"))),this.bindControl(new D12(r,this._linetool.properties().showPriceRange,!0,this.model(),$.t("Change Trend Line Show Price Range"))),this.bindControl(new D12(a,this._linetool.properties().showBarsRange,!0,this.model(),$.t("Change Trend Line Show Bars Range"))),this.bindControl(new D12(c,this._linetool.properties().showDateTimeRange,!0,this.model(),$.t("Change Trend Line Show Date/Time Range"))),this.bindControl(new D12(p,this._linetool.properties().showDistance,!0,this.model(),"Change Trend Line Show Distance")),this.bindControl(new D12(u,this._linetool.properties().showAngle,!0,this.model(),$.t("Change Trend Line Show Angle"))),this.bindControl(new D12(f,this._linetool.properties().alwaysShowStats,!0,this.model(),$.t("Change Trend Line Always Show Stats"))),this.loadData()},$32.prototype.widget=function(){return this._table},inherit($12,$49),$12.prototype.prepareLayout=function(){this._res=$("<div>"),this._table=$('<table class="property-page" cellspacing="0" cellpadding="2" style="width:100%"></table>').appendTo(this._res);var e=TradingView.createLineWidthEditor(),t=TradingView.createLineStyleEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Line");$("<td>").append(i).appendTo(n),$("<td>").append(e).appendTo(n),$('<td colspan="3">').append(t.render().css("display","block")).appendTo(n);var o=$("<input type='checkbox' class='visibility-switch'>"),n=$("<tr>").appendTo(this._table);$('<td colspan="3">').append($("<label>").append(o).append($.t("Show Price"))).prependTo(n);var r=$("<input type='checkbox'>"),n=$("<tr>").appendTo(this._table);$('<td colspan="3">').append($("<label>").append(r).append($.t("Show Text"))).prependTo(n);var n=this.addLabeledRow(this._table,"Text:"),s=this.createColorPicker(),a=this.createFontSizeEditor(),l=this.createFontEditor(),d=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),h=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');$("<td>").append(s).appendTo(n),$("<td>").append(l).appendTo(n),$("<td>").append(a).appendTo(n),$("<td>").append(d).appendTo(n),$("<td>").append(h).appendTo(n),n=$("<tr>").appendTo(this._table),$("<td colspan='2'>").append($.t("Text Alignment:")).appendTo(n);var c=$("<select><option value='left'>"+$.t("left")+"</option><option value='center'>"+$.t("center")+"</option><option value='right'>"+$.t("right")+"</option></select>"),p=$("<select><option value='bottom'>"+$.t("top")+"</option><option value='middle'>"+$.t("middle")+"</option><option value='top'>"+$.t("bottom")+"</option></select>").data("selectbox-css",{display:"block"});$("<td>").append(c).appendTo(n),$("<td colspan='3'>").append(p).appendTo(n);var u=$("<textarea rows='7' cols='60'>").css("width","100%"),n=$("<tr>").appendTo(this._table);$("<td colspan='7'>").append(u).appendTo(n),this.bindControl(new D12(r,this._linetool.properties().showLabel,!0,this.model(),"Change Horz Line Text Visibility")),this.bindControl(new D11(c,this._linetool.properties().horzLabelsAlign,null,!0,this.model(),"Change Horz Line Labels Alignment")),this.bindControl(new D11(p,this._linetool.properties().vertLabelsAlign,null,!0,this.model(),"Change Horz Line Labels Alignment")),this.bindControl(new SimpleStringBinder(u,this._linetool.properties().text,null,!0,this.model(),"Change Text")),this.bindControl(new D12(o,this._linetool.properties().showPrice,!0,this.model(),"Change Horz Line Price Visibility")),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Horz Line Color")),this.bindControl(new D11(t,this._linetool.properties().linestyle,parseInt,!0,this.model(),"Change Horz Line Style")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Horz Line Width")),this.bindControl(new D11(a,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(l,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new ColorBinding(s,this._linetool.properties().textcolor,!0,this.model(),"Change Text Color")),this.bindControl(new D12(d,this._linetool.properties().bold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(h,this._linetool.properties().italic,!0,this.model(),"Change Text Font Italic")),this.loadData()},$12.prototype.widget=function(){return this._res},inherit($11,$14),$11.prototype.prepareLayout=function(){if(this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">'),this._linetool.points().item(0)){var e=$('<input type="text">'),t=$("<tr>").appendTo(this._table);$("<td>"+$.t("Price")+"</td>").appendTo(t),$("<td>").append(e).appendTo(t);var t=this._linetool.properties().points[0],i=[ToFloatTransformer(t.price.value())];this.bindControl(new SimpleStringBinder(e,t.price,i,!1,this.model(),"Change "+this._linetool+" point price")),this.loadData()}},inherit($36,$49),$36.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=TradingView.createLineWidthEditor(),t=TradingView.createLineStyleEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Line");$("<td>").prependTo(n),$("<td>").append(i).appendTo(n),$("<td>").append(e).appendTo(n),$("<td>").append(t.render()).appendTo(n);var o=$("<input type='checkbox' class='visibility-switch'>"),n=$("<tr>").appendTo(this._table);$("<td>").append(o).prependTo(n),this.createLabeledCell(2,"Show Time",o).appendTo(n),this.bindControl(new D12(o,this._linetool.properties().showTime,!0,this.model(),"Change Vert Line Time Visibility")),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Vert Line Color")),this.bindControl(new D11(t,this._linetool.properties().linestyle,parseInt,!0,this.model(),"Change Vert Line Style")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Vert Line Width")),this.loadData()},$36.prototype.widget=function(){return this._table},inherit($35,$14),$35.prototype.prepareLayout=function(){if(this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">'),this._linetool.points().item(0)){var e=$('<input type="text" class="ticker">'),t=$("<tr>").appendTo(this._table);$("<td>"+$.t("Bar #")+"</td>").appendTo(t),$("<td>").append(e).appendTo(t);var t=this._linetool.properties().points[0],i=[ToIntTransformer(t.bar.value()),GreateTransformer(-5e3),LessTransformer(15e3)];this.bindControl(new SimpleStringBinder(e,t.bar,i,!1,this.model(),"Change "+this._linetool+" point bar index")),this.loadData()}},inherit($18,$49),$18.prototype.onResoreDefaults=function(){this._linetool.properties().style.listeners().fire(this._linetool.properties().style)},$18.prototype.addLevelEditor=function(e,t,i){if(i=$("<tr>"),i.appendTo(this._table),e){var n=$("<td>");n.appendTo(i),e=$("<input type='checkbox' class='visibility-switch'>"),e.appendTo(n),n=$("<td>"),n.appendTo(i);var o=$("<input type='text'>");o.appendTo(n),o.css("width","70px"),this.bindControl(new D12(e,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))}else $("<td></td>").appendTo(i),$("<td>"+$.t("Median")+"</td>").appendTo(i);e=$("<td class='colorpicker-cell'>"),e.appendTo(i),e=TradingView.addColorPicker(e),o=$("<td>"),o.appendTo(i),n=TradingView.createLineWidthEditor(),n.appendTo(o),o=$("<td>"),o.appendTo(i),i=TradingView.createLineStyleEditor(),i.render().appendTo(o),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),this.bindControl(new D11(i,t.linestyle,parseInt,!0,this.model(),"Change Pitchfork Line Style")),this.bindControl(new SliderBinder(n,t.linewidth,!0,this.model(),"Change Pitchfork Line Width"))},$18.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().median,!1);for(var e=0;8>=e;e++){var t="level"+e;this.addLevelEditor($.t("Level {0}").format(e+1),this._linetool.properties()[t],!1)}e=$("<tr>"),e.appendTo(this._table),t=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(t).appendTo(e),this.createLabeledCell("Background",t).appendTo(e);var i=TradingView.createTransparencyEditor();$('<td colspan="3">').append(i).appendTo(e);var n=$("<select><option value='0'>"+$.t("Original")+"</option><option value='3'>"+$.t("Schiff")+"</option><option value='1'>"+$.t("Modified Schiff")+"</option><option value='2'>"+$.t("Inside")+"</option></select>"),e=$("<tr>");e.appendTo(this._table),$("<td>"+$.t("Style")+"</td>").appendTo(e),$("<td>").append(n).appendTo(e),this.bindControl(new D11(n,this._linetool.properties().style,parseInt,!0,this.model(),"Change Pitchfork Style")),this.bindControl(new D12(t,this._linetool.properties().fillBackground,!0,this.model(),"Change Pitchfork Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Pitchfork Background Transparency")),this.loadData()},$18.prototype.widget=function(){return this._table},inherit($17,$49),$17.prototype.addLevelEditor=function(e,t,i){if(i=$("<tr>"),i.appendTo(this._table),e){var n=$("<td>");n.appendTo(i),e=$("<input type='checkbox' class='visibility-switch'>"),e.appendTo(n),n=$("<td>"),n.appendTo(i);var o=$("<input type='text'>");o.appendTo(n),o.css("width","70px"),this.bindControl(new D12(e,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))}else $("<td colspan='2'>"+$.t("Median")+"</td>").appendTo(i);e=$("<td class='colorpicker-cell'>"),e.appendTo(i),e=TradingView.addColorPicker(e),o=$("<td>"),o.appendTo(i),n=TradingView.createLineWidthEditor(),n.appendTo(o),o=$("<td>"),o.appendTo(i),i=TradingView.createLineStyleEditor(),i.render().appendTo(o),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),this.bindControl(new D11(i,t.linestyle,parseInt,!0,this.model(),"Change Pitchfan Line Style")),this.bindControl(new SliderBinder(n,t.linewidth,!0,this.model(),"Change Pitchfan Line Width"))},$17.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().median,!1);for(var e=0;8>=e;e++){var t="level"+e;this.addLevelEditor("Level "+(e+1),this._linetool.properties()[t],!1)}e=$("<tr>"),e.appendTo(this._table),t=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(t).appendTo(e),this.createLabeledCell("Background",t).appendTo(e);var i=TradingView.createTransparencyEditor();$('<td colspan="3">').append(i).appendTo(e),this.bindControl(new D12(t,this._linetool.properties().fillBackground,!0,this.model(),"Change Pitchfan Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Pitchfan Background Transparency")),this.loadData()},$17.prototype.widget=function(){return this._table},LineToolTextInplaceEditor.prototype.attachSource=function(e,t){this.W99=e,this._edit=$("<textarea>"),this._edit.css("width","300"),this._edit.css("height","150"),this._edit.appendTo(this.D4._jqMainDiv),TradingView.setAbsolutePos(this._edit,t),this._edit.val(e.properties().text.value()),this._edit.focus();var i=this._edit;return i.select(),this._binding=new SimpleStringBinder(i,e.properties().text,null,!0,this._undoModel,"change line tool text"),this._edit.focusout(function(){e.properties().text.setValue(i.val())}),this._edit.mousedown(function(e){return!0}),i},inherit($27,$49),$27.prototype.prepareLayout=function(){var e=this.createColorPicker(),t=this.createColorPicker(),i=this.createFontSizeEditor(),n=this.createFontEditor(),o=this.createTextEditor(350,200),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),a=$('<input type="checkbox" class="visibility-switch">'),l=$('<input type="checkbox" class="visibility-switch">'),d=$('<input type="checkbox">'),h=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),c=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');this.bindControl(new ColorBinding(e,this._linetool.properties().color,!0,this.model(),$.t("Change Text Color"))),this.bindControl(new D11(i,this._linetool.properties().fontsize,parseInt,!0,this.model(),$.t("Change Text Font Size"))),this.bindControl(new D11(n,this._linetool.properties().font,null,!0,this.model(),$.t("Change Text Font"))),this.bindControl(new SimpleStringBinder(o,this._linetool.properties().text,null,!0,this.model(),$.t("Change Text"))),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),$.t("Change Text Background"))),this.bindControl(new SliderBinder(s,this._linetool.properties().backgroundTransparency,!0,this.model(),$.t("Change Text Background Transparency"))),this.bindControl(new D12(a,this._linetool.properties().fillBackground,!0,this.model(),$.t("Change Text Background Fill"))),this.bindControl(new D12(l,this._linetool.properties().drawBorder,!0,this.model(),$.t("Change Text Border"))),this.bindControl(new ColorBinding(t,this._linetool.properties().borderColor,!0,this.model(),$.t("Change Text Border Color"))),this.bindControl(new D12(d,this._linetool.properties().wordWrap,!0,this.model(),$.t("Change Text Wrap"))),this.bindControl(new D12(h,this._linetool.properties().bold,!0,this.model(),$.t("Change Text Font Bold"))),this.bindControl(new D12(c,this._linetool.properties().italic,!0,this.model(),$.t("Change Text Font Italic")));var p=$('<table class="property-page" cellspacing="0" cellpadding="2">'),u=$('<table class="property-page" cellspacing="0" cellpadding="2">'),f=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._table=p.add(f).add(u),$(document.createElement("tr")).append($(document.createElement("td")).attr({width:1}).append(e)).append($(document.createElement("td")).attr({width:1}).append(n)).append($(document.createElement("td")).attr({width:1}).append(i)).append($(document.createElement("td")).attr({width:1}).append(h)).append($(document.createElement("td")).append(c)).appendTo(p),$(document.createElement("tr")).append($(document.createElement("td")).attr({colspan:5}).append(o)).appendTo(p),e=this.addLabeledRow(u,$.t("Text Wrap"),d),$("<td>").append(d).prependTo(e),e=this.addLabeledRow(f,$.t("Background"),a),$("<td>").append(a).prependTo(e),$("<td>").append(r).appendTo(e),$("<td>").append(s).appendTo(e),e=this.addLabeledRow(f,$.t("Border"),l),$("<td>").append(l).prependTo(e),$("<td>").append(t).appendTo(e),this.loadData(),setTimeout(function(){o.select(),o.focus()},20)},$27.prototype.widget=function(){return this._table},$27.prototype.dialogPosition=function(e,t){var i=0,n=this._linetool,o=n.D0.paneForSource(n);$.each(this.D0.D4._paneWidgets,function(e,t){return t._state==o?(i=$(t.canvas).offset().top,!1):void 0}),e||(e={});var r=e.left,s=e.top,a=this._linetool.paneViews().item(0);if(a)var l=a._floatPoints.item(0);return l&&(r=l.x,s=l.y+i),a=$(t).outerHeight(),l=$(window).height(),n=n.properties().fontsize.value(),{top:l>=s+a+n+5?s+n+5:s-a-5,left:r}},inherit($23,$49),$23.prototype.prepareLayout=function(){function e(){s.slider("option","disabled",!a.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");n.prepend("<td>"),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var o=$('<input type="checkbox" class="visibility-switch">'),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),n=this.addLabeledRow(this._table,"Background",o);$("<td>").append(o).prependTo(n),$("<td>").append(r).appendTo(n),$("<td>").append(s).appendTo(n);var a=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(o,this._linetool.properties().fillBackground,!0,this.model(),"Change Rectangle Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Rectangle Line Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),"Change Rectangle Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Rectangle Border Width")),this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Rectangle Background Transparency")),this.loadData()},$23.prototype.widget=function(){return this._table},inherit(A98,$49),A98.prototype.prepareLayout=function(){function e(){s.slider("option","disabled",!a.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");n.prepend("<td>"),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var o=$('<input type="checkbox" class="visibility-switch">'),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),n=this.addLabeledRow(this._table,"Background",o);$("<td>").append(o).prependTo(n),$("<td>").append(r).appendTo(n),$("<td>").append(s).appendTo(n);var a=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(o,this._linetool.properties().fillBackground,!0,this.model(),"Change Ellipse Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Ellipse Line Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),"Change Ellipse Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Ellipse Border Width")),this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Ellipse Background Transparency")),this.loadData()},A98.prototype.widget=function(){return this._table},inherit(A87,$49),A87.prototype.prepareLayout=function(){function e(){s.slider("option","disabled",!a.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");n.prepend("<td>"),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var o=$('<input type="checkbox" class="visibility-switch">'),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),n=this.addLabeledRow(this._table,"Background",o);$("<td>").append(o).prependTo(n),$("<td>").append(r).appendTo(n),$("<td>").append(s).appendTo(n);var a=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(o,this._linetool.properties().fillBackground,!0,this.model(),"Change Arc Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Arc Line Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),"Change Arc Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Arc Border Width")),
this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Arc Background Transparency")),this.loadData()},A87.prototype.widget=function(){return this._table},inherit($34,$49),$34.prototype.prepareLayout=function(){function e(){s.slider("option","disabled",!a.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");n.prepend("<td>"),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var o=$('<input type="checkbox" class="visibility-switch">'),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),n=this.addLabeledRow(this._table,"Background",o);$("<td>").append(o).prependTo(n),$("<td>").append(r).appendTo(n),$("<td>").append(s).appendTo(n);var a=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(o,this._linetool.properties().fillBackground,!0,this.model(),"Change Triangle Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Triangle Line Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),"Change Triangle Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Triangle Border Width")),this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Triangle Background Transparency")),this.loadData()},$34.prototype.widget=function(){return this._table},inherit($16,$49),$16.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),o=$("<tr>").appendTo(e);$("<td></td><td>"+$.t("Channel")+"</td>").appendTo(o),$("<td>").append(n).appendTo(o),$("<td>").append(t).appendTo(o),$("<td>").append(i.render()).appendTo(o);var o=$("<tr>").appendTo(e),r=$("<td>").appendTo(o),s=$("<input type='checkbox' class='visibility-switch'>");s.appendTo(r),this.createLabeledCell("Middle",s).appendTo(o);var r=TradingView.createLineWidthEditor(),a=TradingView.createLineStyleEditor(),l=this.createColorPicker();$("<td>").append(l).appendTo(o),$("<td>").append(r).appendTo(o),$("<td>").append(a.render()).appendTo(o);var o=$("<tr>").appendTo(e),d=$("<td>").appendTo(o),e=$("<input type='checkbox' class='visibility-switch'>");e.appendTo(d),this.createLabeledCell("Background",e).appendTo(o),d=this.createColorPicker(),$("<td>").append(d).appendTo(o);var h=TradingView.createTransparencyEditor(d);$('<td colspan="2">').append(h).appendTo(o);var c=$("<tbody>").appendTo(this._table),o=this.addEditorRow(c,"Extend Left",$("<input type='checkbox'>"),2),c=this.addEditorRow(c,"Extend Right",$("<input type='checkbox'>"),2),p=this._linetool.properties();this.bindControl(new D12(e,p.fillBackground,!0,this.model(),"Change Parallel Channel Fill Background")),this.bindControl(new D12(s,p.showMidline,!0,this.model(),"Change Parallel Channel Show Center Line")),this.bindControl(new D12(o,p.extendLeft,!0,this.model(),"Change Parallel Channel Extending Left")),this.bindControl(new D12(c,p.extendRight,!0,this.model(),"Change Parallel Channel Extending Right")),this.bindControl(new ColorBinding(n,p.linecolor,!0,this.model(),"Change Parallel Channel Color")),this.bindControl(new D11(i,p.linestyle,parseInt,!0,this.model(),"Change Parallel Channel Style")),this.bindControl(new SliderBinder(t,p.linewidth,!0,this.model(),"Change Parallel Channel Width")),this.bindControl(new ColorBinding(l,p.midlinecolor,!0,this.model(),"Change Parallel Channel Middle Color")),this.bindControl(new D11(a,p.midlinestyle,parseInt,!0,this.model(),"Change Parallel Channel Middle Style")),this.bindControl(new SliderBinder(r,p.midlinewidth,!0,this.model(),"Change Parallel Channel Middle Width")),this.bindControl(new ColorBinding(d,p.backgroundColor,!0,this.model(),"Change Parallel Channel Back Color")),this.bindControl(new SliderBinder(h,p.transparency,!0,this.model(),"Change Parallel Channel Background Transparency")),this.loadData()},$16.prototype.widget=function(){return this._table},inherit(A88,$49),A88.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">').css({width:"100%"});var e=$("<input type='text'>").css({width:"100%"}),t=$('<div class="property-page-fullwidth-wrapper">').append(e),i=this.createColorPicker(),n=this.createFontEditor(),o=$("<tr>").appendTo(this._table);$("<td>").css({width:"0"}).html($.t("Text")).appendTo(o),$('<td colspan="2">').append(t).appendTo(o),o=this.addLabeledRow(this._table,"Text Font"),o.children().css({whiteSpace:"nowrap"}),$("<td>").append(i).appendTo(o).css({width:"0"}),$("<td>").append(n).appendTo(o),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Arrow Mark Text Color")),this.bindControl(new SimpleStringBinder(e,this._linetool.properties().text,null,!0,this.model(),"Change Arrow Mark Text")),this.bindControl(new D11(n,this._linetool.properties().font,null,!0,this.model(),"Change Arrow Mark Font")),this.loadData(),setTimeout(function(){e.select(),e.focus()},20)},A88.prototype.widget=function(){return this._table},inherit($21,$49),$21.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=this.createColorPicker(),t=this.createColorPicker(),i=this.createColorPicker(),n=TradingView.createTransparencyEditor(i),o=this.addLabeledRow(this._table,"Text Color");$("<td>").append(e).appendTo(o),o=this.addLabeledRow(this._table,"Border Color"),$("<td>").append(t).appendTo(o),o=this.addLabeledRow(this._table,"Background"),$("<td>").append(i).appendTo(o),$("<td>").append(n).appendTo(o),this.bindControl(new ColorBinding(e,this._linetool.properties().color,!0,this.model(),"Change Price Text Color")),this.bindControl(new ColorBinding(t,this._linetool.properties().borderColor,!0,this.model(),"Change Border Color")),this.bindControl(new ColorBinding(i,this._linetool.properties().backgroundColor,!0,this.model(),"Change Background Color")),this.bindControl(new SliderBinder(n,this._linetool.properties().transparency,!0,this.model(),"Change Background Transparency")),this.loadData()},$21.prototype.widget=function(){return this._table},inherit(A89,$49),A89.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="0">').css({width:"100%"}).data("layout-tab-open",EditObjectDialog.TAB_OPEN_OVERRIDE),t=$('<table class="property-page" cellspacing="0" cellpadding="0">');this._table=e.add(t);var i=this.createColorPicker(),n=this.createColorPicker(),o=this.createColorPicker(),r=TradingView.createTransparencyEditor(o),s=$("<input type='text'>").css({width:"100%"}),e=$("<tr>").appendTo(e),a=$('<div class="property-page-fullwidth-wrapper">').append(s);$("<td>").css({width:"0"}).append(i).appendTo(e),$("<td>").append(a).appendTo(e),e=this.addLabeledRow(t,"Background"),$("<td>").appendTo(e).append(o),$("<td>").appendTo(e).append(r),e=this.addLabeledRow(t,"Border Color"),$("<td>").appendTo(e).append(n),$("<td>"),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Balooon Text Color")),this.bindControl(new ColorBinding(n,this._linetool.properties().borderColor,!0,this.model(),"Change Balloon Border Color")),this.bindControl(new ColorBinding(o,this._linetool.properties().backgroundColor,!0,this.model(),"Change Balloon Background Color")),this.bindControl(new SliderBinder(r,this._linetool.properties().transparency,!0,this.model(),"Change Balloon Background Transparency")),this.bindControl(new SimpleStringBinder(s,this._linetool.properties().text,null,!0,this.model(),"Change Balloon Text")),this.loadData(),setTimeout(function(){s.select(),s.focus()},0)},A89.prototype.widget=function(){return this._table},inherit(A92,$49),A92.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=TradingView.createLineWidthEditor(),t=this.createColorPicker(),i=$('<input type="checkbox" class="visibility-switch">'),n=this.createColorPicker(),o=TradingView.createTransparencyEditor(n),r=this.addLabeledRow(this._table,"Line");$("<td>").prependTo(r),$("<td>").append(t).appendTo(r),$("<td>").append(e).appendTo(r),r=this.addLabeledRow(this._table,"Background",i),$("<td>").append(i).prependTo(r),$("<td>").append(n).appendTo(r),$("<td>").append(o).appendTo(r),this.bindControl(new ColorBinding(t,this._linetool.properties().linecolor,!0,this.model(),"Change Brush Color")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Brush Line Width")),this.bindControl(new D12(i,this._linetool.properties().fillBackground,!0,this.model(),"Change Brush Filling")),this.bindControl(new ColorBinding(n,this._linetool.properties().backgroundColor,!0,this.model(),"Change Brush Background Color")),this.bindControl(new SliderBinder(o,this._linetool.properties().transparency,!0,this.model(),"Change Brush Background Transparency")),this.loadData()},A92.prototype.widget=function(){return this._table},inherit($20,$49),$20.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="2">'),t=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),i=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._table=e.add(t).add(i);var n=this.createColorPicker(),o=TradingView.createLineWidthEditor(),e=this.addLabeledRow(e,"Line");$("<td>").append(n).appendTo(e),$("<td>").append(o).appendTo(e);var e=$("<tr>").appendTo(t),t=$("<td>").appendTo(e).css({"vertical-align":"top",width:"50%"}),e=$("<td>").appendTo(e).css({"vertical-align":"top",width:"50%"}),r=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo(t),s=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo(e),t=this.addColorPickerRow(r,"Source back color"),e=this.addColorPickerRow(r,"Source text color"),a=this.addColorPickerRow(r,"Source border color"),l=this.addColorPickerRow(r,"Success back color"),r=this.addColorPickerRow(r,"Success text color"),d=this.addColorPickerRow(s,"Target back color"),h=this.addColorPickerRow(s,"Target text color"),c=this.addColorPickerRow(s,"Target border color"),p=this.addColorPickerRow(s,"Failure back color"),s=this.addColorPickerRow(s,"Failure text color"),u=TradingView.createTransparencyEditor(d);this.addEditorRow(i,"Transparency",u),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),"Forecast Line Color")),this.bindControl(new SliderBinder(o,this._linetool.properties().linewidth,!0,this.model(),"Forecast Line Width")),this.bindControl(new ColorBinding(t,this._linetool.properties().sourceBackColor,!0,this.model(),"Forecast Source Background Color")),this.bindControl(new ColorBinding(a,this._linetool.properties().sourceStrokeColor,!0,this.model(),"Forecast Source Border Color")),this.bindControl(new ColorBinding(e,this._linetool.properties().sourceTextColor,!0,this.model(),"Forecast Source Text Color")),this.bindControl(new ColorBinding(d,this._linetool.properties().targetBackColor,!0,this.model(),"Forecast Target Background Color")),this.bindControl(new ColorBinding(c,this._linetool.properties().targetStrokeColor,!0,this.model(),"Forecast Target Border Color")),this.bindControl(new ColorBinding(h,this._linetool.properties().targetTextColor,!0,this.model(),"Forecast Target Text Color")),this.bindControl(new ColorBinding(l,this._linetool.properties().successBackground,!0,this.model(),"Forecast Success Back Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().successTextColor,!0,this.model(),"Forecast Success Text Color")),this.bindControl(new ColorBinding(p,this._linetool.properties().failureBackground,!0,this.model(),"Forecast Failure Back Color")),this.bindControl(new ColorBinding(s,this._linetool.properties().failureTextColor,!0,this.model(),"Forecast Failure Text Color")),this.bindControl(new SliderBinder(u,this._linetool.properties().transparency,!0,this.model(),"Change Forecast Background Transparency")),this.loadData()},$20.prototype.widget=function(){return this._table},inherit($19,$49),$19.prototype.prepareLayout=function(){function e(){s.slider("option","disabled",!a.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");n.prepend("<td>"),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var o=$('<input type="checkbox" class="visibility-switch">'),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),n=this.addLabeledRow(this._table,"Background",o);$("<td>").append(o).prependTo(n),$("<td>").append(r).appendTo(n),$("<td>").append(s).appendTo(n);var a=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(o,this._linetool.properties().fillBackground,!0,this.model(),"Change Polyline Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Polyline Line Color")),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),"Change Polyline Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Polyline Border Width")),this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Polyline Background Transparency")),this.loadData()},$19.prototype.widget=function(){return this._table},inherit($10,$49),$10.prototype.addLevelEditor=function(e,t,i){t=$("<tr>"),t.appendTo(e);var n=$("<td>");n.appendTo(t),e=$("<input type='checkbox' class='visibility-switch'>"),e.appendTo(n),n=$("<td>"),n.appendTo(t);var o=$("<input type='text'>");o.appendTo(n),o.css("width","70px"),this.bindControl(new D12(e,i.visible,!0,this.model(),"Change Gann Square Line Visibility")),this.bindControl(new SimpleStringBinder(o,i.coeff,ToFloatTransformer(i.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff")),e=$("<td class='colorpicker-cell'>"),e.appendTo(t),t=TradingView.addColorPicker(e),this.bindControl(new ColorBinding(t,i.color,!0,this.model(),"Change Gann Square Line Color"))},$10.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page property-page-unpadded"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this._table.css({width:"100%"});var e=$("<tbody>").appendTo(this._table),t=$("<tr>");t.appendTo(e);var i=$('<td width="50%">');for(i.appendTo(t),e=$('<td width="50%">'),e.appendTo(t),t=$('<table cellspacing="0" cellpadding="2">'),t.appendTo(i),t.addClass("property-page"),i=$('<table cellspacing="0" cellpadding="2">'),i.appendTo(e),i.addClass("property-page"),$("<tr><td align='center' colspan='4'>"+$.t("Price Levels")+"</td></tr>").appendTo(t),$("<tr><td align='center' colspan='4'>"+$.t("Time Levels")+"</td></tr>").appendTo(i),e=1;7>=e;e++){var n="hlevel"+e;this.addLevelEditor(t,"Level "+e,this._linetool.properties()[n])}for(e=1;7>=e;e++)n="vlevel"+e,this.addLevelEditor(i,"Level "+e,this._linetool.properties()[n]);var i=$("<input type='checkbox' class='visibility-switch'>"),n=$("<input type='checkbox' class='visibility-switch'>"),o=$("<input type='checkbox' class='visibility-switch'>"),r=$("<input type='checkbox' class='visibility-switch'>"),s=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),t=$("<tr>").appendTo(s),a=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(t)),t=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(t)),e=this.addLabeledRow(a,"Left Labels",i);$("<td>").append(i).prependTo(e),e=this.addLabeledRow(t,"Right Labels",n),$("<td>").append(n).prependTo(e),e=this.addLabeledRow(a,"Top Labels",o),$("<td>").append(o).prependTo(e),e=this.addLabeledRow(t,"Bottom Labels",r),$("<td>").append(r).prependTo(e),this.bindControl(new D12(i,this._linetool.properties().showLeftLabels,!0,this.model(),"Change Gann Square Left Labels Visibility")),this.bindControl(new D12(n,this._linetool.properties().showRightLabels,!0,this.model(),"Change Gann Square Right Labels Visibility")),this.bindControl(new D12(o,this._linetool.properties().showTopLabels,!0,this.model(),"Change Gann Square Top Labels Visibility")),this.bindControl(new D12(r,this._linetool.properties().showBottomLabels,!0,this.model(),"Change Gann Square Bottom Labels Visibility")),this._table=this._table.add(s),e=$("<tr>"),e.appendTo(a),i=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(i).appendTo(e),n=TradingView.createTransparencyEditor(),$("<td>").append(n).appendTo(e),this.bindControl(new D12(i,this._linetool.properties().fillHorzBackground,!0,this.model(),"Change Gann Square Background Visibility")),this.bindControl(new SliderBinder(n,this._linetool.properties().horzTransparency,!0,this.model(),"Change Gann Square Background Transparency")),e=$("<tr>"),e.appendTo(t),i=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(i).appendTo(e),n=TradingView.createTransparencyEditor(),$("<td>").append(n).appendTo(e),this.bindControl(new D12(i,this._linetool.properties().fillVertBackground,!0,this.model(),"Change Gann Square Background Visibility")),this.bindControl(new SliderBinder(n,this._linetool.properties().vertTransparency,!0,this.model(),"Change Gann Square Background Transparency")),this.loadData()},$10.prototype.widget=function(){return this._table},inherit($8,$49),$8.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page property-page-unpadded"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this._table.css({width:"100%"});var e=$("<tr>");e.appendTo(this._table);var t=this._linetool.properties(),i=$("<table>");$("<td valign='top'>").append(i).appendTo(e);var n=$("<tr>");$("<td colspan='3'>"+$.t("Levels")+"</td>").appendTo(n),n.appendTo(i);for(var o in t.levels._childs){var r=t.levels[o],s=$("<tr>");s.appendTo(i),$("<td>"+o+"</td>").appendTo(s),n=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(n).appendTo(s);var a=$("<td class='colorpicker-cell'>");a.appendTo(s);var a=TradingView.addColorPicker(a),l=$("<td>");l.appendTo(s),s=TradingView.createLineWidthEditor(),s.appendTo(l),this.bindControl(new D12(n,r.visible,!0,this.model(),"Change Gann Line Visibility")),this.bindControl(new ColorBinding(a,r.color,!0,this.model(),"Change Gann Line Color")),this.bindControl(new SliderBinder(s,r.width,!0,this.model(),"Change Gann Line Width"))}i=$("<table>"),$("<td valign='top'>").append(i).appendTo(e),n=$("<tr>"),$("<td colspan='4'>"+$.t("Fans")+"</td>").appendTo(n),n.appendTo(i);for(o in t.fanlines._childs)r=t.fanlines[o],s=$("<tr>"),s.appendTo(i),n=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(n).appendTo(s),a=r.x.value()+"x"+r.y.value(),$("<td>"+a+"</td>").appendTo(s),a=$("<td class='colorpicker-cell'>"),a.appendTo(s),a=TradingView.addColorPicker(a),l=$("<td>"),l.appendTo(s),s=TradingView.createLineWidthEditor(),s.appendTo(l),this.bindControl(new D12(n,r.visible,!0,this.model(),"Change Gann Line Visibility")),this.bindControl(new ColorBinding(a,r.color,!0,this.model(),"Change Gann Fan Color")),this.bindControl(new SliderBinder(s,r.width,!0,this.model(),"Change Gann Line Width"));i=$("<table>"),$("<td valign='top'>").append(i).appendTo(e),e=$("<tr>"),$("<td colspan='4'>"+$.t("Arcs")+"</td>").appendTo(e),e.appendTo(i);for(o in t.arcs._childs)e=t.arcs[o],s=$("<tr>"),s.appendTo(i),n=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(n).appendTo(s),a=e.x.value()+"x"+e.y.value(),$("<td>"+a+"</td>").appendTo(s),a=$("<td class='colorpicker-cell'>"),a.appendTo(s),a=TradingView.addColorPicker(a),l=$("<td>"),l.appendTo(s),s=TradingView.createLineWidthEditor(),s.appendTo(l),this.bindControl(new D12(n,e.visible,!0,this.model(),"Change Gann Line Visibility")),this.bindControl(new ColorBinding(a,e.color,!0,this.model(),"Change Gann Arc Color")),this.bindControl(new SliderBinder(s,e.width,!0,this.model(),"Change Gann Line Width"));e=$("<tbody>").appendTo(this._table),t=$('<input type="checkbox" class="visibility-switch">'),o=TradingView.createTransparencyEditor(),e=$("<tr>").appendTo(e),n=$("<table>"),$('<td colspan="3">').append(n).appendTo(e),e=$("<tr>").appendTo(n),$("<td>"+$.t("Background")+"</td>").appendTo(e),$("<td>").append(t).appendTo(e),$("<td>").append(o).appendTo(e),this.bindControl(new D12(t,this._linetool.properties().arcsBackground.fillBackground,!0,this.model(),"Change Gann Square Filling")),this.bindControl(new SliderBinder(o,this._linetool.properties().arcsBackground.transparency,!0,this.model(),"Change Gann Square Background Transparency"))},$8.prototype.widget=function(){return this._table},inherit($9,$49),$9.prototype.addLevelEditor=function(e,t,i,n){var o=$("<tr>");o.appendTo(this._tbody),n="control-level-"+i+"-"+n;var r=$("<td>");r.appendTo(o),i=$("<input type='checkbox' class='visibility-switch' id='"+n+"'>"),i.appendTo(r),this.createLabeledCell(e).appendTo(o).find("label").attr("for",n),e=$("<td class='colorpicker-cell'>"),e.appendTo(o),e=TradingView.addColorPicker(e),r=$("<td>"),r.appendTo(o),n=TradingView.createLineWidthEditor(),n.appendTo(r),r=$("<td>"),r.appendTo(o),o=TradingView.createLineStyleEditor(),o.render().appendTo(r),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Gann Fan Line Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Gann Fan Line Color")),this.bindControl(new D11(o,t.linestyle,parseInt,!0,this.model(),"Change Gann Fan Line Style")),this.bindControl(new SliderBinder(n,t.linewidth,!0,this.model(),"Change Gann Fan Line Width"))},$9.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="2">'),t=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._tbody=$("<tbody>").appendTo(e);for(var i=1;9>=i;i++){var n="level"+i,n=this._linetool.properties()[n],o=n.coeff1.value(),r=n.coeff2.value();this.addLevelEditor("<sup>"+o+"</sup>&frasl;<sub>"+r+"</sub>",n,o,r)}n=$("<input type='checkbox' class='visibility-switch'>"),i=this.addLabeledRow(t,"Labels",n),$("<td>").append(n).prependTo(i),this.bindControl(new D12(n,this._linetool.properties().showLabels,!0,this.model(),"Change Gann Fan Labels Visibility")),this._table=e.add(t),i=$("<tr>"),i.appendTo(this._table),e=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(e).appendTo(i),this.createLabeledCell("Background",e).appendTo(i),t=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(t).appendTo(i),this.bindControl(new D12(e,this._linetool.properties().fillBackground,!0,this.model(),"Change Pitchfan Background Visibility")),this.bindControl(new SliderBinder(t,this._linetool.properties().transparency,!0,this.model(),"Change Pitchfan Background Transparency")),this.loadData()},$9.prototype.widget=function(){return this._table},inherit(A84,$49),A84.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");if(o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e){o=$("<td>"),o.appendTo(n);var r=$("<input type='text'>");r.appendTo(o),r.css("width","70px"),this.bindControl(new SimpleStringBinder(r,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))}else this.createLabeledCell("Trend Line",i).appendTo(n);o=$("<td class='colorpicker-cell'>"),o.appendTo(n);var o=TradingView.addColorPicker(o),s=$("<td>");s.appendTo(n),r=TradingView.createLineWidthEditor(),r.appendTo(s),e||(e=$("<td>"),e.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(e),this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Fib Circle Style"))),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Fib Circle Visibility")),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),"Change Fib Circle Line Color")),this.bindControl(new SliderBinder(r,t.linewidth,!0,this.model(),"Change Fib Circle Width"))},A84.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().trendline,!1);for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}var i=$("<input type='checkbox' class='visibility-switch'>"),e=this.addLabeledRow(this._table,"Levels",i);$("<td>").append(i).prependTo(e),t=$("<input type='checkbox' class='visibility-switch'>"),e=this.addLabeledRow(this._table,"Coeffs As Percents",t),$("<td>").append(t).prependTo(e),this.bindControl(new D12(i,this._linetool.properties().showCoeffs,!0,this.model(),"Change Fib Circle Levels Visibility")),e=$("<tr>"),e.appendTo(this._table),i=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(i).appendTo(e),this.createLabeledCell("Background",i).appendTo(e);var n=TradingView.createTransparencyEditor();$('<td colspan="3">').append(n).appendTo(e),this.bindControl(new D12(i,this._linetool.properties().fillBackground,!0,this.model(),"Change Pitchfork Background Visibility")),this.bindControl(new SliderBinder(n,this._linetool.properties().transparency,!0,this.model(),"Change Pitchfork Background Transparency")),this.bindControl(new D12(t,this._linetool.properties().coeffsAsPercents,!0,this.model(),"Change Fib Retracement Coeffs As Percents")),this.loadData()},A84.prototype.widget=function(){return this._table},inherit($1,$49),$1.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e?(e=$("<td>"),e.appendTo(n),o=$("<input type='text'>"),o.appendTo(e),o.css("width","70px"),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))):this.createLabeledCell("Trend Line",i).appendTo(n),e=$("<td class='colorpicker-cell'>"),e.appendTo(n),e=TradingView.addColorPicker(e);var r=$("<td>");r.appendTo(n),o=TradingView.createLineWidthEditor(),o.appendTo(r),r=$("<td>"),r.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(r),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Pitchfork Line Style")),this.bindControl(new SliderBinder(o,t.linewidth,parseInt,this.model(),"Change Pitchfork Line Width"))},$1.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().trendline,!1);for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}var i=$("<input type='checkbox' class='visibility-switch'>"),n=$("<input type='checkbox' class='visibility-switch'>"),e=$("<input type='checkbox' class='visibility-switch'>"),t=$("<input type='checkbox' class='visibility-switch'>"),o=$("<input type='checkbox' class='visibility-switch'>"),r=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),s=$("<tr>").appendTo(r),a=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(s)),s=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(s)),a=this.addLabeledRow(a,"Levels",i);$("<td>").append(i).prependTo(a),a=this.addLabeledRow(s,"Prices",n),$("<td>").append(n).prependTo(a),a=this.addLabeledRow(this._table,"Extend Lines",e),$("<td>").append(e).prependTo(a),a=this.addLabeledRow(this._table,"Reverse",t),$("<td>").append(t).prependTo(a),a=this.addLabeledRow(this._table,"Coeffs As Percents",o),$("<td>").append(o).prependTo(a),this.bindControl(new D12(n,this._linetool.properties().showPrices,!0,this.model(),"Change Gann Fan Prices Visibility")),this.bindControl(new D12(i,this._linetool.properties().showCoeffs,!0,this.model(),"Change Gann Fan Levels Visibility")),i=$("<table cellspacing='0' cellpadding='0'>"),n=$("<select><option value='left'>"+$.t("left")+"</option><option value='center'>"+$.t("center")+"</option><option value='right'>"+$.t("right")+"</option></select>"),s=$("<select><option value='bottom'>"+$.t("top")+"</option><option value='middle'>"+$.t("middle")+"</option><option value='top'>"+$.t("bottom")+"</option></select>"),a=$("<tr>"),a.append("<td>"+$.t("Labels")+"</td>").append(n).append("<td>&nbsp</td>").append(s),a.appendTo(i),a=$("<tr>"),$("<td colspan='5'>").append(i).appendTo(a),a.appendTo(this._table),this.bindControl(new D11(n,this._linetool.properties().horzLabelsAlign,null,!0,this.model(),"Change Fib Retracement Labels Alignment")),this.bindControl(new D11(s,this._linetool.properties().vertLabelsAlign,null,!0,this.model(),"Change Fib Retracement Labels Alignment")),this._table=this._table.add(r),a=$("<tr>"),a.appendTo(this._table),r=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(r).appendTo(a),this.createLabeledCell("Background",r).appendTo(a),i=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(i).appendTo(a),this.bindControl(new D12(r,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Retracement Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Fib Retracement Background Transparency")),this.bindControl(new D12(e,this._linetool.properties().extendLines,!0,this.model(),"Change Fib Retracement Extend Lines")),this.bindControl(new D12(t,this._linetool.properties().reverse,!0,this.model(),"Change Fib Retracement Reverse")),this.bindControl(new D12(o,this._linetool.properties().coeffsAsPercents,!0,this.model(),"Change Fib Retracement Coeffs As Percents")),this.loadData()},$1.prototype.widget=function(){return this._table},inherit(A99,$49),A99.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e?(e=$("<td>"),e.appendTo(n),o=$("<input type='text'>"),o.appendTo(e),o.css("width","70px"),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))):this.createLabeledCell("Trend Line",i).appendTo(n),e=$("<td class='colorpicker-cell'>"),e.appendTo(n),e=TradingView.addColorPicker(e);var r=$("<td>");r.appendTo(n),o=TradingView.createLineWidthEditor(),o.appendTo(r),r=$("<td>"),r.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(r),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),
this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Pitchfork Line Style")),this.bindControl(new SliderBinder(o,t.linewidth,parseInt,this.model(),"Change Pitchfork Line Width"))},A99.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}var i=$("<input type='checkbox' class='visibility-switch'>"),n=$("<input type='checkbox' class='visibility-switch'>"),e=$("<input type='checkbox' class='visibility-switch'>"),t=$("<input type='checkbox' class='visibility-switch'>"),o=$("<input type='checkbox' class='visibility-switch'>"),r=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),s=$("<tr>").appendTo(r),a=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(s)),s=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(s)),a=this.addLabeledRow(a,"Levels",i);$("<td>").append(i).prependTo(a),a=this.addLabeledRow(s,"Prices",n),$("<td>").append(n).prependTo(a),a=this.addLabeledRow(this._table,"Extend Left",e),$("<td>").append(e).prependTo(a),a=this.addLabeledRow(this._table,"Extend Right",t),$("<td>").append(t).prependTo(a),a=this.addLabeledRow(this._table,"Coeffs As Percents",o),$("<td>").append(o).prependTo(a),this.bindControl(new D12(n,this._linetool.properties().showPrices,!0,this.model(),"Change Gann Fan Prices Visibility")),this.bindControl(new D12(i,this._linetool.properties().showCoeffs,!0,this.model(),"Change Gann Fan Levels Visibility")),i=$("<table cellspacing='0' cellpadding='0'>"),n=$("<select><option value='left'>"+$.t("left")+"</option><option value='center'>"+$.t("center")+"</option><option value='right'>"+$.t("right")+"</option></select>"),s=$("<select><option value='bottom'>"+$.t("top")+"</option><option value='middle'>"+$.t("middle")+"</option><option value='top'>"+$.t("bottom")+"</option></select>"),a=$("<tr>"),a.append("<td>"+$.t("Labels")+"</td>").append(n).append("<td>&nbsp</td>").append(s),a.appendTo(i),a=$("<tr>"),$("<td colspan='5'>").append(i).appendTo(a),a.appendTo(this._table),this.bindControl(new D11(n,this._linetool.properties().horzLabelsAlign,null,!0,this.model(),"Change Fib Retracement Labels Alignment")),this.bindControl(new D11(s,this._linetool.properties().vertLabelsAlign,null,!0,this.model(),"Change Fib Retracement Labels Alignment")),this._table=this._table.add(r),a=$("<tr>"),a.appendTo(this._table),r=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(r).appendTo(a),this.createLabeledCell("Background",r).appendTo(a),i=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(i).appendTo(a),this.bindControl(new D12(r,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Retracement Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Fib Retracement Background Transparency")),this.bindControl(new D12(e,this._linetool.properties().extendLeft,!0,this.model(),"Change Fib Retracement Extend Lines")),this.bindControl(new D12(t,this._linetool.properties().extendRight,!0,this.model(),"Change Fib Retracement Extend Lines")),this.bindControl(new D12(o,this._linetool.properties().coeffsAsPercents,!0,this.model(),"Change Fib Retracement Coeffs As Percents")),this.loadData()},A99.prototype.widget=function(){return this._table},inherit($30,$1),inherit($31,$49),$31.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e?(e=$("<td>"),e.appendTo(n),o=$("<input type='text'>"),o.appendTo(e),o.css("width","70px"),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))):this.createLabeledCell("Trend Line",i).appendTo(n),e=$("<td class='colorpicker-cell'>"),e.appendTo(n),e=TradingView.addColorPicker(e);var r=$("<td>");r.appendTo(n),o=TradingView.createLineWidthEditor(),o.appendTo(r),r=$("<td>"),r.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(r),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Pitchfork Line Style")),this.bindControl(new SliderBinder(o,t.linewidth,parseInt,this.model(),"Change Pitchfork Line Width"))},$31.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().trendline,!1);for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}e=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),e=$("<tr>").appendTo(e),$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(e)),$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(e)),e=$("<input type='checkbox' class='visibility-switch'>"),t=this.addLabeledRow(this._table,"Show Labels",e),$("<td>").append(e).prependTo(t);var i=$("<table cellspacing='0' cellpadding='0'>"),n=$("<select><option value='left'>"+$.t("left")+"</option><option value='center'>"+$.t("center")+"</option><option value='right'>"+$.t("right")+"</option></select>"),o=$("<select><option value='top'>"+$.t("top")+"</option><option value='middle'>"+$.t("middle")+"</option><option value='bottom'>"+$.t("bottom")+"</option></select>"),t=$("<tr>");t.append("<td>"+$.t("Labels")+"</td>").append(n).append("<td>&nbsp</td>").append(o),t.appendTo(i),t=$("<tr>"),$("<td colspan='5'>").append(i).appendTo(t),t.appendTo(this._table),this.bindControl(new D11(n,this._linetool.properties().horzLabelsAlign,null,!0,this.model(),"Change Trend-Based Fib Time Labels Alignment")),this.bindControl(new D11(o,this._linetool.properties().vertLabelsAlign,null,!0,this.model(),"Change Trend-Based Fib Time Labels Alignment")),t=$("<tr>"),t.appendTo(this._table),i=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(i).appendTo(t),this.createLabeledCell("Background",i).appendTo(t),n=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(n).appendTo(t),this.bindControl(new D12(i,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Retracement Background Visibility")),this.bindControl(new SliderBinder(n,this._linetool.properties().transparency,!0,this.model(),"Change Fib Retracement Background Transparency")),this.bindControl(new D12(e,this._linetool.properties().showCoeffs,!0,this.model(),"Change Fib Retracement Extend Lines")),this.loadData()},$31.prototype.widget=function(){return this._table},inherit($3,$49),$3.prototype.addLevelEditor=function(e,t,i){t=$("<tr>"),t.appendTo(e);var n=$("<td>");n.appendTo(t),e=$("<input type='checkbox' class='visibility-switch'>"),e.appendTo(n),n=$("<td>"),n.appendTo(t);var o=$("<input type='text'>");o.appendTo(n),o.css("width","70px"),this.bindControl(new D12(e,i.visible,!0,this.model(),"Change Gann Square Line Visibility")),this.bindControl(new SimpleStringBinder(o,i.coeff,ToFloatTransformer(i.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff")),e=$("<td class='colorpicker-cell'>"),e.appendTo(t),t=TradingView.addColorPicker(e),this.bindControl(new ColorBinding(t,i.color,!0,this.model(),"Change Gann Square Line Color"))},$3.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page property-page-unpadded"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this._table.css({width:"100%"});var e=$("<tbody>").appendTo(this._table),t=$("<tr>");t.appendTo(e);var i=$('<td width="50%">');for(i.appendTo(t),e=$('<td width="50%">'),e.appendTo(t),t=$('<table cellspacing="0" cellpadding="2">'),t.appendTo(i),t.addClass("property-page"),i=$('<table cellspacing="0" cellpadding="2">'),i.appendTo(e),i.addClass("property-page"),$("<tr><td align='center' colspan='4'>"+$.t("Price Levels")+"</td></tr>").appendTo(t),$("<tr><td align='center' colspan='4'>"+$.t("Time Levels")+"</td></tr>").appendTo(i),e=1;7>=e;e++){var n="hlevel"+e;this.addLevelEditor(t,"Level "+e,this._linetool.properties()[n])}for(e=1;7>=e;e++)n="vlevel"+e,this.addLevelEditor(i,"Level "+e,this._linetool.properties()[n]);var i=$("<input type='checkbox' class='visibility-switch'>"),n=$("<input type='checkbox' class='visibility-switch'>"),o=$("<input type='checkbox' class='visibility-switch'>"),r=$("<input type='checkbox' class='visibility-switch'>"),t=$('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width:"100%"}),e=$("<tr>").appendTo(t),s=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(e)),a=$('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width:"50%"}).appendTo(e)),e=this.addLabeledRow(s,"Left Labels",i);$("<td>").append(i).prependTo(e),e=this.addLabeledRow(a,"Right Labels",n),$("<td>").append(n).prependTo(e),e=this.addLabeledRow(s,"Top Labels",o),$("<td>").append(o).prependTo(e),e=this.addLabeledRow(a,"Bottom Labels",r),$("<td>").append(r).prependTo(e),this.bindControl(new D12(i,this._linetool.properties().showLeftLabels,!0,this.model(),"Change Gann Square Left Labels Visibility")),this.bindControl(new D12(n,this._linetool.properties().showRightLabels,!0,this.model(),"Change Gann Square Right Labels Visibility")),this.bindControl(new D12(o,this._linetool.properties().showTopLabels,!0,this.model(),"Change Gann Square Top Labels Visibility")),this.bindControl(new D12(r,this._linetool.properties().showBottomLabels,!0,this.model(),"Change Gann Square Bottom Labels Visibility")),n=$('<table class="property-page" cellspacing="0" cellpadding="2">'),o=TradingView.createLineWidthEditor(),r=TradingView.createLineStyleEditor(),s=this.createColorPicker(),i=$("<input type='checkbox' class='visibility-switch'>"),e=this.addLabeledRow(n,"Grid",i),$("<td>").append(i).prependTo(e),$("<td>").append(s).appendTo(e),$("<td>").append(o).appendTo(e),$("<td>").append(r.render()).appendTo(e),this.bindControl(new D12(i,this._linetool.properties().grid.visible,!0,this.model(),"Change Fib Speed Resistance Fan Grid Visibility")),this.bindControl(new ColorBinding(s,this._linetool.properties().grid.color,!0,this.model(),"Change Fib Speed Resistance Fan Grid Line Color")),this.bindControl(new D11(r,this._linetool.properties().grid.linestyle,parseInt,!0,this.model(),"Change Fib Speed Resistance Fan Grid Line Style")),this.bindControl(new SliderBinder(o,this._linetool.properties().grid.linewidth,!0,this.model(),"Change Fib Speed Resistance Fan Grid Line Width")),this._table=this._table.add(t).add(n),e=$("<tr>"),e.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(i).appendTo(e),this.createLabeledCell("Background",i).appendTo(e),t=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(t).appendTo(e),this.bindControl(new D12(i,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Speed/Resistance Fan Background Visibility")),this.bindControl(new SliderBinder(t,this._linetool.properties().transparency,!0,this.model(),"Change Fib Speed/Resistance Fan Background Transparency")),this.loadData()},$3.prototype.widget=function(){return this._table},inherit($2,$49),$2.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");if(o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e){o=$("<td>"),o.appendTo(n);var r=$("<input type='text'>");r.appendTo(o),r.css("width","70px"),this.bindControl(new SimpleStringBinder(r,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))}else $("<td>"+$.t("Trend Line")+"</td>").appendTo(n);o=$("<td class='colorpicker-cell'>"),o.appendTo(n);var o=TradingView.addColorPicker(o),s=$("<td>");s.appendTo(n),r=TradingView.createLineWidthEditor(),r.appendTo(s),e||(e=$("<td>"),e.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(e),this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Fib Speed Resistance Arcs Style"))),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Fib Speed Resistance Arcs Visibility")),this.bindControl(new ColorBinding(o,t.color,!0,this.model(),"Change Fib Speed Resistance Arcs Line Color")),this.bindControl(new SliderBinder(r,t.linewidth,!0,this.model(),"Change Fib Speed Resistance Arcs Width"))},$2.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().trendline,!1);for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}t=$("<input type='checkbox' class='visibility-switch'>"),e=this.addLabeledRow(this._table,"Levels"),$("<td>").append(t).prependTo(e),this.bindControl(new D12(t,this._linetool.properties().showCoeffs,!0,this.model(),"Change Fib Speed Resistance Arcs Levels Visibility")),e=$("<tr>"),e.appendTo(this._table),t=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(t).appendTo(e),$("<td>"+$.t("Background")+"</td>").appendTo(e);var i=TradingView.createTransparencyEditor();$('<td colspan="3">').append(i).appendTo(e),this.bindControl(new D12(t,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Arcs Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Fib Arcs Background Transparency")),this.loadData()},$2.prototype.widget=function(){return this._table},inherit($4,$49),$4.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),e=this.addLabeledRow(e,"Line");$("<td>").append(n).appendTo(e),$("<td>").append(t).appendTo(e),$('<td colspan="3">').append(i.render()).appendTo(e),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),"Change Fib Spiral Line Color")),this.bindControl(new D11(i,this._linetool.properties().linestyle,parseInt,!0,this.model(),"Change Fib Spiral Line Style")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Fib Spiral Line Width")),this.loadData()},$4.prototype.widget=function(){return this._table},inherit($5,$49),$5.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e?(e=$("<td>"),e.appendTo(n),o=$("<input type='text'>"),o.appendTo(e),o.css("width","70px"),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))):this.createLabeledCell("Trend Line",i).appendTo(n),e=$("<td class='colorpicker-cell'>"),e.appendTo(n),e=TradingView.addColorPicker(e);var r=$("<td>");r.appendTo(n),o=TradingView.createLineWidthEditor(),o.appendTo(r),r=$("<td>"),r.appendTo(n),n=TradingView.createLineStyleEditor(),n.render().appendTo(r),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Pitchfork Line Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Pitchfork Line Color")),this.bindControl(new D11(n,t.linestyle,parseInt,!0,this.model(),"Change Pitchfork Line Style")),this.bindControl(new SliderBinder(o,t.linewidth,parseInt,this.model(),"Change Pitchfork Line Width"))},$5.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}var e=TradingView.createLineWidthEditor(),t=TradingView.createLineStyleEditor(),i=this.createColorPicker(),n=$("<input type='checkbox' class='visibility-switch'>"),o=this.addLabeledRow(this._table,"Show Labels",n);$("<td>").append(n).prependTo(o);var r=$("<table cellspacing='0' cellpadding='0'>"),s=$("<select><option value='left'>"+$.t("left")+"</option><option value='center'>"+$.t("center")+"</option><option value='right'>"+$.t("right")+"</option></select>"),a=$("<select><option value='top'>"+$.t("top")+"</option><option value='middle'>"+$.t("middle")+"</option><option value='bottom'>"+$.t("bottom")+"</option></select>"),o=$("<tr>");o.append("<td>"+$.t("Labels")+"</td>").append(s).append("<td>&nbsp</td>").append(a),o.appendTo(r),o=$("<tr>"),$("<td colspan='5'>").append(r).appendTo(o),o.appendTo(this._table),this.bindControl(new D11(s,this._linetool.properties().horzLabelsAlign,null,!0,this.model(),"Change Fib Time Zone Labels Alignment")),this.bindControl(new D11(a,this._linetool.properties().vertLabelsAlign,null,!0,this.model(),"Change Fib Time Zone Labels Alignment")),o=$("<tr>"),o.appendTo(this._table),r=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(r).appendTo(o),this.createLabeledCell("Background",r).appendTo(o),s=TradingView.createTransparencyEditor(),$('<td colspan="3">').append(s).appendTo(o),this.bindControl(new D12(n,this._linetool.properties().showLabels,!0,this.model(),"Change Fib Time Zone Labels Visibility")),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Fib Time Zone Color")),this.bindControl(new D11(t,this._linetool.properties().linestyle,parseInt,!0,this.model(),"Change Fib Time Zone Style")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Fib Time Zone Width")),this.bindControl(new D12(r,this._linetool.properties().fillBackground,!0,this.model(),"Change Fib Retracement Background Visibility")),this.bindControl(new SliderBinder(s,this._linetool.properties().transparency,!0,this.model(),"Change Fib Retracement Background Transparency")),this.loadData()},$5.prototype.widget=function(){return this._table},inherit($6,$49),$6.prototype.addLevelEditor=function(e,t,i){var n=$("<tr>");n.appendTo(this._table);var o=$("<td>");o.appendTo(n),i=$("<input type='checkbox' class='visibility-switch'>"),i.appendTo(o),e?(e=$("<td>"),e.appendTo(n),o=$("<input type='text'>"),o.appendTo(e),o.css("width","70px"),this.bindControl(new SimpleStringBinder(o,t.coeff,ToFloatTransformer(t.coeff.value()),!1,this.model(),"Change Pitchfork Line Coeff"))):this.createLabeledCell("Trend Line",i).appendTo(n),e=$("<td class='colorpicker-cell'>"),e.appendTo(n),e=TradingView.addColorPicker(e),o=$("<td>"),o.appendTo(n),n=TradingView.createLineWidthEditor(),n.appendTo(o),this.bindControl(new D12(i,t.visible,!0,this.model(),"Change Fib Wedge Visibility")),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Fib Wedge Line Color")),this.bindControl(new SliderBinder(n,t.linewidth,!0,this.model(),"Change Fib Wedge Width"))},$6.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.addLevelEditor(null,this._linetool.properties().trendline,!1);for(var e=1;11>=e;e++){var t="level"+e;this.addLevelEditor("Level "+e,this._linetool.properties()[t],!1)}t=$("<input type='checkbox' class='visibility-switch'>"),e=this.addLabeledRow(this._table,"Levels",t),$("<td>").append(t).prependTo(e),this.bindControl(new D12(t,this._linetool.properties().showCoeffs,!0,this.model(),"Change Fib Wedge Levels Visibility")),e=$("<tr>"),e.appendTo(this._table),t=$("<input type='checkbox' class='visibility-switch'>"),$("<td>").append(t).appendTo(e),this.createLabeledCell("Background",t).appendTo(e);var i=TradingView.createTransparencyEditor();$('<td colspan="3">').append(i).appendTo(e),this.bindControl(new D12(t,this._linetool.properties().fillBackground,!0,this.model(),"Change Wedge Background Visibility")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Wedge Background Transparency")),this.loadData()},$6.prototype.widget=function(){return this._table},inherit(A94,$49),A94.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=TradingView.createLineWidthEditor(),t=TradingView.createLineStyleEditor(),i=this.createColorPicker(),n=this.addLabeledRow(this._table,"Lines");$("<td>").append(i).appendTo(n),$("<td>").append(e).appendTo(n),$("<td>").append(t.render()).appendTo(n),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Circle Lines Color")),this.bindControl(new D11(t,this._linetool.properties().linestyle,parseInt,!0,this.model(),"Change Circle Lines Style")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Circle Lines Width")),this.loadData()},A94.prototype.widget=function(){return this._table},inherit($24,$14),$24.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="0">'),t=$('<table class="property-page" cellspacing="0" cellpadding="0">').data({"layout-tab":EditObjectDialog.TAB_NAME_INPUTS,"layout-tab-priority":EditObjectDialog.TAB_PRIORITY_INPUTS});this._table=e.add(t);for(var i=this._linetool.points(),n=0;n<i.size();n++){i.item(n);var o=$("<tr>");o.appendTo(e);var r=$("<td>");r.html("Point "+(n+1)+" Bar #"),r.appendTo(o),barEditCell=$("<td>"),barEditCell.appendTo(o),o=$("<input type='text'>"),o.appendTo(barEditCell),o.addClass("ticker");var r=this._linetool.properties().points[n],s=[ToIntTransformer(r.bar.value()),GreateTransformer(-5e3),LessTransformer(15e3)];this.bindControl(new SimpleStringBinder(o,r.bar,s,!1,this.model(),"Change "+this._linetool+" point bar index"))}e=StudyMetaInfo.findStudyMetaInfo(this.D0.studiesMetaData(),"RegressionTrend@tv-basicstudies"),$41.prototype.prepareLayoutImpl.call(this,e,t)},$24.prototype.widget=function(){return this._table},inherit(A95,$49),A95.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(e,"Line");$("<td>").prependTo(n),$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var n=this.createColorPicker(),o=this.createColorPicker(),r=this.createFontSizeEditor(),s=this.createFontEditor();this.createTextEditor(350,200);var a=this.createColorPicker(),l=TradingView.createTransparencyEditor(a),d=$('<input type="checkbox" class="visibility-switch">'),h=this.createColorPicker(),c=TradingView.createTransparencyEditor(h),p=$('<input type="checkbox" class="visibility-switch">');this.bindControl(new ColorBinding(n,this._linetool.properties().textcolor,!0,this.model(),"Change Text Color")),this.bindControl(new D11(r,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(s,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new ColorBinding(a,this._linetool.properties().labelBackgroundColor,!0,this.model(),"Change Text Background")),this.bindControl(new SliderBinder(l,this._linetool.properties().labelBackgroundTransparency,!0,this.model(),"Change Text Background Transparency")),this.bindControl(new D12(d,this._linetool.properties().fillLabelBackground,!0,this.model(),"Change Text Background Fill")),this.bindControl(new ColorBinding(h,this._linetool.properties().backgroundColor,!0,this.model(),"Change Text Background")),this.bindControl(new SliderBinder(c,this._linetool.properties().backgroundTransparency,!0,this.model(),"Change Text Background Transparency")),this.bindControl(new D12(p,this._linetool.properties().fillBackground,!0,this.model(),"Change Text Background Fill")),this.bindControl(new ColorBinding(o,this._linetool.properties().borderColor,!0,this.model(),"Change Text Border Color")),o=this.addLabeledRow(e,"Background",p),$("<td>").append(p).prependTo(o),$("<td>").append(h).appendTo(o),$('<td colspan="2">').append(c).appendTo(o),h=this.addLabeledRow(e,"Label"),$("<td>").prependTo(h),$("<td>").append(n).appendTo(h),$("<td>").append(s).appendTo(h),$("<td>").append(r).appendTo(h),o=this.addLabeledRow(e,"Label Background",d),$("<td>").append(d).prependTo(o),$("<td>").append(a).appendTo(o),$('<td colspan="2">').append(l).appendTo(o),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Date Range Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Date Range Line Width")),this.loadData()},A95.prototype.widget=function(){return this._table},inherit($22,$49),$22.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=this.createColorPicker(),t=this.createColorPicker(),i=TradingView.createTransparencyEditor(e),n=this.addLabeledRow(this._table,"Background");$("<td>").append(e).appendTo(n),$("<td>").append(t).appendTo(n),$("<td>").append(i).appendTo(n);var o=TradingView.createLineWidthEditor(),r=this.createColorPicker(),n=this.addLabeledRow(this._table,"Border");$("<td>").append(r).appendTo(n),$("<td>").appendTo(n),$("<td>").append(o).appendTo(n),this.bindControl(new ColorBinding(r,this._linetool.properties().trendline.color,!0,this.model(),"Change Projection Line Color")),this.bindControl(new ColorBinding(e,this._linetool.properties().color1,!0,this.model(),"Change Projection Background Color")),this.bindControl(new ColorBinding(t,this._linetool.properties().color2,!0,this.model(),"Change Projection Background Color")),this.bindControl(new SliderBinder(o,this._linetool.properties().linewidth,!0,this.model(),"Change Projection Border Width")),this.bindControl(new SliderBinder(i,this._linetool.properties().transparency,!0,this.model(),"Change Projection Background Transparency")),this.loadData()},$22.prototype.widget=function(){return this._table},inherit($15,$49),$15.prototype.prepareLayout=function(){function e(){c.slider("option","disabled",!p.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.createColorPicker(),o=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),r=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>'),s=this.createFontSizeEditor(),a=this.createFontEditor(),l=this.addLabeledRow(this._table,"Border");l.prepend("<td>"),$("<td>").append(i).appendTo(l),$("<td>").append(t).appendTo(l);var d=$('<input type="checkbox" class="visibility-switch">'),h=this.createColorPicker(),c=TradingView.createTransparencyEditor(h),a=this.createFontEditor(),l=this.addLabeledRow(this._table,"Background",d);$("<td>").append(d).prependTo(l),$("<td>").append(h).appendTo(l),$("<td>").append(c).appendTo(l);var p=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(d,this._linetool.properties().fillBackground,!0,this.model(),"Change Pattern Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Pattern Line Color")),this.bindControl(new ColorBinding(n,this._linetool.properties().textcolor,!0,this.model(),"Change Pattern Text Color")),this.bindControl(new ColorBinding(h,this._linetool.properties().backgroundColor,!0,this.model(),"Change Pattern Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Pattern Border Width")),this.bindControl(new SliderBinder(c,this._linetool.properties().transparency,!0,this.model(),"Change Pattern Background Transparency")),this.bindControl(new D11(s,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(a,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new D12(o,this._linetool.properties().bold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(r,this._linetool.properties().italic,!0,this.model(),"Change Text Font Italic")),t=$('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width:1}).append(n)).append($(document.createElement("td")).attr({width:1}).append(a)).append($(document.createElement("td")).attr({width:1}).append(s)).append($(document.createElement("td")).css("vertical-align","top").attr({width:1}).append(o)).append($(document.createElement("td")).css("vertical-align","top").append(r)).append($("</tr></table>")),l=this.addLabeledRow(this._table,""),$('<td colspan="5">').append(t).appendTo(l),this.loadData()},$15.prototype.widget=function(){return this._table},inherit(A86,$49),A86.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=TradingView.createLineWidthEditor(),t=this.createColorPicker(),i=this.createColorPicker(),n=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),o=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>'),r=this.createFontSizeEditor(),s=this.createFontEditor(),s=this.addLabeledRow(this._table,"Border");s.prepend("<td>"),$("<td>").append(t).appendTo(s),$("<td>").append(e).appendTo(s),s=this.createFontEditor(),this.bindControl(new ColorBinding(t,this._linetool.properties().color,!0,this.model(),"Change Pattern Line Color")),this.bindControl(new ColorBinding(i,this._linetool.properties().textcolor,!0,this.model(),"Change Pattern Text Color")),this.bindControl(new SliderBinder(e,this._linetool.properties().linewidth,!0,this.model(),"Change Pattern Border Width")),this.bindControl(new D11(r,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(s,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new D12(n,this._linetool.properties().bold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(o,this._linetool.properties().italic,!0,this.model(),"Change Text Font Italic")),e=$('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width:1}).append(i)).append($(document.createElement("td")).attr({width:1}).append(s)).append($(document.createElement("td")).attr({width:1}).append(r)).append($(document.createElement("td")).css("vertical-align","top").attr({width:1}).append(n)).append($(document.createElement("td")).css("vertical-align","top").append(o)).append($("</tr></table>")),s=this.addLabeledRow(this._table,""),$('<td colspan="5">').append(e).appendTo(s),this.loadData()},A86.prototype.widget=function(){
return this._table},inherit(LineToolNotePropertyPage,$49),LineToolNotePropertyPage.prototype.prepareLayout=function(){var e=this.createColorPicker(),t=this.createFontSizeEditor(),i=this.createFontEditor(),n=this.createTextEditor(350,200),o=this.createColorPicker(),r=this.createColorPicker(),s=TradingView.createTransparencyEditor(r),a=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),l=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');this.bindControl(new ColorBinding(e,this._linetool.properties().textColor,!0,this.model(),$.t("Change Text Color"))),this.bindControl(new D11(t,this._linetool.properties().fontSize,parseInt,!0,this.model(),$.t("Change Text Font Size"))),this.bindControl(new D11(i,this._linetool.properties().font,null,!0,this.model(),$.t("Change Text Font"))),this.bindControl(new SimpleStringBinder(n,this._linetool.properties().text,null,!0,this.model(),$.t("Change Text"))),this.bindControl(new ColorBinding(o,this._linetool.properties().markerColor,!0,this.model(),$.t("Change Marker and Border Color"))),this.bindControl(new ColorBinding(r,this._linetool.properties().backgroundColor,!0,this.model(),$.t("Change Background Color"))),this.bindControl(new SliderBinder(s,this._linetool.properties().backgroundTransparency,!0,this.model(),"Change Background Transparency")),this.bindControl(new D12(a,this._linetool.properties().bold,!0,this.model(),$.t("Change Text Font Bold"))),this.bindControl(new D12(l,this._linetool.properties().italic,!0,this.model(),$.t("Change Text Font Italic")));var d=$('<table class="property-page" cellspacing="0" cellpadding="2">'),h=$('<table class="property-page" cellspacing="0" cellpadding="2">'),c=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._table=d.add(c).add(h),$(document.createElement("tr")).append($(document.createElement("td")).attr({width:1}).append(e)).append($(document.createElement("td")).attr({width:1}).append(i)).append($(document.createElement("td")).attr({width:1}).append(t)).append($(document.createElement("td")).attr({width:1}).append(a)).append($(document.createElement("td")).append(l)).appendTo(d),$(document.createElement("tr")).append($(document.createElement("td")).attr({colspan:5}).append(n)).appendTo(d),e=this.addLabeledRow(c,$.t("Label")),$("<td>").attr("colspan",2).append(o).appendTo(e),e=this.addLabeledRow(c,$.t("Background")),$("<td>").append(r).appendTo(e),$("<td>").append(s).appendTo(e),this.loadData(),setTimeout(function(){n.select(),n.focus()},20)},LineToolNotePropertyPage.prototype.widget=function(){return this._table},LineToolNotePropertyPage.prototype.dialogPosition=function(e,t){if(e&&t){for(var i,n=0,o=this._linetool.D0.paneForSource(this._linetool),r=A45.getChartWidget();n<r._paneWidgets.length;n++)if(r._paneWidgets[n]._state==o){i=$(r._paneWidgets[n].canvas).offset().left;break}if(n=this._linetool.paneViews().item(0),o=new MathEx.Point(0,0),n&&(o=n._floatPoints.item(0)||this._linetool._fixedPoints.item(0)),n=TradingView.LineToolNote.TOOLTIP_WIDTH,i=(i||0)+o.x-n/2,o=t.outerWidth(),e.left<i&&e.left+o+10>i)return e.left-=e.left+o+10-i,e;if(e.left>i&&e.left<i+n+10)return e.left+=i+n+10-e.left,e}},inherit($43,$14),$43.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="0">'),t=$('<table class="property-page" cellspacing="0" cellpadding="0">').data({"layout-tab":EditObjectDialog.TAB_NAME_INPUTS,"layout-tab-priority":EditObjectDialog.TAB_PRIORITY_INPUTS});this._table=e.add(t);for(var i=this._linetool.points(),n=0;n<i.size();n++){i.item(n);var o=$("<tr>");o.appendTo(e);var r=$("<td>");r.html("Point "+(n+1)+" Bar #"),r.appendTo(o),barEditCell=$("<td>"),barEditCell.appendTo(o),o=$("<input type='text'>"),o.appendTo(barEditCell),o.addClass("ticker");var r=this._linetool.properties().points[n],s=[ToIntTransformer(r.bar.value()),GreateTransformer(-5e3),LessTransformer(15e3)];this.bindControl(new SimpleStringBinder(o,r.bar,s,!1,this.model(),"Change "+this._linetool+" point bar index"))}e=StudyMetaInfo.findStudyMetaInfo(this.D0.studiesMetaData(),this._linetool.studyId()),$41.prototype.prepareLayoutImpl.call(this,e,t)},$43.prototype.widget=function(){return this._table},inherit($44,D7),inherit($44,SeriesStylePropertyPageMixin),$44.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="2">'),t=$('<table class="property-page" cellspacing="0" cellpadding="2">'),i=$('<table class="property-page" cellspacing="0" cellpadding="2">'),n=$('<table class="property-page" cellspacing="0" cellpadding="2">'),o=$('<table class="property-page" cellspacing="0" cellpadding="2">'),r=this.D1.properties();this._prepareSeriesStyleLayout(e,t,i,r),this._table=e.add(t).add(i).add(n).add(o),e=$('<input type="checkbox">'),n=this.addLabeledRow(n,"Price Line",e),$("<td>").append(e).prependTo(n),this.bindControl(new D12(e,r.showPriceLine,!0,this.model(),"Change Price Price Line")),n=this.createSeriesMinTickEditor(),e=$("<tr>"),e.appendTo(o),$("<td>"+$.t("Override Min Tick")+"</td>").appendTo(e),$("<td>").append(n).appendTo(e),this.bindControl(new D11(n,r.minTick,null,!0,this.model(),"Change MinTick")),$47.prototype._putStudyDefaultStyles.call(this,o)},$44.prototype.loadData=function(){this.superclass.prototype.loadData.call(this),this.switchStyle()},$44.prototype.switchStyle=function(){switch($(this._barsTbody).add(this._barsColorerTbody).add(this._candlesTbody).add(this._candlesColorerTbody).add(this._hollowCandlesTbody).add(this._lineTbody).add(this._areaTbody).css("display","none"),this.D1.properties().style.value()){case TradingView.Series.STYLE_BARS:this._barsTbody.css("display","table-row-group"),this._barsColorerTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_CANDLES:this._candlesTbody.css("display","table-row-group"),this._candlesColorerTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_HOLLOW_CANDLES:this._hollowCandlesTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_LINE:this._lineTbody.css("display","table-row-group");break;case TradingView.Series.STYLE_AREA:this._areaTbody.css("display","table-row-group")}},$44.prototype.widget=function(){return this._table},inherit(A97,$49),A97.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=[],e=6===this._linetool.pointsCount()?"Subminuette Minuette Minute Minor Intermediate Primary Cycle SuperCycle GrandSuperCycle".split(" ").map(function(e){return $.t(e)}):["Minor","Major"].map(function(e){return $.t(e)});waveTypeEditor=this.createKeyCombo(e),waveTypeEditor.width(300),this.createFontEditor(),e=this.createFontSizeEditor(),$('<span class="property-page-small-select">').append(e);var e=this.createColorPicker(),t=$('<input type="checkbox" class="visibility-switch">'),i=$('<input type="checkbox" class="visibility-switch">'),n=this.addLabeledRow(this._table,"Wave Size");$("<td>").prependTo(n),$("<td>").append(waveTypeEditor).appendTo(n),n=this.addLabeledRow(this._table,"Color"),$("<td>").prependTo(n),$("<td>").append(e).appendTo(n),n=this.addLabeledRow(this._table,"Show Wave",i),$("<td>").append(i).prependTo(n),n=this.addLabeledRow(this._table,"Show Background",t),$("<td>").append(t).prependTo(n),this.bindControl(new D12(t,this._linetool.properties().showBackground,!0,this.model(),"Change Elliott Labels Background")),this.bindControl(new ColorBinding(e,this._linetool.properties().color,!0,this.model(),"Change Elliott Label Color")),this.bindControl(new D11(waveTypeEditor,this._linetool.properties().wavesize,parseInt,!0,this.model(),"Change Elliott Wave Size")),this.bindControl(new D12(i,this._linetool.properties().showWave,!0,this.model(),"Change Elliott Labels Background")),this.loadData()},A97.prototype.widget=function(){return this._table},inherit($25,$14),$25.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=this.addLabeledRow(e,"Stop Level. Ticks:"),i=$("<input type='text'>");$("<td>").append(i).appendTo(t),i.addClass("ticker");var n=$("<input type='text'>");$("<td>"+$.t("Price:")+"</td>").appendTo(t),$("<td>").append(n).appendTo(t);var o=this.addLabeledRow(e,"Entry price:"),r=$("<input type='text'>");$('<td colspan="2">').append(r).appendTo(o);var s=this.addLabeledRow(e,"Profit Level. Ticks:"),o=$("<input type='text'>");$("<td>").append(o).appendTo(s),o.addClass("ticker");var a=$("<input type='text'>");$("<td>"+$.t("Price:")+"</td>").appendTo(s),$("<td>").append(a).appendTo(s),"LineToolRiskRewardLong"==this._linetool.getConstructor()&&(t.detach().appendTo(e),s.detach().prependTo(e)),e=[ToIntTransformer(this._linetool.properties().stopLevel.value()),GreateTransformer(0),LessTransformer(1e9)],this.bindControl(new SimpleStringBinder(i,this._linetool.properties().stopLevel,e,!1,this.model(),"Change "+this._linetool+" stop level")),e=[ToIntTransformer(this._linetool.properties().profitLevel.value()),GreateTransformer(0),LessTransformer(1e9)],this.bindControl(new SimpleStringBinder(o,this._linetool.properties().profitLevel,e,!1,this.model(),"Change "+this._linetool+" profit level")),e=[ToFloatTransformer(this._linetool.properties().entryPrice.value())],this.bindControl(new SimpleStringBinder(r,this._linetool.properties().entryPrice,e,!1,this.model(),"Change "+this._linetool+" entry price"));var l=this,e=[ToFloatTransformer(this._linetool.properties().stopPrice.value()),function(e){return l._linetool.preparseStopPrice(e)}];this.bindControl(new SimpleStringBinder(n,this._linetool.properties().stopPrice,e,!1,this.model(),"Change "+this._linetool+" stop price")),e=[ToFloatTransformer(this._linetool.properties().targetPrice.value()),function(e){return l._linetool.preparseProfitPrice(e)}],this.bindControl(new SimpleStringBinder(a,this._linetool.properties().targetPrice,e,!1,this.model(),"Change "+this._linetool+" stop price"))},$25.prototype.widget=function(){return this._table},inherit($26,$49),$26.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.addLabeledRow(e,"Lines");$("<td>").append(i).appendTo(n),$("<td>").append(t).appendTo(n);var n=this.addLabeledRow(e,"Stop Color:"),o=this.createColorPicker();$("<td>").append(o).appendTo(n);var r=TradingView.createTransparencyEditor(o);$('<td colspan="2">').append(r).appendTo(n);var n=this.addLabeledRow(e,"Target Color:"),s=this.createColorPicker();$("<td>").append(s).appendTo(n);var a=TradingView.createTransparencyEditor(s);$('<td colspan="2">').append(a).appendTo(n);var n=this.addLabeledRow(e,"Text:"),e=this.createColorPicker(),l=this.createFontSizeEditor(),d=this.createFontEditor();$("<td>").append(e).appendTo(n),$("<td>").append(d).appendTo(n),$("<td>").append(l).appendTo(n),this.bindControl(new ColorBinding(i,this._linetool.properties().linecolor,!0,this.model(),"Change Risk/Reward line Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Risk/Reward line width")),this.bindControl(new ColorBinding(o,this._linetool.properties().stopBackground,!0,this.model(),"Change stop color")),this.bindControl(new SliderBinder(r,this._linetool.properties().stopBackgroundTransparency,!0,this.model(),"Change Stop Background Transparency")),this.bindControl(new ColorBinding(s,this._linetool.properties().profitBackground,!0,this.model(),"Change target color")),this.bindControl(new SliderBinder(a,this._linetool.properties().profitBackgroundTransparency,!0,this.model(),"Change Profit Background Transparency")),this.bindControl(new D11(l,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(d,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new ColorBinding(e,this._linetool.properties().textcolor,!0,this.model(),"Change Text Color")),this.loadData()},$26.prototype.widget=function(){return this._table},inherit($33,$49),$33.prototype.prepareLayout=function(){function e(){c.slider("option","disabled",!p.value())}this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var t=TradingView.createLineWidthEditor(),i=this.createColorPicker(),n=this.createColorPicker(),o=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),r=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>'),s=this.createFontSizeEditor(),a=this.createFontEditor(),l=this.addLabeledRow(this._table,"Border");l.prepend("<td>"),$("<td>").append(i).appendTo(l),$("<td>").append(t).appendTo(l);var d=$('<input type="checkbox" class="visibility-switch">'),h=this.createColorPicker(),c=TradingView.createTransparencyEditor(h),a=this.createFontEditor(),l=this.addLabeledRow(this._table,"Background",d);$("<td>").append(d).prependTo(l),$("<td>").append(h).appendTo(l),$("<td>").append(c).appendTo(l);var p=this._linetool.properties().fillBackground;e(),this._linetool.properties().fillBackground.subscribe(null,e),this.bindControl(new D12(d,this._linetool.properties().fillBackground,!0,this.model(),"Change Pattern Filling")),this.bindControl(new ColorBinding(i,this._linetool.properties().color,!0,this.model(),"Change Pattern Line Color")),this.bindControl(new ColorBinding(n,this._linetool.properties().textcolor,!0,this.model(),"Change Pattern Text Color")),this.bindControl(new ColorBinding(h,this._linetool.properties().backgroundColor,!0,this.model(),"Change Pattern Background Color")),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),"Change Pattern Border Width")),this.bindControl(new SliderBinder(c,this._linetool.properties().transparency,!0,this.model(),"Change Pattern Background Transparency")),this.bindControl(new D11(s,this._linetool.properties().fontsize,parseInt,!0,this.model(),"Change Text Font Size")),this.bindControl(new D11(a,this._linetool.properties().font,null,!0,this.model(),"Change Text Font")),this.bindControl(new D12(o,this._linetool.properties().bold,!0,this.model(),"Change Text Font Bold")),this.bindControl(new D12(r,this._linetool.properties().italic,!0,this.model(),"Change Text Font Italic")),t=$('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width:1}).append(n)).append($(document.createElement("td")).attr({width:1}).append(a)).append($(document.createElement("td")).attr({width:1}).append(s)).append($(document.createElement("td")).css("vertical-align","top").attr({width:1}).append(o)).append($(document.createElement("td")).css("vertical-align","top").append(r)).append($("</tr></table>")),l=this.addLabeledRow(this._table,""),$('<td colspan="5">').append(t).appendTo(l),this.loadData()},$33.prototype.widget=function(){return this._table},inherit(A96,$49),A96.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),o=this.addLabeledRow(e,$.t("Line"));$("<td>").append(n).appendTo(o),$("<td>").append(t).appendTo(o),$('<td colspan="3">').append(i.render()).appendTo(o);var o=this.addLabeledRow(e,$.t("Text")),e=this.createColorPicker(),r=this.createFontSizeEditor(),s=this.createFontEditor(),a=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),l=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');$("<td>").append(e).appendTo(o),$("<td>").append(s).appendTo(o),$("<td>").append(r).appendTo(o),$("<td>").append(a).appendTo(o),$("<td>").append(l).appendTo(o);var o=$("<tbody>").appendTo(this._table),d=$('<input type="checkbox" class="visibility-switch">'),h=this.createColorPicker(),c=TradingView.createTransparencyEditor(h),o=this.addLabeledRow(o,$.t("Background"),d),p=$("<table>");$('<td colspan="5">').append(p).appendTo(o),o=$("<tr>").appendTo(p),$("<td>").append(d).appendTo(o),$("<td>").append(h).appendTo(o),$("<td>").append(c).appendTo(o);var u=$("<tbody>").appendTo(this._table),f=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),p=$('<input type="checkbox">').appendTo(f),g=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),m=$('<input type="checkbox">').appendTo(g),_=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),v=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),o=this.addLabeledRow(u,$.t("Left End"));$('<td colspan="3">').appendTo(o).append(_).append(f),o=this.addLabeledRow(u,$.t("Right End")),$('<td colspan="3">').appendTo(o).append(v).append(g),o=$("<tbody>").appendTo(this._table),o=$("<tr>").appendTo(o),u=$("<input type='checkbox'>"),f=$("<label style='display:block'>").append(u).append($.t("Show Prices")),$("<td colspan='2'>").append(f).appendTo(o),this.bindControl(new D11(r,this._linetool.properties().fontsize,parseInt,!0,this.model(),$.t("Change Text Font Size"))),this.bindControl(new D11(s,this._linetool.properties().font,null,!0,this.model(),$.t("Change Text Font"))),this.bindControl(new ColorBinding(e,this._linetool.properties().textcolor,!0,this.model(),$.t("Change Text Color"))),this.bindControl(new D12(a,this._linetool.properties().bold,!0,this.model(),$.t("Change Text Font Bold"))),this.bindControl(new D12(l,this._linetool.properties().italic,!0,this.model(),$.t("Change Text Font Italic"))),this.bindControl(new D12(u,this._linetool.properties().showPrices,!0,this.model(),$.t("Change Disjoint Angle Show Prices"))),this.bindControl(new D12(p,this._linetool.properties().extendLeft,!0,this.model(),$.t("Change Disjoint Angle Extending Left"))),this.bindControl(new D12(m,this._linetool.properties().extendRight,!0,this.model(),$.t("Change Disjoint Angle Extending Right"))),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),$.t("Change Disjoint Angle Color"))),this.bindControl(new D11(i,this._linetool.properties().linestyle,parseInt,!0,this.model(),$.t("Change Disjoint Angle Style"))),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),$.t("Change Disjoint Angle Width"))),this.bindControl(new D11(_,this._linetool.properties().leftEnd,parseInt,!0,this.model(),$.t("Change Disjoint Angle Left End"))),this.bindControl(new D11(v,this._linetool.properties().rightEnd,parseInt,!0,this.model(),$.t("Change Disjoint Angle Right End"))),this.bindControl(new D12(d,this._linetool.properties().fillBackground,!0,this.model(),$.t("Change Disjoint Angle Filling"))),this.bindControl(new ColorBinding(h,this._linetool.properties().backgroundColor,!0,this.model(),$.t("Change Disjoint Angle Background Color"))),this.bindControl(new SliderBinder(c,this._linetool.properties().transparency,!0,this.model(),$.t("Change Disjoint Angle Background Transparency"))),this.loadData()},A96.prototype.widget=function(){return this._table},inherit($7,$49),$7.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),o=this.addLabeledRow(e,$.t("Line"));$("<td>").append(n).appendTo(o),$("<td>").append(t).appendTo(o),$('<td colspan="3">').append(i.render()).appendTo(o);var o=this.addLabeledRow(e,$.t("Text")),e=this.createColorPicker(),r=this.createFontSizeEditor(),s=this.createFontEditor(),a=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),l=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');$("<td>").append(e).appendTo(o),$("<td>").append(s).appendTo(o),$("<td>").append(r).appendTo(o),$("<td>").append(a).appendTo(o),$("<td>").append(l).appendTo(o);var o=$("<tbody>").appendTo(this._table),d=$('<input type="checkbox" class="visibility-switch">'),h=this.createColorPicker(),c=TradingView.createTransparencyEditor(h),o=this.addLabeledRow(o,$.t("Background"),d),p=$("<table>");$('<td colspan="5">').append(p).appendTo(o),o=$("<tr>").appendTo(p),$("<td>").append(d).appendTo(o),$("<td>").append(h).appendTo(o),$("<td>").append(c).appendTo(o);var u=$("<tbody>").appendTo(this._table),f=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),p=$('<input type="checkbox">').appendTo(f),g=$("<label>"+$.t("Extend")+" </label>").css({"margin-left":"8px"}),m=$('<input type="checkbox">').appendTo(g),_=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),v=$("<select><option value='0'>"+$.t("Normal")+"</option><option value='1'>"+$.t("Arrow")+"</option></select>"),o=this.addLabeledRow(u,$.t("Left End"));$('<td colspan="3">').appendTo(o).append(_).append(f),o=this.addLabeledRow(u,$.t("Right End")),$('<td colspan="3">').appendTo(o).append(v).append(g),o=$("<tbody>").appendTo(this._table),o=$("<tr>").appendTo(o),u=$("<input type='checkbox'>"),f=$("<label style='display:block'>").append(u).append($.t("Show Prices")),$("<td colspan='2'>").append(f).appendTo(o),this.bindControl(new D11(r,this._linetool.properties().fontsize,parseInt,!0,this.model(),$.t("Change Text Font Size"))),this.bindControl(new D11(s,this._linetool.properties().font,null,!0,this.model(),$.t("Change Text Font"))),this.bindControl(new ColorBinding(e,this._linetool.properties().textcolor,!0,this.model(),$.t("Change Text Color"))),this.bindControl(new D12(a,this._linetool.properties().bold,!0,this.model(),$.t("Change Text Font Bold"))),this.bindControl(new D12(l,this._linetool.properties().italic,!0,this.model(),$.t("Change Text Font Italic"))),this.bindControl(new D12(u,this._linetool.properties().showPrices,!0,this.model(),$.t("Change Disjoint Angle Show Prices"))),this.bindControl(new D12(p,this._linetool.properties().extendLeft,!0,this.model(),$.t("Change Disjoint Angle Extending Left"))),this.bindControl(new D12(m,this._linetool.properties().extendRight,!0,this.model(),$.t("Change Disjoint Angle Extending Right"))),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),$.t("Change Disjoint Angle Color"))),this.bindControl(new D11(i,this._linetool.properties().linestyle,parseInt,!0,this.model(),$.t("Change Disjoint Angle Style"))),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),$.t("Change Disjoint Angle Width"))),this.bindControl(new D11(_,this._linetool.properties().leftEnd,parseInt,!0,this.model(),$.t("Change Disjoint Angle Left End"))),this.bindControl(new D11(v,this._linetool.properties().rightEnd,parseInt,!0,this.model(),$.t("Change Disjoint Angle Right End"))),this.bindControl(new D12(d,this._linetool.properties().fillBackground,!0,this.model(),$.t("Change Disjoint Angle Filling"))),this.bindControl(new ColorBinding(h,this._linetool.properties().backgroundColor,!0,this.model(),$.t("Change Disjoint Angle Background Color"))),this.bindControl(new SliderBinder(c,this._linetool.properties().transparency,!0,this.model(),$.t("Change Disjoint Angle Background Transparency"))),this.loadData()},$7.prototype.widget=function(){return this._table},inherit($13,$49),$13.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2");var e=this.createColorPicker(),t=this.addLabeledRow(this._table,"Color:");$("<td>").append(e).appendTo(t),t=this._linetool.properties(),this._div=$("<div>").append(this._table),this.bindControl(new ColorBinding(e,t.color,!0,this.model(),"Change Icon Color")),this.loadData()},$13.prototype.widget=function(){return this._div},inherit($29,$49),$29.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=$("<tbody>").appendTo(this._table),t=TradingView.createLineWidthEditor(),i=TradingView.createLineStyleEditor(),n=this.createColorPicker(),e=this.addLabeledRow(e,$.t("Line"));$("<td>").append(n).appendTo(e),$("<td>").append(t).appendTo(e),$('<td colspan="3">').append(i.render()).appendTo(e);var o=$("<tbody>").appendTo(this._table),e=this.addLabeledRow(o,$.t("Text")),r=this.createColorPicker(),s=this.createFontSizeEditor(),a=this.createFontEditor(),l=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"></span></span>'),d=$('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"></span></span>');$("<td>").append(r).appendTo(e),$("<td>").append(a).appendTo(e),$("<td>").append(s).appendTo(e),$("<td>").append(l).appendTo(e),$("<td>").append(d).appendTo(e);var h=$('<input type="checkbox">'),c=$('<input type="checkbox">'),e=this.addLabeledRow(o,$.t("Extend Right End"));$('<td colspan="3">').appendTo(e).append(h),e=this.addLabeledRow(o,$.t("Extend Left End")),$('<td colspan="3">').appendTo(e).append(c);var p=$('<input type="checkbox">'),u=$('<input type="checkbox">'),f=$('<input type="checkbox">'),e=this.addLabeledRow(o,$.t("Show Price Range"));$('<td colspan="3">').appendTo(e).append(p),e=this.addLabeledRow(o,$.t("Show Bars Range")),$('<td colspan="3">').appendTo(e).append(u),e=this.addLabeledRow(o,$.t("Always Show Stats")),$('<td colspan="3">').appendTo(e).append(f),this.bindControl(new D12(p,this._linetool.properties().showPriceRange,!0,this.model(),$.t("Change Trend Line Show Price Range"))),this.bindControl(new D12(u,this._linetool.properties().showBarsRange,!0,this.model(),$.t("Change Trend Line Show Bars Range"))),this.bindControl(new D11(s,this._linetool.properties().fontsize,parseInt,!0,this.model(),$.t("Change Text Font Size"))),this.bindControl(new D11(a,this._linetool.properties().font,null,!0,this.model(),$.t("Change Text Font"))),this.bindControl(new ColorBinding(r,this._linetool.properties().textcolor,!0,this.model(),$.t("Change Text Color"))),this.bindControl(new D12(l,this._linetool.properties().bold,!0,this.model(),$.t("Change Text Font Bold"))),this.bindControl(new D12(d,this._linetool.properties().italic,!0,this.model(),$.t("Change Text Font Italic"))),this.bindControl(new ColorBinding(n,this._linetool.properties().linecolor,!0,this.model(),$.t("Change Trend Line Color"))),this.bindControl(new D11(i,this._linetool.properties().linestyle,parseInt,!0,this.model(),$.t("Change Trend Line Style"))),this.bindControl(new SliderBinder(t,this._linetool.properties().linewidth,!0,this.model(),$.t("Change Trend Line Width"))),this.bindControl(new D12(h,this._linetool.properties().extendRight,!0,this.model(),$.t("Change Trend Angle Extending Right"))),this.bindControl(new D12(c,this._linetool.properties().extendLeft,!0,this.model(),$.t("Change Trend Angle Extending Left"))),this.bindControl(new D12(f,this._linetool.properties().alwaysShowStats,!0,this.model(),$.t("Change Trend Line Always Show Stats"))),this.loadData()},$29.prototype.widget=function(){return this._table},inherit($28,$14),$28.prototype.prepareLayout=function(){this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var e=this._linetool.points().item(0),t=this._linetool.properties().points[0];if(e&&t){var i=this._createPointRow(e,t,"");this._table.append(i),i=$("<tr>").appendTo(this._table),$("<td>").append($.t("Angle")).appendTo(i),e=$("<input type='text'>"),$("<td>").append(e).appendTo(i),t=[ToFloatTransformer(t.price.value()),GreateTransformer(-360),LessTransformer(360)],this.bindControl(new SimpleStringBinder(e,this._linetool.properties().angle,t,!1,this.model(),$.t("Change angle"))),this.loadData()}},$28.prototype.widget=function(){return this._table},inherit($42,D7),$42.prototype.prepareLayout=function(){var e=$('<table class="property-page" cellspacing="0" cellpadding="2">'),t=$('<table class="property-page" cellspacing="0" cellpadding="2">');this._table=e.add(t);for(var i,n=this.D1.properties(),o=[["Base",n.styles.baseLine],["Up",n.styles.upLine],["Down",n.styles.downLine]],r=0;r<o.length;r++){var s=o[r],a=$("<input type='checkbox' class='visibility-switch'/>"),l=this.createColorPicker(),d=TradingView.createLineWidthEditor(),h=TradingView.createLineStyleEditor(),c=this.addLabeledRow(e,s[0],a);r||(i=l),$("<td>").append(a).prependTo(c),$("<td>").append(l).appendTo(c),$("<td>").append(d).appendTo(c),$("<td>").append(h.render()).appendTo(c),c="Change "+s[0],this.bindControl(new D12(a,s[1].visible,!0,this.model(),c)),this.bindControl(new ColorBinding(l,s[1].color,!0,this.model(),c)),this.bindControl(new SliderBinder(d,s[1].linewidth,!0,this.model(),c)),this.bindControl(new D11(h,s[1].linestyle,parseInt,!0,this.model(),c))}e=$("<input type='checkbox' class='visibility-switch'/>"),o=$("<input type='checkbox'/>"),c=$("<tr>").appendTo(t),$("<td>").append(e).appendTo(c),this.createLabeledCell("Pearson's R",e).appendTo(c),c=$("<tr>").appendTo(t),$("<td>").append(o).appendTo(c),this.createLabeledCell("Extend Lines",o).appendTo(c),c=$("<tr>").appendTo(t),$("<td>").appendTo(c),$("<td>Background</td>").appendTo(c),t=TradingView.createTransparencyEditor(i),$("<td>").append(t).appendTo(c),this.bindControl(new D12(e,n.styles.showPearsons,!0,this.model(),"Change show Pearson's R")),this.bindControl(new D12(o,n.styles.extendLines,!0,this.model(),"Change Extend Lines")),this.bindControl(new SliderBinder(t,n.styles.transparency,!0,this.model(),"Change Background Transparency"))},$42.prototype.widget=function(){return this._table},inherit($50,D7),$50.prototype.prepareLayout=function(){var e=this.D1.properties();this._table=$('<table class="property-page" cellspacing="0" cellpadding="2">');var t=this.addLabeledRow(this._table,"Volume"),i=TradingView.createPlotEditor();$("<td>").append(i).appendTo(t),this.bindControl(new D11(i,e.styles.vol.plottype,parseInt,!0,this.model(),"Change Volume Plot Style")),i=this.createColorPicker(),$("<td>").append(i).appendTo(t),this.bindControl(new ColorBinding(i,e.palettes.volumePalette.colors[0].color,!0,this.model(),"Change Up Volume color")),i=this.createColorPicker(),$("<td>").append(i).appendTo(t),this.bindControl(new ColorBinding(i,e.palettes.volumePalette.colors[1].color,!0,this.model(),"Change Down Volume color")),i=TradingView.createTransparencyEditor(),$("<td>").append(i).appendTo(t),this.bindControl(new SliderBinder(i,e.transparency,!0,this.model(),"Change Volume Transparency")),i=$("<input type='checkbox'>"),$("<td>").appendTo(t),$("<td>").append(i).appendTo(t),$("<td>"+$.t("Price Line")+"</td>").appendTo(t),this.bindControl(new D12(i,e.styles.vol.trackPrice,!0,this.model(),"Change Price Line")),e=e.styles.vol_ma,t=this.addLabeledRow(this._table,"Volume MA"),i=TradingView.createPlotEditor(),$("<td>").append(i).appendTo(t),this.bindControl(new D11(i,e.plottype,parseInt,!0,this.model(),"Change Volume MA Plot Style")),$("<td>").html("&nbsp;").appendTo(t),i=this.createColorPicker(),$("<td>").append(i).appendTo(t),this.bindControl(new ColorBinding(i,e.color,!0,this.model(),"Change Volume MA color")),i=TradingView.createTransparencyEditor(i),$("<td>").append(i).appendTo(t),this.bindControl(new SliderBinder(i,e.transparency,!0,this.model(),"Change Volume MA Transparency")),i=TradingView.createLineWidthEditor(),$("<td>").append(i).appendTo(t),this.bindControl(new SliderBinder(i,e.linewidth,!0,this.model(),"Change Volume MA Line Width")),i=$("<input type='checkbox'>"),$("<td>").append(i).appendTo(t),$("<td>"+$.t("Price Line")+"</td>").appendTo(t),this.bindControl(new D12(i,e.trackPrice,!0,this.model(),"Change Price Line")),$47.prototype._putStudyDefaultStyles.call(this,this._table,8);
},$50.prototype.widget=function(){return this._table},A3=function(e){this._$container=$(e),this._$header=this._$container.parent().find(".header").eq(0)},A3.prototype.setSelectableHeader=function(e){var t=this._$container.parent().find(".header");t.addClass("selectable").append($("<span>").addClass("dropdown")),this._title=t.find(".title"),t=t.find(".title, .dropdown"),t.on("click",e),TradingView.bindPopupMenu(t,null,{event:"show-popup",addClass:"narrow",careBottomBorder:!0})},A3.prototype.updateTitleFull=function(e,t){this._notification_count||(this._notification_count=0),t&&(this._notification_count+=t),0<=this._notification_count||(this._notification_count=0);var i=this._$container.parent().find(".header .title");i.text(e),this._notification_count&&i.prepend($("<span>").addClass("ch-new-counter").text(this._notification_count))},A3.prototype.clearNotifications=function(){this._notification_count=0,this.updateTitle()},A3.prototype.HIGHLIGHT_NUM_FLICKS=5,A3.prototype.resize=$.noop,TradingView.MarketSummaryWidget=function(e){this._bridge=e,this.D2=e.properties||{},this.D2.symbols||(this.D2.symbols=this.defaults().symbols),this._initLayout(),this._bridge.visible.subscribe(this._visibilityChanged.bind(this)),this._bridge.height.subscribe(this._onHeightChange.bind(this))},TradingView.MarketSummaryWidget.prototype.defaults=function(){return{symbols:[{symbol:"S&P 500",symbol_full:"FX:SPX500",short_name:"SPX500",color:"#e0725e"},{symbol:"Nikkei 225",symbol_full:"FX:JPN225",short_name:"JPN225",color:"#64a81e"},{symbol:"Nasdaq",symbol_full:"FX:NAS100",short_name:"NAS100",color:"#fdaf48"}],minHeight:150}},TradingView.MarketSummaryWidget.prototype._initLayout=function(){var e=this._bridge.$body;e.addClass("market-summary");var t=$.map(this.D2.symbols,function(e){return{symbol:e.symbol_full,options:{line:{color:e.color}}}});this.$chart=$('<div class="mini-chart" style="position: relative;"></div>'),this.$timeframes=$('<div class="timeframe"></div>'),this._chart=new TradingView.MiniChart(t,this.$chart,{showMessage:!1,timeframe:{container:this.$timeframes,value:"1m",visible:!0},showTimeframes:!0,chartOptions:{minHeight:this.defaults().minHeight,minWidth:W77.enabled("browser_extension")?330:null,grid:{xIsVisible:!1,yIsVisible:!0,line:{width:1,style:CanvasEx.LINESTYLE_DASHED,color:"#ebedf0"}},yScale:{visible:!0,position:"right",isPercentage:!0,paddingLeft:10,paddingRight:4,marginInPercents:0,font:{size:10,family:"Helvetica",color:"#c8cacd"},drawOverPlotArea:!1,drawTickMarkLine:!1,maxTickMarkAmount:5},xScale:{visible:!0,font:{size:10,family:"Helvetica",color:"#c8cacd"}},plot:{line:{width:2},belowLineFillStyle:"transparent",aboveLineFillStyle:"transparent"},loading:{showWhileNoPlots:!0}}}),this.$quotes=$(Mustache.render('<table class="quote-tickers"><tr>{{#symbols}}<td><div class="market-summary-quote-ticker chart-legend" data-symbol="{{symbol_full}}"><a href="/e/?symbol={{symbol_full}}" target="_blank" class="chart-link" data-symbol="{{symbol_full}}" style="border-color: {{color}}"><div class="symbol-name symbol-short-name">{{symbol}}</div><div class="symbol-tiker symbol-change-direction symbol-last">&nbsp;</div></a></div></td>{{/symbols}}</tr></table>',{symbols:this.D2.symbols})),this._quotes=[];var i=this;this.$quotes.find(".market-summary-quote-ticker").each(function(){var e=$(this);i._quotes.push(new TradingView.QuoteTicker(e.data("symbol"),e))}),e.append(this.$timeframes,this.$chart,this.$quotes),this._onHeightChange()},TradingView.MarketSummaryWidget.prototype._onHeightChange=function(e){e=this._bridge.$body.height()-this.$quotes.outerHeight(!0)-this.$timeframes.outerHeight(!0),e=Math.max(e,this.defaults().minHeight),this.$chart.height(e)},TradingView.MarketSummaryWidget.prototype._visibilityChanged=function(e){e||this.$chart.css("visibility","hidden"),this._quotes.forEach(function(t){t.enabled=!!e}),e?this._chart.connect(function(){this.$chart.css("visibility","visible"),this._onHeightChange()}.bind(this)):this._chart.disconnect()};var counter=0;A12=function(e){this._charWidgetCollection=e.getChartWidgetCollection(),this.D4=null,this._views=[],this._itemsBinding=[],this._headerBinding=[],this._boxBinding=[],this.$container=$('<div class="chart-data-window"></div>').appendTo(e.$body),this._scroll=new A59(e.$body,this.$container),this.visible=e.visible.value(),this._updateSource(),this._upadateLayout(),this._charWidgetCollection.activeChartWidget.subscribe(this.updateAll.bind(this)),e.visible.subscribe(this._onVisibilityChange.bind(this)),this._charWidgetCollection.selectedSource.subscribe(function(e){this.updateHighlight({source:e,updateScroll:!0})}.bind(this)),e.setTitle("Data Window")},A12.prototype._updateSource=function(){if(this.visible){this._views=[],this.D4&&(this.D4._dataWindowWidget=null),this.D4=this._charWidgetCollection.activeChartWidget.value(),this.D4._dataWindowWidget=this;var e=this.D4.model();if(e)for(var e=e.model().D19(),t=0;t<e.size();t++){var i=e.item(t).dataWindowView();i&&this._views.push(i)}}},A12.prototype._upadateLayout=function(){if(this.visible){var e=this;this.$container.empty(),this._itemsBinding=[],this._headerBinding=[];for(var t=this._boxBinding.length-1;t>=0;t--){var i=this._boxBinding[t];i.src.properties().visible.unsubscribe(e,i.visibilityHandler)}for(this._boxBinding=[],t=0;t<this._views.length;++t)i=this._views[t],i.items().size()&&function(t){var i=null;t instanceof SeriesDataWindowView?i=t._series:(t instanceof StudyDataWindowView||t instanceof A49)&&(i=t.D1);var n=$('<div class="box"></div>').appendTo(e.$container),o=t.header()?$('<div class="chart-data-window-header"><span class="text">'+t.header()+'</span><div class="hover-source-icon"></div></div>').appendTo(n):null;if(o&&e._headerBinding.push({value:t,$el:o.find(".text")}),i&&o){var r=function(e){n.toggleClass("hidden",!e.value()).find(".toggle-source-icon").attr("title",s(e))},s=function(e){return(e?"Hide":"Show")+" data"};n.addClass("with-actions").toggleClass("hidden",!i.properties().visible.value()).on("click",function(t){t.preventDefault(),e.setSelectedSource(i)}).on("contextmenu",function(t){t.preventDefault(),e.D4.readOnly()||e.showContextMenuForSource(i,t)}),o.on("dblclick",function(){new EditObjectDialog(i,e.D4.model()).show()}).append($('<div class="toggle-source-icon" title="'+s(i.properties().visible.value())+'"></div>').on("click",function(t){t.stopPropagation(),t=i.properties().visible.value(),e.D4.model().setProperty(i.properties().visible,!t,(t?"Hide ":"Show ")+i.title())})),i.properties().visible.subscribe(e,r),e._boxBinding.push({src:i,$el:n,visibilityHandler:r})}for(o=0;o<t.items().size();++o){var r=t.items().item(o),a=$('<div class="chart-data-window-item"></div>').appendTo(n);$('<div class="chart-data-window-item-title">'+r.title()+"</div>").appendTo(a),a=$('<div class="chart-data-window-item-value">'+r.value()+"</div>").appendTo(a),e._setValueHtml(a,r),e._itemsBinding.push({value:r,$el:a})}}(i);this.updateHighlight(),this._scroll.resize()}},A12.prototype.update=function(){this.visible&&(this.updateHighlight(),this.updateValues())},A12.prototype.updateHighlight=function(e){var t=(e||{}).source;if(e=!!(e||{}).updateScroll,this.visible&&this.D4&&this.D4.model()){for(var i,n=this.D4.model().hoveredSource(),t=t||this._charWidgetCollection.selectedSource.value(),o=0;o<this._boxBinding.length;++o){var r=this._boxBinding[o].src,s=this._boxBinding[o].$el;if(r){var a=!(!t||r!==t);this._boxBinding[o].$el.toggleClass("hover",!(!n||r!==n)).toggleClass("active",a),a&&(i=s)}}i&&e&&this._scroll.scrollTo(i)}},A12.prototype.updateValues=function(){if(this.visible){for(var e=0;e<this._itemsBinding.length;++e)this._setValueHtml(this._itemsBinding[e].$el,this._itemsBinding[e].value);for(e=0;e<this._headerBinding.length;e++)this._headerBinding[e].$el.html(this._headerBinding[e].value.header()).attr("title",this._headerBinding[e].value.title())}},A12.prototype.updateAll=function(){this._updateSource(),this._upadateLayout()},A12.prototype._onVisibilityChange=function(e){this.visible=!!e,e&&this.updateAll()},A12.prototype._setValueHtml=function(e,t){var i=t.color(),n=this.prepareColor(i),i=i&&i!=n?'<div class="real-color" title="Сolor line" style="background-color:'+i+'"></div>'+t.value():t.value();e.html(i).css({color:n||""})},A12.prototype.prepareColor=function(e,t){if(e){var i=new RGBColor(t||"#FFFFFF");return 20>Math.abs(i.grayChannel()-new RGBColor(e).grayChannel())&&(e=i.blackWhiteContrast()),e}},A12.prototype.setSelectedSource=function(e){this.D4.model().setSelectedSource(e)},A12.prototype.showContextMenuForSource=function(e,t){e.hasContextMenu()&&(this.setSelectedSource(e),e.constructor===TradingView.Series?this._seriesContextMenu(e).show(t):isInherited(e.constructor,TradingView.Study)&&this._studyContextMenu(e).show(t))},A12.prototype._seriesContextMenu=function(e,t){var i=this.D4.actions(),n=e.properties().visible.value(),n=[i.format,n?i.seriesHide:this.createActionShow(e)];return e!=this.D4.model().mainSeries()&&n.push(i.seriesRemove),ContextMenu.createMenu(n)},A12.prototype._studyContextMenu=function(e,t){var i=this.D4.actions(),n=e.properties().visible.value();return ContextMenu.createMenu([i.format,n?i.studyHide:this.createActionShow(e),i.studyRemove])},A12.prototype.createActionShow=function(e){var t=new Action({checkable:!0,text:"Show",enabled:!0});return t._binding=new D14(t,e.properties().visible,this.D4.model(),t.text),t._binding.setValue(e.properties().visible.value()),t},$(function(){var e,t=new function(){function e(){a&&(clearTimeout(a),a=null)}function t(e){if(!r)return 0;var t=!!r&&jQuery.contains(document.body,r[0]);return t||r.css("position","fixed").appendTo(document.body),e=r[e](),t||r.css("position","").detach(),e}var i,n,o,r,s,a,l;this.sendMessage=function(){var e=r.find('[name="message-text"]');(message=String(e.val()).replace(/^\s+|\s+$/g,""))?(widgetbar.setPage("Recent Chats"),TradingView.messagesWidget.sendMessageToUser(message,n.id),this.close()):e.css("border-color","#E0735E").focus()},this.isActiveTarget=function(e){return r&&o&&o.is(e)},this.isSameUser=function(e){return(e=e.data())&&n&&e.id==n.id},this.update=function(t,a){if(this.isActiveTarget(t)||this.isSameUser(t))return e(),this;s&&this.close(),n=a||t.data(),n.large_badge=!0,n.is_self=n.username==window.user.username,n.current_user_is_staff=window.user.is_staff,n.show_add_status_btn=!window.user.status&&is_authenticated,n.is_realtime=n.is_pro&&"pro_realtime"==n.pro_plan,n.is_premium=n.is_pro&&"pro_premium"==n.pro_plan,n.is_trial=n.is_pro&&"pro_realtime_trial"==n.pro_plan,o=t;var d=Mustache.render(TradingView.templates.userlinkPopup,n,TradingView.templates);if(r=$(d).on("mouseenter",function(){e()}).on("mouseleave",function(e){i||$(e.target).is(".content")||this.close(l||500)}.bind(this)),r.find(".userlink").removeClass("userlink"),!n.is_self&&(o.hasClass("ch-userlink")||o.hasClass("ch-item-userpic"))&&(d=o.closest(".ch-item"),d.length&&!d.data("ch-is-standalone"))){var h=o,d=$('<div class="ignore-ban-wrapper"></div>').appendTo(r.find(".content .username")),c=!!user.ignore_list[n.id],p=n.is_staff?null:$('<a href="#" class="ch-ignore-lnk'+(c?" active":"")+'">').text(c?"Unignore":"Ignore").click(n,function(e){e.preventDefault(),c?$.post("/conversation-ignore/",{user_id:e.data.id,action:"remove"},function(t){t.error?A83.showNotice("Error",t.error):(delete user.ignore_list[e.data.id],r&&(r.find(".ch-ignore-lnk").removeClass("active").text("Ignore"),c=!1),h.trigger("userignorechange",!1))}):A83.showConfirm("Confirm","Are you sure you want to ignore messages from "+e.data.username+"?",function(){$.post("/conversation-ignore/",{user_id:e.data.id,username:e.data.username},function(t){t.error?A83.showNotice("Error",t.error):(user.ignore_list[e.data.id]=e.data.username,h.trigger("userignorechange",!0))})})}),u=!!n.is_banned,f=user.is_staff&&!n.is_staff?$('<a href="#" class="ch-ban-lnk'+(u?" active":"")+'">').text(u?"Unban":"Ban").click(n,function(e){e.preventDefault(),u?$.post("/conversation-ban/",{user_id:e.data.id,action:"unban"},function(e){e.error?A83.showNotice("Error",e.error):(r&&(r.find(".ch-ban-lnk").removeClass("active").text("Ban"),u=!1),h.trigger("userbanchange",!1))}):TradingView.messagesWidget.banUser(e.data.username,e.data.id,null,function(){h.trigger("userbanchange",!0)})}):null;p&&p.appendTo(d),p&&f&&$("<span>&thinsp;|&thinsp;</span>").appendTo(d),f&&f.appendTo(d)}return this},this.setForm=function(){return r.on("keyup",function(e){27==e.which&&this.close()}.bind(this)).addClass("form-layout"),r.find('[name="message-text"]').focus(),r.find("textarea").on("keyup",function(e){13==e.which&&e.ctrlKey&&this.sendMessage()}.bind(this)),r.find(".message-user.send").on("click",this.sendMessage.bind(this)),r.find(".message-user.cancel").on("click",this.close.bind(this)),i=!0,this},this.open=function(){if(e(),s||!r)return i&&r.css({top:.45*$(window).height()+$(document).scrollTop(),left:""}),this;r&&jQuery.contains(document.body,r[0])||r.css("position","fixed").appendTo(document.body);var a=left=0,l=t("width"),a=t("height");return i?(a=.45*$(window).height()+$(document).scrollTop(),left=""):(a=o.offset().top-a,0>a-$(document).scrollTop()&&(a=o.offset().top+o.height()),left=o.offset().left-20,left+l>$(window).width()&&(left=$(window).width()-l)),r.css({position:"",top:a,left:left}).hide().fadeIn("fast",function(){i&&r.find('[name="message-text"]').focus(),n.btc_address&&new TradingView.CoinWidget(n.btc_address,r.find(".btc-tip"),"br")}),s=!0,this},this.close=function(t){return t&&"number"==typeof t?(a=setTimeout(this.close,t),l=t,this):(e(),s?(r.remove(),r=o=n=null,s=i=!1,this):this)},this.isForm=function(){return i}};$(document).on("mouseenter",".userlink, .ch-userlink, .ch-item-userpic",function(){if(!W77.enabled("disable_userlink_popup")){var i=$(this);if(t.isActiveTarget(i))t.open();else{var n="/u/"+(i.data("username")||i.text())+"/info/",o={type:"POST",success:function(e){e&&!e.error&&t.update(i,e).open()}};($.browser.msie||/\btrident\b/i.test(navigator.userAgent))&&(o.cache=!1),e=$.ajax(n,o)}}}).on("mouseleave",".userlink, .ch-userlink, .ch-item-userpic",function(){t.isForm()||(e&&e.abort(),t.close(500))}).on("click","button.message-user.message, button.profile-action.profile-message, a.ch-item-message, .ch-private-message-popup-item",function(){var e=$(this);runOrSignIn(function(){t.update(e).setForm().open()})})}),A60=function(e,t,i,n){var o=this;this._options=n||{},this._readonly=!!this._options.readonly,this._container=e,this._chart=t,this._panes=i,this._pane_header_height=34,this._hidden_panes_count=0,this.prepareLayout(),setInterval(function(){o.paint()},66)},A60.prototype.prepareLayout=function(){var e=this;this._widget=$('<div class="chart-sidebar">').appendTo(this._container),this._widget.toggleClass("hidden",void 0!=this._options.hidden?this._options.hidden:TVSettings.getBool("sidebar.hidden",!1)),this._separator=$('<div class="separator"><div class="separator-bar"><div class="separator-icon"></div></div></div>').appendTo(this._widget),this._separator.click(function(){e._widget.toggleClass("hidden"),e._readonly||TVSettings.setValue("sidebar.hidden",e._widget.is(".hidden")),$(window).resize()}),this._panes.forEach(function(t,i){void 0===t.ratio&&(t.ratio=TVSettings.getFloat("sidebar.pane."+t.id+".ratio",1)),void 0===t.state&&(t.state=TVSettings.getBool("sidebar.pane."+t.id+".state",!0),this._hidden_panes_count+=t.state?0:1),t.$pane=$('<div class="chart-sidebar-pane">').addClass("tv-"+t.id).appendTo(this._widget),t.$header=$('<div class="header"><span class="icon"></span><span class="title">'+t.title+"</span></div>").click(function(){t.state=!t.state,e._readonly||TVSettings.setValue("sidebar.pane."+t.id+".state",t.state),e._hidden_panes_count+=t.state?-1:1,e.resize()}).appendTo(t.$pane),t.index=i,t.$container=$('<div class="container">').appendTo(t.$pane),t.widgetObject=new t.widget(t.$container,this._chart,t.options),i<this._panes.length-1&&$('<div class="chart-sidebar-vseparator"><div class="handle"></div></div>').on("mousedown touchstart",function(t){var i=$(this),n=i.prevAll(".chart-sidebar-pane:not(.minimized)").first(),o=i.nextAll(".chart-sidebar-pane:not(.minimized)").first();return n.length&&o.length?(e._drag_start=t.pageY||t.originalEvent.pageY||t.originalEvent.touches&&t.originalEvent.touches[0].pageY||0,e._drag_prev_h=n.height(),e._drag_next_h=o.height(),$(window).on("mousemove.sidebarDrag touchmove.sidebarDrag",function(t){t=(t.pageY||t.originalEvent.pageY||t.originalEvent.touches&&t.originalEvent.touches[0].pageY||0)-e._drag_start,n.height(e._drag_prev_h+t).data("paneObj").widgetObject.resize(),o.height(e._drag_next_h-t).data("paneObj").widgetObject.resize()}),$(window).one("mouseup touchend",function(t){$(window).unbind("mousemove.sidebarDrag touchmove.sidebarDrag");var n=i.prevAll(".chart-sidebar-pane:not(.minimized)").first();t=i.nextAll(".chart-sidebar-pane:not(.minimized)").first();var o=(e._widget.height()-e._hidden_panes_count*e._pane_header_height-(e._panes.length-1))/(e._panes.length-e._hidden_panes_count),r=(n.height()+e._pane_header_height)/o,n=n.data("paneObj");n.ratio=r,o=(t.height()+e._pane_header_height)/o,n=t.data("paneObj"),n.ratio=o,e.resize()}),void t.preventDefault()):!1}).appendTo(this._widget),t.$pane.data("paneObj",t)},this),$(window).resize(function(){e.resize()}),this.resize()},A60.prototype.normalizeRatios=function(){var e=this,t=this._panes.length-this._hidden_panes_count,i=0,n=0;this._panes.forEach(function(e){e.state&&(i+=e.ratio)}),n=(i-t)/t,this._panes.forEach(function(t){t.state&&(t.ratio-=n,e._readonly||TVSettings.setValue("sidebar.pane."+t.id+".ratio",t.ratio.toFixed(2)))})},A60.prototype.resize=function(){this.normalizeRatios();var e=(this._widget.height()-this._hidden_panes_count*this._pane_header_height-(this._panes.length-1))/(this._panes.length-this._hidden_panes_count);this._panes.forEach(function(t,i){t.state?t.$pane.height(e*t.ratio-this._pane_header_height):t.$pane.height(0),t.widgetObject.resize(!0),t.$pane.toggleClass("minimized",!t.state),t.$container.trigger("paneStateChange",[t.state])},this)},A60.prototype.getPaneIndexById=function(e){for(var t=0;t<this._panes.length;t++)if(this._panes[t].id===e)return t;return null},A60.prototype.getPaneById=function(e){return e=this.getPaneIndexById(e),null===e?null:this._panes[e]},A60.prototype.highlightPane=function(e,t,i){this._panes[e].$header.highlight(t,i)},A60.prototype.highlightWidget=function(e,t,i){this.highlightPane(this.getPaneIndexById(e),t,i)},A60.prototype.paint=function(){this._panes.forEach(function(e,t){e.widgetObject.paint&&e.widgetObject.paint()},this)},A60.prototype.setPaneState=function(e,t,i){e&&(e.state=!!t,t=i&&i.doNotSave,this._readonly||t||TVSettings.setValue("sidebar.pane."+e.id+".state",e.state),this._hidden_panes_count=this._panes.filter(function(e){return!e.state}).length,this.resize())},A59=function(e,t,i){var n=this;this._options=$.extend({},this._defaultOptions,i||{}),this._$wrapper=e,this._$content=t,this._scroll_speed=40,this._shadow_offset=10,this._header_height=this._options.headerHeight,this.scrolled=new Delegate,this.scrolltoend=new Delegate,this.scrolltostart=new Delegate,(this._touch=Modernizr.touch||navigator.msMaxTouchPoints)?(this._$content.css("position","relative"),this._$wrapper.css({"overflow-y":"scroll","-webkit-overflow-scrolling":"touch","-ms-overflow-style":"-ms-autohiding-scrollbar"}).scroll(this._onScroll.bind(this))):(this._$wrapper.css("overflow","hidden"),this._$wrapper.mouseenter(function(){n._bottomFixed||n._dragging||(n._options.alwaysVisible||n._$scrollBar.addClass("active"),n._onScroll())}).mouseleave(function(){n._bottomFixed||n._dragging||(n._options.alwaysVisible||n._$scrollBar.removeClass("active"),n._onScroll())}).mousewheel(function(e,t){return e.isDefaultPrevented()?void 0:n.scroll(t)}),this._$shadowTop=$('<div class="sb-inner-shadow top">').appendTo(this._$wrapper),this._$shadowTop.hide(),this._$shadowBottom=$('<div class="sb-inner-shadow">').appendTo(this._$wrapper),this._header_height&&this._$shadowTop.css("top",this._header_height-this._shadow_offset),e=this._options.additionalClass?" "+this._options.additionalClass:"",t=this._options.alwaysVisible?" active-always":"",this._$scrollBarWrapper=$('<div class="sb-scrollbar-wrap">').appendTo(this._$wrapper),this._$scrollBar=$('<div class="sb-scrollbar sb-scrollbar-body'+e+t+'"></div>').appendTo(this._$scrollBarWrapper),this._onScroll())},A59.prototype._defaultOptions={headerHeight:0,additionalClass:"",alwaysVisible:!1,showBottomShadow:!0},A59.prototype.initDraggable=function(){if(this._dragInitialized)return this;var e=this;return this._$wrapper.offset(),this._$scrollBar.draggable({axis:"y",containment:this._$scrollBarWrapper,start:function(){e._dragging=!0},stop:function(){e._dragging=!1},drag:function(t,i){e.updateScroll()}}),this._dragInitialized=!0,this},A59.prototype.updateScroll=function(){if(this._touch)return this;var e=Math.ceil(this._$scrollBar.position().top-1-this._header_height),t=this._$wrapper.height()-this._header_height,i=this._$content.height();return 0>=t?this:(this._scroll_target_top=0>=i-t-1?this._header_height:-e*i/t+this._header_height,e+this._$scrollBar.height()+2>=t?this.scrollToEnd():(this._$content.css("top",this._scroll_target_top+"px"),this._onScroll()),this)},A59.prototype.updateScrollBar=function(){if(this._touch)return this;var e=this._$content.position().top,t=this._$content.height(),i=this._$wrapper.height(),n=i-this._header_height,o=1+this._header_height,r=n-2,e=(Math.abs(e)-this._header_height)*r/t,i=i*i/t;return n>t?(this._$scrollBar.hide(),this._$wrapper.removeClass("sb-scroll-active")):(this._$scrollBar.show().height(i).css("top",o+e),this._$wrapper.addClass("sb-scroll-active"),this.initDraggable()),this},A59.prototype.scroll=function(e,t){if(this._touch)return this;var i=this._$content.position().top,n=this._$content.height(),o=this._$wrapper.height()-this._header_height,n=n-o-1;return 0>=n?!0:(this._scroll_target_top=Math.max(-n+this._header_height,Math.min(this._header_height,i+e*(t||this._scroll_speed))),this.setContentTop(this._scroll_target_top),this._onScroll(),!1)},A59.prototype.animateTo=function(e){if(this._touch)return this;this._$content.position();var t=this._$content.height(),i=this._$wrapper.height()-this._header_height,t=t-i-1;return 0>=t?!0:(this._scroll_target_top=Math.max(-t+this._header_height,Math.min(this._header_height,-e)),void this._$content.animate({top:this._scroll_target_top},500,function(){this._onScroll()}.bind(this)))},A59.prototype.resize=function(){if(!this._bottomFixed){this._$content.position();var e=this._$content.height(),t=this._$wrapper.height();!this._options.vAlignBottom&&t>e?this.atStart()||this.scrollToStart():this.atEnd()?this.scrollToEnd():"number"==typeof this._stickyBottom&&this.setContentTop(Math.min(0,this._stickyBottom+this._$wrapper.height()-this._$content.height()))}},A59.prototype.resizeHeader=function(e){var t=e-this._header_height;this._header_height=e,this._scroll_target_top+=t,this._$shadowTop&&this._$shadowTop.css("top",this._header_height-this._shadow_offset),this.resize()},A59.prototype.scrollTo=function(e,t){t=$.extend({position:"visible",areaHeight:e instanceof $?e.height():0},t),e instanceof $&&(e=e.position().top);var i=this._$content.position().top,n=this._$content.height(),o=this._$wrapper.height()-this._header_height;if(0>=n-o-1)return!0;if(i=-1*(i-this._header_height),o=i+o,n=0,"visible"==t.position){if(e>i&&e+t.areaHeight<o)return!1;n=e+t.areaHeight>o?o-e-t.areaHeight:i-e}else"top"==t.position&&(n=i-e);return this.scroll(n,1),this._onScroll(),!1},A59.prototype.scrollToEnd=function(){var e=this._$content.position().top,t=this._$content.height(),i=this._$wrapper.height();return this.setContentTop(e+(i-(t+e))+1),this._onScroll(),this},A59.prototype.scrollToStart=function(){return this.setContentTop(this._header_height),this._onScroll(),this},A59.prototype.atStart=function(){return Math.round(this._$content.position().top)>=this._header_height},A59.prototype.atEnd=function(e){"number"==typeof e&&isFinite(e)||(e=0);var t=this._$content.position().top,i=this._$content.height(),n=this._$wrapper.height();return i-Math.abs(t)-1<=n+e},A59.prototype._onScroll=function(e){this._touch||this._$content.css("bottom","auto"),this.scrolled.fire(),this._dragging&&!0!==e||this.updateScrollBar(),e=this.atStart();var t=this.atEnd();this._$shadowTop&&this._$shadowTop.toggle(!e),this._$shadowBottom&&this._$shadowBottom.toggle(!t),!this._atStart&&e?(this._atStart=!0,this.scrolltostart.fire()):this._atStart&&!e&&delete this._atStart,!this._atEnd&&t?(this._atEnd=!0,this.scrolltoend.fire()):this._atEnd&&!t&&delete this._atEnd,this._options.vAlignBottom&&(this._stickyBottom=this._$content.height()-Math.abs(this._$content.position().top)-this._$wrapper.height())},A59.prototype.save=function(){return this._saved={top:this._$content.position().top,height:this._$content.height()},this},A59.prototype.restore=function(){if(this._saved){if(this._saved.top==this._$content.position().top&&this._saved.height==this._$content.height())return delete this._saved,this;this._options.vAlignBottom&&(this._saved.top-=this._$content.height()-this._saved.height,this._saved.top>this._header_height&&(this._saved.top=this._header_height)),this.setContentTop(this._saved.top),delete this._saved,this._onScroll(!0)}return this},A59.prototype.fixBottom=function(){if(this._bottomFixed)return this;if(this._touch){var e=this._$content.height(),t=this._$wrapper.scrollTop();this._tempIntervalID=setInterval(function(){this._$wrapper.scrollTop(t+(this._$content.height()-e))}.bind(this),0)}else this._$content.css({top:"auto",bottom:this._$wrapper.height()-this._$content.position().top-this._$content.height()});return this._bottomFixed=!0,this},A59.prototype.releaseBottom=function(){return this._bottomFixed?(this._touch?clearInterval(this._tempIntervalID):this._$content.css({top:this._$content.position().top,bottom:"auto"}),delete this._bottomFixed,this._onScroll(),this):this},A59.prototype.setContentTop=function(e){return this._touch?this._options.vAlignBottom&&this._$content.height()<this._$wrapper.height()?(this._$wrapper.css("overflow-y","visible"),this._$content.css({position:"absolute",bottom:0})):(this._$content.css({position:"relative",bottom:"auto"}),this._$wrapper.css("overflow-y","scroll"),this._$wrapper.scrollTop(-e)):this._$content.css("top",e),this},TradingView.SaveLoadWidget=function(e,t,i){function n(){t.metaInfo.name.value()||o._readOnly?o.setTitle(t.metaInfo.name.value()):o.hideTitle()}this._options=i=$.extend({popupDirection:"up",popupReverse:!1},i||{}),this.onTitleSizeChanged=new Delegate,this._container=e=$(e),this.D5=t,this._readOnly=t.readOnly(),this._savedCharts=[],this._editEnabled=!0,this.loadChartDialog=new LoadChartDialog,this.renameChartDialog=new RenameChartDialog,TradingView.D18("open_last_chart")&&(this._new=$('<span class="first button load">'+$.t("New")+"</span>").click(this.loadChartDialog.openNewChart).appendTo(e)),this._load=$('<span class="button load">'+$.t("Load")+"</span>").click($.proxy(this,"signInOrLoadChart")).appendTo(e),TradingView.D18("open_last_chart")||this._load.addClass("first"),this._title=$('<span class="title apply-common-tooltip"></span>'),i.hideChartTitle&&this._title.hide(),this._sep=$("<i>").addClass("separator"),this._optionsMenu=$('<span class="button with-arrow options last">').append($("<span>").addClass("arrow-icon")).click($.proxy(this,"otherActionsMenu")),TradingView.bindPopupMenu(this._optionsMenu,null,{direction:i.popupDirection,event:"button-popup",reverse:i.popupReverse,notCloseOnButtons:!0,popupSpacing:i.popupSpacing}),this._readOnly?(this._save=$(),this._copy=$('<span class="copy">'+$.t("Copy")+"</span>").appendTo(e).click($.proxy(this,"cloneChart")),this._title.addClass("read-only"),this._titleReadOnly=$("<span>").addClass("read-only").appendTo(this._title),this._sep.appendTo(this._copy),this._optionsMenu.hide()):(i=$.t("Save Chart Layout saves not just some particular chart,\nit saves all charts for all symbols and intervals\nwhich you are modifying while working with this Layout"),this._save=$('<span class="save button apply-common-tooltip" title="'+i+'">'+$.t("Save")+"</span>").appendTo(e).click($.proxy(this,"signInOrSaveChart")),this._copy=$(),this._titleInput=$('<span type="text" maxlength="80">').appendTo(this._title),this._title.bind("click",$.proxy(this,"_renameChart")),this._title.attr("title",$.t("Rename Chart Layout")),this._titleSize=$('<span class="sizer">').appendTo(this._title),this._sep.appendTo(this._save)),this._title.appendTo(e),this._optionsMenu.appendTo(e),this._savecopy=$().add(this._save).add(this._copy).mousedown(function(e){return e.button?!1:void this._save.addClass("active")}.bind(this)).mouseup(function(){this._save.removeClass("active")}.bind(this));var o=this;t.metaInfo.name.subscribe(function(){n()}),n(),loginStateChange.subscribe(this,this._refreshSavedChartsList),TVXWindowEvents.on("saved-charts-change",$.proxy(this._otherTabUpdated,this)),TVXWindowEvents.on("saved-charts-change-favorites",$.proxy(this._favoritesUpdated,this)),A77.undoStack().onChange().subscribe(this,function(){if(!A77.undoStack().isEmpty()){var e=A77.undoStack().head().text();if("scroll"==e||"scale time"==e)return}this._setChanges(!0),this.autosave()}),TradingView.keyboardBinder.registerListener("LoadChartDialogHotkey",function(e){return e.ctrlKey?!1:"46"==e.which&&$(e.target).is("body")?(this._load.click(),e.preventDefault(),e.stopPropagation(),!0):!1}.bind(this)),this.favorites=TVSettings.getJSON(TradingView.SaveLoadWidget.FAVORITES_KEY,{})},TradingView.SaveLoadWidget.FAVORITES_KEY="loadChartDialog.favorites",TradingView.SaveLoadWidget.prototype._favoritesUpdated=function(e){this.favorites=JSON.parse(e),this.loadChartDialog.updateFavoritesData(this.favorites)},TradingView.SaveLoadWidget.prototype._otherTabUpdated=function(e){this._savedCharts=JSON.parse(e),this.loadChartDialog.updateChartsData(this._getLoadMenuCharts())},TradingView.SaveLoadWidget.prototype._renameChart=function(){var e=this;e._editEnabled&&this.renameChartDialog.show(this.getTitle()).then(function(t){e.setTitle(t),e.saveChart()})},TradingView.SaveLoadWidget.prototype._setTitle=function(e){this._titleInput.text(e),this._titleValue=e,this._savecopy.removeClass("last").addClass("titled"),e?this._options.hideChartTitle||(this._optionsMenu.show(),this._title.show()):(this._optionsMenu.hide(),this._title.hide(),this._savecopy.addClass("last").removeClass("titled")),this._setInputSuze(),this._setChanges(!0)},TradingView.SaveLoadWidget.prototype._setReadOnlyTitle=function(e){this._titleReadOnly.html(e).attr("title",e.replace(/<[^>]+>/g,"")),this._savecopy.removeClass("last").addClass("titled"),this._title.addClass("last"),this._options.hideChartTitle||this._title.show()},TradingView.SaveLoadWidget.prototype.setTitle=function(e){if(this._readOnly){var t=clean(this.D5.metaInfo.username.value());e=(e?e+": ":"")+"view-only chart by "+'<a href="/u/%1">%1</a>'.replace(/%1/g,t),this._setReadOnlyTitle(e)}else this._setTitle(e)},TradingView.SaveLoadWidget.prototype.hideTitle=function(){this._title.hide(),this._optionsMenu.hide(),this._titleInput.text(""),this._savecopy.removeClass("titled").addClass("last")},TradingView.SaveLoadWidget.prototype.getTitle=function(){return this._titleValue},TradingView.SaveLoadWidget.prototype._setInputSuze=function(){this._titleSize.text(this._titleInput.text()),this._titleInput.width(this._titleSize.width()),this.onTitleSizeChanged.fire()},TradingView.SaveLoadWidget.prototype.cloneChart=function(){var e=this;W77.enabled("save_old_chart_before_save_as")&&this.D5.metaInfo.id.value()&&this._saveChart(),new RenameChartDialog($.t("Copy Chart Layout")).show($.t("{0} copy").format(e.D5.metaInfo.name.value())).then(function(t){W77.enabled("saved_charts_count_restriction")&&!user.is_pro&&5<=e._savedCharts.length?A83.showGoProDialog({feature:"savedChartsLimit"}):W77.enabled("saveload_storage_customization")?(e.D5.metaInfo.uid.setValue(void 0),
e.D5.metaInfo.id.setValue(void 0),e.setTitle(t),e.saveChart()):window.open("/e/?clone="+e.D5.metaInfo.uid.value()+"&name="+encodeURIComponent(t),"_blank")}.bind(this))},TradingView.SaveLoadWidget.prototype._setChanges=function(e){this._haveChanges=e=!!e,!e&&this.getTitle()?this._save.addClass("no-change"):this._save.removeClass("no-change")},TradingView.SaveLoadWidget.prototype._process=function(e){e?this._save.addClass("process"):this._save.removeClass("process")},TradingView.SaveLoadWidget.prototype._saveChart=function(e,t){if(!this._readOnly&&!this._saving&&this._haveChanges){var i=function(){this._saving=!1,this._process(!1),this._editEnabled=!0,clearTimeout(this._saveTimeout)}.bind(this);this._saving=!0,this._process(!0),this._editEnabled=!1,this._saveTimeout=setTimeout(i,7e3);try{saver.saveChartSilently(function(){i(),this._setChanges(!1),"function"==typeof e&&e.call(this)}.bind(this),null,function(){i(),"function"==typeof t&&t.call(this)})}catch(n){i(),"undefined"!=typeof console&&console.log&&console.log("Error while saving",n)}}},TradingView.SaveLoadWidget.prototype._autosaveInterval=6e4,TradingView.SaveLoadWidget.prototype.autosave=function(){W77.enabled("charts_auto_save")&&(this._autosaveTimer&&(clearTimeout(this._autosaveTimer),this._autosaveTimer=0),this._autosaveTimer=setTimeout(function(){this.D5.metaInfo.id.value()&&this._saveChart()}.bind(this),this._autosaveInterval))},TradingView.SaveLoadWidget.prototype._goChartPage=function(e){"/e/"==location.pathname&&(location="/e/"+e+(TradingView.isMobileView?"?mobile=1":""))},TradingView.SaveLoadWidget.prototype.saveChart=function(){var e=this.getTitle();e?(this.D5.metaInfo.name.setValue(e),this._saveChart(function(){TradingView.trackEvent("GUI","Save Chart Layout"),this._goChartPage(this.D5.metaInfo.uid.value()),"undefined"!=typeof TradingView.UaTitleManager&&TradingView.UaTitleManager.instance&&TradingView.UaTitleManager.instance.updateView(),this._refreshSavedChartsList()}.bind(this),function(){this.D5.metaInfo.name.setValue(""),this.setTitle("")}.bind(this))):TradingView.showChartNameDialog(function(e){this.setTitle(e),this.saveChart()}.bind(this),void 0,$.t("Chart layout name"),64)},TradingView.SaveLoadWidget.prototype.signInOrSaveChart=function(){W77.enabled("saveload_requires_authentication")?runOrSignIn($.proxy(this,"saveChart")):this.saveChart()},TradingView.SaveLoadWidget.prototype.signInOrLoadChart=function(){W77.enabled("saveload_requires_authentication")?runOrSignIn($.proxy(this,"loadMenu")):this.loadMenu()},TradingView.SaveLoadWidget.prototype.saveChartByEnter=function(e){"13"==e.keyCode&&(this._titleInput.blur(),this.signInOrSaveChart())},TradingView.SaveLoadWidget.prototype._refreshSavedChartsList=function(e){W77.enabled("saveload_requires_authentication")&&!is_authenticated?this._savedCharts=[]:getSavedChartsList(function(e){this._savedCharts=e,TVXWindowEvents.emit("saved-charts-change",JSON.stringify(e))}.bind(this)).then(function(){TVSettings.getJSON(this._FAV_KEY,[]),e&&e()})},TradingView.SaveLoadWidget.prototype._getSavedChartsList=function(){return this._savedCharts},TradingView.SaveLoadWidget.prototype._fastDelete=function(e,t){this._savedCharts.splice(t,1),e==this.D5.metaInfo.id.value()&&(W77.enabled("saveload_storage_customization")?(this.D5.clearChartMetaInfo(),this.setTitle(void 0)):location.href="/e/")},TradingView.SaveLoadWidget.prototype._getSavedCharts=function(){var e=[];return!this._readOnly&&this.isSaved()&&(e.push({title:$.t("Rename..."),action:this._renameChart.bind(this)}),e.push({title:$.t("Save As..."),action:this.cloneChart.bind(this)})),e},TradingView.SaveLoadWidget.prototype.isSaved=function(){return!!this.getTitle()},TradingView.SaveLoadWidget.prototype._getLoadMenuCharts=function(){var e=[],t=this,i=this._getSavedChartsList();return i.length&&$.each(i,function(i,n){e.push({id:n.id,title:n.name,symbol:n.short_symbol,interval:n.interval,toolsCount:0,modified:n.modified_iso,active:function(){return n.id==t.D5.metaInfo.id.value()},openAction:function(){openSavedChart(n)},deleteAction:function(e){deleteChart(n.image_url,function(){t._fastDelete(n.id,i),TVXWindowEvents.emit("saved-charts-change",JSON.stringify(t._savedCharts)),e.resolve()})},favoriteAction:function(e){t.favorites=e,TVSettings.setJSON(TradingView.SaveLoadWidget.FAVORITES_KEY,e),TVXWindowEvents.emit("saved-charts-change-favorites",JSON.stringify(e))}})}),e},TradingView.SaveLoadWidget.prototype.otherActionsMenu=function(){this._optionsMenu.hasClass("active")||this._optionsMenu.trigger("button-popup",[this._getSavedCharts()])},TradingView.SaveLoadWidget.prototype.loadMenu=function(){var e=this;this._load.addClass("process"),this._refreshSavedChartsList(function(){e._load.removeClass("process"),e.loadChartDialog.show(e._getLoadMenuCharts(),e.favorites)})},A9=function(e,t,i){this._chart=e,this._parent=t,this.zoom_active=!1,this._real=i,this._state="stop",this.init(),i&&this.initToRealChart(),this.initHandlers()},A9.prototype.init=function(){this._widget=$('<div class="control-bar-wrapper">').appendTo(this._parent),$('<div class="control-bar"><svg class="move-left-button-control-bar"><use xlink:href="#svg-left" /></svg><svg class="zoom-out-right-button-control-bar"><use xlink:href="#svg-minus" /></svg><svg class="turn-button-control-bar"><use xlink:href="#svg-restore" /></svg><svg class="zoom-in-button-control-bar"><use xlink:href="#svg-plus" /></svg><svg class="move-right-button-control-bar"><use xlink:href="#svg-right" /></svg></div>').appendTo(this._widget),this._buttons={zoomIn:this._widget.find(".zoom-in-button-control-bar"),zoomOut:this._widget.find(".zoom-out-right-button-control-bar"),moveLeft:this._widget.find(".move-left-button-control-bar"),moveRight:this._widget.find(".move-right-button-control-bar"),turn:this._widget.find(".turn-button-control-bar")}},A9.prototype.initToRealChart=function(){var e=this;this._back=$('<svg class="back-to-present hidden"><use xlink:href="#svg-right-stop" /></svg>').appendTo(this._parent),this._back.on("click",function(){e._chart.model().timeScale().scrollToRealtime(!0),e._chart.model().model()._invalidateHandler(new A22(A22.FULL_UPDATE)),e._back.addClass("hidden")});var t=function(){var t=e._chart.maxRhsPriceAxisWidth+4;t&&e._back.css("marginRight",t)};this._chart.rhsPriceAxisWidthChanged.subscribe(this,t),t(),this._chart.withModel(this,function(){this._chart.model().model().setInterval(function(){e.check()},1e3)})},A9.prototype.check=function(){this._chart.model()&&0>this._chart.model().timeScale().rightOffset()?this._back.attr("class","back-to-present"):this._back.attr("class","back-to-present hidden")},A9.prototype._move=function(e){if("stop"==this._state&&this._chart.model().beginUndoMacro(1==e?"Move Left":"Move Right"),this._state="moving",this._moveType="animated",this._deferredFinishTimeout&&(clearTimeout(this._deferredFinishTimeout),this._deferredFinishTimeout=0),this._finishingTimeout&&(clearTimeout(this._finishingTimeout),this._finishingTimeout=0),this._startTime=+new Date,!this._movingTimeout){var t=this._startTime;this._movingTimeout=setTimeout(function i(){this._moveStep.call(this,t,0,50*e,1e3),this._movingTimeout=setTimeout(i.bind(this),10)}.bind(this),10)}},A9.prototype._moveStep=function(e,t,i,n){return this._chart.model().timeScale().isEmpty()?void 0:(e=1-(Math.max(0,e+n-+new Date)/n||0),1>e&&(n=jQuery.easing.easeOutCubic(null,n*e,0,1,n),this.currentDistance=(i-t)*n+t),this._chart.model().scrollChart(this.currentDistance),e)},A9.prototype._finishMove=function(e){clearTimeout(this._movingTimeout),this._deferredFinishTimeout=this._movingTimeout=0;var t=this.currentDistance,i=+new Date;this._finishingTimeout=setTimeout(function n(){1>this._moveStep.call(this,i,t,0,700)?this._finishingTimeout=setTimeout(n.bind(this),10):(this._state="stop",this._moveType="",this.currentDistance=this._movingTimeout=0,this._chart.model().endUndoMacro())}.bind(this),10)},A9.prototype._stopMove=function(e){"moving"==this._state&&(this._state="wait_finishing",200>(new Date).getTime()-this._startTime?this._deferredFinishTimeout=setTimeout(this._finishMove.bind(this),200-((new Date).getTime()-this._startTime)):this._finishMove())},A9.prototype._moveByBar=function(e){"stop"==this._state&&this._chart.model().beginUndoMacro(1==e?"Move Left":"Move Right");var t=this._chart.model().timeScale(),i=t.indexToCoordinate(t.visibleBars().lastBar())+t.barSpacing()/2;if(Math.abs(t.width()-i)>t.barSpacing()/6&&this._chart.model().scrollChart(t.width()-i),this._state="moving",this._moveType="by_bar",this._startTime=+new Date,!this._movingTimeout){var n=150,o=0;this._movingTimeout=setTimeout(function r(){this._moveByBarStep(e),o++,n>100&&(n-=o/5*20),this._movingTimeout=setTimeout(r.bind(this),n)}.bind(this),400),this._moveByBarStep(e)}},A9.prototype._moveByBarStep=function(e){this._chart.model().timeScale().isEmpty()||this._chart.model().scrollChartByBar(e)},A9.prototype._stopMoveByBar=function(e){"moving"==this._state&&(clearTimeout(this._movingTimeout),this._movingTimeout=0,this._state="stop",this._moveType="",this.currentDistance=this._movingTimeout=0,this._chart.model().endUndoMacro())},A9.prototype.initHandlers=function(){var e=this._chart;$(".control-bar span");var t=Modernizr.touch?"touchstart":"mousedown",i=Modernizr.touch?"touchend":"mouseup mouseout";this._buttons.moveLeft.on(t,this._moveByBar.bind(this,1)),this._buttons.moveLeft.on(i,this._stopMoveByBar.bind(this,1)),this._buttons.moveRight.on(t,this._moveByBar.bind(this,-1)),this._buttons.moveRight.on(i,this._stopMoveByBar.bind(this,-1)),this._buttons.turn.on("click",function(){e.GUIResetScales()}),this._buttons.zoomOut.on("click",function(){e.model()&&e.model().zoomOut()}),this._buttons.zoomIn.on("click",function(){e.model()&&e.model().zoomIn()}),e.withModel(this,function(){var t=function(){var t=!e.model().canZoomIn(),i=!e.model().canZoomOut();this.makeBtnDisabled(this._buttons.zoomIn,t),this.makeBtnDisabled(this._buttons.zoomOut,i)};e.model().onSimpleZoomIn().subscribe(this,function(){t.call(this)}),e.model().onSimpleZoomOut().subscribe(this,function(){t.call(this)})});var n={};$("body").on("keydown",function(e){if(!($(e.target).closest("input, textarea").length||e.which in n))switch(n[e.which]=!0,e.which){case 37:e.ctrlKey||e.altKey?this._move(1):this._moveByBar(1),e.preventDefault();break;case 39:e.ctrlKey||e.altKey?this._move(-1):this._moveByBar(-1),e.preventDefault()}}.bind(this)).on("keyup",function(e){if(!$(e.target).closest("input, textarea").length)switch(delete n[e.which],e.which){case 37:case 39:"by_bar"==this._moveType?this._stopMoveByBar():this._stopMove()}}.bind(this))},A9.prototype.makeBtnDisabled=function(e,t){e instanceof $?e.toggleClass("disabled",!!t):"string"==typeof e&&(this._buttons[e]?this._buttons[e].toggleClass("disabled",!!t):console.warn("No btn "+e+" in ControlBarNavigation"))},A9.prototype.resetButtons=function(){if(this._buttons)for(var e in this._buttons)this._buttons[e].removeClass("disabled")},TradingView.SeriesControlWidget=function(){function e(e){var t=this,i=this.D4=e.D3;this._$seriesControls=$(document.createElement("div")).attr("class","chart-controls-bar-buttons chart-series-controls").appendTo(e.parent),i.onWidget()||W77.enabled("charting_library")?this._$extendedHoursButton=null:this._$extendedHoursButton=$(document.createElement("a")).text($.t("ext")).attr("title","The Extended Trading Hours feature is available only for intraday charts").addClass("apply-common-tooltip").appendTo(this._$seriesControls),this._$percButton=$(document.createElement("a")).text("%").attr("title",$.t("Toggle Percentage")).addClass("apply-common-tooltip").appendTo(this._$seriesControls),this._$logButton=$(document.createElement("a")).text($.t("log")).attr("title",$.t("Toggle Log Scale")).addClass("apply-common-tooltip").appendTo(this._$seriesControls),this._$autoScaleButton=$(document.createElement("a")).text($.t("auto",{context:"scale"})).attr("title",$.t("Toggle Auto Scale")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);var n=$(document.createElement("a")).attr("title",$.t("Scales Properties")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);this._$fullscreenChartButton=$(document.createElement("a")).attr("title",$.t("Toggle Maximize Chart")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);var o=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({width:12,height:12}).css({fill:"currentColor",stroke:"none",margin:"1px"});$(document.createElementNS("http://www.w3.org/2000/svg","desc")).text("SP").appendTo(o),$(document.createElementNS("http://www.w3.org/2000/svg","path")).attr({d:"M 11.896733,5.4401 C 11.201602,5.2497118 10.287185,5.3844905 9.8529668,4.6739798 9.3680407,3.9899631 9.7713075,3.1150758 10.335646,2.6255445 10.81759,2.1397596 10.086625,1.2464141 9.5348331,1.5679918 9.0096065,2.0197899 8.3586515,2.5915907 7.6081884,2.2860159 6.8487054,2.0572252 6.6657258,1.2214292 6.6611579,0.52971682 6.6904416,-0.14270317 5.5547878,-0.19920111 5.3509206,0.33932112 5.3495604,1.0614071 5.216111,1.980668 4.4411277,2.2733721 3.718985,2.58432 3.0421913,2.0835985 2.5447076,1.6132218 2.019086,1.2075468 1.1733117,2.0525503 1.6258135,2.5522279 2.1291674,3.0522349 2.6067846,3.7947509 2.23627,4.5142319 1.9382627,5.2487851 1.0997484,5.3013165 0.42629601,5.3591295 -0.18586111,5.4121559 -0.1726988,6.614951 0.4382476,6.6606553 1.1701866,6.6354301 2.0901088,6.8653212 2.3114865,7.6677973 2.5690397,8.4182506 1.9757702,9.0009969 1.5707544,9.5375753 1.260194,10.111116 2.1887088,10.863746 2.6392394,10.30714 3.1282414,9.7691412 3.9518015,9.3917137 4.6315605,9.8249999 5.3287279,10.186762 5.2619381,11.018963 5.3869987,11.672161 5.5440075,12.215504 6.7794125,12.12358 6.6535582,11.446999 6.6654072,10.746236 6.9028479,9.8947057 7.6677558,9.6885901 8.4182253,9.4312024 9.000933,10.024446 9.5375381,10.429439 10.111007,10.739871 10.863873,9.8114259 10.307197,9.360908 9.7691358,8.8719351 9.3913098,8.0483184 9.8250144,7.3685614 10.18688,6.6714752 11.018948,6.7380091 11.672226,6.6131264 12.162952,6.4957229 11.998177,5.7860369 11.896733,5.4401 z M 5.999918,8.8061 C 4.4052236,8.8574703 3.0094365,7.3092614 3.2012542,5.7303585 3.3197775,4.2414555 4.7798203,3.0282413 6.2655218,3.2004993 7.7296227,3.3187202 8.9364572,4.7279379 8.805387,6.1941362 8.7186344,7.6148699 7.4347334,8.84471 5.999918,8.8061 z"}).appendTo(o),n.append(o),o=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({width:12,height:12}).css({fill:"currentColor",stroke:"none",margin:"1px"}),o.get(0).setAttribute("viewBox","0 0 24 24"),$(document.createElementNS("http://www.w3.org/2000/svg","desc")).text("FS").appendTo(o),$(document.createElementNS("http://www.w3.org/2000/svg","path")).attr({d:"M0 0v9l3.5-3.5 4.5 4.5h2v-2l-4.5-4.5 3.5-3.5h-9zm15 0l3.5 3.5-4.5 4.5v2h2l4.5-4.5 3.5 3.5v-9h-9zm-7 14l-4.5 4.5-3.5-3.5v9h9l-3.5-3.5 4.5-4.5v-2h-2zm6 0v2l4.5 4.5-3.5 3.5h9v-9l-3.5 3.5-4.5-4.5h-2z"}).appendTo(o),this._$fullscreenChartButton.append(o),this._$percButton.on("click",function(e){e.preventDefault(),e=i.model();var t=e.mainSeries(),n=t.priceScale(),o=n.properties();t.properties().lockScale.value()||(e.beginUndoMacro($.t("Toggle Percentage")),o.log.value()&&e.setLogProperty(o.log,!1,n,$.t("Toggle Log Scale")),e.setPercentProperty(o.percentage,!o.percentage.value(),n,$.t("Toggle Percentage")),e.endUndoMacro())}),this._$logButton.on("click",function(e){e.preventDefault(),e=i.model();var t=e.mainSeries(),n=t.priceScale(),o=n.properties();t.properties().lockScale.value()||(e.beginUndoMacro($.t("Toggle Log Scale")),o.percentage.value()&&e.setPercentProperty(o.percentage,!1,n,$.t("Toggle Percentage")),e.setLogProperty(o.log,!o.log.value(),n,$.t("Toggle Log Scale")),e.endUndoMacro())}),this._$autoScaleButton.on("click",function(e){e.preventDefault(),e=i.model();var t=e.mainSeries().priceScale(),n=t.properties();e.beginUndoMacro($.t("Toggle Auto Scale")),n.autoScale.value()&&n.percentage.value()&&e.setPercentProperty(n.percentage,!1,t,$.t("Toggle Percentage")),e.setAutoScaleProperty(n.autoScale,!n.autoScale.value(),t,$.t("Toggle Auto Scale")),e.endUndoMacro()}),n.on("click",function(e){e.preventDefault(),n.addClass("active"),i.showScalesProperties().on("remove",function(){n.removeClass("active")})}),this._$extendedHoursButton&&this._$extendedHoursButton.on("click",function(e){e.preventDefault(),e=i.model();var t=e.mainSeries().properties().extendedHours;e.setProperty(t,!t.value(),"Extended Hours")}),this._$dateRanges=$(document.createElement("div")).attr("class","chart-controls-bar-buttons date-range-wrapper").appendTo(e.parent),i.withModel(null,function(){var e=i.model().mainSeries(),n=e.priceScale();t.updateScaleButtons(),e.priceScaleChanged.subscribe(t,t.updateScaleButtons),n.properties().autoScale.subscribe(t,t.updateScaleButtons),t.updateDateRangeButtons(),e.onStatusChanged().subscribe(t,t.updateDateRangeButtons),W77.enabled("update_timeframes_set_on_symbol_resolve")&&e.onSymbolResolved().subscribe(t,t.updateDateRangeButtons),e.properties().lockScale.subscribe(t,t.updateDateRangeButtons),t.updateExtendedHoursButton(),e.properties().extendedHours.subscribe(t,t.updateExtendedHoursButton),e.properties().interval.subscribe(t,t.updateExtendedHoursButton)}),t.updateFullscreenChartButton();var r=this.D4.D5;r&&(r.layout.subscribe(this.updateFullscreenChartButton.bind(this)),r.maximizeCurrentChart.subscribe(this.updateFullscreenChartButton.bind(this)),this._$fullscreenChartButton.on("click",function(){r.activeChartWidget.setValue(i),r.maximizeCurrentChart.setValue(!r.maximizeCurrentChart.value())}))}return e.prototype.updateScaleButtons=function(){var e=this.D4.model().mainSeries().priceScale().properties(),t=e.log.value(),i=e.percentage.value(),e=e.autoScale.value();this._$logButton.toggleClass("active",t),this._$percButton.toggleClass("active",i),this._$autoScaleButton.toggleClass("active",e)},e.prototype.updateDateRangeButtons=function(){var e=this.D4;if(e.model().mainSeries().status()!=TradingView.Series.STATUS_LOADING){var t=e._dateRangeResolutions();if(t.length){this._$dateRanges.empty();for(var i=0;i<t.length;i++){var n=t[i],o=$(document.createElement("a")).text(n.text);o.appendTo(this._$dateRanges),o.click({val:n.value,res:n.targetResolution},function(t){e.model().loadRange(t.data)})}}}},e.prototype.updateExtendedHoursButton=function(){this._$extendedHoursButton&&(this.D4.model().mainSeries().properties().extendedHours.value()?this._$extendedHoursButton.addClass("active"):this._$extendedHoursButton.removeClass("active"))},e.prototype.updateFullscreenChartButton=function(){var e=this.D4.D5;e&&"s"!==e.layout.value()?(this._$fullscreenChartButton.show(),this._$fullscreenChartButton.toggleClass("active",e.maximizeCurrentChart.value())):this._$fullscreenChartButton.hide()},e.prototype.updateUI=function(){this.updateScaleButtons()},e}(),A69=function(){function e(t){if(!(this instanceof e))throw new TypeError("SymbolSearch is a constructor");if(this._inputParserMixin=W77.enabled("symbol_search_parser_mixin")?new A70(this):void 0,t=t||{},this._inputElement=$(t.input).get(0),!this._inputElement)throw new TypeError("options.input must be a DOM element, jQuery object or selector");if(this.$list=$(t.list).eq(0),0===this.$list.size()&&delete this.$list,void 0!==t.callback){if("function"!=typeof t.callback)throw new TypeError("options.callback must be function");this._callback=t.callback}if(void 0!==t.onValueChanged){if("function"!=typeof t.onValueChanged)throw new TypeError("options.onValueChanged must be function");this._onValueChanged=t.onValueChanged}if(void 0!==t.onEmptyApply){if("function"!=typeof t.onEmptyApply)throw new TypeError("options.onEmptyApply must be function");this._onEmptyApply=t.onEmptyApply}if(t.ignoreInterval&&(this._ignoreInterval=!0),e.resetStoredInterval(),t.hidePro&&(this._hidePro=!0),t.allowMultipleSymbols&&(this._allowMultipleSymbols=!0),void 0!==t.onParse){if("function"!=typeof t.onParse)throw new TypeError("options.onParse must be function");this._onParse=t.onParse}this._state={},$(this._inputElement).data("symbol-search-instance",this);for(var i=this._boundListener=this._eventListener.bind(this),n=this.boundTimeoutListener=function(e){setTimeout(function(){i(e)},0)},r=0;r<o.length;r++)o[r].immediate?$(this._inputElement).on(o[r].name,i):$(this._inputElement).on(o[r].name,n);this._boundOnKeyDown=this._onKeyDown.bind(this),this._boundOnKeyPress=this._onKeyPress.bind(this),$(this._inputElement).on("keydown",this._boundOnKeyDown).on("keypress",this._boundOnKeyPress),this._eventListener(),t.autoFocus&&e.registerAutoFocus(this)}function t(e,t){var i=D16.supportedSymbolsTypes(),n=TVSettings.getValue("symboledit.filter");return!i.some(function(e){return e.value===n})&&0<i.length&&(n=i[0].value),0==i.length?!1:(i.forEach(function(i){var o=i.value;i=$('<a class="type-filter">').attr("href","#"+o).text($.t(i.name)),o===n&&i.addClass("active"),i.on("click",function(i){i.preventDefault(),t.find(".type-filter").removeClass("active"),$(this).addClass("active"),e.typeFilter(o),TVSettings.setValue("symboledit.filter",o)}),i.appendTo(t)}),e.typeFilter(n),!0)}function i(e,t){var i=D16.supportedExchangesList(),n=TVSettings.getValue("symboledit.exchangefilter");if(!i.some(function(e){return e.value===n})&&0<i.length&&(n=i[0].value),0==i.length)return!1;var o=$('<div class="exchange-filter">').appendTo(t),r=$("<select>").appendTo(o);return i.forEach(function(e){var t=e.value,i=e.name||t,o=e.desc||i,t=$("<option>").attr("value",t).text($.t(i)).data("custom-option-text",$.t(o)).appendTo(r);e.value===n&&t.attr("selected",!0)}),r.change(function(){var t=$(this).val()||"";TVSettings.setValue("symboledit.exchangefilter",t),e.exchangeFilter(t)}),r.selectbox({speed:0,classHolder:"tv-unstyled-select-container tv-symbol-select"}),e.exchangeFilter(n),!0}function n(e){return e.ctrlKey||e.metaKey||!e.charCode||!e.which||32>=e.which||/^(input|textarea)$/i.test(e.target.tagName)||A83.modalDialog?!1:!0}var o=[{name:"input",immediate:!0},{name:"sync",immediate:!0},{name:"keypress"},{name:"keydown"},{name:"keyup"},{name:"mousedown"},{name:"mouseup"},{name:"cut"},{name:"paste"}],r=[/^e\-m/i];return e.registerAutoFocus=function(t){if(t instanceof jQuery&&(t=t.data("symbol-search-instance")),!(t instanceof e))throw new TypeError("arg must be an SymbolSearch instance of jQuery input with bound SymbolSearch object");TradingView.keyboardBinder.registerListener("symbolEdit",function(e){n(e)&&(e.preventDefault(),this.resetState(),this._skipAutoFocus=!0,this._inputElement.focus(),e=String.fromCharCode(e.charCode),"function"==typeof this._setInputValue?this._setInputValue(e):this._inputElement.value=e,this._eventListener())}.bind(t))},e.prototype.resetState=function(){this._state={}},e.prototype.typeFilter=function(e){return 0<arguments.length?void(e!==this._state.typeFilter&&(null==e?delete this._state.typeFilter:this._state.typeFilter=e+"",delete this._state.keepListFor,this._onSelectionChanged())):this._state.typeFilter},e.prototype.exchangeFilter=function(e){return 0<arguments.length?void(e!==this._state.exchangeFilter&&(null==e?delete this._state.exchangeFilter:this._state.exchangeFilter=e+"",delete this._state.keepListFor,this._onSelectionChanged())):this._state.exchangeFilter},e.prototype._moveSelection=function(e,t){if(this._state.suggestOptions&&0!==this._state.suggestOptions.length){var i,n=this.$list.find("tbody tr:not(.group-close):not(.hidden)"),o=this.$list.find("tr.symbol-edit-popup-active"),r=-1;o.size()?(r=n.index(o),i=Math.max(0,Math.min(r+e,n.size()-1))):i=0,r!=i&&(n=n.eq(i),r=n.data("item"),o.length&&o.removeClass("symbol-edit-popup-active"),r.groupTitle?(n.addClass("symbol-edit-popup-active"),this._selectedGroupItem=r,delete this._state.highlightIndex,this._scrollHighlightIntoView()):(this._selectedGroupItem&&(this._selectedGroupItem=null),o=this._state.suggestOptions.indexOf(r),this._highlightOption(~o&&o||0,!0,t)))}},e.prototype._groupSetCollapsed=function(e,t){e.groupTitle&&this._groupListHandler&&this._groupListHandler.setCollapsed(e.root,t)},e.prototype._onKeyDown=function(e){(40===e.keyCode||38===e.keyCode)&&(this._moveSelection(40===e.keyCode?1:-1,!0),e.preventDefault()),!this._selectedGroupItem||37!==e.keyCode&&39!==e.keyCode||(this._groupSetCollapsed(this._selectedGroupItem,37===e.keyCode),e.preventDefault())},e.prototype._onKeyPress=function(e){if(40===e.keyCode||38===e.keyCode){if(e.charCode)return;if(this._boundOnKeyDown)return $(this._inputElement).off("keydown",this._boundOnKeyDown),delete this._boundOnKeyDown,void e.preventDefault();this._moveSelection(40===e.keyCode?1:-1),e.preventDefault()}13===e.keyCode&&(this._selectedGroupItem?(this._groupSetCollapsed(this._selectedGroupItem,!1),e.preventDefault()):this.acceptTypeIn())},e.prototype._eventListener=function(e,t){var i=this._inputElement,n=this._getInputValue().toUpperCase(),o=!1;this._state.value!==n&&(this._state.hasOwnProperty("value")&&this._onValueChanged&&this._onValueChanged(n),this._state.value=n,o=!0,this._inputParserMixin&&this._inputParserMixin.parse()),this._fixIntervalCase(),n=this._limitInputSelectionValue("selectionStart"),this._state.selectionStart!==n&&(this._state.selectionStart=n,o=!0),n=this._limitInputSelectionValue("selectionEnd"),this._state.selectionEnd!==n&&(this._state.selectionEnd=n,o=!0),this._state.selectionDirection!==i.selectionDirection&&(this._state.selectionDirection=i.selectionDirection,o=!0),o&&(this._onSelectionChanged(void 0,t),o=!1,this._getInputValue()!==this._state.value&&(this._setInputValue(this._state.value),o=!0),(o||this._state.selectionStart!==this._limitInputSelectionValue("selectionStart")||this._state.selectionEnd!==this._limitInputSelectionValue("selectionEnd"))&&i.setSelectionRange(this._state.selectionStart,this._state.selectionEnd,this._state.selectionDirection))},e.prototype._fixIntervalCase=function(){if(this._selectionInsideInterval()){var t=e.detachInterval(this._inputElement.value);/[a-z]/.test(t.detached)&&(this._inputElement.value=t.rest+t.detached.toUpperCase())}},e.prototype._selectionInsideInterval=function(t){if(this._ignoreInterval)return!1;var i=e.detachInterval(this._inputElement.value);return i?"string"==typeof t?this._inputElement[t]>i.rest.length:this._inputElement.selectionStart>i.rest.length&&this._inputElement.selectionEnd>i.rest.length:!1},e.prototype._limitInputSelectionValue=function(t){return this._selectionInsideInterval(t)?e.detachInterval(this._inputElement.value).rest.length:this._inputElement[t]},e.prototype._getInputValue=function(){if(this._ignoreInterval)return this._inputElement.value;var t=e.detachStoreInterval(this._inputElement.value);return $(this._inputElement).toggleClass("interval-error",e.intervalError()),t},e.prototype._setInputValue=function(t){this._inputElement.value=this._ignoreInterval?t:e.recallAttachInterval(t)},e.prototype._onSelectionChanged=function(e,t){function i(e,t,i,o){n._state.contextTicker=e,n._state.contextExchange=t,n._state.contextType=i,n._state.keepListFor&&n._state.keepListFor===o||(n._getSuggestList(),delete n._state.keepListFor)}var n=this;if(!r.some(function(e){return e.test(n._state.value)})&&this._inputParserMixin&&!0!==t)this._inputParserMixin.onSelectionChanged(i);else{var o=this._state.value;i(o,this._state.exchangeFilter,this._state.typeFilter,this._state._selectedTicker||o)}},e.prototype._clearSelectionState=function(){delete this._state.contextTicker,delete this._state.contextExchange,delete this._state.contextType,delete this._state.contextToken,delete this._state.keepListFor},e.prototype._getSuggestList=function(){var e=this,t=this._state.contextTicker||"",i=this._state.contextExchange||this._state.exchangeFilter||"",n=this._state.typeFilter||"";this._showLoading(),D16.searchSymbolsByName(t,i,n,"undefined"!=typeof D3?D3:void 0,function(o){t===(e._state.contextTicker||"")&&i===(e._state.contextExchange||e._state.exchangeFilter||"")&&n===(e._state.typeFilter||"")&&e._renderSuggestList(o)})},e.prototype._showLoading=function(){this.$list&&(this._clearSuggestList(),$('<div class="symbol-search-loading">').appendTo(this.$list))},e.prototype._renderSuggestList=function(t){if(this.$list){var i=this,n=this._state;this._clearSuggestList();var o=n.suggestOptions=[],r=RegExpEscape(n.contextTicker).trim(),s=new RegExp(r.replace(" ","|"),"i"+(1<r.length?"g":""));if(delete n.highlightIndex,this._hidePro&&(t=t.filter(function(e){return!e.params||-1===e.params.indexOf("pro")})),0===t.length)this.$list.html('<div style="text-align: center; padding: 7px 0; font-style: italic;">'+$.t("No symbols matched your criteria")+"</div>");else{var a=$('<table class="symbol-edit-popup">').appendTo(this.$list),l=new e.GroupListHandler(a,s);t.forEach(function(e){e.ticker||(e.ticker=e.full_name);var t=$('<tr class="symbol-edit-popup">'),i=$('<td class="symbol-edit-popup-td name apply-overflow-title">');i.html(e.symbol.replace(s,"<strong>$&</strong>")),i.appendTo(t),""!==e.platform?t.addClass(e.platform):t.addClass("others"),$('<td class="symbol-edit-popup-td desc apply-overflow-title">').html(s.test(e.symbol)?e.description:e.description.replace(s,"<strong>$&</strong>")).appendTo(t),""!==e.platform?$('<td class="symbol-edit-popup-td type apply-overflow-title">').append("BTCC&nbsp;<span>"+e.platform+"</span>&nbsp;Exchange").appendTo(t):$('<td class="symbol-edit-popup-td type apply-overflow-title">').appendTo(t),$('<td class="symbol-edit-popup-td type apply-overflow-title">').append(e.property).appendTo(t),"futures"==e.type?l.append(e,t):t.appendTo(a),e._$tr=t,t.data("item",e)}),l.collapse(),this._groupListHandler=l,t=0;for(var d,h,r=this.$list.find("tbody tr:not(.group-close)");t<r.size();t++)d=r.eq(t),d=d.data("item"),o.push(d),d.ticker===n.contextTicker&&d.exchange===n.contextExchange&&void 0===h&&(h=t);"number"==typeof h&&this._highlightOption(h),a.on("click","tr",function(e){e.isDefaultPrevented()||(e.preventDefault(),i._state.suggestOptions&&(e=$(this).data("item"))&&e.full_name&&i.accept(e.full_name,e.ticker))})}}},e.prototype._highlightOption=function(e,t,i){var n=this._state;n.highlightIndex!==e&&(void 0!==n.highlightIndex&&n.suggestOptions[this._state.highlightIndex]._$tr&&n.suggestOptions[this._state.highlightIndex]._$tr.removeClass("symbol-edit-popup-active"),n.highlightIndex=e,(e=n.suggestOptions[e]._$tr)&&e.addClass("symbol-edit-popup-active"),this._scrollHighlightIntoView(),t&&this._replaceCurrentSymbol(i))},e.prototype._scrollHighlightIntoView=function(){$tr=this.$list.find("tr.symbol-edit-popup-active"),$tr.length&&($tr.offset().top<this.$list.offset().top?this.$list.scrollTop(this.$list.scrollTop()-(this.$list.offset().top-$tr.offset().top)):$tr.offset().top+$tr.outerHeight()>this.$list.offset().top+this.$list.outerHeight()&&this.$list.scrollTop(this.$list.scrollTop()+($tr.offset().top+$tr.outerHeight()-(this.$list.offset().top+this.$list.outerHeight()))))},e.prototype._clearSuggestList=function(){delete this._state.suggestOptions,this.$list&&this.$list.empty()},e.prototype._showErrorNotice=function(){this.$list&&(this._clearSuggestList(),this.$list.text("Invalid expression"))},e.prototype._replaceCurrentSymbol=function(e){var t=this._state;if(t.suggestOptions&&void 0!==t.highlightIndex){var i=t.suggestOptions[t.highlightIndex],n="",o=0;if(this._inputParserMixin&&!0!==e){if(i=this._inputParserMixin.replaceCurrentSymbol(i),!i.ok)return;n=i.newValue,o=i.newCaretPos,t.keepListFor=i.keepListFor}else n=!0===e&&i.full_name&&this._inputParserMixin?i.full_name:i.symbol,o=n.length,this._state._selectedTicker=t.keepListFor=i.ticker||i.symbol;this._setInputValue(n),this._inputElement.setSelectionRange(o,o),this._eventListener(void 0,e)}},e.prototype.splitAndAcceptUserInput=function(){for(var e=this._getInputValue().split(","),t=0;t<e.length;t++)this.acceptSymbolIn(e[t])},e.prototype.acceptSymbolIn=function(e){var t,i;this._inputParserMixin?t=this._inputParserMixin.parseSymbol(e):(t=e,i=this._state._selectedTicker||e),this.accept(t,i)},e.prototype.acceptTypeIn=function(){
this._allowMultipleSymbols?this.splitAndAcceptUserInput():this.acceptSymbolIn(this._getInputValue())},e.prototype.accept=function(t,i){if(i=i||t){delete this._state.keepListFor;var n=this._ignoreInterval?void 0:e.getInterval(!0);this._inputElement.value=t,this._eventListener(),this._callback&&this._callback(i,n),$(this._inputElement).trigger("accept-symbol",[i])}},e.prototype.bindListWrapper=function(e){if(e=$(e).eq(0),0===e.size())throw new TypeError("element must be a DOM element, jQuery object or selector");this.$list=e,this._clearSelectionState(),this._eventListener()},e.prototype.removeListWrapper=function(){delete this.$list,this._clearSuggestList(),this._clearSelectionState(),this._eventListener()},e.showDialog=function(n){if(n=n||{},!A83.get("Symbol Search")){var o=A83.createDialog("Symbol Search",{hideTitle:!0,hideCloseCross:!0,dragHandle:".filter",width:"650px",content:TradingView.templates.dialogs.symbolSearch});A83.positionDialog(o);var r=o.find(".tv-dialog-content").addClass("symbol-search-dialog"),s=r.find(".results");s.mousewheel(function(e,t){var i=$(this);t>0?i.scrollTop(i.scrollTop()-15):i.scrollTop(i.scrollTop()+15)});var a=r.find("input").get(0);n.initialValue&&(a.value=n.initialValue),a.selectionStart=a.selectionEnd=a.value.length,a.focus();var l;if("undefined"!=typeof A70){var d,h;n.ignoreInterval||(d=e.getInputValueGetter(a),h=e.getInputValueSetter(a)),l=A70.addSpreadActions(r.find(".spread-actions"),a,d,h)}return l=new e({input:a,list:r.find(".results").get(0),callback:function(e,t){n.callback&&n.callback(e,t),A83.destroy("Symbol Search")},onParse:l,ignoreInterval:n.ignoreInterval}),r=r.find(".filter"),d=t(l,r),l=i(l,r),d||l||r.attr("style","display: none"),A83.resizeContent(o.height(),s),A83.applyHandlers(o),A83.positionDialog(o),o.on("destroy",function(){TVSettings.setValue("symboledit.dialog_last_entry",a.value)}),o}},e.bindToInput=function(n,o){function r(){h&&(g.removeListWrapper(),h.off(),h.remove(),h=null)}function s(e){e.preventDefault()}o=o||{},n=$(n).eq(0);var a=o.callback,l=null,d=null,h=null,c=void 0,p=o.spreadActions&&$(o.spreadActions).eq(0);if(p&&p.size()&&"undefined"!=typeof A70){var u,f;o.ignoreInterval||(u=e.getInputValueGetter(n.get(0)),f=e.getInputValueSetter(n.get(0))),c=A70.addSpreadActions(p,n.get(0),u,f)}var g=new e({input:n,onValueChanged:function(){if(!h){var e=g,n=$('<div class="symbol-edit-popup">').appendTo(document.body),o=$('<div class="filter">').appendTo(n);t(e,o),i(e,o);var r=$('<div class="table-wrapper">').appendTo(n),a=$(e._inputElement),e=a.offset();leftOffset=Math.max(0,Math.min(e.left+0,$(window).width()-n.outerWidth())),n.css("left",leftOffset+"px"),n.css("top",e.top+a.outerHeight()+1);var l=parseInt($(window).height(),10),o=o.outerHeight(),d=$(window).scrollTop(),a=a.height();r.css("maxHeight",l-(e.top-d)-a/2-a-o+"px"),h=n,g.bindListWrapper(r),h.on("focus","*",s),h.on("click","*",s),h.on("mousedown","*",s)}W77.enabled("charting_library")&&(n=this._state,n.keepListFor&&(n.suggestOptions&&void 0!==n.highlightIndex?(n=n.suggestOptions[n.highlightIndex],r=this._getInputValue().toUpperCase(),n.symbol!=r&&delete this._state.keepListFor):delete this._state.keepListFor))},callback:function(e,t){r(),"function"==typeof d&&d(e,t)||("function"==typeof a&&a(e,t),"function"==typeof l&&l(e,t)),o.clearAfterAccept&&n.val(""),o.keepFocus?n.get(0).focus():n.get(0).blur(),g.resetState()},hidePro:o.hidePro,autoFocus:o.autoFocus,onEmptyApply:o.onEmptyApply,onParse:c,allowMultipleSymbols:o.allowMultipleSymbols,ignoreInterval:o.ignoreInterval}),m=!1;if(n.on("focus",function(e,t){m=!0,g._skipAutoFocus?delete g._skipAutoFocus:setTimeout(function(){m&&n.get(0).select()},0)}),n.on("blur",function(e){m=!1,setTimeout(function(){m||r()},0)}),o.syncWithChartWidget){var _=function(e){e=e&&A45.seriesShortSymbol.value()||A45.symbol.value()||"",n.val(e),g.resetState()};_(!0),A45.seriesShortSymbol.subscribe(function(){_(!0)}),l=function(e,t){e&&A45.symbol.setValue(e),t&&A45.interval.setValue(t)},d=function(e,t){return t?!1:e===A45.symbol.value()||e===A45.seriesShortSymbol.value()?!0:void 0},n.on("keypress",function(e){27===e.keyCode&&(n.get(0).blur(),_(!1))}),n.on("keydown",function(e){27===e.keyCode&&(n.get(0).blur(),_(!1))})}return g},e.GroupListHandler=function(e,t){this._$container=e,this._tickerRegExp=t,this._roots={}},e.GroupListHandler.prototype.addRoot=function(e,t,i){var n=this,o=i.clone().addClass("group-title").click(function(t){t.preventDefault(),n[o.hasClass("collapsed")?"expand":"collapse"](e)});o.find("td.name").html("<div>"+e.replace(this._tickerRegExp,"<strong>$&</strong>")+"</div>"),o.find("td.type").html(t.type),o.appendTo(this._$container),o.data("item",{groupTitle:!0,root:e}),t=$('<tr class="group-close"><td colspan="3"></td></tr>').appendTo(this._$container),this._roots[e]={titleRow:o,closeRow:t}},e.GroupListHandler.prototype.append=function(e,t){var i=/^(.+)([12]!|\w\d{4})$/.exec(String(e.symbol));i?(i=i[1],this._roots[i]||this.addRoot(i,e,t),t.addClass("root-"+i).insertBefore(this._roots[i].closeRow)):t.appendTo(this._$container)},e.GroupListHandler.prototype.setCollapsed=function(e,t){if(e){if(this._roots[e]){var i=!0===t?"addClass":"removeClass";this._roots[e].titleRow[i]("collapsed"),this._$container.find("tr.root-"+e)[i]("hidden")}}else for(e in this._roots)this.setCollapsed(e,t)},e.GroupListHandler.prototype.collapse=function(e){this.setCollapsed(e,!0)},e.GroupListHandler.prototype.expand=function(e){this.setCollapsed(e,!1)},e.isIntervalInit=function(e){return/[\d,]/.test(e)&&W77.enabled("show_interval_dialog_on_key_press")},e.isIntervalChar=function(e){return/[\dhdwm]/i.test(e)},e.parseIntervalValue=function(e){var t=/^[,\s]*(\d*)\s*([hdwm]?)\s*$/i.exec(e)||[];e=~~t[1];var t=t[2]&&t[2].toUpperCase(),i={qty:!e&&t?1:e,unit:t||null};return i.error=!e&&!t,i.intraday=!(i.error||i.unit&&"H"!=i.unit),i},e.sanitizeIntervalValue=function(t){t=e.parseIntervalValue(t);var i=t.qty,n=t.unit;return t.error?null:("H"==n&&(i*=60,n=null),i&&!n?String(i):!n||i&&1!=i?i+n:n)},e.detachInterval=function(e){var t=/,[^,]*$/i.exec(e)||[];return t[0]?{rest:e.substr(0,e.length-t[0].length),detached:t[0]}:void 0},e.intervalIsSupported=function(t){if(W77.enabled("allow_supported_resolutions_set_only"))return t=this.sanitizeIntervalValue(t),null===t?!1:IntervalHelper.isAvailable(t);if(t=e.parseIntervalValue(t),t.error)return!1;if(t.intraday)return A45.intraday.value();var i=A45.supportedResolutions.value();return i?!!~i.indexOf(t.unit):!0},function(){var t="",i=null;e.resetStoredInterval=function(){t="",i=null},e.detachStoreInterval=function(n){var o=e.detachInterval(n);return o?(t=o.detached,i=e.sanitizeIntervalValue(t),o.rest):(e.resetStoredInterval(),n)},e.recallAttachInterval=function(e){return e+t},e.getInterval=function(t){var n=i;return!0===t&&e.resetStoredInterval(),n},e.getInputValueGetter=function(t){return function(){return e.detachStoreInterval(t.value)}},e.getInputValueSetter=function(t){return function(i){t.value=e.recallAttachInterval(i)}},e.intervalError=function(){return!t||/^,\s*$/.test(t)?!1:!i}}(),e.registerDialogKeypressHandler=function(t){if(!t)throw new TypeError("D3 is required");TradingView.keyboardBinder.pushBackListener("symbolEdit",function(t){n(t)&&(t.preventDefault(),t=String.fromCharCode(t.charCode),e.isIntervalInit(t)?new ChangeIntervalDialog({callback:function(e){A45.interval.setValue(e)}}).show(t):e.showDialog({initialValue:t,callback:function(e,t){A45.symbol.setValue(e),t&&A45.interval.setValue(t)}}))})},e}(),TradingView.MiniChartWidget=function(e,t,i){this.$container=t,this._options=_options=$.extend(!0,this.defaults(),i||{}),this._ctx=this._canvas=null,this._plots=$.map(e||[],function(e){return new TradingView.MiniChartWidgetPlot(e.data,$.extend(!0,{},_options.plot,e.options))}),this._initCanvas(),e=function(){return this._plots}.bind(this),this._xScale=new TradingView.MiniChartWidgetXScale(e,this._ctx,this._options.xScale),this._yScale=new TradingView.MiniChartWidgetYScale(e,this._ctx,this._options.yScale),this._plotArea=new TradingView.MiniChartWidgetPlotArea(e,this._ctx,this._xScale,this._yScale,{grid:this._options.grid,plot:this._options.plot,loading:this._options.loading}),this.height=new WatchedValue(0),this.width=new WatchedValue(0),this._initSizeHandling(),this.resetSize(),this._onPlotsChanged(),this.bindOnResize()},TradingView.MiniChartWidget.prototype.defaults=function(){return{minWidth:100,minHeight:75,bgColor:null,grid:{xIsVisible:!0,yIsVisible:!0,line:{width:1,style:CanvasEx.LINESTYLE_DASHED,color:"#e9e9ea"}},xScale:{visible:!0,position:"bottom",isTimeScale:!0,paddingTop:4,paddingBottom:4,font:{size:10,family:"Helvetica",color:"#83888d"},drawOverPlotArea:!0,bgColor:"transparent",borderColor:"transparent",drawTickMarkLine:!1,maxTickMarkAmount:10},yScale:{visible:!0,position:"right",isPercentage:!1,paddingLeft:4,paddingRight:4,marginInPercents:10,font:{size:10,family:"Helvetica",color:"#83888d"},drawOverPlotArea:!0,bgColor:"transparent",borderColor:"transparent",drawTickMarkLine:!1,maxTickMarkAmount:10},plot:{line:{width:2,color:"#ff7965"},belowLineFillStyle:"rgba(180, 180, 180, 0.2)",aboveLineFillStyle:null},loading:{lines:9,length:0,width:5,radius:8,corners:1,color:null,speed:.75}}},TradingView.MiniChartWidget.prototype._initCanvas=function(){this._canvas=TradingView.addCanvasTo(this.$container,{w:this._options.minWidth,h:this._options.minHeight}),$(this._canvas).css("display","block"),this._ctx=this._canvas.getContext("2d"),this._ctx._fillText=function(e,t,i){t=Math.round(t),i=Math.round(i),this._ctx.fillText(e,t,i)}.bind(this)},TradingView.MiniChartWidget.prototype._initSizeHandling=function(){function e(){var e=o._options.drawOverPlotArea||!o._options.visible?n.height.value():n.height.value()-o.height.value();s.height.setValue(e)}function t(){var e=r._options.drawOverPlotArea||!r._options.visible?n.width.value():n.width.value()-r.width.value();s.width.setValue(e)}function i(){var e=0;"right"===r._options.position&&(e=r._options.drawOverPlotArea||!r._options.visible?s.width.value()-r.width.value():s.width.value()),r.originX.setValue(e)}var n=this,o=this._xScale,r=this._yScale,s=this._plotArea;n.height.subscribe(e),o.height.subscribe(e),s.height.subscribe(function(e){r.height.setValue(e),e=0,"bottom"===o._options.position&&(e=o._options.drawOverPlotArea||!o._options.visible?s.height.value()-o.height.value():s.height.value()),o.originY.setValue(e)}),n.width.subscribe(t),r.width.subscribe(t),r.width.subscribe(function(){var e=0;"left"===r._options.position&&(e=r.width.value()),s.originX.setValue(e)}),r.width.subscribe(i),r.width.subscribe(function(){var e=0;"left"===r._options.position&&(e=r.width.value()),o.originX.setValue(e)}),s.width.subscribe(function(e){o.width.setValue(e),i()})},TradingView.MiniChartWidget.prototype.resetSize=function(){var e=this.$container.height()||this._options.minHeight,t=this.$container.width()||this._options.minWidth;this._xScale.originX.setValue("left"===this._yScale._options.position?this._yScale.width.value():0),this._yScale.originY.setValue("top"===this._xScale._options.position?this._xScale.height.value():0),TradingView.setCanvasSize(this._canvas,{h:e,w:t}),this.height.setValue(e),this.width.setValue(t)},TradingView.MiniChartWidget.prototype.onResize=function(){this.resetSize(),this.draw()},TradingView.MiniChartWidget.prototype.bindOnResize=function(){this._onResize||(this._onResize=this.onResize.bind(this)),this.$container.resize(this._onResize)},TradingView.MiniChartWidget.prototype.unbindOnResize=function(){this._onResize&&(this.$container.off("resize",this._onResize),delete this._onResize)},TradingView.MiniChartWidget.prototype.addPlot=function(e){var t=e;if(!(t instanceof TradingView.MiniChartWidgetPlot)){if(!t.data)return void console.error("[MiniChartWidget] wrong plot format");t=new TradingView.MiniChartWidgetPlot(t.data,$.extend(!0,{},this._options.plot,t.options))}return $.grep(this._plots,function(e){return e.id===t.id}).length?void 0:(this._plots.push(t),t.dataChanged.subscribe(this,this._onPlotsChanged),this._onPlotsChanged(),t)},TradingView.MiniChartWidget.prototype._onPlotsChanged=function(){this._yScale.onPlotsChanged(),this._xScale.onPlotsChanged(),this.draw()},TradingView.MiniChartWidget.prototype.removePlot=function(e){this._plots=$.grep(this._plots,function(t){return t.id!==e.id}),this._yScale.onPlotsChanged.call(this._yScale),this._xScale.onPlotsChanged.call(this._xScale),this.draw()},TradingView.MiniChartWidget.prototype.removeAllPlots=function(){this._plots=[],this._yScale.onPlotsChanged.call(this._yScale),this._xScale.onPlotsChanged.call(this._xScale),this.draw()},TradingView.MiniChartWidget.prototype.draw=function(){this._plotArea.draw(),this._yScale.draw(),this._xScale.draw()},TradingView.MiniChartWidget.prototype.showMessage=function(e){this._options.showMessage&&this._writeMessage(e)},TradingView.MiniChartWidget.prototype.writeText=function(e){this._options.bgColor&&"transparent"!==this._options.bgColor?(this._ctx.fillStyle=this._options.bgColor,this._ctx.fillRect(0,0,this.width.value(),this.height.value())):this._ctx.clearRect(0,0,this.width.value(),this.height.value());var t=this._ctx.measureText(e).width;this._ctx.fillStyle=this._options.xScale.font.color,this._ctx.font=this._options.xScale.font.size+"px "+this._options.xScale.font.family,this._ctx._fillText(e,(this.width.value()-t)/2,(this.height.value()-this._options.xScale.font.size)/2)},TradingView.MiniChartWidgetPlot=function(e,t){this.id=TradingView.guid(),this._options=$.extend(!0,{},t),this._y=this._x=null,e&&this.setData(e,!0),this.dataChanged=new Delegate},TradingView.MiniChartWidgetPlot.prototype.setData=function(e,t){e.x&&e.y||console.error("[MiniChartWidgetPlot] wrong data format"),this._x=e.x,this._y=e.y,t||this.dataChanged.fire()},TradingView.MiniChartWidgetPlot.prototype.x=function(){return this._x},TradingView.MiniChartWidgetPlot.prototype.y=function(e){var t=this._y;if(!e)return t;var i=function(){for(var e=0,i=t.length;i>e;e++)if(isNumber(t[e]))return t[e]}()/100;return $.map(t,function(e){return isNumber(e)?e/i-100:void 0})},TradingView.MiniChartWidgetRectangle=function(e,t,i,n){this.originX=new WatchedValue(e||0),this.originY=new WatchedValue(t||0),this.width=new WatchedValue(i||0),this.height=new WatchedValue(n||0)},TradingView.MiniChartWidgetRectangle.prototype.left=function(){return this.originX.value()},TradingView.MiniChartWidgetRectangle.prototype.right=function(){return this.originX.value()+this.width.value()},TradingView.MiniChartWidgetRectangle.prototype.top=function(){return this.originY.value()},TradingView.MiniChartWidgetRectangle.prototype.bottom=function(){return this.originY.value()+this.height.value()},TradingView.MiniChartWidgetRectangle.prototype.clearBack=function(){var e=this._ctx,t=this.left()-.5,i=this.top()-.5,n=this.right()+.5,o=this.bottom()+.5;this._options.bgColor&&"transparent"!==this._options.bgColor?(e.fillStyle=this._options.bgColor,e.fillRect(t,i,n,o)):e.clearRect(t,i,n,o)},TradingView.MiniChartWidgetPlotArea=function(e,t,i,n,o){TradingView.MiniChartWidgetRectangle.call(this),this.getWidgetPlots=e,this._ctx=t,this._xScale=i,this._yScale=n,this._options=o,this.originY.setValue("bottom"===this._xScale._options.position?0:this._xScale.height.value()),this.originY.setValue=function(){console.warn("[MiniChartWidgetPlotArea] updating originY forbidden")}},inherit(TradingView.MiniChartWidgetPlotArea,TradingView.MiniChartWidgetRectangle),TradingView.MiniChartWidgetPlotArea.prototype.draw=function(){this.clearBack(),this._drawGrid(),this.getWidgetPlots().length?(this._drawPlots(),this._hideLoading()):this._options.loading.showWhileNoPlots&&this._showLoading()},TradingView.MiniChartWidgetPlotArea.prototype._drawGrid=function(e){e=this._ctx;var t,i,n,o,r=this.left(),s=this.right(),a=this.top(),l=this.bottom();e.lineWidth=this._options.grid.line.width,e.strokeStyle=this._options.grid.line.color,e.lineStyle=this._options.grid.line.style;var d=this._xScale.tickMarks();if(d.length&&this._options.grid.xIsVisible)for(var h=0;h<d.length;h++)t=d[h].coordinate,i=a,n=d[h].coordinate,o=l,CanvasEx.drawLine(e,t,i,n,o);if(a=this._yScale.tickMarks(),a.length&&this._options.grid.yIsVisible)for(h=0;h<a.length;h++)t=r,i=a[h].coordinate,n=s,o=a[h].coordinate,CanvasEx.drawLine(e,t,i,n,o)},TradingView.MiniChartWidgetPlotArea.prototype._drawPlots=function(){var e=this.getWidgetPlots(),t=this._ctx,i=this._xScale.valueToCoord.bind(this._xScale),n=this._yScale.valueToCoord.bind(this._yScale);this.left(),this.right();for(var o,r,s,a=this.top(),l=this.bottom(),d=0;d<e.length;d++)o=e[d],r=$.map(o.x(),function(e){return i(e)}),s=$.map(o.y(this._yScale._options.isPercentage),function(e){return n(e)}),1===r.length?this._drawCircle(r[0],s[0],o._options.line.width,o._options.line.color):(o._options.belowLineFillStyle&&"transparent"!==o._options.belowLineFillStyle&&this._drawNearAroundArea(t,r,s,l,o._options.belowLineFillStyle),o._options.aboveLineFillStyle&&"transparent"!==o._options.aboveLineFillStyle&&this._drawNearAroundArea(t,r,s,a,o._options.aboveLineFillStyle),this._drawLine(t,r,s,o._options.line.width,o._options.line.color))},TradingView.MiniChartWidgetPlotArea.prototype._drawNearAroundArea=function(e,t,i,n,o){var r=function(){for(var e=0,n=t.length;n>e;e++)if(isNumber(t[e])&&isNumber(i[e]))return e;return null}(),s=function(){for(var e=t.length-1;e>=0;e--)if(isNumber(t[e])&&isNumber(i[e]))return e;return null}();if(null!==r||null!==s){for(e.fillStyle=o,e.beginPath(),e.moveTo(t[r],n),o=r;s>=o;o++)isNumber(t[o])&&isNumber(i[o])&&e.lineTo(t[o],i[o]);e.lineTo(t[s],n),e.closePath(),e.fill()}},TradingView.MiniChartWidgetPlotArea.prototype._drawLine=function(e,t,i,n,o){var r=function(){for(var e=0,n=t.length;n>e;e++)if(isNumber(t[e])&&isNumber(i[e]))return e;return null}(),s=function(){for(var e=t.length-1;e>=0;e--)if(isNumber(t[e])&&isNumber(i[e]))return e;return null}();if(null!==r||null!==s){for(e.lineWidth=n,e.strokeStyle=o,e.moveTo(t[r],i[r]),e.beginPath(),n=r;s>=n;n++)isNumber(t[n])&&isNumber(i[n])&&e.lineTo(t[n],i[n]);e.stroke()}},TradingView.MiniChartWidgetPlotArea.prototype._drawCircle=function(e,t,i,n,o){isNumber(t)&&isNumber(i)&&(e.beginPath(),e.arc(x,y,n,0,2*Math.PI,!1),e.fillStyle=o,e.fill())},TradingView.MiniChartWidgetPlotArea.prototype._showLoading=function(){this._$loadingIndicator||(this._$loadingIndicator=$("<div></div>"),new Spinner({lines:this._options.loading.lines,length:this._options.loading.length,width:this._options.loading.width,radius:this._options.loading.radius,corners:this._options.loading.corners,rotate:0,direction:1,color:this._options.loading.color||this._options.grid.line.color,speed:this._options.loading.speed,trail:100,shadow:!1,hwaccel:!1,className:"spinner",zIndex:1,top:"50%",left:"50%"}).spin(this._$loadingIndicator.get(0)),this._$loadingIndicator.insertAfter(this._ctx.canvas)),this._$loadingIndicator.show()},TradingView.MiniChartWidgetPlotArea.prototype._hideLoading=function(){this._$loadingIndicator&&this._$loadingIndicator.hide()},TradingView.MiniChartWidgetAbstractScale=function(e,t,i){TradingView.MiniChartWidgetRectangle.call(this),this._ctx=t,this._options=i,this._max=this._min=null,this._tickMarks=[],this.getWidgetPlots=e},inherit(TradingView.MiniChartWidgetAbstractScale,TradingView.MiniChartWidgetRectangle),TradingView.MiniChartWidgetAbstractScale.prototype._calculateTickMarks=function(e,t,i){function n(e){return Math.round(1e6*e)/1e6+(a._options.isPercentage?"%":"")}function o(e){var o=n(e);return e=a.valueToCoord(e),"vertical"!==i||p?"vertical"===i&&p?e+.5*t(o):"horizontal"!==i||p?"horizontal"===i&&p?e-.5*t(o):void 0:e:e}function r(e){var o=n(e);return e=a.valueToCoord(e),"vertical"!==i||p?"vertical"===i&&p?e-.5*t(o):"horizontal"!==i||p?"horizontal"===i&&p?e+.5*t(o):void 0:e+a._GREED_MARGIN+t(o):e-a._GREED_MARGIN-t(o)}function s(e,t){return"vertical"===i?r(e)-c>o(t):r(e)+c<o(t)}var a=this,l=a._min,d=a._max;if(!e||null===l||null===d||"function"!=typeof t)return[];i=i||"vertical";var h=a._options.maxTickMarkAmount||10,c=e/(h||20),p=!a._options.drawOverPlotArea;if(e=[],l===d)e=[l];else for(;h>0;){e=(d-l)/h;var u=Math.pow(10,Math.ceil(Math.log(e)/Math.LN10));u/5>=e&&(u/=5),u/2>=e&&(u/=2);var f=Math.floor(l/u)*u;for(l>f&&(f=Math.ceil(l/u)*u),e=[f];e[e.length-1]+u<=d;)e.push(e[e.length-1]+u);for(var g,u=!1,m=1;m<e.length;m++){if(g=e[m],!s(f,g)){u=!0;break}f=g}if(!u)break;h--}return $.map(e,function(e){return{text:n(e),coordinate:Math.round(a.valueToCoord(e))}})},TradingView.MiniChartWidgetAbstractScale.prototype.tickMarks=function(){return this._tickMarks},TradingView.MiniChartWidgetAbstractScale.prototype.draw=function(){if(this._options.visible){var e=this._tickMarks,t=this._ctx;if(this._options.drawOverPlotArea||this.clearBack(),!this._options.drawOverPlotArea&&this._options.borderColor&&"transparent"!==this._options.borderColor){switch(t.strokeStyle=this._options.borderColor,t.lineWidth=1,t.beginPath(),this._options.position){case"left":t.moveTo(this.right()-.5,this.top()),t.lineTo(this.right()-.5,this.bottom());break;case"right":t.moveTo(this.left()+.5,this.top()),t.lineTo(this.left()+.5,this.bottom());break;case"top":t.moveTo(this.left(),this.bottom()),t.lineTo(this.right(),this.bottom());break;case"bottom":t.moveTo(this.left(),this.top()),t.lineTo(this.right(),this.top())}t.stroke()}t.fillStyle=this._options.font.color,t.font=this._options.font.size+"px "+this._options.font.family;for(var i=0;i<e.length;i++)t=e[i],this._drawLabel(t.coordinate,t.text)}},TradingView.MiniChartWidgetXScale=function(e,t,i){TradingView.MiniChartWidgetAbstractScale.apply(this,arguments),this._series=[],this.height.setValue(this._options.paddingBottom+this._options.font.size+this._options.paddingTop),this.height.setValue=function(){console.warn("[MiniChartWidgetXScale] updating height forbidden")},this.width.subscribe(this._updateSize.bind(this)),this._GREED_MARGIN=2},inherit(TradingView.MiniChartWidgetXScale,TradingView.MiniChartWidgetAbstractScale),TradingView.MiniChartWidgetXScale.prototype.valueToCoord=function(e){return this._min===this._max?(this.right()-this.left())/2:this.left()+this._pixelsPerValue*(e-this._min)},TradingView.MiniChartWidgetXScale.prototype.onPlotsChanged=function(){this._updateSeries(),this._updateMinMax(),this._updateSize()},TradingView.MiniChartWidgetXScale.prototype._updateSize=function(){this._updatePixelsPerValue(),this._updateTickMarks()},TradingView.MiniChartWidgetXScale.prototype._updateSeries=function(){this._series=this.getWidgetPlots().length?this.getWidgetPlots()[0].x():[]},TradingView.MiniChartWidgetXScale.prototype._updateMinMax=function(){this._min=this._series.length?this._series[0]:null,this._max=this._series.length?this._series[this._series.length-1]:null},TradingView.MiniChartWidgetXScale.prototype._updatePixelsPerValue=function(){this._pixelsPerValue=this.width.value()/(this._max-this._min)},TradingView.MiniChartWidgetXScale.prototype._updateTickMarks=function(){var e=this.width.value(),t=function(e){return this._ctx.measureText(e).width}.bind(this);this._tickMarks=this._options.isTimeScale?this._calculateTimeTickMarks(e,t):this._calculateTickMarks(e,t,"horizontal")},TradingView.MiniChartWidgetXScale.prototype._calculateTimeTickMarks=function(e,t){if(!e||null===this._min||null===this._max||"function"!=typeof t)return[];var i=this._max-this._min,n=i/86400,o=[],r=[],o=this._ctx;for(o.font=this._options.fontSize+"px "+this._options.fontFamily,o.fillStyle=this._options.fontColor,o.textBaseline="bottom",2>n?o=this._timeSplit(e,t,this._trimToHour,this._formatHour):3>n?o=this._timeSplit(e,t,this._trimToHour,this._formatDayHour):6>n?o=this._timeSplit(e,t,this._trimToDay,this._formatDay):6>i/604800?o=this._timeSplit(e,t,this._trimToWeek,this._formatDay):15>i/2592e3?(o=new Date(1e3*this._max).getFullYear()===(new Date).getFullYear()?this._formatMonthOnly:this._formatMonthYear,o=this._timeSplit(e,t,this._trimToMonth,o)):(o=i/31104e3,o=6>o?this._timeSplit(e,t,this._trimToYear,this._formatYear):30>o?this._timeSplit(e,t,this._trimTo5Years,this._formatYear):50>o?this._timeSplit(e,t,this._trimTo10Years,this._formatYear):this._timeSplit(e,t,this._trimTo25Years,this._formatYear)),i=0,n=o.length;n>i;i++){var s=this.valueToCoord(this._series[o[i].index]);r.push({text:""+o[i].text,coordinate:s})}return r},TradingView.MiniChartWidgetXScale.prototype._timeSplit=function(e,t,i,n){for(var o=[],r=null,s=e/20,a=0,l=this._series.length;l>a;a++){var d=i.call(this,new Date(1e3*this._series[a])),h=n.call(this,d);if(null===r)r=d;else{var c=this.valueToCoord(this._series[a]),p=c>0&&e>c;if(o.length&&p)var p=this.valueToCoord(this._series[o[o.length-1].index]),u=t(o[o.length-1].text),p=c>=p+u+s;p&&r.valueOf()!==d.valueOf()&&(o.push({index:a,text:h}),r=d)}}return o},TradingView.MiniChartWidgetXScale.prototype._trimToHour=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours())},TradingView.MiniChartWidgetXScale.prototype._trimToDay=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},TradingView.MiniChartWidgetXScale.prototype._trimToMonth=function(e){return new Date(e.getFullYear(),e.getMonth(),1)},TradingView.MiniChartWidgetXScale.prototype._trimToYear=function(e){return new Date(e.getFullYear(),1,1)},TradingView.MiniChartWidgetXScale.prototype._trimToWeek=function(e){return e=this._trimToDay(e),new Date(e.valueOf()-864e5*e.getDay())},TradingView.MiniChartWidgetXScale.prototype._trimTo5Years=function(e){return e=e.getFullYear(),new Date(e-e%5,1,1)},TradingView.MiniChartWidgetXScale.prototype._trimTo10Years=function(e){return e=e.getFullYear(),new Date(e-e%10,1,1)},TradingView.MiniChartWidgetXScale.prototype._trimTo25Years=function(e){return e=e.getFullYear(),new Date(e-e%25,1,1)},TradingView.MiniChartWidgetXScale.prototype._monthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),TradingView.MiniChartWidgetXScale.prototype._formatHour=function(e){return e=e.getHours().toString(),1===e.length&&(e="0"+e),e+":00"},TradingView.MiniChartWidgetXScale.prototype._formatDayHour=function(e){return this._formatDay(e)+" "+this._formatHour(e)},TradingView.MiniChartWidgetXScale.prototype._formatDay=function(e){return this._monthNames[e.getMonth()]+","+e.getDate()},TradingView.MiniChartWidgetXScale.prototype._formatMonthOnly=function(e){return this._monthNames[e.getMonth()]},TradingView.MiniChartWidgetXScale.prototype._formatMonthYear=function(e){return this._monthNames[e.getMonth()]+", "+e.getFullYear()},TradingView.MiniChartWidgetXScale.prototype._formatYear=function(e){return e.getFullYear()},TradingView.MiniChartWidgetXScale.prototype._drawLabel=function(e,t){var i=this._ctx,n=i.measureText(t).width,n=this._options.drawOverPlotArea?e+this._GREED_MARGIN:e-n/2,n=Math.min(this.right(),n),n=Math.max(this.left(),n),o="bottom"===this._options.position?this.bottom()-this._options.paddingBottom:this.top()+this._options.paddingTop+this._options.font.size;i.textBaseline="bottom",i._fillText(t,n,o),this._options.drawTickMarkLine&&this._options.borderColor&&"transparent"!==this._options.borderColor&&(i.strokeStyle=this._options.borderColor,i.beginPath(),"bottom"===this._options.position?(i.moveTo(e,this.top()),i.lineTo(e,this.top()+2)):(i.moveTo(e,this.bottom()),i.lineTo(e,this.bottom()-2)),i.stroke())},TradingView.MiniChartWidgetYScale=function(e,t,i){TradingView.MiniChartWidgetAbstractScale.apply(this,arguments),this._max=this._min=null,this.height.subscribe(this._updateSize.bind(this)),this._GREED_MARGIN=1},inherit(TradingView.MiniChartWidgetYScale,TradingView.MiniChartWidgetAbstractScale),TradingView.MiniChartWidgetYScale.prototype.onPlotsChanged=function(){this._updateMinMax(),this._updateSize()},TradingView.MiniChartWidgetYScale.prototype._updateMinMax=function(){for(var e,t,i=this.getWidgetPlots(),n=null,o=null,r=0;r<i.length;r++)e=MathEx.min(i[r].y(this._options.isPercentage)),t=MathEx.max(i[r].y(this._options.isPercentage)),(null===n||n>e)&&(n=e),(null===o||t>o)&&(o=t);this._min=n,this._max=o},TradingView.MiniChartWidgetYScale.prototype._updatePixelsPerValue=function(){this._pixelsPerValue=(this.height.value()-2*this._margin())/(this._max-this._min)},TradingView.MiniChartWidgetYScale.prototype._updateTickMarks=function(){var e=this.height.value(),t=function(){return this._options.font.size}.bind(this);this._tickMarks=this._calculateTickMarks(e,t,"vertical")},TradingView.MiniChartWidgetYScale.prototype._updateSize=function(){this._updatePixelsPerValue(),this._updateTickMarks(),this.width.setValue(this._options.paddingLeft+this._maxLabelWidth()+this._options.paddingRight)},TradingView.MiniChartWidgetYScale.prototype._maxLabelWidth=function(){for(var e=0,t=0;t<this._tickMarks.length;t++)e=Math.max(e,this._ctx.measureText(this._tickMarks[t].text).width);return e},TradingView.MiniChartWidgetYScale.prototype._margin=function(){return this.height.value()*this._options.marginInPercents/100},TradingView.MiniChartWidgetYScale.prototype.valueToCoord=function(e){return this._min===this._max?(this.bottom()-this.top())/2:this.height.value()-this._margin()-this._pixelsPerValue*(e-this._min)},TradingView.MiniChartWidgetYScale.prototype._drawLabel=function(e,t){var i=this._ctx,n=this._options.drawOverPlotArea?e-this._GREED_MARGIN:e+this._options.font.size/2,o="left"===this._options.position?this.left()+this._options.paddingLeft:this.right()-this._options.paddingRight-this._maxLabelWidth();i.textBaseline="bottom",i._fillText(t,o,n),this._options.drawTickMarkLine&&(this._options.borderColor&&"transparent"!==this._options.borderColor&&(i.strokeStyle=this._options.borderColor),i.beginPath(),"left"===this._options.position?(i.moveTo(this.right(),e),i.lineTo(this.right()-2,e)):(i.moveTo(this.left(),e),i.lineTo(this.left()+2,e)),i.stroke())},RenameChartDialog.prototype.show=function(e){var t=$.Deferred(),i=A83.createDialog(this.title),n=function(){var e=i.find('input[name="name"]'),n=e.val();return n?(t.resolve(n),A83.destroy(this.title)):(A83.showError($.t("Please enter chart layout name"),A83.get(this.title)),e.focus()),!1}.bind(this);return i.css("width","400px"),i.find(".tv-dialog-content").html('<div class="main"><form><p>'+this.label+':</p><p class="tv-dialogs-name"><input type="text" name="name" maxlength="'+this.maxlength+'"/></p><p class="tv-dialog-right"></p></form></div>'),i.find("form").submit(n),$('<a class="tv-button wide ok">'+$.t("OK")+"</a>").click(n).css({"margin-right":"5px"}).appendTo(i.find(".tv-dialog-right")),$('<a class="tv-button wide cancel">'+$.t("Cancel")+"</a>").click(function(){A83.destroy(this.title)}.bind(this)).appendTo(i.find(".tv-dialog-right")),A83.positionDialog(i,{left:$(window).width()/2-i.width()/2,top:$(window).height()/2-i.height()/2}),A83.applyHandlers(i),i.find('input[name="name"]').val(e).focus().select(),t},LoadChartDialog.onChartLoaded=function(){this.itemsData&&0<this.itemsData.length&&this._refreshChartsList()},LoadChartDialog.QuickSearch=function(e,t,i){this.fieldsExtractor=t,this.callback=i,this.regExps=[],e.subscribe(this,this.onInput)},LoadChartDialog.QuickSearch.prototype.onInput=function(e){this.query=e,this.createRegexps(e),this.search()},LoadChartDialog.QuickSearch.prototype.createRegexps=function(e){this.regExps=[],this.regExps.push(new RegExp("("+e.split("").map(function(e){return RegExpEscape(e)}).join(")(.*?)(")+")","i"))},LoadChartDialog.QuickSearch.prototype.match=function(e){for(var t=0;t<this.regExps.length;t++){var i=this.regExps[t];i.lastIndex=0;for(var n=this.fieldsExtractor(e),o=0;o<n.length;o++)if(i.test(n[o]))return!0}return!1},LoadChartDialog.QuickSearch.prototype.search=function(){for(var e=[],t=0;t<this.items.length;t++){var i=this.items[t];this.match(i)&&e.push(i)}this.callback(e,this.regExps)},LoadChartDialog.QuickSearch.prototype.setItems=function(e){this.items=e},LoadChartDialog.SortObject=function(e,t){this.isAscending=!1,this.sortingFunc=e,this.getPredicate=function(){return function(e,t){var i=this.sortingFunc(e,t);return this.isAscending&&(i*=-1),
i}.bind(this)},this.inverse=function(){this.isAscending=!this.isAscending},this.setIsAscending=function(e){return"boolean"==typeof e&&(this.isAscending=e),this.isAscending},this.reset=function(){this.isAscending=!1}},LoadChartDialog.prototype.fieldsExtractor=function(e){var t=LoadChartDialog.symbolWrap(e);return[e.title,t]},LoadChartDialog.prototype.saveFavorite=function(e,t){t?this.favorites[e]=t:delete this.favorites[e]},LoadChartDialog.prototype.filterFavorites=function(){var e={};this.itemsData.map(function(t){this.favorites.hasOwnProperty(t.id)&&(e[t.id]=!0)}.bind(this)),this.favorites=e},LoadChartDialog.prototype.getFavorite=function(e){return this.favorites.hasOwnProperty(e)},LoadChartDialog.prototype._appendListItem=function(e){var t=$('<div class="item">').appendTo(this.itemsList);e.active()&&t.addClass("active");var i=moment.unix(e.modified),n=$('<div class="value name first">').appendTo(t);if(W77.enabled("items_favoriting")){var o=$('<div class="icon-favorite">').appendTo(n).click(function(t){this.saveFavorite(e.id,!this.getFavorite(e.id)),this.filterFavorites(),this.fillList(),e.favoriteAction(this.favorites),t.stopPropagation()}.bind(this));this.getFavorite(e.id)&&o.addClass("active")}$('<span class="text">').text(e.title).appendTo(n),n=$('<div class="actions">').appendTo(t),$('<div class="icon-delete">').appendTo(n).click(function(t){var i=this,n=$.Deferred();e.deleteAction(n),n.then(function(){i.removeItem(e)}),t.stopPropagation()}.bind(this)),$('<div class="value modified">').text(i.format("L LT")).appendTo(t),i=""===e.symbol?"multiple charts":e.symbol+", "+e.interval,$('<div class="value symbol last">').text(i).appendTo(t),t.click(function(t){!0!==this.itemsList.executing&&(this.itemsList.executing=!0,e.openAction(),setTimeout(function(){this.itemsList.executing=!1}.bind(this),1e3))}.bind(this))},LoadChartDialog.prototype.removeItem=function(e){e=this.itemsData.indexOf(e),e>-1&&this.itemsData.splice(e,1),this.setChartsData(this.itemsData)},LoadChartDialog.prototype.modifiedCompare=function(e,t){var i=e.modified;return moment(t.modified).diff(moment(i))},LoadChartDialog.prototype.nameCompare=function(e,t){return e.title.localeCompare(t.title)},LoadChartDialog.symbolWrap=function(e){return""===e.symbol?"multiple charts":e.symbol+" "+e.interval},LoadChartDialog.prototype.symbolCompare=function(e,t){return LoadChartDialog.symbolWrap(e).localeCompare(LoadChartDialog.symbolWrap(t))},LoadChartDialog.prototype.toolsCompare=function(e,t){var i=e.toolsCount,n=t.toolsCount;return n>i?-1:i==n?0:1},LoadChartDialog.prototype.sortClick=function(e){this.setSort($(e.target).data("sort"),!0),this.fillList()},LoadChartDialog.prototype.setSort=function(e,t){var i,n=TVSettings.getValue("loadChartDialog.sort.field")||"modified",o=TVSettings.getValue("loadChartDialog.sort.asc")||"0",r=e||n,s=t?"0"==o?"1":"0":o;(!this.currentSortObj||(i=r!=n))&&(this.currentSortObj="name"==r?this.nameSort:"symbol"==r?this.symbolSort:"tools"==r?this.toolsSort:this.sortObj,i&&TVSettings.setValue("loadChartDialog.sort.field",r)),this.currentSortObj.setIsAscending("1"==s),s!=o&&TVSettings.setValue("loadChartDialog.sort.asc",s),$.each(this.header.children(".item"),function(){$(this).data("sort"),$(this)[$(this).data("sort")==r?"addClass":"removeClass"]("active")})},LoadChartDialog.prototype.sortList=function(){var e=[],t=[];if(this.matchedItems.map(function(i){this.favorites.hasOwnProperty(i.id)?e.push(i):t.push(i)}.bind(this)),void 0!==this.currentSortObj){var i=this.currentSortObj.getPredicate();t.sort(i),e.sort(i)}this.matchedItems=e.concat(t)},LoadChartDialog.prototype.fillList=function(){var e=this;this.sortList(),this.itemsList.children(".item").remove(),$.each(this.matchedItems,function(){e._appendListItem(this)}),this.highlightOccurrences(this.qs.regExps)},LoadChartDialog.prototype.searchResult=function(e,t){this.matchedItems=e,this.fillList()},LoadChartDialog.prototype.updateChartsData=function(e){this.setChartsData(e)},LoadChartDialog.prototype.updateFavoritesData=function(e){this.favorites=e,this.itemsList&&this.inputDelegate.fire(this.input.val())},LoadChartDialog.prototype._refreshChartsList=function(){this.qs.setItems(this.itemsData),this.inputDelegate.fire(this.input.val())},LoadChartDialog.prototype.setChartsData=function(e){this.itemsList&&(this.itemsData=e,this.qs.setItems(e),this.inputDelegate.fire(this.input.val()))},LoadChartDialog.prototype.layoutHeader=function(){var e=$('<div class="list-header">').appendTo(this.content);return $('<div class="item name first">').text($.t("Chart Layout Name")).data("sort","name").appendTo(e),$('<div class="item modified">').text($.t("Last Modified")).data("sort","modified").appendTo(e),$('<div class="item symbol last">').text($.t("Active Symbol")).data("sort","symbol").appendTo(e),e},LoadChartDialog.prototype.resetSort=function(){this.sortObj.reset(),this.nameSort.reset(),this.symbolSort.reset(),this.toolsSort.reset(),this.currentSortObj=this.sortObj},LoadChartDialog.prototype.resetSearchClick=function(){this.input.val("").trigger("input").focus()},LoadChartDialog.prototype.show=function(e,t){this.options.width="654px",this.options.content='<div class="load-chart">'+(W77.enabled("new_chart_creation_available")?'<a class="button new-chart">'+$.t("NEW CHART LAYOUT")+"</a>":"")+'<div class="chart-search"><input type="text" name="q" value="" autocomplete="off" placeholder="'+$.t("Search")+'"><a class="input-reset"></a><div class="search-icon"></div></div></div>';var i=A83.createDialog(this.title,this.options);A83.positionDialog(i),this.input=i.find(".chart-search input"),this.inputReset=i.find(".chart-search .input-reset"),this.content=$('<div class="list-content"></div>').appendTo(i.find(".load-chart")),this.header=this.layoutHeader(),this.setSort(),this.itemsListContainer=$('<div class="charts-list-container">').appendTo(this.content),this.itemsList=$('<div class="charts-list">').appendTo(this.itemsListContainer),this._scroll=new A59(this.itemsListContainer,this.itemsList,{showBottomShadow:!1}),i.find(".new-chart").click(this.openNewChart),this.header.children(".item").click($.proxy(this,"sortClick")),this.inputReset.click($.proxy(this,"resetSearchClick")),this.input.on("input propertychange",function(){this._scroll.scrollTo(0),this.inputDelegate.fire(this.input.val()),""!==this.input.val()?this.inputReset.show():this.inputReset.hide()}.bind(this));var n;W77.enabled("saveload_requires_authentication")&&!is_authenticated&&(this.content.hide(),n=$('<div class="please-log-in"></div>').appendTo(i.find(".load-chart")),$('<a href="#" class="link">You are not logged in. Please sign in.</a>').appendTo(n).click(function(e){e.preventDefault(),A83.destroy(this.title),A83.showSignInDialog(null,{mode:"signin"})}.bind(this))),this.favorites=t,this.setChartsData(e);var o=this;A83.applyHandlers(i,{doNotCloseOnBgClickIfShadowbox:!0,beforeDestroy:function(){D17.on("chart_loaded",LoadChartDialog.onChartLoaded,o)}});var r=this.itemsListContainer;n&&(r=n),A83.resizeContent(i.height(),r),A83.positionDialog(i)},LoadChartDialog.prototype.openNewChart=function(){window.open("/e/"+(is_authenticated?"new/":""),"_blank")},LoadChartDialog.prototype.highlightOccurrences=function(e){this.itemsList.children(".item").each(function(){var t=$(this).find(".value.name").find("span"),i=t.text(),i=LoadChartDialog.highlightText(i,e);t.html(i),t=$(this).find(".value.symbol"),i=t.text(),i=LoadChartDialog.highlightText(i,e),t.html(i)})},LoadChartDialog.highlightText=function(e,t){if(e=$("<div>").text(e).html(),0===t.length)return e;for(var i=0;i<t.length;i++){var n=t[i];n.lastIndex=0;var o="",r="";if((r=n.exec(e))&&r.length)for(var s=1;s<r.length;s++)o=s%2?o+('<span class="match">$'+s+"</span>"):o+("$"+s);if((r=e.replace(n,o))&&r!==e)return r}},ChangeIntervalDialog.prototype._setInput=function(){this._input=$('<input type="text" class="change-interval-input" autocomplete="off" maxlength="4">'),this._input.on("keypress",this._handleInput.bind(this)).on("input",function(){this._validate(),this._updateCaption()}.bind(this)).on("blur",function(){setTimeout(this._submit.bind(this),0)}.bind(this))},ChangeIntervalDialog.prototype._validate=function(){var e=this._input.val();this._parsed=A69.parseIntervalValue(e),this._valid=!this._parsed.error,(this._supported=!this._parsed.error&&A69.intervalIsSupported(e))&&(!this._parsed.unit||"H"==this._parsed.unit)&&1440<this._parsed.qty*("H"==this._parsed.unit?60:1)&&(this._supported=!1)},ChangeIntervalDialog.prototype._updateCaption=function(){var e;this._valid&&this._supported?(e=this._parsed.qty||1,e=e+" "+$.t(this._parsed.unit?{H:"hour",D:"day",W:"week",M:"month"}[this._parsed.unit]:"minute",{count:e}),this._input.add(this._caption).removeClass("error")):(e=this._parsed.error?"&nbsp;":$.t("Not applicable"),this._input.add(this._caption).addClass("error")),this._caption.html(e)},ChangeIntervalDialog.prototype._handleInput=function(e){13===e.which?this._submit():e.ctrlKey||e.metaKey||!e.charCode||!e.which||32>=e.which||A69.isIntervalChar(String.fromCharCode(e.charCode))||e.preventDefault()},ChangeIntervalDialog.prototype._submit=function(){if(A83.isOpen(this._dialogTitle)){if(this._valid&&this._supported){var e=A69.sanitizeIntervalValue(this._input.val()),t=A45.interval.value();e&&t!=e&&"function"==typeof this._options.callback&&this._options.callback(e)}this._helpTooltipTrigger.trigger("mouseleave"),A83.destroy(this._dialogTitle)}},ChangeIntervalDialog.prototype._setInitialValue=function(e){e=e||this._options.initialValue;var t="",i=!1;e&&","!=e?t=A69.sanitizeIntervalValue(e)||"":(t=e=A45.interval.value(),i=!0),this._input.val(t),i&&this._input.select()},ChangeIntervalDialog.prototype.isValid=function(){return Boolean(this._valid)},ChangeIntervalDialog.prototype.show=function(e){var t=A83.createDialog(this._dialogTitle,{hideCloseCross:!0,addClass:"change-interval-dialog"}),i=t.find(".tv-dialog-content");return t.css("min-width",0),i.css("min-width",0).mousedown(function(e){this._input.is(e.target)||e.preventDefault()}.bind(this)).append(this._input.add(this._caption).add(this._helpTooltipTrigger)),A83.applyHandlers(t),A83.positionDialog(t),this._setInitialValue(e),this._validate(),this._updateCaption(),t},TVXWindowEvents=function(){var e={};return $(window).on("storage",function(t){if(null!==t.originalEvent.newValue){var i=t.originalEvent.key;i.startsWith("tvxwevents.")&&(i=i.substr(11),$.browser.msie&&TVXWindowEvents._emitting?TVXWindowEvents._emitting=!1:e[i]&&e[i].forEach(function(e){e.call(t.originalEvent.newValue,t.originalEvent.newValue)}))}}),{on:function(t,i){e[t]||(e[t]=[]),e[t].push(i)},off:function(t,i){if(e[t]){var n=e[t].indexOf(i);-1!==n&&(1===e[t].length?delete e[t]:e[t].splice(n,1))}},current:function(e){return localStorage.getItem("tvxwevents."+e)},emit:function(e,t){void 0===t&&(t=+new Date),t!=localStorage.getItem("tvxwevents."+e)&&($.browser.msie&&(TVXWindowEvents._emitting=!0),localStorage.setItem("tvxwevents."+e,t))}}}(),function(e){var t=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"]];e.clean=function(e,i,n){var o=e;if(!e||!e.replace)return o;for(e=0;e<t.length;e++){var r=t[e][0],s=t[e][1];n&&n.indexOf&&-1!==n.indexOf(i?s:r)||(o=i?o.replace(new RegExp(s,"g"),r):o.replace(new RegExp(r,"g"),s))}return o},e.cleanButAmpersand=function(t,i){return e.clean(t,i,i?["&amp;"]:["&"])}}(this),"undefined"!=typeof module&&module&&module.exports&&(module.exports={clean:clean,cleanButAmpersand:cleanButAmpersand}),$(document).ajaxSend(function(e,t,i){"POST"==i.type&&(t.setRequestHeader("X-CSRFToken",$.cookie("csrftoken")),t.setRequestHeader("sessionid",$.cookie("sessionid")))}),String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,i){return"undefined"!=typeof e[i]?e[i]:t})}),"string"==typeof $.cookie("csrftoken")&&""!=$.cookie("csrftoken")?$("#update-status-li").append('<a href="#" onclick="TradingView.showChangeUserStatusDialog(); return false;">Update Status</a>'):$("#update-status-li").empty(),$(document).ready(function(){$(".tv-select").selectbox({speed:100,classHolder:"tv-select-container"}),Modernizr.canvas&&Modernizr.canvastext||"undefined"!=typeof FlashCanvas||A83.showNotice("Oops, your browser can't display our charts!",{html:'It appears that your browser does not support <strong>Canvas</strong> technology, which is needed for TradingView to work.<br/>Please use one of the following browsers:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome</a></li><li><a href="http://www.mozilla.com" target="_blank">Firefox</a></li><li><a href="http://www.apple.com/safari/" target="_blank">Safari</a></li><li><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home" target="_blank">Internet Explorer 9+</a></li></ul>',classSuffix:"slim",doNotCloseOnBgClick:!0}),!W77.enabled("websocket_connection")||"WebSocket"in window||swfobject.hasFlashPlayerVersion("9.0.0")||A83.showNotice("TradingView Notice",{html:'It appears that your browser does not support <strong>WebSocket</strong> technology and does not have <strong>Adobe Flash</strong> plugin installed, one of which is essential for our portal.<br/>Please, <a href="http://get.adobe.com/flashplayer/" target="_blank">install Flash plugin</a> or consider updating to one of these modern browsers with WebSocket support:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome</a></li><li><a href="http://www.apple.com/safari/" target="_blank">Safari</a></li></ul>',classSuffix:"slim",doNotCloseOnBgClick:!0})});var loginStateChange=new Delegate;loginStateChange.subscribe(this,onLoginStateChange),TVXWindowEvents.on("loginStateChange",function(){var e=JSON.parse(this);user=e.user,is_authenticated=!!e.is_authenticated,loginStateChange.fire()}),TradingView.trackEvent=function(e,t,i){window._UNIT_TESTS||"undefined"==typeof _gaq||(e=["_trackEvent",e,t],"undefined"!=typeof i&&e.push(i),_gaq.push(e))};var assert=function(e,t){if(!e)throw Error("Assertion failed"+(t?": "+t:""))};bindProfileTabsFilter=bindIdeasStreamFilter,A18=function(e,t){function i(e,t){var i={};(e||n.options&&n.options.defaultSymbol)&&(i.symbol=String(e||n.options.defaultSymbol).toUpperCase()),t&&(i.interval=t);var o="/e/";Object.keys(i).length&&(o+="?"+$.param(i)),location.href=o}this.$element=e,this.$field=this.$element.find("input"),this.$button=this.$element.find("span"),this.options=t,this.$button.on("click",function(){if(!this.$field.val()){var e=(n.options||{}).defaultSymbol||(TradingView.D18("open_last_chart")?"":this.$field.data("default-symbol"));e&&this.$field.val(String(e).toUpperCase())}this.symbolSearch.acceptTypeIn()}.bind(this)),this.$element.on("keyup",function(){this.$element.toggleClass("not-empty",!!this.$field.val().length)}.bind(this)),this.symbolSearch=A69.bindToInput(this.$field,$.extend((this.options||{}).symbolSearch,{callback:i,onEmptyApply:i}));var n=this},A18.prototype.updateOptions=function(e){$.extend(this.options,e)},TradingView.SearchChartField=function(e){this.$element=e,this.$field=this.$element.find("input"),this.$button=this.$element.find(".button"),this.symbolSearch=A69.bindToInput(this.$field,{callback:function(e){e&&(e=e.toUpperCase(),location.href="/s/?q="+encodeSpread(e))}}),this.$field.placeholder(),this.$field.on("focus",function(){this.$element.addClass("active")}.bind(this)).on("blur",function(){this.$element.removeClass("active")}.bind(this)).on("keyup",function(){this.$element.toggleClass("not-empty",!!this.$field.val().length)}.bind(this)),this.$button.on("click",function(){this.symbolSearch.acceptTypeIn()}.bind(this))},TradingView.applyReadMoreToChart=function(e){var t=e.find(".desc");t.html(t.html().replace(/<br>/g," ")).ellipsis(111,!1,function(t){t=e.find(".chart-read-more-container"),t.css("display","block"),t.is(t.parent().children(":visible").last())&&e.css("padding-bottom","0px")})},$.fn.TVTicker=function(e){function t(e){e=Math.abs(e);var t=1;return!isInteger(e)&&e>1&&(e=parseFloat(e.toString().replace(/^.+\./,"0."))),e>0&&1>e&&(t=Math.pow(10,e.toString().length-2)),t}var i=$('<div class="tv-ticker">').appendTo(this.parent());$('<div class="icon up">').appendTo(i),$('<div class="icon down">').appendTo(i),e=e||{};var n=+e.step||1,o=e.min,r=e.max,s=t(n);return this.each(function(){function e(e){l.trigger("tvticker-beforechange");var i=isInteger(n)?parseInt(l.val(),10):parseFloat(l.val());isNaN(i)&&(i=0);var o=t(i),o=Math.max(s,o);l.val(e(i,o)),l.change()}function i(){e(function(e,t){var i=(Math.round(e*t)+Math.round(n*t))/t;return void 0!==r&&null!==r&&i>r&&(i=e),i})}function a(){e(function(e,t){var i=(Math.round(e*t)-Math.round(n*t))/t;return void 0!==o&&null!==o&&o>i&&(i=e),i})}var l=$(this);l.next().find(".up, .down").on("mousedown",function(e){e.preventDefault(),l.focus()}),l.next().find(".up").click(function(){l.is(":disabled")||i()}),l.next().find(".down").click(function(){l.is(":disabled")||a()}),l.keydown(function(e){l.is(":disabled")||(38==e.keyCode?l.next().find(".up").addClass("active"):40==e.keyCode&&l.next().find(".down").addClass("active"))}),l.keyup(function(e){l.is(":disabled")||(38==e.keyCode?(i(),l.next().find(".up").removeClass("active")):40==e.keyCode&&(a(),l.next().find(".down").removeClass("active")))}),l.mousewheel(function(e,t){t>0?l.next().find(".up").click():l.next().find(".down").click()})}),this},$.fn.ellipsis=function(){return this.each(function(e,t,i){var n=$(this),o=n.text(),r=o,s=$(this.cloneNode(!0)).hide().css({position:"absolute",overflow:"visible",height:"auto",width:n.width()});e=e||n.height(),n.after(s);for(var a,l=s.height()-e,d=0;l>0;)if(r=r.substr(0,r.length-l/2),s.text(r+"…"),l=s.height()-e,a=!0,500<d++){console.warn("Error: too long text");break}n.html(s.text()),a&&"function"==typeof i&&i(n),t&&o!=s.text()&&n.attr("title",o),s.remove()},arguments)},function(e){var t=e('<div class="blue-tooltip-icon icon" />'),i=e('<div class="blue-tooltip-text" />'),n=e('<div class="blue-tooltip blue-tooltip-hidden" />').append(t).append(i);e.fn.blueTooltip=function(o,r,s){return n.parent().length||n.appendTo(document.body),this.each(function(){var a=e(this);a.data("tooltip",o),a.off("mouseenter.tooltip").on("mouseenter.tooltip",function(){if(!Modernizr.touch){s=s||"",i.html(a.data("tooltip")),n.attr("class","blue-tooltip"),n.addClass("blue-tooltip-"+r).addClass(s);var o=(a.outerWidth()-n.outerWidth())/2,l=0,d=o+a.offset().left+n.outerWidth(),h=o+a.offset().left,c=e(window).width()-5;5>h?l=5-h:d>c&&(l=c-d),o=a.offset().left+o+l,d=0,h="","top"===r?(d=a.offset().top-n.outerHeight()-10,h="-=10"):"bottom"==r&&(d=a.offset().top+a.outerHeight()+10,h="+=10"),n.css({left:o,top:d,opacity:0}),t.css({left:Math.round(n.width()/2)-l}),n.stop().animate({top:h,opacity:1},200)}}).off("mouseleave.tooltip").on("mouseleave.tooltip",function(e){n.addClass("blue-tooltip-hidden").removeClass(s)})})}}(jQuery),TradingView.Tooltip=function(){function e(){clearTimeout(o),clearTimeout(r),jQuery.contains(document.body,s[0])&&(s.css("opacity","0"),r=setTimeout(s.detach.bind(s),250))}function t(e){if(e=$(e),0===e.size())return!1;e:{var t=e.data("commonTooltipText"),n=e.attr("title");if(t)n&&(t=n,e.data("commonTooltipText",t),e.removeAttr("title"));else{if(!n){e=void 0;break e}t=n,e.data("commonTooltipText",t),e.removeAttr("title")}n={y:e.offset().top-$(window).scrollTop(),x:e.offset().left-$(window).scrollLeft(),w:e.outerWidth(),h:e.outerHeight()},e={text:t,rect:n,vertical:e.hasClass("common-tooltip-vertical")}}e&&i(e)}function i(e){var t=jQuery.contains(document.body,s[0]);clearTimeout(o),clearTimeout(r),t?(a.text(e.text),n(e),s.css("opacity","1")):o=setTimeout(function(){s.appendTo(document.body),i(e)},500)}function n(e){var t=e.rect;s.attr("class","common-tooltip-wrapper").css({top:"auto",right:"auto",bottom:"auto",left:"auto"}),Modernizr.pointerevents||s.addClass("no-pointer-events"),a.css({top:"auto",right:"auto",bottom:"auto",left:"auto"});var i=$(window).width(),n=$(window).height();((e=e.vertical)&&20>t.w||!e&&20>t.h)&&s.addClass("farther"),e?(s.addClass("vertical").css({left:t.x+t.w,top:t.y-(s.outerHeight()-t.h)/2}),a.offset().left+a.outerWidth()+10>i?s.addClass("otl").css({left:"auto",right:i-t.x}):s.addClass("otr")):(s.css({bottom:n-t.y,left:t.x-(s.outerWidth()-t.w)/2}),10>a.offset().top?s.addClass("below").css({bottom:"auto",top:t.y+t.h}):s.addClass("above"),0>a.offset().left-10?a.css("left",Math.abs(a.offset().left)+10):a.offset().left+a.outerWidth()+10>i&&a.css("left",i-(a.offset().left+a.outerWidth()+10)))}var o,r,s=$("<div />").css("opacity","0"),a=$('<div class="common-tooltip-body" />').appendTo(s);return Modernizr.touch||$(document).on("mouseenter",".apply-common-tooltip",function(i){function n(){o.off("mouseleave mousedown",n),e()}if("buttons"in i){if(1&i.buttons)return}else if(1==i.which)return;var o=$(this);t(o),o.on("mouseleave mousedown",n)}),{show:i,showOnElement:t,hide:e}}(),$(function(){$(document).on("mouseenter",".apply-overflow-title",function(){$(this).attr("title")||this.offsetWidth>=this.scrollWidth||$(this).attr("title",$(this).text())})}),A17=function(e,t){this._options=t||{};var i=this;this.id=e.id;var n=this._lastId();n?this.id<=n||(i=this,this.container=$(Mustache.render(TradingView.templates.globalNotification,e)).prependTo($("body")),i.container.show(),this._options.addClass&&this.container.addClass(this._options.addClass),i.container.css("top",0),this._options.notShiftBody||$("body").addClass("padding-animate").css({paddingTop:i.container.outerHeight()}),this.container.find(".global-notification-close").on("click",function(){i.close()}),$.browser.msie)||TVXWindowEvents.on(this.KEY+"-close",this._onCloseInAnotherTab.bind(this)):this._setLastId(this.id)},A17.prototype.KEY="globalNotification",A17.prototype._lastId=function(){var e=TVSettings.getInt(this.KEY,0,!0),t=TVSettings.getInt(this.KEY,0),i=Math.max(t,e);return e!=t&&TVSettings.setValue(this.KEY,i),!i&&$.cookie("notification_id")&&(i=~~$.cookie("notification_id"),TVSettings.setValue(this.KEY,i),$.cookie("notification_id",0,{expires:-1,path:"/"})),i},A17.prototype._setLastId=function(e){TVSettings.setValue(this.KEY,e)},A17.prototype.close=function(e){var t=this;this.container&&(e?(this.container.remove(),this.container=null):(t.container.css("top",-1*this.container.outerHeight()+"px"),setTimeout(function(){t.container.remove(),t.container=null,$(window).resize(),t._options.notShiftBody||$("body").removeClass("padding-animate")},1500),TVXWindowEvents.emit(t.KEY+"-close",JSON.stringify([t.id,+new Date])),this._setLastId(t.id)),this._options.notShiftBody||$("body").css({paddingTop:0}))},A17.prototype._onCloseInAnotherTab=function(e){e=JSON.parse(e),this.id<=e[0]&&this.close(!0)},TradingView.RequestCache=function(e){function t(t){return n||o||(o=!0,$.getJSON(e,function(e){o=!1,n=!0,i=e,"function"==typeof t&&t(e)})),i&&"function"==typeof t&&t(i),i}if(W77.enabled("charting_library"))return t=function(e){return"function"==typeof e&&e([]),e},t.D20=function(){},t;var i,n=!1,o=!1;return t.D20=function(){i=null,n=!1},t},W77.enabled("charting_library")?ChartingLibraryBackend?(TradingView.getStudyTemplatesList=ChartingLibraryBackend.getStudyTemplatesList,TradingView.getStudyTemplatesList.D20=ChartingLibraryBackend.clearStudyTemplatesListCache):(TradingView.getStudyTemplatesList=function(){},TradingView.getStudyTemplatesList.D20=function(){}):(TradingView.getStudyTemplatesList=new TradingView.RequestCache("/study-templates-ext/"),TradingView.getThemesList=new TradingView.RequestCache("/themes/")),function(e){jQuery.fn.putCursorAtEnd=function(){return this.each(function(){if(e(this).focus(),this.setSelectionRange){var t=2*e(this).val().length;this.setSelectionRange(t,t)}else e(this).val(e(this).val());this.scrollTop=999999})}}(jQuery),ShareTwitterSnapshot.getStatus=function(e,t){return TradingView.isCmeWidget?t+" from cmegroup.com via @tradingview $"+e:"$"+e+" chart "+t+" via http://www.tradingview.com"},ShareStocktwitsSnapshot.getStatus=function(e,t){return"$"+e+" chart "+t+" via http://www.tradingview.com"},TradingView.agoDateFormatter=function(e,t,i){i||(i=TradingView.agoDateFormatter.fullFormat);var n=i(new Date-t),o=n.text,n=n.timeout;e.attr("title",t.toLocaleString()).text(o),o=null,n&&(e.attr("data-ago-date-timer")&&clearTimeout(+e.attr("data-ago-date-timer")),o=setTimeout(function(){TradingView.agoDateFormatter(e,t,i)},n)),e.attr("data-ago-date-timer",o)},TradingView.agoDateFormatter.destroy=function(e){$(e).find("*").andSelf().filter("[data-ago-date-timer]").each(function(){clearTimeout(+$(this).attr("data-ago-date-timer"))})},TradingView.agoDateFormatter.nextMinuteThrough=function(e){return 6e4-e%6e4},TradingView.agoDateFormatter.nextHourThrough=function(e){return 36e5-e%36e5},TradingView.agoDateFormatter.nextDayThrough=function(e){return 864e5-e%864e5},TradingView.agoDateFormatter.fullFormat=function(e){var t=Math.floor(e/6e4),i="",n=!1;return 60>t?(i=1>t?"less than a minute":t+" minute"+(t>1?"s":""),n=TradingView.agoDateFormatter.nextMinuteThrough(e)):1440>t?(t=Math.floor(t/60),i=t+" hour"+(t>1?"s":""),n=TradingView.agoDateFormatter.nextHourThrough(e)):43200>t?(t=Math.floor(t/1440),i=t+" day"+(t>1?"s":""),n=TradingView.agoDateFormatter.nextDayThrough(e)):15768e3>t?(t=Math.floor(t/43200),i=t+" month"+(t>1?"s":"")):(t=Math.floor(t/15768e3),i=t+" year"+(t>1?"s":"")),n&&(n+=200),{text:i+" ago",timeout:n}},TradingView.agoDateFormatter.shortFormat=function(e){var t=Math.floor(e/6e4),i="",n=!1;return 60>t?(i=(1>t?0:t)+"m",n=TradingView.agoDateFormatter.nextMinuteThrough(e)):1440>t?(t=Math.floor(t/60),i=t+"h",n=TradingView.agoDateFormatter.nextHourThrough(e)):43200>t?(t=Math.floor(t/1440),i=t+"d",n=TradingView.agoDateFormatter.nextDayThrough(e)):15768e3>t?(t=Math.floor(t/43200),i=t+"mn"):(t=Math.floor(t/15768e3),i=t+"y"),n&&(n+=200),{text:i,timeout:n}},TradingView.Common={publishChartWidget:function(e){runOrSignIn(function(){saver.publishChart(e)})},publishChart:function(e){runOrSignIn(function(){A83.showPublishIntroDialog().done(function(){saver.publishChart(e)})})},createTrendingSymbols:function(){function e(e){function r(e,t){o[t]=e,quoteSessionMultiplexerInstance.simple.subscribe("trending_symbols_retry",[e],function(e){e.symbolname=t,s(e)})}function s(e){i[e.symbolname]||(i[e.symbolname]={}),$.extend(i[e.symbolname],e.values);var t=i[e.symbolname],n=$("#trending-symbols-item-"+TradingView.symbol2id(e.symbolname)+" .change");e=$("#trending-symbols-item-"+TradingView.symbol2id(e.symbolname)+" .last");var o=new PriceFormatter(t.pricescale||100,t.minmov||1,t.fractional,t.minmove2);e.text(o.format(t.last_price||"")),0<t.change_percent?n.removeClass("minus").addClass("plus").text("+"+t.change_percent+"%"):0>t.change_percent?n.removeClass("plus").addClass("minus").text(t.change_percent+"%"):0==t.change_percent&&n.removeClass("plus minus").text(t.change_percent+"%")}var a=n.splice(0,n.length);e.forEach(function(e){var i=$("#trending-symbols-item-"+TradingView.symbol2id(e.name));i.length?(i.attr("title",e.sessions+" watching "+e.short_name),i.find(".sessions-count").text(e.sessions)):i=$('<a class="trending-symbols-item clearfix" id="trending-symbols-item-'+TradingView.symbol2id(e.name)+'" title="'+e.sessions+" watching "+e.short_name+'" href="/chart/'+e.short_name+"/"+(e.full_name_required?"?exg="+e.exchange:"")+'" target="_blank"><div class="sessions"><span class="sessions-count">'+e.sessions+'</span> <span class="icon icon-people-watching"></span></div><div class="symbol">'+e.short_name+'</div><div class="last"></div><div class="change"></div></a>').data("symbol",e.name),i.appendTo(t),n.push(e.name)}),t.find(".trending-symbols-item").each(function(){-1==n.indexOf($(this).data("symbol"))&&$(this).remove()}),e=[];for(var l=0;l<n.length;l++){var d=n[l],h=a.indexOf(d);-1===h?e.push(d):a.splice(h,1)}for(l=0;l<a.length;l++)d=a[l],quoteSessionMultiplexerInstance.simple.unsubscribe("trending_symbols",d),o[d]&&(quoteSessionMultiplexerInstance.simple.unsubscribe("trending_symbols_retry",o[d]),delete o[d]);e.length&&quoteSessionMultiplexerInstance.simple.subscribe("trending_symbols",e,function(e){"permission_denied"==e.status?r(e.values.alternative,e.symbolname):s(e)}),a=e=null}var t=$(".trending-symbols-table"),i={},n=[],o={};e(initialData.trendingSymbols),setInterval(function(){$.getJSON("/index/popular/",function(t){e(t)})},3e4)}},TradingView.symbol2id=function(e){return e.replace(/[^a-z0-9]/gi,"_")},TradingView.tokenInitialized=$.Deferred(),TradingView.tokenExpiration=6e5,TradingView.registerAuthToken=function(e){var t=this.tokenInitialized,i=new Date(1e3*user.auth_token_timestamp),n=new Date;loginStateChange.subscribe(TradingView,function(o){o&&user?user.auth_token&&(n-i<this.tokenExpiration?(e.setAuthToken(user.auth_token),t.resolve()):this.requestAndSetAuthToken(e).done(function(){t.resolve(),console.info("Token expired and recreated.")})):this.isProRealtime()&&this.requestAndSetAuthToken(e).done(function(){t.resolve()})}.bind(this)),setTimeout(t.resolve.bind(t),5e3)},TradingView.requestAndSetAuthToken=function(e,t){var i=$.Deferred();return this.requestAuthToken().done(function(n){e.setAuthToken(n,t),i.resolve()}),i},TradingView.requestAuthToken=function(){function e(){t=$.post("/quote_token/",null,"json").done(function(e){i.resolve(e)}).fail(function(){if(!i.isRejected()&&!i.isResolved()){var t=Math.min(1e3*n,3e4);n++,setTimeout(e,t)}})}var t,i=$.Deferred(),n=0;return e(),i.always(function(){t&&t.abort()}),i},TradingView.isPro=function(){return is_authenticated&&user.is_pro},TradingView.isProRealtime=function(){return this.isPro()&&("pro_realtime"==user.pro_plan||"pro_realtime_trial"==user.pro_plan)},TradingView.centerBlock=function(e){var t=$(window),i=e.width(),n=e.height(),o=t.width(),t=t.height();e.css({left:Math.round((o-i)/2)+"px",top:Math.round((t-n)/2)+"px"})},TradingView.visitPaymentPageSwreg=function(e,t){if(!e.product_ids.hasOwnProperty(t))throw new TypeError("Unknown product");runOrSignIn(function(){if(!(t in{pro:1,pro_yearly:1,pro_realtime:1,pro_realtime_yearly:1}&&user.is_pro&&user.pro_plan==t)){var i={s:e.shop_id,q:1,d:0,v:0,bb:1,clr:1,clro:1,a:user.id,fn:user.first_name,sn:user.last_name,em:user.email,p:e.product_ids[t]},n=Object.keys(i).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(i[e])});location.href=e.shop_url.replace(/(\?.*|$)/,"?"+n.join("&"))}},!0)},TradingView.visitPaymentPage=function(e,t,i){t=t||"y",i=i||{};var n="/order/";"bitcoin"==i.paymentMethod&&(n="/coinbase/begin/"),runOrSignIn(function(){$('<form action="'+n+'" method="post"'+(i.newWindow?' target="_blank"':"")+'><input type="hidden" name="product" value="'+e+'"/><input type="hidden" name="billing_cycle" value="'+t+'"/><input type="hidden" name="fixed_billing_cycle" value="'+(i.fixedCycle?"true":"")+'"/><input type="hidden" name="exchanges_only" value="'+(i.exchangesOnly?"true":"")+'"/></form>').appendTo(document.body).submit()},!0)},$("body").on("click","button.follow-user",follow),TradingView.keyboardBinder=function(){function e(e){i.forEach(function(t,n){t.name===e&&i.splice(n,1)})}function t(e){for(var t=0;t<i.length;t++)if(i[t].name===e)return t}var i=[];return $(window).on("keypress",function(e){for(var t=i.length-1;t>=0&&!0!==i[t].func(e);t--);}),{registerListener:function(e,n){var o={name:e,func:n},r=t(o.name);r?i[r]=o:i.push(o)},removeListener:function(t){e(t)},pushBackListener:function(e,n){var o={name:e,func:n},r=t(o.name);r&&i.splice(r,1),i.unshift(o)}}}(),TradingView.inputOnTyping=function(e,t,i){function n(){var e=$(this),n=e.val(),o=t(n);e.removeClass("tv-dialog-text-input-error"),"function"==typeof i&&i(n),n!==o&&e.val(o)}function o(e){return e.ctrlKey||e.metaKey||!e.charCode?!1:(e=e.keyCode||e.which,9==e||13==e||16==e||17==e||18==e||19==e||20==e||27==e||e>=33&&40>=e?!1:!0)}e instanceof $?("function"!=typeof t&&(t=function(e){return e}),e.each(function(e,t){var i=$(t);i.on("keypress",function(e){if(o(e)){var t=function(){n.call(this),$(this).off("keyup",t)}.bind(this);$(this).on("keyup",t);
}}),i.change(n)})):console.warn("'$inputs' should be instance of jQuery")},TradingView.makeInputNumberOnly=function(e,t){t=t||{};var i=t.integerOnly,n=t.positiveOnly;TradingView.inputOnTyping(e,function(e){return e=e.replace(/\,/g,".").replace(/[^0-9\.-]/g,"").replace(/^-/,n?"":"__minus__").replace(/\./,"__point__").replace(/^__point__/,"0__point__").replace(/[\.-]/g,"").replace("__minus__","-").replace("__point__",".").replace(/^0+/,"0"),i&&/\d+/.test(e)&&(e=parseInt(e),isInteger(t.minValue)&&(e=Math.max(t.minValue,e)),isInteger(t.maxValue)&&(e=Math.min(t.maxValue,e))),!i&&/^0\d/.test(e)&&(e=e.toString(),e=e.substring(0,1)+"."+e.substring(1,e.length)),e},t.inputOnTypingCallback)},TradingView.makeInputDateOnly=function(e,t){t=t||{},TradingView.inputOnTyping(e,function(e){return(4==e.length||7==e.length)&&(e+="-"),e=e.substr(0,10)},t.inputOnTypingCallback)},TradingView.makeInputTimeOnly=function(e,t){t=t||{},TradingView.inputOnTyping(e,function(e){return 2==e.length&&(e+=":"),e=e.substr(0,5)},t.inputOnTypingCallback)},TradingView.timezoneIsAvailable=function(e){for(var t=0;t<TradingView.availableTimezones.length;t++)if(e===TradingView.availableTimezones[t].id)return!0;return!1},TradingView.showChangeUserStatusDialog=function(){return runOrSignIn(function(){A83.showChangeUserStatusDialog()}),!1},TradingView.getUrlParams=function(){for(var e,t=/\+/g,i=/([^&=]+)=?([^&]*)/g,n=window.location.search.substring(1),o={};e=i.exec(n);)o[decodeURIComponent(e[1].replace(t," "))]=decodeURIComponent(e[2].replace(t," "));return o},TradingView.createUrlParams=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&null!=e[t]&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i.join("&")},$.fn.filterByData=function(e,t){return this.filter(function(){return $(this).data(e)==t})},window.adPack=function(){function e(e){return("object"!=typeof e||null===e)&&(e=user),"Exante"===e.username}function t(e){e.removeClass("settings").addClass("ad-pack");var t=e.find(".form-section.tv-profile-area").eq(0);$('<div class="left-column">').appendTo(e.html(""));var i=$('<div class="right-column">').appendTo(e);return[{name:"ad-pack-change-messages",title:"Chart Pop-up Messages",action:"/ad_pack/change_messages/",fields:"default index stock futures forex bitcoin".split(" "),parent:e},{name:"ad-pack-pm-message",title:"Private Messages",action:"/ad_pack/pm_message/",fields:["message"],sbmText:"Send PM to All Non-Pro Users",parent:i,skip:!0}].forEach(function(e){if(!e.skip){var i=t.clone();i.find("h3").text(e.title),i.find("form").attr({id:e.name,action:e.action,target:e.name+"-target"}),i.find("iframe").replaceWith($(document.createElement("iframe")).attr({src:e.action,name:e.name+"-target"}).css({position:"absolute",left:-9999,width:10,height:10})),i.find("tr").each(function(){if(row=$(this),!row.hasClass("error-row"))if(row.hasClass("caption")||!e.fields.length)row.remove();else{var t=e.fields.shift(),i=row.find("td");i.eq(0).text(t.charAt(0).toUpperCase()+t.substr(1)),$(document.createElement("textarea")).attr({name:t,maxLength:Math.pow(2,8),rows:10,cols:40}).appendTo(i.eq(1).html(""))}}),e.sbmText&&i.find("input[type=submit]").attr("value",e.sbmText),i.appendTo(e.parent)}}),e}var i,n=customChatMessageActive=chartPopUpActive=profileTabActive=sendMassPMActive=!1;return $(function(){n=TradingView.D18("adPackActive"),customChatMessageActive=TradingView.D18("adPackCustomChatMsgActive"),chartPopUpActive=TradingView.D18("adPackChartPopUpActive"),sendMassPMActive=TradingView.D18("adPackMassPMActive"),profileTabActive=TradingView.D18("adPackProfileTabActive"),n&&$(document.documentElement).addClass("sp-active")}),{isAdvertiser:e,customChatMessage:function(t,i){n&&customChatMessageActive&&e(t)&&i("exante")},chartPopUp:function(e){if(n&&chartPopUpActive&&!user.is_pro){var t=~~localStorage.getItem("chart-ads-popup-counter-Exante"),o=~~localStorage.getItem("chart-ads-popup-disabled-Exante");if(!(t>=3||o)){var r,s;e.model().mainSeries().onSymbolResolved().subscribe(null,function(){i||r||(r=setTimeout(function n(){if(r=null,s){var o=e.model().mainSeries().quoteData;o&&(o=s[o.type]||s["default"],String(o).replace(/^\s+|\s+$/g,"")&&(i=A83.createDialog("adPackExante",{addClass:"popup-exante",content:'<div class="message">'+o.replace(/</g,"&lt;").replace(/>/g,"&gt;")+'</div><div class="actions-block"><a class="no-button">No, thank you</a><a href="https://exante.eu/?utm_source=tradingview" class="yes-button" target="_blank">Read more</a></div>',hideTitle:!0}),i.on("click",".no-button, .yes-button, .tv-dialog-title-close",function(e){e=$(e.target),e.hasClass("no-button")||e.hasClass("tv-dialog-title-close")?(TradingView.trackEvent("AdPack","Exante-Popup-Decline"),localStorage.setItem("chart-ads-popup-counter-Exante",t+1)):e.hasClass("yes-button")&&(TradingView.trackEvent("AdPack","Exante-Popup-Accept"),localStorage.setItem("chart-ads-popup-disabled-Exante",1)),A83.destroy("adPackExante"),i=null}),A83.positionDialog(i),TradingView.trackEvent("AdPack","Exante-Popup-Show")))}else $.ajax("/ad_pack/get_messages/").done(function(e){!e||e.constructor!==Object||e.error?e.error&&window.console&&console.error("AdPack Error: "+e.error):(s=e,n())})},9e5))},!0)}}},setTab:function(i){if(e()&&profileTabActive&&i){var n=i.$decks.filter(".settings"),o=i.$tabs.filter("a[href=#settings]");n&&o&&(n=t(n.clone()).insertAfter(n),o=o.closest(".filter-tabbed"),o=o.clone().insertAfter(o).find(".profile-tab"),o.text("Ad Pack").attr("href","#ad-pack").attr("data-value","ad-pack"),i._tabsList["ad-pack"]={showForNotAuth:!1},i.$tabs=i.$tabs.add(o.get(0)),i.$decks=i.$decks.add(n.get(0)))}}}}(),$.fn.reverse=[].reverse,D17=function(){function e(e){return i.hasOwnProperty(e)||(i[e]=new Delegate),i[e]}var t={},i={};return t.unsubscribe=function(t,i,n){e(t).unsubscribe(n,i)},t.on=function(e,i,n){return t.subscribe(e,i,n)},t.subscribe=function(t,i,n){e(t).subscribe(n,i)},t.emit=function(t,i){e(t).fire(i)},t}();var TVSettings=function(){function e(e,t){var i;return i=u[e],!window.is_authenticated&&null==i&&window.localStorage&&(i=u[e]),null==i?t:i}function t(e,t){return strValue=""+t,u[e]!==strValue&&(u[e]=strValue,o(e)),this}function i(e){return null!=u[e]&&(delete u[e],o(e)),this}function n(){p=void 0,f.length&&r()}function o(e){if(window.is_authenticated)f.push(e),p||(p=setTimeout(n,c));else try{null==u[e]?localStorage.removeItem("tradingview."+e):localStorage.setItem("tradingview."+e,u[e])}catch(t){}TVXWindowEvents.emit("settings",JSON.stringify({key:e,value:u[e]}))}function r(e){if(!TradingView.onWidget()&&window.is_authenticated&&0!==f.length){var t=f;f=[];for(var i={},n=t.length;n--;){var o=t[n],r=u[o];void 0===r&&(r=null),i[o]=r}$.ajax({url:"/savesettings/",type:"POST",data:{delta:JSON.stringify(i)},async:!e})}}function s(){return Object.keys(u)}var a=!1;try{a=!TradingView.onWidget()&&parent&&parent!==window&&!!parent.IS_DEMO_PAGE}catch(l){}if(a){var d={"widgetbar.layout-settings":{widgets:{},settings:{minimized:!0}},notShowMainWizard:!0},a=function(e,t,i){return e=d[e],null===e||void 0===e?t:e},h=function(){};return{loaded:!1,loadedModel:!1,getValue:a,getJSON:a,getBool:a,getFloat:a,getInt:a,setValue:h,setJSON:h,remove:h,restoreDefaults:h,keys:function(){return Object.keys(d)},keysMask:function(){return[]},sync:h}}var c=12e4;"local"===window.environment&&(c=5e3);var p,u={},f=[];return TVXWindowEvents.on("settings",function(e){e=JSON.parse(e),null==e.value?delete u[e.key]:u[e.key]=e.value}),$(window).on("visibilitychange",function(e,t){t||r()}),$(window).on("unload",function(){r(!0)}),{loaded:!1,loadedModel:!1,getValue:e,getJSON:function(t,n){var o=e(t,void 0);if(null==o)return n;try{return JSON.parse(o)}catch(r){return i(t),n}},getBool:function(t,i){var n=e(t);return null==n?i:n&&"false"!==n&&0!==+n?!0:!1},getFloat:function(t,i,n){if(n=e(t,void 0,n),null==n)return i;if(i=parseFloat(n),!isFinite(i))throw new TypeError('"'+n+'" is not float (key: "'+t+'")');return i},getInt:function(t,i,n){if(n=e(t,void 0,n),null==n)return i;if(i=parseInt(n,10),!isFinite(i))throw new TypeError('"'+n+'" is not int (key: "'+t+'")');return i},setValue:t,setJSON:function(e,i){var n=JSON.stringify(i);return t(e,n),this},remove:i,restoreDefaults:function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);"tradingview."===t.substring(0,12)&&(f=[],localStorage.removeItem(t))}$.post("/restoredefaults/",{},function(e){A83.showNotice("Success","Defaults has been successfully restored")}).error(function(e){})},keys:s,keysMask:function(e,t){var i=s(t),n=[];e=new RegExp("^"+RegExpEscape(e).replace(/\\\*\\\*/gi,".+").replace(/\\\*/gi,"[^.]+")+"$","gi");for(var o=i.length-1;o>=0;o--)e.test(i[o])&&n.push(i[o]),e.lastIndex=0;return n},sync:function(e){if(window.is_authenticated){if(e=e||{},u=[],window.localStorage)for(var i=0===Object.keys(e).length,n=localStorage.length;n--;){var o=localStorage.key(n);if("tradingview."===o.substring(0,12)){if(i){var r=o.substring(12);t(r,localStorage.getItem(o))}localStorage.removeItem(o)}}for(n in e)u[n]=e[n]+""}else if(u=[],window.localStorage)for(n=localStorage.length;n--;)e=localStorage.key(n),"tradingview."===e.substring(0,12)&&(i=e.substring(12),u[i]=localStorage.getItem(e))}}}();if(A13=function(){return"www.tradingview.com"==location.host||"dwq4do82y8xi7.cloudfront.net"==location.host||location.host.match(/proxy\d.tradingview.com/)||location.host.match(/prod-[^.]+.tradingview.com/)?"battle":"beta.tradingview.com"==location.host||"beta2.tradingview.com"==location.host?"staging":location.host.match(/webcharts/)?"staging_local":(location.host.match(/^localhost(:\d+)?$/),"local")},A13.isLocal=function(){return"local"==this()},A13.isProd=function(){return"battle"==this()},A13.isDebug=function(){return!this.isProd()},TradingView.LOGLEVEL_NORMAL=1,TradingView.LOGLEVEL_DEBUG=2,A46=[],TradingView.LOGHISTORY_LENGTH=100,TradingView.getLogLevel=function(){return TVSettings.getInt("log_level",TradingView.LOGLEVEL_NORMAL)},TradingView.loggingOn=lon=function(){TVSettings.setValue("log_level",TradingView.LOGLEVEL_DEBUG),TradingView.logNormal("Debug logging enabled")},TradingView.loggingOff=loff=function(){TVSettings.setValue("log_level",TradingView.LOGLEVEL_NORMAL),TradingView.logNormal("Debug logging disabled")},TradingView.log=function(){var e;return setInterval(function(){e=null},1e3),function(t,i){i!=e&&("\n"!=i&&A46.unshift(i),A46.length>TradingView.LOGHISTORY_LENGTH&&A46.pop(),"undefined"!=typeof console&&console.log&&t<=TradingView.getLogLevel()&&(e=i,console.log(i)))}}(),TradingView.logNormal=function(e){TradingView.log(TradingView.LOGLEVEL_NORMAL,e)},TradingView.logDebug=function(e){TradingView.log(TradingView.LOGLEVEL_DEBUG,e)},TradingView.remoteDebug=function(){var e={arguments:JSON.stringify(Array.prototype.slice.call(arguments))};$.ajax("/remote_debug/",{data:e})},TradingView.remoteDebugTouch=function(){Modernizr.touch&&this.remoteDebug.apply(this,arguments)},A13.isProd()&&"undefined"!=typeof console){var noop=function(){};TradingView.remoteDebug=noop}!function(e){function t(t,i){this.container=e(t),this.options=i||{},!this.options.callbacks&&(this.options.callbacks={}),this.column_num=0,this.items=[],this.init();var n=this;window.addEventListener("resize",function(){n.resize()})}t.prototype.fireCallback=function(e,t){"function"==typeof this.options.callbacks[e]&&this.options.callbacks[e](t)},t.prototype.resize=function(){this.columnsCount!=this.calculateColumnsCount()&&(this.options.fixHeightOnRecalculate&&this.container.css({height:this.container.height()}),this.removeColumns(),this.init(!0),this.options.fixHeightOnRecalculate&&this.container.css({height:"auto"}))},t.prototype.getItems=function(){return this.container.find("> "+this.options.itemsSelector).toArray()},t.prototype.addItems=function(e,t){this.items=this.items.concat(e),this.balance(e,t)},t.prototype.balance=function(e,t){switch(this.options.balanceType){case"height":this.balanceHeight(e,t);break;default:this.balanceSimple(e,t)}},t.prototype.balanceHeight=function(t,i){var n=this;this.columns.forEach(function(e){!e.fragment&&(e.fragment=document.createDocumentFragment())}),e.each(t,function(t,o){var r=e(o),s=r.data("cb-height")||r.outerHeight(!0);if(!s)throw"Cant get item height";r.data("cb-height",s);var a=null;if(r.hasClass("two-columns-item")){if(n.columns.sort(TradingView.sortMultipleFunction("index")),2<this.columnsCount)for(var l,a=null,r=this.columns.length-1;r>0;r--){var d=Math.abs(this.columns[r].height-this.columns[r-1].height);(null===a||a>=d)&&(a=d,l=r-1)}else l=0;a=this.columns[l],l=this.columns[l+1],r=s,d=0,a.height>l.height?r+=a.height-l.height:d=l.height-a.height;var h=document.createElement("div");h.style.height=r+"px",h.className="empty-space",l.fragment.appendChild(h),l.height+=r,d&&(h=document.createElement("div"),h.style.height=d+"px",h.className="empty-space",a.fragment.appendChild(h),a.height+=d)}else n.columns.sort(TradingView.sortMultipleFunction("height","index")),a=n.columns[0];!n.options.maxRow||this.row_num<n.options.maxRow?(a.height+=s,a.fragment.appendChild(o)):i&&n.container[0].removeChild(o)}.bind(this))},t.prototype.balanceSimple=function(t,i){var n=this;e.each(t,function(e,t){var o=n.columns[this.column_num];!o.fragment&&(o.fragment=document.createDocumentFragment()),!n.options.maxRow||this.row_num<n.options.maxRow?(o.fragment.appendChild(t),o.count++):i&&n.container[0].removeChild(t),++this.column_num>=n.columnsCount&&(this.row_num++,this.column_num=0)}.bind(this))},t.prototype.init=function(e){this.row_num=this.column_num=0,this.columnsCount=this.calculateColumnsCount(),this.createLayout(this.columnsCount),e?this.balance(this.items,!1):this.addItems(this.getItems(),!0),this.pushFragmentsToColumns()},t.prototype.calculateColumnsCount=function(){var e=this.container.width(),t=this.options;if(!e)throw"Can't get container width.";for(var i=Math.floor(e/t.columnWidth);i>=0&&i*t.columnWidth+(i-1)*t.gap>e;)i--;return i},t.prototype.createLayout=function(t){this.columns=[];for(var i=document.createDocumentFragment(),n=0;t>n;n++){var o=e('<div class="cb-column"></div>');this.columns.push({target:o,count:0,height:0,index:n}),i.appendChild(o[0])}this.container.prepend(i)},t.prototype.pushFragmentsToColumns=function(e){for(var t=this.columns.length,i=0;t>i;i++){var n=this.columns[i];if(e)for(var o=0;o<n.fragment.childNodes.length;o++)n.fragment.childNodes[o].className+=" show-animate animate-init";n.target.append(n.fragment),delete n.fragment}var r=this;e&&setTimeout(function(){r.container.find(".animate-init").removeClass("animate-init")},1)},t.prototype.removeColumns=function(){this.columns.forEach(function(e){e.target.detach()})},t.prototype.rescan=function(){this.addItems(this.getItems(),!0),this.pushFragmentsToColumns()},t.prototype.reset=function(){this.items=[],this.removeColumns(),this.init()},e.fn.columnsBalancer=function(i){if(e(this).length)return new t(e(this),i);var n=[];return e(this).each(function(){n.push(new t(e(this),i))}),n}}(jQuery),A83={modalDialog:null,dialogs:[],messageInterval:null,messageDelay:4e3,NOTIFICATION_ANIMATION_START_OFFSET:"-33px",_constrainDraggableOptionsIfNeeded:function(e){return W77.enabled("constraint_dialogs_movement")&&(e.containment=".chart-page"),e},showIntervalMismatchDialog:function(e){var t;t=!1,A83.createModalDialog("Interval is not applicable");var i=A83.modalDialog;if(i.css({zIndex:1e3}),i.find(".tv-dialog").css("width","400px"),i=A83.modalDialog.find(".tv-dialog-content"),i.html('<div class="main"><div class="caption-big"><p>Only <b>D, W, M</b> intervals are supported for this symbol/exchange. You will be automatically switched to a D interval. Intraday intervals are not available because of exchange policies.</p></div><div class="main-properties"></div></div>'),i=i.find(".main-properties"),i=$('<div class="dialog-buttons"></div>').appendTo(i),e){var n=$('<label class="dialog-trail-checkbox"><input type="checkbox" /> Do not show this message again</label>').appendTo(i).find("input");n.attr("checked",e.silentIntervalChange.value()),n.bind("click",function(){e.silentIntervalChange.setValue(this.checked)})}$('<a class="tv-button ok">OK</a>').appendTo(i).bind("click",function(){A83.destroy()}),A83.positionDialog(),A83.applyHandlers(!1,{doNotCloseOnBgClickIfShadowbox:t})},showSignInDialog:function(e,t){function i(e){var t;switch(e){case"signup":case"signup-trial":t=d.indexOfPage(a);break;case"recover":t=d.indexOfPage(l);break;default:e="signin",t=d.indexOfPage(s)}n.find('[name="signup_trial"]').val("signup-trial"==e?1:0),n.find(".show-if-signin, .show-if-signup, .show-if-recover").not(".show-if-"+e).hide(),n.find(".show-if-"+e).show(),d.setActivePage(t)}if(!is_authenticated){"function"==typeof e?A83.onSigninSuccess=e:delete A83.onSigninSuccess,A83.createModalDialog("Log in",{noHeader:!0,addClass:"auth-dialog"});var n=A83.modalDialog.find(".tv-dialog-content"),o=$('<div class="properties-tabs show-if-signin show-if-signup show-if-signup-trial"></div>').prependTo(n);$('<a href="#" class="properties-tabs-label"></a>').text($.t("Sign In")).appendTo(o),$('<a href="#" class="properties-tabs-label"></a>').text($.t("Sign Up")).appendTo(o),$('<a href="#" class="properties-tabs-label"></a>').appendTo(o);var r=$(document.createElement("div")).appendTo(n),s=$(document.createElement("div")).addClass("page").appendTo(r),a=$(document.createElement("div")).addClass("page").appendTo(r),l=$(document.createElement("div")).addClass("page recover").appendTo(r),d=new A71(o,r);s.html(TradingView.templates.dialogs.signin),a.html(TradingView.templates.dialogs.auth),l.html(TradingView.templates.dialogs.recover),i(t&&t.mode),d.tabChanged.subscribe(null,function(e){d.pageAt(e).find('input:eq(0)[type!="hidden"]').focus()}),n.find(".recover-link").on("click",function(e){i("recover"),e.preventDefault()}),n.find(".signup-link").on("click",function(e){i("signup"),e.preventDefault()}),n.find(".signin-link").on("click",function(e){i("signin"),e.preventDefault()}),n.find(".auth-dialog-field").each(function(){function e(){i.toggleClass("empty",!i.val()),n=!1}var t=$(this).find(".auth-dialog-field-placeholder"),i=$(this).find("input"),n=!1;e(),i.on("blur",function(){t.toggleClass("disabled",!!this.value)}),i.on("keypress keydown keyup input paste",function(){n||(n=!0,setTimeout(function(t){e()},0))})}),"stocktwits google facebook twitter linkedin yahoo".split(" ").forEach(function(e){var i="/accounts/signin/"+e+"/";n.find(".auth-dialog-social-"+e).on("click",function(e){t&&"signup-trial"==t.mode&&$.cookie("will_start_trial",1,{path:"/"}),e.preventDefault(),window.open(i,"_blank")})}),n.find("#signin-form").on("submit",function(e){e.preventDefault();var t=$(this).find('[type="submit"]').addClass("process");A83.submit(function(e){""!==e.error?A83.showError("Error: "+e.error):(A83.destroy(),user=e.user,changeLoginState(!0),"function"==typeof A83.onSigninSuccess&&(A83.onSigninSuccess(),delete A83.onSigninSuccess),"undefined"!=typeof next&&next&&(location.href=next)),t.removeClass("process")},this)}),n.find("#signup-form").on("submit",function(e){var t=this,i=TradingView.getUrlParams().utmsource,n=TradingView.getUrlParams().utmmedium;null!=i&&(i=$("<input>").attr("type","hidden").attr("name","utm_source").val(i),n=$("<input>").attr("type","hidden").attr("name","utm_medium").val(n),$(t).append(i),$(t).append(n)),e.preventDefault();var o=$(t).find('[type="submit"]').addClass("process");A83.submit(function(e){if($(".tv-dialog input").removeClass("error"),$(".tv-dialog-field-error").hide(),""!==e.errors)if("object"==typeof e.errors){for(var i in e.errors)$(t).find("input[name^="+i+"]").addClass("error").data("error",e.errors[i][0]);$(".tv-dialog input.error").first().focus(),A83.showError($(".tv-dialog input.error").first().data("error"))}else A83.showError("Error: "+e.errors);else A83.showNotice("Activate Your Account",e.message);o.removeClass("process")},t)}),n.find("#recover-form").on("submit",function(e){e.preventDefault();var t=A83.modalDialog;A83.submit(function(e){""!==e.error?A83.showError("Failed: "+e.error):(A83.showMessage("New password is sent to your email."),setTimeout(function(){A83.modalDialog===t&&A83.destroy()},A83.messageDelay))},this)}),A83.positionDialog(),A83.applyHandlers(null)}},showPublishIntroDialog:function(e){var t=$.Deferred(),i=TVSettings.getBool("publish.showIntroText",!0);if(e||i){e=A83.createDialog("Please read before publishing");var n=!1;e.css({width:"750px","z-index":130}),e.find(".tv-dialog-content").html(Mustache.render(TradingView.templates.dialogs.publishIntro,{do_not_show:!i})),e.draggable(A83._constrainDraggableOptionsIfNeeded({handle:".tv-dialog-title"})),e.find('input[name="donotshow"]').on("change",function(e){TVSettings.setValue("publish.showIntroText",!$(this).is(":checked"))}),$("#publish-intro-continue").click(function(){A83.destroy("Please read before publishing"),t.resolve()}),e.on("destroy",function(){n=!0,setTimeout(t.resolve,0)}),t.always(function(){n||A83.destroy("Please read before publishing")}),A83.positionDialog(e),A83.applyHandlers(e)}else t.resolve();return t},showPublishChartDialog:function(e){function t(){s.find(".publish-related").tvtags("extractTags");var t={name:s.find('[name="name"]').val(),description:s.find('[name="description"]').val(),direction:s.find('input[name="direction"]').val(),is_public:"1"};e.onWidget||(t.tags=s.find(".publish-tags").tvtags("extractTags").tvtags("tagsWithPending").join(","),t.twitter=s.find('input[name="twitter"]').is(":checked")?"1":"",t.stocktwits=s.find('input[name="stocktwits"]').is(":checked")?"1":"",t.is_public=s.find('input[name="public"]').is(":checked")?"1":"",t.related_charts=s.find(".publish-related").tvtags("extractTags").tvtags("tagsWithPending").join(","),t.chat=s.find('input[name="chat"]').is(":checked")?"1":""),e.publishSource&&(t.publish_source=e.publishSource);var i={onWidget:e.onWidget,publishAllLayout:s.find('[name="publish_entire_layout"]').is(":checked")};t.name.trim()?t.description.trim()?isLatin(t.name)&&isLatin(t.description)?isLatin(t.tags)?e.onPublish&&e.onPublish(t,i):A83.showError("Please use only English in tags"):A83.showError("TradingView is only for English-language content at this time."):(A83.showError("Chart description is required",s),s.find('[name="description"]').focus()):(A83.showError("Chart title is required",s),s.find('[name="name"]').focus())}function i(){s.show();var t=TVSettings.getJSON("publishchart.size",{w:f,h:g});s.height(Math.max(Math.min(t.h,.9*$(window).height()),g)),s.width(Math.max(Math.min(t.w,.9*$(window).width()),f)),h(),A83.positionDialog(s,{considerScroll:!0}),e.onShow&&e.onShow()}function n(){s.hide(),e.onMinimize&&e.onMinimize()}e=e||{};var o="edit"===e.mode,r=o?"Edit Idea":"Publish Idea",s=A83.createDialog(r,{addClass:"publish-dialog",hideCloseCross:!o,hideTitle:!0});s.css("width","700px");var a=s.find(".tv-dialog-content"),l=e.onWidget?TradingView.templates.dialogs.publishChartWidget:TradingView.templates.dialogs.publishChart,d=TradingView.clone(window.user||{});d.editMode=o,a.html(Mustache.render(l,d)),l=s.find(".tv-dialog-title"),$(document.createElement("div")).css({height:"30px","margin-bottom":"-10px",position:"relative"}).appendTo(l),o||$('<a class="tv-dialog-title-minimize"></a>').appendTo(l).on("click",function(e){e.preventDefault(),n()}),s.draggable(A83._constrainDraggableOptionsIfNeeded({handle:l}));var h=function(){var e=a.find(".jsfluid"),t=a.children(".main, *[class^=main-]").eq(0);return function(){e.css("height",s.height()-t.position().top-t.outerHeight()+e.height())}}();s.on("resize",function(e){e.stopPropagation(),e.preventDefault(),h()}),l=e.formData||{},l.name&&s.find('[name="name"]').val(l.name),l.description&&s.find('[name="description"]').val(l.description),l.direction&&s.find('input[name="direction"]').val(l.direction),l.related_charts&&s.find(".publish-related").val(l.related_charts),l.tags&&s.find(".publish-tags").val(l.tags),$("#publish-chart-form").submit(function(e){e.preventDefault(),t()}),$("#publish-dialog-do-publish").click(function(e){e.preventDefault(),t()}),s.find('input[name="public"]').on("change",function(e){$(this).is(":checked")||(c.prop("checked",!1).change(),p.prop("checked",!1).change())});var c=s.find('input[name="twitter"]'),p=s.find('input[name="stocktwits"]');c.change(function(){c.is(":checked")&&(user.has_twitter||window.open("/accounts/permission/twitter/","twitter_permission_request","scrollbars=yes,height=400,width=700").focus())}),p.change(function(){p.is(":checked")&&authInStocktwits()}),a.find(".publish-direction-buttons .tv-button").on("mousedown",function(){var e=$(this);$(".publish-direction-buttons .tv-button").removeClass("active"),e.addClass("active"),s.find('input[name="direction"]').val(e.data("val"))}).each(function(){$(this).toggleClass("active",+$(this).data("val")===(+s.find('input[name="direction"]').val()||0))}),s.find(".tv-dialog-readbefore a").on("click",function(e){e.preventDefault(),A83.showPublishIntroDialog(!0)}),e.isPrivate&&s.find('input[name="public"]').prop("checked",!1).change(),function(){function t(e){return e=new Date(e),[e.getFullYear(),("0"+e.getMonth()).substr(-2),("0"+e.getDate()).substr(-2)].join("-")}function i(e){return(/([0-9A-Za-z-]+)\/?$/.exec(e)||0)[1]}var n={},o=s.find(".publish-related");e.related&&o.val([].concat(e.related).join(",")),o.tvtags("init",{suggest:function(e,t){var o=location.protocol+"//"+location.host+"/v/";e.substr(0,o.length)===o&&(e=i(e)||e),$.ajax("/ideas-json/",{data:{search:e},dataType:"json"}).done(function(e){e=e||[],e.forEach(function(e){n[e.image_url]=e,e.str=o+e.image_url+"/"}),t(e)}).error(function(){t(null)})},formatSuggest:function(e){var i=$(document.createElement("span")).addClass("date").text(t(1e3*e.created)+" "),n=$(document.createElement("strong")).text(e.name);return e=$(document.createTextNode(" "+[e.short_name||e.pro_symbol,e.resolution].join(", "))),{content:$().add(i).add(n).add(e)}},validate:function(e,t){var o=i(e);o?n[o]?t(!0):$.ajax("/ideas-json/"+o+"/",{dataType:"json"}).done(function(e){e&&e.length?(n[e[0].image_url]=e[0],t(!0)):t(!1)}).error(function(){t(!1)}):t(!1)},transform:i,format:function(e){e=e.str;var t=n[e];return t&&e?t.name:"Idea"},keys:["\n",",",/\s/,";"],separator:","}).on("change",h)}(),s.find(".publish-tags").tvtags("init",{keys:["\n",",",/\s/,";"],separator:",",addClass:"no-arrow with-ears",format:function(e){return{str:e.str,addClass:"tag"}},transform:function(e){return e.toLowerCase()},suggest:function(e,t){e||t(null),$.ajax("/tags-json/",{data:{search:e.toLowerCase()},dataType:"json"}).done(function(e){t(e)}).error(function(){t(null)})},maxLength:64,caseInsensitive:!0}).on("change",h);var u=[];e.D6&&function(){function t(){var e=r.value().model();return e?(e=e.mainSeries(),(e.properties().shortName.value()||e.symbol())+" ("+e.interval()+")"):"Active Chart"}function i(){n.toggleClass("hidden",!("s"!==o.value()&&!l.value())),c.is(":checked")?(p.text("All Charts"),h.attr({"class":"tv-dialog-layout-button tv-dialog-layout-"+o.value()})):(p.text(t()),h.attr({"class":"tv-dialog-layout-button tv-dialog-layout-s"}))}var n=a.find(".tv-dialog-layoutpicker"),o=e.D6.layout.spawn(),r=e.D6.activeChartWidget.spawn(),l=e.D6.maximizeCurrentChart.spawn(),d=A45.symbol.spawn();u=[o,r,l,d];var h=$('<span class="tv-dialog-layout-button">'),c=$('<input type="checkbox" name="publish_entire_layout">').hide().appendTo(h);$('<i class="icon"></i>').appendTo(h);var p=$("<span></span>").appendTo(h);$('<span class="arrow-icon"></span>').appendTo(h),o.subscribe(i),r.subscribe(i),l.subscribe(i),d.subscribe(i),i(),TradingView.bindPopupMenu(h,function(){var e=c.is(":checked");return[{addClass:"tv-dialog-layout-popup tv-dialog-layout-s",title:"Publish Only "+t(),action:function(){c.attr("checked",!1),i()},active:!e,icon:!0},{addClass:"tv-dialog-layout-popup tv-dialog-layout-"+o.value(),title:"Publish All Charts",action:function(){c.attr("checked",!0),i()},active:e,icon:!0}]},{direction:"up"}),h.appendTo(n),s.on("destroy",function(){for(var e=0;e<u.length;e++)u[e].destroy()})}(),s.find(".tv-dialog-cancel-button").on("click",function(e){e.preventDefault(),o?A83.destroy(r):A83.showConfirm("Cancel publication","Are you sure you want to abandon your post?",function(){A83.destroy(r)})}),function(){function e(){var e=o.val()||"",t=o.prop("selectionStart");null==t&&(t=e.length);var i=o.prop("selectionEnd");return null==i&&(i=e.length),[e.substring(0,t),e.substring(t,i),e.substring(i)]}function t(e,t){var i=e.slice(0,t).join("").length;o.val(e.join("")),o.prop("selectionEnd",i),o.prop("selectionStart",i),o.focus()}function i(e){r.toggleClass("active",!!e),l.toggleClass("active",!!e),e?a.attr("disabled",!1).focus():a.attr("disabled",!0).blur()}function n(){var n=a.val();a.val("");var o=/\/v\/[a-zA-Z0-9]{8}/.test(n),r=/\/(i|x)\/[a-zA-Z0-9]{8}/.test(n),l=e();!n||o||r?(o?(l.splice(2,0,"[chart]"+n+"[/chart]"),t(l,3)):r&&(l.splice(2,0,"[image]"+n+"[/image]"),t(l,3)),i(!1)):A83.showError($.t("Please enter a valid idea URL or chart image URL"),s)}var o=s.find('[name="description"]');s.find(".bb-bold").addClass("apply-common-tooltip").attr("title",$.t("Bold")).on("click",function(i){i.preventDefault(),i=e(),i.splice(2,0,"[/b]"),i.splice(1,0,"[b]"),t(i,4)}),s.find(".bb-italic").addClass("apply-common-tooltip").attr("title",$.t("Italic")).on("click",function(i){i.preventDefault(),i=e(),i.splice(2,0,"[/i]"),i.splice(1,0,"[i]"),t(i,4)}),s.find(".bb-list").addClass("apply-common-tooltip").attr("title",$.t("List or list item")).on("click",function(i){i.preventDefault(),i=e();var n=!1;i[0].replace(/\[(\/)?list\]/gi,function(e,t){n=!t}),n?(i.splice(2,0,""),i.splice(1,0,"\n[*]")):(i.splice(2,0,"\n[/list]"),i.splice(1,0,"[list]\n[*]")),t(i,3)});var r=s.find(".bbcode-embed-form"),a=r.find("input");a.attr("placeholder",$.t("Published idea or chart image URL")),r.on("touchstartoutside mousedownoutside",function(e){r.hasClass("active")&&($(e.target).parents().andSelf().is(".bb-embed")||i(!1))});var l=s.find(".bb-embed");l.addClass("apply-common-tooltip").attr("title",$.t("Idea or chart snapshot image")).on("click",function(e){e.preventDefault(),i(!0),a.val("").focus()}),a.on("keypress",function(e){13===e.keyCode&&(n(),e.preventDefault())}),s.find(".embed-submit").on("click",function(e){e.preventDefault(),n()})}(),e.onDestroy&&s.on("destroy",e.onDestroy);var f=s.width(),g=s.height();return s.resizable({handles:"se",minHeight:g,minWidth:f,stop:function(){TVSettings.setJSON("publishchart.size",{w:s.width(),h:s.height()})}}),A83.applyHandlers(s,{doNotCloseOnBgClickIfShadowbox:!0,doNotCloseOnEsc:!0,doNotCloseOnBgClick:!0}),i(),{dialog:s,show:i,hide:n,close:function(){A83.destroy(r)}}},showGoProDialog:function(e){e||(e={}),A83.createModalDialog("",{noHeader:!0,addClass:"gopro-dialog ",appearance:"flat"});var t=A83.modalDialog;t.css({zIndex:1e3}),t=t.find(".tv-dialog-content"),t.html(Mustache.render(TradingView.templates.dialogs.goPro.layout,{trialButton:A10&&A10.trialAvailable&&A10.trialAvailable(),exchangesButton:e.exchangesButton,exchange:e.exchange}));var i=t.find(".col-main .col-copy");e=e.feature?Mustache.render(TradingView.templates.dialogs.goPro.features[e.feature],{exchangesButton:e.exchangesButton,exchange:e.exchange,options:e.featureOptions||{}}):TradingView.templates.dialogs.goPro.defaultCopy,i.html(e),t.find(".yes-button").on("click",function(e){this.href===location.href&&e.preventDefault(),A83.destroy()}),t.find(".no-button").on("click",function(e){e.preventDefault(),A83.destroy()}),A83.positionDialog(),A83.applyHandlers(null)},showAddSymbolDialog:function(e,t){t=$.extend({},{title:"Add Symbol",callback:function(e,t){},overlayOption:!1,overlayOptionChecked:TVSettings.getBool("showAddSymbolDialog.checkboxState",!0),okButtonTitle:"Add Symbol"},t||{});var i=A83.createDialog(t.title);i.css("min-width",0),i.find(".tv-dialog-content").html(Mustache.render(TradingView.templates.dialogs.addSymbol,t)).css("min-width",0),A83.applyHandlers(i);var n=$('<div class="symbol-edit-widget"></div>'),o=$('<input type="text" class="symbol-edit single" placeholder="Symbol" maxlength="30" style="text-transform: none; font-weight: normal;" autocomplete="off">').appendTo(n),r=A69.bindToInput(o,{
callback:function(e){var n=i.find("#tv-dialog-addsymbol-overlay-checkbox").is(":checked");if(e){var o=t.callback;o(e,n),$(window).off("keyup.addOverlay"),A83.destroy(i.data("title"))}}});i.find("div.symbol-edit-place").replaceWith(n),i.find(".tv-dialog").draggable(A83._constrainDraggableOptionsIfNeeded({handle:".tv-dialog-title"})),i.find("input[type=checkbox]").on("change",function(e){TVSettings.setJSON("showAddSymbolDialog.checkboxState",e.target.checked)}),i.find(".ok").on("click",function(){r.acceptTypeIn()}),i.show(),A83.positionDialog(i),o.focus()},makeDraggable:function(e){e.draggable({handle:".tv-dialog-title"})},showConfirmInputsDialog:function(e,t,i){function n(e){var t=i.callback;e=e.state(),t(e),A83.destroy(o.data("title"))}i=$.extend({},{title:"Confirm Inputs",callback:function(e){},okButtonTitle:"Apply"},i||{});var o=A83.createDialog(i.title,{content:"<div class='main'></div>"});o.css("min-width",0),A83.applyHandlers(o,{beforeDestroy:function(){$(window).unbind("keyup.hideInputsConfirmDialog")}});for(var r=TradingView.merge({},t.defaults.inputs),s=0;s<t.inputs.length;++s){var a=t.inputs[s];a.confirm||delete r[a.id]}var l=new Property({inputs:r});e=new $41(l,e.model(),{metaInfo:function(){return t}},!0).widget(),r=o.find(".main"),r.append(e),$(window).bind("keyup.hideInputsConfirmDialog",function(e){"13"==e.keyCode&&"textarea"!==e.target.tagName.toLowerCase()&&(n(l),$(window).unbind("keyup.hideInputsConfirmDialog"))}),$("select",r).each(function(){var e=$(this),t="tv-select-container dialog";e.hasClass("tv-select-container-fontsize")&&(t+=" tv-select-container-fontsize"),e.selectbox({speed:100,classHolder:t})}),$('input[type="text"]',r).addClass("tv-text-input inset dialog"),$("input.ticker",r).TVTicker(),o.find(".main").append("<div class='tv-dialogs-bottom-button'><span class='tv-button tv-right tv-uppercase ok'>Apply</span></div>"),o.find(".ok").on("click",function(){n(l)}),o.show(),A83.positionDialog(o),r.find("input,select").first().focus()},showUpdateAccountDataDialog:function(e){var t=Mustache.render('<form>{{#html}}<p>{{&html}}</p>{{/html}}<input type="text" value="{{value}}"></form>',{value:e.value||"",html:e.html});return A83.showCustomDialog({title:e.title,html:t,action:function(t){var i=t.find(".tv-button.ok");return i.addClass("process"),changeUserProfileField({name:e.paramName,value:t.find("input[type=text]").val(),onSuccess:e.success,onError:function(i){i=(i||[]).join(" "),"function"==typeof e.error?e.error(i):A83.showError(i||"Unexpected error: can't change profile data",t)},onComplete:function(){i.removeClass("process")}}),{notClose:!0}},onCancel:e.cancel})},showProRTTrialOffer:function(e){A83.createModalDialog("",{noHeader:!0,addClass:"prorttrial-dialog ",appearance:"flat"});var t=A83.modalDialog;t.css({zIndex:1e3}).find(".tv-dialog"),t=t.find(".tv-dialog-content"),t.html(Mustache.render(TradingView.templates.dialogs.proRTTrialOffer)),t.find("a.trial").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onAccept&&e.callbacks.onAccept()}),t.find("a.nothanks").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onDecline&&e.callbacks.onDecline()}),t.find("a.ordernow").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onOrder&&e.callbacks.onOrder()}),t.find("a.later").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onRemindLater&&e.callbacks.onRemindLater()}),A83.positionDialog(),A83.applyHandlers(null,{doNotCloseOnBgClickIfShadowbox:!0,doNotCloseOnEsc:!0})},showTrialMessage:function(e){A83.createModalDialog("",{noHeader:!0,addClass:"prorttrial-dialog ",appearance:"flat"});var t=A83.modalDialog;t.css({zIndex:1e3}).find(".tv-dialog"),t=t.find(".tv-dialog-content"),t.html('<div class="main"><h3 class="title"></h3><div class="copy"></div><div class="big-buttons"><a href="javascript://" class="big-button ok">OK</a></div></div>');var i=t.find(".title"),n=t.find(".copy"),o=t.find(".big-button.ok"),r=t.find(".big-buttons");e&&e.title?i.html(e.title):i.remove(),e&&e.copy?n.html(e.copy):n.remove(),e&&e.closeButtonCopy&&o.html(e.closeButtonCopy),e&&e.replaseCloseBtn&&r.html(e.replaseCloseBtn),t.find("a.ok").on("click",function(t){e&&e.replaseCloseBtnFunc?e.replaseCloseBtnFunc(t):(t.preventDefault(),A83.destroy())}),A83.positionDialog(),A83.applyHandlers(null)},showTrialMessageSuccess:function(){A83.showTrialMessage({title:"PRO Plus Trial",copy:"<p>Your 30-day free PRO Plus account has been activated. You are now part of a community of 2 million+ ideas that have been created within TradingView charts. To help get the ball rolling, we'd suggest you spend a few minutes familiarizing yourself with our online <a href='/stock-charts-support/'>help section</a>. We hope you enjoy working with TradingView and wish you good trading!</p>",replaseCloseBtn:"<a href='/e/' class='big-button ok'>LAUNCH CHART</a>",replaseCloseBtnFunc:function(){}})},showTrialConfirmationDialog:function(e){e=e||{},A83.createModalDialog("",{noHeader:!0,addClass:"trialconfirm-dialog ",appearance:"flat"});var t=A83.modalDialog;t.css({zIndex:1e3});var i=t.find(".tv-dialog-content");i.html('<div class="main"><h3 class="title">'+(e.title||"Trial confirmation dialog")+'</h3><div class="copy">'+(e.text||"Trial confirmation text")+'</div><div class="actions-block"><a class="no-button">'+(e.noText||"No, thank you")+'</a><a class="yes-button">START TRIAL</a></div></div>'),t=i.find(".no-button"),i=i.find(".yes-button"),t.on("click",function(t){return t.preventDefault(),"function"==typeof e.onCancel?e.onCancel(t):void A83.destroy()}),i.on("click",function(t){return"function"==typeof e.onSubmit?e.onSubmit(t):void t.preventDefault()}),A83.positionDialog(),A83.applyHandlers(null)},showEarlyAccessDialog:function(e){A83.createModalDialog("",{noHeader:!0,addClass:"prorttrial-dialog ",appearance:"flat"});var t=A83.modalDialog;t.css({zIndex:1e3}).find(".tv-dialog");var t=t.find(".tv-dialog-content"),i={};switch(e&&e.reason){case"after 1 week":i.is_1wk=!0;break;case"after 2 weeks":i.is_2wk=!0;break;case"finished":i.is_finished=!0;break;default:i.is_manual=!0}t.html(Mustache.render(TradingView.templates.dialogs.earlyAccess,i)),i=null,t.find("a.nothanks").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onDecline&&e.callbacks.onDecline()}),t.find("a.ordernow").on("click",function(t){t.preventDefault(),e&&e.callbacks&&e.callbacks.onOrder&&e.callbacks.onOrder()}),A83.positionDialog(),A83.applyHandlers(null,{doNotCloseOnBgClickIfShadowbox:!0,doNotCloseOnEsc:!0})},showUnsubscribeConfirmationDialog:function(e,t,i){A83.createModalDialog(e),A83.modalDialog.find(".tv-dialog").css("width","450px"),A83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big">Aww, we are sorry to see you go! If you cancel, you will no longer be billed after your current subscription period ends. Your subscription service will continue to be active until the end of the period that you paid for. Sorry, there are no refunds.<br/><br/>If you are sure you want to cancel, click Cancel, otherwise choose Do Not Cancel. If you cancel, we’d really like to know the reason why you are cancelling so we can make things better.</div><textarea style="width: 398px; height: 100px;"></textarea></div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide yes" type="button" value="Cancel {{text}} and send feedback" style="margin-right: 10px;"/><input class="tv-button wide no" type="button" value="Do Not Cancel"/></div>',{text:t}));var n=A83.modalDialog.find(".yes");n.click(function(){var e=A83.modalDialog.find("textarea").val();e?(n.addClass("process"),i(e)):A83.showError("Please enter your feedback")}),A83.modalDialog.find(".no").click(function(){A83.destroy()}),A83.positionDialog(),A83.applyHandlers()},showChangeUserStatusDialog:function(){var e=A83.createDialog("Update status");e.find(".tv-dialog").css("width","400px"),e.find(".tv-dialog-content").html('<form><div class="main"><input type="text" name="status" value="'+("string"==typeof window.user.status?window.user.status.replace(/"/g,"&quot;"):"")+'"></div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="submit" value="OK" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="Cancel"/></div></form>');var t=e.find(".ok"),i=e.find('[name="status"]');e.find("form").submit(function(){return t.addClass("process"),changeUserProfileField({name:"status",value:String(i.val()).replace(/^\s+|\s+$/g,""),onSuccess:function(e){var t=$("#change-profile-status"),i=e?e:"Add status...";t.hasClass("tv-editable-active")?t.find('input[type="text"], textarea').val(i):t.text(i),$('[name="status"]').val(e),A83.destroy("Update status")},onError:function(e){A83.showError("We'are sorry, something went wrong. Try to reload page."),console.warn(e)},onComplete:function(){t.removeClass("process")}}),!1}),e.find(".cancel").click(function(){A83.destroy("Update status")}),Modernizr.touch&&i.val(""),A83.positionDialog(e,{considerScroll:!0}),A83.applyHandlers(e),i.focus().select()},showScriptSearchDialog:function(e){function t(){if(value=o.val(),value!==a){a=value,r.toggle(!!value),l&&(l.abort&&l.abort(),l=null),s.html('<div class="loading"></div>');var e=A56.suggest(a);l=e,A56.list().done(function(t){e.done(function(n){e===l&&i(n,t)})})}}function i(e,t){s.empty(),e&&(e.length||$('<p class="nothing">No scripts matched your criteria</p>').appendTo(s),e.forEach(function(e){if(e){var i=$('<div class="item">');if(e.author){var o=$('<div class="item-avatar">').appendTo(i);$("<img>").attr({src:"/avatar/"+e.author.id+"/","class":"avatar userlink",alt:e.author.username,"data-username":e.author.username}).appendTo(o)}if(o=$('<div class="item-buttons"></div>').appendTo(i),$(Mustache.render(TradingView.templates.publishedScriptButton,{script_id_part:e.scriptIdPart,script_install_count:e.scriptInstallCount,show_script_install_count:!!e.scriptInstallCount,script_in_library:t.some(function(t){return t.scriptIdPart==e.scriptIdPart})})).appendTo(o),n){var r=$('<a class="pubscript-try-button" title="Add this study to active chart"><span class="label">Try</span></a>');r.on("click",function(t){t.preventDefault(),n(e)}),r.appendTo(o)}o=$('<div class="item-main">').appendTo(i),r=$('<div class="item-title">').appendTo(o),$("<a>").attr({href:"/v/"+e.imageUrl+"/",target:"_blank"}).text(e.scriptName||e.scriptTitle||"Study").appendTo(r),$('<div class="item-desc">').text(e.description||"").appendTo(o),s.append(i)}}))}var n=e.onTry;e=A83.createDialog("Search for scripts published by community",{width:815,content:TradingView.templates.dialogs.scriptSearch,addClass:"script-search-dialog"});var o=e.find("input[name=q]"),r=e.find(".input-reset"),s=e.find(".script-search-results");r.on("click",function(){o.val(""),t()});var a=void 0,l=null;return o.on("input keyup change",t),t(),A83.positionDialog(e),A83.applyHandlers(e),e},showPrioritySupportDialog:function(){A83.showCustomDialog({title:"Priority Support",html:TradingView.templates.dialogs.proiritySupport,noButtons:!0})},showNotice:function(e,t,i){return"object"==typeof t&&(i=t,t=""),i=i||{},doNotCloseOnBgClick=i.doNotCloseOnBgClick||!1,html=i.html||"",A83.createModalDialog(e),A83.modalDialog.find(".tv-dialog").css("width","400px"),A83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big-center {{classSuffix}}">{{text}}'+html+"</div></div>",{classSuffix:i.classSuffix||"",text:t})),A83.positionDialog(),A83.applyHandlers(!1,{doNotCloseOnBgClickIfShadowbox:doNotCloseOnBgClick,beforeDestroy:i.onClose}),A83.modalDialog},showConfirm:function(e,t,i,n,o){o=o||{},o.dontAskSetting&&TVSettings.getBool(o.dontAskSetting)?i():(A83.createModalDialog(e,o),A83.modalDialog.find(".tv-dialog").css("width","400px"),A83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big">{{text}}</div>{{#dontAskSetting}}<input type="checkbox" id="confirm-dialog-checkbox" style="margin: 0; vertical-align: middle;"> <label for="confirm-dialog-checkbox" style="font-size: 11px;">Do not ask again</label>{{/dontAskSetting}}</div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="button" value="'+$.t("YES")+'" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="'+$.t("NO")+'"/></div>',{text:t,dontAskSetting:!!o.dontAskSetting})),o.okButtonText&&A83.modalDialog.find(".ok").val(o.okButtonText),o.cancelButtonText&&A83.modalDialog.find(".cancel").val(o.cancelButtonText),A83.modalDialog.find(".ok").click(function(){o.dontAskSetting&&$("#confirm-dialog-checkbox").is(":checked")&&TVSettings.setValue(o.dontAskSetting,!0),i(),A83.destroy()}),A83.modalDialog.find(".cancel").click(function(){n&&n(),A83.destroy()}),A83.positionDialog(),A83.applyHandlers())},showPrompt:function(e,t,i,n,o){function r(){var e=l.val();if(a){var t=a(e);if(t)return!0===t&&(t="Wrong value"),void A83.showError(t,A83.modalDialog)}A83.destroy(),i&&i(e)}var s=o&&o.defaultValue,a=o&&o.validate;A83.createModalDialog(e,o),A83.modalDialog.find(".tv-dialog").css("width","400px"),A83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><form><div class="caption-big-center slim">{{text}}: <input type="text" name="prompt-value" class="prompt-value"/></div></form></div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="button" value="OK" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="Cancel"/></div>',{text:t}));var l=A83.modalDialog.find('[name="prompt-value"]');s&&l.val(s),A83.modalDialog.find("form").submit(function(e){r(),e.preventDefault()}),A83.modalDialog.find(".ok").click(function(e){r(),e.preventDefault()}),A83.modalDialog.find(".cancel").click(function(){A83.destroy(),n&&n(value)}),A83.positionDialog(),A83.applyHandlers(),setTimeout(function(){l.focus().select()},0)},showCustomDialog:function(e){function t(t){var i=e.action(A83.modalDialog),n=i&&i.notClose;(!i||i.error)&&void 0!==i||n?i.error&&A83.showError(i.error):A83.destroy(),t.preventDefault()}function i(t){"function"==typeof e.onCancel?e.onCancel():A83.destroy()}return A83.createModalDialog(e.title||"Dialog"),A83.modalDialog.find(".tv-dialog").css("width",e.width||"400px"),A83.modalDialog.find(".tv-dialog-content").html('<div class="main">'+(e.html||"Content")+"</div>"+(e.noButtons?"":'<div class="tv-dialogs-bottom tv-dialog-center">'+(e.noButtonOk?"":'<input class="tv-button wide ok" type="button" value="OK" style="margin-right: 10px;"/>')+(e.noButtonCnacel?"":'<input class="tv-button wide cancel" type="button" value="Cancel"/>')+"</div>")),e.okButtonText&&A83.modalDialog.find(".ok").val(e.okButtonText),e.cancelButtonText&&A83.modalDialog.find(".cancel").val(e.cancelButtonText),A83.modalDialog.find(".ok").click(t),A83.modalDialog.find("form").submit(t),A83.modalDialog.find(".cancel").click(i),A83.modalDialog.find(".tv-dialog-title-close").click(i),A83.positionDialog(),A83.applyHandlers(),A83.modalDialog},createModalDialog:function(e,t){t=t||{},null!==A83.modalDialog&&A83.destroy(),A83.modalDialog=$('<div class="tv-dialog-shadowbox"><div class="tv-dialog tv-dialog-modal'+(t.addClass?" "+t.addClass:"")+'">'+(t.noHeader?"":'<div class="tv-dialog-title">'+(t.noClose?"":'<a class="tv-dialog-title-close"></a>')+'<span class="tv-dialog-title-text">'+e+"</span></div>")+'<div class="tv-dialog-error"></div><div class="tv-dialog-message"></div><div class="tv-dialog-content"></div></div></div>').appendTo($("body")).data("title",e),t.noShadowBox&&A83.modalDialog.addClass("transparent"),t.addClass&&A83.modalDialog.addClass(t.addClass),t.width&&A83.modalDialog.find(".tv-dialog").css({width:t.width}),t.content&&A83.modalDialog.find(".tv-dialog-content").html(t.content);var i=$(".fancybox-overlay");i.length&&(i=i.css("z-index"),$(".tv-dialog-shadowbox").css("z-index",i+1)),t.zIndex&&A83.modalDialog.css("z-index",t.zIndex)},createDialog:function(e,t){if(A83.isOpen(e)){var i=A83.get(e);return i.find(".tv-dialog-content").html(""),i.data("new",!1),i}t=t||{},i=$(Mustache.render('<div class="tv-dialog tv-dialog-nonmodal {{&addClass}}"><div class="tv-dialog-title{{#hideTitle}} tv-dialog-title-hidden{{/hideTitle}}{{#hideCloseCross}} tv-dialog-title-no-close{{/hideCloseCross}}">{{^hideTitle}} {{&title}}{{/hideTitle}}{{^hideCloseCross}}<a class="tv-dialog-title-close"></a>{{/hideCloseCross}}</div><div class="tv-dialog-error"></div><div class="tv-dialog-message"></div><div class="tv-dialog-content"></div></div>',{addClass:t.addClass||"",hideTitle:t.hideTitle,hideCloseCross:t.hideCloseCross,title:e})).appendTo($("body")),t.width&&i.css({width:t.width}),t.content&&i.find(".tv-dialog-content").html(t.content);var n=0,n=A83.dialogs&&A83.dialogs.length?MathEx.max($.map(A83.dialogs,function(e){return parseInt((e.dialog||e).css("z-index"),10)}))+1:110;return i.css("z-index",n),i.data("new",!0),i.data("title",e),i.data("id",A83.dialogs.length+1),A83.dialogs.push({title:e,dialog:i,id:A83.dialogs.length+1}),n={start:function(e,t){for(var i=t.helper.css("z-index"),n=0,o=null,r=0;r<A83.dialogs.length;r++){var s=A83.dialogs[r].dialog.css("z-index");s>n&&(n=s,o=A83.dialogs[r].dialog)}t.helper.css("z-index",n),o.css("z-index",i)}},t.dragHandle?n.handle=t.dragHandle:t.hideTitle||(n.handle=".tv-dialog-title"),i.draggable(A83._constrainDraggableOptionsIfNeeded(n)),i},positionDialog:function(e,t,i){if(i=i||{},t=t||i.position,e){var n=e.width(),o=e.height(),r=$(window).width(),s=$(window).height();t&&t.top&&t.left?(n=i.forcePosition?t.left:Math.max(2,Math.min(r-n-4,t.left))+"px",o=i.forcePosition?t.top:Math.max(2,Math.min(s-o-4,t.top))+"px"):t&&t.considerScroll?(t=$(document),n=Math.round((r-n)/2+t.scrollLeft())+"px",o=Math.round((s-o)/2+t.scrollTop())+"px"):(n=Math.round((r-n)/2)+"px",o=Math.round((s-o)/2)+"px"),i.smooth?e.animate({left:n,top:o}):e.css({left:n,top:o})}else{i=function(){a.css("margin-left",-Math.round(a.outerWidth()/2)+"px"),a.css("margin-top",-Math.round(a.outerHeight()/2)+"px")},e=A83.modalDialog;var a=e.find(".tv-dialog");i(),a.resize(i)}},applyHandlers:function(e,t){var i=!e||e===this.modalDialog;t=t||{};var n=i?function(){A83.destroy()}:function(){A83.destroy(e.data("title"))};e||(e=A83.modalDialog.find(".tv-dialog")),t.beforeDestroy&&e.on("destroy",t.beforeDestroy),e.find(".tv-dialog-title .tv-dialog-title-close").on("click",n),t.doNotCloseOnBgClick||setTimeout(function(){e.on("mousedownoutside",function(i){i=$(i.target).parents().andSelf(),t.doNotCloseOnBgClickIfShadowbox&&i.is(".tv-dialog-shadowbox")||i.is(".colorpicker, .charts-popup-list, .tv-dialog, .tvcolorpicker-popup, .symbol-edit-popup, .ui-datepicker, .clockpicker-popover, .pac-container")||(e.unbind("mousedownoutside"),n())})},0),e.find('input[type="checkbox"]').change(function(){var e=$(this);e.next(".tv-dialog-checkbox-mask").toggleClass("disabled",e.prop("disabled")).toggleClass("tv-dialog-checkbox-mask-active",e.is(":checked"))}),i=e.find('input[type="text"]').focus(function(){$(this).addClass("tv-dialog-content-textactive")}).blur(function(){$(this).removeClass("tv-dialog-content-textactive")}).first(),Modernizr.touch||t.notFocusFirst||i.focus(),e.find('input[type="password"]').focus(function(){$(this).addClass("tv-dialog-content-textactive")}).blur(function(){$(this).removeClass("tv-dialog-content-textactive")}),e.find("textarea").focus(function(){$(this).addClass("tv-dialog-content-textareaactive")}).blur(function(){$(this).removeClass("tv-dialog-content-textareaactive")}),e.find(".tv-dialog-checkbox-mask").click(function(){var e=$(this).prev();e.prop("disabled")||(e.prop("checked",!e[0].checked),e.change())}),$(".tv-dialog .tv-dialog-error").mouseenter(function(){$(this).animate({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,opacity:0},"fast",function(){$(".tv-dialog .tv-dialog-error").hide()}),clearInterval(A83.messageInterval)}),$(".tv-dialog .tv-dialog-message").mouseenter(function(){$(this).animate({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,opacity:0},"fast",function(){$(".tv-dialog .tv-dialog-message").hide()}),clearInterval(A83.messageInterval)}),t.doNotCloseOnEsc||$(window).bind("keyup.hideDialog",function(t){return"27"==t.keyCode?(e?A83.destroy(e.data("title")):A83.destroy(),!1):void 0})},showError:function(e,t){var i;t?(i=t.find(".tv-dialog-error"),t.width()):(i=$(".tv-dialog .tv-dialog-error"),$(".tv-dialog").width()),i.text(e).css({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,left:"10px",right:"10px",opacity:"0"}).show().animate({marginTop:0,opacity:1},"fast"),clearInterval(A83.messageInterval),A83.messageInterval=setInterval(function(){$(".tv-dialog .tv-dialog-error").animate({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,opacity:0},"fast",function(){$(".tv-dialog .tv-dialog-error").hide()}),clearInterval(A83.messageInterval)},A83.messageDelay)},showMessage:function(e){$(".tv-dialog .tv-dialog-message").text(e).css({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,left:"10px",right:"10px",opacity:"0"}).show().animate({marginTop:0,opacity:1},"fast"),clearInterval(A83.messageInterval),A83.messageInterval=setTimeout(function(){$(".tv-dialog .tv-dialog-message").animate({marginTop:A83.NOTIFICATION_ANIMATION_START_OFFSET,opacity:0},"fast",function(){$(".tv-dialog .tv-dialog-message").hide()}),clearInterval(A83.messageInterval)},A83.messageDelay)},showStocktwitsDialog:function(e,t){return A83.showCustomDialog({title:"Send Message to stocktwits",html:Mustache.render('<textarea style="width: 100%" maxLength="120">{{text}}</textarea>',{text:e}),action:t})},isOpen:function(e){for(var t=0;t<A83.dialogs.length;t++)if(A83.dialogs[t].title==e)return!0;return!1},get:function(e){for(var t=0;t<A83.dialogs.length;t++)if(A83.dialogs[t].title==e)return A83.dialogs[t].dialog},submit:function(e,t){var i=t?$(t):$(".tv-dialog form").first(),n=i.serialize(),i=i.attr("action");$.post(i,n,function(t){void 0!==e&&e(t)},"json")},destroy:function(e,t){if(void 0!==A83.chart&&(A83.chart.destroy(),delete A83.chart),$(window).unbind("keyup.hideDialog"),e)for(var i=0;i<A83.dialogs.length;i++)A83.dialogs[i].title==e&&(A83.dialogs[i].dialog.trigger("destroy",t),$(document).unbind("mouseup.hideDialog"+A83.dialogs[i].id),$("input",A83.dialogs[i].dialog).blur(),A83.dialogs[i].dialog.remove(),A83.dialogs.splice(i,1));else A83.modalDialog&&(A83.modalDialog.find(".tv-dialog").trigger("destroy"),A83.modalDialog.remove(),A83.modalDialog=null)},changeTitle:function(e,t){if(e)for(var i=0;i<A83.dialogs.length;i++)if(A83.dialogs[i].title==e){var i=A83.dialogs[i],n=i.dialog,o=n.find(".tv-dialog-title");i.title=t,n.data("title",t),o.html(o.html().replace(e,t)),o.find("a").on("click",function(){A83.destroy(t)});break}},calcHeight:function(e,t,i){return null==i&&(i=20),e+=i,i=parseInt($("body").height(),10),e>i&&(t=Math.max(0,t-(e-i))),t},resizeContent:function(e,t,i){null==i&&(i=20),e+=i,i=parseInt($("body").height(),10);var n=t.height();e>i&&(n=Math.max(0,n-(e-i)),t.height(n))},resizeContentWidth:function(e,t,i){null==i&&(i=20),e+=i,i=parseInt($(window).width(),10);var n=t.width();e>i&&(n=Math.max(0,n-(e-i)),t.width(n))}},ChartSaver.prototype.saveToJSON=function(){return this._fillSavingInfo(!1,!0)},ChartSaver.prototype._fillAsyncInfo=function(e,t,i){var n=JSON.parse(e.content),o=this.D5;t||(i=!0);var r=$.Deferred();return i?o.asyncState(!!t).then(function(t){e.content=JSON.stringify($.extend(!0,n,t)),r.resolve(e)}):o.activeChartWidget.value().asyncState(!!t).then(function(t){e.content=JSON.stringify($.extend(!0,n,t)),r.resolve(e)}),r.promise()},ChartSaver.prototype._fillSavingInfo=function(e,t){e||(t=!0);var i={publish_request_id:Math.random().toString(36).substring(2)},n=this.D5,o=n.activeChartWidget.value(),r=n.metaInfo,s=o.model().mainSeries(),a=s.properties(),l=s.symbolInfo();if(!(s&&s.symbolInfo()&&r&&l))throw new ReferenceError("Missed required data");for(r.id.value()&&(i.id=r.id.value()),i.name=r.name.value()||"",i.description=r.description.value()||"",i.resolution=s.properties().interval.value(),i.symbol_type=l.type||"",i.exchange=l.exchange||"",i.listed_exchange=l.listed_exchange||"",s.isSpread()?(a=l.legs[0],r=l.base_name[0],r=r.split(":")[1],i.symbol=a,i.short_name=this.verifiedShortName(a,r,o),i.expression=l.full_name):(r=l.ticker||a.symbol.value(),a=a.shortName.value(),i.symbol=r,i.short_name=this.verifiedShortName(r,a,o)),a=[],r=0,s=l.legs.length;s>r;r++)a.push({symbol:l.legs[r],pro_symbol:l.base_name[r]});return i.legs=JSON.stringify(a),i.content=t?JSON.stringify(n.state(!!e)):JSON.stringify(o.state(!!e)),e&&(i.image=JSON.stringify(n.images({onlyActiveChart:!t}))),i.is_realtime=e?"0":"1",i},ChartSaver.prototype.publishChart=function(e){function t(e,t){i.onPublish(e,$.extend({},t,{closeForm:function(){i._dialogCtl.close()},showError:function(e){A83.showError(e,i._dialogCtl.dialog)}}))}var i=this;TradingView.trackEvent("GUI","Publish Chart"),$(".publish-chart-button").removeClass("inprogress"),i._dialogCtl?i._dialogCtl.show():i._dialogCtl=A83.showPublishChartDialog($.extend({D6:this.D5,onPublish:t,onMinimize:function(){$(".publish-chart-button").addClass("inprogress")},onDestroy:function(){delete i._dialogCtl,$(".publish-chart-button").removeClass("inprogress")},related:i._lastPublishUrl},e))},ChartSaver.prototype.onPublish=function(e,t){function i(e){n.publishInProgress=!1,e=e.responseText,"ok:"===e.substr(0,3)?(e=e.substr(3),e=JSON.parse(e),n.D5.metaInfo.id.value()||n.D5.metaInfo.id.setValue(e.id),t.closeForm&&t.closeForm(),n._lastPublishUrl=e.publishUrl,n.hWnd&&(n.hWnd.location=e.publishUrl)):(t.showError&&t.showError(e||"Error occured while publishing"),n.hWnd&&(n.hWnd.close(),n.hWnd=null))}var n=this;if(!n.publishInProgress){var o=n._fillSavingInfo(!0,t&&t.publishAllLayout);n._fillAsyncInfo(o,!0,t&&t.publishAllLayout).then(function(t){$.ajax({url:"/publishchart/",type:"post",dataType:"text",data:$.extend({},t,e),complete:i})}),n.publishInProgress=!0,!t.onWidget&&""!==e.name&&""!==e.description&&4e3>=e.description.length&&64>=e.name.length&&($.cookie("publish_request_id",o.publish_request_id,{path:"/"}),n.hWnd=window.open("/loading/","_blank"))}},ChartSaver.prototype.verifiedShortName=function(e,t,i){t||(t=""),i=i.model().mainSeries();var n;if(n=!i.isSpread()){var o=t,r=/^[1-9]\//;n=e.replace(r,""),o=o.replace(r,""),n=-1==n.indexOf(o)}return n&&!W77.enabled("short_name_may_differ_from_fullname")&&(t=e.substr(e.indexOf(":")+1),i.properties().shortName.setValue(t),TradingView.trackEvent("Chart","short_name differs from full_name"),console.error("short_name differs from full_name")),t},ChartSaver.prototype.saveChartSilently=function(e,t,i,n){var o=this.D5.metaInfo;t=this._fillSavingInfo(t),n=n||{},n.chartName&&(t.name=n.chartName),$(window).on("beforeunload.savechart",function(){return $.t("Your chart is being saved, please wait a moment before you leave this page.")}),saveChart(t,o,e,i,n),$(window).off("beforeunload.savechart")},A71=function(e,t,i){this._$tabs=e,this._$pages=t,this.options=$.extend({},this._DEFAULT_OPTIONS,i||{}),this.tabChanged=new Delegate,this.initActivePage(),this.initHandlers()},A71.prototype._DEFAULT_OPTIONS={saveTab:!1},A71.prototype.initActivePage=function(){var e=0;this.options.saveTab&&(e=TVSettings.getInt(this.options.saveTab,0)),this.setActivePage(e)},A71.prototype.setActivePage=function(e){this._$tabs.children().removeClass("active").eq(e).addClass("active"),this._$pages.children().removeClass("active").eq(e).addClass("active"),this.options.saveTab&&TVSettings.setValue(this.options.saveTab,e),this.tabChanged.fire(e)},A71.prototype.initHandlers=function(){this._$tabs.on("click","*",this._onTabClick.bind(this))},A71.prototype._onTabClick=function(e){e.preventDefault(),e=$(e.currentTarget).index(),this.setActivePage(e)},A71.prototype.addPage=function(e,t){var i=this.count();return this._$tabs.append(e),this._$pages.append(t),i||this.setActivePage(0),i},A71.prototype.removePage=function(e){this._$tabs.children().eq(e).remove(),this._$pages.children().eq(e).remove(),e=this._$tabs.children().filter(".active").length?this._$tabs.children().filter(".active").index():e-1>=0?e-1:0,this.setActivePage(e)},A71.prototype.count=function(){return this._$tabs.children().length},A71.prototype.index=function(){return this._$tabs.children().filter(".active:eq(0)").index()},A71.prototype.indexOfPage=function(e){return this._$pages.children().index(e)},A71.prototype.pageAt=function(e){return this._$pages.children().eq(e)},TradingView.templates={index:{chartsSection:'<div class="index-charts-tab active" id="index-charts-tab-{{index}}"><div class="index-charts-tab-sizer"><div class="index-charts-tab-container"><div class="clear"></div></div><div class="index-charts-spinner"></div></div><div class="show-more"><a href="/s/?q=&sort={{url}}" id="show-more-button">More {{sectionName}} Ideas</a></div></div>',chartsSectionItem:'<div class="item" id="chart-{{id}}"><a href="/v/{{image_url}}/"><img class="chart-img" src="{{image_mid_url}}" alt="" /></a><div class="caption">{{>iconedFollowSymbolButton}} <a href="/chart/{{short_name}}/{{#full_name_required}}?exg={{exchange}}{{/full_name_required}}" class="symbol" data-symbol="{{symbol}}">{{short_name}}</a>, <span class="interval">{{interval}}</span> <span class="count views"><span class="icon icon-eye" title="Views"></span> {{views_count}}</span><span class="count comments"><span class="icon icon-comment" title="Comments"></span> {{comment_count}}</span></div><a class="cover{{#is_online}} online{{/is_online}}" href="/v/{{image_url}}/"><img class="avatar-pic" src="{{user_picture}}" alt="{{full_name}}"/><div class="user-info">{{full_name}}{{#is_moderator}}<sup class="user-badge mod" title="Moderator}">mod</sup>{{/is_moderator}} {{^is_moderator}}{{#is_pro}}<sup class="user-badge pro{{#is_realtime}} realtime{{/is_realtime}}{{#is_trial}} trial{{/is_trial}}" title="Pro{{#is_realtime}} Realtime{{/is_realtime}}{{#is_trial}} Trial{{/is_trial}}">pro</sup>{{/is_pro}} {{/is_moderator}}<br/><span class="icon icon-charts" title="Charts"></span> {{user_charts}} <span class="icon icon-rating-small" title="Rating"></span> {{followers_count}}</div><div class="clear"></div><div class="name">{{name}}</div><div class="desc">{{desc}}</div><div class="date">{{created_time}}</div><div class="icons">{{> chartBadges}}<span class="chart-direction-label direction-{{direction}}">{{#direction_name}}{{direction}}{{/direction_name}}</span></div></a></div>'},addressInputsRows:'<tr><td class="half" colspan="6"><p>Address</p><input class="address-autocomplete" type="text" value="" placeholder="{{#addressPlaceholder}}{{addressPlaceholder}}{{/addressPlaceholder}}{{^addressPlaceholder}}Enter your address{{/addressPlaceholder}}"/></td></tr><tr><td colspan="6"><input type="text" autocomplete-name="route" name="STREET" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.STREET}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_street }}{{/reference_transaction_billing_address}}" placeholder="Street" disabled="true"/></td></tr><tr><td class="half" colspan="3"><input type="text" autocomplete-name="locality" name="CITY" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.CITY}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_city }}{{/reference_transaction_billing_address}}" placeholder="City" disabled="true"/></td><td class="half" colspan="3"><input type="text" autocomplete-name="administrative_area_level_1" name="STATE" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.STATE}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_state }}{{/reference_transaction_billing_address}}" placeholder="State/Region" disabled="true"/></td></tr><tr><td class="half" colspan="3"><input type="text" autocomplete-name="country" name="COUNTRY" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.COUNTRY}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_country }}{{/reference_transaction_billing_address}}" placeholder="Country" disabled="true"/><input type="hidden" autocomplete-name="country_code" name="COUNTRYCODE" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.COUNTRYCODE}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_countrycode }}{{/reference_transaction_billing_address}}" /></td><td class="half" colspan="3"><input type="text" autocomplete-name="postal_code" name="ZIP" value="{{#reference_transaction_billing_address}}{{reference_transaction_billing_address.ZIP}}{{/reference_transaction_billing_address}}{{^reference_transaction_billing_address}}{{ user.billing_zip }}{{/reference_transaction_billing_address}}" placeholder="Zip Code" disabled="true"/></td></tr>',
dialogs:{paymentMethod:'<table class="tv-dialog-colomn-table"><tr><td><div class="tv-dialog-title"><span class="tv-dialog-title-text">{{title}}</span><a class="tv-dialog-title-close"></a></div><div class="main">{{#message}}<p>{{message}}</p>{{/message}}{{#pnref}}<div class="order-detail-head" data-method="oneclick-form"><h3><span class="order-checkbox radio active"></span>Make payment with previously used details</h3></div>{{/pnref}}<div class="order-detail-head" data-method="cc-form"><h3><span class="order-checkbox radio{{^pnref}} active{{/pnref}}"></span>Credit Card</h3></div><div class="order-detail-head" data-method="expresscheckout-form"><h3><span class="order-checkbox radio"></span>PayPal</h3></div>{{#pnref}}<div class="order-detail-body oneclick-form active"><p>Your credit card on file is XXXX-XXXX-XXXX-{{ cchint }}</p><form action="/paypal/oneclick/" id="oneclick-form" class="payment-form" method="post"><input type="hidden" name="pnref" value="{{ pnref }}" /><input type="hidden" name="billing_cycle" value="{{billing_cycle}}" /> <input type="hidden" name="child_products" value="{{child_products}}" /> <input type="hidden" name="exchanges_only" value="{{exchanges_only}}" /> {{#reference_transaction_billing_address_is_full}}<input name="ZIP" value="{{reference_transaction_billing_address.ZIP}}" type="hidden"><input name="STREET" value="{{reference_transaction_billing_address.STREET}}" type="hidden"><input name="CITY" value="{{reference_transaction_billing_address.CITY}}" type="hidden"><input name="STATE" value="{{reference_transaction_billing_address.STATE}}" type="hidden"><input name="COUNTRY" value="{{reference_transaction_billing_address.COUNTRY}}" type="hidden"><input name="COUNTRYCODE" value="{{reference_transaction_billing_address.COUNTRYCODE}}" type="hidden">{{/reference_transaction_billing_address_is_full}}{{^reference_transaction_billing_address_is_full}}<table id="oneclick-table">{{>addressInputsRows}}</table>{{/reference_transaction_billing_address_is_full}}</form></div>{{/pnref}}<div class="order-detail-body expresscheckout-form"><p>You will be automatically redirected to PayPal in order to finish your purchase.</p><form action="/paypal/expresscheckout/" id="expresscheckout-form" class="payment-form" method="post"><input type="hidden" name="billing_cycle" value="{{billing_cycle}}" /> <input type="hidden" name="child_products" value="{{child_products}}" /> <input type="hidden" name="exchanges_only" value="{{exchanges_only}}" /> </form></div><div class="order-detail-body cc-form{{^pnref}} active{{/pnref}}"><form action="https://{{ api_host }}" id="cc-form" class="payment-form" method="post"><input type="hidden" name="SECURETOKEN" value="" /><input type="hidden" name="SECURETOKENID" value="" /><input type="hidden" name="EXPDATE" value="" /> <table id="cc-table"><tr><td class="half" colspan="3"><p>First Name</p><input type="text" name="BILLTOFIRSTNAME" value="{{ user.first_name }}" /></td><td class="half" colspan="3"><p>Last Name</p><input type="text" name="BILLTOLASTNAME" value="{{ user.last_name }}" /></td></tr>{{>addressInputsRows}}<tr><td colspan="6"><p>Email</p><input type="text" name="BILLTOEMAIL" value="{{ user.email }}" /></td></tr><tr><td colspan="6"><p>Card Number</p><input type="text" name="ACCT" value="" /></td></tr><tr><td class="half" colspan="3"><p>Card Security Code <span id="cc-table-csc-help-link" href="#csc-help">?</span></p><input type="text" name="CVV2" value="" /></td><td colspan="3"><p>Expiration Date (MM/YY)</p><input class="exp-date" type="text" name="EXPDATEMM" value="" /><span class="slash">/</span><input class="exp-date" type="text" name="EXPDATEYY" value="" /></td></tr></table></form></div><div class="order-purchase-button"><a href="#subscribe" class="green" id="order-subscribe">{{#okText}}{{okText}}{{/okText}}{{^okText}}Subscribe{{/okText}}</a></div></div></td>{{#showTotalColumn}}<td class="tv-dialog-right-colomn"><div class="main"><div class="slip-header">Your Order</div><table class="slip-table">{{#totalsList}}<tr><td>{{name}} ({{billing_cycle_readable}})</td><td>${{cost}}</td></tr>{{/totalsList}}<tr class="slip-divider"><td colspan="2"></td></tr><tr class="slip-total"><td><b>Total</b></td><td>${{total}}</td></tr></table></div></td>{{/showTotalColumn}}</tr></table>',proiritySupport:'<p><strong>Priority phone support</strong>: +1 (614) 285-3457<br><br>Average waiting time on the phone is less than one minute. Phone support is available Monday-Friday from 6:30 AM until 3:00 PM EST.</p><p><strong>Priority email support</strong>: <a href="mailto:premium@tradingview.com">premium@tradingview.com</a><br><br>E-mail support hours are 4:00 AM – 3 PM EST Monday - Friday. Typical response time is 1 hour during business hours.</p>',publishIntro:'<div class="main"><p>Publishing means sharing your chart and trading idea with the financial web and the investing community. A published idea needs to be detailed and descriptive in order to be meaningful to other traders.</p><p>In effort to make TradingView more useful to a larger number of users, moderators have the right to hide ideas with bad descriptions or not informative from the front page and the gallery. We are NOT limiting any ways of publishing or using TradingView charts. You can still create and publish any kind of charts; your profile and Activity Stream will still show all created charts.</p><p>The best ideas are placed in the <b>Suggested</b> tab, where they receive extra exposure. All suggested ideas are hand-picked by our editorial team based on a number of criteria. We have a dedicated group of people who review every idea published every day to find the most interesting and informative ideas that will be helpful to other members.</p><p><strong>Following below suggestions will help get your ideas suggested:</strong></p><ul><li>A clear title that describes your idea. Don’t just write “MSFT” or “MSFT Short”. A title like this doesn’t say much and won’t attract much interest to your idea.</li><li>A description that clearly states your idea. Describe what you think and WHY you think that. Good fundamental analysis always helps. Put yourself in reader’s shoes and see if you’d understand the context based on what you wrote. It’s also a good idea to re-post descriptions right on the chart, so your idea can be shared without losing meaning.</li><li>Long-term intervals are better than short-term ones for publishing analysis. An idea on 1 minute bars will probably become obsolete by the time people read it. However a good idea may still be featured.</li><li>Clearly state Profit Target and Stop Loss areas if you are making a prediction. This significantly helps others understand what you meant.</li><li>Presentation is important. Too much clutter adds to confusion.</li></ul><p>In short, the more understandable and interesting your ideas are, the more you’ll gain respect of others and get discovered by the financial community. We’ll do our best to help showcase good ideas.</p><p>Some authors that we recommend get marked as <b>Suggested Authors</b>, and their ideas get posted to the front page automatically. The basis for recommending authors is multiple factors, which include a large number of interesting ideas. A suggested author has a corresponding badge in their profile.</p><div class="caption-text"><input id="tv-dialog-donotshow-checkbox" type="checkbox" name="donotshow"{{#do_not_show}} checked="checked"{{/do_not_show}}/><span class="tv-dialog-checkbox-mask donotshow{{#do_not_show}} tv-dialog-checkbox-mask-active{{/do_not_show}}"></span> <label for="tv-dialog-donotshow-checkbox"><strong>Do not show this message again</strong></label></div><div class="tv-dialogs-bottom-button"><a class="tv-dialog-button-blue tv-left" id="publish-intro-continue">CONTINUE</a></div></div>',publishChartWidget:'<div class="main"><form id="publish-chart-form" autocomplete="off"><div class="caption first">IDEA TITLE AND DESCRIPTION*</div><div class="publish-text"><input type="text" name="name" maxlength="64" placeholder="A clear title that describes your idea. Don\'t just write &ldquo;MSFT&rdquo; or &ldquo;MSFT Short&rdquo;."/></div><div class="empty-caption"></div><div class="publish-text autowidth"><textarea name="description" placeholder="Describe what you think and WHY you think that. Good fundamental analysis always helps. Put yourself in reader\'s shoes and see if you\'d understand the context based on what you wrote. Clearly state Profit Target and Stop Loss areas if you are making a prediction. This significantly helps others understand what you meant."></textarea></div><div class="empty-caption"></div><input type="hidden" name="tags"/><div class="publish-direction-buttons clearfix"><div class="col-short"><a class="tv-button short" data-val="2">SHORT</a></div><div class="col-long"><a class="tv-button long" data-val="1">LONG</a></div><div class="col-neutral"><a class="tv-button neutral active" data-val="0">NEUTRAL</a></div></div><div class="tv-dialogs-bottom-button"><a class="tv-dialog-button-blue tv-right" id="publish-dialog-do-publish">{{^editMode}}PUBLISH IDEA{{/editMode}}{{#editMode}}EDIT IDEA{{/editMode}}</a><span class="tv-dialog-layoutpicker tv-right"></span><span class="tv-dialog-cancel-button tv-right">Cancel</span></div><input type="hidden" name="direction" value="0"/></form></div>',publishChart:'<div class="main"><form id="publish-chart-form" autocomplete="off"><div class="caption first">IDEA TITLE AND DESCRIPTION*</div><div class="publish-text"><input type="text" name="name" maxlength="64" placeholder="A clear title that describes your idea. Don\'t just write &ldquo;MSFT&rdquo; or &ldquo;MSFT Short&rdquo;."/></div><div class="empty-caption"></div><div class="bbcode-buttons clearfix"><span tabindex="-1" class="bbcode-button bb-bold"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="29"><path d="M12.699 7.579h3.916c3.797-.089 5.041.962 5.151 3.896.072 1.909-1.75 2.441-2.622 2.598v.098c2.103.358 3.155 1.283 3.154 3.311-.002 3.047-2.479 3.925-4.766 3.945h-4.834zm1.611 5.928c2.418.132 5.948.008 5.85-2.344-.11-2.632-3.385-2.242-5.85-2.197zm0 1.367v5.176c2.514.154 6.377.26 6.26-2.676-.104-2.597-3.656-2.5-6.26-2.5z"/></svg></span><span tabindex="-1" class="bbcode-button bb-italic"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="29"><path d="M15.624 7.579l-.28 1.281h2.563l-2.463 11.25h-2.563l-.287 1.313h6.782l.287-1.313h-2.594l2.463-11.25h2.594l.28-1.281h-6.782z"/></svg></span><span tabindex="-1" class="bbcode-button bb-list"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="29"><path d="M8 8h2v2h-2zM8 13h2v2h-2zM8 18h2v2h-2zM14 8h12v2h-12zM14 13h13v2h-13zM14 18h9v2h-9z"/></svg></span><span tabindex="-1" class="bbcode-button bb-embed"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="29"><path d="M26.516 6.394a.85.85 0 0 0-.594.438l-6.719 11.094-4.406-5.469.031-.156c0-.713-.569-1.313-1.281-1.313-.713 0-1.281.6-1.281 1.313l.031.125-4.313 6.688a.85.85 0 1 0 1.438.906l4.125-6.438 4.406 5.5-.031.125c0 .713.569 1.313 1.281 1.313.713 0 1.281-.6 1.281-1.313v-.063l6.906-11.437a.85.85 0 0 0-.781-1.313.85.85 0 0 0-.094 0z"/></svg></span><div class="bbcode-embed-block"><div class="bbcode-embed-form"><input type="text" class="embed" disabled><span class="tv-dialog-button-blue embed-submit">Insert</span></div></div></div><div class="publish-text autowidth jsfluid"><textarea name="description" placeholder="Describe what you think and WHY you think that. Good fundamental analysis always helps. Put yourself in reader\'s shoes and see if you\'d understand the context based on what you wrote. Clearly state Profit Target and Stop Loss areas if you are making a prediction. This significantly helps others understand what you meant."></textarea></div>{{^editMode}}<div class="empty-caption"></div><div class="publish-direction-buttons clearfix"><div class="col-short"><a class="tv-button short" data-val="2">SHORT</a></div><div class="col-long"><a class="tv-button long" data-val="1">LONG</a></div><div class="col-neutral"><a class="tv-button neutral active" data-val="0">NEUTRAL</a></div></div>{{/editMode}}<div class="caption">LINK TO RELATED IDEAS</div><input class="publish-related" placeholder="Pick your idea or paste url to someone\'s else idea."><div class="caption">TAGS</div><input class="publish-tags"><div class="tv-dialogs-bottom-button">{{^editMode}}<label class="publish-dialog-privacy tv-right" title="Private Chart Publishing"><input name="public" type="checkbox" checked="checked"/><span class="publish-dialog-privacy-icon"></span></label>{{/editMode}}<a class="tv-dialog-button-blue tv-right" id="publish-dialog-do-publish">{{^editMode}}PUBLISH IDEA{{/editMode}}{{#editMode}}EDIT IDEA{{/editMode}}</a>{{^editMode}}<span class="tv-dialog-layoutpicker tv-right"></span>{{/editMode}}<span class="tv-dialog-cancel-button tv-right">Cancel</span>{{^editMode}}<div class="tv-left repost-to"><span class="repost-to-label">Repost to</span><input id="tv-dialog-twitter-checkbox" type="checkbox" name="twitter"{{#has_twitter}} checked="checked"{{/has_twitter}}/><label for="tv-dialog-twitter-checkbox" class="repost-to-twitter"><span class="icon"></span></label><input id="tv-dialog-stocktwits-checkbox" type="checkbox" name="stocktwits"{{^has_twitter}}{{#has_stocktwits}} checked="checked"{{/has_stocktwits}}{{/has_twitter}}/><label for="tv-dialog-stocktwits-checkbox" class="repost-to-stocktwits"><span class="icon"></span></label><div class="clear"></div></div>{{/editMode}}</div><input type="hidden" name="direction" value="0"/></form></div>',goPro:{layout:'<div class="col-main"><div class="col-copy"></div><div class="actions-block"><a class="no-button">No, thank you</a>{{^exchangesButton}}{{^trialButton}}<a href="/gopro/" target="_blank" class="yes-button">Upgrade now<span class="arrow-icon"></span></a>{{/trialButton}}{{#trialButton}}<a href="/gopro/" target="_blank" class="yes-button">30 Day Free Trial</a>{{/trialButton}}{{/exchangesButton}}{{#exchangesButton}}<a href="/gopro/" target="_blank" class="yes-button" onclick="pro.visitExchangesPage({newWindow: true}); return false;">Add real-time markets</a>{{/exchangesButton}}</div></div><div class="col-aside"><div class="col-bg"></div><div class="col-copy"><h2>Why <em>Go Pro</em>?</h2><ul><li>Official real-time &amp; intraday data</li><li>Intraday Renko, Kagi, Line Break, PnF charts</li><li>Intraday Spread Charts</li><li>Volume Profile Indicators</li><li>Custom Intervals</li><li>Unlimited saved charts</li><li>Multiple Watch Lists</li><li>Hot Lists</li><li>PRO Badge &amp; Adding Value</li><li>Extended Trading Hours</li><li>Multiple Charts Layout</li><li>Unlimited number of indicators on a chart</li></ul></div></div><div class="clear"></div>',defaultCopy:"<h2>Upgrade your account</h2><p>This functionality is available only to PRO users.</p><p>Please consider subscribing to our PRO service which includes many other features not available in the free membership.</p>",features:{proRtSymbol:"<h2>Official AMEX, NYSE&nbsp;&amp; NASDAQ Real-time Data</h2><p>You requested a symbol that is available only to PRO Plus and Premium users. You will now be switched to the equivalent BATS symbol.</p><p>NASDAQ and NYSE charge exchange and per-user fees, which means we can’t give this for free to everyone (as much as we'd love&nbsp;to). Our free feed is provided by BATS electronic exchange, which offers approximate volumes and prices with fewer updates.</p><p>If you need only the most complete and accurate data, then consider subscribing to the PRO Plus or Premium service from only $19.95/m that offers actual real-time data from the NYSE/NASDAQ/AMEX exchanges and much more.</p>",kagiRenko:"<h2>Renko, Kagi, Line Break, Point&nbsp;&amp;&nbsp;Figure</h2><p>Only PRO Plus and Premium subscribers can access intraday Renko, Kagi, Line Break, Point & Figure charts. You will now be switched to a Daily (D) interval.</p><p>Intraday Renko, Kagi, Line Break and Point & Figure charts take considerable resources, so we can't give them out for free to everyone (as much as we'd like&nbsp;to). We can, however, give out these charts for free in the Daily and Weekly resolutions.</p><p>If you do intraday analysis consider subscribing to PRO Plus or Premium service from only $19.95/m.</p>",hotLists:"<h2>Hot Lists</h2><p>You requested a hotlist that is available only to PRO users.</p><p>HotLists continuously scan the US stock market to identify best trading opportunities and take considerable resources, so we can't give them out for free to everyone (as much as we'd like&nbsp;to).</p><p>If you want to identify opportunities in an efficient manner, consider subscribing to our PRO service for only $9.95/m. This subscription includes many other features not available in the free membership.</p>",intradaySpread:"<h2>Intraday Spread</h2><p>You requested an intraday spread symbol that is available only to PRO Plus and Premium users. You will now be switched to a Daily (D) interval.</p><p>Spreads for intraday charts are calculated based on 1-minute bars, and then recompiled into the selected interval. This approach is the only correct one, but requires significant server power. This means we can't give spread charts for free to everyone (as much as we'd like&nbsp;to).</p><p>If you do intraday spread analysis consider subscribing to PRO Plus or Premium service from only $19.95/m.</p>",customIntervals:"<h2>Custom Intervals</h2><p>You requested a custom interval that is available only to PRO&nbsp;users.</p><p>This feature allows you to create any chart, such as 7&nbsp;minutes, 12&nbsp;minutes, or 8&nbsp;hours. If you want to identify opportunities on custom intervals in an efficient manner, consider subscribing to our PRO service for only $9.95/m. This subscription includes many other features not available in the free membership.</p>",multipleWatchLists:"<h2>Multiple Watch Lists</h2><p>Multiple Watch Lists available only to  PRO users.</p><p>Any custom watchlist can be saved under a unique name and loaded at any time with one click. All lists are available from any computer, so you have your workspace wherever you go.</p><p>If you want to use different watchlists to quickly assess different sectors of the market, consider subscribing to our PRO service for only $9.95/m. This subscription includes many other features not available in the free membership.</p>",extendedHours:"<h2>Extended Trading Hours</h2><p>Only PRO Plus and Premium subscibers can access extended hours data on the charts.  Extended trading hours include both pre-market and after hours sessions each day the market is open.</p><p>If you want to act quickly to news and events that occur when the regular market is closed, please consider subscribing to PRO Plus or Premium service from only $19.95/m.</p>",multipleCharts:"<h2>Multiple Charts Layout</h2><p>Multiple Charts Layout available only to PRO users.</p><p>You can plot up to 8 charts in one tab of your browser. Moreover, it’s possible to link your charts by resolutions or symbols. And even use global cursor that synchronizes many charts.</p><p>If you want to unlock the power of multiple time frame analysis and add multiple symbols to the same chart layout, consider subscribing to our PRO service for only $9.95/m. This subscription includes many other features not available in the free membership.</p>",alerts:"<h2>Unlimited server-side alerts</h2><p>You already set {{options.maxAlertsNumber}} alerts. Upgrade to PRO Plus to set unlimited custom alerts and improve your experience!</p><p>TradingView alerts run on powerful and backed-up servers, so you’ll always get notified when something happens and won’t miss a beat. This takes considerable resources, so we can't give an unlimited number of alerts to everyone for free (as much as we'd like to).</p><p>Become a PRO Plus user for just $19.95 and get unlimited alerts! You also get a ton of other useful features, like multiple charts on the same screen, custom chart timeframe like 3-min charts, and our sincere thanks!</p>",intradayExchange:"<h2>Official real-time, intraday and volume data</h2><p>Only PRO, PRO Plus and Premium users that have a subscription to {{exchange}} Exchange can get official data on real-time prices, volume and intraday history. You'll now be switched to the Daily (D) interval, which is available to all users.</p><p>Exchanges charge per-user fees and redistribution fees from TradingView for delivery of intraday and real-time data. So, we can't give this data for free to everyone (as much as we'd like to).</p><p>If you do intraday analysis, consider subscribing to the {{exchange}} exchange.{{^exchangesButton}} You must subscribe to PRO, PRO Plus or Premium service first (from only 9.95/m).{{/exchangesButton}}</p>",savedChartsLimit:"<h2>Unlimited Saved Charts</h2><p>You can save up to 5 charts with your subscription. Upgrade to PRO, PRO Plus or Premium  membership and save unlimited charts, along with many other exciting features. Starting from only $9.95 a month - upgrade today!</p>",studyLimit:"<h2>Unlimited number of indicators on a chart</h2><p>Your free account allows you to apply up to 10 studies to a chart. Upgrade to PRO, PRO Plus or Premium account to have as many studies on a chart as you want, as well as many other exciting features.</p><p>We are happy to give away as many things for free as possible, however studies are server-based and this takes considerable resources. So we can't give an unlimited number of indicators to everyone for free (as much as we'd like to).</p><p>Become a Pro user for just $9.95 and get unlimited studies! You also get a ton of other useful features, like multiple charts on the same screen, custom chart timeframe like 3-min charts, and our sincere thanks because you support further development of TradingView!</p>",savedChartsForAlertLimit:"<h2>Unlimited Saved Charts</h2><p>To set an alert on a drawing requires the chart to be saved. Unfortunately you have already saved 5 charts. Upgrade to PRO, PRO Plus or Premium  account and save as many charts as you want, along with many other exciting features. Starts from only $9.95 a month - upgrade today!</p>"}},addSymbol:' <div class="main"> <div class="symbol-edit-place"></div>{{#overlayOption}} <div class="tv-dialog-relative">	<input id="tv-dialog-addsymbol-overlay-checkbox" type="checkbox" name="addsymbol-overlay" {{#overlayOptionChecked}}checked="checked"{{/overlayOptionChecked}} />	<span class="tv-dialog-checkbox-mask tv-dialog-checkbox-mask{{#overlayOptionChecked}}-active{{/overlayOptionChecked}}"></span>	<label for="tv-dialog-addsymbol-overlay-checkbox"> Overlay the main chart</label> </div>{{/overlayOption}} <div class="tv-dialogs-bottom-button"> <span class="tv-button tv-right tv-uppercase ok">{{okButtonTitle}}</span> </div> </div>',billingCycleSelection:'<div class="main billing-cycle-dialog"><div class="bcd-title">Subscription Plans</div><div class="bcd-subtitle">You\'re subscribing to {{ product_title }}</div><div class="bcd-choice-container clearfix"><div class="bcd-choice active" data-cycle="y"><div class="bcd-choice-bg"></div><div class="bcd-choice-marker"></div><div class="bcd-choice-copy"><h5>Buy Annual</h5><div class="bcd-prices"><p>${{price_1_m}} per month</p><p>${{price_1_y}} per year</p><p>Save ${{savings}}</p><p>No monthly invoices</p></div></div></div><div class="bcd-choice" data-cycle="m"><div class="bcd-choice-bg"></div><div class="bcd-choice-marker"></div><div class="bcd-choice-copy"><h5>Buy Monthly</h5><div class="bcd-prices"><p>${{price_2_m}} per month</p><p>${{price_2_y}} per year</p><p>Invoiced every month</p></div></div></div></div><div class="bcd-continue"><a class="bcd-continue-button">Continue</a></div></div>',symbolSearch:'<div class="symbol-block"><div class="spread-actions"></div><div class="symbol-block-inputspacer"><input maxlength="'+TradingView.SYMBOL_SEARCH_MAX_LENGTH+'" /><div class="search-cion"></div></div></div><div class="filter"></div><div class="results"></div>',proRTTrialOffer:'<div class="main"><h3>Your Personal Invitation to&nbsp;Go&nbsp;PRO Plus</h3><p>For a limited time, we’re offering a <strong>FREE 1 month</strong> subscription of PRO Plus (no credit card required, no catches or hidden autobilling).</p><p>Our PRO Plus users see amazing benefits. You get advanced trading opportunities using multi symbol statistical arbitrage techniques. <a href="/gopro/" target="_blank">Read more about PRO Plus features</a>.</p><div class="big-buttons two-buttons"><a href="javascript://" class="big-button trial">Activate Offer and GO PRO</a><a href="javascript://" class="big-button nothanks">No, thank you</a></div></div>',earlyAccess:'<div class="main"><h3>Early Access 50% off{{#is_finished}}&nbsp;&ndash; Final&nbsp;chance{{/is_finished}}</h3>{{#is_1wk}}<p>So&hellip; You’ve had free PRO Plus for a week now. Seeing the advantages?</p><ul><li>Multiple charts layout and watch lists</li><li>Custom intervals and unlimited alerts</li><li>Intraday Renko, Kagi, Line Break, PnF and spread charts</li><li>Volume profile indicators and extended trading hours</li></ul><p>If you like what you see, you have an exclusive chance to get <strong>12&nbsp;months for only $179.4</strong>. That’s less than $15/month and 50% off regular month-to-month payments.</p><p>Do you want to take advantage of this offer now?</p>{{/is_1wk}}{{#is_2wk}}<p>Oh no! You have only 2&nbsp;weeks left in your PRO Plus trial! These benefits will expire in two short weeks:</p><ul><li>Multiple charts layout and watch lists</li><li>Custom intervals and unlimited alerts</li><li>Intraday Renko, Kagi, Line Break, PnF and spread charts</li><li>Volume profile indicators and extended trading hours</li></ul><p>Just for you, we made a special deal that lets you continue for another <strong>12&nbsp;months for only $179.4</strong>. That’s less than $15/month and 50% off regular month-to-month payments.</p><p><strong>Low price available now&nbsp;&ndash; don’t miss this chance!</strong></p>{{/is_2wk}}{{#is_finished}}<p>Don’t cry&hellip; but your free PRO Plus trial has ended! We hope you benefited from useful features and felt good about yourself for supporting the community.</p><p>Now is your <strong>LAST and FINAL</strong> chance to get 12&nbsp;months for <strong>only $179.4</strong> (regular $360). That’s less than $15/month and 50% off regular month-to-month payments.</p><p>Remember, with PRO Plus you benefit from:</p><ul><li>Multiple charts layout and watch lists</li><li>Custom intervals and unlimited alerts</li><li>Intraday Renko, Kagi, Line Break, PnF and spread charts</li><li>Volume profile indicators and extended trading hours</li></ul><p>Don’t miss the last chance to get the special Early Access and secure this low rate! <strong>Act now!</strong></p>{{/is_finished}}{{#is_manual}}<p>Upgrade and get 50% off regular month-to-month payments!</p><p>Just for you, we made a special deal that lets you continue for another 12&nbsp;months for <strong>only $179.4</strong>. That is less than $15/month. Don’t miss the last chance to get the special Early Access and secure this low rate! Act now!</p><p>Remember, with PRO Plus you benefit from:</p><ul><li>Multiple charts layout and watch lists</li><li>Custom intervals and unlimited alerts</li><li>Intraday Renko, Kagi, Line Break, PnF and spread charts</li><li>Volume profile indicators and extended trading hours</li></ul>{{/is_manual}}<div class="big-buttons"><a href="javascript://" class="big-button ordernow">Early Access for $15/Month</a></div><div class="more-controls"><a href="javascript://" class="nothanks">No, thank you</a></div></div>',auth:'<div class="main"><h2 class="auth-dialog-title"><span class="">Sign Up</span></h2><div class=""><div class="auth-dialog-socials"><a class="auth-dialog-social-facebook">Facebook</a><a class="auth-dialog-social-twitter">Twitter</a><a class="auth-dialog-social-google">Google+</a><a class="auth-dialog-social-stocktwits">StockTwits</a><a class="auth-dialog-social-linkedin">Linked In</a><a class="auth-dialog-social-yahoo">Yahoo!</a></div><div class="auth-dialog-separator"><span class="auth-dialog-separator-copy">Or</span></div></div><div class=""><form id="signup-form" action="/accounts/signup/"><label class="auth-dialog-field"><input name="email" type="text"><span class="auth-dialog-field-placeholder">E-mail</span></label><label class="auth-dialog-field"><input name="username" type="text"><span class="auth-dialog-field-placeholder">Username</span></label><label class="auth-dialog-field"><input name="password" type="password"><span class="auth-dialog-field-placeholder">Password</span></label><input type="hidden" name="signup_trial" value="0"><div class="auth-dialog-notice"><p>By clicking on &ldquo;Sign Up&rdquo; below, you are agreeing to the <a href="/policies/" target="_blank">Terms of Service</a>.</p><p>Note: e-mail will not be publicly displayed.</p></div><div class="auth-dialog-submit"><button class="" type="submit">Sign Up</button></div></form><div class="auth-dialog-footnote">Already have an account? <a class="signin-link">Sign in</a></div></div></div>',signin:'<div class="main"><h2 class="auth-dialog-title"><span class="show-if-signin">Sign In</span></h2><div class=""><div class="auth-dialog-socials"><a class="auth-dialog-social-facebook">Facebook</a><a class="auth-dialog-social-twitter">Twitter</a><a class="auth-dialog-social-google">Google+</a><a class="auth-dialog-social-stocktwits">StockTwits</a><a class="auth-dialog-social-linkedin">Linked In</a><a class="auth-dialog-social-yahoo">Yahoo!</a></div><div class="auth-dialog-separator"><span class="auth-dialog-separator-copy">Or</span></div></div><div class=""><form id="signin-form" action="/accounts/signin/"><label class="auth-dialog-field"><input name="username" type="text"><span class="auth-dialog-field-placeholder">Username</span></label><label class="auth-dialog-field"><input name="password" type="password"><span class="auth-dialog-field-placeholder">Password</span></label><div class="auth-dialog-group"><label class="auth-dialog-remember"><span class="auth-dialog-remember-pseudo"><input type="checkbox" name="remember" checked /><i class="auth-dialog-remember-view"></i></span><span class="auth-dialog-remember-text">Remember me</span></label><a class="auth-dialog-recover recover-link">Forgot password?</a></div><div class="auth-dialog-submit"><button type="submit">Sign In</button></div></form><div class="auth-dialog-footnote">If you don\'t have an account, <a class="signup-link">Sign&nbsp;up</a></div></div></div>',recover:'<div class="main"><h2 class="auth-dialog-title recover"><span class="">Recover Password</span></h2><div class=""><form id="recover-form" action="/accounts/forgot_password/"><label class="auth-dialog-field"><input name="email" type="text"><span class="auth-dialog-field-placeholder">E-mail</span></label><div class="auth-dialog-submit"><button type="submit">Recover</button></div></form></div></div>'},lists:{savedCharts:"<ul>{{#charts}}<li><a href='/e/{{url}}/'><span class='name'>{{name}}</span> <span class='subscript'>{{modified}}{{#short_symbol}} | {{short_symbol}}{{#interval}}, {{interval}}{{/interval}}{{/short_symbol}}</span> <span class='icon icon-carousel-item-delete-dark' title='Delete' data-id='{{url}}'></span></a></li>{{/charts}}</ul>"},userlink:"<a href='/u/{{username}}/' class='userlink'>{{username}}</a>{{> userBadge}}",userBadge:"{{#is_top}}{{> topBadge}}{{/is_top}}{{^is_top}}{{#is_moderator}}{{> modBadge}}{{/is_moderator}}{{^is_moderator}}{{#is_pro}}{{> proBadge}}{{/is_pro}}{{/is_moderator}}{{/is_top}}",proBadge:'<{{badge_tag}}{{^badge_tag}}a href="/gopro/"{{/badge_tag}} class="apply-common-tooltip user-badge pro{{#is_realtime}} realtime{{/is_realtime}}{{#is_premium}} premium{{/is_premium}}{{#is_trial}} trial{{/is_trial}}{{#large_badge}} large{{/large_badge}}" title="{{#is_realtime}}Pro Realtime{{/is_realtime}}{{#is_premium}}Premium{{/is_premium}}{{#is_trial}}Pro Trial{{/is_trial}}{{^is_realtime}}{{^is_premium}}{{^is_trial}}Pro{{/is_trial}}{{/is_premium}}{{/is_realtime}}">pro</{{badge_tag}}{{^badge_tag}}a{{/badge_tag}}>',
modBadge:"<{{badge_tag}}{{^badge_tag}}a href='/house-rules/'{{/badge_tag}} class='user-badge mod{{#large_badge}} large{{/large_badge}} apply-common-tooltip' title='Moderator'>mod</{{badge_tag}}{{^badge_tag}}a{{/badge_tag}}>",topBadge:"<{{badge_tag}}{{^badge_tag}}a href='/people/'{{/badge_tag}} class='user-badge top{{#large_badge}} large{{/large_badge}} {{badge_class}} apply-common-tooltip' title='{{badge_title}}'>top</{{badge_tag}}{{^badge_tag}}a{{/badge_tag}}>",chartBadges:'{{#is_hot}}<span class="icon icon-chart-recommended" title="Suggested Chart"></span>{{/is_hot}}',iconedFollowSymbolButton:'{{#pro_symbol}}<button class="follow-symbol iconed{{#current_user_follows_symbol}} active{{/current_user_follows_symbol}}" data-symbol="{{pro_symbol}}" title="Follow {{pro_symbol}}"></button>{{/pro_symbol}}',globalNotification:'<div class="tv-global-notification" id="global-notification-{{ id }}"><div class="tv-layout-width"><span class="icon icon-notification-info"></span>{{{ text }}}</div><span class="global-notification-close"><i class="icon icon-notification-close"></i></span></div>',actionsLog:'<div class="entry"><b>{{#is_system}}<img src="/static/images/small-logo.png" class="log-system-message"/>system{{/is_system}}{{^is_system}}<a href="/u/{{username}}" target="_blank">{{username}}</a>{{/is_system}}</b><div class="entry-time time-upd">{{ created_timestamp }}</div> <div class="message">{{{text}}}</div></div>',onChartMessage:'<div class="onchart-message"><span class="onchart-message-close"></span><div class="onchart-message-top"><div class="onchart-message-copy"></div></div><div class="onchart-message-bottom"><div class="onchart-message-ear"></div></div></div>',userlinkPopup:'<div class="msg-userlink-popup" data-id="{{ id }}"><div class="msg-userlink-popup-container"><a class="userpic" href="/u/{{ username }}/"><img class="userpic" src="{{#has_picture}}{{big_picture_url}}{{/has_picture}}{{^has_picture}}{{mid_picture_url}}{{/has_picture}}"/></a><div class="content"><div class="username">{{> userlink}}<span class="btc-tip"></span></div><div class="user-stats-small"><span class="user-stats-followers" title="Followers">{{followers_count}}</span><span class="user-stats-charts" title="Charts">{{charts_count}}</span><span class="user-stats-reputation" title="Reputation">{{reputation}}</span></div>{{^is_self}}<div class="action-buttons"><button class="follow-user follow-user-{{ id }}{{#follow_status}} active{{/follow_status}}" title="{{#follow_status}}Unfollow{{/follow_status}}{{^follow_status}}Follow{{/follow_status}}" data-id="{{ id }}"><span class="follow">Follow</span><span class="following">Followed</span><span class="unfollow">Unfollow</span></button> <button class="message-user message active" title="Send message" data-username="{{ username }}" data-id="{{ id }}"><span class="message">Message</span></button></div>{{/is_self}}</div><div class="clear"></div>{{#status}}<div class="user-status">{{status}}</div>{{/status}}<div class="send-form"><p>To: <strong>{{ username }}</strong></p><p><textarea name="message-text"></textarea></p><p class="actions"><button class="message-user active send">Send</button><button class="message-user cancel">Cancel</button></p></div></div></div>',miniWidgetWizardAddSymbol:'<tr class="symbol-item"><td>{{symbol}}</td><td>{{description}}</td><td>{{timeframe}}</td><td><div class="remove-symbol"></div></td></tr>',userInfoWidgetButtons1:'<div class="buttons layout-2-buttons"><button class="profile-action profile-edit" data-id="{{ id }}" data-username="{{ username }}" title="Edit profile"><span class="">Edit</span></button><button class="profile-action profile-signout" title="Sign out" onclick="signOut(); return false;"><span class="">Sign out</span></button><div class="clear"></div></div>',userInfoWidgetButtons2:'<div class="buttons layout-1-buttons"><button class="follow-user {{ is_followed_css }} follow-user-{{ id }}" data-id="{{ id }}"><span class="follow" title="Follow"></span><span class="following" title="Following"></span><span class="unfollow" title="Unfollow"></span></button><div class="clear"></div></div>',userInfoWidgetButtons3:'<div class="buttons layout-1-buttons"><button class="profile-action profile-signin" title="Sign in" onclick="runOrSignIn(function() {}); return false;"><span class="">Sign in</span></button><div class="clear"></div></div>'},TradingView.postMessageWrapper=function(){var e,t={},i={},n={},o=0,r=0;return window.addEventListener&&window.addEventListener("message",function(n){var o;try{o=JSON.parse(n.data),W77.enabled("charting_library_debug_mode")&&console.log("PostMessage: incoming message: "+JSON.stringify(o))}catch(r){return}o.provider&&"TradingView"==o.provider&&("get"==o.type&&i[o.name]?i[o.name].call(o,o.data,function(t){e.postMessage(JSON.stringify({id:o.id,type:"on",name:o.name,client_id:o.client_id,data:t,provider:"TradingView"}),"*")}):"on"==o.type?t[o.client_id]&&t[o.client_id][o.id]&&(t[o.client_id][o.id].call(o,o.data),delete t[o.client_id][o.id]):"post"==o.type&&"function"==typeof i[o.name]&&i[o.name].call(o,o.data,function(){}))}),function(s,a){return t[a]={},e=n[a]=s,postClientId="",{on:function(e,t){i[e]=t},get:function(e,i,r){e={id:o++,type:"get",name:e,client_id:a,data:i,provider:"TradingView"},t[a][e.id]=r,n[a].postMessage(JSON.stringify(e),"*")},post:function(e,t,i){t={id:r++,type:"post",name:t,client_id:postClientId,data:i,provider:"TradingView"},e&&"function"==typeof e.postMessage&&e.postMessage(JSON.stringify(t),"*")},setClientId:function(e){postClientId=e}}}}(),TradingView.QuoteTabbedWidget=function(e,t,i){this._id=e,this.$container=t,this._tabs=i||t.data("quoteTabs"),this.visible=new WatchedValue(!0),this.animationInProcess=new WatchedValue(!0),this._init()},TradingView.QuoteTabbedWidget.prototype._init=function(){var e=this;e.$container.empty(),e.$container.addClass("quote-tabbed-widget");var t=e.$tabs=$('<div class="tabs"></div>'),i=e.$pages=$('<div class="pages"></div>');e._tabs.forEach(function(e){e.symbols=$.map(e.symbols||[],function(e){return e.last&&e.pctchange&&e.pctchangedir?("down"===e.pctchangedir?e.changeColor=PriceColorer.formatSign(-1):"up"===e.pctchangedir&&(e.changeColor=PriceColorer.formatSign(1)),e):("undefined"!=typeof e.last&&delete e.last,"undefined"!=typeof e.pctchange&&delete e.pctchange,"undefined"!=typeof e.pctchangedir&&delete e.pctchangedir,e)}),t.append(Mustache.render('<div class="tab">{{title}}</div>',e)),e=$(Mustache.render('<div class="page-wrapper"><div class="page"><table>{{#symbols}}<tr data-symbol={{symbol_full}} {{^last}}data-need-quote-ticker=true{{/last}}><td class="name"><a href="/chart/{{symbol_full}}/" data-symbol={{symbol_full}} class="chart-link{{^symbol}} symbol-short-name{{/symbol}}">{{#symbol}}{{symbol}}{{/symbol}}</a></td><td class="ticker"><span class="symbol-last">{{last}}</span>&nbsp;<span class="symbol-change-pt" {{#changeColor}}style="color: {{changeColor}} "{{/changeColor}}>{{#pctchange}}({{pctchange}}){{/pctchange}}</span></td><td class="chart-cell"><a href="/e/?symbol={{symbol_full}}" class="chart"></a></td></tr>{{/symbols}}</table></div></div>',e)),i.append(e)});var n=new A71(t,i,{saveTab:this._activeTabKey()});e._onTabChanged(n.index()),n.tabChanged.subscribe(e,e._onTabChanged);var o=$('<div class="tabs-wrapper"></div>');t.appendTo(o),e.$container.append(o),e.$container.append(i),e.visible.subscribe(function(t){e.$pages.children().each(function(i){i=t?n.index()===i:!1,e._setPageActive($(this),i,!0)})}),e.animationInProcess.subscribe(function(t){e.$pages.children().each(function(i){(i=$(this).data("chart"))&&(t?i.unbindOnResize():e.visible.value()&&i.bindOnResize())})})},TradingView.QuoteTabbedWidget.prototype._onTabChanged=function(e){var t=this;t.$pages.children().each(function(i){t._setPageActive($(this),e===i)})},TradingView.QuoteTabbedWidget.prototype._setPageActive=function(e,t,i){function n(){e.find("tr").each(function(t){t=$(this);var i=t.data("symbol");if(i){if(t.data("quoteTicker"))t.data("quoteTicker").enabled=!0;else if(t.data("needQuoteTicker")){var n=new TradingView.QuoteTicker(i,t,{changePercentInBrackets:!0});t.data("quoteTicker",n)}t.data("chart")?t.data("chart").connect():(i=new TradingView.MiniChart(i,t.find(".chart"),{minHeight:18,showMessage:!1,onlyLastBars:30,timeframe:{value:"1m"},chartOptions:{grid:{xIsVisible:!1,yIsVisible:!1},xScale:{visible:!1},yScale:{visible:!1},plot:{line:{color:"#2e5c75",width:1},belowLineFillStyle:"rgba(46,94,117, 0.2)"}}}),e.resize(i.widget.onResize),t.data("chart",i))}})}function o(){e.find("tr").each(function(e){e=$(this),e.data("quoteTicker")&&(e.data("quoteTicker").enabled=!1),e.data("chart")&&e.data("chart").disconnect()})}t?(clearTimeout(e.data("turnOffTimeout")),n()):e.data("turnOffTimeout",setTimeout(function(){o()},1e3*(i?0:60)))},TradingView.QuoteTabbedWidget.prototype._activeTabKey=function(){return"undefined"!=typeof this._id?"marketsummary.quotestabbedwidget."+this._id+".activetabindex":null},$(function(){var e=$("#market-summary-header"),t=$("#market-summary-body");e.length&&t.length&&(TradingView.marketSummary=new TradingView.MarketSummary(e,t))}),TradingView.MarketSummary=function(e,t){this.$button=$(".market-summary-toggle"),this.$header=e,this.$body=t,this.animationInProcess=new WatchedValue(!1),this.bodyIsVisible=new WatchedValue(!1),this.toggled=new Delegate,this.initHeader(),this.$button.click(this.toggle.bind(this)),IS_OPENED_BY_DEAFAULT=!0,this.toggle(TVSettings.getBool("marketsummary.opened",IS_OPENED_BY_DEAFAULT)),loginStateChange.subscribe(this,function(){is_authenticated&&this.toggle(TVSettings.getBool("marketsummary.opened",IS_OPENED_BY_DEAFAULT))})},TradingView.MarketSummary.POPULAR_QUOTES_TABED_WIDGET=0,TradingView.MarketSummary.ACTIVE_QUOTES_TABED_WIDGET=1,TradingView.MarketSummary.prototype.initHeader=function(){this._initQouteTickers(),this._bindChartSearchToLinks()},TradingView.MarketSummary.prototype.toggle=function(e){function t(){i.animationInProcess.setValue(!1),i.toggled.fire(n)}var i=this;if(!i.animationInProcess.value()){i.animationInProcess.setValue(!0),i.$button.toggleClass("opened",e);var n=i.$button.hasClass("opened");n?i.$body.slideDown(function(){t(),i.chart()||i._initChart(),i.activeQuotes()||i._initActiveQuotes(),i.popularQuotes()||i._initPopularQuotes()}.bind(i)):i.$body.slideUp(t),i.bodyIsVisible.setValue(n),TVSettings.setValue("marketsummary.opened",n)}},TradingView.MarketSummary.prototype._initQouteTickers=function(){this.$header.find(".market-summary-quote-ticker").each(function(){var e=$(this);new TradingView.QuoteTicker(e.data("symbol"),e)})},TradingView.MarketSummary.prototype.chart=function(){return this._chart},TradingView.MarketSummary.prototype.activeQuotes=function(){return this._activeQuotes},TradingView.MarketSummary.prototype.popularQuotes=function(){return this._popularQuotes},TradingView.MarketSummary.prototype._initChart=function(){function e(e,t){"boolean"!=typeof t&&(t=!e.hasClass("chart-legend-colored"));var i=e.data();e.find("a").css("border-left-color",t?i.color:"transparent"),e.toggleClass("chart-legend-colored",t)}for(var t=this,i=[],n=t.$header.find(".market-summary-quote-ticker.chart-legend"),o=0;o<n.length;o++){var r=n.eq(o),s=r.data();i.push({symbol:s.symbol,options:{line:{color:s.color}}}),e(r,!0)}t._chart=new TradingView.MiniChart(i,t.$body.find(".tickers-chart"),{showMessage:!1,timeframe:{visible:!0,value:"5y"},showTimeframes:!0,chartOptions:{minHeight:18,grid:{xIsVisible:!1,yIsVisible:!0,line:{width:1,style:CanvasEx.LINESTYLE_DASHED,color:"#3a3b43"}},yScale:{visible:!0,position:"right",isPercentage:!0,paddingLeft:10,paddingRight:4,marginInPercents:10,font:{size:10,family:"Helvetica",color:"#57585d"},drawOverPlotArea:!1,drawTickMarkLine:!1,maxTickMarkAmount:5},xScale:{visible:!1},plot:{line:{width:2},belowLineFillStyle:"transparent",aboveLineFillStyle:"transparent"},loading:{showWhileNoPlots:!0}}}),t.bodyIsVisible.subscribe(function(i){i?t._chart.connect():t._chart.disconnect(),n.each(function(){e($(this),i)})}),t.animationInProcess.subscribe(function(e){e?t._chart.widget().unbindOnResize():t.bodyIsVisible.value()&&t._chart.widget().bindOnResize()})},TradingView.MarketSummary.prototype._initActiveQuotes=function(){this._activeQuotes=this._createQuotesWidget(TradingView.MarketSummary.ACTIVE_QUOTES_TABED_WIDGET,this.$body.find(".active-quotes"))},TradingView.MarketSummary.prototype._initPopularQuotes=function(){this._popularQuotes=this._createQuotesWidget(TradingView.MarketSummary.POPULAR_QUOTES_TABED_WIDGET,this.$body.find(".populars-quotes"))},TradingView.MarketSummary.prototype._createQuotesWidget=function(e,t){var i=new TradingView.QuoteTabbedWidget(e,t);return this.bodyIsVisible.subscribe(function(e){i.visible.setValue(e)}),this.animationInProcess.subscribe(function(e){i.animationInProcess.setValue(e)}),this._bindChartSearchToLinks(),i},TradingView.MarketSummary.prototype._bindChartSearchToLinks=function(e,t){this.$header.add(this.$body).find("a.chart-link:not(.inited)").addClass("inited").click(function(e){if(TradingView.searchCharts&&TradingView.searchCharts.queryField&&TradingView.searchCharts.form){var t=$(this).data("symbol");t&&(TradingView.searchCharts.queryField.val(t),TradingView.searchCharts.form.submit(),e.preventDefault())}})},TradingView.Symbology=function(){},TradingView.Symbology.prototype.convertTo=function(e,t,i){return e},TradingView.Symbology.prototype.convertFrom=function(e){return e},TradingView.YahooSymbology=function(){this.specialFromCases={};for(var e in this.specialCases)this.specialFromCases[this.specialCases[e]]=e;this.exchangeFromMap={};for(e in this.exchangeMap)this.exchangeFromMap[this.exchangeMap[e]]=e},inherit(TradingView.YahooSymbology,TradingView.Symbology),TradingView.YahooSymbology.prototype.convertTo=function(e,t,i){return e in this.specialCases?this.specialCases[e]:"forex"==t?e+"=X":"TSX"==i?e+".TO":"TSXV"==i?e+".V":"MICEX"==i?e+".ME":"COMEX"==i?e+".CMX":"CME"==i?e+".CME":"CBOT"==i?e+".CBT":"index"==t?"^"+e:e},TradingView.YahooSymbology.prototype.convertFrom=function(e){if(e in this.specialFromCases)return this.specialFromCases[e];var t=e.split("."),i=t[1];return i?(e=this.exchangeFromMap["."+i])?e+":"+t[0]:null:e},TradingView.YahooSymbology.prototype.exchangeFromMap={},TradingView.YahooSymbology.prototype.exchangeMap={TSX:".TO",TSXV:".V",MICEX:".ME",COMEX:".CMX",CME:".CME",CBOT:".CBT"},TradingView.YahooSymbology.prototype.specialFromCases={},TradingView.YahooSymbology.prototype.specialCases={ESP35:"^IBEX",FRA40:"^FCHI",GER30:"^GDAXI",JPN225:"^N225",NAS100:"^NDX",SPX500:"SPY",SUI30:"^SSMI",UK100:"^FTSE",FTSE:"^DJI",USDOLLAR:"^USDOLLAR",DOWI:"^DJI",DOWT:"^DJT",DOWU:"^DJU"},TradingView.StockTwitsSymbology=function(){},inherit(TradingView.StockTwitsSymbology,TradingView.Symbology),TradingView.StockTwitsSymbology.prototype.convertTo=function(e,t,i){return"futures"==t?e+"_F":e},TradingView.NewsProvider=function(e){if(!this.isValidProvider(e))throw new TypeError("Invalid provider: "+e);this._provider=new this.providers[e],this._baseURL=this._BASE_URL+e+"/"},TradingView.NewsProvider.prototype.isValidProvider=function(e){return e in this.providers},TradingView.NewsProvider.prototype.providers={yahoo:function(){this.symbology=new TradingView.YahooSymbology},stocktwits:function(){this.symbology=new TradingView.StockTwitsSymbology},fxwirepro:function(){this.symbology=new TradingView.Symbology,this.package_name="tv-fxwirepro",this.feed_realtime="fxwirepro_realtime",this.feed_delayed="fxwirepro_delayed"},futuresmag:function(){this.symbology=new TradingView.Symbology}},TradingView.NewsProvider.prototype._BASE_URL=W77.enabled("trading_terminal")?"https://www.tradingview.com/headlines/":"/headlines/",TradingView.NewsProvider.prototype.getURLforSymbol=function(e,t,i){return e=this.convertSymbol(e,t,i),this._baseURL+"symbol/"+e+"/"},TradingView.NewsProvider.prototype.convertSymbol=function(e,t,i){return this.getProvider().symbology.convertTo(e,t,i)},TradingView.NewsProvider.prototype.getURLforCategory=function(e){return this._baseURL+"category/"+e+"/"},TradingView.NewsProvider.prototype.getURLforSpread=function(e){return e=e.join(","),this._baseURL+"spread/"+e+"/"},TradingView.NewsProvider.prototype.getBySymbol=function(e,t,i){var n=this.getProvider(),o="",o=$.isFunction(n.getURLforSymbol)?n.getURLforSymbol(e,t,i):this.getURLforSymbol(e,t,i);return $.ajax(o,{type:"GET",dataType:"json"}).pipe(this._onReceived.bind(this))},TradingView.NewsProvider.prototype.getBySpread=function(e,t,i){var n=this.getProvider();e=e.map(function(e,n){return e=A68.ticker(e),n?e:this.convertSymbol(e,t,i)}.bind(this));var o="",o=$.isFunction(n.getURLforSpread)?n.getURLforSpread(e,t,i):this.getURLforSpread(e);return $.ajax(o,{type:"GET",dataType:"json"}).pipe(this._onReceived.bind(this))},TradingView.NewsProvider.prototype.getByCategory=function(e){var t=this.getProvider();return $.isFunction(t.getURLforCategory)?t.getURLforCategory(e):this.getURLforCategory(e),$.ajax(this.getURLforCategory(e),{type:"GET",dataType:"json"}).pipe(this._onReceived.bind(this))},TradingView.NewsProvider.prototype._onReceived=function(e){return e?(e.forEach(function(e){e.published=new Date(1e3*e.published)}),$.isFunction(this.getProvider().itemTransform)?e.map(this.getProvider().itemTransform,this._provider):e):void 0},TradingView.NewsProvider.prototype.init=function(e){var t=this.getProvider();$.isFunction(t.init)&&t.init(this,e)},TradingView.NewsProvider.prototype.update=function(e){$.isFunction(this.getProvider().update)&&this.getProvider().update(e)},TradingView.NewsProvider.prototype.destroy=function(){$.isFunction(this.getProvider().destroy)&&this.getProvider().destroy(),this.getProvider().$message instanceof $&&this.getProvider().$message.remove()},TradingView.NewsProvider.prototype.options=function(e){return $.isFunction(this.getProvider().getOptions)?this.getProvider().getOptions(e):!1},TradingView.NewsProvider.prototype.getProvider=function(){return this._provider},TradingView.NewsProvider.prototype.providers.yahoo.prototype.init=function(e,t){this._newsWidget=t.newsWidget,this._providerBase=e},TradingView.NewsProvider.prototype.providers.yahoo.prototype.getURLforSymbol=function(e,t,i){return"MTGOX"==i?this._providerBase.getURLforCategory("bitcoin"):"futures"!=t&&"cfd"!=t||e in this.symbology.specialCases?this._providerBase.getURLforSymbol(e,t,i):this._providerBase.getURLforCategory("futures")},TradingView.NewsProvider.prototype.providers.yahoo.prototype.getURLforSpread=function(e,t,i){return"MTGOX"==i?this.getByCategory("bitcoin"):"futures"==t||"cfd"==t?this.getByCategory("futures"):this._providerBase.getURLforSpread(e)},TradingView.NewsProvider.prototype.providers.yahoo.prototype.itemTransform=function(e){return{id:e.id,link:e.link,published:e.published,title:e.title,source:this.getSource(e)}},TradingView.NewsProvider.prototype.providers.yahoo.prototype.getSource=function(e){var t=e.summary&&e.summary.match(/\[[^\-]+\]/g);if(t)return t[0].replace(/\[(at )?|\]/g,"");for(addr in this.NewsSources)if(~e.link.indexOf(addr))return this.NewsSources[addr];return"Yahoo Finance"},TradingView.NewsProvider.prototype.providers.yahoo.prototype.NewsSources={"allthingsd.com":"AllThingsD","ap.org":"AP","bankrate.com":"Bankrate.com","barrons.com":"Barrons.com","bizjournals.com":"Business Journals","bloomberg.com":"Bloomberg","businessinsider.com":"Business Insider","businesswire.com":"Business Wire","businessweek.com":"BusinessWeek","cnbc.com":"CNBC","cnnmoney.com":"CNNMoney.com","newswire.ca":"CNW Group",consumerreports:"Consumer Reports",creditcards:"CreditCards.com","dailyfx.com":"DailyFX","entrepreneur.com":"Entrepreneur",etfdb:"ETF Database",etftrends:"ETF Trends",etfguide:"ETFguide",etfzone:"ETFZone","ft.com":"Financial Times","forbes.com":"Forbes","fortune.cnn.com":"Fortune","foxbusiness.com":"Fox Business","futuresmag.com":"Futuresmag.com",gftforex:"GFT Forex","globenewswire.com":"GlobeNewswire",indieresearch:"IndieResearch",indexuniverse:"IndexUniverse.com","investopedia.com":"Investopedia","investors.com":"Investor's Business Daily",kiplinger:"Kiplinger","marketwatch.com":"MarketWatch",marketwire:"Marketwire",minyanville:"Minyanville","money.cnn.com":"Money",morningstar:"Morningstar","fool.com":"Motley Fool","nytimes.com":"New York Times","oilprice.com":"Oilprice.com",optionetics:"Optionetics",optionmonster:"optionMONSTER","paidcontent.org":"paidContent.org",newswire:"PR Newswire","reuters.com":"Reuters","seekingalpha.com":"Seeking Alpha","smallcapinvestor.com":"SmallCapInvestor.com",smartmoney:"SmartMoney",atlantic:"The Atlantic","wsj.com":"The Wall Street Journal","theflyonthewall.com":"Theflyonthewall.com","thestreet.com":"TheStreet",thomsonreuters:"Thomson Reuters ONE",usnews:"US News & World Report","wallstcheatsheet.com":"Wall St. Cheat Sheet",transcript:"Wall Street Transcript",zacks:"Zacks"},TradingView.NewsProvider.prototype.providers.yahoo.prototype.update=function(e){e=TradingView.NewsWidget.prototype.providers.yahoo.title,this._newsWidget._quoteMetaInfo&&this._newsWidget._quoteMetaInfo.name&&(e+=" for "+this._newsWidget._quoteMetaInfo.name),this._newsWidget._bridge.setTitle(e)},TradingView.NewsProvider.prototype.providers.stocktwits.prototype.init=function(e,t){this._newsWidget=t.newsWidget},TradingView.NewsProvider.prototype.providers.stocktwits.prototype.update=function(e){e=TradingView.NewsWidget.prototype.providers.stocktwits.title,this._newsWidget._quoteMetaInfo&&this._newsWidget._quoteMetaInfo.name&&(e+=" for "+this._newsWidget._quoteMetaInfo.name),this._newsWidget._bridge.setTitle(e)},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.init=function(e,t){this._pushstream_channel=this.feed_realtime,this._providerBase=e,this._newsWidget=t.newsWidget,this.currencies={},pro.hasPackage(this.package_name)||(this._pushstream_channel=this.feed_delayed,this._newsWidget.D2.value().delayedWarningShown||(this.showDelayedWarning(),this._newsWidget.updateProperties({delayedWarningShown:!0}))),this.setTitle(),TradingView.pushStreamMultiplexer.on(this._pushstream_channel,function(e){e=this.filterNews(e),t.onData&&t.onData(e,{incremental:!0})}.bind(this))},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.getURLforSymbol=function(e,t,i){return e=this._providerBase.convertSymbol(e,t,i),t=pro.hasPackage(this.package_name)?this.feed_realtime:this.feed_delayed,this._providerBase._BASE_URL+t+"/symbol/"+e+"/"},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.getURLforSpread=function(e,t,i){return t=pro.hasPackage(this.package_name)?this.feed_realtime:this.feed_delayed,e=e.join(","),this._providerBase._BASE_URL+t+"/spread/"+e+"/"},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.update=function(e){if(this.currencies={},Array.isArray(e))for(var t=0;t<e.length;t++)this.currencies[e[t].substr(0,3)]=1,this.currencies[e[t].substr(3,3)]=1;else this.currencies[e.substr(0,3)]=1,this.currencies[e.substr(3,3)]=1},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.destroy=function(){TradingView.pushStreamMultiplexer.off(this._pushstream_channel)},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.filterNews=function(e){return e.filter(function(e){return e.published=new Date(1e3*e.published),""==e.currency||e.currency in this.currencies},this)},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.showAboutDialog=function(){pro.showProductDialog(this.package_name)},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.showDelayedWarning=function(){var e=$('<div class="widgetbody-overlay"><span class="ns-fxwire-message-close"></span><div class="ns-fxwire-message"><h3>This is delayed news feed</h3><p>This is delayed FxWire PRO news feed. Want real-time updates and more features?</p><a href="#">Learn More</a></div></div>').appendTo(this._newsWidget._bridge.$body);e.find(".ns-fxwire-message a").click(function(){this.showAboutDialog(),e.remove()}.bind(this)),e.find(".ns-fxwire-message-close").click(function(){e.remove()}),this.$message=e},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.setTitle=function(e){e="FxWire Pro "+(pro.hasPackage(this.package_name)?"Realtime":"Delayed"),this._newsWidget._bridge.setTitle(e)},TradingView.NewsProvider.prototype.providers.fxwirepro.prototype.getOptions=function(){return[{title:"About and Subscription",action:this.showAboutDialog.bind(this)}]},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.categories={all:"All Content",news:"News","market-analysis":"Market Analysis","trading-strategies":"Trading Strategies",blogs:"Blogs",commodities:"Commodities",forex:"Forex",options:"Options"},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.getURLforSymbol=function(e,t,i){return this._providerBase.getURLforCategory(this._category)},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.init=function(e,t){this._news=t.newsWidget,this._providerBase=e,this.setCategory(this._news.D2.value().category||"all",!0)},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.setCategory=function(e,t){this._category=e,this._news.updateProperties({category:e}),this._news._bridge.setTitle("Futures Magazine - "+this.categories[e]),t||this._news.update()},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.getOptions=function(){function e(e){return function(){this.setCategory(e)}.bind(this)}var t,i=[];for(t in this.categories)i.push({title:this.categories[t],action:e.call(this,t),active:t==this._category});return i.push({separator:1}),i.push({title:"About",action:this.showAboutDialog.bind(this)}),i},TradingView.NewsProvider.prototype.providers.futuresmag.prototype.showAboutDialog=function(){A83.showNotice("About Futuresmag News Feed","For 40 years Futures has been a thought leader and independent voice of the commodity, futures, options, forex and stock trader. Here is a list of our services, information and directories to help you learn to or continue to trade successfully.")},A45=function(){function e(e,d){function h(c){function p(t){(W77.enabled("same_data_requery")||w.value()!==t)&&(d?d.setSymbol(t):e.setSymbol(t))}function u(){t.setValue(w.value())}function f(){n.setValue(v.actualSymbol())}function g(){i.setValue(y.shortName.value());var e=v.symbolInfo();e?(f(),e.hasOwnProperty("supported_resolutions")?s.setValue(e.supported_resolutions):s.setValue(void 0),r.setValue(!!e.has_intraday)):r.deleteValue()}function m(t){(W77.enabled("same_data_requery")||b.value()!==t)&&(d?d.setResolution(t):e.setResolution(t))}function _(){o.setValue(b.value())}e.modelCreated().unsubscribe(null,h);var v=e.model().mainSeries(),y=v.properties(),w=y.symbol;w.subscribe(null,u),t.setValue(w.value()),t.subscribe(p),v.onSymbolResolved().subscribe(null,f),t.hook=function(e){return v.symbolSameAsCurrent(e)&&(e=v.actualSymbol()),e},v.onSymbolResolved().subscribe(null,g),v.onSymbolError().subscribe(null,g),g();var b=y.interval;b.subscribe(null,_),o.setValue(b.value()),o.subscribe(m),e.readOnly()&&(t.writeLock=!0),a=function(){w.unsubscribe(null,u),t.unsubscribe(p),v.onSymbolResolved().unsubscribe(null,g),v.onSymbolError().unsubscribe(null,g),b.unsubscribe(null,_),o.unsubscribe(m),delete t.hook,delete t.writeLock,a=new Function,l=new Function}}a(),l=function(){return e};var c=e.model();c?h(c):(e.modelCreated().subscribe(null,h),a=function(){e.modelCreated().unsubscribe(null,h),a=new Function,l=new Function},c=e.properties().mainSeriesProperties,t.setValue(c.symbol.value()),o.setValue(c.interval.value()))}var t=new WatchedValue,i=new WatchedValue,n=new WatchedValue,o=new WatchedValue,r=new WatchedValue,s=new WatchedValue,a=new Function,l=new Function,d=new Function;return{symbol:t,actualSymbol:n,seriesShortSymbol:i.readonly(),interval:o,intraday:r.readonly(),supportedResolutions:s.readonly(),bindToChartWidget:e,unbindFromChartWidget:function(){a()},getChartWidget:function(){return l()},bindToSearchCharts:function(e){function i(e){o=!0,t.setValue(e.resolved_symbol),o=!1}function n(t){o||e.search(t)}d();var o=!1;e.onSearchBySymbol.subscribe(null,i),t.subscribe(n),d=function(){e.onSearchBySymbol.unsubscribe(null,i),t.unsubscribe(n),d=new Function}},unbindFromSearchCharts:function(){d()},bindToChartWidgetCollection:function(t){a(),t.activeChartWidget.subscribe(function(i){a(),e(i,t)},{callWithLast:!0})}}}(),A15={force_prefix:"forcefeaturetoggle.",enableFeature:function(e){localStorage[this.force_prefix+e]="true"},disableFeature:function(e){localStorage.removeItem(this.force_prefix+e)}},TradingView.D18=function(e){function t(t){return localStorage["featuretoggle."+t]=Math.random()<=e[t]}return TradingView.pushStreamMultiplexer&&TradingView.pushStreamMultiplexer.on("featuretoggle",function(i){e[i.name]=i.state,t(i.name)}),function(i){if("local"===window.environment||"true"===localStorage[A15.force_prefix+i]||window.is_authenticated&&"undefined"!=typeof user&&user&&user.settings[A15.force_prefix+i])return!0;if(!e[i])return!1;if(1===e[i])return!0;var n=localStorage["featuretoggle."+i];return void 0===n||null===n?t(i):"true"===n}}(window.featureToggleState||{}),function(e){if(document.createElement("canvas")&&document.createElement("canvas").getContext){var t=function(t){return(e.devicePixelRatio||1)/(t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(document.createElement("canvas").getContext("2d"));2>t||(e.hidpiCanvasRatio=t,function(e){e.drawImagePatchedSource=e.drawImage,e.drawImagePatchedSourceAndDest=e.drawImage,function(e,t){for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)}({fillRect:"all",clearRect:"all",strokeRect:"all",moveTo:"all",lineTo:"all",arc:[0,1,2],arcTo:"all",bezierCurveTo:"all",isPointinPath:"all",isPointinStroke:"all",quadraticCurveTo:"all",rect:"all",translate:"all",createRadialGradient:"all",createLinearGradient:"all",drawImagePatchedSource:[1,2,3,4],drawImagePatchedSourceAndDest:[1,2,3,4,5,6,7,8]},function(i,n){var o=e[n];e[n]=function(){var e,n;if("all"===i)for(n=[],e=arguments.length;0<e--;)n[e]=arguments[e]*t;else for(n=Array.prototype.slice.call(arguments),e=i.length;0<e--;)n[i[e]]&&(n[i[e]]*=t);return o.apply(this,n)}}),e.drawImage=function(e){return function(){return arguments[0]instanceof HTMLCanvasElement?e.drawImagePatchedSourceAndDest.apply(this,arguments):e.drawImagePatchedSource.apply(this,arguments)}}(e),e.fillText=function(e){return function(){var i=Array.prototype.slice.call(arguments);i[1]*=t,i[2]*=t,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(e,i,n){return i*t+n}),e.apply(this,i),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(e,i,n){return i/t+n})}}(e.fillText),e.strokeText=function(e){return function(){var i=Array.prototype.slice.call(arguments);i[1]*=t,i[2]*=t,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(e,i,n){return i*t+n}),e.apply(this,i),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(e,i,n){return i/t+n})}}(e.strokeText)}(CanvasRenderingContext2D.prototype),function(e){e.getContext=function(e){return function(i){var n=e.call(this,i);return"2d"===i&&this.width!=Math.floor(parseInt(this.style.width)*t)&&(this.style.height=this.height+"px",this.style.width=this.width+"px",this.width*=t,this.height*=t),n}}(e.getContext)}(HTMLCanvasElement.prototype))}}(window),!function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Spinner=t()}(this,function(){function e(e,t){var i,n=document.createElement(e||"div");for(i in t)n[i]=t[i];return n}function t(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function i(e,t,i,n){var o=["opacity",t,~~(100*e),i,n].join("-");i=.01+i/n*100,n=Math.max(1-(1-e)/t*(100-i),e);var r=d.substring(0,d.indexOf("Animation")).toLowerCase();return c[o]||(p.insertRule("@"+(r&&"-"+r+"-"||"")+"keyframes "+o+"{0%{opacity:"+n+"}"+i+"%{opacity:"+e+"}"+(i+.01)+"%{opacity:1}"+(i+t)%100+"%{opacity:"+e+"}100%{opacity:"+n+"}}",p.cssRules.length),
c[o]=1),o}function n(e,t){var i,n,o=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<h.length;n++)if(i=h[n]+t,void 0!==o[i])return i;return void 0!==o[t]?t:void 0}function o(e,t){for(var i in t)e.style[n(e,i)||i]=t[i];return e}function r(e){for(var t=1;t<arguments.length;t++){var i,n=arguments[t];for(i in n)void 0===e[i]&&(e[i]=n[i])}return e}function s(e,t){return"string"==typeof e?e:e[t%e.length]}function a(e){this.opts=r(e||{},a.defaults,u)}function l(){function i(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}p.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(e,n){function r(){return o(i("group",{coordsize:h+" "+h,coordorigin:-d+" "+-d}),{width:h,height:h})}function a(e,a,l){t(c,t(o(r(),{rotation:360/n.lines*e+"deg",left:~~a}),t(o(i("roundrect",{arcsize:n.corners}),{width:d,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),i("fill",{color:s(n.color,e),opacity:n.opacity}),i("stroke",{opacity:0}))))}var l,d=n.length+n.width,h=2*d;l=2*-(n.width+n.length)+"px";var c=o(r(),{position:"absolute",top:l,left:l});if(n.shadow)for(l=1;l<=n.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)a(l);return t(e,c)},a.prototype.opacity=function(e,t,i,n){e=e.firstChild,n=n.shadow&&n.lines||0,e&&t+n<e.childNodes.length&&(e=e.childNodes[t+n],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=i))}}var d,h=["webkit","Moz","ms","O"],c={},p=function(){var i=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),u={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},r(a.prototype,{spin:function(t){this.stop();var i=this,n=i.opts,r=i.el=o(e(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});if(n.radius+n.length+n.width,o(r,{left:n.left,top:n.top}),t&&t.insertBefore(r,t.firstChild||null),r.setAttribute("role","progressbar"),i.lines(r,i.opts),!d){var s,a=0,l=(n.lines-1)*(1-n.direction)/2,h=n.fps,c=h/n.speed,p=(1-n.opacity)/(c*n.trail/100),u=c/n.lines;!function f(){a++;for(var e=0;e<n.lines;e++)s=Math.max(1-(a+(n.lines-e)*u)%c*p,n.opacity),i.opacity(r,e*n.direction+l,s,n);i.timeout=i.el&&setTimeout(f,~~(1e3/h))}()}return i},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(n,r){function a(t,i){return o(e(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*h+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var l,h=0,c=(r.lines-1)*(1-r.direction)/2;h<r.lines;h++)l=o(e(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:d&&i(r.opacity,r.trail,c+h*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(l,o(a("#000","0 0 4px #000"),{top:"2px"})),t(n,t(l,a(s(r.color,h),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var f=o(e("group"),{behavior:"url(#default#VML)"});return!n(f,"transform")&&f.adj?l():d=n(f,"animation"),a}),IntervalHelper=function(){var e={},t=/^(\d*)([DWM])$/;return e.isDWM=function(e){return(e=t.exec(e+""))?{qty:e[1]||"1",unit:e[2]}:!1},e.isAvailable=function(e){var t=A45.supportedResolutions.value(),i=!1,i="undefined"!=typeof t?-1!=t.indexOf(e):!0;return A45.intraday.value()?i:this.isDWM(e)&&i},e.isMinute=function(e){return e=parseInt(e),e>=1&&1440>=e},e.isHour=function(e){return e>=60&&!(e%60)},e}(),StudyInputsHelper=function(){function e(e,t){var i=t.slice(0).toLowerCase();if(e){for(var n=0;n<e.size();++n)if(e.item(n).description.toLowerCase()===i||e.item(n).shortDescription.toLowerCase()===i)return e.item(n);throw Error("Can't find metainfo for `"+t+"`")}throw Error("There is no studies metainfo at all")}function t(e){return e.inputs.map(function(e){return{id:e.id,type:e.type,name:e.name}})}function i(i,n,o){o=e(o.model().studiesMetaData(),i);var r,s=t(o),a={};for(r in n){var l=r.toLowerCase(),d=s.filter(function(e){return e.name.toLowerCase()===l});0===d.length?console.warn("Uknown input `"+r+"` of `"+i+"`"):(d=d[0],a[d.id]=n[r])}return{id:o.id,name:i,inputs:a}}var n={},o={bool:function(e){return!!e},integer:function(e){return parseInt(e)},"float":function(e){return parseFloat(e)},string:function(e){return e}};return n.getStudyRecordFromArray=function(i,n){n=n||D3;var r,s=n;if(isArray(i)){var a=i.slice(0);r=a[0];for(var l,s=e(s.model().studiesMetaData(),r),d=s.is_price_study,h=t(s),a=a.splice(1),c=0;c<a.length;++c)l||(l={}),l[h[c].id]=(o[h[c].type]||o.string)(a[c]);r={id:s.id,name:r,overlay:d,inputs:l}}else s=e(s.model().studiesMetaData(),i),r={id:s.id,overlay:s.is_price_study};return r},n.getStudyRecordFromObject=function(e,t,n){return n=n||D3,i(e,t,n)},n}(),A82.ChartapiMessager=function(e,t){this._server=e,this._session=t,this._timezone=null},A82.ChartapiMessager.prototype.setTimezone=function(e){this._timezone="exchange"==e?"exchange":PineJsCalendar.get_timezone(e)},A82.ChartapiMessager.prototype.onRequestMetadata=function(e,t){this._server.receiveLocalResponse({method:"studies_metadata",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onSymbolResolved=function(e,t){this._server.receiveLocalResponse({method:"symbol_resolved",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onSymbolError=function(e,t){this._server.receiveLocalResponse({method:"symbol_error",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onStudyError=function(e,t){this._server.receiveLocalResponse({method:"study_error",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onSeriesLoading=function(e,t){this._server.receiveLocalResponse({method:"series_loading",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onSeriesCompleted=function(e,t,i){this._server.receiveLocalResponse({method:"series_completed",params:[this._session,e,i,t]})},A82.ChartapiMessager.prototype.onSeriesError=function(e,t){this._server.receiveLocalResponse({method:"series_error",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onSeriesClearData=function(e,t){var i={};i[e]={series:[],turnaround:t},this._server.receiveLocalResponse({method:"timescale_update",params:[this._session,i,{index:0,zoffset:0,changes:[],marks:[]}]})},A82.ChartapiMessager.prototype.onStudyCompleted=function(e,t){this._server.receiveLocalResponse({method:"study_completed",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onStudyLoading=function(e,t){this._server.receiveLocalResponse({method:"study_loading",params:[this._session,e,t]})},A82.ChartapiMessager.prototype.onTickmarksUpdated=function(e,t,i){t=t.slice(0);var n=PineJsCalendar.get_timezone(i.timezone);for(i=0;i<t.length;++i)t[i]=this.timeInTimezone(t[i],n);var o,n=[],r=[];for(i=0;i<t.length;++i){var s=t[i];n.push([this._spanByTime(s,o),s,e+i]),r.push(s),o=s}this._server.receiveLocalResponse({method:"tickmark_update",params:[this._session,{index:e,zoffset:0,changes:r,marks:n}]})},A82.ChartapiMessager.prototype.onTimescaleUpdate=function(e,t,i,n,o){i=i.slice(0);var r=PineJsCalendar.get_timezone(n.timezone);for(n=0;n<i.length;++n)i[n].value[0]=this.timeInTimezone(i[n].value[0],r);r={},r[e]={series:i,turnaround:t},e=[],t=[];var s;for(n=0;n<i.length;++n){var a=i[n].value[0];e.push([this._spanByTime(a,s),a,o+n]),t.push(a),s=a}this._server.receiveLocalResponse({method:"timescale_update",params:[this._session,r,{index:o,zoffset:0,changes:t,marks:e}]})},A82.ChartapiMessager.prototype.onSeriesTimeframeUpdate=function(e,t,i,n,o){this._server.receiveLocalResponse({method:"series_timeframe",params:[this._session,e,t,i,n,o]})},A82.ChartapiMessager.prototype.onPointsetDataUpdate=function(e,t,i,n){this._onDataUpdate(e,t,i,void 0,n,1)},A82.ChartapiMessager.prototype.onDataUpdate=function(e,t,i,n,o){this._onDataUpdate(e,t,i,n,o,0)},A82.ChartapiMessager.prototype._onDataUpdate=function(e,t,i,n,o,r){i=i.slice(0),o=PineJsCalendar.get_timezone(o.timezone);for(var s=0;s<i.length;++s)i[s].value[r]=this.timeInTimezone(i[s].value[r],o);r={},n=n?JSON.stringify({offsets:n}):"",r[e]={s:i,ns:{d:n,indexes:[]},turnaround:t},this._server.receiveLocalResponse({method:"data_update",params:[this._session,r]})},A82.ChartapiMessager.prototype.onQuotesData=function(e){this._server.receiveLocalResponse({method:"quote_symbol_data",params:e})},A82.ChartapiMessager.prototype.timeInTimezone=function(e,t){return"exchange"==this._timezone?parseInt(PineJsCalendar.utc_to_cal(t,1e3*e).valueOf()/1e3):parseInt(PineJsCalendar.utc_to_cal(this._timezone,1e3*e).valueOf()/1e3)},A82.ChartapiMessager.prototype.timeInGMT=function(e,t){return"exchange"==this._timezone?parseInt(PineJsCalendar.cal_to_utc(t,new Date(1e3*e))/1e3):parseInt(PineJsCalendar.cal_to_utc(this._timezone,new Date(1e3*e))/1e3)},A82.ChartapiMessager.prototype._spanByTime=function(e,t){var i=[{divisor:1,span:20},{divisor:3e5,span:21},{divisor:18e5,span:22},{divisor:36e5,span:30},{divisor:108e5,span:31},{divisor:216e5,span:32},{divisor:432e5,span:33}];if(!t)return 20;var n=new Date(1e3*t),o=new Date(1e3*e);if(o.getYear()!=n.getYear())return 70;if(o.getUTCMonth()!=n.getUTCMonth())return 60;if(o.getUTCDate()!=n.getUTCDate())return 50;for(var r=i.length-1;r>=0;--r)if(Math.floor(n/i[r].divisor)!=Math.floor(o/i[r].divisor))return i[r].span},ChartapiMessagerInstances=[],A82.ChartApi=function(e){this._notificationHandlers=[],this._sessions=[],this.studyCounter=0,this._enabled=this._connected=!1,this._studyEngine=new A79(e),this._callbacks={},this._symbolIdCache={},this._seriesIdCache={},this._recentSeriesId=null,this._enableLogging=!1,this._enabledMoreBarsRequest=!0;var t=this;this._studyEngine.on("configuration_received",function(){t._fireEvent("configuration_received")}),this._studyEngine.on("realtime_tick",function(e){t._fireEvent("realtime_tick",{time:e.value[0]/1e3,open:e.value[1],high:e.value[2],low:e.value[3],close:e.value[4],volume:e.value[5]})}),this._autosavePause=void 0,this._setupAutoSave(),TradingView.availableTimezones=[{id:"UTC",title:$.t("UTC")},{id:"exchange",title:$.t("Exchange")}].concat([{id:"Europe/Athens",title:"Athens"},{id:"Europe/Berlin",title:"Berlin"},{id:"America/Bogota",title:"Bogota"},{id:"Asia/Bangkok",title:"Bangkok"},{id:"America/Argentina/Buenos_Aires",title:"Buenos Aires"},{id:"America/Chicago",title:"Chicago"},{id:"Asia/Hong_Kong",title:"Hong Kong"},{id:"Asia/Kolkata",title:"Kolkata"},{id:"Europe/London",title:"London"},{id:"America/Los_Angeles",title:"Los Angeles"},{id:"Europe/Madrid",title:"Madrid"},{id:"Europe/Moscow",title:"Moscow"},{id:"America/New_York",title:"New York"},{id:"Europe/Paris",title:"Paris"},{id:"America/Sao_Paulo",title:"Sao Paulo"},{id:"Asia/Seoul",title:"Seoul"},{id:"Asia/Shanghai",title:"Shanghai"},{id:"Asia/Singapore",title:"Singapore"},{id:"Australia/Sydney",title:"Sydney"},{id:"Asia/Taipei",title:"Taipei"},{id:"Asia/Tehran",title:"Tehran"},{id:"Asia/Tokyo",title:"Tokyo"},{id:"America/Toronto",title:"Toronto"},{id:"America/Vancouver",title:"Vancouver"},{id:"Europe/Warsaw",title:"Warsaw"}].map(function(e){return e.title=$.t(e.title),e}).sort(function(e,t){return e.title.localeCompare(t.title)}))},A82.ChartApi.prototype.purgeCache=function(e){this._symbolIdCache={},delete this._recentSeriesId,this._studyEngine.purgeCache(),this._studyEngine.purgeRangeExtensionData()},A82.ChartApi.prototype.setAdditionalBarsRequestEnabled=function(e){this._enabledMoreBarsRequest=e},A82.ChartApi.prototype.setTimeFramesList=function(e){this._timeframes=[];for(var t=/(\d+)(\w+)/,i=0;i<e.length;++i){var n=e[i],o=t.exec(n.text),r=o[2].toLowerCase(),o=parseInt(o[1]),s="y"==r?12*o+"m":o+r,a=PineJS.Symbol.parsePeriod(n.resolution);this._timeframes.push({text:o+$.t(r,{context:"dates",count:o}),value:s,targetResolution:n.resolution,requiresIntraday:a.isIntraday})}},A82.ChartApi.prototype._setupAutoSave=function(){var e=this,t=!1;A77.undoStack().onChange().subscribe(this,function(){e._autosavePause?t=!0:(e._fireEvent("onAutoSaveNeeded",void 0,!0),e._autosavePause=setTimeout(function(){t&&e._fireEvent("onAutoSaveNeeded",void 0,!0),e._autosavePause=void 0,t=!1},5e3))})},A82.ChartApi.prototype.defaultWatchlistSymbols=function(){return this._watchlistSettings.default_symbols},A82.ChartApi.prototype.availableTimeFrames=function(e,t){return e?this._timeframes.filter(function(t){return t.requiresIntraday&&!e.has_intraday||e.supported_resolutions&&0>e.supported_resolutions.indexOf(t.targetResolution)?!1:!0}):[]},A82.ChartApi.prototype.defaultResolutions=function(){return this._studyEngine.supportedResolutions()||{1:1,3:1,5:1,15:1,30:1,45:1,60:1,120:1,180:1,240:1,D:1,W:1,M:1}},A82.ChartApi.prototype.supportedSymbolsTypes=function(){return this._studyEngine.supportedSymbolsTypes()},A82.ChartApi.prototype.supportedExchangesList=function(){return this._studyEngine.supportedExchangesList()},A82.ChartApi.prototype.start=function(){this._enabled=!0,this._fireEvent("start_enabled")},A82.ChartApi.prototype._logMessage=function(e){this._enableLogging&&console.log(e)},A82.ChartApi.prototype.unsubscribe=function(e,t){var i=this._callbacks[e];i&&i.splice(i.indexOf(t),1)},A82.ChartApi.prototype.on=function(e,t){return this._callbacks.hasOwnProperty(e)||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},A82.ChartApi.prototype._fireEvent=function(e,t,i){if(this._callbacks.hasOwnProperty(e)){var n=this._callbacks[e].slice(0);for(i||(this._callbacks[e]=[]),e=0;e<n.length;++e)n[e](t)}},A82.ChartApi.prototype.setAuthToken=function(e,t){throw"This method is not implemented"},A82.ChartApi.prototype.authTokenRequired=function(e){return!1},A82.ChartApi.prototype.chartCreateSession=function(e,t){},A82.ChartApi.prototype.chartDeleteSession=function(e){},A82.ChartApi.prototype.createSession=function(e,t){ChartapiMessagerInstances[e]=new A82.ChartapiMessager(this,e),this._sessions[e]=t,this._notificationHandlers[e]=t,this.connected()&&t.onMessage({method:"connected",params:[]})},A82.ChartApi.prototype.removeSession=function(e){delete this._sessions[e],delete this._notificationHandlers[e],this.chartDeleteSession(e)},A82.ChartApi.prototype.connected=function(){return this._connected},A82.ChartApi.prototype._getHost=function(e){return e},A82.ChartApi.prototype._isSafari5=function(){return!!navigator.appVersion.match(/\/5\.[^\/]*?Safari\//)},A82.ChartApi.prototype._isIE9=function(){return!!navigator.appVersion.match(/MSIE 9/)},A82.ChartApi.prototype._isIOS5=function(){return!!navigator.appVersion.match(/iPad, CPU 5/)},A82.ChartApi.prototype._getPort=function(e){return this._isSafari5()||this._isIE9()?8081:e},A82.ChartApi.prototype.connect=function(){if(this._enabled)this.connected()||(this._connected=!0,this.sessionid="dummy session id",this._notifySessions({method:"connected",params:[]}));else{var e=this;this.on("start_enabled",function(){e.connect()})}},A82.ChartApi.prototype.disconnect=function(){throw"This method is not implemented"},A82.ChartApi.prototype.switchTimezone=function(e,t){if(ChartapiMessagerInstances[e].setTimezone(t),this._recentSeriesId){this._studyEngine.purgeEndOfDataFlags(this._recentSeriesId);var i=this;this._doWhenSeriesSymbolIdIsReady(this._recentSeriesId,function(t){i._studyEngine.recreateSources(t.name,i._seriesIdCache[i._recentSeriesId].resolution,e),i._doWhenSeriesDataReceived(function(){var n=i._seriesIdCache[i._recentSeriesId].resolution,o=D3.model().mainSeries().data().last();i._studyEngine.rebuildExtrapolatedData(e,t.name,n,t.info,1e3*o.value[0])})})}},A82.ChartApi.prototype.receiveLocalResponse=function(e){this._logMessage("< "+e.method),this._dispathNotification(e),this._fireEvent("message_"+e.method,void 0,!0)},A82.ChartApi.prototype.getMarks=function(e,t,i,n,o){this._studyEngine.getMarks(e,t,i,n,o)},A82.ChartApi.prototype.resolveSymbol=function(e,t,i,n,o){function r(t,n){ChartapiMessagerInstances[e].onSymbolError(t,n),s._symbolIdCache[t]={name:i,status:"invalid_symbol"},s._fireEvent(t+"_resolve_fail"),s._fireEvent("resolve_fail",t)}this._notificationHandlers[e][t]=new HandlerInfo(n,t),this._symbolIdCache[t]=null;var s=this;this._studyEngine.resolveSymbol(i,function(n){n.errmsg?r(t,n.errmsg):(s._symbolIdCache[t]={name:i,info:n,status:"ok"},s._fireEvent(t+"_resolved",n),s._fireEvent("symbol_resolved",{symbolInfo:n,symbolId:t}),ChartapiMessagerInstances[e].onSymbolResolved(t,n))},function(e){r(t,e)})},A82.ChartApi.prototype._doWhenSymbolIdIsReady=function(e,t){function i(){o&&(t({name:n._symbolIdCache[e].name,info:n._symbolIdCache[e].info}),o=!1,n.unsubscribe(e+"_resolved",i),n.unsubscribe(e+"_resolve_fail",i))}var n=this,o=!0;this._symbolIdCache[e]?i():(this.on(e+"_resolved",i),this.on(e+"_resolve_fail",i))},A82.ChartApi.prototype._doWhenSeriesDataReceived=function(e){function t(){D3.model().mainSeries().onCompleted().unsubscribe(null,t),e()}D3.model().mainSeries().onCompleted().subscribe(null,t)},A82.ChartApi.prototype._doWhenSeriesSymbolIdIsReady=function(e,t,i){function n(){var t=a._symbolIdCache[a._seriesIdCache[e].symbolId];return{name:t.name,info:t.info}}function o(){a.unsubscribe("symbol_resolved",s),a.unsubscribe("resolve_fail",r)}function r(t){t==a._seriesIdCache[e].symbolId&&i&&(o(),i())}function s(i){i.symbolId==a._seriesIdCache[e].symbolId&&(o(),t(n()))}var a=this;this._symbolIdCache[this._seriesIdCache[e].symbolId]?t(n()):(this.on("symbol_resolved",s),this.on("resolve_fail",r))},A82.ChartApi.prototype.createSeries=function(e,t,i,n,o,r,s){i=i||"",this._notificationHandlers[e][t]=new HandlerInfo(s,t),this._recentSeriesId=t;var a=this;this._seriesIdCache[t]={symbolId:n,resolution:o,turnaround:i},this._studyEngine.updateSeriesTurnaround(t,i),this._doWhenSeriesSymbolIdIsReady(t,function(n){a._studyEngine.createSeries(n.name,o,e,t,i)})},A82.ChartApi.prototype.removeSeries=function(e,t,i){this._notificationHandlers[e][t]=new HandlerInfo(i,t),this._studyEngine.removeSeries(t)},A82.ChartApi.prototype.setVisibleTimeRange=function(e,t,i,n){var o=D3.model().mainSeries().data(),o=!!o.timeToBarIndex(t,SEARCH_FROM_LEFT),r=this._recentSeriesId;o?(o=D3.model().mainSeries().data(),t=[o.timeToBarIndex(t,SEARCH_FROM_LEFT),o.timeToBarIndex(i,SEARCH_FROM_RIGHT)],ChartapiMessagerInstances[e].onSeriesTimeframeUpdate(r,this._seriesIdCache[r].turnaround,t[0],t[1],!0),n&&n()):console.warn("This method doesn't support moving to not loaded history bars now")},A82.ChartApi.prototype._exactBarsCountOfTimeFrame=function(e,t){for(var i=D3.model().mainSeries().bars(),n=D3.model().mainSeries().symbolInfo().session,o=i._valueAt(i.size()-1)[0],n=PineJsBarBuilder.alignPeriodsBack(n,e.resolution,e.interval,1,1e3*o),o=i.size(),n=n/1e3,r=0,r=0;o>r&&!(i._valueAt(r)[0]>n);++r);return o-r},A82.ChartApi.prototype.modifySeries=function(e,t,i,n,o,r,s){i=i||"";var a=this._seriesIdCache[t]?this._seriesIdCache[t].resolution:void 0,l=this;this._notificationHandlers[e][t]=new HandlerInfo(function(s){if("series_completed"==s.method){var d=PineJS.Symbol.parsePeriod(a),h=PineJS.Symbol.parsePeriod(o);h.range&&d.range!=h.range&&(d=D3.model().mainSeries().bars().size(),h=l._exactBarsCountOfTimeFrame(h.range,l._symbolIdCache[n].info),h=Math.max(0,d-1-h),d=Math.max(h,d-1),ChartapiMessagerInstances[e].onSeriesTimeframeUpdate(t,i,h,d))}r(s)},t),this._recentSeriesId=t,this._studyEngine.updateSeriesTurnaround(t,i),this._seriesIdCache[s]=null,this._seriesIdCache[t]={symbolId:n,resolution:o,turnaround:i},this._doWhenSeriesSymbolIdIsReady(t,function(i){l._studyEngine.purgeEndOfDataFlags(t),l._studyEngine.purgeRangeExtensionData(),l._studyEngine.purgeDataCache(),l._studyEngine.recreateSources(i.name,o,e,!0)})},A82.ChartApi.prototype.requestMoreData=function(e,t,i,n){this._enabledMoreBarsRequest&&(this._notificationHandlers[e][t]=new HandlerInfo(n,t),this._studyEngine.extendSeriesRange(t,e,i))},A82.ChartApi.prototype.setStudiesAccessController=function(e){this.studiesAccessController=e},A82.ChartApi.prototype.setWatchlistSettings=function(e){this._watchlistSettings=e},A82.ChartApi.prototype.allStudiesMetadata=function(){return this._studyEngine.studiesMetadata()},A82.ChartApi.prototype.requestMetadata=function(e,t,i){this._notificationHandlers[e][t]=new HandlerInfo(i,t),i=this.studiesAccessController.getEnabledTools(),ChartapiMessagerInstances[e].onRequestMetadata(t,i)},A82.ChartApi.prototype.isCanCreateStudy=function(){return this.studyCounter<STUDY_COUNT_LIMIT},A82.ChartApi.prototype.createStudy=function(e,t,i,n,o,r,s){if(!this.isCanCreateStudy())throw"Exceeded the limit of studies";var a=this;i=i||"",this._notificationHandlers[e][t]=new HandlerInfo(s,t);var l=this._seriesIdCache[n].resolution;this._doWhenSymbolIdIsReady(this._seriesIdCache[n].symbolId,function(n){a._studyEngine.createStudy(n.name,l,e,t,i,o,r),a.studyCounter++})},A82.ChartApi.prototype.removeStudy=function(e,t){this._notificationHandlers[e][t]=null,this._studyEngine.removeStudy(t),this.studyCounter--},A82.ChartApi.prototype.modifyStudy=function(e,t,i,n,o){i=i||"",this._notificationHandlers[e][t]=new HandlerInfo(o,t),[e,t,i].concat(n),this._studyEngine.recomputeStudy(t,n,e,i)},A82.ChartApi.prototype.createPointset=function(e,t,i,n,o,r,s){this._notificationHandlers[e][t]=new HandlerInfo(s,t);var a=this;this._doWhenSymbolIdIsReady(n,function(i){a._studyEngine.createPointset(e,t,i.info.full_name,i.info,o,r)})},A82.ChartApi.prototype.modifyPointset=function(e,t,i,n,o){throw"This call is not implemented"},A82.ChartApi.prototype.removePointset=function(e,t,i){this._notificationHandlers[e][t]=null,this._studyEngine.removePointset(t)},A82.ChartApi.prototype.requestMoreTickmarks=function(e,t,i,n){this._notificationHandlers[e][t]=new HandlerInfo(n,t);var o=this;this._doWhenSeriesSymbolIdIsReady(t,function(n){o._studyEngine.onMoreTickmarksRequested(e,n.name,n.info,o._seriesIdCache[t].resolution,i)})},A82.ChartApi.prototype.requestFirstBarTime=function(e,t,i,n){this._notificationHandlers[e][t]=new HandlerInfo(n,t)},A82.ChartApi.prototype._invokeHandler=function(e,t){e&&e(t)},A82.ChartApi.prototype._sendRequest=function(e,t){throw"This method is not implemented"},A82.ChartApi.prototype._onMessage=function(e){throw"This method is not implemented"},A82.ChartApi.prototype._convertTimescaleResponse=function(e){for(var t=e.marks,i=0;i<t.length;++i)t[i]={span:t[i][0],time:t[i][1],index:t[i][2]};return e},A82.ChartApi.prototype._dispathNotification=function(e){var t=e.params.shift();if(this._notificationHandlers[t])switch(e.method){case"timescale_update":var i=e.params[0];e=e.params[1];var n=this._convertTimescaleResponse(e);n.clear=0===e.changes.length&&0===e.marks.length,this._notificationHandlers[t].onMessage({method:"timescale_update",params:n});for(var o in i)n={},n.customId=o,n.plots=i[o].series,i[o].ns&&(n.nonseries=i[o].ns),n.turnaround=i[o].turnaround,n={method:"data_update",params:n},this._invokeNotificationHandler(t,o,n);break;case"tickmark_update":n=this._convertTimescaleResponse(e.params[0]),n.changes=[],this._notificationHandlers[t].onMessage({method:"timescale_update",params:n});break;case"data_update":for(o in e.params[0]){var r=e.params[0][o],n={};n.customId=o,n.plots=r.series?r.series:r.plots,n.turnaround=r.turnaround,"s"in r&&"ns"in r&&(n.plots=r.s,n.nonseries=r.ns);for(i in n.plots)for(var s in n.plots[i].value)1e100===n.plots[i].value[s]&&(n.plots[i].value[s]=void 0);n={method:"data_update",params:n},this._invokeNotificationHandler(t,o,n)}break;case"index_update":for(o in e.params[0])n={method:"index_update",params:e.params[0][o]},this._invokeNotificationHandler(t,o,n);break;case"critical_error":TradingView.logNormal(new Date+" critical_error session:"+this.sessionid+" reason:"+e.params[0]),this._notificationHandlers[t].onMessage({method:"critical_error",params:e.params});break;case"quote_symbol_data":case"quote_list_fields":case"depth_symbol_error":case"depth_symbol_success":case"dd":case"dpu":case"depth_bar_last_value":this._notificationHandlers[t].onMessage({method:e.method,params:e.params});break;default:this._invokeNotificationHandler(t,e.params[0],e)}},A82.ChartApi.prototype._invokeNotificationHandler=function(e,t,i){if(void 0!==t){var n=this._notificationHandlers[e][t];"undefined"!=typeof n&&n&&this._invokeHandler(n.handler,i),"series_deleted"!=i.method&&"study_deleted"!=i.method||delete this._notificationHandlers[e][t]}},A82.ChartApi.prototype.searchSymbolsByName=function(e,t,i,n,o){0==e.length&&0==t.length&&0==i.length&&o([]),this._studyEngine.searchSymbolsByName(e,t,i,o)},A82.ChartApi.prototype._notifySessions=function(e){for(var t in this._sessions){if(!this._sessions.hasOwnProperty(t))break;var i=this._sessions[t];"function"==typeof i.onMessage&&i.onMessage(e)}},A82.ChartApi.prototype.unpack=function(e){throw"This method is not implemented"},A82.ChartApi.prototype.reconnectTimeout=function(e){throw"This method is not implemented"},A82.ChartApi.prototype.quoteCreateSession=function(e){return this._studyEngine.quoteCreateSession(e)},A82.ChartApi.prototype.quoteDeleteSession=function(e){return this._studyEngine.quoteDeleteSession(e)},A82.ChartApi.prototype.quoteSetFields=function(e,t){return this._studyEngine.quoteSetFields(e,t)},A82.ChartApi.prototype.quoteAddSymbols=function(e,t){return this._studyEngine.quoteAddSymbols(e,t)},A82.ChartApi.prototype.quoteRemoveSymbols=function(e,t){return this._studyEngine.quoteRemoveSymbols(e,t)},A82.ChartApi.prototype.quoteFastSymbols=function(e,t){return this._studyEngine.quoteFastSymbols(e,t)},A82.ChartApi.prototype.depthCreateSession=function(e,t,i){},A82.ChartApi.prototype.depthDeleteSession=function(e){},A82.ChartApi.prototype.depthSetSymbol=function(e,t){},A82.ChartApi.prototype.depthClearSymbol=function(e){},A82.ChartApi.prototype.depthSetScale=function(e,t){},A82.ChartApi.prototype.createStudiesAccessController=function(e,t,i){return e?new this.StudiesAccessController(this._studyEngine,JSON.parse(e)):new this.ObsoleteStudiesAccessController(this._studyEngine,t&&JSON.parse(t),i&&JSON.parse(i))},A82.ChartApi.prototype.StudiesAccessController=function(e,t){this._studyEngine=e,this._studiesAccess=t},A82.ChartApi.prototype.StudiesAccessController.prototype._findTool=function(e){for(var t=null,i=0;i<this._studiesAccess.tools.length;++i){var n=this._studiesAccess.tools[i];if(n.name==e||n==e){t=n;break}}return t},A82.ChartApi.prototype.StudiesAccessController.prototype.getEnabledTools=function(){return this._studyEngine.studiesMetadata().filter(function(e){return e=this._findTool(e.description),"black"==this._studiesAccess.type?!e||e.grayed:!!e},this)},A82.ChartApi.prototype.StudiesAccessController.prototype.isToolGrayed=function(e){return(e=this._findTool(e))&&e.grayed},A82.ChartApi.prototype.ObsoleteStudiesAccessController=function(e,t,i){this._studyEngine=e,this._enabledStudiesList=t,this._disabledStudiesList=i},A82.ChartApi.prototype.ObsoleteStudiesAccessController.prototype.getEnabledTools=function(){var e=this._studyEngine.studiesMetadata();return 0<this._enabledStudiesList.length?e=e.filter(function(e){return e.is_hidden_study||0<=this._enabledStudiesList.indexOf(e.description)},this):0<this._disabledStudiesList.length&&(e=e.filter(function(e){return e.is_hidden_study||-1==this._disabledStudiesList.indexOf(e.description)},this)),e},A82.ChartApi.prototype.ObsoleteStudiesAccessController.prototype.isToolGrayed=function(){return!1},requireFullInterfaceImplementation(A82.ChartApi,"A82.ChartApi",W98,"W98"),this.TzData=TzData=function(){var e={"America/New_York":{time:[-2717668562,-1633298400,-1615154400,-1601848800,-1583704800,-1570399200,-1551650400,-1536530400,-1523224800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-76941e4,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-17762,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Los_Angeles":{time:[-2717668378,-1633298400,-1615154400,-1601848800,-1583704800,-880236e3,-769420800,-765410400,-687996e3,-662680800,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-386805600,-368661600,-355356e3,-337212e3,-323906400,-305762400,-292456800,-273708e3,-261007200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-28378,-28800,-25200,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Chicago":{time:[-2717668236,-1633298400,-1615154400,-1601848800,-1583704800,-1563746400,-1551650400,-1538949600,-1520200800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1067810400,-1045432800,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-769413600,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-21036,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600]},"America/Toronto":{time:[-2366755200,-1632088800,-1615154400,-1601771400,-1583712e3,-1567375200,-1554681600,-1534716e3,-1524088800,-1503266400,-149238e4,-1471816800,-1460930400,-1440972e3,-1428876e3,-1409522400,-1397426400,-1378072800,-1365976800,-1346623200,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1188770400,-1176069600,-1157320800,-1144015200,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-880232400,-76941e4,-765410400,-747266400,-733960800,-715824e3,-702518400,-684374400,-671068800,-652924800,-634176e3,-620863200,-602719200,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-19052,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Vancouver":{time:[-2713910400,-1632088800,-1615154400,-880236e3,-769420800,-765410400,-747266400,-732751200,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-386805600,-368661600,-355356e3,-337212e3,-323906400,-305762400,-292456800,-273708e3,-261007200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-29548,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Argentina/Buenos_Aires":{time:[-2372112e3,-1567468800,-1233446400,-1222992e3,-1205971200,-1194048e3,-117288e4,-1162512e3,-1141344e3,-1130976e3,-1109808e3,-109944e4,-1078272e3,-1067817600,-1046649600,-1036281600,-1015113600,-1004745600,-983577600,-973209600,-952041600,-941587200,-931046400,-900892800,-890352e3,-83376e4,-82728e4,-752284800,-733795200,-197337600,-190857600,-184204800,-164505600,-152668800,-132969600,-121132800,-101433600,-86832e3,-71107200,-54777600,-39052800,-23328e3,-7603200,128131200,136598400,596937600,605059200,624412800,636508800,656467200,667958400,687916800,699408e3,719366400,731462400,938912400,952041600,1198972800,1205625600,1224374400,1237075200,1924981200],offset:[-14028,-15408,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-10800,-10800,-7200,-10800,-7200,-10800]},"America/Sao_Paulo":{time:[-1767225600,-1206968400,-1191369600,-1175385600,-1159833600,-633830400,-622076400,-602294400,-59184e4,-570758400,-560217600,-539136e3,-53136e4,-195436800,-184204800,-155174400,-150076800,-128908800,-121132800,-99964800,-89596800,-68428800,-57974400,499737600,511228800,530582400,540259200,562118400,571190400,592963200,602035200,624412800,634694400,656467200,666748800,687916800,697593600,719971200,728438400,750816e3,761702400,782265600,793152e3,813715200,823996800,84456e4,856051200,876096e3,888710400,908064e3,919555200,938908800,951609600,970963200,982454400,1003017600,1013904e3,1036281600,1045353600,1066521600,1076803200,1099353600,1108857600,1129420800,1140307200,1162684800,1172361600,119232e4,1203206400,1224374400,1234656e3,1255824e3,1266710400,1287273600,129816e4,1318723200,1330214400,1350777600,1361059200,1382227200,1392508800,1413676800,1424563200,1445126400,1456012800,1476576e3,1487462400,1508025600,1518912e3,154008e4,1550361600,1571529600,1581811200,1602979200,1613865600,1634428800,1645315200,1665878400,1677369600,1697328e3,1708214400,1729382400,1739664e3,1760832e3,1771718400,1792281600,1803168e3,1823731200,1834617600,1855180800,1866067200,1887235200,1897516800,1918684800,1928966400],offset:[-11188,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200]},"America/Bogota":{time:[-2707689600,-1739059200,704851200,733881600,1924974e3],offset:[-17776,-17776,-18e3,-14400,-18e3]},"Europe/Moscow":{time:[-2840140800,-1688256e3,-165681e4,-1641340800,-1627956e3,-1618700400,-1596416400,-1593813600,-1589846400,-1542416400,-1539478800,-1525305600,-1522713600,-1491177600,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670388400,686113200,695786400,701823600,717548400,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1414288800,1925002800],offset:[9017,9017,9079,12679,9079,16279,12679,16279,14400,10800,14400,18e3,14400,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800]},"Europe/Athens":{time:[-2344636800,-1686095940,-1182988800,-1178150400,-906854400,-904867200,-85725e4,-844473600,-828230400,-812419200,-552355200,-541641600,166492800,186195600,198036e3,213764400,228880800,244090800,260330400,275457600,291805200,307418400,323395200,338947200,354682800,370411200,386132400,401860800,417582e3,433310400,449031600,465364800,481086e3,496814400,512535600,528264e3,543985200,559713600,575434800,591163200,606884400,622612800,638334e3,654667200,670388400,686116800,701838e3,717566400,733287600,749016e3,764737200,780465600,796186800,811915200,828241200,846388800,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5692,5692,7200,10800,7200,10800,7200,3600,7200,3600,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Berlin":{time:[-2422051200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-776552400,-765925200,-761173200,-748476e3,-733266e3,-717627600,-714603600,-71037e4,-701902800,-684972e3,-670453200,-654127200,-639003600,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3208,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/London":{time:[-3852662400,-1691964e3,-1680469200,-1664143200,-1650142800,-1633903200,-1617483600,-1601848800,-1586034e3,-1570399200,-1552165200,-1538344800,-152253e4,-15075e5,-1490562e3,-1473631200,-1460926800,-1442786400,-1428872400,-1410732e3,-1396213200,-1379282400,-1364763600,-1348437600,-1333314e3,-1315778400,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-118998e4,-1175461200,-1159135200,-1143406800,-1126476e3,-1111957200,-1095631200,-1080507600,-1063576800,-1049058e3,-1032127200,-1017608400,-1001282400,-986158800,-969228e3,-950475600,-942012e3,-904514400,-896043600,-875484e3,-864594e3,-844034400,-832539600,-812584800,-798066e3,-781048800,-772059600,-764802e3,-748476e3,-733352400,-719445600,-717026400,-706741200,-699483600,-687996e3,-668034e3,-654732e3,-636584400,-622072800,-605739600,-590623200,-57429e4,-558568800,-542235600,-527119200,-512600400,-496274400,-481150800,-46422e4,-449701200,-432165600,-417646800,-401320800,-386197200,-369266400,-354747600,-337816800,-323298e3,-306972e3,-291848400,-276732e3,-257979600,-245282400,-22653e4,-213228e3,-195080400,-182383200,-163630800,-150933600,-132181200,-119484e3,-100731600,-88034400,-68677200,-59004e3,57726e3,69818400,89175600,101268e3,120625200,132717600,152074800,164167200,183524400,196221600,214974e3,227671200,246423600,259120800,278478e3,290570400,309927600,32202e4,341377200,354675600,372823200,386125200,404272800,417574800,435722400,449024400,467776800,481078800,499226400,512528400,530676e3,543978e3,562125600,575427600,593575200,606877200,625629600,638326800,657079200,670381200,688528800,701830800,719978400,733280400,751428e3,76473e4,782877600,796179600,814327200,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-75,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Madrid":{time:[-2177452800,-1661734800,-1648425600,-1631926800,-1616889600,-1601254800,-1585353600,-1442451600,-1427673600,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1029114e3,-1017619200,-1002848400,-986169600,-969238800,-954115200,-940208400,-873075600,-862531200,-842835600,-828230400,-811386e3,-796003200,-779936400,-765414e3,-748486800,-733881600,-652323600,-639183600,135126e3,150253200,167180400,181702800,196815600,212547600,22887e4,243997200,260406e3,276051600,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[-884,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Paris":{time:[-2486678340,-1855958340,-1689814800,-1680393600,-1665363600,-1648339200,-1635123600,-1616889600,-1604278800,-158544e4,-1574038800,-1552262400,-1539997200,-1520553600,-1507510800,-1490572800,-1470618e3,-1459123200,-1444006800,-1427673600,-1411952400,-1396224e3,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1253494800,-1238371200,-1221440400,-1206921600,-1191200400,-1175472e3,-1160355600,-1143417600,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942012e3,-932432400,-85725e4,-844552800,-828219600,-812498400,-800064e3,-796258800,-781048800,-766616400,196822800,212547600,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[561,561,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Warsaw":{time:[-2840140800,-1717027200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1600466400,-1587157200,-1501718400,-931730400,-85725e4,-844552800,-828219600,-812498400,-796600800,-778723200,-762652800,-748483200,-733266e3,-715212e3,-701902800,-684972e3,-670453200,-654127200,-639003600,-397090800,-386805600,-371084400,-355356e3,-334191600,-323301600,-307580400,-291852e3,-271292400,-260402400,-239842800,-228952800,-208393200,-197503200,-176338800,-166053600,228877200,244000800,260326800,276055200,291776400,307504800,323830800,338954400,354675600,370404e3,386125200,401853600,417574800,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[5040,5040,3600,7200,3600,7200,3600,7200,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Australia/Sydney":{time:[-2364076800,-1672531140,-1665352800,-883605600,-876088800,-860364e3,-844639200,-828309600,-813189600,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,386737200,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,636519600,657079200,667969200,688528800,699418800,719978400,731473200,752032800,762922800,783482400,794372400,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,967341600,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],
offset:[36292,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600]},"Asia/Tokyo":{time:[-2587678861,-2335219200,-1017792e3,-683762400,-672357600,-654732e3,-640908e3,-620258400,-609458400,-588808800,-578008800,1925024400],offset:[33539,32400,32400,32400,36e3,32400,36e3,32400,36e3,32400,36e3,32400]},"Asia/Taipei":{time:[-2335219200,-1017792e3,-766191600,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-639100800,-620784e3,-607564800,-589248e3,-576028800,-562896e3,-541728e3,-528681600,-510192e3,-497145600,-478656e3,-465609600,-449798400,-433987200,-418176e3,-402451200,-38664e4,-370915200,-355104e3,-339379200,-323568e3,-302486400,-291945600,-270950400,-260409600,134006400,149817600,165542400,181353600,299635200,307584e3,1925020800],offset:[29160,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Singapore":{time:[-2177452800,-2038176e3,-1167609600,-1073001600,-894153600,-879638400,-766972800,-138758400,378691200,1925020800],offset:[24925,24925,25200,26400,26400,27e3,32400,27e3,27e3,28800]},"Asia/Shanghai":{time:[-2177452800,-933465600,-923097600,-908755200,-891561600,515548800,52704e4,545184e3,558489600,576633600,589939200,608688e3,621993600,640137600,653443200,671587200,684892800,1925020800],offset:[29143,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Seoul":{time:[-2524521600,-2053900800,-1325462400,-1199232e3,-1017792e3,-767318400,-498096e3,-303955200,-293500800,-264902400,-39484800,547603200,560908800,579052800,592358400,1925024400],offset:[30472,30600,32400,30600,32400,32400,32400,28800,32400,28800,30600,32400,36e3,32400,36e3,32400]},"Asia/Tehran":{time:[-1704153600,-757382400,247190400,259286400,277776e3,283996800,290822400,306547200,322444800,338515200,673228800,685497600,701222400,71712e4,732758400,748656e3,764294400,780192e3,795830400,811728e3,827366400,843264e3,858988800,874886400,890524800,906422400,922060800,937958400,953596800,969494400,985219200,1001116800,1016755200,1032652800,1048291200,1064188800,1079827200,1095724800,1111449600,1127347200,1206057600,1221955200,123768e4,1253577600,1269216e3,1285113600,1300752e3,1316649600,1332288e3,1348185600,1363910400,1379808e3,1395446400,1411344e3,1426982400,144288e4,1458518400,1474416e3,1490140800,1506038400,1521676800,1537574400,1553212800,1569110400,1584748800,1600646400,1616371200,1632268800,1647907200,1663804800,1679443200,1695340800,1710979200,1726876800,1742601600,1758499200,1774137600,1790035200,1805673600,1821571200,1837209600,1853107200,1868745600,1884643200,1900368e3,1916265600,1931904e3],offset:[12344,12344,12600,14400,18e3,14400,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600]},"Asia/Kolkata":{time:[-2840140800,-891561600,-872035200,-862617600,-764121600,1925011800],offset:[21208,21200,23400,19800,23400,19800]},"Asia/Hong_Kong":{time:[-2056665600,-907360200,-891635400,-884217600,-766713600,-747952200,-728512200,-717021e3,-694470600,-683757e3,-668032200,-654726600,-636582600,-623277e3,-605133e3,-591827400,-573683400,-559773e3,-542320200,-528323400,-510179400,-498083400,-478729800,-466633800,-446675400,-435184200,-415225800,-403129800,-383776200,-371680200,-352326600,-340230600,-320877e3,-308781e3,-288822600,-277331400,-257373e3,-245881800,-225923400,-213827400,-194473800,-182377800,-163024200,-148509e3,-132784200,-117059400,-101334600,-85609800,-69280200,-53555400,-37830600,-22105800,-6381e3,9343800,25068600,40793400,56518200,72243e3,88572600,104297400,120022200,126070200,151471800,167196600,182921400,198646200,214371e3,295414200,309324600,1925020800],offset:[27402,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Bangkok":{time:[-2840140800,-1570060800,1925017200],offset:[24124,24124,25200]}};return"undefined"!=typeof module&&module.exports?module.exports=e:this.TzData=e,e}(this),this.PineJsCalendar=PineJsCalendar=function(){function e(e){this._name=e;var i=t[e];if(i||("UTC"!==e&&"Etc/UTC"!==e&&console.error("unknown timezone: "+e),i={time:[],offset:[]}),i.time.length!==i.offset.length&&(console.error("timezone transition table doesn't match offset table"),i={time:[],offset:[]}),!i.time_utc){e=i.time;for(var n=i.offset,o=e.length,r=Array(o),s=0;o>s;s++)e[s]*=1e3,n[s]*=1e3,r[s]=e[s]-n[s];i.time_utc=r}this.tz=i}var t=this.TzData?this.TzData:require("./tzdata.js");e.prototype.offset_utc=function(t){return e._offset(this.tz.time_utc,this.tz.offset,t)},e.prototype.offset_loc=function(t){return e._offset(this.tz.time,this.tz.offset,t)},e._offset=function(e,t,i){e:{var n=e.length;if(0===n)e=-1;else for(var o=0,r=n-1,s=(o+r)/2|0;;){if(e[s]>i){if(r=s-1,o>r){e=s;break e}}else if(o=s+1,o>r){e=n-1>s?s+1:-1;break e}s=(o+r)/2|0}}return-1===e?0:t[e]};var i={SUNDAY:1,MONDAY:2,TUESDAY:3,WEDNESDAY:4,THURSDAY:5,FRIDAY:6,SATURDAY:7,JANUARY:0,DECEMBER:11,YEAR:1,MONTH:2,WEEK_OF_YEAR:3,DAY_OF_MONTH:5,DAY_OF_YEAR:6,DAY_OF_WEEK:7,HOUR_OF_DAY:11,MINUTE:12,SECOND:13,minutesPerDay:1440,secondsPerDay:864e5,get_year:function(e){return e.getUTCFullYear()},get_month:function(e){return e.getUTCMonth()},get_hours:function(e){return e.getUTCHours()},get_minutes:function(e){return e.getUTCMinutes()},get_seconds:function(e){return e.getUTCSeconds()},get_day_of_month:function(e){return e.getUTCDate()},get_day_of_week:function(e){return e.getUTCDay()+1},get_day_of_year:function(e){var t=Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0);return((e.getTime()-t)/i.secondsPerDay|0)+1},get_week_of_year:function(e){var t=Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0);return e=i.clone(e),i.set_hms(e,0,0,0,0),e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7)),((e.getTime()-t)/i.secondsPerDay+1)/7|0},get_minutes_from_midnight:function(e){return 60*i.get_hours(e)+i.get_minutes(e)},set_hms:function(e,t,i,n,o){e.setUTCHours(t),e.setUTCMinutes(i),e.setUTCSeconds(n),e.setUTCMilliseconds(o)},add_days_considering_dst:function(e,t,i){var n=e.offset_utc(t);return t=this.clone(t),this.add_date(t,i),e=e.offset_utc(t),t.setTime(t.getTime()+n-e),t},add_date:function(e,t){e.setTime(e.getTime()+t*i.secondsPerDay)},clone:function(e){return new Date(e.getTime())},get_days_per_year:function(e){return e=e.getUTCFullYear(),this.days_per_year(e)},days_per_year:function(e){return 0!==e%4||0===e%100&&0!==e%400?365:366},get_part:function(e,t){switch(t){case i.YEAR:return i.get_year(e);case i.MONTH:return i.get_month(e);case i.DAY_OF_MONTH:return i.get_day_of_month(e);case i.WEEK_OF_YEAR:return i.get_week_of_year(e);case i.DAY_OF_WEEK:return i.get_day_of_week(e);case i.HOUR_OF_DAY:return i.get_hours(e);case i.MINUTE:return i.get_minutes(e);case i.DAY_OF_YEAR:return i.get_day_of_year(e);case i.SECOND:return i.get_seconds(e);default:return e.getTime()}},time_minutes:function(e){return 6e4*e},time_minutes_diff:function(e,t){return((e/1e3|0)-(t/1e3|0))/60|0},utc_to_cal:function(e,t){var i=e.offset_utc(t);return new Date(t+i)},get_cal:function(e,t,i,n){return t=new Date(Date.UTC(t,i,n)),e=e.offset_utc(+t),new Date(t.valueOf()-e)},cal_to_utc:function(e,t){var i=t.getTime(),n=e.offset_loc(i);return i-n},get_timezone:function(t){return new e(t)},shift_day:function(e,t){var i;return i=e-1+t,i>6?i%=7:0>i&&(i=(7+i%7)%7),i+1}};return"undefined"!=typeof module&&module.exports?module.exports=i:this.PineJsCalendar=i,i}(this),this.PineJsBarBuilder=PineJsBarBuilder=function(){function e(e,t){switch(e){case"D":return new g(t);case"W":return new m(t);case"M":return new _(t)}return console.error("unknown dwm resolution: "+e),null}function t(e,t,i){var n=t;e.moveTo(n);for(var o=[],r=0,s=0;!i(o,n);){if(r>5)throw console.trace(["0x10",new Date(t),"->",new Date(n)]),"Internal error 0x10 while extrapolating.";if(n=e.indexOfBar(n),-1===n)n=e.startOfBar(0);else if(-2===n)n=e.startOfBar(-2);else{var a=e.startOfBar(n);if(a!=t){if(s&&s==a)throw console.trace(["0x11",new Date(t),"->",new Date(a)]),"Internal error 0x11 while extrapolating.";s=a,r=0,o.push(a)}n=e.startOfBar(n+1)}e.moveTo(n),r++}return o}function i(e){if(isNaN(e))return NaN;var t=this.indexOfBar(e);return-2===t&&(this.moveTo(e),t=this.indexOfBar(e)),0>t?NaN:this.startOfBar(t)}function n(e,t){this.period=e,this.session=t,this.sessionEnd=this.sessionStart=Number.MIN_VALUE}function o(e,t,i,n){this.period=i,this.sessionTgt=e,this.sessionSrc=t||e,this.builder=n,this.periodStart=-Number.MAX_VALUE,this.periodEnd=-Number.MAX_VALUE,this.periodLastBarStart=-Number.MAX_VALUE}function r(e,t,i){var n=C.get_day_of_week(t),o=C.get_minutes_from_midnight(t);e=e.findSession(n,o);var o=e.dayOfWeek(),r=e.isOvernight(),n=(o-n+7)%7-(r?1:0);return 0!==n&&C.add_date(t,n),n=e.start(),C.set_hms(t,n/60|0,n%60,0,0),n=e.length(),e=new Date(t.valueOf()+6e4*n),t=i.offset_loc(t)/6e4,i=i.offset_loc(e)/6e4,n+(t-i)}function s(e,t,i){return i=C.clone(i),r(t,i,e),C.cal_to_utc(e,i)}function a(e,t){var i=C.get_day_of_week(t)-e.firstDayOfWeek;return 0>i?i+7:i}function l(e,t){var i=t+e.firstDayOfWeek;return i>C.SATURDAY?i-C.SATURDAY:i}function d(e,t){var i=C.get_day_of_year(t)-1,n=a(e,t)-i%7;return 0==n?i/7|0:(n>=0&&(n-=7),(n+i)/7|0)}function h(e,t,i){for(var n=0;i>t;++t)n+=e.isWeekEnd(l(e,t))?1:0;return n}function c(e,t){var i=new Date(Date.UTC(t,11,31,23,59)),n=C.days_per_year(t)-p(e,i);return C.get_day_of_week(i)!==C.SUNDAY&&C.get_day_of_week(i)!==C.SATURDAY||n--,n}function p(e,t){var i=C.get_day_of_year(t)-1,n=a(e,t),o=n-i%7;0>o&&(o+=7);var r=0;return 7-o>i?r+=h(e,o,n):(i=0==o?0:h(e,o,7),r+=h(e,0,n)+i),r+d(e,t)*e.weekEndsCount()}function u(){}function f(e){this.sessionsSpec=e}function g(e){this.session=e}function m(e){this.session=e}function _(e){this.session=e}function v(e,t,i){this._dayOfWeek=e,this._start=t,this._length=i}function y(e,t){return e.compareTo(t)}function w(e){function t(e){var t=e.split(";");if(2<t.length)return console.error("Only one `first day` specification expected @ session "+e),e;if(1==t.length)return e;var n=1,o=0<=t[0].indexOf("-")?NaN:parseInt(t[0]);return isNaN(o)&&(n=0,o=parseInt(t[1])),o<C.SUNDAY||o>C.SATURDAY?(console.error("Unexpected day index @ session: "+e+"; day index "+o),e):(i.firstDayOfWeek=o,t[n])}var i=this;if(e=e||"0000-0000",this.entries=[],this.firstDayOfWeek=C.MONDAY,"24x7"===e.toLowerCase())A.forEach(function(e){this.addSessionEntry(e,0,0)},this);else{e=t(e);var n=!1,o={};e.split("|").forEach(function(e){var t=e.split(":");1!==t.length&&2!==t.length&&console.error("bad session section: "+e);var i=1===t.length;i&&(n&&console.error("duplicated default section: "+e),n=!0),(i?P:b(t[1])).forEach(function(e){i&&o[e]||(o[e]=t[0])},this)},this),A.forEach(function(t){var i=o[t];i&&i.split(",").forEach(function(i){var n=i.split("-");2!==n.length&&(console.error("bad sessions spec: "+e),n=["0000","0000"]),i=parseInt(n[0]),n=parseInt(n[1]),this.addSessionEntry(t,i%100+60*(i/100|0),n%100+60*(n/100|0))},this)},this)}this.entries.sort(y)}function b(e){for(var t=[],i=0;i<e.length;i++){var n=e.charAt(i)-0;-1===t.indexOf(n)&&t.push(n)}return t}function T(){}function S(e,t,i){var n=e.length;if(0===n)return-1;for(var o=0,r=n-1,s=(o+r)/2|0;;){var a=i(e[s],t);if(0===a||a>0){if(r=s-1,o>r)return s}else if(o=s+1,o>r)return n-1>s?s+1:-1;s=(o+r)/2|0}}var C=this.PineJsCalendar?this.PineJsCalendar:require("./calendar.js"),x={D:864e5,W:6048e5,M:2592e6};n.prototype.alignTime=i,n.prototype.indexOfBar=function(e){return e<this.sessionStart?-1:e>=this.sessionEnd?-2:C.time_minutes_diff(e,this.sessionStart)/this.period|0},n.prototype.startOfBar=function(e){if(-2===e)return this.sessionEnd;if(0>e)throw"Negative offset is not supported";return this.sessionStart+C.time_minutes(this.period*e)},n.prototype.isLastBar=function(e,t){var i=this.sessionStart+C.time_minutes(this.period*(e+1)-1);return t>=i},n.prototype.moveTo=function(e){var t=this.session.timezone;e=C.utc_to_cal(t,e);var i=r(this.session.spec,e,this.session.timezone);this.sessionStart=C.cal_to_utc(t,e),this.sessionEnd=this.sessionStart+C.time_minutes(i)},o.prototype.alignTime=i,o.prototype.indexOfBar=function(e){return e<this.periodStart?-1:e>=this.periodEnd?-2:0},o.prototype.startOfBar=function(e){if(-2===e||e>0)return this.periodEnd;if(-1===e)throw"PRE_SESSION is not supported";return this.periodStart},o.prototype.isLastBar=function(e,t){return t>=this.periodLastBarStart},o.prototype.moveTo=function(e){var t=C.utc_to_cal(this.sessionSrc.timezone,e);e=this.sessionSrc.spec;var t=C.clone(t),i=C.get_day_of_week(t),n=C.get_minutes_from_midnight(t);e.findSession(i,n).isOvernight()&&C.add_date(t,1),C.set_hms(t,0,0,0,0),i=(this.builder.indexOfPeriod(t)/this.period|0)*this.period,e=this.sessionTgt.timezone;var n=C.get_year(t),t=this.sessionTgt.spec,o=this.builder.startOfPeriod(e,i,n);this.periodStart=s(e,t,o),i=this.builder.startOfPeriod(e,i+this.period,n),this.periodEnd=s(e,t,i)},o.prototype.moveToPrevWorkDay=function(e,t){for(;e.isWeekEnd(C.get_day_of_week(t));)C.add_date(t,-1)},u.prototype.indexOfPeriod=function(e){return C.get_day_of_year(e)-1},u.prototype.startOfPeriod=function(e,t,i){return i=C.get_cal(e,i,C.JANUARY,1),t=C.add_days_considering_dst(e,i,t),C.utc_to_cal(e,+t)},f.prototype.uber=new u,f.prototype.indexOfPeriod=function(e){return this.uber.indexOfPeriod(e)-p(this.sessionsSpec,e)},f.prototype.startOfPeriod=function(e,t,i){function n(e,t){for(var i=0,n=e;7>n&&(s.sessionsSpec.isWeekEnd(l(s.sessionsSpec,n))||!(0>--t));++n)i++;return i}function o(e,t,i){var n=0,o=0;for(e=i%(7-s.sessionsSpec.weekEndsCount())-(0==e?0:t.businessDays);7>o&&e>0;++o){var r=s.sessionsSpec.isWeekEnd(l(s.sessionsSpec,o)),n=n+(r?1:0);e-=r?0:1}return n=t.weekEnds+n,t=(i-t.businessDays)/(7-s.sessionsSpec.weekEndsCount())|0,t=n+s.sessionsSpec.weekEndsCount()*t,i+t}var r=c(this.sessionsSpec,i);t>=r&&(i++,t=0);var s=this,r=new Date(Date.UTC(i,C.JANUARY,1)),r=a(this.sessionsSpec,r),d=new function(e,t){this.weekEnds=h(e,t,7),this.calendarDays=7-t,this.businessDays=this.calendarDays-this.weekEnds}(this.sessionsSpec,r);return t=t<d.businessDays?n(r,t):o(r,d,t),this.uber.startOfPeriod(e,t,i)},g.prototype.indexOfPeriod=function(e){return this.builder().indexOfPeriod(e)},g.prototype.startOfPeriod=function(e,t,i){return this.builder().startOfPeriod(e,t,i)},g.prototype.builder=function(){return this._builder||(this._builder=this.session.spec.hasWeekEnds()?new f(this.session.spec):new u),this._builder},m.prototype.indexOfPeriod=function(e){return d(this.session.spec,e)},m.prototype.startOfPeriod=function(e,t,i){var n=new Date(Date.UTC(i,C.JANUARY,1)),o=a(this.session.spec,n);return t=0===o?7*t:7*(t+1)-o,n=C.get_days_per_year(n),t>n?this.startOfPeriod(e,0,i+(t/n|0)):(i=C.get_cal(e,i,C.JANUARY,1),i=C.add_days_considering_dst(e,i,t),C.utc_to_cal(e,+i))},_.prototype.indexOfPeriod=function(e){return C.get_month(e)},_.prototype.startOfPeriod=function(e,t,i){if(0>t){var n=(-t+11)/12|0;i-=n,t+=12*n}else if(t>C.DECEMBER)return C.utc_to_cal(e,+C.get_cal(e,i+1,C.JANUARY,1));return t=C.get_cal(e,i,t,1),i=a(this.session.spec,t),i>4&&C.add_date(t,7-i),C.utc_to_cal(e,+t)},v.prototype.start=function(){return 0>this._start?this._start+C.minutesPerDay:this._start},v.prototype.isOvernight=function(){return 0>this._start},v.prototype.dayOfWeek=function(){return this._dayOfWeek},v.prototype.length=function(){return this._length},v.prototype.weight=function(){return this._dayOfWeek*C.minutesPerDay+this._start},v.prototype.compareTo=function(e){var t=this.weight(),i=t+this._length;return e=e.weight(),e>=t&&i>e?0:t>e?1:-1};var P=[C.MONDAY,C.TUESDAY,C.WEDNESDAY,C.THURSDAY,C.FRIDAY],A=[C.SUNDAY,C.MONDAY,C.TUESDAY,C.WEDNESDAY,C.THURSDAY,C.FRIDAY,C.SATURDAY];w.prototype.addSessionEntry=function(e,t,i){t>=i&&0!=t&&(t-=C.minutesPerDay),this.entries.push(new v(e,t,i==t?C.minutesPerDay:i-t))},w.prototype.isWeekEnd=function(e){var t=S(this.entries,new v(e,0,0),function(e,t){return e.dayOfWeek()-t.dayOfWeek()});return 0>t||this.entries[t].dayOfWeek()!=e},w.prototype.hasWeekEnds=function(){return 0<this.weekEndsCount()},w.prototype.weekEndsCount=function(){if(void 0==this._weekEndsCount){var e=[];this.entries.forEach(function(t){e[t.dayOfWeek()]=1},this),this._weekEndsCount=7-e.reduce(function(e,t){return e+(t||0)},0)}return this._weekEndsCount},w.prototype.indexOfSession=function(e,t){var i=S(this.entries,new v(e,t,0),y);return-1===i?0:i},w.prototype.findSession=function(e,t){return this.entries[this.indexOfSession(e,t)]},T.prototype.init=function(e,t){return this.timezone="string"==typeof e?C.get_timezone(e):e,this.spec=new w(t),this};var L={PRE_SESSION:-1,POST_SESSION:-2,LASTBAR_SESSION:-3,newBarBuilder:function(t,i,r,s){return""===t?new n(i,r):new o(r,s,i,e(t,r))},Session:T,alignPeriodsBack:function(e,t,i,n,o){e=(new T).init("UTC",e);var r=""!=t;return r?(i*=x[t],t=x.D):(i*=6e4,t=6e4*e.spec.findSession(0,0)._length),t/=i,e=(r?7:e.spec.hasWeekEnds()?5:7)*t,e>n?o-n/t*x.D:o-n/e*x.W},extrapolateBarsFrontByCount:function(e,i,n){return t(e,i,function(e,t){return e.length>=n})},extrapolateBarsFrontToTime:function(e,i,n){return t(e,i,function(e,t){return t>n})},lower_bound:S,isTradingNow:function(e,t){var i=PineJsCalendar.utc_to_cal(t.timezone,+e),n=C.get_day_of_week(i),i=C.get_minutes_from_midnight(i),o=t.spec.findSession(n,i);return n==o._dayOfWeek&&i>=o._start&&i<o._start+o._length},alignToStartOfSession:r,numberOfFullWeeks:d,numberOfWeekEndsSinceYearStart:p,BusinessDaysBuilder:f,alignExchangeTimeToSessionStartAndReturnUTC:s};return"undefined"!=typeof module&&module.exports?module.exports=L:this.PineJsBarBuilder=L,L}.call(this),this.PineJS=PineJS=function(){function e(e,t,i,n,o){if(i=o,o=0,isNaN(e.get(t-1)))return{index:NaN,value:NaN};for(var r=0;t>r;++r)n(e.get(r),i)&&(o=r,i=e.get(r));return{index:o,value:i}}function t(e,t){return 100*e/t}function i(e,t,i,n,o){this._areaRight=e,this._areaLeft=t,this._pivotType=i,this._series=n,this._currentIndex=o.new_var(0),this._currentValue=o.new_var(NaN),this._pivotIndex=o.new_var(-1),this._index=m.n(o),this._isNewBar=o.symbol.isNewBar,e=this._currentIndex.get(1),t=this._currentValue.get(1),i=this._pivotIndex.get(1),1<this._index&&(this._currentIndex.set(e),this._currentValue.set(t),this._pivotIndex.set(i))}function n(e,t,n){this._deviation=e,e=n.new_var(m.high(n));var o=n.new_var(m.low(n));e.get(2*t+1),o.get(2*t+1),this._pivotHigh=new i(t,t,i.HIGH,e,n),this._pivotLow=new i(t,t,i.LOW,o,n),this._lastVal=n.new_var(NaN),this._lastIndex=n.new_var(-1),this._lastType=n.new_var(),this._index=m.n(n),this._isNewBar=n.symbol.isNewBar,this._isBarClosed=n.symbol.isBarClosed,t=this._lastIndex.get(1),n=this._lastVal.get(1),e=this._lastType.get(1),1<this._index&&this.addPivot(t,n,e),this.processPivot(this._pivotHigh),this.processPivot(this._pivotLow)}function o(e){this.symbol=e,this.vars=[],this.vars_index=0,this.ctx=[],this.ctx_index=0}function r(e){this.mindepth=0,this.original=NaN,this.modified=!1,this.symbol=e}function s(e,t,i,n){this.periodBase=i,this.tickerid=e,this.period=t,this.index=-1,this.updatetime=this.volume=this.close=this.low=this.high=this.open=this.time=NaN,this.isBarClosed=this.isNewBar=!1,this.session=new g.Session,this.other_sessions={},this.script=n,this.ticker=s.parseTicker(e),e=s.parsePeriod(t),this.resolution=e.resolution,this.interval=e.interval,this.bb_cache={}}function a(e,t,i,n,r,s,a){this.body=r,this.symbols=[],this.runner=n,this.inputCallback=a,this.out=s,this.ctx=new o(this.add_sym(e,t,i)),this.init()}function l(e){this.symbols=[],this.barsets=[],this.subscription=[],this.host=e,this.isRecalculated=!1,this.start()}function d(e){this.runner=new l(e)}function h(e,t,i){this.info=e,this.cloneData=i,this.bars=t?i?TradingView.clone(t):t:[],this.isBarClosed=!0,this.dwm_aligner=void 0}function c(e,t){this.period=e,this.generateEmptyBars=!!t}function p(){}function u(){}var f=this.PineJsCalendar?this.PineJsCalendar:require("./calendar.js"),g=this.PineJsBarBuilder?this.PineJsBarBuilder:require("./barbuilder.js"),m={max_series_size:5e3,n:function(e){return e.symbol.index+1},nz:function(e,t){return t=t||0,isFinite(e)?e:t},na:function(e){return 0==arguments.length?NaN:isNaN(e)?1:0},isZero:function(e){return 1e-10>=Math.abs(e)},toBool:function(e){return isFinite(e)&&!m.isZero(e)},eq:function(e,t){return m.isZero(e-t)},neq:function(e,t){return!m.eq(e,t)},ge:function(e,t){return m.isZero(e-t)||e>t},gt:function(e,t){return!m.isZero(e-t)&&e>t},lt:function(e,t){return!m.isZero(e-t)&&t>e},le:function(e,t){return m.isZero(e-t)||t>e},and:function(e,t){return isNaN(e)||isNaN(t)?NaN:m.isZero(e)||m.isZero(t)?0:1},or:function(e,t){return isNaN(e)||isNaN(t)?NaN:m.isZero(e)&&m.isZero(t)?0:1},not:function(e){return isNaN(e)?NaN:m.isZero(e)?1:0}};m.max=Math.max,m.min=Math.min,m.pow=Math.pow,m.abs=Math.abs,m.log=Math.log,m.log10=function(e){return Math.log(e)/Math.LN10},m.sqrt=Math.sqrt,m.sign=function(e){return isNaN(e)?NaN:m.isZero(e)?0:e>0?1:-1},m.exp=Math.exp,m.sin=Math.sin,m.cos=Math.cos,m.tan=Math.tan,m.asin=Math.asin,m.acos=Math.acos,m.atan=Math.atan,m.floor=Math.floor,m.ceil=Math.ceil,m.round=Math.round,m.avg=function(e,t,i,n,o,r){if(2===arguments.length)return(e+t)/2;for(var s=0,a=0;a<arguments.length;a++)s+=arguments[a];return s/arguments.length},m.open=function(e){return e.symbol.open},m.high=function(e){return e.symbol.high},m.low=function(e){return e.symbol.low},m.close=function(e){return e.symbol.close},m.hl2=function(e){return(e.symbol.high+e.symbol.low)/2},m.hlc3=function(e){return(e.symbol.high+e.symbol.low+e.symbol.close)/3},m.ohlc4=function(e){return(e.symbol.open+e.symbol.high+e.symbol.low+e.symbol.close)/4},m.volume=function(e){return e.symbol.volume},m.time=function(e,t,i){return e.symbol.bartime(t,i)},m.period=function(e){return e.symbol.period},m.tickerid=function(e){return e.symbol.tickerid},m.ticker=function(e){return e.symbol.ticker},m.interval=function(e){return e.symbol.interval},m.isdwm=function(e){return e.symbol.isdwm()},m.isintraday=function(e){return!e.symbol.isdwm()},m.isdaily=function(e){return"D"===e.symbol.resolution},m.isweekly=function(e){return"W"===e.symbol.resolution},m.ismonthly=function(e){return"M"===e.symbol.resolution},m.year=function(e,t){return m.timepart(e.symbol,f.YEAR,t)},m.month=function(e,t){return m.timepart(e.symbol,f.MONTH,t)},m.weekofyear=function(e,t){return m.timepart(e.symbol,f.WEEK_OF_YEAR,t)},m.dayofmonth=function(e,t){return m.timepart(e.symbol,f.DAY_OF_MONTH,t)},m.dayofweek=function(e,t){return m.timepart(e.symbol,f.DAY_OF_WEEK,t)},m.hour=function(e,t){return m.timepart(e.symbol,f.HOUR_OF_DAY,t)},m.minute=function(e,t){return m.timepart(e.symbol,f.MINUTE,t)},m.second=function(e,t){return m.timepart(e.symbol,f.SECOND,t)},m.iff=function(e,t,i){return m.not(e)?i:t},m.rising=function(e,t){for(var i=1;t+1>i;++i)if(e.get(i)>e.get(0))return 0;return 1},m.falling=function(e,t){for(var i=1;t+1>i;++i)if(e.get(i)<e.get(0))return 0;return 1},m.timepart=function(e,t,i){return e=f.utc_to_cal(e.timezone,i||e.bartime()),f.get_part(e,t)},m.rsi=function(e,t){return m.isZero(t)?100:m.isZero(e)?0:100-100/(1+e/t)},m.sum=function(e,t,i){return i=i.new_var(),e=m.nz(e.get())+m.nz(i.get(1))-m.nz(e.get(t)),i.set(e),e},m.sma=function(e,t,i){return i=m.sum(e,t,i),m.na(e.get(t-1))?NaN:i/t},m.rma=function(e,t,i){var n=m.sum(e,t,i),o=t-1,r=e.get(o);i=i.new_var();var s=i.get(1);return e=e.get(),t=m.na(r)?NaN:m.na(s)?n/t:(e+s*o)/t,i.set(t),t},m.fixnan=function(e,t){var i=t.new_var();return isNaN(e)?i.get(1):(i.set(e),e)},m.tr=function(e){var t=e.new_var(m.close(e));return m.max(m.max(m.high(e)-m.low(e),m.abs(m.high(e)-t.get(1))),m.abs(m.low(e)-t.get(1)))},m.atr=function(e,t){var i=t.new_var(m.tr(t));return m.sma(i,e,t)},m.ema=function(e,t,i){var n=m.sum(e,t,i);i=i.new_var();var o=e.get(0);e=e.get(t-1);var r=i.get(1);return t=m.na(e)?NaN:m.na(r)?n/t:2*(o-r)/(t+1)+r,i.set(t),t},m.wma=function(e,t,i){i=0;for(var n=t=Math.round(t);n>=0;n--)i+=(t-n)*e.get(n);return 2*i/(t*(t+1))},m.vwma=function(e,t,i){var n=i.new_var(m.volume(i));return e=i.new_var(e.get(0)*m.volume(i)),m.sma(e,t,i)/m.sma(n,t,i)},m.swma=function(e,t){return(e.get(0)+2*e.get(1)+2*e.get(2)+e.get(3))/6},m.lowestbars=function(t,i,n){return-e(t,i,n,function(e,t){return m.lt(e,t)},Number.MAX_VALUE).index},m.lowest=function(t,i,n){return e(t,i,n,function(e,t){return m.lt(e,t)},Number.MAX_VALUE).value},m.highestbars=function(t,i,n){return-e(t,i,n,function(e,t){return m.gt(e,t)},Number.MIN_VALUE).index},m.highest=function(t,i,n){return e(t,i,n,function(e,t){return m.gt(e,t)},Number.MIN_VALUE).value},m.cum=function(e,t){var i=t.new_var(),n=m.nz(i.get(1))+e;return i.set(n),n},m.accdist=function(e){m.open(e);var t=m.high(e),i=m.low(e),n=m.close(e),o=m.volume(e);return m.cum(n==t&&n==i||t==i?0:o*(2*n-i-t)/(t-i),e)},m.correlation=function(e,t,i,n){var o=m.sma(e,i,n),r=m.sma(t,i,n),s=n.new_var(e.get()*t.get());return(m.sma(s,i,n)-o*r)/Math.sqrt(m.variance2(e,o,i)*m.variance2(t,r,i))},m.stoch=function(e,i,n,o,r){return i=m.highest(i,o),n=m.lowest(n,o),m.fixnan(t(e.get()-n,i-n),r)},m.tsi=function(e,t,i,n){var o=n.new_var(m.change(e));return e=n.new_var(m.abs(m.change(e))),o=n.new_var(m.ema(o,i,n)),i=n.new_var(m.ema(e,i,n)),o=m.ema(o,t,n),t=m.ema(i,t,n),o/t},m.cross=function(e,t,i){return isNaN(e)||isNaN(t)?!1:(e=i.new_var(function(e){return 0>e?-1:0==e?0:1}(e-t)),!isNaN(e.get(1))&&e.get(1)!=e.get())},m.linreg=function(e,t,i){for(var n=0,o=0,r=0,s=0,a=0;t>a;++a)var l=e.get(a),d=t-1-a+1,n=n+d,o=o+l,r=r+d*d,s=s+l*d;return e=(t*s-n*o)/(t*r-n*n),o/t-e*n/t+e+e*(t-1-i)},m.sar=function(e,t,i,n){function o(t,i){var n=c.get();return p.set(t),c.set(i),u.set(1e3*e),f.set(n),n}var r=m.high(n),s=m.low(n),a=m.close(n),l=n.new_var(r),d=n.new_var(s),h=n.new_var(a).get(1),d=d.get(1),l=l.get(1),c=n.new_var(),p=n.new_var(),u=n.new_var(),f=n.new_var();if(n=f.get(1),isNaN(h))return NaN;if(isNaN(n)&&(m.ge(a,h)?(p.set(1),c.set(Math.max(r,l)),n=Math.min(s,d)):(p.set(-1),n=Math.max(r,l),c.set(Math.min(s,d))),u.set(1e3*e)),1==p.get()){if(m.gt(r,c.get())&&(c.set(r),u.set(Math.min(u.get()+1e3*t,1e3*i))),m.le(s,n))return o(-1,s)}else if(m.lt(s,c.get())&&(c.set(s),u.set(Math.min(u.get()+1e3*t,1e3*i))),m.ge(r,n))return o(1,r);return t=n+u.get()*(c.get()-n)/1e3,1==p.get()?m.ge(t,s)&&(t=s-1e-7):m.le(t,r)&&(t=r+1e-7),f.set(t),t},m.alma=function(e,t,i,n){i=Math.floor(i*(t-1));var o=t/n*(t/n);n=[];for(var r=0,s=0;t>s;++s){var a=Math.exp(-1*Math.pow(s-i,2)/(2*o)),r=r+a;n.push(a)}for(s=0;t>s;++s)n[s]/=r;for(s=i=0;t>s;++s)i+=n[s]*e.get(t-s-1);return i},m.wvap=function(e,t){return e.get()-e.get(1)},m.change=function(e){return e.get()-e.get(1)},m.roc=function(e,t){var i=e.get(t);return 100*(e.get()-i)/i},m.dev=function(e,t,i){return i=m.sma(e,t,i),m.dev2(e,t,i)},m.dev2=function(e,t,i){for(var n=0,o=0;t>o;o++)var r=e.get(o),r=m.abs(r-i),n=n+r;return n/t},m.stdev=function(e,t,i){return e=m.variance(e,t,i),m.sqrt(e)},m.variance=function(e,t,i){return i=m.sma(e,t,i),m.variance2(e,i,t)},m.variance2=function(e,t,i){for(var n=0,o=0;i>o;o++)var r=e.get(o),r=m.abs(r-t),n=n+r*r;return n/i},m.percentrank=function(e,t){if(m.na(e.get(t-1)))return NaN;for(var i=0,n=e.get(),o=1;t>o;o++){var r=e.get(o);m.ge(n,r)&&i++}return 100*i/t},i.LOW=0,i.HIGH=1,i.prototype.isPivotFound=function(){return-1!=this._pivotIndex.get()},i.prototype.pivotIndex=function(){return this._pivotIndex.get()},i.prototype.currentValue=function(){return this._currentValue.get()},i.prototype.pivotType=function(){return this._pivotType},i.prototype.reset=function(){this._currentValue.set(NaN),this._currentIndex.set(0),this._pivotIndex.set(-1)},i.prototype.isRightSideOk=function(e){return e-this._currentIndex.get()==this._areaRight},i.prototype.isViolate=function(e,t){if(1>e||isNaN(this._currentValue.get()))return!0;var n=this._series.get(this._index-e);return isNaN(n)?!0:n===this._currentValue.get()?t:this._pivotType==i.HIGH?n>this._currentValue.get():n<this._currentValue.get()},i.prototype.processPoint=function(e){this.isViolate(e,!1)&&(this._currentValue.set(this._series.get()),this._currentIndex.set(e))},i.prototype.isRestartNeeded=function(e){return e-this._currentIndex.get()>this._areaRight},i.prototype.update=function(){if(this._isNewBar&&this.isPivotFound()&&this.reset(),this.processPoint(this._index),this.isRightSideOk(this._index)){if(-1==this._pivotIndex.get()){for(var e=!0,t=0;t<this._areaLeft;++t)if(this.isViolate(this._currentIndex.get()-1-t,!0)){e=!1;break}e&&this._pivotIndex.set(this._currentIndex.get())}}else-1!=this._pivotIndex.get()&&this._pivotIndex.set(-1);if(this.isRestartNeeded(this._index))for(this.reset(),t=0;t<=this._areaRight;++t)this.processPoint(this._index-this._areaRight+t)},n.prototype.addPivot=function(e,t,i){this._lastIndex.set(e),this._lastVal.set(t),this._lastType.set(i)},n.prototype.updatePivot=function(e,t){this._lastIndex.set(e),this._lastVal.set(t)},n.prototype.lastPrice=function(){return this._lastVal.get()},n.prototype.lastIndex=function(){return this._lastIndex.get()},n.prototype.addPoint=function(e,t,n){if(isNaN(this._lastVal.get()))this.addPivot(e,t,n);else{var o=this._lastVal.get();this._lastType.get()==n?(n===i.HIGH?t>o:o>t)&&this.updatePivot(e,t):Math.abs(o-t)/t>this._deviation&&this.addPivot(e,t,n)}},n.prototype.processPivot=function(e){e.update(),this._isBarClosed&&e.isPivotFound()&&this.addPoint(e.pivotIndex(),e.currentValue(),e.pivotType())},m.zigzag=function(e,t,i){return new n(e,t,i).lastPrice()},m.zigzagbars=function(e,t,i){return e=new n(e,t,i),-1==e.lastIndex()?NaN:e.lastIndex()-m.n(i)},o.prototype.new_sym=function(e,t,i){return this.symbol.script.add_sym(e,t,i)},o.prototype.select_sym=function(e){this.symbol=this.symbol.script.get_sym(e)},o.prototype.new_var=function(e){var t=this.vars;return t.length<=this.vars_index&&t.push(new r(this.symbol)),t=t[this.vars_index++],0<arguments.length&&t.set(e),t},o.prototype.new_ctx=function(){return this.ctx.length<=this.ctx_index&&this.ctx.push(new o(this.symbol)),this.ctx[this.ctx_index++]},o.prototype.prepare=function(e){for(var t=this.vars_index=this.ctx_index=0;t<this.vars.length;t++)this.vars[t].prepare(e);for(t=0;t<this.ctx.length;t++)this.ctx[t].prepare(e)},o.prototype.stop=function(){this.vars=this.symbol=null},r.prototype.valueOf=function(){return this.get(0)},r.prototype.get=function(e){return isNaN(e)&&(e=0),e=e||0,this.hist?e>=this.hist.length?(console.error("not enough depth: "+this),NaN):this._get(e):(this.mindepth=m.max(this.mindepth,e),NaN)},r.prototype._get=function(e){return e=this.hist_pos-e,0>e&&(e+=this.hist.length),this.hist[e]},r.prototype.set=function(e){this.hist&&(this.hist[this.hist_pos]=e,this.modified=!0)},r.prototype.prepare=function(e){e===this.symbol&&(e.isNewBar?(this.original=this.get(0),
!this.modified&&this.hist||this.add_hist()):this.set(this.original),this.modified=!1)},r.prototype.add_hist=function(){if(!this.hist){for(var e=m.na(this.mindepth)?m.max_series_size:m.min(this.mindepth+1,m.max_series_size),e=Math.round(e),t=Array(e),i=0;e>i;i++)t[i]=NaN;this.hist=t,this.hist_pos=-1}this.hist_pos=(this.hist_pos+1)%this.hist.length,this.hist[this.hist_pos]=this.original},r.prototype.adopt=function(e,t,i){this.hist||(this.mindepth=NaN);var n=t.get(),n=e.indexOf(n);return 0!==i&&(t=t.get(1),m.na(t)||(e=e.indexOf(t),n=n===e?-1:n)),0>n?NaN:this._get(n)},r.prototype.indexOf=function(e){if(!this.hist)return this.mindepth=NaN,-1;if(m.na(e))return-1;for(var t=this.symbol.index+1,i=this.hist.length,n=0,t=(t>i?i:t)-1,i=(t+n)/2|0;;){if(this._get(i)>e){if(n=i+1,n>t)return i+1}else if(t=i-1,n>t)return i;i=(t+n)/2|0}},s.parseTicker=function(e){var t=e.indexOf(":");return-1===t?e:e.substr(t+1)},s.parsePeriod=function(e){var t,i=(e+"").slice(0);0<=i.indexOf(",")&&(e=i.split(","),t=s.parsePeriod(e[1]),i=e[0]),e=!1;var n=i[i.length-1];return-1==="DWM".indexOf(n)&&(e=!0,n=""),i=parseInt(e?i:1<i.length?i.slice(0,i.length-1):1),{resolution:n,interval:i,pureResolution:[i,n].join(""),isIntraday:e,range:t}},s.newBarBuilder=function(e,t,i){return e=s.parsePeriod(e),g.newBarBuilder(e.resolution,e.interval,t,i)},s.newSession=function(e,t){var i=f.get_timezone(e);return(new g.Session).init(i,t)},s.prototype.set_symbolinfo=function(e){e||console.error("WARN: symbolinfo isn't defined for "+this.tickerid),this.info=e,this.timezone=f.get_timezone(e.timezone),this.session.init(this.timezone,e.session);for(var t in this.other_sessions)this.other_sessions.hasOwnProperty(t)&&this.other_sessions[t].init(this.timezone,t)},s.prototype.get_session=function(e){if(!e)return this.session;var t=this.other_sessions[e];return t||(t=new g.Session,this.other_sessions[e]=t),t},s.prototype.isdwm=function(){return""!==this.resolution},s.prototype.enable_dwm_aligning=function(e,t){this.dwm_aligner=s.newBarBuilder(this.period,e,t)},s.prototype.bartime=function(e,t){var i=this.time;if(e){var n=e;t&&(n+=t);var o=this.bb_cache[n];o||(o=this.get_session(t),o=s.newBarBuilder(e,o),this.bb_cache[n]=o),i=o.alignTime(i)}if(!this.isdwm()||isNaN(i))return i;var n=f.utc_to_cal(this.timezone,i),r=this.session.spec,a=f.get_day_of_week(n),o=f.get_minutes_from_midnight(n),a=r.findSession(a,o),r=a.isOvernight(),o=a.start()<=o;return r&&o?(f.add_date(n,1),f.cal_to_utc(this.timezone,n)):i},s.prototype.lastbar=function(e){if(!isNaN(e.time)){var t=e.time;this.dwm_aligner&&(this.dwm_aligner.moveTo(t),t=this.dwm_aligner.startOfBar(0));var i=this.time!==t;i&&0<=this.index&&!this.isBarClosed&&(this.isNewBar=!1,this.isBarClosed=!0,this.script.calc(this)),this.time=t,this.open=e.open,this.high=e.high,this.low=e.low,this.close=e.close,this.volume=e.volume,this.updatetime=e.updatetime,this.isNewBar=i,this.isBarClosed=e.isBarClosed,this.isNewBar&&this.index++,this.script.calc(this)}},a.prototype.calc=function(e){var t=this.ctx,i=this.body;t.prepare(e),e=i.main(t,this.inputCallback),!isNaN(t.symbol.time)&&this.out&&this.out(t.symbol,e)},a.prototype.init=function(){var e=this.ctx,t=this.body;t.init&&t.init(e,this.inputCallback),t.main(e,this.inputCallback)},a.prototype.add_sym=function(e,t,i){return e=this.runner.add_sym(e,t,i,this),this.symbols.push(e),e.isdwm()&&1<this.symbols.length&&e.enable_dwm_aligning(this.symbols[0].session,e.session),e},a.prototype.stop=function(e){this.symbols=null,this.ctx.stop(),this.ctx=null},a.prototype.get_sym=function(e){return this.symbols[e]},l.prototype.add_sym=function(e,t,i,n){return e=new s(e,t,i,n),this.symbols.push(e),e},l.prototype.get_sym=function(e){return this.symbols[e]},l.prototype.start=function(){function e(e,o){var r=l.feed.subscribe(e.tickerid,e.period,e.periodBase,function(e){i.update(o,e)},t.onErrorCallback,t.symbolInfo,t.rangeExtension);n.push(r)}var t=this.host;this._script=new a(t.tickerid,t.period,t.periodBase||t.period,this,t.body,t.out,t.input);for(var i=this,n=[],o=this.symbols,r=0;r<o.length;r++)e(o[r],r);this.subscription=n},l.prototype.stop=function(){var e=this.subscription;if(e||this._script){for(var t=0;t<e.length;t++)l.feed.unsubscribe(e[t]);this.subscription=null,this._script.stop(),this.symbols=this._script=null}else console.warn("Recurring script engine stop happened.")},l.prototype.update=function(e,t){if(t){var i=this.symbols[e];if(this.isRecalculated){var n=t.bar(t.count()-1);n.isBarClosed=t.isLastBarClosed(),i.lastbar(n)}else this.barsets[e]||(this.barsets[e]=t,i.set_symbolinfo(t.symbolinfo()),this.recalc())}else console.error("Unexpected barset = null")},l.prototype.recalc=function(){for(var e=this.symbols,t=0;t<e.length;t++)if(!this.barsets[t])return;for(t=e.length-1;t>=0;t--)for(var i=e[t],n=this.barsets[t],o=n.count(),r=0;o>r;r++){var s=n.bar(r);s.isBarClosed=r===o-1?n.isLastBarClosed():!0,i.lastbar(s)}this.isRecalculated=!0,this.host.recalc(this)},l.feed={subscribe:function(e,t,i,n){console.error("must be initialized with setupFeed")},unsubscribe:function(e){console.error("must be initialized with setupFeed")}},d.prototype.stop=function(){this.runner.stop()},h.prototype._alignBarTime=function(e){return this.dwm_aligner.moveTo(e),this.dwm_aligner.startOfBar(0)},h.prototype._alignBars=function(){for(var e=this.bars,t=0;t<e.length;t++)e[t].time=this._alignBarTime(e[t].time)},h.prototype.set_dwm_aligner=function(e){this.dwm_aligner||(this.dwm_aligner=e,this._alignBars())},h.prototype.symbolinfo=function(){return this.info},h.prototype.isLastBarClosed=function(){return this.isBarClosed},h.prototype.bar=function(e){return this.bars[e]},h.prototype.count=function(){return this.bars.length},h.prototype.add=function(e,t){var i=this.cloneData?TradingView.clone(e):e;this.dwm_aligner&&(i.time=this._alignBarTime(i.time));var n=this.bars,o=n.length,r=i.time,s=0===o?NaN:n[o-1].time;0===o||r>s?n.push(i):s===r?n[o-1]=i:console.error("time order violation, prev: "+new Date(s).toUTCString()+", cur: "+new Date(r).toUTCString()),this.isBarClosed=!!t},c.prototype.init=function(e){this.bb=s.newBarBuilder(this.period,e.symbol.session),this.bbEmptyBars=this.generateEmptyBars?s.newBarBuilder(this.period,e.symbol.session):void 0},c.prototype.extrapolate=function(e,t){return isNaN(e)||isNaN(t)?void 0:g.extrapolateBarsFrontToTime(this.bbEmptyBars,e,t)},c.prototype.main=function(e){var t=e.symbol.time,i=this.bb.alignTime(t),n=e.new_var(i),o=m.na(i),r=n.get(1),s=m.na(r)?1:m.neq(i,r),n=e.new_var(),a=e.new_var(),l=e.new_var(),d=e.new_var(),h=n.get(1),c=a.get(1),p=l.get(1),u=d.get(1),h=o?NaN:s?m.open(e):h,c=o?NaN:s?m.high(e):m.max(m.high(e),c),p=o?NaN:s?m.low(e):m.min(m.low(e),p),f=o?NaN:m.close(e),u=o?NaN:s?m.volume(e):m.volume(e)+u,o=o?NaN:t,t=e.symbol.isBarClosed&&this.bb.isLastBar(t),r=this.generateEmptyBars&&s?this.extrapolate(r,i):void 0;return e=e.new_var(m.close(e)).get(1),e=r instanceof Array?e:NaN,n.set(h),a.set(c),l.set(p),d.set(u),[i,h,c,p,f,u,o,t,r,e]},p.prototype.main=function(e){var t=e.new_var(m.open(e)),i=e.new_var(m.close(e)),n=t.get(1),o=i.get(1),i=m.ohlc4(e),n=m.na(t.get(1))?(m.open(e)+m.close(e))/2:(n+o)/2;t.set(n);var t=m.max(m.high(e),m.max(n,i)),o=m.min(m.low(e),m.min(n,i)),r=m.volume(e);return e=e.symbol,[e.time,n,t,o,i,r,e.updatetime,e.isBarClosed]},u.prototype.main=function(e){var t=m.open(e),i=m.high(e),n=m.low(e),o=m.close(e);return e=m.volume(e),[t,i,n,o,e]};var _={Std:m,Series:r,Symbol:s,SymbolInfo:function(e,t){this.timezone=e||"America/New_York",this.session=t||"0000-0000"},StudyEngine:d,BarSet:h,OHLCV:u,BarBuilder:c,HeikenAshi:p,setupFeed:function(e,t){l.feed=e,t&&(s.inputSessionForDWM=s.newSession("UTC","24x7"))}};return"undefined"!=typeof module&&module.exports?module.exports=_:this.PineJS=_,_}(this),PineJSFeed=function(){function e(e){this.host=e,this.cache={}}function t(e){return e.has_empty_bars||e.force_session_rebuild}function i(e){return 0!==e.indexOf("=")?{symbol:e}:(e=JSON.parse(e.slice(1)),e.type&&(0===e.type.indexOf("BarSetHeikenAshi@tv-basicstudies-")?e.builder=new n.HeikenAshi:console.error("unknown builder type: "+e.type)),"string"!=typeof e.symbol&&(e.session=e.symbol.session||e.session,e.symbol=e.symbol.symbol),e)}var n=this.PineJS?this.PineJS:require("./iljs.js"),o=this.PineJsBarBuilder?this.PineJsBarBuilder:require("./barbuilder.js"),r=n.Symbol,s=n.StudyEngine,a=n.BarBuilder,l=n.BarSet;e.prototype.getCache=function(e){return this.cache[e]},e.prototype.putCache=function(e,t){this.cache[e]=t},e.prototype.subscribe=function(e,i,n,o,r,s){var a;a=t(s)?"_":"",a=e+i+n+a;var l=this.getCache(a);return l||(l=this.createItem(e,i,n,s),this.putCache(a,l)),l.listeners.addListener(o,r),{key:a,listener:o}},e.prototype.unsubscribe=function(e){var t=this.getCache(e.key);t&&t.listeners.removeListener(e.listener)},e.prototype.removeUnused=function(){var e,t=[];for(e in this.cache)this.cache[e]&&0===this.cache[e].listeners.listenersCount()&&t.push(e);if(0!==t.length){for(e=0;e<t.length;e++){var i=t[e],n=this.cache[i];this.cache[i]=null,n.stop()}this.removeUnused()}},e.prototype.rebuildFrom=function(e,t,i){if(e=r.parsePeriod(e),t=r.parsePeriod(t),""!==e.resolution){if(i.has_weekly_and_monthly)return e.resolution;if("undefined"==typeof i.has_daily||i.has_daily)return"D";""!==t.resolution&&(t.resolution="",t.interval=i.intraday_multipliers?i.intraday_multipliers[0]:1)}if("undefined"!=typeof i.has_intraday&&!i.has_intraday)return"";if(t=""!==e.resolution?t.interval:""===t.resolution?Math.min(e.interval,t.interval):e.interval,i.intraday_multipliers&&(i=i.intraday_multipliers,-1===i.indexOf(t))){for(e=i.length-1;e>=0;e--){var n=i[e];if(0===t%n)return""+n}return""}return""+t},e.prototype.createItem=function(e,n,o,r){var s=new c;if(e=i(e),e.builder)return new h(s,e.symbol,n,o,e.builder,r);var l=this.rebuildFrom(n,o,r),p=t(r);return n!==l||p?(o=r.has_empty_bars,r=$.extend({},r),p&&(r.has_empty_bars=!1,r.force_session_rebuild=!1),new h(s,e.symbol,n,l,new a(n,o),r)):new d(s,e.symbol,n,o,e.session&&"extended"!==e.session,this.host,r)};var d=function(e,t,i,n,o,s,a){this.listeners=e,this.host=s,this._aligner_required=r.inputSessionForDWM&&"D"===i,this._aligner_set=!1;var l=this;this.host.resolve(t,function(e){o&&e.regular_session&&(e.session=e.regular_session);var r=l.calculateFromTo(e,n||i,t);l.subs=l.host.subscribe(e,i,r,function(e){l._aligner_required&&!l._aligner_set&&(e.set_dwm_aligner(l._create_dwm_aligner(i,e.info)),l._aligner_set=!0),l.listeners.fire(e)},function(e){l.listeners.onError(e)})},function(e){l.listeners.onError(e)})};d.prototype._create_dwm_aligner=function(e,t){var i=PineJsCalendar.get_timezone(t.timezone),n=new o.Session;return n.init(i,t.session),r.newBarBuilder(e,n,r.inputSessionForDWM)},d.prototype.stop=function(){this.host.unsubscribe(this.subs)},d.prototype.calculateFromTo=function(e,t,i){i=r.parsePeriod(t);var n,s,a=(new Date).valueOf(),a=e.expired?PineJsCalendar.cal_to_utc(PineJsCalendar.get_timezone(e.timezone),new Date(1e3*e.expiration_date))||a:a;return""===i.resolution?(n=i.interval,s="D"):(n=12*("D"===i.resolution?1:"W"===i.resolution?5:30)*i.interval,s="M"),i.range?(n=i.range.interval,s=i.range.resolution):this.host.calculateHistoryDepth&&(t=this.host.calculateHistoryDepth(t,s,n))&&(n=t.intervalBack||n,s=t.resolutionBack||s),e=e.sessionString||e.session,t=o.alignPeriodsBack(e,s,n,1,a),this.host.getRangeExtension&&(n=this.host.getRangeExtension(),n>0&&(t=o.alignPeriodsBack(e,i.resolution,i.interval,n,t))),{from:t,to:a+6e4}};var h=function(e,t,i,n,o,r){if(this.listeners=e,this.isRecalculated=!1,""===n)console.error("unsupported resolution for rebuild: "+i),this.listeners.onError("unsupported resolution for rebuild: "+i);else{var a=this;this.engine=new s({tickerid:t,period:n,periodBase:i,body:o,symbolInfo:r,recalc:function(){a._recalc()},out:function(e,t){a._out(e,t)},onErrorCallback:function(e){a.listeners.onError(e)}})}};h.prototype.stop=function(){this.engine?this.engine.stop():console.error("Internal library error 0x1")},h.prototype._recalc=function(){this.isRecalculated&&console.error("recalc called twice!"),this.barset&&this.listeners.fire(this.barset),this.isRecalculated=!0},h.prototype._out=function(e,t){var i=t[0];if(!isNaN(i)){var i={time:i,open:t[1],high:t[2],low:t[3],close:t[4],volume:t[5],updatetime:t[6]},n=t[7];this.barset||(this.barset=new l(e.info));var o=t[8];if(o instanceof Array)for(var r=0;r<o.length;r++){var s=t[9],a=o[r];this.barset.add({time:a,open:s,high:s,low:s,close:s,volume:0,updatetime:a},!0),this.isRecalculated&&this.listeners.fire(this.barset)}this.barset.add(i,n),this.isRecalculated&&this.listeners.fire(this.barset)}};var c=function(){this.listeners=[]};c.prototype.listenersCount=function(){return this.listeners.reduce(function(e,t){return e+(t?1:0)},0)},c.prototype.addListener=function(e,t){this.listeners.push({dataListener:e,onErrorCallback:t}),this.barset&&e(this.barset),this.errorMsg&&t(this.errorMsg)},c.prototype.removeListener=function(e){var t=this.listeners.filter(function(t){return t.dataListener==e});0!=t.length&&(t=this.listeners.indexOf(t[0]),delete this.listeners[t])},c.prototype.onError=function(e){this.errorMsg=e||"unspecified error";for(var t=this.listeners,i=t.length,n=0;i>n;n++){var o=t[n];o&&o.onErrorCallback&&o.onErrorCallback(e)}},c.prototype.fire=function(e){this.barset=e;for(var t=this.listeners,i=t.length,n=0;i>n;n++){var o=t[n];o&&o.dataListener(e)}};var p={setupFeed:function(t,i){e.instance=new e(t),n.setupFeed(e.instance,i)},parseSymbol:i,unsubscribeUnused:function(){e.instance.removeUnused()}};return"undefined"!=typeof module&&module.exports?module.exports=p:this.PineJSFeed=p,p}(this),A82.studyLibrary=[{name:"Accumulation/Distribution",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#808000"}},precision:4,inputs:{}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Accumulation/Distribution",shortDescription:"Accum/Dist",is_price_study:!1,inputs:[],id:"Accumulation/Distribution@tv-basicstudies-1",scriptIdPart:"",name:"Accumulation/Distribution"},constructor:function(){this.f_0=function(e,t,i,n){return PineJS.Std.or(PineJS.Std.and(PineJS.Std.eq(e,t),PineJS.Std.eq(e,i)),PineJS.Std.eq(t,i))?0:(2*e-i-t)/(t-i)*n},this.main=function(e,t){this._context=e,this._input=t;var i=this.f_0(PineJS.Std.close(this._context),PineJS.Std.high(this._context),PineJS.Std.low(this._context),PineJS.Std.volume(this._context));return[PineJS.Std.cum(i,this._context)]}}},{name:"Aroon",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF6A00"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0094FF"}},precision:4,inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"Upper",histogramBase:0,joinPoints:!1},plot_1:{title:"Lower",histogramBase:0,joinPoints:!1}},description:"Aroon",shortDescription:"Aroon",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:14,type:"integer",min:1,max:1e12}],id:"Aroon@tv-basicstudies-1",scriptIdPart:"",name:"Aroon"},constructor:function(){this.f_0=function(e,t){return 100*(e+t)/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.high(this._context),o=i+1,n=this._context.new_var(n),n=PineJS.Std.highestbars(n,o,this._context),n=this.f_0(n,i),r=PineJS.Std.low(this._context),r=this._context.new_var(r),o=PineJS.Std.lowestbars(r,o,this._context),i=this.f_0(o,i);return[n,i]}}},{name:"Advance/Decline",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:10}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Advance/Decline",shortDescription:"AD",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:10,type:"integer",min:1,max:1e12}],id:"Advance/Decline@tv-basicstudies-1",scriptIdPart:"",name:"Advance/Decline"},constructor:function(){this.f_0=function(e,t){return PineJS.Std.gt(e,t)},this.f_1=function(e,t){return PineJS.Std.lt(e,t)},this.f_2=function(e,t){return e/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this.f_0(PineJS.Std.close(this._context),PineJS.Std.open(this._context)),n=this._context.new_var(n),n=PineJS.Std.sum(n,i,this._context),o=this.f_1(PineJS.Std.close(this._context),PineJS.Std.open(this._context)),o=this._context.new_var(o),i=PineJS.Std.sum(o,i,this._context);return[this.f_2(n,i)]}}},{name:"Average True Range",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Average True Range",shortDescription:"ATR",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:14,type:"integer",min:1,max:1e12}],id:"Average True Range@tv-basicstudies-1",scriptIdPart:"",name:"Average True Range"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.tr(this._context),n=this._context.new_var(n);return[PineJS.Std.sma(n,i,this._context)]}}},{name:"Awesome Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:1,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,palettes:{palette_0:{colors:{0:{color:"#FF0000",width:1,style:0},1:{color:"#008000",width:1,style:0}}}},inputs:{}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",palette:"palette_0",target:"plot_0",type:"colorer"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Awesome Oscillator",shortDescription:"AO",is_price_study:!1,palettes:{palette_0:{colors:{0:{name:"Color 0"},1:{name:"Color 1"}}}},inputs:[],id:"Awesome Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Awesome Oscillator"},constructor:function(){this.f_0=function(e,t){return e-t},this.f_1=function(e){return PineJS.Std.le(e,0)?0:1},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.hl2(this._context),n=this._context.new_var(i),n=PineJS.Std.sma(n,5,this._context),i=this._context.new_var(i),i=PineJS.Std.sma(i,34,this._context),n=this.f_0(n,i),i=this._context.new_var(n),i=PineJS.Std.change(i),i=this.f_1(i);return[n,i]}}},{name:"Bollinger Bands Width",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:20,in_1:2}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Bollinger Bands Width",shortDescription:"BBW",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12},{id:"in_1",name:"mult",defval:2,type:"float",min:.001,max:50}],id:"Bollinger Bands Width@tv-basicstudies-1",scriptIdPart:"",name:"Bollinger Bands Width"},constructor:function(){this.f_0=function(e,t){return e*t},this.f_1=function(e,t){return e+t},this.f_2=function(e,t){return e-t},this.f_3=function(e,t,i){return(e-t)/i},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._context.new_var(i),r=PineJS.Std.sma(r,n,this._context),i=this._context.new_var(i),n=PineJS.Std.stdev(i,n,this._context),n=this.f_0(o,n),o=this.f_1(r,n),n=this.f_2(r,n);return[this.f_3(o,n,r)]}}},{name:"Balance of Power",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Balance of Power",shortDescription:"Balance of Power",is_price_study:!1,inputs:[],id:"Balance of Power@tv-basicstudies-1",scriptIdPart:"",name:"Balance of Power"},constructor:function(){this.f_0=function(e,t,i,n){return(e-t)/(i-n)},this.main=function(e,t){return this._context=e,this._input=t,[this.f_0(PineJS.Std.close(this._context),PineJS.Std.open(this._context),PineJS.Std.high(this._context),PineJS.Std.low(this._context))]}}},{name:"Bollinger Bands",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,filledAreasStyle:{fill_0:{color:"#000080",transparency:90,visible:!0}},inputs:{in_0:20,in_1:2}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Median",histogramBase:0,joinPoints:!1},plot_1:{title:"Upper",histogramBase:0,joinPoints:!1},plot_2:{title:"Lower",histogramBase:0,joinPoints:!1}},description:"Bollinger Bands",shortDescription:"BB",is_price_study:!0,filledAreas:[{id:"fill_0",objAId:"plot_1",objBId:"plot_2",type:"plot_plot",title:"Plots Background"}],inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12},{id:"in_1",name:"mult",defval:2,type:"float",min:.001,max:50}],id:"Bollinger Bands@tv-basicstudies-1",scriptIdPart:"",name:"Bollinger Bands"},constructor:function(){this.f_0=function(e,t){return e*t},this.f_1=function(e,t){return e+t},this.f_2=function(e,t){return e-t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._context.new_var(i),r=PineJS.Std.sma(r,n,this._context),i=this._context.new_var(i),n=PineJS.Std.stdev(i,n,this._context),n=this.f_0(o,n),o=this.f_1(r,n),n=this.f_2(r,n);return[r,o,n]}}},{name:"Bollinger Bands %B",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008080"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:1},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],filledAreasStyle:{fill_0:{color:"#008080",transparency:90,visible:!0}},inputs:{in_0:20,in_1:2}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Bollinger Bands %B",shortDescription:"BB %B",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12},{id:"in_1",name:"mult",defval:2,type:"float",min:.001,max:50}],id:"Bollinger Bands %B@tv-basicstudies-1",scriptIdPart:"",name:"Bollinger Bands %B"},constructor:function(){this.f_0=function(e,t){return e*t},this.f_1=function(e,t){return e+t},this.f_2=function(e,t){return e-t},this.f_3=function(e,t,i){return(e-t)/(i-t)},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._context.new_var(i),r=PineJS.Std.sma(r,n,this._context),s=this._context.new_var(i),n=PineJS.Std.stdev(s,n,this._context),n=this.f_0(o,n),o=this.f_1(r,n),r=this.f_2(r,n);return[this.f_3(i,r,o)]}}},{name:"Chaikin Money Flow",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:20}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Chaikin Money Flow",shortDescription:"CMF",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12}],id:"Chaikin Money Flow@tv-basicstudies-1",scriptIdPart:"",name:"Chaikin Money Flow"},constructor:function(){this.f_0=function(e,t,i,n){return PineJS.Std.or(PineJS.Std.and(PineJS.Std.eq(e,t),PineJS.Std.eq(e,i)),PineJS.Std.eq(t,i))?0:(2*e-i-t)/(t-i)*n},this.f_1=function(e,t){return e/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this.f_0(PineJS.Std.close(this._context),PineJS.Std.high(this._context),PineJS.Std.low(this._context),PineJS.Std.volume(this._context)),n=this._context.new_var(n),n=PineJS.Std.sum(n,i,this._context),o=PineJS.Std.volume(this._context),o=this._context.new_var(o),i=PineJS.Std.sum(o,i,this._context);return[this.f_1(n,i)]}}},{name:"Chaikin Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:3,in_1:10}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Chaikin Oscillator",shortDescription:"Chaikin Osc",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"short",defval:3,type:"integer",min:1,max:1e12},{id:"in_1",name:"long",defval:10,type:"integer",min:1,max:1e12}],id:"Chaikin Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Chaikin Oscillator"},constructor:function(){this.f_0=function(e,t){return e-t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.accdist(this._context),r=this._context.new_var(o),i=PineJS.Std.ema(r,i,this._context),o=this._context.new_var(o),n=PineJS.Std.ema(o,n,this._context);return[this.f_0(i,n)]}}},{name:"Chande Kroll Stop",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:10,in_1:1,in_2:9}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"Long",histogramBase:0,joinPoints:!1},plot_1:{title:"Short",histogramBase:0,joinPoints:!1}},description:"Chande Kroll Stop",shortDescription:"Chande Kroll Stop",is_price_study:!0,inputs:[{id:"in_0",name:"p",defval:10,type:"integer",min:1,max:1e12},{id:"in_1",name:"x",defval:1,type:"integer",min:1,max:1e12},{id:"in_2",name:"q",defval:9,type:"integer",min:1,max:1e12}],id:"Chande Kroll Stop@tv-basicstudies-1",scriptIdPart:"",name:"Chande Kroll Stop"},constructor:function(){this.f_0=function(e,t,i){return e-t*i},this.f_1=function(e,t,i){return e+t*i},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=PineJS.Std.high(this._context),s=this._context.new_var(r),a=PineJS.Std.highest(s,i,this._context),s=PineJS.Std.atr(i,this._context),a=this.f_0(a,n,s),r=this._context.new_var(r),i=PineJS.Std.lowest(r,i,this._context),n=this.f_1(i,n,s),i=this._context.new_var(a),i=PineJS.Std.highest(i,o,this._context),n=this._context.new_var(n);return[PineJS.Std.lowest(n,o,this._context),i]}}},{name:"Chande Momentum Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008080"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Chande Momentum Oscillator",shortDescription:"ChandeMO",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:9,type:"integer",min:1,max:1e12}],id:"Chande Momentum Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Chande Momentum Oscillator"},constructor:function(){this.f_0=function(e){return PineJS.Std.ge(e,0)?e:0},this.f_1=function(e){return PineJS.Std.ge(e,0)?0:-e},this.f_2=function(e,t){return 100*e/t},this.f_3=function(e,t){return this.f_2(e-t,e+t)},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.close(this._context),n=this._context.new_var(n),n=PineJS.Std.change(n),o=this.f_0(n),n=this.f_1(n),o=this._context.new_var(o),o=PineJS.Std.sum(o,i,this._context),n=this._context.new_var(n),i=PineJS.Std.sum(n,i,this._context);return[this.f_3(o,i)]}}},{name:"Commodity Channel Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#808000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:100},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:-100}],filledAreasStyle:{fill_0:{color:"#808000",transparency:90,visible:!0}},inputs:{in_0:20}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Commodity Channel Index",shortDescription:"CCI",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12}],id:"Commodity Channel Index@tv-basicstudies-1",scriptIdPart:"",name:"Commodity Channel Index"},constructor:function(){this.f_0=function(e,t,i){return(e-t)/(.015*i)},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._context.new_var(i),o=PineJS.Std.sma(o,n,this._context),r=this._context.new_var(i),n=PineJS.Std.dev(r,n,this._context);return[this.f_0(i,o,n)]}}},{name:"Choppiness Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:61.8},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:38.2}],filledAreasStyle:{fill_0:{color:"#008000",transparency:90,visible:!0}},inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Choppiness Index",shortDescription:"CHOP",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:14,type:"integer",min:1,max:1e12}],id:"Choppiness Index@tv-basicstudies-1",scriptIdPart:"",name:"Choppiness Index"},constructor:function(){this.f_0=function(e,t,i,n){return 100*PineJS.Std.log10(e/(t-i))/n},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.atr(1,this._context),n=this._context.new_var(n),n=PineJS.Std.sum(n,i,this._context),o=PineJS.Std.high(this._context),o=this._context.new_var(o),o=PineJS.Std.highest(o,i,this._context),r=PineJS.Std.low(this._context),r=this._context.new_var(r),r=PineJS.Std.lowest(r,i,this._context),i=PineJS.Std.log10(i);return[this.f_0(n,o,r,i)]}}},{name:"Directional Movement Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,
color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF7F00"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:14,in_1:14}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"+DI",histogramBase:0,joinPoints:!1},plot_1:{title:"-DI",histogramBase:0,joinPoints:!1},plot_2:{title:"ADX",histogramBase:0,joinPoints:!1}},description:"Directional Movement Index",shortDescription:"DMI",is_price_study:!1,inputs:[{id:"in_0",name:"DI Length",defval:14,type:"integer",min:1,max:1e12},{id:"in_1",name:"ADX Smoothing",defval:14,type:"integer",min:1,max:50}],id:"Directional Movement Index@tv-basicstudies-1",scriptIdPart:"",name:"Directional Movement Index"},constructor:function(){this.f_0=function(e){return-e},this.f_1=function(e,t){return PineJS.Std.and(PineJS.Std.gt(e,t),PineJS.Std.gt(e,0))?e:0},this.f_2=function(e,t){return 100*e/t},this.f_3=function(e,t){return e+t},this.f_4=function(e,t,i){return PineJS.Std.abs(e-t)/(PineJS.Std.eq(i,0)?1:i)},this.f_5=function(e){return 100*e},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.high(this._context),o=this._context.new_var(o),r=PineJS.Std.change(o),o=PineJS.Std.low(this._context),o=this._context.new_var(o),o=PineJS.Std.change(o),s=this.f_0(o),o=PineJS.Std.tr(this._context),o=this._context.new_var(o),a=PineJS.Std.rma(o,i,this._context),o=this.f_1(r,s),o=this._context.new_var(o),o=PineJS.Std.rma(o,i,this._context),o=this.f_2(o,a),o=PineJS.Std.fixnan(o,this._context),r=this.f_1(s,r),r=this._context.new_var(r),i=PineJS.Std.rma(r,i,this._context),i=this.f_2(i,a),i=PineJS.Std.fixnan(i,this._context),r=this.f_3(o,i),r=this.f_4(o,i,r),r=this._context.new_var(r),n=PineJS.Std.rma(r,n,this._context),n=this.f_5(n);return[o,i,n]}}},{name:"Correlation Coeff",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:4,trackPrice:!1,transparency:40,visible:!0,color:"#800080"}},precision:4,inputs:{in_0:"AAPL",in_1:20}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Correlation Coeff",shortDescription:"CC",is_price_study:!1,inputs:[{id:"in_0",name:"sym",defval:"AAPL",type:"symbol"},{id:"in_1",name:"length",defval:20,type:"integer",min:1,max:1e12}],id:"Correlation Coeff@tv-basicstudies-1",scriptIdPart:"",name:"Correlation Coeff"},constructor:function(){this.init=function(e,t){this._context=e,this._input=t,this._context.new_sym(this._input(0),PineJS.Std.period(this._context),PineJS.Std.period(this._context))},this.main=function(e,t){this._context=e,this._input=t;var i=this._context.new_var(this._context.symbol.time);this._input(0),PineJS.Std.period(this._context);var n=PineJS.Std.close(this._context),o=this._input(1);this._context.select_sym(1);var r=this._context.new_var(this._context.symbol.time),s=PineJS.Std.close(this._context),s=this._context.new_var(s);return this._context.select_sym(0),i=s.adopt(r,i,0),n=this._context.new_var(n),i=this._context.new_var(i),[PineJS.Std.correlation(n,i,o,this._context)]}}},{name:"Donchian Channels",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF7F00"}},precision:4,filledAreasStyle:{fill_0:{color:"#0000FF",transparency:90,visible:!0}},inputs:{in_0:20}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1},plot_1:{title:"Plot",histogramBase:0,joinPoints:!1},plot_2:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Donchian Channels",shortDescription:"DC",is_price_study:!0,filledAreas:[{id:"fill_0",objAId:"plot_1",objBId:"plot_0",type:"plot_plot",title:"Plots Background"}],inputs:[{id:"in_0",name:"length",defval:20,type:"integer",min:1,max:1e12}],id:"Donchian Channels@tv-basicstudies-1",scriptIdPart:"",name:"Donchian Channels"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.low(this._context),n=this._context.new_var(n),n=PineJS.Std.lowest(n,i,this._context),o=PineJS.Std.high(this._context),o=this._context.new_var(o),i=PineJS.Std.highest(o,i,this._context),o=PineJS.Std.avg(i,n);return[n,i,o]}}},{name:"Double Exponential Moving Average",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Double Exponential Moving Average",shortDescription:"DEMA",is_price_study:!0,inputs:[{id:"in_0",name:"length",defval:9,type:"integer",min:1,max:1e12}],id:"Double Exponential Moving Average@tv-basicstudies-1",scriptIdPart:"",name:"Double Exponential Moving Average"},constructor:function(){this.f_0=function(e,t){return 2*e-t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.close(this._context),n=this._context.new_var(n),n=PineJS.Std.ema(n,i,this._context),o=this._context.new_var(n),i=PineJS.Std.ema(o,i,this._context);return[this.f_0(n,i)]}}},{name:"Ease of Movement",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#808000"}},precision:4,inputs:{in_0:1e4,in_1:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Ease of Movement",shortDescription:"EOM",is_price_study:!1,inputs:[{id:"in_0",name:"Divisor",defval:1e4,type:"integer",min:1,max:1e12},{id:"in_1",name:"length",defval:14,type:"integer",min:1,max:1e12}],id:"Ease of Movement@tv-basicstudies-1",scriptIdPart:"",name:"Ease of Movement"},constructor:function(){this.f_0=function(e,t,i,n,o){return e*t*(i-n)/o},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.hl2(this._context),o=this._context.new_var(o),o=PineJS.Std.change(o),i=this.f_0(i,o,PineJS.Std.high(this._context),PineJS.Std.low(this._context),PineJS.Std.volume(this._context)),i=this._context.new_var(i);return[PineJS.Std.sma(i,n,this._context)]}}},{name:"Elders Force Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:13}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Elders Force Index",shortDescription:"EFI",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"length",defval:13,type:"integer",min:1,max:1e12}],id:"Elders Force Index@tv-basicstudies-1",scriptIdPart:"",name:"Elders Force Index"},constructor:function(){this.f_0=function(e,t){return e*t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.close(this._context),n=this._context.new_var(n),n=PineJS.Std.change(n),n=this.f_0(n,PineJS.Std.volume(this._context)),n=this._context.new_var(n);return[PineJS.Std.sma(n,i,this._context)]}}},{name:"Envelope",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF7F00"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,filledAreasStyle:{fill_0:{color:"#0000FF",transparency:90,visible:!0}},inputs:{in_0:20,in_1:10,in_2:!1}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Median",histogramBase:0,joinPoints:!1},plot_1:{title:"Upper",histogramBase:0,joinPoints:!1},plot_2:{title:"Lower",histogramBase:0,joinPoints:!1}},description:"Envelope",shortDescription:"Env",is_price_study:!0,filledAreas:[{id:"fill_0",objAId:"plot_1",objBId:"plot_2",type:"plot_plot",title:"Plots Background"}],inputs:[{id:"in_0",name:"Length",defval:20,type:"integer",min:1,max:1e12},{id:"in_1",name:"percent",defval:10,type:"float",min:-1e12,max:1e12},{id:"in_2",name:"exponential",defval:!1,type:"bool"}],id:"Envelope@tv-basicstudies-1",scriptIdPart:"",name:"Envelope"},constructor:function(){this.f_0=function(e,t,i){return e?t:i},this.f_1=function(e,t){return e*(1+t)},this.f_2=function(e,t){return e*(1-t)},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._input(2),s=this._context.new_var(i),s=PineJS.Std.ema(s,n,this._context),i=this._context.new_var(i),n=PineJS.Std.sma(i,n,this._context),r=this.f_0(r,s,n),n=o/100,o=this.f_1(r,n),n=this.f_2(r,n);return[r,o,n]}}},{name:"Ichimoku Cloud",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"},plot_3:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800080"},plot_4:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800080"}},precision:4,filledAreasStyle:{fill_0:{color:"#000080",transparency:90,visible:!0}},inputs:{in_0:9,in_1:26,in_2:52,in_3:26}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"},{id:"plot_3",type:"line"},{id:"plot_4",type:"line"}],styles:{plot_0:{title:"Tenkan-sen",histogramBase:0,joinPoints:!1},plot_1:{title:"Kijun-sen",histogramBase:0,joinPoints:!1},plot_2:{title:"Chikou span",histogramBase:0,joinPoints:!1},plot_3:{title:"Senkou A",histogramBase:0,joinPoints:!1},plot_4:{title:"Senkou B",histogramBase:0,joinPoints:!1}},description:"Ichimoku Cloud",shortDescription:"Ichimoku",is_price_study:!0,filledAreas:[{id:"fill_0",objAId:"plot_3",objBId:"plot_4",type:"plot_plot",title:"Plots Background"}],inputs:[{id:"in_0",name:"Short",defval:9,type:"integer",min:1,max:1e12},{id:"in_1",name:"Middle",defval:26,type:"integer",min:1,max:1e12},{id:"in_2",name:"Long",defval:52,type:"integer",min:1,max:1e12},{id:"in_3",name:"displacement",defval:26,type:"integer",min:1,max:1e12}],id:"Ichimoku Cloud@tv-basicstudies-1",scriptIdPart:"",name:"Ichimoku Cloud"},constructor:function(){this.f_0=function(e){return-e},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=this._input(3),s=PineJS.Std.low(this._context),a=this._context.new_var(s),l=PineJS.Std.lowest(a,i,this._context),a=PineJS.Std.high(this._context),d=this._context.new_var(a),i=PineJS.Std.highest(d,i,this._context),i=PineJS.Std.avg(l,i),l=this._context.new_var(s),l=PineJS.Std.lowest(l,n,this._context),d=this._context.new_var(a),n=PineJS.Std.highest(d,n,this._context),n=PineJS.Std.avg(l,n),l=PineJS.Std.avg(i,n),s=this._context.new_var(s),s=PineJS.Std.lowest(s,o,this._context),a=this._context.new_var(a),o=PineJS.Std.highest(a,o,this._context),o=PineJS.Std.avg(s,o),a=PineJS.Std.close(this._context);return[i,n,{value:a,offset:this.f_0(r)},{value:l,offset:r},{value:o,offset:r}]}}},{name:"Klinger Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,inputs:{}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1},plot_1:{title:"Signal",histogramBase:0,joinPoints:!1}},description:"Klinger Oscillator",shortDescription:"Klinger Oscillator",is_price_study:!1,inputs:[],id:"Klinger Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Klinger Oscillator"},constructor:function(){this.f_0=function(e,t){return PineJS.Std.ge(e,0)?t:-t},this.f_1=function(e,t){return e-t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.hlc3(this._context),i=this._context.new_var(i),i=PineJS.Std.change(i),n=this.f_0(i,PineJS.Std.volume(this._context)),i=this._context.new_var(n),i=PineJS.Std.ema(i,34,this._context),n=this._context.new_var(n),n=PineJS.Std.ema(n,55,this._context),i=this.f_1(i,n),n=this._context.new_var(i),n=PineJS.Std.ema(n,13,this._context);return[i,n]}}},{name:"Hull MA",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Hull MA",shortDescription:"HMA",is_price_study:!0,inputs:[{id:"in_0",name:"length",defval:9,type:"integer",min:1,max:1e12}],id:"Hull MA@tv-basicstudies-1",scriptIdPart:"",name:"Hull MA"},constructor:function(){this.f_0=function(e,t){return 2*e-t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=n/2,r=this._context.new_var(i),o=PineJS.Std.wma(r,o,this._context),i=this._context.new_var(i),i=PineJS.Std.wma(i,n,this._context),i=this.f_0(o,i),n=PineJS.Std.sqrt(n),n=PineJS.Std.round(n),i=this._context.new_var(i);return[PineJS.Std.wma(i,n,this._context)]}}},{name:"Keltner Channels",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,filledAreasStyle:{fill_0:{color:"#0000FF",transparency:90,visible:!0}},inputs:{in_0:!0,in_1:20,in_2:1}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Upper",histogramBase:0,joinPoints:!1},plot_1:{title:"Middle",histogramBase:0,joinPoints:!1},plot_2:{title:"Lower",histogramBase:0,joinPoints:!1}},description:"Keltner Channels",shortDescription:"KC",is_price_study:!0,filledAreas:[{id:"fill_0",objAId:"plot_0",objBId:"plot_2",type:"plot_plot",title:"Plots Background"}],inputs:[{id:"in_0",name:"useTrueRange",defval:!0,type:"bool"},{id:"in_1",name:"length",defval:20,type:"integer",min:1,max:1e12},{id:"in_2",name:"mult",defval:1,type:"float",min:-1e12,max:1e12}],id:"Keltner Channels@tv-basicstudies-1",scriptIdPart:"",name:"Keltner Channels"},constructor:function(){this.f_0=function(e,t,i,n){return e?t:i-n},this.f_1=function(e,t,i){return e+t*i},this.f_2=function(e,t,i){return e-t*i},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._input(2),i=this._context.new_var(i),i=PineJS.Std.ema(i,o,this._context),n=this.f_0(n,PineJS.Std.tr(this._context),PineJS.Std.high(this._context),PineJS.Std.low(this._context)),n=this._context.new_var(n),n=PineJS.Std.ema(n,o,this._context),o=this.f_1(i,n,r),r=this.f_2(i,n,r);return[o,i,r]}}},{name:"Linear Regression Curve",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Linear Regression Curve",shortDescription:"LRC",is_price_study:!0,inputs:[{id:"in_0",name:"Length",defval:9,type:"integer",min:1,max:1e12}],id:"Linear Regression Curve@tv-basicstudies-1",scriptIdPart:"",name:"Linear Regression Curve"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i);return[PineJS.Std.linreg(i,n,0)]}}},{name:"Know Sure Thing",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:10,in_1:15,in_2:20,in_3:30,in_4:10,in_5:10,in_6:10,in_7:15,in_8:9}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"KST",histogramBase:0,joinPoints:!1},plot_1:{title:"Signal",histogramBase:0,joinPoints:!1}},description:"Know Sure Thing",shortDescription:"KST",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"roclen1",defval:10,type:"integer",min:1,max:1e12},{id:"in_1",name:"roclen2",defval:15,type:"integer",min:1,max:1e12},{id:"in_2",name:"roclen3",defval:20,type:"integer",min:1,max:1e12},{id:"in_3",name:"roclen4",defval:30,type:"integer",min:1,max:1e12},{id:"in_4",name:"smalen1",defval:10,type:"integer",min:1,max:1e12},{id:"in_5",name:"smalen2",defval:10,type:"integer",min:1,max:1e12},{id:"in_6",name:"smalen3",defval:10,type:"integer",min:1,max:1e12},{id:"in_7",name:"smalen4",defval:15,type:"integer",min:1,max:1e12},{id:"in_8",name:"siglen",defval:9,type:"integer",min:1,max:1e12}],id:"Know Sure Thing@tv-basicstudies-1",scriptIdPart:"",name:"Know Sure Thing"},constructor:function(){this.f_0=function(e,t,i,n){return e+2*t+3*i+4*n},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=this._input(3),s=this._input(4),a=this._input(5),l=this._input(6),d=this._input(7),h=this._input(8),c=PineJS.Std.close(this._context),p=this._context.new_var(c),i=PineJS.Std.roc(p,i),i=this._context.new_var(i),s=PineJS.Std.sma(i,s,this._context),i=this._context.new_var(c),n=PineJS.Std.roc(i,n),n=this._context.new_var(n),a=PineJS.Std.sma(n,a,this._context),n=this._context.new_var(c),o=PineJS.Std.roc(n,o),o=this._context.new_var(o),l=PineJS.Std.sma(o,l,this._context),c=this._context.new_var(c),r=PineJS.Std.roc(c,r),r=this._context.new_var(r),d=PineJS.Std.sma(r,d,this._context),d=this.f_0(s,a,l,d),r=this._context.new_var(d),h=PineJS.Std.sma(r,h,this._context);return[d,h]}}},{name:"MA Cross",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"},plot_2:{linestyle:0,linewidth:4,plottype:3,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:9,in_1:26}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Short",histogramBase:0,joinPoints:!1},plot_1:{title:"Long",histogramBase:0,joinPoints:!1},plot_2:{title:"Crosses",histogramBase:0,joinPoints:!1}},description:"MA Cross",shortDescription:"MA Cross",is_price_study:!0,inputs:[{id:"in_0",name:"Short",defval:9,type:"integer",min:1,max:1e12},{id:"in_1",name:"Long",defval:26,type:"integer",min:1,max:1e12}],id:"MA Cross@tv-basicstudies-1",scriptIdPart:"",name:"MA Cross"},constructor:function(){this.f_0=function(e,t){return e?t:PineJS.Std.na()},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.close(this._context),r=this._context.new_var(o),i=PineJS.Std.sma(r,i,this._context),o=this._context.new_var(o),n=PineJS.Std.sma(o,n,this._context),o=PineJS.Std.cross(i,n,this._context),o=this.f_0(o,i);return[i,n,o]}}},{name:"Money Flow",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#459915"}},precision:4,bands:[{color:"#c0c0c0",linestyle:2,linewidth:1,visible:!0,value:80},{color:"#c0c0c0",linestyle:2,linewidth:1,visible:!0,value:20}],filledAreasStyle:{fill_0:{color:"#9915ff",transparency:90,visible:!0}},inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Money Flow",shortDescription:"MFI",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"Length",defval:14,type:"integer",min:1,max:2e3}],id:"Money Flow@tv-basicstudies-1",scriptIdPart:"",name:"Money Flow"},constructor:function(){this.f_0=function(e,t,i){return e*(PineJS.Std.le(t,0)?0:i)},this.f_1=function(e,t,i){return e*(PineJS.Std.ge(t,0)?0:i)},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.hlc3(this._context),o=this._context.new_var(n),r=PineJS.Std.change(o),o=this.f_0(PineJS.Std.volume(this._context),r,n),o=this._context.new_var(o),o=PineJS.Std.sum(o,i,this._context),n=this.f_1(PineJS.Std.volume(this._context),r,n),n=this._context.new_var(n),i=PineJS.Std.sum(n,i,this._context);return[PineJS.Std.rsi(o,i)]}}},{name:"Mass Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:10}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Mass Index",shortDescription:"Mass Index",is_price_study:!1,inputs:[{id:"in_0",name:"length",defval:10,type:"integer",min:1,max:1e12}],id:"Mass Index@tv-basicstudies-1",scriptIdPart:"",name:"Mass Index"},constructor:function(){this.f_0=function(e,t){return e-t},this.f_1=function(e,t){return e/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this.f_0(PineJS.Std.high(this._context),PineJS.Std.low(this._context)),n=this._context.new_var(n),n=PineJS.Std.ema(n,9,this._context),o=this._context.new_var(n),o=PineJS.Std.ema(o,9,this._context),n=this.f_1(n,o),n=this._context.new_var(n);return[PineJS.Std.sum(n,i,this._context)]}}},{name:"Moving Average Exponential",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Moving Average Exponential",shortDescription:"EMA",is_price_study:!0,inputs:[{id:"in_0",name:"Length",defval:9,type:"integer",min:1,max:1e12}],id:"Moving Average Exponential@tv-basicstudies-1",scriptIdPart:"",name:"Moving Average Exponential"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i);return[PineJS.Std.ema(i,n,this._context)]}}},{name:"Net Volume",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Net Volume",shortDescription:"Net Volume",is_price_study:!1,inputs:[],id:"Net Volume@tv-basicstudies-1",scriptIdPart:"",name:"Net Volume"},constructor:function(){this.f_0=function(e,t,i){return PineJS.Std.gt(e,0)?t:PineJS.Std.lt(i,0)?-t:0*t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),i=this._context.new_var(i),i=PineJS.Std.change(i);return[this.f_0(i,PineJS.Std.volume(this._context),i)]}}},{name:"Moving Average Convergence/Divergence",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:1,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:12,in_1:26,in_2:9}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Histogram",histogramBase:0,joinPoints:!1},plot_1:{title:"MACD",histogramBase:0,joinPoints:!1},plot_2:{title:"Signal",histogramBase:0,joinPoints:!1}},description:"MACD",shortDescription:"MACD",is_price_study:!1,inputs:[{id:"in_0",name:"fastLength",defval:12,type:"integer",min:1,max:1e12},{id:"in_1",name:"slowLength",defval:26,type:"integer",min:1,max:1e12},{id:"in_2",name:"signalLength",defval:9,type:"integer",min:1,max:1e12}],id:"Moving Average Convergence/Divergence@tv-basicstudies-1",scriptIdPart:"",name:"MACD"},constructor:function(){this.f_0=function(e,t){return e-t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._input(2),s=this._context.new_var(i),n=PineJS.Std.ema(s,n,this._context),i=this._context.new_var(i),o=PineJS.Std.ema(i,o,this._context),o=this.f_0(n,o),i=this._context.new_var(o),r=PineJS.Std.sma(i,r,this._context);return[this.f_0(o,r),o,r]}}},{name:"Moving Average",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Moving Average",shortDescription:"MA",is_price_study:!0,inputs:[{id:"in_0",name:"Length",defval:9,type:"integer",min:1,max:1e12}],id:"Moving Average@tv-basicstudies-1",scriptIdPart:"",name:"Moving Average"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i);return[PineJS.Std.sma(i,n,this._context)]}}},{name:"Moving Average Weighted",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Moving Average Weighted",shortDescription:"WMA",is_price_study:!0,inputs:[{id:"in_0",name:"Length",defval:9,type:"integer",min:1,max:1e12}],id:"Moving Average Weighted@tv-basicstudies-1",scriptIdPart:"",name:"Moving Average Weighted"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i);return[PineJS.Std.wma(i,n,this._context)]}}},{name:"Parabolic SAR",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:3,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:.02,in_1:.02,in_2:.2}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Parabolic SAR",shortDescription:"SAR",is_price_study:!0,inputs:[{id:"in_0",name:"start",defval:.02,type:"float",min:-1e12,max:1e12},{id:"in_1",name:"increment",defval:.02,type:"float",min:-1e12,max:1e12},{id:"in_2",name:"maximum",defval:.2,type:"float",min:-1e12,max:1e12}],id:"Parabolic SAR@tv-basicstudies-1",scriptIdPart:"",name:"Parabolic SAR"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2);return[PineJS.Std.sar(i,n,o,this._context)]}}},{name:"On Balance Volume",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"On Balance Volume",shortDescription:"OBV",is_price_study:!1,inputs:[],id:"On Balance Volume@tv-basicstudies-1",scriptIdPart:"",name:"On Balance Volume"},constructor:function(){this.f_0=function(e,t,i){return PineJS.Std.gt(e,0)?t:PineJS.Std.lt(i,0)?-t:0*t},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),i=this._context.new_var(i),i=PineJS.Std.change(i),i=this.f_0(i,PineJS.Std.volume(this._context),i);return[PineJS.Std.cum(i,this._context)]}}},{name:"Price Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:10,in_1:21}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Price Oscillator",shortDescription:"PPO",is_price_study:!1,inputs:[{id:"in_0",name:"shortlen",defval:10,type:"integer",min:1,max:1e12},{id:"in_1",name:"longlen",defval:21,type:"integer",min:1,max:1e12}],id:"Price Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Price Oscillator"},constructor:function(){this.f_0=function(e,t){return(e-t)/t*100},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._context.new_var(i),n=PineJS.Std.sma(r,n,this._context),i=this._context.new_var(i),o=PineJS.Std.sma(i,o,this._context);return[this.f_0(n,o)]}}},{name:"Relative Strength Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800080"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:70},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:30}],filledAreasStyle:{fill_0:{color:"#800080",transparency:90,visible:!0}},inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Relative Strength Index",shortDescription:"RSI",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"Length",defval:14,type:"integer",min:1,max:1e12}],id:"Relative Strength Index@tv-basicstudies-1",scriptIdPart:"",name:"Relative Strength Index"},constructor:function(){this.f_0=function(e){return PineJS.Std.max(e,0)},this.f_1=function(e){return-PineJS.Std.min(e,0)},this.f_2=function(e,t){return PineJS.Std.eq(e,0)?100:PineJS.Std.eq(t,0)?0:100-100/(1+t/e)},this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i),o=PineJS.Std.change(i),i=this.f_0(o),i=this._context.new_var(i),i=PineJS.Std.rma(i,n,this._context),o=this.f_1(o),o=this._context.new_var(o),n=PineJS.Std.rma(o,n,this._context);
return[this.f_2(n,i)]}}},{name:"Relative Vigor Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:10}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"RVGI",histogramBase:0,joinPoints:!1},plot_1:{title:"Signal",histogramBase:0,joinPoints:!1}},description:"Relative Vigor Index",shortDescription:"RVGI",is_price_study:!1,inputs:[{id:"in_0",name:"Length",defval:10,type:"integer",min:1,max:1e12}],id:"Relative Vigor Index@tv-basicstudies-1",scriptIdPart:"",name:"Relative Vigor Index"},constructor:function(){this.f_0=function(e,t){return e-t},this.f_1=function(e,t){return e/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this.f_0(PineJS.Std.close(this._context),PineJS.Std.open(this._context)),n=this._context.new_var(n),n=PineJS.Std.swma(n,this._context),n=this._context.new_var(n),n=PineJS.Std.sum(n,i,this._context),o=this.f_0(PineJS.Std.high(this._context),PineJS.Std.low(this._context)),o=this._context.new_var(o),o=PineJS.Std.swma(o,this._context),o=this._context.new_var(o),i=PineJS.Std.sum(o,i,this._context),i=this.f_1(n,i),n=this._context.new_var(i),n=PineJS.Std.swma(n,this._context);return[i,n]}}},{name:"Relative Volatility Index",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:80},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:20}],filledAreasStyle:{fill_0:{color:"#808000",transparency:90,visible:!0}},inputs:{in_0:10}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Relative Volatility Index",shortDescription:"RVI",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:10,type:"integer",min:1,max:1e12}],id:"Relative Volatility Index@tv-basicstudies-1",scriptIdPart:"",name:"Relative Volatility Index"},constructor:function(){this.f_0=function(e,t){return PineJS.Std.le(e,0)?0:t},this.f_1=function(e,t){return PineJS.Std.gt(e,0)?0:t},this.f_2=function(e,t){return e/(e+t)*100},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.close(this._context),o=this._context.new_var(n),i=PineJS.Std.stdev(o,i,this._context),n=this._context.new_var(n),o=PineJS.Std.change(n),n=this.f_0(o,i),n=this._context.new_var(n),n=PineJS.Std.ema(n,14,this._context),i=this.f_1(o,i),i=this._context.new_var(i),i=PineJS.Std.ema(i,14,this._context);return[this.f_2(n,i)]}}},{name:"SMI Ergodic Indicator/Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF7F00"},plot_2:{linestyle:0,linewidth:1,plottype:1,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,inputs:{in_0:5,in_1:20,in_2:5}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Indicator",histogramBase:0,joinPoints:!1},plot_1:{title:"Signal",histogramBase:0,joinPoints:!1},plot_2:{title:"Oscillator",histogramBase:0,joinPoints:!1}},description:"SMI Ergodic Indicator/Oscillator",shortDescription:"SMIIO",is_price_study:!1,inputs:[{id:"in_0",name:"shortlen",defval:5,type:"integer",min:1,max:1e12},{id:"in_1",name:"longlen",defval:20,type:"integer",min:1,max:1e12},{id:"in_2",name:"siglen",defval:5,type:"integer",min:1,max:1e12}],id:"SMI Ergodic Indicator/Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"SMI Ergodic Indicator/Oscillator"},constructor:function(){this.f_0=function(e,t){return e-t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=PineJS.Std.close(this._context),r=this._context.new_var(r),i=PineJS.Std.tsi(r,i,n,this._context),n=this._context.new_var(i),o=PineJS.Std.ema(n,o,this._context),n=this.f_0(i,o);return[i,o,n]}}},{name:"Stochastic",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:80},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:20}],filledAreasStyle:{fill_0:{color:"#800080",transparency:75,visible:!0}},inputs:{in_0:14,in_1:1,in_2:3}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"%D",histogramBase:0,joinPoints:!1},plot_1:{title:"%K",histogramBase:0,joinPoints:!1}},description:"Stochastic",shortDescription:"Stoch",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:14,type:"integer",min:1,max:1e12},{id:"in_1",name:"smoothK",defval:1,type:"integer",min:1,max:1e12},{id:"in_2",name:"smoothD",defval:3,type:"integer",min:1,max:1e12}],id:"Stochastic@tv-basicstudies-1",scriptIdPart:"",name:"Stochastic"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=PineJS.Std.close(this._context),s=PineJS.Std.high(this._context),a=PineJS.Std.low(this._context),r=this._context.new_var(r),s=this._context.new_var(s),a=this._context.new_var(a),i=PineJS.Std.stoch(r,s,a,i,this._context),i=this._context.new_var(i),n=PineJS.Std.sma(i,n,this._context),i=this._context.new_var(n),o=PineJS.Std.sma(i,o,this._context);return[n,o]}}},{name:"TRIX",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:18}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"TRIX",histogramBase:0,joinPoints:!1}},description:"TRIX",shortDescription:"TRIX",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"length",defval:18,type:"integer",min:1,max:1e12}],id:"TRIX@tv-basicstudies-1",scriptIdPart:"",name:"TRIX"},constructor:function(){this.f_0=function(e){return PineJS.Std.log(e)},this.f_1=function(e){return 1e4*e},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this.f_0(PineJS.Std.close(this._context)),n=this._context.new_var(n),n=PineJS.Std.ema(n,i,this._context),n=this._context.new_var(n),n=PineJS.Std.ema(n,i,this._context),n=this._context.new_var(n),i=PineJS.Std.ema(n,i,this._context),i=this._context.new_var(i),i=PineJS.Std.change(i);return[this.f_1(i)]}}},{name:"Stochastic RSI",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:80},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:20}],filledAreasStyle:{fill_0:{color:"#800080",transparency:80,visible:!0}},inputs:{in_0:14,in_1:14,in_2:3,in_3:3}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"}],styles:{plot_0:{title:"%D",histogramBase:0,joinPoints:!1},plot_1:{title:"%K",histogramBase:0,joinPoints:!1}},description:"Stochastic RSI",shortDescription:"Stoch RSI",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"lengthRSI",defval:14,type:"integer",min:1,max:1e12},{id:"in_1",name:"lengthStoch",defval:14,type:"integer",min:1,max:1e12},{id:"in_2",name:"smoothK",defval:3,type:"integer",min:1,max:1e12},{id:"in_3",name:"smoothD",defval:3,type:"integer",min:1,max:1e12}],id:"Stochastic RSI@tv-basicstudies-1",scriptIdPart:"",name:"Stochastic RSI"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._input(2),s=this._input(3),a=PineJS.Std.rsi(i,n),i=this._context.new_var(a),n=this._context.new_var(a),a=this._context.new_var(a),o=PineJS.Std.stoch(i,n,a,o,this._context),o=this._context.new_var(o),r=PineJS.Std.sma(o,r,this._context),o=this._context.new_var(r),s=PineJS.Std.sma(o,s,this._context);return[r,s]}}},{name:"Triple EMA",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,inputs:{in_0:9}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Triple EMA",shortDescription:"TEMA",is_price_study:!0,inputs:[{id:"in_0",name:"length",defval:9,type:"integer",min:1,max:1e12}],id:"Triple EMA@tv-basicstudies-1",scriptIdPart:"",name:"Triple EMA"},constructor:function(){this.f_0=function(e,t,i){return 3*(e-t)+i},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.close(this._context),n=this._context.new_var(n),n=PineJS.Std.ema(n,i,this._context),o=this._context.new_var(n),o=PineJS.Std.ema(o,i,this._context),r=this._context.new_var(o),i=PineJS.Std.ema(r,i,this._context);return[this.f_0(n,o,i)]}}},{name:"VWMA",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"}},precision:4,inputs:{in_0:20}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"VWMA",shortDescription:"VWMA",is_price_study:!0,inputs:[{id:"in_0",name:"len",defval:20,type:"integer",min:1,max:1e12}],id:"VWMA@tv-basicstudies-1",scriptIdPart:"",name:"VWMA"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),i=this._context.new_var(i);return[PineJS.Std.vwma(i,n,this._context)]}}},{name:"Volume Oscillator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:0}],inputs:{in_0:5,in_1:10}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Volume Oscillator",shortDescription:"Volume Osc",is_price_study:!1,bands:[{id:"hline_0",name:"Zero"}],inputs:[{id:"in_0",name:"shortlen",defval:5,type:"integer",min:1,max:1e12},{id:"in_1",name:"longlen",defval:10,type:"integer",min:1,max:1e12}],id:"Volume Oscillator@tv-basicstudies-1",scriptIdPart:"",name:"Volume Oscillator"},constructor:function(){this.f_0=function(e,t){return 100*(e-t)/t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.volume(this._context),r=this._context.new_var(o),i=PineJS.Std.ema(r,i,this._context),o=this._context.new_var(o),n=PineJS.Std.ema(o,n,this._context);return[this.f_0(i,n)]}}},{name:"Williams Alligator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#0000FF"},plot_1:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#FF0000"},plot_2:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,inputs:{in_0:21,in_1:13,in_2:8}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",type:"line"},{id:"plot_2",type:"line"}],styles:{plot_0:{title:"Jaw",histogramBase:0,joinPoints:!1},plot_1:{title:"Teeth",histogramBase:0,joinPoints:!1},plot_2:{title:"Lips",histogramBase:0,joinPoints:!1}},description:"Williams Alligator",shortDescription:"Alligator",is_price_study:!0,inputs:[{id:"in_0",name:"jawLength",defval:21,type:"integer",min:1,max:1e12},{id:"in_1",name:"teethLength",defval:13,type:"integer",min:1,max:1e12},{id:"in_2",name:"lipsLength",defval:8,type:"integer",min:1,max:1e12}],id:"Williams Alligator@tv-basicstudies-1",scriptIdPart:"",name:"Williams Alligator"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=PineJS.Std.hl2(this._context),s=this._context.new_var(r),i=PineJS.Std.ema(s,i,this._context),s=this._context.new_var(r),n=PineJS.Std.ema(s,n,this._context),r=this._context.new_var(r),o=PineJS.Std.ema(r,o,this._context);return[{value:i,offset:8},{value:n,offset:5},{value:o,offset:3}]}}},{name:"Willams %R",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,bands:[{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:-20},{color:"#808080",linestyle:2,linewidth:1,visible:!0,value:-80}],filledAreasStyle:{fill_0:{color:"#000080",transparency:90,visible:!0}},inputs:{in_0:14}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Willams %R",shortDescription:"%R",is_price_study:!1,bands:[{id:"hline_0",name:"UpperLimit"},{id:"hline_1",name:"LowerLimit"}],filledAreas:[{id:"fill_0",objAId:"hline_0",objBId:"hline_1",type:"hline_hline",title:"Hlines Background"}],inputs:[{id:"in_0",name:"length",defval:14,type:"integer",min:1,max:1e12}],id:"Willams %R@tv-basicstudies-1",scriptIdPart:"",name:"Willams %R"},constructor:function(){this.f_0=function(e,t,i){return 100*(e-t)/(t-i)},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.high(this._context),n=this._context.new_var(n),n=PineJS.Std.highest(n,i,this._context),o=PineJS.Std.low(this._context),o=this._context.new_var(o),i=PineJS.Std.lowest(o,i,this._context);return[this.f_0(PineJS.Std.close(this._context),n,i)]}}},{name:"Coppock Curve",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:10,in_1:14,in_2:11}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Coppock Curve",shortDescription:"Coppock Curve",is_price_study:!1,inputs:[{id:"in_0",name:"WMA Length",defval:10,type:"integer",min:-1e12,max:1e12},{id:"in_1",name:"Long RoC Length",defval:14,type:"integer",min:-1e12,max:1e12},{id:"in_2",name:"Short RoC Length",defval:11,type:"integer",min:-1e12,max:1e12}],id:"Coppock Curve@tv-basicstudies-1",scriptIdPart:"",name:"Coppock Curve"},constructor:function(){this.f_0=function(e,t){return e+t},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=this._input(2),r=PineJS.Std.close(this._context),s=this._context.new_var(r),n=PineJS.Std.roc(s,n),r=this._context.new_var(r),o=PineJS.Std.roc(r,o),o=this.f_0(n,o),o=this._context.new_var(o);return[PineJS.Std.wma(o,i,this._context)]}}},{name:"Least Squares Moving Average",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:25,in_1:0}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Least Squares Moving Average",shortDescription:"LSMA",is_price_study:!0,inputs:[{id:"in_0",name:"Length",defval:25,type:"integer",min:-1e12,max:1e12},{id:"in_1",name:"Offset",defval:0,type:"integer",min:-1e12,max:1e12}],id:"Least Squares Moving Average@tv-basicstudies-1",scriptIdPart:"",name:"Least Squares Moving Average"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.close(this._context),o=this._context.new_var(o);return[PineJS.Std.linreg(o,i,n)]}}},{name:"Arnaud Legoux Moving Average",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:9,in_1:.85,in_2:6}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"Arnaud Legoux Moving Average",shortDescription:"ALMA",is_price_study:!0,inputs:[{id:"in_0",name:"Window Size",defval:9,type:"integer",min:-1e12,max:1e12},{id:"in_1",name:"Offset",defval:.85,type:"float",min:-1e12,max:1e12},{id:"in_2",name:"Sigma",defval:6,type:"float",min:-1e12,max:1e12}],id:"Arnaud Legoux Moving Average@tv-basicstudies-1",scriptIdPart:"",name:"Arnaud Legoux Moving Average"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=PineJS.Std.close(this._context),n=this._input(0),o=this._input(1),r=this._input(2),i=this._context.new_var(i);return[PineJS.Std.alma(i,n,o,r)]}}},{name:"True Strength Indicator",metainfo:{_metainfoVersion:27,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:1,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#000080"}},precision:4,inputs:{in_0:25,in_1:13}},plots:[{id:"plot_0",type:"line"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"True Strength Indicator",shortDescription:"True Strength Indicator",is_price_study:!1,inputs:[{id:"in_0",name:"long",defval:25,type:"integer",min:-1e12,max:1e12},{id:"in_1",name:"short",defval:13,type:"integer",min:-1e12,max:1e12}],id:"True Strength Indicator@tv-basicstudies-1",scriptIdPart:"",name:"True Strength Indicator"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),o=PineJS.Std.close(this._context),o=this._context.new_var(o);return[PineJS.Std.tsi(o,n,i,this._context)]}}}],A82.studyLibrary=A82.studyLibrary.concat([{name:"Compare",metainfo:{_metainfoVersion:15,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!0,defaults:{styles:{compare:{linestyle:0,linewidth:2,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#800080"}},precision:4,inputs:{source:"close",symbol:""}},plots:[{id:"compare",type:"line"}],styles:{compare:{title:"Plot",histogramBase:0}},description:"Compare",shortDescription:"Compare",is_price_study:!0,inputs:[{defval:"close",id:"source",name:"Source",options:"open high low close hl2 hlc3 ohlc4".split(" "),type:"text"},{id:"symbol",name:"Symbol",type:"symbol"}],id:"Compare@tv-basicstudies-1"},constructor:function(){this.init=function(e,t){this._context=e,this._context.new_sym(t(1),PineJS.Std.period(this._context),PineJS.Std.period(this._context))},this.main=function(e,t){this._context=e;var i=this._context.new_var(this._context.symbol.time);PineJS.Std.period(this._context),this._context.select_sym(1);var n=this._context.new_var(this._context.symbol.time),o=PineJS.Std[t(0)](this._context),o=this._context.new_var(o);return this._context.select_sym(0),[o.adopt(n,i,0)]}}},{name:"Overlay",metainfo:{_metainfoVersion:15,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!0,defaults:{styles:{},precision:4,inputs:{}},plots:[{id:"open",type:"line"},{id:"high",type:"line"},{id:"low",type:"line"},{id:"close",type:"line"}],styles:{open:{},high:{},low:{},close:{}},description:"Overlay",shortDescription:"Overlay",is_price_study:!1,inputs:[{id:"symbol",name:"symbol",defval:"",type:"symbol",isHidden:!0}],id:"Overlay@tv-basicstudies-1"},constructor:function(){this.init=function(e,t){this._context=e,this._context.new_sym(t(0),PineJS.Std.period(this._context),PineJS.Std.period(this._context))},this.main=function(e,t){this._context=e;var i=this._context.new_var(this._context.symbol.time);this._context.select_sym(1);var n=this._context.new_var(this._context.symbol.time),o=this._context.new_var(PineJS.Std.open(this._context)),r=this._context.new_var(PineJS.Std.high(this._context)),s=this._context.new_var(PineJS.Std.low(this._context)),a=this._context.new_var(PineJS.Std.close(this._context));return this._context.select_sym(0),[o.adopt(n,i,0),r.adopt(n,i,0),s.adopt(n,i,0),a.adopt(n,i,0)]}}},{name:"Volume",metainfo:{_metainfoVersion:15,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,transparency:65,defaults:{styles:{vol:{linestyle:0,linewidth:1,plottype:5,trackPrice:!1,transparency:65,visible:!0,color:"#000080"},vol_ma:{linestyle:0,linewidth:1,plottype:4,trackPrice:!1,transparency:65,visible:!0,color:"#0496FF"}},precision:0,palettes:{volumePalette:{colors:{0:{color:"#FF0000",width:1,style:0},1:{color:"#008000",width:1,style:0}}}},inputs:{showMA:!0}},plots:[{id:"vol",type:"line"},{id:"volumePalette",palette:"volumePalette",target:"vol",type:"colorer"},{id:"vol_ma",type:"line"}],styles:{vol:{title:"Volume",histogramBase:0},vol_ma:{title:"Volume MA",histogramBase:0}},description:"Volume",shortDescription:"Volume",is_price_study:!1,palettes:{volumePalette:{colors:{0:{name:"Color 0"},1:{name:"Color 1"}}}},inputs:[{id:"showMA",name:"show MA",defval:!1,type:"bool"}],id:"Volume@tv-basicstudies-1"},constructor:function(){this.f_0=function(e,t){return PineJS.Std.gt(e,t)?0:1},this.f_1=function(e,t){return e?t:PineJS.Std.na()},this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=PineJS.Std.volume(this._context),o=this.f_0(PineJS.Std.open(this._context),PineJS.Std.close(this._context)),r=PineJS.Std.volume(this._context),r=this._context.new_var(r),r=PineJS.Std.sma(r,20,this._context),i=this.f_1(i,r);return[n,o,i]}}},{name:"ZigZag",metainfo:{_metainfoVersion:23,isTVScript:!1,isTVScriptStub:!1,is_hidden_study:!1,defaults:{styles:{plot_0:{linestyle:0,linewidth:2,plottype:0,trackPrice:!1,transparency:35,visible:!0,color:"#008000"}},precision:4,inputs:{in_0:5,in_1:10}},plots:[{id:"plot_0",type:"line"},{id:"plot_1",target:"plot_0",type:"dataoffset"}],styles:{plot_0:{title:"Plot",histogramBase:0,joinPoints:!1}},description:"ZigZag",shortDescription:"ZigZag",is_price_study:!0,classId:"ScriptWithDataOffset",inputs:[{id:"in_0",name:"deviation",defval:5,type:"integer",min:1,max:100},{id:"in_1",name:"depth",defval:10,type:"integer",min:2,max:1e3}],id:"ZigZag@tv-basicstudies-1"},constructor:function(){this.main=function(e,t){this._context=e,this._input=t;var i=this._input(0),n=this._input(1),i=i/100,o=n/2,n=PineJS.Std.zigzag(i,o,this._context),i=PineJS.Std.zigzagbars(i,o,this._context);return[n,i]}}}]),A81=function(){this._sets={}},A81.prototype._cacheKey=function(e,t){return e},A81.prototype.createPointset=function(e,t,i,n,o,r){t=this._cacheKey(t,i),this._sets.hasOwnProperty(t)||(this._sets[t]=[]),i=[];for(var s=0;s<n.length;++s)if(0!==n[s][1]){var a=o.getPointTimeUTC(n[s][0],n[s][1],r);i.push(a)}else n[s][0]&&i.push(n[s][0]);this._sets[t].push({guid:e,points:i})},A81.prototype.removePointset=function(e){for(var t in this._sets)for(var i=this._sets[t],n=0;n<i.length;++n)if(i[n].guid==e)return void i.splice(n,1)},A81.prototype._refreshPointsetData=function(e,t,i,n){for(var o=[],r=0;r<e.points.length;++r){var s=e.points[r],a=this._indexOfTime(t,s,i,n);o.push({index:r,value:[a,s]})}return o},A81.prototype.broadcastPointsetsUpdates=function(e,t,i,n,o,r){if(e=this._cacheKey(e,t),this._sets.hasOwnProperty(e)){t=this._sets[e].length;for(var s=0;t>s;++s){var a=this._sets[e][s],l=this._refreshPointsetData(a,i,n,o);r(a.guid,l)}}},A81.prototype._indexOfTime=function(e,t,i,n){var o=PineJsBarBuilder.lower_bound(e,1e3*t,function(e,t){return e.value[0]>t?1:e.value[0]<t?-1:0});return o>=0&&t<e[e.length-1].value[0]?(e[o].value[0]/1e3!==t&&0!==o&&o--,e[o].index):i.indexOfBar(t,n)},A82.ExtrapolationManager=function(){this._storages={}},A82.ExtrapolationManager.prototype._storageKey=function(e,t,i){return e+","+t+","+i},A82.ExtrapolationManager.prototype.remove=function(e,t,i){delete this._storages[this._storageKey(e,t,i)]},A82.ExtrapolationManager.prototype.storage=function(e,t,i){return i=PineJS.Symbol.parsePeriod(i),t=this._storageKey(e,t,i.pureResolution),this._storages[t]?this._storages[t]:(this._storages[t]=new A80(ChartapiMessagerInstances[e],i.pureResolution),this._storages[t])},A80=function(e,t){this._chartApiMessager=e,this._lastRealBarIndex=this._lastRealBarTime=null,this._resolution=t,this._extrapolatedBarsCache=[],this._onReadyCallbacks=[]},A80.prototype.ready=function(){return!!this._lastRealBarTime},A80.prototype.rebuild=function(e,t){this._lastRealBarTime=e,this._extrapolatedBarsCache=[],this.ensureExtrapolatedToBar(t,this._lastRealBarIndex)},A80.prototype.getPointTimeUTC=function(e,t,i){return e=0===this._extrapolatedBarsCache.length||e<this._extrapolatedBarsCache[0]?-1:this.indexOfBar(e,i)-this._lastRealBarIndex,this.ensureExtrapolatedToBar(i,e+t+1),this._extrapolatedBarsCache[e+t]},A80.prototype.indexOfBar=function(e,t){this._ensureExtrapolatedToTime(t,1e3*e);var i=PineJsBarBuilder.lower_bound(this._extrapolatedBarsCache,e,function(e,t){return e>t?1:t>e?-1:0});return this._lastRealBarIndex+i+1},A80.prototype._extrapolateData=function(e,t){if(!this.ready())throw"No real bars known, so cannot extrapolate anything";var i=t(this._lastRealBarTime);if(i&&0!==i.length){PineJsCalendar.get_timezone(e.timezone);for(var n=0;n<i.length;++n)i[n]/=1e3;i[0]==this._lastRealBarTime/1e3&&(i=i.slice(1)),this._extrapolatedBarsCache=i;var o=i.slice(0);for(o.sort(),n=0;n<o.length-1;++n)o[n]==o[n+1]&&console.error("Duplicating extrapolated bars: duplicated "+new Date(1e3*o[n]));this._chartApiMessager.onTickmarksUpdated(this._lastRealBarIndex+1,i,e)}else this._chartApiMessager.onTickmarksUpdated(this._lastRealBarIndex+1,this._extrapolatedBarsCache,e)},A80.prototype.onTickmarksNeeded=function(e,t){if(this.ready())this.ensureExtrapolatedToBar(e,t);else{var i=this;this._onReadyCallbacks.push(function(){i.ensureExtrapolatedToBar(e,t)})}},A80.prototype.ensureExtrapolatedToBar=function(e,t){var i=this;return this._extrapolateData(e,function(n){return i._extrapolatedBarsCache.length>=t||!i._shouldExtrapolateMore()?null:PineJsBarBuilder.extrapolateBarsFrontByCount(i.newBarBuilder(e),n,t)})},A80.prototype._ensureExtrapolatedToTime=function(e,t){var i=this;return this._extrapolateData(e,function(n){return n>=t||!i._shouldExtrapolateMore()?null:(n=PineJsBarBuilder.extrapolateBarsFrontToTime(i.newBarBuilder(e),n,t),n[n.length-1]<t&&console.warn("Extrapolation error: not enough data created"),n)})},A80.prototype.newBarBuilder=function(e){return e=PineJS.Symbol.newSession(e.timezone,e.session),PineJS.Symbol.newBarBuilder(this._resolution,e)},A80.prototype._shouldExtrapolateMore=function(){return 100>this._extrapolatedBarsCache.length},A80.prototype.setLastBarTime=function(e,t){this._lastRealBarIndex===e&&this._lastRealBarTime!==t&&(this._extrapolatedBarsCache=[]),this._extrapolatedBarsCache&&this._lastRealBarIndex!==e&&(this._lastRealBarIndex>e?this._extrapolatedBarsCache=[]:this._extrapolatedBarsCache.shift(e-this._lastRealBarIndex)),this._lastRealBarIndex=e,this._lastRealBarTime=t;for(var i=0;i<this._onReadyCallbacks.length;++i)this._onReadyCallbacks[i]();this._onReadyCallbacks=[]},A79=function(e){function t(e,t){var i=n._cacheSymbols[e.ticker];void 0===i&&(i=n._cacheSymbols[e.ticker]={});var o=i[t];return void 0===o&&(o=i[t]=[]),o}function i(e,i,o){if(0===o.length)return!0;if(e=t(e,i),e.length===o.length&&e[0].time===o[0].time&&e[e.length-1].time===o[o.length-1].time)return n._logMessage("Time range of received data is the same as cached one. Skip the update."),!0;if(0!=e.length&&o[o.length-1].time>=e[0].time&&(i=e[e.length-1].time===o[o.length-1].time,e.splice(0,e.length),!i))return!1;if(Array.prototype.unshift.apply(e,o),W77.enabled("charting_library_debug_mode"))for(o=1;o<e.length;o++)e[o].time<=e[o-1].time&&console.error("Corrupted bars, time {0} at {1} > {2} at {3}".format(e[o].time,o,e[o-1].time,o-1));return!0}var n=this;this._studiesCache={},this._metainfoCache=[],this._symbolInfoCache={},this._extrapolationManager=new A82.ExtrapolationManager,this._externalDatafeed=e,this._datafeedConfiguration=null,this._callbacks={},this._externalDatafeed.onReady(function(e){n._logMessage("Datafeed settings received: {0}".format(JSON.stringify(e))),n._datafeedConfiguration=n._adoptConfigurationData(e),n._fireEvent("configuration_received")}),this._pointsetsManager=new A81,this._rangeExtensionData={summary:0},this._quotesInfo=[],this._endOfData={},this._cacheSymbols={},this._recursionGuardCounter=0,this._extendedRange=function(){return n._rangeExtensionData.summary},PineJSFeed.setupFeed({resolve:function(e,t,i){n.resolveSymbol(e,t,i)},subscribe:function(e,o,r,s,a){var l=e.ticker,d=l+","+o;n._logMessage("History request for {0} {1}: from `{2}` to {3}".format(l,o,new Date(r.from),new Date(r.to)));var h=parseInt(r.from/1e3),c=parseInt(r.to/1e3);W77.enabled("log_data_request_time")&&(r=new Date,console.log(r.toLocaleTimeString()+":"+r.getMilliseconds()+"> Requesting data"));var p=function(r,a,p){var f=t(e,o),g=a&&a.version&&1<a.version;if(!p&&g){if(p=f.length,0<r.length){if(n._logMessage("Receiving bars: `{0}` total {1} bars in [{2} ... {3}] ".format(l,r.length,new Date(r[0].time),new Date(r[r.length-1].time))),!i(e,o,r))return n._logMessage("Incremental update failed. Starting full update."),void u(h,c)}else n._logMessage("Receiving bars: barset is empty");if(f.length===p&&(p=c-h,p=p>86400?p:86400,!a.noData||a.nextTime))return a.nextTime&&n._logMessage("Next time received: `{0}`".format(new Date(1e3*a.nextTime))),c=a.nextTime||h,h=c-p,void u(h,c)}r=g?f:r;var m=new PineJS.BarSet(e,r,!0);0<r.length?n._logMessage("Bars to return: `{0}` total {1} bars in [{2} ... {3}] ".format(l,r.length,new Date(r[0].time),new Date(r[r.length-1].time))):n._logMessage("Nothing to return"),n._recursionGuardCounter=0,s(m),e.expired||n._externalDatafeed.subscribeBars(e,o,function(i){if(g){var n=t(e,o),r=n.length,a=i.time,l=0===r?NaN:n[r-1].time;0===r||a>l?n.push(i):l===a?n[r-1]=i:console.error("putToCacheNewBar: time violation, prev: "+new Date(l).toUTCString()+", cur: "+new Date(a).toUTCString())}m.add(i),s(m)},d)},u=function(i,r){if(4<n._recursionGuardCounter++)n._logMessage("Stop requesting data. 4 attempts to reach the data failed."),p([],{version:2},!0);else{var s=t(e,o);if(0<s.length){if(s=s[0].time/1e3,i>=s)return n._logMessage("Requested bars which already sent"),p([],{version:2},!1),d;r=s-1}n._logMessage("Requesting data: `{0}` in [{1} ... {2}] ".format(l,new Date(1e3*i),new Date(1e3*r))),n._externalDatafeed.getBars(e,o,i,r,function(e,t){p(e,t)},a)}};return u(h,c),d},unsubscribe:function(e){n._externalDatafeed.unsubscribeBars(e)},calculateHistoryDepth:this._externalDatafeed.calculateHistoryDepth,getRangeExtension:this._extendedRange},!W77.enabled("disable_resolution_rebuild"))},A79.prototype.purgeCache=function(){this._endOfData={},this._symbolInfoCache={}},A79.prototype.purgeDataCache=function(){this._cacheSymbols={}},A79.prototype._logMessage=function(e){W77.enabled("charting_library_debug_mode")&&console.log(e)},A79.prototype._extendRange=function(e){
this._rangeExtensionData.summary+=e},A79.prototype.on=function(e,t){return this._callbacks.hasOwnProperty(e)||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},A79.prototype._fireEvent=function(e,t){if(this._callbacks.hasOwnProperty(e)){for(var i=this._callbacks[e],n=0;n<i.length;++n)i[n](t);this._callbacks[e]=[]}},A79.prototype._adoptConfigurationData=function(e){e=TradingView.merge({},e);var t=e.supported_resolutions;if(!t||0===t.length)return e.supported_resolutions=void 0,e;for(var i={},n=0;n<t.length;n++){var o=t[n];if(i.hasOwnProperty(o))throw"Duplicating resolution `"+o+"`";i[o]=1}return e.supported_resolutions=i,e},A79.prototype.supportedResolutions=function(){return this._datafeedConfiguration.supported_resolutions},A79.prototype.supportedSymbolsTypes=function(){return this._datafeedConfiguration.symbols_types||[]},A79.prototype.supportedExchangesList=function(){return this._datafeedConfiguration.exchanges||[]},A79.prototype._createStudyLogicObject=function(e){var t=e.split("@")[0],i=A82.studyLibrary.filter(function(i){return i.metainfo.id==e||i.metainfo.shortDescription==t});if(0===i.length)throw"Study `"+e+"` not found";return new i[0].constructor},A79.prototype.getMarks=function(e,t,i,n,o){function r(e){function t(t,i){return isArray(e[t])?e[t][i]:e[t]}if(isArray(e))return e;for(var i=[],n=0;n<e.id.length;++n)i.push({id:t("id",n),time:t("time",n),color:t("color",n),text:t("text",n),label:t("label",n),labelFontColor:t("labelFontColor",n),minSize:t("minSize",n)});return i}var s={red:6,green:5,blue:4,yellow:3};if(this._externalDatafeed.getMarks&&this._datafeedConfiguration.supports_marks){this._logMessage("Requesting bars marks: symbol {0}, resolution {1}, range [{2} ... {3}]".format(e.full_name,o,new Date(1e3*t),new Date(1e3*i)));var a=this;this._externalDatafeed.getMarks(e,t,i,function(t){t=r(t).map(function(e){return e.time=parseInt(e.time),e}),a._logMessage("Received bars marks: symbol {0}, resolution {1}, marks {2}".format(e.full_name,o,JSON.stringify(t))),t=t.map(function(e){return e.tickmark=e.time,e.direction=s[e.color],e.onClicked=function(){D17.emit("onMarkClick",e.id)},e.label=!!e.label&&e.label[0],e}),n(t)},o)}},A79.prototype._computeStudy=function(e,t,i,n,o,r,s,a){var l=!0,d=[],h={},c=0,p=this;this.resolveSymbol(t,function(u){if(PineJS.Symbol.parsePeriod(i).isIntraday&&!u.has_intraday)a("Unsupported resolution");else{var f=new PineJS.StudyEngine({tickerid:t,symbolInfo:u,period:i,body:e,onErrorCallback:a,input:function(e){return o[e]},out:function(e,t){for(var i=e.time,n="number"==typeof r?[t]:t,o=0;o<n.length;++o){var r=n[o];r&&"object"==typeof r&&(h["plot_"+o]=r.offset,r=r.value,c++),"number"==typeof r&&isNaN(r)&&(r=void 0),n[o]=r}o=d.length-1,(r=0>o||i>d[o].value[0])?d.push({index:d.length,value:[i].concat(n)}):d[o].value=[i].concat(n),l||s([d[d.length-1]],r,d.length,h,u)},recalc:function(){l=!1,r(d,c>0?h:void 0,u)}});if(!p._studiesCache[n])throw"This should never happen";p._studiesCache[n].engine=f}},function(e){a(e)})},A79.prototype._createStudy=function(e,t,i,n,o,r,s){var a=this;ChartapiMessagerInstances[n].onStudyLoading(o,r),a._computeStudy(i,e,t,o,s,function(i,s,l){ChartapiMessagerInstances[n].onDataUpdate(o,r,a._convertBarsTimeToUnix(i),s,l,a._extendedRange(e,t)),ChartapiMessagerInstances[n].onStudyCompleted(o,r)},function(i,s,l,d,h){ChartapiMessagerInstances[n].onDataUpdate(o,r,a._convertBarsTimeToUnix(i),d,h,a._extendedRange(e,t))},function(e){ChartapiMessagerInstances[n].onStudyError(o,e)})},A79.prototype.purgeEndOfDataFlags=function(e){for(var t in this._studiesCache)e&&e!=t||(this._studiesCache[t].firstBarTime=null)},A79.prototype.recreateSources=function(e,t,i,n){for(var o in this._studiesCache){var r=this._studiesCache[o];r&&r.engine&&r.engine.stop()}PineJSFeed.unsubscribeUnused();for(o in this._studiesCache)(r=this._studiesCache[o])&&(r.symbol=e,r.resolution=t,"series"==r.type&&this.createSeries(e,t,i,o,r.turnaround,n));for(o in this._studiesCache)(r=this._studiesCache[o])&&"study"==r.type&&this._createStudy(e,t,r.studyObject,i,o,r.turnaround,r.inputs)},A79.prototype.removeStudy=function(e){this._studiesCache[e]&&this._studiesCache[e].engine&&(this._studiesCache[e].engine.stop(),PineJSFeed.unsubscribeUnused()),this._studiesCache[e]=null},A79.prototype.removeSeries=function(e){this.removeStudy(e)},A79.prototype.recomputeStudy=function(e,t,i,n){var o=this._studiesCache[e];if(!o)throw"This should never happen";o.inputs=t,o.turnaround=n,o.engine&&o.engine.stop(),this._createStudy(o.symbol,o.resolution,o.studyObject,i,e,n,t)},A79.prototype._convertBarsTimeToUnix=function(e){for(var t=[],i=0;i<e.length;++i){var n={index:e[i].index,value:[].concat(e[i].value)};n.value[0]/=1e3,t.push(n)}return t},A79.prototype.createStudy=function(e,t,i,n,o,r,s){r=this._createStudyLogicObject(r),this._studiesCache[n]={studyObject:r,symbol:e,resolution:t,guid:n,type:"study",inputs:s,turnaround:o},this._createStudy(e,t,r,i,n,o,s)},A79.prototype.purgeRangeExtensionData=function(){this._rangeExtensionData={summary:0}},A79.prototype.extendSeriesRange=function(e,t,i){var n=this._studiesCache[e];if(!n)throw"This should never happen";if(this._isEndOfData(t,e,n.turnaround)){var o=n.engine.runner.host.symbolInfo.data_status;setTimeout(function(){ChartapiMessagerInstances[t].onSeriesCompleted(e,n.turnaround,o)},0)}else{this._extendRange(i+10);var r=this;setTimeout(function(){r.recreateSources(n.symbol,n.resolution,t,!0)},0)}},A79.prototype.updateSeriesTurnaround=function(e,t){this._studiesCache[e]||(this._studiesCache[e]={}),this._studiesCache[e].turnaround=t},A79.prototype.createSeries=function(e,t,i,n,o,r){function s(e,n,o){h._extrapolationManager.storage(i,e.full_name,t).setLastBarTime(n,o)}var a=new PineJS.OHLCV,l=this._studiesCache[n],d=l&&l.firstBarTime;this._studiesCache[n]={symbol:e,resolution:t,studyObject:a,guid:n,type:"series",turnaround:o},ChartapiMessagerInstances[i].onSeriesLoading(n,o);var h=this;this._computeStudy(a,e,t,n,[],function(e,a,l){if(MarketStatusWatcher.onMainSeriesSymbolChanged(l.session,l.timezone,l.expired),a=h._studiesCache[n],!a)throw"This should never happen";var c=h._convertBarsTimeToUnix(e),p=0<c.length?1e3*c[0].value[0]:void 0;0===c.length||d===p?(h._logMessage("Series has no more data on server: {0}".format(l.full_name)),h._setEndOfData(i,n,o),0===c.length&&ChartapiMessagerInstances[i].onSeriesClearData(n,o),ChartapiMessagerInstances[i].onSeriesCompleted(n,o,l.data_status)):(a.firstBarTime=p,s(l,c.length-1,1e3*c[c.length-1].value[0]),r&&ChartapiMessagerInstances[i].onSeriesClearData(n,o),ChartapiMessagerInstances[i].onTimescaleUpdate(n,o,c,l,0),ChartapiMessagerInstances[i].onSeriesCompleted(n,o,l.data_status),a=h._extrapolationManager.storage(i,l.full_name,t),h._pointsetsManager.broadcastPointsetsUpdates(l.full_name,t,e,a,l,function(e,t){ChartapiMessagerInstances[i].onPointsetDataUpdate(e,o,t,l)}))},function(e,t,r,a,l){var d=h._convertBarsTimeToUnix(e);if(a=d[d.length-1],t){if(!h._studiesCache[n])throw"This should never happen";t=r-1,h._logMessage("New bar arrived: symbol {0}, bar {1}".format(l.full_name,JSON.stringify(a))),ChartapiMessagerInstances[i].onTimescaleUpdate(n,o,[a],l,t),s(l,t,1e3*a.value[0])}else h._logMessage("Last bar update: symbol {0}, bar {1}".format(l.full_name,JSON.stringify(a))),ChartapiMessagerInstances[i].onDataUpdate(n,o,d,void 0,l);h._fireEvent("realtime_tick",e[e.length-1])},function(e){h._logMessage("Series error: {0}".format(e)),ChartapiMessagerInstances[i].onSeriesError(n,e)})},A79.prototype.onMoreTickmarksRequested=function(e,t,i,n,o){this._extrapolationManager.storage(e,i.full_name,n).onTickmarksNeeded(i,o)},A79.prototype.removePointset=function(e){this._pointsetsManager.removePointset(e)},A79.prototype.rebuildExtrapolatedData=function(e,t,i,n,o){this._extrapolationManager.storage(e,n.full_name,i).rebuild(o,n)},A79.prototype.createPointset=function(e,t,i,n,o,r){var s=this._extrapolationManager.storage(e,n.full_name,o);r=r.slice(0);for(var a=0;a<r.length;++a)r[a][0]=ChartapiMessagerInstances[e].timeInGMT(r[a][0],PineJsCalendar.get_timezone(n.timezone));this._pointsetsManager.createPointset(t,i,o,r,s,n)},A79.prototype.studiesMetadata=function(){return 0===this._metainfoCache.length&&(this._metainfoCache=A82.studyLibrary.map(function(e){return e.metainfo})),this._metainfoCache},A79.prototype.searchSymbolsByName=function(e,t,i,n){this._logMessage("Symbol search requested: user input `{0}`, exchange: `{1}`, type `{2}`".format(e,t,i));var o=this;this._externalDatafeed.searchSymbolsByName(e,t,i,function(e){o._logMessage("Symbol search response: {0}".format(JSON.stringify(e))),n(e)})},A79.prototype.resolveSymbol=function(e,t,i){function n(e){r._logMessage("Symbol resolve failed: `{0}`, reason: `{1}`".format(o,e)),i(e)}var o=PineJSFeed.parseSymbol(e).symbol,r=this;this._symbolInfoCache.hasOwnProperty(o)?t(this._symbolInfoCache[o]):(this._logMessage("Symbol resolve requested: `{0}` ".format(o)),this._externalDatafeed.resolveSymbol(o,function(e){r._logMessage("Symbol resolved: `{0}`, SymbolInfo in server response {1}".format(o,JSON.stringify(e))),e.base_name||(e.base_name=[e.name]),e.legs||(e.legs=[e.name]),e.exchange||(e.exchange=e["exchange-listed"]),e.full_name||(e.full_name=e.symbol||e.exchange+":"+e.name),e.data_status||(e.data_status="streaming"),e.ticker||(e.ticker=e.symbol),!e.session&&e["session-regular"]&&(e.session=e["session-regular"]),!e.minmov&&e.minmovement&&(e.minmov=e.minmovement),r._logMessage("Symbol info after post-processing: `{0}`, SymbolInfo {1}".format(o,JSON.stringify(e))),r._symbolInfoCache[o]=r._symbolInfoCache[e.symbol]=e,t(e)},n))},A79.prototype._stopQuotesSubscription=function(e){this._quotesInfo[e].listenerGUID&&(this._externalDatafeed.unsubscribeQuotes(this._quotesInfo[e].listenerGUID),this._quotesInfo[e].listenerGUID=void 0)},A79.prototype._startQuotesSubscription=function(e){function t(t){t.forEach(function(t){t.symbolname=t.n,t.status=t.s,t.values=t.v,t.values.change=t.v.ch,t.values.last_price=t.v.lp,t.values.change_percent=t.v.chp,ChartapiMessagerInstances[e].onQuotesData([e].concat([t]))})}if(0!==this._quotesInfo[e].symbols.length){var i=this;this._externalDatafeed.getQuotes(this._quotesInfo[e].symbols,function(n){t(n),i._quotesInfo[e].listenerGUID=e,i._externalDatafeed.subscribeQuotes(i._quotesInfo[e].symbols,i._quotesInfo[e].fastSymbols,t,i._quotesInfo[e].listenerGUID)})}},A79.prototype._restartQuotesSubscription=function(e){this._stopQuotesSubscription(e),this._startQuotesSubscription(e)},A79.prototype.quoteCreateSession=function(e){this._quotesInfo[e]={symbols:[],fastSymbols:[],listenerGUID:void 0}},A79.prototype.quoteDeleteSession=function(e){this._stopQuotesSubscription(e),this._quotesInfo[e]=null},A79.prototype.quoteSetFields=function(e,t){},A79.prototype.quoteAddSymbols=function(e,t){this._quotesInfo[e].symbols=this._filteredSymbols(this._quotesInfo[e].symbols.concat(t)),this._restartQuotesSubscription(e)},A79.prototype.quoteRemoveSymbols=function(e,t){this._quotesInfo[e].symbols=this._quotesInfo[e].symbols.filter(function(e){return 0>t.indexOf(e)}),this._restartQuotesSubscription(e)},A79.prototype.quoteFastSymbols=function(e,t){this._quotesInfo[e].fastSymbols=this._filteredSymbols(t),this._restartQuotesSubscription(e)},A79.prototype._filteredSymbols=function(e){var t=[];return e.forEach(function(e){e instanceof Object||0>t.indexOf(e)&&t.push(e)}),t},A79.prototype._isEndOfData=function(e,t,i){return!!this._endOfData[e+"!"+t+"@"+i]},A79.prototype._setEndOfData=function(e,t,i){this._endOfData[e+"!"+t+"@"+i]=!0},MetainfoTuner=function(){function e(e){W77.enabled("charting_library_debug_mode")&&console.warn("Overrides:"+e)}var t={"volume.transparency":"!transparency"},i={};Object.keys(TradingView.StudyConsts).forEach(function(e){0==e.indexOf("PLOT_")&&0!=e.indexOf("PLOT_TYPE_")&&(i[e.toLowerCase().substring(5)]=TradingView.StudyConsts[e])});var n={setMetainfoProperty:function(n,o,r){if(o=t[o]||o,o=o.split("."),0==o[0].indexOf("!"))n[o[0].slice(1)]=r;else{var s;e:{var a=o[0];for(s in n.styles)if(n.styles[s].title.toLowerCase()==a.toLowerCase())break e;s=null}e:{for(var a=o[0],l=0;l<n.inputs.length;++l)if(n.inputs[l].name.toLowerCase()==a.toLowerCase()){a={id:n.inputs[l].id,index:l};break e}a=null}if(l="options"==o[0],s||a||l)if(s&&a||s&&l||a&&l)e("Study `{0}` ambiguous identifier `{1}`".format(n.description,o[0]));else if(s)if(a=o[1],"color"==a){var d;e:{for(d in n.plots)if("colorer"==n.plots[d].type&&n.plots[d].target==s){d=n.defaults.palettes[n.plots[d].palette];break e}d=null}a=2<o.length?parseInt(o[2]):NaN,null==d&&!isNaN(a)&&a>0?e("Plot `{1}` of `{0}` does not have color #{2}".format(n.description,o[0],a)):0==a||isNaN(a)?(n.defaults.styles[s].color=r,null!=d&&(d.colors[0].color=r)):d.colors[a].color=r}else n.defaults.styles[s].hasOwnProperty(a)?("plottype"==a&&(r=i[r]),n.defaults.styles[s][a]=r):e("Plot `{1}` of `{0}` does not have property `{2}`".format(n.description,o[0],a));else a?(o=a.index,n.defaults.inputs[a.id]=r,n.inputs[o].defval=r):n[o[1]]=r;else e("Study `{0}` has no plot or input `{1}`".format(n.description,o[0]))}},setProperty:function(t,i){var o,r=t.split(".")[0];e:{o=A82.studyLibrary;for(var s=0;s<o.length;++s){var a=o[s].metainfo;if(a.description.toLowerCase()==r.toLowerCase()||a.shortDescription.toLowerCase()==r.toLowerCase()){o=a;break e}}o=null}o?n.setMetainfoProperty(o,t.substring(r.length+1),i):e("Study `{0}` not found".format(r))}};if("undefined"!=typeof __initialMetainfoOverrides&&__initialMetainfoOverrides)for(var o in __initialMetainfoOverrides)n.setProperty(o,__initialMetainfoOverrides[o]);return n}();var MarketStatusWatcher=function(){function e(){if(t)if(i)D3.D0.mainSeries().marketStatus.setValue("out_of_session");else{var e=PineJsBarBuilder.isTradingNow(new Date,t)?"market":"out_of_session";D3.D0.mainSeries().marketStatus.setValue(e)}}var t,i,n={};return n.onMainSeriesSymbolChanged=function(n,o,r){o=PineJsCalendar.get_timezone(o),t=(new PineJsBarBuilder.Session).init(o,n),i=r,e()},setInterval(e,6e4),n}();$89=function(){},TradingView.study_PivotPointsStandard=function(){},TradingView.study_PivotPointsHighLow=function(){},TradingView.study_ZigZag=function(){},TradingView.study_LinearRegression=function(){},TradingView.study_ElliottWave=function(){},TradingView.ESDStudyBase=function(){},A55=function(){this.hasPackage=function(){return!1}},user={is_pro:!1,settings:{}},A55.prototype.getStudies=function(){return[]},A55.prototype.getProduct=function(){return{}},A55.prototype.getStudiesOrder=function(){return[]},TradingView.LineToolRegressionTrend=function(){},TradingView.templates={dialogs:{addSymbol:' <div class="main"> <div class="symbol-edit-place"></div>{{#overlayOption}} <div class="tv-dialog-relative">	<input id="tv-dialog-addsymbol-overlay-checkbox" type="checkbox" name="addsymbol-overlay" {{#overlayOptionChecked}}checked="checked"{{/overlayOptionChecked}} />	<span class="tv-dialog-checkbox-mask tv-dialog-checkbox-mask{{#overlayOptionChecked}}-active{{/overlayOptionChecked}}"></span>	<label for="tv-dialog-addsymbol-overlay-checkbox"> Overlay the main chart</label> </div>{{/overlayOption}} <div class="tv-dialogs-bottom-button"> <span class="tv-button tv-right tv-uppercase ok">{{okButtonTitle}}</span> </div> </div>',symbolSearch:'<div class="symbol-block"><div class="spread-actions"></div><div class="symbol-block-inputspacer"><input maxlength="'+TradingView.SYMBOL_SEARCH_MAX_LENGTH+'" /><div class="search-cion"></div></div></div><div class="filter"></div><div class="results"></div>'}},TradingView.AlertLabel=function(){},TradingView.getDataVendorString=function(){},A72={sendReport:function(){}},TradingView.study_VbPVisible=function(){},TradingView.study_VbPSessions=function(){},TradingView.LineToolVbPFixed=function(){},MockupRequestedCache=function(e){e&&e([])},MockupRequestedCache.D20=function(){},TradingView.getThemesList=MockupRequestedCache;</script><script>function postMessageToParent(e,a){window&&window.parent&&pm.post(window.parent,e,a)}function customizeUI(e){if(e.studiesOverrides){var a=e.studiesOverrides;for(var n in a)MetainfoTuner.setProperty(n,a[n])}__defaultsOverrides=e.defaultsOverrides}function createChart(){if(!Modernizr.canvas||!Modernizr.canvastext)throw"Charting library cannot be running under this browser";W77.setEnabled("charting_library_debug_mode","true"==urlParams.debug),is_authenticated=!1,headerChartPanel=$(".header-chart-panel"),widgetContainer=$("#library-container"),tvHeader=$(".tv-header"),footer=$("#footer-chart-panel"),W77.enabled("remove_library_container_border")&&(widgetContainer.css("border","0px"),widgetContainer.css("padding","1px")),customizeUI({studiesOverrides:urlParams.studiesOverrides?JSON.parse(urlParams.studiesOverrides):void 0,defaultsOverrides:JSON.parse(urlParams.overrides)}),W77.enabled("saveload_storage_customization")&&("undefined"!=typeof urlParams.chartsStorageUrl&&urlParams.chartsStorageUrl&&"undefined"!=typeof urlParams.clientId&&urlParams.clientId?ChartingLibraryBackend.initialize(urlParams.clientId,urlParams.userId,urlParams.chartsStorageUrl):(W77.setEnabled("saveload_storage_customization",!1),W77.setEnabled("header_saveload",!1))),D16=new A82.ChartApi(window.parent[urlParams.uid].datafeed),D16.setTimeFramesList(JSON.parse(urlParams.timeFrames)),D16.setStudiesAccessController(D16.createStudiesAccessController(urlParams.studiesAccess,urlParams.enabledStudies,urlParams.disabledStudies)),W77.enabled("narrow_chart_enabled")&&$(".chart-page").css("min-width","240px"),W77.enabled("use_localstorage_for_settings")&&TVSettings.sync();var e=urlParams.chartContent?JSON.parse(urlParams.chartContent).json:void 0,a=urlParams.interval||"D",n={jqParent:$("#chart-area"),onResize:function(e){var a=$(document.body).height()-2;widgetContainer.height(a);var n=W77.enabled("header_widget")&&"none"!=headerChartPanel.css("display")?headerChartPanel.outerHeight():0,r=a-n-tvHeader.outerHeight()-(footer.length?footer.outerHeight():0);r=Math.max(50,r),e.height(r)},padding:W77.enabled("border_around_the_chart")?5:0,edge:W77.enabled("border_around_the_chart")?5:0,content:e,widgetOptions:{hideIdeas:!0,addVolume:!0,handleSessionErrors:!0,muteSessionErrors:!0,timezone:urlParams.timezone,defSymbol:urlParams.symbol,defInterval:a,hideSymbolSearch:JSON.parse(urlParams.hideSymbolSearch)}};if(e&&"undefined"!=typeof e.extendedData){var r=e.extendedData;n.metaInfo={id:r.uid,name:r.name,description:r.description,uid:r.uid,username:"",tags:""}}D6=new A8(n),ChartSaverInstance=saver=new ChartSaver(D6),D3=D6.activeChartWidget.value(),pro=new A55;var t=JSON.parse(urlParams.favorites);t.intervals=t.intervals.map(function(e){var a=""+e;return a}),studyTemplates=new A65({D6:D6,notShowQuicks:!W77.enabled("favorites")}),headerWidget=new A5({D6:D6,headerChartPanel:headerChartPanel,hideStudyTemplates:!0,favoriteIntervals:t.intervals,interval_options:{interval:a},favoriteChartTypes:t.chartTypes,snapshotUrl:urlParams.snapshotUrl}),A45.bindToChartWidgetCollection(D6);var o=function(){},i=JSON.parse(urlParams.logo);o=i.image?function(e,a,n){$(".onchart-custom-logo").remove();var r=$('<img src="'+i.image+'">'),t=i.link?$('<a href="'+i.link+'" target="_blank"/>').append(r):r,o=$('<span class="text">Powered&nbsp;by&nbsp;<span><a href="https://www.tradingview.com/" target="_blank"><span class="text logo-highlighted">TradingView</span></a>'),s=$('<div class="onchart-custom-logo"/>').appendTo(a||D3._jqMainDiv),d=$('<div class="wrapper"/>').appendTo(s),l=$('<table class="inner">').appendTo(d),c=$("<tr>").appendTo(l);$('<td class="custom-logo">').append(t).appendTo(c);var u=$("<tr>").appendTo(l);W77.enabled("link_to_tradingview")&&$('<td class="tv-link">').append(o).appendTo(u),n&&s.addClass("on-pane")}:function(e,a,n){if(W77.enabled("link_to_tradingview")){$(".onchart-tv-logo").remove();var r=$('<div class="onchart-tv-logo wrapper"><div class="wrapper"><a class="inner" href="https://www.tradingview.com/" target="_blank"><img class="solid" src="images/logo-widget-copyright.png" alt="TradingView Logo"><img class="faded" src="images/logo-widget-copyright-faded.png" alt="TradingView Logo"><span class="text">charts&nbsp;by&nbsp;<span class="logo-highlighted">TradingView</span></span></a></div></div>').appendTo(a||D3._jqMainDiv);W77.enabled("minimalistic_logo")?r.on("mouseenter",function(){$(this).addClass("expanded")}).on("mouseleave",function(){$(this).removeClass("expanded")}):r.addClass("expanded"),n&&r.addClass("on-pane")}};var s=W77.enabled("widget_logo")&&"true"!=urlParams.disableLogo;if(s&&(D3.createLogo=o,W77.enabled("move_logo_to_main_pane")||D3.withModel(null,o)),TradingView.tokenInitialized.resolve(),urlParams.toolbarbg){var d="#"+urlParams.toolbarbg;$(".tv-side-toolbar").css("background-color",d),$(".chart-controls-bar").css("background-color",d),$("#chart-area").css("background-color",d),headerChartPanel.css("background-color",d),$("#footer-chart-panel").css("background-color",d)}var l=new A6({container:$(".tv-side-toolbar"),D6:D6,onWidget:!0,enabledDrawings:urlParams.enabledDrawings?JSON.parse(urlParams.enabledDrawings):[],disabledDrawings:urlParams.disabledDrawings?JSON.parse(urlParams.disabledDrawings):[],drawingsAccess:urlParams.drawingsAccess?JSON.parse(urlParams.drawingsAccess):void 0});window.sideToolbar=l,"true"!=urlParams.hideSideToolbar&&W77.enabled("left_toolbar")||l._fold(!0),window.lineToolPropertiesToolbar=new TradingView.LineToolPropertiesWidget(D6),D3.onDisconnected().subscribe(null,function(e){return e?void showCriticalErrorMessage():void 0}),$(".tv-content").bind("contextmenu",function(e){var a=$(e.originalEvent.target);return a.is("input")||a.is("textarea")?void 0:!1}),chartApiInitializationTimePassed.resolve(),function(){function e(e,a){D3.withModel(null,function(){if(D3.model().mainSeries().bars().size()>0)a();else{var e=function(){a(),D3.model().mainSeries().onBarReceived().unsubscribe(null,e)};D3.model().mainSeries().onBarReceived().subscribe(null,e)}})}pm.on("symbolInfo",function(e,a){var n=D3.model().mainSeries().symbolInfo(),r=D3.model().mainSeries().properties().interval.value(),t={name:n.name,exchange:n.exchange,description:n.description,type:n.type,interval:r};a(t)}),pm.on("resize",function(){$(window).resize()}),pm.on("initializationFinished",function(){A77.clearStack()}),pm.on("widgetReady",function(a,n){e(a,n),pm.setClientId(a.client_id)});for(var a=0;a<pm.__delayedMesssages.length;++a)e(pm.__delayedMesssages[a].data,pm.__delayedMesssages[a].cb);pm.on("executeAction",function(e){D3.executeActionByName(e.action)}),pm.on("removeAllStudies",function(){D3.removeAllStudies()}),pm.on("refreshMarks",function(){D3.refreshMarks()}),pm.on("clearMarks",function(){D3.clearMarks()}),pm.on("removeAllShapes",function(){D3.removeAllDrawingTools()}),pm.on("saveChart",function(){var e=ChartSaverInstance.saveToJSON();postMessageToParent("onChartSaved",JSON.parse(e.content))}),pm.on("changeSymbol",function(e){function a(){D3.model().mainSeries().onDataLoaded().unsubscribe(null,a),pm.post(window.parent,"symbolChangeFinished",{})}A45.interval.setValue(e.interval),A45.symbol.setValue(e.symbol),D3.model().mainSeries().onDataLoaded().subscribe(null,a)}),pm.on("symbolIntervalRequest",function(){pm.post(window.parent,"symbolInterval",JSON.stringify({symbol:A45.symbol.value(),interval:A45.interval.value()}))}),pm.on("removeEntity",function(e){var a=D3.model().chartModel().dataSourceForId(e);return a?void D3.model().chartModel().removeSource(a,!0):void console.warn("Can't find a source with id: "+e)})}(),D3.withModel(null,function(){D3.model().mainSeries().onSymbolResolved().subscribe(null,function(){var e=D3.model().mainSeries().symbolInfo(),a=D3.model().mainSeries().properties().interval.value(),n={name:e.name,exchange:e.exchange,description:e.description,type:e.type,interval:a};postMessageToParent("onSymbolChange",n)}),A45.interval.subscribe(function(e){postMessageToParent("onIntervalChange",e)}),D16.on("realtime_tick",function(e){postMessageToParent("onTick",e)}),D16.on("onAutoSaveNeeded",function(){postMessageToParent("onAutoSaveNeeded")}),D17.subscribe("onMarkClick",function(e){postMessageToParent("onMarkClick",e)})}),headerWidget.onScreenshotReady(function(e){postMessageToParent("onScreenshotReady",e)})}function setChartType(e){D3.model().mainSeries().properties().style.setValue(e)}function loadChart(e){D3.loadContent(e.json.charts[0],e.extendedData),D17.emit("chart_loaded")}function createStudy(e){e.name=e.name.toLowerCase();var a=StudyMetaInfo.findStudyMetaInfoByDescription(D3.model().studiesMetaData(),e.name);a=$.extend({},a),delete a.state,a||console.warn("Study `"+e.name+"` not found.");var n={};if(e.overrides){var r=e.overrides;for(var t in r)MetainfoTuner.setMetainfoProperty(a,t,r[t]);n.styles=a.defaults.styles}e.inputs&&(n.inputs=StudyInputsHelper.getStudyRecordFromArray([e.name].concat(e.inputs),D3).inputs);var o=D3.model().chartModel().insertStudy(a,n,e.forceOverlay);e.lock&&e.lock&&o.setUserEditEnabled(!1),e.callback&&e.callback(o.id())}function createShape(e){var a=D3.model().timeScale().timePointToIndex(e.point.time),n={index:a};if(e.point.price)n.price=e.point.price;else{var r=["open","high","low","close"],t=e.point.channel?r.indexOf(e.point.channel)+1:1;0>=t&&(t=1),n.price=D3.model().mainSeries().data().valueAt(a)[t]}var o=D3._paneWidgets[0]._state,i={arrow_up:{name:"LineToolArrowMarkUp",supportsText:!0},arrow_down:{name:"LineToolArrowMarkDown",supportsText:!0},flag:{name:"LineToolFlagMark",supportsText:!1},vertical_line:{name:"LineToolVertLine",supportsText:!1},horizontal_line:{name:"LineToolHorzLine",supportsText:!1}},s=i[e.options.shape]||i.flag,d=new $52(s.name.toLowerCase());if(e.options.overrides)for(var l in e.options.overrides)d[l]&&d[l].setValue(e.options.overrides[l]);s.supportsText&&e.options.text&&d.text.setValue(e.options.text);var c=D3.model().createLineTool(o,n,s.name,d);e.options.lock&&c.setUserEditEnabled(!1),e.callback&&e.callback(c.id())}function setVisibleRange(e,a){return"undefined"==typeof e||!e.from||!e.to||isNaN(e.from)||isNaN(e.to)?void console.warn("Wrong time range: "+JSON.stringify(e)):void D3.setVisibleTimeRange(parseInt(e.from),parseInt(e.to),a)}function getVisibleRange(e){if(!e)return void console.warn("Callback expected as argument");var a=D3.model().timeScale(),n=a.visibleBars(),r={from:a.indexToUserTime(n.firstBar()<0?0:n.firstBar()),to:a.indexToUserTime(n.lastBar())};e({from:(+r.from||0)/1e3,to:(+r.to||0)/1e3})}function createStudyTemplate(e,a){a(D3.model().model().studyTemplate(e.saveInterval))}function applyStudyTemplate(e){D3.model().model().restoreStudyTemplate(e,""+1e3*Math.random())}urlParams=function(){for(var e,a=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(a," "))},t=window.location.hash.substring(1),o={};e=n.exec(t);)o[r(e[1])]=r(e[2]);var i=window.parent[o.uid];for(var s in i)"datafeed"!=s&&(o[s]=JSON.stringify(i[s]));return o}();var customIndicatorsPresent=!!urlParams.indicatorsFile,customIndicatorsLodaded=$.Deferred(),chartApiInitializationTimePassed=$.Deferred();$.when(customIndicatorsLodaded,chartApiInitializationTimePassed).done(function(){D16.start()}),customIndicatorsPresent?$.getScript(urlParams.indicatorsFile).done(function(){"undefined"!=typeof __customIndicators&&isArray(__customIndicators)&&(A82.studyLibrary=A82.studyLibrary.concat(__customIndicators),console.log("{0} custom indicators loaded.".format(__customIndicators.length)),customIndicatorsLodaded.resolve())}).fail(function(e){console.warn("Error loading custom indicators @ `{0}`: {1} ({2}) ".format(urlParams.indicatorsFile,e.statusText,e.status)),customIndicatorsLodaded.resolve()}):customIndicatorsLodaded.resolve(),pm=TradingView.postMessageWrapper(window.parent),pm.__delayedMesssages=[],pm.on("widgetReady",function(e,a){pm.__delayedMesssages.push({data:e,cb:a}),pm.setClientId(e.client_id)});var localizationReady=$.Deferred(),datafeedReady=$.Deferred();$.when(localizationReady,datafeedReady).done(function(){if(JSON.parse(urlParams.disabledFeatures).map(function(e){W77.setEnabled(e,!1)}),JSON.parse(urlParams.enabledFeatures).map(function(e){W77.setEnabled(e,!0)}),setTimeout(createChart,0),W77.enabled("14851")){!function(e,a,n,r,t,o,i){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,o=a.createElement(n),i=a.getElementsByTagName(n)[0],o.async=1,o.src=r,i.parentNode.insertBefore(o,i)}(window,document,"script","//www.google-analytics.com/analytics.js","ga");var e=document.URL.match(new RegExp("(:?.*://)([^/]+)/.*"))[2];ga("create","UA-53174009-1","auto"),ga("set",{hostname:e,page:e,referrer:e}),ga("send","pageview")}}),window.parent[urlParams.uid].datafeed.onReady(function(){datafeedReady.resolve()}),$(function(){var e={lng:urlParams.locale,load:"unspecific",resGetPath:"localization/translations/__lng__.json",keyseparator:"@",nsseparator:"@",fallbackLng:"en"};$.i18n.init(e,function(e){$("html").i18n(),localizationReady.resolve(),$(window).resize(),$(".loading-indicator").hide()})});</script></body></html>
